window.__require=function e(t,i,n){function o(r,s){if(!i[r]){if(!t[r]){var l=r.split("/");if(l=l[l.length-1],!t[l]){var c="function"==typeof __require&&__require;if(!s&&c)return c(l,!0);if(a)return a(l,!0);throw new Error("Cannot find module '"+r+"'")}}var d=i[r]={exports:{}};t[r][0].call(d.exports,function(e){return o(t[r][1][e]||e)},d,d.exports,e,t,i,n)}return i[r].exports}for(var a="function"==typeof __require&&__require,r=0;r<n.length;r++)o(n[r]);return o}({AStarUtil:[function(e,t,i){"use strict";cc._RF.push(t,"4c3bfSn0SxKkrLw+l9mLtpm","AStarUtil"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./AStar"),o=e("../../Global/GlobalValue"),a=e("../Utils"),r=function(){function e(){this.aStar=new n.AStar,this.keyNode=[]}return e.getIndexByX=function(e){return Math.floor(e/o.MapTiledSize)},e.getIndexByY=function(e){return Math.floor(-e/o.MapTiledSize)},e.getFlatByIndexX=function(e){return e*o.MapTiledSize+o.MapTiledSize/2},e.getFlatByIndexY=function(e){return-e*o.MapTiledSize-o.MapTiledSize/2},e.prototype.ValidationMapIndex=function(t,i){var n=new cc.Vec2,o=e.getIndexByX(t),a=e.getIndexByY(i);return o<0&&(o=0),o>=this.Grid.numCols&&(o=this.Grid.numCols-1),a<0&&(a=0),a>=this.Grid.numRows&&(a=this.Grid.numRows-1),n.x=o,n.y=a,n},e.prototype.findPath=function(e,t,i,n,o){void 0===o&&(o=!0);var a=this.ValidationMapIndex(e,t);this.Grid.setStartNode(a.x,a.y);var r=this.ValidationMapIndex(i,n);if(this.Grid.setEndNode(r.x,r.y),this.aStar.findPath(this.Grid)){var s=this.aStar.path;return 1==o&&s&&s.length>0&&this.simplifyRoad(s,e,t),s}return[]},e.prototype.simplifyRoad=function(t,i,n){var o,r,s,l=t.length,c=i,d=n;this.keyNode.length=l;for(var p=0;p<l;p++)this.keyNode[p]=0;var h=0;for(p=l-1;p>=h;p--){c=i,d=n,o=e.getFlatByIndexX(t[p].x),r=e.getFlatByIndexY(t[p].y),s=Math.atan2(r-d,o-c);for(var u=!0;a.default.distance(c,d,o,r)>10;){c+=10*Math.cos(s),d+=10*Math.sin(s);var f=this.Grid.getNode(e.getIndexByX(c),e.getIndexByY(d));if(!f||0==f.walkable){u=p<=h;break}}if(u){if(this.keyNode[p]=1,p>=l-1)break;i=o,n=r,h=p+1,p=l}}for(p=0;p<t.length-1;p++)0==this.keyNode[p]&&(this.keyNode.splice(p,1),t.splice(p,1),p--)},e}();i.AStarUtil=r,cc._RF.pop()},{"../../Global/GlobalValue":"GlobalValue","../Utils":"Utils","./AStar":"AStar"}],AStar:[function(e,t,i){"use strict";cc._RF.push(t,"2c6cbIVPg9DcorZ1xKiJA3V","AStar"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(){this._straightCost=1,this._diagCost=Math.SQRT2,this._heuristic=this.diagonal}return e.prototype.findPath=function(e){return this._grid=e,this._open=[],this._closed=[],this._startNode=this._grid.startNode,this._endNode=this._grid.endNode,this._startNode.g=0,this._startNode.h=this._heuristic(this._startNode),this._startNode.f=this._startNode.g+this._startNode.h,this.search()},e.prototype.search=function(){for(var e=this._startNode;e!=this._endNode;){for(var t=Math.max(0,e.x-1),i=Math.min(this._grid.numCols-1,e.x+1),n=Math.max(0,e.y-1),o=Math.min(this._grid.numRows-1,e.y+1),a=t;a<=i;a++)for(var r=n;r<=o;r++){a!=e.x&&e.y;var s=this._grid.getNode(a,r);if(s!=e&&s.walkable&&this._grid.getNode(e.x,s.y).walkable&&this._grid.getNode(s.x,e.y).walkable){var l=this._straightCost;e.x!=s.x&&e.y!=s.y&&(l=this._diagCost);var c=e.g+l*s.costMultiplier,d=this._heuristic(s),p=c+d;this.isOpen(s)||this.isClosed(s)?s.f>p&&(s.f=p,s.g=c,s.h=d,s.parent=e):(s.f=p,s.g=c,s.h=d,s.parent=e,this._open.push(s))}}for(var h=0;h<this._open.length;h++);if(this._closed.push(e),0==this._open.length)return console.log("AStar >> no path found"),!1;for(var u=this._open.length,f=0;f<u;f++)for(var g=f+1;g<u;g++)if(this._open[f].f>this._open[g].f){var y=this._open[f];this._open[f]=this._open[g],this._open[g]=y}e=this._open.shift()}return this.buildPath(),!0},e.prototype.buildPath=function(){this._path=new Array;var e=this._endNode;for(this._path.push(e);e!=this._startNode;)e=e.parent,this._path.unshift(e)},Object.defineProperty(e.prototype,"path",{get:function(){return this._path},enumerable:!0,configurable:!0}),e.prototype.isOpen=function(e){for(var t=0;t<this._open.length;t++)if(this._open[t]==e)return!0;return!1},e.prototype.isClosed=function(e){for(var t=0;t<this._closed.length;t++)if(this._closed[t]==e)return!0;return!1},e.prototype.manhattan=function(e){return Math.abs(e.x-this._endNode.x)*this._straightCost+Math.abs(e.y+this._endNode.y)*this._straightCost},e.prototype.euclidian=function(e){var t=e.x-this._endNode.x,i=e.y-this._endNode.y;return Math.sqrt(t*t+i*i)*this._straightCost},e.prototype.diagonal=function(e){var t=Math.abs(e.x-this._endNode.x),i=Math.abs(e.y-this._endNode.y),n=Math.min(t,i),o=t+i;return this._diagCost*n+this._straightCost*(o-2*n)},Object.defineProperty(e.prototype,"visited",{get:function(){return this._closed.concat(this._open)},enumerable:!0,configurable:!0}),e}();i.AStar=n;var o=function(){function e(e,t){this._numCols=e,this._numRows=t,this._nodes=[];for(var i=0;i<e;i++){this._nodes[i]=[];for(var n=0;n<t;n++)this._nodes[i][n]=new a(i,n)}}return e.prototype.getNode=function(e,t){return this._nodes[e][t]},e.prototype.setEndNode=function(e,t){this._endNode=this._nodes[e][t]},e.prototype.setStartNode=function(e,t){this._startNode=this._nodes[e][t]},e.prototype.setWalkable=function(e,t,i){this._nodes[e][t].walkable=i},Object.defineProperty(e.prototype,"endNode",{get:function(){return this._endNode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numCols",{get:function(){return this._numCols},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numRows",{get:function(){return this._numRows},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startNode",{get:function(){return this._startNode},enumerable:!0,configurable:!0}),e}();i.Grid=o;var a=function(){return function(e,t){this.walkable=!1,this.costMultiplier=1,this.x=e,this.y=t}}();i.Node=a,cc._RF.pop()},{}],AchieveInfo:[function(e,t,i){"use strict";cc._RF.push(t,"94ad9GbOM1Lj60ox0MDWOj9","AchieveInfo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("./AchievementData"),a=e("../../NetConnect/NetConnet"),r=e("../Commons/RewardUtils"),s=e("./AchievementController"),l=e("../../Core/GameEventDispatcher"),c=e("../../Core/Event"),d=e("../Item/ItemIcon"),p=e("../../Util/Utils"),h=e("../../Core/WindowType"),u=e("../OpenWin/OpenWinController"),f=e("../Tips/RewardTips"),g=e("../../GlobalContext"),y=e("../../Core/LoadManager"),m=e("./AchievementWin"),C=cc._decorator,v=C.ccclass,_=C.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Name=null,t.description=null,t.Status=null,t.progressBar=null,t.Reward=null,t.Icon=null,t.Icons=null,t.config=null,t.id=0,t.btnDown=!1,t.item=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),l.GameEventDispatcher.instance.on(c.EventDefiner.GetFlag,this.getflag,this)},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),this.onClear(),l.GameEventDispatcher.instance.off(c.EventDefiner.GetFlag,this.getflag,this)},t.prototype.hide=function(){e.prototype.hide.call(this),this.onClear()},t.prototype.onClear=function(){for(var e=this.Reward.childrenCount-1;e>=0;e--)this.Reward.children[e]&&this.Reward.children[e].getComponent(d.default)&&p.default.setNodeToPool(h.PoolType.ItemIcon,this.Reward.children[e])},t.prototype.getflag=function(){if(0!=this.HasGotReward(this.id)){var e=this.item;u.default.instance.openWindow(h.WindowType.RewardTips,function(){f.default.instance.setData(e)}),s.default.instance.array[this.config.achieveid]&&(s.default.instance.array[this.config.achieveid]={}),l.GameEventDispatcher.instance.emit(c.EventDefiner.SetProgress,this.id),this.Status.children[1].active=!0,this.Status.children[0].active=!1,this.Status.children[2].active=!1,m.default.instance&&m.default.instance.ItemInfo()}},t.prototype.getReward=function(){this.config.reward&&this.sendptc(this.config.id)},t.prototype.init=function(e,t,i){var n=this;this.id=e;var a=this.HasGotReward(e);this.config=new o.default,this.config.initData(e),this.Icon.spriteFrame=this.Icons.getSpriteFrame("icon_"+this.config.icon),this.Name.string=this.config.name,this.description.string=this.config.description;var s=this.config.number;if(this.onClear(),this.config.reward){var l=r.default.instance.getItemList(this.config.reward);this.item=l,y.default.instance.loadResByType(g.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(e){for(var t=0;t<l.length;t++)if(l[t]){var i=p.default.getNodeByPool(h.PoolType.ItemIcon,e,g.GlobalContext.Root+"prefab/Bag/ItemIcon");n.Reward.addChild(i),i.getComponent(d.default).ItemData(l[t],!0,null,!0)}},this)}null==this.config.reverse?t>=this.config.number?0!=a?(this.Status.children[1].active=!0,this.Status.children[0].active=!1,this.Status.children[2].active=!1):(this.Status.children[0].active=!0,this.Status.children[1].active=!1,this.Status.children[2].active=!1):(this.Status.children[2].active=!0,this.Status.children[0].active=!1,this.Status.children[1].active=!1,1==this.config.progresstype?(this.progressBar.progress=0,this.Status.children[2].children[1].children[2].getComponent(cc.Label).string="0 / 1"):(this.progressBar.progress=t/this.config.number,this.Status.children[2].children[1].children[2].getComponent(cc.Label).string=t+"/"+s)):t<=this.config.number?0!=a?(this.Status.children[1].active=!0,this.Status.children[0].active=!1,this.Status.children[2].active=!1):(this.Status.children[0].active=!0,this.Status.children[1].active=!1,this.Status.children[2].active=!1):(this.Status.children[2].active=!0,this.Status.children[0].active=!1,this.Status.children[1].active=!1,1==this.config.progresstype?(this.progressBar.progress=0,this.Status.children[2].children[1].children[2].getComponent(cc.Label).string="0 / 1"):(this.progressBar.progress=(this.config.reverse-t)/(this.config.reverse-this.config.number),this.Status.children[2].children[1].children[2].getComponent(cc.Label).string=this.config.reverse-t+"/"+(this.config.reverse-this.config.number)))},t.prototype.sendptc=function(e){var t={cmd:"achievereward",id:e};a.default.instance.sendProto(t)},t.prototype.HasGotReward=function(e){var t=Math.floor(e/32),i=e%32,n=s.default.instance.flag[t];return n?n&1<<i:0},__decorate([_(cc.Label)],t.prototype,"Name",void 0),__decorate([_(cc.Label)],t.prototype,"description",void 0),__decorate([_(cc.Node)],t.prototype,"Status",void 0),__decorate([_(cc.ProgressBar)],t.prototype,"progressBar",void 0),__decorate([_(cc.Node)],t.prototype,"Reward",void 0),__decorate([_(cc.Sprite)],t.prototype,"Icon",void 0),__decorate([_(cc.SpriteAtlas)],t.prototype,"Icons",void 0),t=__decorate([v],t)}(n.default);i.default=b,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/LoadManager":"LoadManager","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../NetConnect/NetConnet":"NetConnet","../../Util/Utils":"Utils","../Commons/RewardUtils":"RewardUtils","../Item/ItemIcon":"ItemIcon","../OpenWin/OpenWinController":"OpenWinController","../Tips/RewardTips":"RewardTips","./AchievementController":"AchievementController","./AchievementData":"AchievementData","./AchievementWin":"AchievementWin"}],AchieveTip:[function(e,t,i){"use strict";cc._RF.push(t,"ee480x5S3NPw4/DowKzPva+","AchieveTip"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/WindowManager"),a=e("../../Core/WindowType"),r=e("../Sound/SoundController"),s=e("../Scene/Controller/SceneController"),l=e("../../Global/GlobalValue"),c=cc._decorator,d=c.ccclass,p=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.AchieveName=null,t.text=[],t.icon=null,t.spriteAtlas=null,t.flag=!1,t.list=[],t.iconarry=[],t.openWinFlag=!1,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.hide=function(){e.prototype.hide.call(this)},t.prototype.showTips=function(e,t){var i=this;void 0===e&&(e=" "),void 0===t&&(t=""),0==this.flag?(this.flag=!0,this.node.stopAllActions(),this.node.setPosition(0,0),this.node.active=!0,this.AchieveName.string=e,this.icon.spriteFrame=this.spriteAtlas.getSpriteFrame("icon_"+t),this.node.x=0,this.node.runAction(cc.sequence(cc.moveTo(1,cc.v2(-987,0)),cc.delayTime(3),cc.moveTo(1,cc.v2(-2e3,0)),cc.callFunc(function(){i.node.active=!1,i.flag=!1,i.list.length>0&&i.checkName()},this)))):(this.list.unshift(e),this.iconarry.unshift(t))},t.prototype.checkName=function(){this.showTips(this.list.pop(),this.iconarry.pop())},t.prototype.openAchieveWin=function(){0==this.openWinFlag&&s.default.instance.scenestatus!=l.GameScene.Fight&&(r.default.instance.PlayEffect(r.SoundType.comclick),this.openWinFlag=!0,o.default.instance.open(a.WindowType.Achievement))},t.prototype.texting=function(){for(var e in this.text)this.showTips(this.text[e])},__decorate([p(cc.Label)],t.prototype,"AchieveName",void 0),__decorate([p([cc.String])],t.prototype,"text",void 0),__decorate([p(cc.Sprite)],t.prototype,"icon",void 0),__decorate([p(cc.SpriteAtlas)],t.prototype,"spriteAtlas",void 0),t=__decorate([d],t)}(n.default);i.default=h,cc._RF.pop()},{"../../Core/Widget":"Widget","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../Scene/Controller/SceneController":"SceneController","../Sound/SoundController":"SoundController"}],AchievementController:[function(e,t,i){"use strict";cc._RF.push(t,"3621c4kuAhM16iyz/dFcAqX","AchievementController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../Core/GameEventDispatcher"),a=e("../../Core/Event"),r=e("./AchievementWin"),s=e("./AchievementData"),l=e("../Tips/AchieveTip"),c=e("../Functionicon/FunctionIconController"),d=e("../../Core/WindowType"),p=e("../../Core/LoadManager"),h=e("../../GlobalContext"),u=e("../../Util/Utils"),f=cc._decorator,g=f.ccclass,y=f.property,m=function(e){function t(){var t=e.call(this)||this;return t.achievementContent=null,t.data=null,t.flag=null,t.star=null,t.rewardidx=null,t.config=null,t.showflag=!1,t.list=[],t.icon=[],t.tipflag=!1,t.array=[],t._curAcName=null,t._curAcIcon=null,t._curAcId=null,i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this),this.config=new s.default,this.achievementContent.childrenCount||p.default.instance.loadResByType(h.GlobalContext.Root+"prefab/Achievement/AchieveTip",cc.Prefab,function(e){var i=u.default.getNodeByUrl(e,h.GlobalContext.Root+"prefab/Achievement/AchieveTip");t.achievementContent.addChild(i),t.showAcTip()},this)},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.listNotification=function(){this.addProto("achieveprogress",this.getPrograssData,this),this.addProto("achieveflag",this.getflag,this),this.addProto("achievestar",this.getstar,this)},t.prototype.getPrograssData=function(e){this.data=JSON.parse(JSON.stringify(e.progress)),this.array=[];var t=0;for(var i in this.config.achievement)this.config.initData(Number(i)),0==this.config.typeconf[this.config.type].IsShow&&this.data[this.config.condition]&&this.data[this.config.condition][0]>=this.config.number&&(this.showflag=!0),this.data.length-1>=this.config.condition&&(null==this.config.param||this.config.reverse||0==this.config.reverse?null!=this.config.reverse?this.data[this.config.condition]&&this.data[this.config.condition][0]<=this.config.number&&(0==this.tipflag?this.list[this.config.achieveid]=this.config.name:this.checkNewAchieve(this.config.achieveid,this.config.name,this.config.icon),0==this.HasGotReward(this.config.achieveid)&&(this.array[this.config.achieveid]={type:this.config.labelName,subtype:this.config.subTypeName},t++)):this.data[this.config.condition]&&this.data[this.config.condition][0]>=this.config.number&&(0==this.tipflag?this.list[this.config.achieveid]=this.config.name:this.checkNewAchieve(this.config.achieveid,this.config.name,this.config.icon),0==this.HasGotReward(this.config.achieveid)&&(this.array[this.config.achieveid]={type:this.config.labelName,subtype:this.config.subTypeName},t++)):this.data[this.config.condition]&&this.data[this.config.condition][this.config.param]&&this.data[this.config.condition][this.config.param]>=this.config.number&&(0==this.tipflag?this.list[this.config.achieveid]=this.config.name:this.checkNewAchieve(this.config.achieveid,this.config.name,this.config.icon),0==this.HasGotReward(this.config.achieveid)&&(this.array[this.config.achieveid]={type:this.config.labelName,subtype:this.config.subTypeName},t++)));r.default.instance&&1==r.default.instance.WinOpened&&(1==this.showflag&&0==r.default.instance.tabflag&&r.default.instance.checkTab(),r.default.instance.TabBtnList2&&r.default.instance.isShow&&r.default.instance.TabBtnList2.checkRedDot()),t>0?c.default.instance.FuncIconRedDeal(d.WindowType.Achievement,!0):c.default.instance.FuncIconRedDeal(d.WindowType.Achievement,!1),this.tipflag=!0,t||this.setArray()},t.prototype.checkNewAchieve=function(e,t,i){this.list[e]||(this._curAcId=e,this._curAcName=t,this._curAcIcon=i,this.list[e]=t,this.showAcTip())},t.prototype.showAcTip=function(){this.achievementContent.childrenCount&&this._curAcName&&(this.achievementContent.children[0].getComponent(l.default).showTips(this._curAcName,this._curAcIcon),this._curAcName=null,this._curAcIcon=null)},t.prototype.setTipOpenWinFlag=function(){this.achievementContent.childrenCount&&(this.achievementContent.children[0].getComponent(l.default).openWinFlag=!1)},t.prototype.getflag=function(e){this.flag=e.flag,o.GameEventDispatcher.instance.emit(a.EventDefiner.GetFlag)},t.prototype.setArray=function(){!this.array.length&&this.star&&this.star>=this.config.starconf[this.rewardidx].condition?(this.array[this.config.achieveid]={type:"\u603b\u89c8",subtype:this.config.subTypeName},r.default.instance.TabBtnList2&&r.default.instance.isShow?r.default.instance.TabBtnList2.checkRedDot():c.default.instance.FuncIconRedDeal(d.WindowType.Achievement,!0)):(this.array[this.config.achieveid]&&"\u603b\u89c8"==this.array[this.config.achieveid].type&&this.array.splice(this.config.achieveid,1),r.default.instance.TabBtnList2&&r.default.instance.isShow&&r.default.instance.TabBtnList2.checkRedDot())},t.prototype.getstar=function(e){this.star=e.star,this.rewardidx=e.rewardidx,this.setArray(),r.default.instance.starCheck(this.star,this.rewardidx)},t.prototype.HasGotReward=function(e){var t=Math.floor(e/32),n=e%32;if(!i.instance.flag)return 0;var o=i.instance.flag[t];return o?o&1<<n:0},t.instance=null,__decorate([y(cc.Node)],t.prototype,"achievementContent",void 0),t=i=__decorate([g],t)}(n.default);i.default=m,cc._RF.pop()},{"../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/LoadManager":"LoadManager","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Functionicon/FunctionIconController":"FunctionIconController","../Tips/AchieveTip":"AchieveTip","./AchievementData":"AchievementData","./AchievementWin":"AchievementWin"}],AchievementData:[function(e,t,i){"use strict";cc._RF.push(t,"cf3dekfvARHFYeIwvbnDP4S","AchievementData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/ConfigsManager"),o=cc._decorator,a=o.ccclass,r=(o.property,function(){function e(){this._config=null}return e.prototype.initData=function(e){this.id=e},Object.defineProperty(e.prototype,"config",{get:function(){return this._config=n.ConfigsManager.instance.getConfigs("achievementconf"),this._config},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"achieveid",{get:function(){return this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"achievement",{get:function(){return this.config.Achievement},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"subtypeconf",{get:function(){return this.config.subType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"starconf",{get:function(){return this.config.Star},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"typeconf",{get:function(){return this.config.Type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"conditionconf",{get:function(){return this.config.condition},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.config.Achievement[this.id].name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){return this.config.Achievement[this.id].icon},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this.config.Achievement[this.id].Type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"subType",{get:function(){return this.config.Achievement[this.id].subType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function(){return this.config.Achievement[this.id].description},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"difficulty",{get:function(){return this.config.Achievement[this.id].difficulty?this.config.Achievement[this.id].difficulty:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"param",{get:function(){return this.config.Achievement[this.id].param||0==this.config.Achievement[this.id].param?this.config.Achievement[this.id].param:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"condition",{get:function(){return this.config.Achievement[this.id].condition},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"number",{get:function(){return this.config.Achievement[this.id].number},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reward",{get:function(){return this.config.Achievement[this.id].reward},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reverse",{get:function(){return this.config.Achievement[this.id].reverse||0==this.config.Achievement[this.id].reverse?this.config.Achievement[this.id].reverse:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labelName",{get:function(){return this.config.Type[this.type].Name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isShow",{get:function(){return this.config.Type[this.type].IsShow},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"subTypeName",{get:function(){return this.config.subType[this.subType]?this.config.subType[this.subType].Name:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"subTypeInType",{get:function(){return this.config.subType[this.subType].Type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"progresstype",{get:function(){return this.config.Achievement[this.id].progresstype},enumerable:!0,configurable:!0}),e=__decorate([a],e)}());i.default=r,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager"}],AchievementWin:[function(e,t,i){"use strict";cc._RF.push(t,"b0451bbpBJDGa1a57QrPnwn","AchievementWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("./AchievementData"),a=e("./AchievementController"),r=e("../../NetConnect/NetConnet"),s=e("./TabList"),l=e("../../Core/GameEventDispatcher"),c=e("../../Core/Event"),d=e("../Commons/RewardUtils"),p=e("../../Core/LoadManager"),h=e("../../Core/WindowManager"),u=e("../../Core/WindowType"),f=e("../Tips/RewardTips"),g=e("../Commons/ListViewCtrl"),y=e("../../GlobalContext"),m=e("../../Util/Utils"),C=e("../Commons/CommonProgress"),v=cc._decorator,_=v.ccclass,b=v.property,T=function(e){function t(){var t=e.call(this)||this;return t.TabBtnList2=null,t.Summary=null,t.Detail=null,t.PrograssAll=null,t.ProgressShow=null,t.AchieveShow=null,t.SubTypeShow=null,t.StarRewardOn=null,t.StarRewardOff=null,t.BoxIcon=null,t.ListViewCtrl=null,t.tabname=[],t.achievementData=null,t.index=0,t.subIndex=0,t.idByType=[],t.achievenum=0,t.WinOpened=!1,t.hidenType=null,t.tabflag=!1,t.typecount=0,t.typetotal=0,t.typecount1=0,t.isShow=!1,t.itemicon3=null,t.currIndex=0,t.currSubIndex=0,t.achiveArray=[],i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this),this.achievementData=new o.default,this.ListViewCtrl.refreshItem=this.ScrollInfo,this.ListViewCtrl.refreshItemThis=this,this.initTab(),l.GameEventDispatcher.instance.on(c.EventDefiner.SetProgress,this.setProgress,this)},t.prototype.show=function(){e.prototype.show.call(this),this.isShow=!0,1==this.WinOpened&&(this.TabBtnList2._delaySelectedIndexTime=0,this.TabBtnList2._delaySelectedIndexTime1=0,this.TabBtnList2.selectItem(0),i.instance.TabBtnList2.checkRedDot()),l.GameEventDispatcher.instance.on(c.EventDefiner.SetProgress,this.setProgress,this)},t.prototype.hide=function(){e.prototype.hide.call(this),l.GameEventDispatcher.instance.off(c.EventDefiner.SetProgress,this.setProgress,this),this.ProgressShow.childrenCount>0&&m.default.setNodeChildDestoryByUrl(this.ProgressShow,"prefab/Achievement/subProgress"),this.tabflag=!0,this.isShow=!1},t.prototype.checkTab=function(){this.initTab(),this.TabBtnList2.addList(),this.TabBtnList2.selectItem(0),this.tabflag=!0},t.prototype.ItemInfo=function(){this.SelectedChange(this.currIndex),this.SubTabBtnSelectedChange(this.currSubIndex)},t.prototype.setProgress=function(e){var t=e.getUserData(),i=this.achievementData.typeconf[0].totalNum;this.achievementData.initData(t),this.achievenum+=1,this.typecount+=1,this.PrograssAll.getChildByName("CommonProgress").getChildByName("New Label").getComponent(cc.Label).string=this.achievenum+"/"+i,this.PrograssAll.getChildByName("CommonProgress").getComponent(C.default).value=this.achievenum/i},t.prototype.loadItemicon=function(e,t){var i=y.GlobalContext.ResRoot+"resources/itemicon/"+t+".png";m.default.setImage(e,i)},t.prototype.starCheck=function(e,t){if(0!=this.WinOpened){if(t>=Object.keys(this.achievementData.starconf).length)return this.PrograssAll.getChildByName("title").x=-370,this.PrograssAll.getChildByName("CommonProgress").x=-289.6,this.PrograssAll.getChildByName("CommonProgress").getComponent(C.default).width=644,this.PrograssAll.getChildByName("CommonProgress").getChildByName("New Label").x=100,this.PrograssAll.parent.getChildByName("content").width=818,this.PrograssAll.parent.getChildByName("content").x=-40,this.PrograssAll.parent.getChildByName("content").getComponent(cc.Layout).spacingX=100,this.PrograssAll.parent.getChildByName("content").getComponent(cc.Layout).paddingLeft=50,this.PrograssAll.parent.getChildByName("content").getComponent(cc.Layout).paddingRight=50,void(this.StarRewardOff.parent.active=!1);if(e>=this.achievementData.starconf[t].condition){this.StarRewardOn.active=!0,this.StarRewardOff.active=!1;var i=this.achievementData.starconf[t].boxType,n=this.StarRewardOn.children[0];this.loadItemicon(n,i),n.getComponent(cc.Sprite).node.setScale(1.5,1.5),this.StarRewardOn.getChildByName("highLigh").getComponent(cc.Sprite).spriteFrame="ItemIcon_box5"!=i?this.BoxIcon.getSpriteFrame("boxeff1"):this.BoxIcon.getSpriteFrame("boxeff2"),this.joggle(this.StarRewardOn.getChildByName("highLigh")),this.joggle(this.StarRewardOn.getChildByName("New Sprite"))}else{this.StarRewardOn.active=!1,this.StarRewardOff.active=!0,this.StarRewardOff.children[1].children[0].getComponent(cc.Label).string=this.achievenum+"/"+this.achievementData.starconf[t].condition;i=this.achievementData.starconf[t].boxType,n=this.StarRewardOff.children[0];this.loadItemicon(n,i),n.getComponent(cc.Sprite).node.width=144,n.getComponent(cc.Sprite).node.height=134}}},t.prototype.joggle=function(e){e.stopAllActions(),e.runAction(cc.repeatForever(cc.sequence(cc.delayTime(.1),cc.rotateTo(.18,10),cc.rotateTo(.18,-10),cc.rotateTo(.1,2),cc.rotateTo(.1,-2))))},t.prototype.closeJoggle=function(e){e.stopAllActions()},t.prototype.ScrollInfo=function(e,t){t>=0&&e.getComponent("AchieveInfo").init(this.achiveArray[t].id,this.achiveArray[t].reach,this.achiveArray[t].type)},t.prototype.SelectedChange=function(e){this.currIndex=e,this.ListViewCtrl.scrollView=this.AchieveShow.parent.parent.getComponent(cc.ScrollView),0==this.WinOpened&&(this.WinOpened=!0),this.index=e;var t=a.default.instance.data;if(0==e){this.ProgressShow.childrenCount>0&&m.default.setNodeChildDestoryByUrl(this.ProgressShow,"prefab/Achievement/subProgress"),this.Summary.active=!0,this.Detail.active=!1;var i=0,n=this.achievementData.typeconf[0].totalNum,o=a.default.instance.star,r=(this.achievementData.typeconf[0].starNum,[]),s=[],l=[];for(var c in this.achiveArray=[],this.achievementData.achievement)if(this.achievementData.initData(Number(c)),t.length-1>=this.achievementData.condition&&t[this.achievementData.condition])if(null==this.achievementData.param||this.achievementData.reverse||0==this.achievementData.reverse)if(null!=this.achievementData.reverse)if(t[this.achievementData.condition][this.achievementData.param]<=this.achievementData.number)if(0!=this.HasGotReward(this.achievementData.id))i++,s[this.achievementData.labelName]?s[this.achievementData.labelName]+=1:s[this.achievementData.labelName]=1;else{h={id:this.achievementData.id,reach:t[this.achievementData.condition][this.achievementData.param],type:0};this.achiveArray.push(h)}else{var d=this.achievementData.reverse,p=this.achievementData.reverse-t[this.achievementData.condition][this.achievementData.param];p/d>.3&&((r=[]).id=this.achievementData.id,r.achieve=t[this.achievementData.condition][this.achievementData.param],r.sort=p/d,l.push(r))}else if(t[this.achievementData.condition][this.achievementData.param]>=this.achievementData.number)if(0!=this.HasGotReward(this.achievementData.id))i++,s[this.achievementData.labelName]?s[this.achievementData.labelName]+=1:s[this.achievementData.labelName]=1;else{h={id:this.achievementData.id,reach:t[this.achievementData.condition][this.achievementData.param],type:0};this.achiveArray.push(h)}else t[this.achievementData.condition][this.achievementData.param]/this.achievementData.number>.3&&((r=[]).id=this.achievementData.id,r.achieve=t[this.achievementData.condition][this.achievementData.param],r.sort=t[this.achievementData.condition][this.achievementData.param]/this.achievementData.number,l.push(r));else if(t[this.achievementData.condition][this.achievementData.param]>=this.achievementData.number)if(0!=this.HasGotReward(this.achievementData.id))i++,s[this.achievementData.labelName]?s[this.achievementData.labelName]+=1:s[this.achievementData.labelName]=1;else{var h={id:this.achievementData.id,reach:t[this.achievementData.condition][this.achievementData.param],type:0};this.achiveArray.push(h)}else t[this.achievementData.condition][this.achievementData.param]/this.achievementData.number>.3&&((r=[]).id=this.achievementData.id,r.achieve=t[this.achievementData.condition][this.achievementData.param],r.sort=t[this.achievementData.condition][this.achievementData.param]/this.achievementData.number,l.push(r));for(var c in this.tabname)this.openprogress(this.tabname[c],s[this.tabname[c]],this.achievementData.typeconf[c].totalNum);if(l){var u=l.sort(function(e,t){return t.sort[0]-e.sort[0]});for(var c in u)if(this.achievementData.initData(u[c].id),0!=this.achievementData.typeconf[this.achievementData.type].IsShow){var f={id:u[c].id,reach:u[c].achieve,type:0};this.achiveArray.push(f)}}this.achievenum=i,this.PrograssAll.getChildByName("CommonProgress").getChildByName("New Label").getComponent(cc.Label).string=this.achievenum+"/"+n,this.PrograssAll.getChildByName("CommonProgress").getComponent(C.default).value=this.achievenum/n,this.starCheck(o,a.default.instance.rewardidx)}else if(this.Summary.active=!1,this.Detail.active=!0,5==e){r=[],l=[];var g=[],y=0;for(var c in this.typecount=0,this.typetotal=0,this.achievementData.achievement)this.achievementData.initData(Number(c)),this.achievementData.type==e&&t.length-1>=this.achievementData.condition&&t[this.achievementData.condition]&&(null!=this.achievementData.param?0!=this.HasGotReward(this.achievementData.id)?((r=[]).id=this.achievementData.id,r.reach=t[this.achievementData.condition][this.achievementData.param],g.push(r),y++,this.typetotal++):r.reach>=this.achievementData.number&&((r=[]).id=this.achievementData.id,r.reach=t[this.achievementData.condition][this.achievementData.param],l.push(r),this.typetotal++):t[this.achievementData.condition][this.achievementData.param]>=this.achievementData.number&&(0!=this.HasGotReward(this.achievementData.id)?((r=[]).id=this.achievementData.id,r.reach=t[this.achievementData.condition][this.achievementData.param],g.push(r),y++,this.typetotal++):((r=[]).id=this.achievementData.id,r.reach=t[this.achievementData.condition][this.achievementData.param],l.push(r),this.typetotal++)));if(this.typecount=y,l)for(var c in l){var v={id:l[c].id,reach:l[c].reach,type:this.index};this.achiveArray.push(v)}if(g)for(var c in g){var _={id:g[c].id,reach:g[c].reach,type:this.index};this.achiveArray.push(_)}}this.ListViewCtrl.initialize(this.achiveArray),this.ListViewCtrl.scrollToTop()},t.prototype.openprogress=function(e,t,i){var n=this;t||(t=0),p.default.instance.loadResByType("prefab/Achievement/subProgress",cc.Prefab,function(o){var a=m.default.getNodeByUrl(o,"prefab/Achievement/subProgress");n.ProgressShow.addChild(a),a.getComponent("Typeinfo").init(e,t,i)},this)},t.prototype.openprogressinfo=function(e,t,i,n){p.default.instance.loadResByType(y.GlobalContext.Root+"prefab/Achievement/AchieveInfo",cc.Prefab,function(o){var a=m.default.getNodeByUrl(o,"prefab/Achievement/AchieveInfo");a.getComponent("AchieveInfo").init(e,t,n),i.addChild(a)},this)},t.prototype.setInfo=function(e,t,i){e.children[0].children[3].getComponent(cc.Label).string=t+"/"+i,e.children[0].children[1].getComponent(cc.Sprite).fillRange=t/i*.66},t.prototype.SubTabBtnSelectedChange=function(e){if(this.currSubIndex=e,0!=this.currIndex){this.ListViewCtrl.scrollView=this.SubTypeShow.parent.parent.getComponent(cc.ScrollView),this.achiveArray=[];for(var t=0,i=0;i<this.index;i++)t+=this.achievementData.typeconf[i].subTypeCount;if(t+=e,this.index>0&&5!=this.index){var n=a.default.instance.data,o=[],r=[],s=[],l=[];for(var i in this.typecount=0,this.typetotal=this.achievementData.typeconf[this.index].totalNum,this.achievementData.achievement)if(this.achievementData.initData(Number(i)),this.achievementData.type==this.index)if(n.length-1>=this.achievementData.condition)if(n[this.achievementData.condition])if(null==this.achievementData.param||this.achievementData.reverse||0==this.achievementData.reverse){if(null!=this.achievementData.reverse)0!=this.HasGotReward(this.achievementData.id)?(this.achievementData.subType==t&&((o=[]).id=this.achievementData.id,o.reach=n[this.achievementData.condition][this.achievementData.param],l.push(o)),this.typecount++):n[this.achievementData.condition][this.achievementData.param]<=this.achievementData.number?this.achievementData.subType==t&&((o=[]).id=this.achievementData.id,o.reach=n[this.achievementData.condition][this.achievementData.param],r.push(o)):this.achievementData.subType==t&&((o=[]).id=this.achievementData.id,o.reach=n[this.achievementData.condition][this.achievementData.param],s.push(o));else if(n[this.achievementData.condition][0]>=this.achievementData.number)0!=this.HasGotReward(this.achievementData.id)?(this.achievementData.subType==t&&((o=[]).id=this.achievementData.id,o.reach=n[this.achievementData.condition][0],l.push(o)),this.typecount++):this.achievementData.subType==t&&((o=[]).id=this.achievementData.id,o.reach=n[this.achievementData.condition][0],r.push(o));else if(this.achievementData.subType==t){(o=[]).id=this.achievementData.id;var c=this.achievementData.param?this.achievementData.param:0;o.reach=n[this.achievementData.condition][c],s.push(o)}}else 0!=this.HasGotReward(this.achievementData.id)?(this.achievementData.subType==t&&((o=[]).id=this.achievementData.id,o.reach=n[this.achievementData.condition][this.achievementData.param],l.push(o)),this.typecount++):this.achievementData.subType==t&&((o=[]).id=this.achievementData.id,n[this.achievementData.condition][this.achievementData.param]?o.reach=n[this.achievementData.condition][this.achievementData.param]:o.reach=0,o.reach>=this.achievementData.number?r.push(o):s.push(o));else this.achievementData.subType==t&&((o=[]).id=this.achievementData.id,o.reach=this.achievementData.reverse?99999999999999:0,s.push(o));else this.achievementData.subType==t&&((o=[]).id=this.achievementData.id,this.achievementData.reverse?o.reach=this.achievementData.reverse:o.reach=0,s.push(o));if(r)for(var i in r){var d={id:r[i].id,reach:r[i].reach,type:this.index};this.achiveArray.push(d)}if(s)for(var i in s){var p={id:s[i].id,reach:s[i].reach,type:this.index};this.achiveArray.push(p)}if(l)for(var i in l){var h={id:l[i].id,reach:l[i].reach,type:this.index};this.achiveArray.push(h)}}else if(5==this.index){n=a.default.instance.data,o=[],r=[],s=[];for(var i in this.achievementData.achievement)if(this.achievementData.initData(Number(i)),this.achievementData.type==this.index&&n[this.achievementData.condition])if(0!=this.HasGotReward(this.achievementData.id)){(o=[]).id=this.achievementData.id;var u=this.achievementData.param?this.achievementData.param:0;o.reach=n[this.achievementData.condition][u],r.push(o),this.typecount++}else{(o=[]).id=this.achievementData.id;var f=this.achievementData.param?this.achievementData.param:0;n[this.achievementData.condition][f]?o.reach=n[this.achievementData.condition][f]:o.reach=0,o.reach>=this.achievementData.number?r.push(o):s.push(o)}if(r)for(var i in r){var g={id:r[i].id,reach:r[i].reach,type:this.index};this.achiveArray.push(g)}if(s)for(var i in s){g={id:s[i].id,reach:s[i].reach,type:this.index};this.achiveArray.push(g)}}this.ListViewCtrl.initialize(this.achiveArray),this.ListViewCtrl.scrollToTop()}},t.prototype.initTab=function(){var e=this.achievementData.config.Type,t=0,i=[];for(var n in e)0!=e[n].IsShow?(i[t]=e[n].Name,0!=Number(n)&&(this.tabname[t]=e[n].Name)):1==a.default.instance.showflag&&(i[t]=e[n].Name),t++;this.TabBtnList2.TabBtnNames=i,this.TabBtnList2.selectedCallback=this.SelectedChange,this.TabBtnList2.selectedCallbackThisObj=this,this.TabBtnList2.subselectedCallback=this.SubTabBtnSelectedChange,this.TabBtnList2.subselectedCallbackThisObj=this},t.prototype.HasGotReward=function(e){var t=Math.floor(e/32),i=e%32,n=a.default.instance.flag[t];return n&&0!=(n&1<<i)?1:0},t.prototype.close=function(){e.prototype.close.call(this),this.TabBtnList2.selectItem(0),a.default.instance.setTipOpenWinFlag()},t.prototype.onpenRewardNode=function(){var e=this;if(this.achievementData.starconf[a.default.instance.rewardidx].rewardId){this.closeJoggle(this.StarRewardOn.getChildByName("New Sprite")),this.closeJoggle(this.StarRewardOn.getChildByName("highLigh"));var t=d.default.instance.getItemList(this.achievementData.starconf[a.default.instance.rewardidx].rewardId);h.default.instance.open(u.WindowType.RewardTips,function(){f.default.instance.setData(t),e.sendptc()})}},t.prototype.sendptc=function(){r.default.instance.sendProto({cmd:"achievestarreward"})},t.instance=null,__decorate([b(s.default)],t.prototype,"TabBtnList2",void 0),__decorate([b(cc.Node)],t.prototype,"Summary",void 0),__decorate([b(cc.Node)],t.prototype,"Detail",void 0),__decorate([b(cc.Node)],t.prototype,"PrograssAll",void 0),__decorate([b(cc.Node)],t.prototype,"ProgressShow",void 0),__decorate([b(cc.Node)],t.prototype,"AchieveShow",void 0),__decorate([b(cc.Node)],t.prototype,"SubTypeShow",void 0),__decorate([b(cc.Node)],t.prototype,"StarRewardOn",void 0),__decorate([b(cc.Node)],t.prototype,"StarRewardOff",void 0),__decorate([b(cc.SpriteAtlas)],t.prototype,"BoxIcon",void 0),__decorate([b(g.default)],t.prototype,"ListViewCtrl",void 0),t=i=__decorate([_],t)}(n.default);i.default=T,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/LoadManager":"LoadManager","../../Core/Window":"Window","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../NetConnect/NetConnet":"NetConnet","../../Util/Utils":"Utils","../Commons/CommonProgress":"CommonProgress","../Commons/ListViewCtrl":"ListViewCtrl","../Commons/RewardUtils":"RewardUtils","../Tips/RewardTips":"RewardTips","./AchievementController":"AchievementController","./AchievementData":"AchievementData","./TabList":"TabList"}],AcquistionPathWin:[function(e,t,i){"use strict";cc._RF.push(t,"060f39fThhGuL7v9woIUmVl","AcquistionPathWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/LoadManager"),o=e("../../Util/Utils"),a=e("../../GlobalContext"),r=e("../Item/ItemIcon"),s=e("../Item/ItemData"),l=e("../Item/ItemController"),c=e("../Commons/CommonPageBG"),d=e("../../Core/Language"),p=e("./PathItem"),h=e("../Item/ItemModel"),u=e("../Role/RoleInfo"),f=cc._decorator,g=f.ccclass,y=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.itemContent=null,t.itemContentLabe=null,t.pathContent=null,t.layout=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.show=function(){e.prototype.show.call(this),this.onInit(757,554,d.default.getStr("\u83b7\u53d6\u9014\u5f84"),!0)},t.prototype.hide=function(){e.prototype.hide.call(this)},t.prototype.Init=function(e,t){var i=this;void 0===t&&(t=0);var c=0;c=1==e?u.MyRoleInfo.money:9==e?u.MyRoleInfo.diamond:l.default.instance.getItemNum(e),o.default.setNodeChildDestoryByUrl(this.itemContent,a.GlobalContext.Root+"prefab/Bag/ItemIcon"),n.default.instance.loadResByType(a.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(t){var l=o.default.getNodeByUrl(t,a.GlobalContext.Root+"prefab/Bag/ItemIcon"),c=s.default.creatItem(e,1);l.getComponent(r.default).ItemData(c,!0,null,!0),i.itemContent.addChild(l),o.default.setNodeChildDestoryByUrl(i.pathContent,a.GlobalContext.Root+"prefab/AcquistionPath/SkipItem"),n.default.instance.loadResByType(a.GlobalContext.Root+"prefab/AcquistionPath/SkipItem",cc.Prefab,function(e){for(var t in c.Roads){var n=o.default.getNodeByUrl(e,a.GlobalContext.Root+"prefab/AcquistionPath/SkipItem"),r=h.default.instance.getItemRoadOfInfo();n.getComponent(p.default).Init(r[c.Roads[t]].name,0,3,r[c.Roads[t]].windType,c.name,r[c.Roads[t]].icon,c.Roads[t],r[c.Roads[t]].describe,r[c.Roads[t]].childIndex),i.pathContent.addChild(n)}},i)},this),this.itemContentLabe.string=c+"",this.layout.active=3!=e},t.instance=null,__decorate([y(cc.Node)],t.prototype,"itemContent",void 0),__decorate([y(cc.Label)],t.prototype,"itemContentLabe",void 0),__decorate([y(cc.Node)],t.prototype,"pathContent",void 0),__decorate([y(cc.Node)],t.prototype,"layout",void 0),t=i=__decorate([g],t)}(c.default);i.default=m,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/CommonPageBG":"CommonPageBG","../Item/ItemController":"ItemController","../Item/ItemData":"ItemData","../Item/ItemIcon":"ItemIcon","../Item/ItemModel":"ItemModel","../Role/RoleInfo":"RoleInfo","./PathItem":"PathItem"}],ActiveActor:[function(e,t,i){"use strict";cc._RF.push(t,"5f8032ia7VPVLZT6TGIiSrf","ActiveActor"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./Animal"),o=e("../../Global/GlobalValue"),a=cc._decorator,r=a.ccclass,s=(a.property,function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.initWithXY=function(e,t,i,n,a,r,s,l,c,d){void 0===i&&(i="skin"),void 0===l&&(l=!1),void 0===c&&(c=o.ACTION.STAND),void 0===d&&(d=o.DIR.RIGHT),this.init(e,t,i,n,s,l,c,d),this.worldX=a,this.worldY=r,this.updateSit(a,r)},t.prototype.init=function(e,t,i,n,a,r,s,l){void 0===i&&(i="skin"),void 0===r&&(r=!1),void 0===s&&(s=o.ACTION.STAND),void 0===l&&(l=o.DIR.RIGHT),this.prop.deadman?this.avatar.init(e,t,i,n,a,r,s,l,"skin5_fight2_b"):this.avatar.init(e,t,i,n,a,r,s,l)},t.prototype.updateData=function(t,i){e.prototype.updateData.call(this,t,i),this.moving(t)},t=__decorate([r],t)}(n.default));i.default=s,cc._RF.pop()},{"../../Global/GlobalValue":"GlobalValue","./Animal":"Animal"}],ActivityCfg:[function(e,t,i){"use strict";cc._RF.push(t,"308d0eNV49JrrTiymeqGiYE","ActivityCfg"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../GlobalContext"),o=e("../../Core/WindowType"),a=function(){function e(){this._activityID=[],this._url={},this._isInit=!1}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.setData(o.WindowType.SevenDayLogin,"SevenDayLogin"),this.setData(o.WindowType.HalfPrice,"HalfPriceWin"),this.setData(o.WindowType.GroupPurchase,"Firstchargegrouppurchase"),this.setData(o.WindowType.SevenDayGoal,"SevenDayGoal"),this.setData(o.WindowType.SevenDayRanking,"SevenDayRanking"),this.setData(o.WindowType.FristCharge,"DailyFirstCharge"),this.setData(o.WindowType.ActiveBack,"ActivityReturn"),this.setData(o.WindowType.Loop_FristCharge,"DailyFirstCharge"),this.setData(o.WindowType.Loop_GroupPurchase,"Firstchargegrouppurchase"),this.setData(o.WindowType.Loop_ActiveBack,"ActivityReturn"),this.setData(o.WindowType.Loop_HalfPrice,"HalfPriceWin"),this._isInit=!0,console.info("\u6d3b\u52a8\u914d\u7f6e\u521d\u59cb\u5316\u5b8c\u6210!")},e.prototype.setData=function(e,t){var i=n.GlobalContext.Root+"prefab/ActivityView/"+t;this._activityID.push(e),this._url[e]?console.error(" \u6d3b\u52a8\u9884\u5236\u4f53\u8def\u5f84\u91cd\u590d\u6dfb\u52a0 WindowID:%d url:%s",e,i):this._url[e]=i},Object.defineProperty(e.prototype,"windowIDList",{get:function(){return this._isInit||this.init(),this._activityID},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"initFalg",{set:function(e){this._isInit=e},enumerable:!0,configurable:!0}),e.prototype.getPrefabURL=function(e){return this._isInit||this.init(),this._url[e]||console.warn("\u7a97\u53e3ID\u6709\u8bef\uff01WindowID:%d",e),this._url[e]},e._instance=null,e}();i.default=a,cc._RF.pop()},{"../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext"}],ActivityController:[function(e,t,i){"use strict";cc._RF.push(t,"58d94Wi0aNOI7QEjWTGzwoV","ActivityController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../WorldBoss/WorldBoss"),a=e("../../NetConnect/NetConnet"),r=e("../../Core/ConfigsManager"),s=e("../../Core/GameEventDispatcher"),l=e("../../Core/TimeController"),c=e("../Scene/Controller/FightController"),d=e("../Scene/Manager/SceneManager"),p=e("../Status/StatusType"),h=e("../RankingList/RankingConst"),u=e("../OpenWin/OpenWinController"),f=e("../../Core/WindowType"),g=e("../Role/RoleInfo"),y=e("../Functionicon/FunctionIconController"),m=e("./ActivityHallData/ActivityHallData"),C=e("../FridBoss/FridBossController"),v=e("../TreasureMap/TreasureMapController"),_=e("../../Core/Event"),b=e("../Activity/ActivityHallPage"),T=e("../DailyCopy/DailyCopyCtrl"),S=e("../Expedition/ExpeditionController"),I=e("../EquipCopy/EquipCopyController"),w=e("../TotemsCopy/TotemsCopyUtils"),D=e("../../Core/WindowManager"),R=e("../ExpCopy/ExpCopyUtils"),A=e("../Gamelayer/Interface/EventInterface"),N=e("../RankingList/RankListCtrl"),L=e("../LoardCrusadeWin/LoardCrusadeCtrl"),E=cc._decorator,B=E.ccclass,M=(E.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.worldBool=!1,t.eliteBool=!1,t.roomList=null,t.wuling=null,t.blood=null,t.activityConf=null,t.fightNum=null,t.worldLineup=null,t.isSetSandTab=!1,t.killName=null,t.worldSelfRank=null,t.worlRank=null,t.eliteRank=null,t.worldBossHp=null,t.eliteBossHp=null,t.image=null,t.isChange=!1,t.isFrist=!1,t.worldBossRankReward=[],t.currElitIndex=-1,t.challgeEliteIndx=0,t.eliteRoomId=0,t.monster=null,t.RoomChangeCount=0,t.ChallengeBool=!1,t.elitePitch=!1,t.theDeamge=0,t.challengeTimes=0,t.actstatusArr=[],t.worldbossRewardData=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this,this.activityConfigs=r.ConfigsManager.instance.getConfigs("activityInfoconf"),this.rewardConfigs=r.ConfigsManager.instance.getConfigs("stdrewardconf"),this.activityConf=r.ConfigsManager.instance.getConfigs("activityconf_client"),this.onInitActivityHall()},t.prototype.getFight=function(){return this.fightNum+g.MyRoleInfo.Fight},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.listNotification=function(){this.addProto("rankdata",this.rankdata,this),this.addProto("selfrank",this.selfrank,this),this.addProto("worldbosshp",this.SetWorldbosshp,this),this.addProto("worldbossuidata",this.worldBossInfo,this),this.addProto("worldbossdata",this.worldbossdata,this),this.addProto("worldbosskiller",this.worldbosskiller,this),this.addProto("actstatus",this.actstatus,this),this.addProto("actchange",this.actchange,this),this.addProto("ebinfo",this.eliteBossInfo,this),this.addProto("getworldbossattr",this.WorldAttrMsg,this),this.addProto("worldbossimage",this.worldBossSandTabLineup,this),this.addProto("worldbosskillershow",this.worldbossKillInfo,this),this.addProto("ebrank",this.eliteRankInfo,this),this.addProto("singleDamage",this.eliteBossThedamage,this),s.GameEventDispatcher.instance.on(_.EventDefiner.ActivityCopyUpdateRed,this.activitySetRed,this)},t.prototype.rankdata=function(e){switch(e.type){case h.RankingType.ArenaThis:case h.RankingType.ArenaLast:case h.RankingType.HightLadder:case h.RankingType.Grade:case h.RankingType.Combat:case h.RankingType.MyArenaThis:case h.RankingType.MyArenaLast:N.default.instance.resRankData(e);break;case h.RankingType.WorldBoss:this.worlRank=e,s.GameEventDispatcher.instance.emit("WorldBossRank",this);break;case h.RankingType.Devil:L.default.instance.loardRank=e.data,s.GameEventDispatcher.instance.emit("LoardRank",this)}},t.prototype.eliteRankInfo=function(e){this.eliteRank=e,this.currElitIndex>=0&&e.data[this.currElitIndex].hp<=0&&(d.default.instance.fightlogic.OnFightResult(!0),s.GameEventDispatcher.instance.emit("RESETHP",this)),s.GameEventDispatcher.instance.emit("EliteRank",this)},t.prototype.selfrank=function(e){switch(e.type){case h.RankingType.ArenaThis:case h.RankingType.ArenaLast:case h.RankingType.HightLadder:case h.RankingType.Grade:case h.RankingType.Combat:case h.RankingType.MyArenaThis:case h.RankingType.MyArenaLast:N.default.instance.resSelfRank(e);break;case h.RankingType.WorldBoss:this.worldSelfRank=e,s.GameEventDispatcher.instance.emit("WorldSelfRank",this);break;case h.RankingType.Devil:L.default.instance.myDevilRank(e)}},t.prototype.sendrankdata=function(){var e=null;e=p.ActivityStatus.value==p.ActivityStatus.WorldBoss?{cmd:"rankdata",type:3}:{cmd:"ebrank",actId:2},a.default.instance.sendProto(e)},t.prototype.actstatus=function(e){for(var t=0;t<e.act.length;t++){switch(e.act[t].id){case 1:2==e.act[t].status?(s.GameEventDispatcher.instance.emit("WORLDRED",this),y.default.instance.checkIsOpenbyWindowtype(f.WindowType.WorldBoss)&&(this.worldBool=!0)):this.worldBool=!1;break;case 2:y.default.instance.checkIsOpenbyWindowtype(f.WindowType.EliteBoss)&&2==e.act[t].status?(u.default.instance.openWindow(f.WindowType.EliteBossOpenTipsWin),this.eliteBool=!0):this.eliteBool=!1}this.actstatusArr[e.act[t].id]=e.act[t]}},t.prototype.activitySetRed=function(){if(D.default.instance.isOpenWindow(f.WindowType.ActivityWin)&&b.default.instance&&b.default.instance.layerContent&&b.default.instance.layerContent.childrenCount>0){var e=b.default.instance.layerContent.children;if(e&&e.length>0)for(var t=0;t<e.length;t++){var n=e[t].name.match(/\d+$/gi);switch(Number(n[0])){case f.WindowType.DailyCopyArtifact:case f.WindowType.DailyCopy:case f.WindowType.DailyCopyRefine:case f.WindowType.DailyCopyMoney:e[t].getChildByName("red").active=T.default.instance.getReddot();break;case f.WindowType.WorldBoss:e[t].getChildByName("red").active=i.instance.worldBool;break;case f.WindowType.Expedition:e[t].getChildByName("red").active=S.default.instance.setResetRed();break;case f.WindowType.EquipCopyMain:e[t].getChildByName("red").active=I.default.instance.havefreeResetCount();break;case f.WindowType.TotemsCopy:e[t].getChildByName("red").active=w.TotemsCopyUtils.getRed();break;case f.WindowType.ExpCopy:e[t].getChildByName("red").active=R.ExpCopyUtils.getRed();break;case f.WindowType.EliteBoss:e[t].getChildByName("red").active=this.eliteBool}}}var o=[];o.push(T.default.instance&&T.default.instance.getReddot(),i.instance.worldBool,this.eliteBool,w.TotemsCopyUtils.getRed(),R.ExpCopyUtils.getRed(),S.default.instance.setResetRed(),I.default.instance.havefreeResetCount()),-1!=o.indexOf(!0)?s.GameEventDispatcher.instance.emit(A.EventInterface.ActivityRed,!0):s.GameEventDispatcher.instance.emit(A.EventInterface.ActivityRed,!1)},t.prototype.actchange=function(e){switch(this.actstatusArr[e.id]=e,e.id){case 1:this.worldBool=y.default.instance.checkIsOpenbyWindowtype(f.WindowType.WorldBoss)&&2==e.status,s.GameEventDispatcher.instance.emit("WorldData",this),s.GameEventDispatcher.instance.emit(_.EventDefiner.ActivityCopyUpdateRed);break;case 2:this.eliteBool=y.default.instance.checkIsOpenbyWindowtype(f.WindowType.EliteBoss)&&2==e.status,s.GameEventDispatcher.instance.emit("GETINDEX",this);break;case 3:s.GameEventDispatcher.instance.emit("LoardCrusade",this)}},t.prototype.SetWorldbosshp=function(e){this.worldBossHp=e,e.hp<=0&&d.default.instance.fightlogic&&(d.default.instance.fightlogic.OnFightResult(!0),s.GameEventDispatcher.instance.emit("RESETHP",this)),o.default.instance&&o.default.instance.worldbosshp(e)},t.prototype.worldbossdata=function(e){this.worldbossRewardData=e},t.prototype.worldbosskiller=function(e){s.GameEventDispatcher.instance.emit("WORLDRED",this),this.killName=e.name},t.prototype.nameSubstring=function(e,t){var i=String(e);return i.length>t?i.substring(0,t)+"...":i},t.prototype.getTimeLabel=function(e){var t=Math.floor(e/3600),i=t<10?"0"+t:t,n=Math.floor(e%3600/60)<10?"0"+Math.floor(e%3600/60):Math.floor(e%3600/60);return(0==t?"":i+":")+n+":"+(e%60<10?"0"+e%60:e%60)},t.prototype.eliteBossInfo=function(e){this.image=e.data.image,this.challgeEliteIndx=e.data.index,this.challengeTimes=e.data.challengeTimes,s.GameEventDispatcher.instance.emit("GETINDEX",this)},t.prototype.WroldAttr=function(){a.default.instance.sendProto({cmd:"getworldbossattr"})},t.prototype.worldBossInfo=function(e){this.image=e.image,this.worldBossRankReward=e.rankReward,o.default.instance.index=e.index,s.GameEventDispatcher.instance.emit("WorldData",this)},t.prototype.WorldAttrMsg=function(e){this.wuling=e.wulingattr,this.blood=e.bloodattr},t.prototype.worldBossSandTabLineup=function(e){this.worldLineup=e.image},t.prototype.WorldBossSetSand=function(){a.default.instance.sendProto({cmd:"worldbosssetimage"})},t.prototype.EliteBossSetSand=function(){a.default.instance.sendProto({cmd:"ebsetimage",act:2})},t.prototype.TerritoryWarSerSand=function(){a.default.instance.sendProto({cmd:"twsetimage"})},t.prototype.worldbossKillInfo=function(e){var t=this;if(this.killName=e.name,d.default.instance.resultShowItemList=e.killReward,p.ActivityStatus.value==p.ActivityStatus.WorldBoss){c.default.instance.isKill=!0;var i=l.default.instance.setTimeout(function(){u.default.instance.openWindow(f.WindowType.WorldBossResult,function(){t.sendrankdata()}),l.default.instance.clearTimeout(i)},this,1e3)}},t.prototype.getIsPVP=function(){var e=!1;switch(p.ActivityStatus.value){case p.ActivityStatus.Arena:case p.ActivityStatus.HighLadder:e=!0}return e},t.prototype.onInitActivityHall=function(){this._activityHallData=new m.default,this._activityHallData.onInit(this.activityConfigs.ActivityConf)},Object.defineProperty(t.prototype,"activityHallList",{get:function(){return this._activityHallData.activityHallList},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this._activityHallData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activityWindowTypeList",{get:function(){return this._activityHallData.activityWindowTypeList},enumerable:!0,configurable:!0}),t.prototype.getRemainValByWindowType=function(e){for(var t=1,i=0;i<this.activityHallList.length;i++)if(this.activityHallList[i].windowType==e){t=this.activityHallList[i].canEnterNum;break}switch(e){case f.WindowType.TreasureMainView:t-=v.default.instance.getInNum;break;case f.WindowType.FridBoss:t=C.default.instance.FriendBossTimes}return t},t.prototype.sendElitebossenter=function(){var e={cmd:"ebenter",actId:2,index:this.currElitIndex};a.default.instance.sendProto(e)},t.prototype.eliteBossThedamage=function(e){this.theDeamge=e.singleDamage,s.GameEventDispatcher.instance.emit("eliteBossTheDamage",this)},t.instance=null,t=i=__decorate([B],t)}(n.default));i.default=M,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/TimeController":"TimeController","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../NetConnect/NetConnet":"NetConnet","../Activity/ActivityHallPage":"ActivityHallPage","../DailyCopy/DailyCopyCtrl":"DailyCopyCtrl","../EquipCopy/EquipCopyController":"EquipCopyController","../ExpCopy/ExpCopyUtils":"ExpCopyUtils","../Expedition/ExpeditionController":"ExpeditionController","../FridBoss/FridBossController":"FridBossController","../Functionicon/FunctionIconController":"FunctionIconController","../Gamelayer/Interface/EventInterface":"EventInterface","../LoardCrusadeWin/LoardCrusadeCtrl":"LoardCrusadeCtrl","../OpenWin/OpenWinController":"OpenWinController","../RankingList/RankListCtrl":"RankListCtrl","../RankingList/RankingConst":"RankingConst","../Role/RoleInfo":"RoleInfo","../Scene/Controller/FightController":"FightController","../Scene/Manager/SceneManager":"SceneManager","../Status/StatusType":"StatusType","../TotemsCopy/TotemsCopyUtils":"TotemsCopyUtils","../TreasureMap/TreasureMapController":"TreasureMapController","../WorldBoss/WorldBoss":"WorldBoss","./ActivityHallData/ActivityHallData":"ActivityHallData"}],ActivityCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"ff8b3h7wqhHp4Pz5MhhNQTM","ActivityCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var n,o=e("../../Core/Controller"),a=e("./ActivityData"),r=e("../../Core/WindowType"),s=e("../Functionicon/FunctionIconController"),l=e("../../Core/Event"),c=e("../../NetConnect/NetConnet"),d=e("../../Core/GameEventDispatcher"),p=e("../../Global/GlobalValue"),h=e("./GroupPurchase/GroupPurchaseContrl"),u=cc._decorator,f=u.ccclass;u.property;(function(e){e[e.Normal=0]="Normal",e[e.OpenServe=1]="OpenServe",e[e.Loop=2]="Loop",e[e.Merge=3]="Merge",e[e.Week=4]="Week"})(n=i.ActivityType||(i.ActivityType={})),function(e){e[e.OpenServe=1]="OpenServe",e[e.Loop=2]="Loop",e[e.Merge=3]="Merge",e[e.Other=4]="Other"}(i.WinType||(i.WinType={}));var g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._data=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.listNotification=function(){this.addProto(l.EventDefiner.Activity_Yunying,this.resYunyingInfo,this),this.addProto(l.EventDefiner.Activity_yunyingopen,this.resYunyingopen,this),this.addProto(l.EventDefiner.Activity_yunyingend,this.resYunyingend,this),this.addProto(l.EventDefiner.openserverday,this.resOpenserverday,this),this.addProto(l.EventDefiner.rewardpanel,this.resRewardShow,this)},Object.defineProperty(t.prototype,"data",{get:function(){return this._data||(this._data=new a.default),this._data},enumerable:!0,configurable:!0}),t.prototype.setIocnRed=function(){var e=this.data.getActivityType();s.default.instance.FuncIconRedDeal(r.WindowType.ActivityView,e==p.ActivityWinType.openServer&&this.data.iconRedFlag),s.default.instance.FuncIconRedDeal(r.WindowType.LoopActivity,e==p.ActivityWinType.LoopActivity&&this.data.iconRedFlag),s.default.instance.FuncIconRedDeal(r.WindowType.MergeServer,e==p.ActivityWinType.mergeServer&&this.data.iconRedFlag)},t.prototype.onChangeActivity=function(){var e=!(this.data.getActivityCount(n.OpenServe)>0);s.default.instance.FuncIconHideDeal(r.WindowType.ActivityView,e);var t=!(this.data.getActivityCount(n.Loop)>0);s.default.instance.FuncIconHideDeal(r.WindowType.LoopActivity,t)},t.prototype.resYunyingInfo=function(e){this.data.setYunyingInfo(e.info),this.onChangeActivity(),this.reqProto(),d.GameEventDispatcher.instance.emit(l.EventDefiner.Activity_YunyingUP)},t.prototype.resYunyingopen=function(e){this.data.setYunyingopen(e),this.onChangeActivity(),this.reqProto(),d.GameEventDispatcher.instance.emit(l.EventDefiner.Activity_YunyingUP)},t.prototype.resYunyingend=function(e){this.data.setYunyingend(e),this.onChangeActivity(),d.GameEventDispatcher.instance.emit(l.EventDefiner.Activity_YunyingUP)},t.prototype.resRewardShow=function(e){d.GameEventDispatcher.instance.emit(l.EventDefiner.rewardpanel_showEffect,{data:e})},t.prototype.resOpenserverday=function(e){this.data.setOpenserverday(e),d.GameEventDispatcher.instance.emit(l.EventDefiner.openserverday_up)},t.prototype.reqYunying=function(){c.default.instance.sendProto({cmd:"yunying"})},t.prototype.reqOpenserverday=function(){c.default.instance.sendProto({cmd:"openserverday"})},t.prototype.reqProto=function(){var e=-1,t=-1;switch(this.data.getActivityType()){case 1:e=8,t=9,h.default.instance.SendRecharge();break;case 2:e=12,t=13}h.default.instance.SendFirstCharge(e),h.default.instance.SendGroupBuy(t)},t.instance=null,t=i=__decorate([f],t)}(o.default);i.default=g,cc._RF.pop()},{"../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../NetConnect/NetConnet":"NetConnet","../Functionicon/FunctionIconController":"FunctionIconController","./ActivityData":"ActivityData","./GroupPurchase/GroupPurchaseContrl":"GroupPurchaseContrl"}],ActivityData:[function(e,t,i){"use strict";cc._RF.push(t,"5f884zy6cNDQYSEAtoeZf0m","ActivityData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/TimeController"),o=e("../../Core/ConfigsManager"),a=e("../../Global/GlobalValue"),r=e("./ActivityCtrl"),s=e("../../Core/GameEventDispatcher"),l=e("../../Core/Event"),c=function(){function e(){this._yunyingCfg=null,this._openActivityID=[],this._redFlag={},this._openDay=null,this._mergeDay=null,this._yunyingInfo={},this._yunyingSrotCfg={},this._activityType=null,this._tabNmae={},this.activityWindow={},this._yunyingCfg=o.ConfigsManager.instance.getConfigs("yunyingconf"),this.activityWindow=this._yunyingCfg.window,this.initCfg()}return e.prototype.initCfg=function(){var e=this._yunyingCfg.window;for(var t in e)e[t].winType&&(this._yunyingSrotCfg[e[t].winType]||(this._yunyingSrotCfg[e[t].winType]=new Array),this._yunyingSrotCfg[e[t].winType].push(e[t]));this._yunyingSrotCfg[a.ActivityWinType.openServer].sort(function(e,t){return e.srot-t.srot})},e.prototype.getYunyingId=function(e){return this._yunyingCfg.window[e]?this._yunyingCfg.window[e].actID:null},e.prototype.getYunyingCfgData=function(e){return this._yunyingCfg.YunyingConf[e]},e.prototype.getYunyingCfg=function(e){var t=this.getYunyingId(e);return this.getYunyingCfgData(t)},e.prototype.getOpenActivityIDs=function(e){return this._openActivityID=[],this._openActivityID.length<=0&&this.setOpenActivityData(e),this._openActivityID},e.prototype.getActivityState=function(e){var t=this.getYunyingId(e);if(!t)return!1;var i=this.getYunyingInfo(t),o=this.getYunyingCfgData(t),a=!1,r=n.default.instance.ServerTime;return i&&r<=i.endtime&&o.canSee&&(a=!0),a},e.prototype.setOpenActivityData=function(e){var t=this._yunyingSrotCfg[e];for(var i in t){this.getActivityState(t[i].winID)&&this._openActivityID.push(t[i].winID)}},e.prototype.setRedFlag=function(e,t){this._redFlag[e]=t,r.default.instance.setIocnRed(),s.GameEventDispatcher.instance.emit(l.EventDefiner.Activity_upTabRed,{winID:e})},Object.defineProperty(e.prototype,"iconRedFlag",{get:function(){var e=!1;for(var t in this._redFlag)if(this._redFlag[t]){e=!0;break}return e},enumerable:!0,configurable:!0}),e.prototype.getRedFlag=function(e){var t=!1;return this._redFlag[e]&&(t=this._redFlag[e]),t},e.prototype.setYunyingInfo=function(e){for(var t in e)this._yunyingInfo[e[t].id]=e[t];this.setActivityType()},e.prototype.setYunyingopen=function(e){var t={id:e.id,starttime:e.start,endtime:e.end,idx:e.idx};this._yunyingInfo[e.id]=t,this.setActivityType()},e.prototype.setYunyingend=function(e){this._yunyingInfo[e.id]=null,delete this._yunyingInfo[e.id],this.setActivityType()},e.prototype.setActivityType=function(){if(Object.keys(this._yunyingInfo).length<=0)this._activityType=-1;else for(var e in this._yunyingInfo){var t=this.getYunyingCfgData(parseInt(e)).actType;if(t!=a.ActivityWinType.otherServer){this._activityType=t;break}}},e.prototype.getYunyingInfo=function(e){return this._yunyingInfo[e]},e.prototype.getYunyingData=function(e){var t=this.getYunyingId(e);return this.getYunyingInfo(t)},e.prototype.setOpenserverday=function(e){this._openDay=e.openDay,this._mergeDay=e.mergeDay},e.prototype.getOpenDay=function(){return this._openDay?this._openDay:0},e.prototype.getMergeDay=function(){return this._mergeDay?this._mergeDay:0},e.prototype.getActivityCount=function(e){var t=0;for(var i in this._yunyingInfo){var n=this.getYunyingCfgData(this._yunyingInfo[i].id);n&&n.activityType==e&&t++}return t},e.prototype.getActivityType=function(){return this._activityType},e.prototype.setTabName=function(e,t){this._tabNmae[e]=t},e.prototype.getTabName=function(e){var t=null;(t=this._tabNmae[e])||(t=this.getYunyingCfg(e).name);return t},e}();i.default=c,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/TimeController":"TimeController","../../Global/GlobalValue":"GlobalValue","./ActivityCtrl":"ActivityCtrl"}],ActivityHallData:[function(e,t,i){"use strict";cc._RF.push(t,"bc68bqUOhdAwpWeTunNoIql","ActivityHallData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./ActivityHallItemData"),o=e("../../../Core/WindowType"),a=e("../ActivityController"),r=e("../../TreasureMap/TreasureMapController"),s=e("../../FridBoss/FridBossController"),l=e("../../Functionicon/FunctionIconController"),c=function(){function e(){this._activityList=[],this._activityWindowTypeList=[],this._config=null}return e.prototype.onInit=function(e){for(var t in this._config=e,this._activityList=[],this._activityWindowTypeList=[],this._config){var i=new n.default;i.onInit(this._config[t]),1==i.type&&(this._activityList.push(i),this._activityWindowTypeList.push(i.windowType))}this._activityList.sort(function(e,t){return e.activityIndex-t.activityIndex})},Object.defineProperty(e.prototype,"activityHallList",{get:function(){return this._activityList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activityWindowTypeList",{get:function(){return this._activityWindowTypeList},enumerable:!0,configurable:!0}),e.prototype.DataSort=function(e){var t=[],i=[];for(var n in e)this.openSteaus(e[n])?t.push(e[n]):i.push(e[n]);return t=t.concat(i)},e.prototype.openSteaus=function(e){var t=!0,i=l.default.instance.checkIsOpenbyWindowtype(e.windowType);switch(e.windowType){case o.WindowType.WorldBoss:if(a.default.instance.actstatusArr[1])switch(a.default.instance.actstatusArr[1].status){case 1:case 2:break;case 3:default:t=!1}else t=!1;break;case o.WindowType.TreasureMainView:t=!(e.canEnterNum-r.default.instance.getInNum<1);break;case o.WindowType.FridBoss:t=!(s.default.instance.FriendBossTimes<1);break;case o.WindowType.EliteBoss:if(a.default.instance.actstatusArr[2])switch(a.default.instance.actstatusArr[2].status){case 1:case 2:break;case 3:default:t=!1}else t=!1}return i&&t},e}();i.default=c,cc._RF.pop()},{"../../../Core/WindowType":"WindowType","../../FridBoss/FridBossController":"FridBossController","../../Functionicon/FunctionIconController":"FunctionIconController","../../TreasureMap/TreasureMapController":"TreasureMapController","../ActivityController":"ActivityController","./ActivityHallItemData":"ActivityHallItemData"}],ActivityHallEvent:[function(e,t,i){"use strict";cc._RF.push(t,"ad51180qKZLGJwEjroMeBIj","ActivityHallEvent"),Object.defineProperty(i,"__esModule",{value:!0}),function(e){e.ActivityHallClick="ActivityHallClick"}(i.ActivityHallEvent||(i.ActivityHallEvent={})),cc._RF.pop()},{}],ActivityHallItemData:[function(e,t,i){"use strict";cc._RF.push(t,"b540eCcDjZG8Itt4x8y/EJf","ActivityHallItemData"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(){this._config=null}return e.prototype.onInit=function(e){this._config=e},Object.defineProperty(e.prototype,"activityId",{get:function(){return this._config.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activityIndex",{get:function(){return this._config.index},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"iconName",{get:function(){return this._config.iconName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"iconLabel",{get:function(){return this._config.iconLabel},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canEnterNum",{get:function(){return this._config.textNum},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rewardId",{get:function(){return this._config.rewardId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"windowType",{get:function(){return this._config.windowType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textString",{get:function(){return this._config.textString||""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textString2",{get:function(){return this._config.textString2||""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._config.type},enumerable:!0,configurable:!0}),e}();i.default=n,cc._RF.pop()},{}],ActivityHallItem:[function(e,t,i){"use strict";cc._RF.push(t,"dabe2hlwD9E+YjxyXk41Coz","ActivityHallItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../GlobalContext"),a=e("../Commons/Image"),r=e("../../Core/WindowType"),s=e("../Commons/RewardUtils"),l=e("../../Util/Utils"),c=e("../Item/ItemIcon"),d=e("../../Core/TimeController"),p=e("./ActivityController"),h=e("../TreasureMap/TreasureMapController"),u=e("../FridBoss/FridBossController"),f=e("../EquipCopy/EquipCopyController"),g=e("../../Core/Language"),y=e("../Functionicon/FunctionIconController"),m=e("../Commons/WindowOpenUtils"),C=e("../../Core/LoadManager"),v=cc._decorator,_=v.ccclass,b=v.property,T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.spriteTitle=null,t.spriteIcon=null,t.btnEnter=null,t.labelDesc=null,t.layerContent=null,t.layerRedNode=null,t.windowtype=null,t._addIndex=0,t._url=o.GlobalContext.Root+"ui/activityHall/ActivityUI",t}return __extends(t,e),t.prototype.onInitData=function(e){this._activityItemData=e},t.prototype.show=function(){e.prototype.show.call(this),this.onShowPage()},t.prototype.onDisable=function(){e.prototype.onDisable.call(this)},t.prototype.onClear=function(){for(var e=this.layerContent.childrenCount-1;e>=0;e--){this.layerContent.children[e].getComponent(c.default)&&l.default.setNodeToPool(r.PoolType.ItemIcon,this.layerContent.children[e])}},t.prototype.onShowPage=function(){this.spriteTitle.getComponent(a.default).loadSpriteAtlas(this._url,this._activityItemData.iconName),this.spriteIcon.getComponent(a.default).loadSpriteAtlas(this._url,this._activityItemData.iconLabel);var e=y.default.instance.checkIsOpenbyWindowtype(this._activityItemData.windowType),t="",i=!0;switch(this._activityItemData.windowType){case r.WindowType.DailyCopy:t=this._activityItemData.textString;break;case r.WindowType.Expedition:t=this._activityItemData.textString;case r.WindowType.TotemsCopy:t=this._activityItemData.textString;break;case r.WindowType.WorldBoss:if(t=this.onCheckBossTime()?this._activityItemData.textString2:this._activityItemData.textString,p.default.instance.actstatusArr[1])switch(p.default.instance.actstatusArr[1].status){case 1:this._addIndex=-100,t=g.default.getStr("activity_hall_ready");break;case 2:this._addIndex=-100,t=g.default.getStr("activity_hall_jinxing");break;case 3:default:this._addIndex=100,i=!1}else this._addIndex=100,i=!1;break;case r.WindowType.EliteBoss:for(var n=this._activityItemData.textString.split(","),o=null,s=(new Date).getFullYear()+"-"+(Number((new Date).getMonth())+1)+"-"+(new Date).getDate(),l=0;l<n.length;l++){if(o=new Date((s+" "+n[l]).replace(/-/g,"/")),new Date(d.default.instance.ServerTimeMins)<=o){t=g.default.getStr("activity_hall_nextOpen",n[l]);break}l==n.length-1&&o<=new Date(d.default.instance.ServerTimeMins)&&(t=g.default.getStr("activity_hall_nextOpen",n[0]))}if(p.default.instance.actstatusArr[2])switch(p.default.instance.actstatusArr[2].status){case 1:this._addIndex=-100,t=g.default.getStr("activity_hall_ready");break;case 2:this._addIndex=-100,t=g.default.getStr("activity_hall_jinxing");break;case 3:default:this._addIndex=101,i=!1}else this._addIndex=101,i=!1;break;case r.WindowType.TreasureMainView:var c=this._activityItemData.canEnterNum-h.default.instance.getInNum;t=this._activityItemData.textString+c,this._addIndex=c<1?100:0,i=!(c<1);break;case r.WindowType.FridBoss:t=this._activityItemData.textString+u.default.instance.FriendBossTimes,this._addIndex=u.default.instance.FriendBossTimes<1?100:0,i=!(u.default.instance.FriendBossTimes<1);break;case r.WindowType.EquipCopyMain:t=this._activityItemData.textString+f.default.instance.getRemainResetCount;break;case r.WindowType.Arena:case r.WindowType.HighLadderWin:case r.WindowType.ExpCopy:case r.WindowType.LoardCrusadeWin:t=this._activityItemData.textString}this.labelDesc.string=t+"",this.btnEnter.interactable=e&&i,this.onInitReward()},t.prototype.onInitReward=function(){var e=this;l.default.setNodeChildDestoryByUrl(this.layerContent,o.GlobalContext.Root+"prefab/Bag/ItemIcon"),C.default.instance.loadResByType(o.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(t){for(var i=s.default.instance.getItemList(e._activityItemData.rewardId),n=0;n<2;n++){var a=l.default.getNodeByUrl(t,o.GlobalContext.Root+"prefab/Bag/ItemIcon");a.scale=.8,a.getComponent(c.default).ItemData(i[n],!0,null,!0),e.layerContent.addChild(a)}},this)},t.prototype.onClickBtn=function(){y.default.instance.checkIsOpenbyWindowtype(this._activityItemData.windowType,!0)&&m.default.instance.openWindowType(this._activityItemData.windowType)},t.prototype.onCheckBossTime=function(){var e=d.default.instance.ServerTimeMins;return new Date(e).getHours()<12},t.prototype.getIndex=function(){return this._activityItemData.activityIndex+this._addIndex},__decorate([b(cc.Node)],t.prototype,"spriteTitle",void 0),__decorate([b(cc.Node)],t.prototype,"spriteIcon",void 0),__decorate([b(cc.Button)],t.prototype,"btnEnter",void 0),__decorate([b(cc.Label)],t.prototype,"labelDesc",void 0),__decorate([b(cc.Node)],t.prototype,"layerContent",void 0),__decorate([b(cc.Node)],t.prototype,"layerRedNode",void 0),t=__decorate([_],t)}(n.default);i.default=T,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/Image":"Image","../Commons/RewardUtils":"RewardUtils","../Commons/WindowOpenUtils":"WindowOpenUtils","../EquipCopy/EquipCopyController":"EquipCopyController","../FridBoss/FridBossController":"FridBossController","../Functionicon/FunctionIconController":"FunctionIconController","../Item/ItemIcon":"ItemIcon","../TreasureMap/TreasureMapController":"TreasureMapController","./ActivityController":"ActivityController"}],ActivityHallPage:[function(e,t,i){"use strict";cc._RF.push(t,"40267w1zBBNc4Ro1qpOw2GV","ActivityHallPage"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../GlobalContext"),a=e("./ActivityController"),r=e("./ActivityHallItem"),s=e("../../Core/TimeController"),l=e("../../Core/GameEventDispatcher"),c=e("../../Core/Event"),d=e("../../Core/WindowManager"),p=e("../../Core/WindowType"),h=e("../Scene/UIAnim/VariousAnim"),u=e("../../Core/LoadManager"),f=e("../../Util/Utils"),g=cc._decorator,y=g.ccclass,m=g.property,C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layerContent=null,t.scrollView=null,t.spriteBG=null,t.layerBack=null,t._itemWindowTypeList=[],t._config=null,t._isClose=!1,t._contentListLeft=60,t._contentInterval=25,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this,this.node.setContentSize(o.GlobalContext.UIWidth,o.GlobalContext.UIHeight)},t.prototype.onInitData=function(e){void 0===e&&(e=0),this._windowType=e,this.onShowPage(!0)},t.prototype.show=function(){e.prototype.show.call(this),this._isClose=!1},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),this.layerBack.stopAllActions(),this.node.stopAllActions(),this._isClose=!0,this._windowType=0},t.prototype.onShowPage=function(e){var t=this;void 0===e&&(e=!1);var i=a.default.instance.activityHallList,n=a.default.instance.data.DataSort(i),d=this.scrollView.getContentPosition();this._itemWindowTypeList=[];var p=0;f.default.setNodeChildDestoryByUrl(this.layerContent,o.GlobalContext.Root+"prefab/ActivityHall/ActivityHallItem"),u.default.instance.loadResByType(o.GlobalContext.Root+"prefab/ActivityHall/ActivityHallItem",cc.Prefab,function(i){for(var a=0;a<n.length;a++){var h=f.default.getNodeByUrl(i,o.GlobalContext.Root+"prefab/ActivityHall/ActivityHallItem");h.getComponent(r.default).onInitData(n[a]),h.name="ActivityHallItem"+n[a].windowType,h.getComponent(r.default).getIndex(),t._itemWindowTypeList.push(n[a].windowType),t.layerContent.addChild(h),p=h.width}if(e)if(t._windowType>0){var u=0;for(a=0;a<t._itemWindowTypeList.length;a++)if(t._windowType==t._itemWindowTypeList[a]){u=a;break}var g=(o.GlobalContext.UIWidth-t._contentListLeft)/(p+t._contentInterval);s.default.instance.setTimeout(function(){t.scrollView.scrollToPercentHorizontal(u/(t._itemWindowTypeList.length-g),.1)},t,10)}else s.default.instance.setTimeout(function(){t.scrollView.scrollToLeft()},t,10);else s.default.instance.setTimeout(function(){t.scrollView.setContentPosition(new cc.Vec2(d.x,d.y))},t,10);l.GameEventDispatcher.instance.emit(c.EventDefiner.ActivityCopyUpdateRed)},this)},t.prototype.onDelayAdd=function(e,t,i){var n=this;s.default.instance.setTimeout(function(){n.layerContent.insertChild(e,t),n._itemWindowTypeList.push(i.windowType)},this,20)},t.prototype.onShowEffect=function(){var e=this;this.node.x=o.GlobalContext.UIWidth,this.node.runAction(cc.moveTo(.5,0,0)),h.default.instance.openTwoAnim(function(){e.layerBack.opacity=1,e.layerBack.runAction(cc.fadeTo(.4,255)),e.spriteBG.opacity=255,h.default.instance.initInfo()},this)},t.prototype.onClickBack=function(){d.default.instance.close(p.WindowType.ActivityWin)},t.instance=null,__decorate([m(cc.Node)],t.prototype,"layerContent",void 0),__decorate([m(cc.ScrollView)],t.prototype,"scrollView",void 0),__decorate([m(cc.Node)],t.prototype,"spriteBG",void 0),__decorate([m(cc.Node)],t.prototype,"layerBack",void 0),t=i=__decorate([y],t)}(n.default);i.default=C,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Scene/UIAnim/VariousAnim":"VariousAnim","./ActivityController":"ActivityController","./ActivityHallItem":"ActivityHallItem"}],ActivityReturnController:[function(e,t,i){"use strict";cc._RF.push(t,"9a04f6gRKJBGb+64nJhYjSk","ActivityReturnController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Controller"),o=e("../../../NetConnect/NetConnet"),a=e("./ActivityReturnData"),r=e("../ActivityCtrl"),s=e("../../../Core/GameEventDispatcher"),l=e("./ActivityReturnEvent"),c=e("../../../Core/Event"),d=e("../../../Core/WindowType"),p=cc._decorator,h=p.ccclass,u=(p.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._activityId=5,t._configIndex=1,t._openDay=1,t._config=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this,s.GameEventDispatcher.instance.on(c.EventDefiner.Activity_YunyingUP,this.onActivityInfo,this),this._activityReturnData=new a.default},t.prototype.listNotification=function(){this.addProto("activityrepayflag",this.onMainInfo,this)},t.prototype.sendCmdGetMain=function(){var e={cmd:"activityrepayopenUI",actid:this._activityId};o.default.instance.sendProto(e)},t.prototype.sendCmdGetReward=function(e){var t={cmd:"activityrepayreward",index:e,actid:this._activityId};o.default.instance.sendProto(t)},t.prototype.onMainInfo=function(e){if(this._openDay=e.day>0?e.day:0,this._activityReturnData.onInitData(e.rewardflag,e.conf,this._configIndex,e.condition1,e.condition2),s.GameEventDispatcher.instance.emit(l.ActivityReturnEvent.MainInfo),this.getReturnName){var t=r.default.instance.data.getActivityState(d.WindowType.Loop_ActiveBack);r.default.instance.data.setTabName(t?d.WindowType.Loop_ActiveBack:d.WindowType.ActiveBack,this.getReturnName),r.default.instance.data.setRedFlag(t?d.WindowType.Loop_ActiveBack:d.WindowType.ActiveBack,this._activityReturnData.isCanGetReward)}},t.prototype.onActivityInfo=function(){var e=r.default.instance.data.getActivityState(d.WindowType.ActiveBack),t=r.default.instance.data.getActivityState(d.WindowType.Loop_ActiveBack);(t||e)&&(this._activityId=r.default.instance.data.getYunyingId(t?d.WindowType.Loop_ActiveBack:d.WindowType.ActiveBack),this._configIndex=r.default.instance.data.getYunyingInfo(this._activityId).idx,this.sendCmdGetMain())},Object.defineProperty(t.prototype,"getReturnList",{get:function(){return this._activityReturnData.getReturnList},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"getReturnName",{get:function(){return this._activityReturnData.getReturnName(this._configIndex,this.dayIndex-1>=0?this.dayIndex-1:0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dayIndex",{get:function(){return this._openDay%7+1},enumerable:!0,configurable:!0}),t.instance=null,t=i=__decorate([h],t)}(n.default));i.default=u,cc._RF.pop()},{"../../../Core/Controller":"Controller","../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/WindowType":"WindowType","../../../NetConnect/NetConnet":"NetConnet","../ActivityCtrl":"ActivityCtrl","./ActivityReturnData":"ActivityReturnData","./ActivityReturnEvent":"ActivityReturnEvent"}],ActivityReturnData:[function(e,t,i){"use strict";cc._RF.push(t,"a0654xZw2BD/p2ryjmh12wf","ActivityReturnData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./ActivityReturnItemData"),o=e("../../../Core/ConfigsManager"),a=cc._decorator,r=a.ccclass,s=(a.property,function(){function e(){this._activityReturnList=[],this._isCanGet=!1,this._config=o.ConfigsManager.instance.getConfigs("ActivityRepayConf")}return e.prototype.onInitData=function(e,t,i,o,a){if(this._activityReturnList=[],this._isCanGet=!1,t){for(var r=t,s=0;s<r.length;s++){var l=new n.default;l.onInitData(r[s],e[s]?2:null,s,o,a),this._activityReturnList.push(l),1==l.getRewardType&&(this._isCanGet=!0)}for(s=0;s<this._activityReturnList.length;s++)for(var c=s;c<this._activityReturnList.length;c++)if(this._activityReturnList[s].sortIndex>this._activityReturnList[c].sortIndex){var d=this._activityReturnList[s];this._activityReturnList[s]=this._activityReturnList[c],this._activityReturnList[c]=d}}},Object.defineProperty(e.prototype,"getReturnList",{get:function(){return this._activityReturnList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCanGetReward",{get:function(){return this._isCanGet},enumerable:!0,configurable:!0}),e.prototype.getReturnName=function(e,t){return this._config.day[e].length>t?this._config.day[e][t].gradeName:null},e=__decorate([r],e)}());i.default=s,cc._RF.pop()},{"../../../Core/ConfigsManager":"ConfigsManager","./ActivityReturnItemData":"ActivityReturnItemData"}],ActivityReturnEvent:[function(e,t,i){"use strict";cc._RF.push(t,"8f81cYc0o5Eg4abJpQEdirt","ActivityReturnEvent"),Object.defineProperty(i,"__esModule",{value:!0}),function(e){e.MainInfo="MainInfo"}(i.ActivityReturnEvent||(i.ActivityReturnEvent={})),cc._RF.pop()},{}],ActivityReturnItemData:[function(e,t,i){"use strict";cc._RF.push(t,"87d24Mw6L9H5763Lr0wOqN2","ActivityReturnItemData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Language"),o=cc._decorator,a=o.ccclass,r=(o.property,function(){function e(){this._rewardId=0,this._typeName="",this._type=1,this._condition=0,this._rewardType=1,this._statusDesc="",this._index=0,this._sortIndex=0,this._conditionUp=0,this._conditionTo=0}return e.prototype.onInitData=function(e,t,i,o,a){switch(this._rewardId=e.reward,this._condition=e.condition,this._index=i,this._typeName=n.default.getStr1(e.typeName,[e.condition]),this._type=e.type,this._conditionUp=o,this._conditionTo=a,2==t?this._rewardType=t:2==e.kind?this._rewardType=this._conditionTo>=e.condition?1:0:1==e.kind?this._rewardType=this._conditionUp>=e.condition?1:0:this._rewardType=0,this._rewardType){case 1:this._sortIndex=this._index;break;case 0:this._sortIndex=1e3+this._index;break;case 2:this._sortIndex=2e3+this._index}var r=2==e.kind?this._conditionTo:this._conditionUp;this._statusDesc=n.default.getStr("activity_return_status_desc",r>=0?r:0,this._condition)},Object.defineProperty(e.prototype,"getStatusDesc",{get:function(){return this._statusDesc},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getRewardId",{get:function(){return this._rewardId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getTypeName",{get:function(){return this._typeName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getType",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getCondition",{get:function(){return this._condition},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getRewardType",{get:function(){return this._rewardType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getIndex",{get:function(){return this._index},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sortIndex",{get:function(){return this._sortIndex},enumerable:!0,configurable:!0}),e=__decorate([a],e)}());i.default=r,cc._RF.pop()},{"../../../Core/Language":"Language"}],ActivityReturnItem:[function(e,t,i){"use strict";cc._RF.push(t,"21b0cOV0B5FbJnVVJCX/nYH","ActivityReturnItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../Commons/RewardUtils"),a=e("../../../Util/Utils"),r=e("../../../Core/WindowType"),s=e("../../Item/ItemIcon"),l=e("../../OpenWin/OpenWinController"),c=e("./ActivityReturnController"),d=e("../../../Core/GameEventDispatcher"),p=e("../../Status/StatusType"),h=e("../../../Core/Event"),u=e("../../Totems/TotemsConst"),f=e("../../../Util/GrayEffect"),g=e("../../../Core/LoadManager"),y=e("../../../GlobalContext"),m=cc._decorator,C=m.ccclass,v=m.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.contentList=null,t.richText=null,t.labelDesc=null,t.nodeButton=[],t._itemData=null,t}return __extends(t,e),t.prototype.onInitData=function(e){this._itemData=e,this.onShowPage()},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),this.onClearItem()},t.prototype.onClearItem=function(){for(var e=this.contentList.childrenCount-1;e>=0;e--)a.default.setNodeToPool(r.PoolType.ItemIcon,this.contentList.children[e]);this.contentList.removeAllChildren()},t.prototype.onShowPage=function(){var e=this;switch(this.onClearItem(),g.default.instance.loadResByType(y.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(t){var i=o.default.instance.getItemList(e._itemData.getRewardId);for(var n in i){var l=a.default.getNodeByPool(r.PoolType.ItemIcon,t,y.GlobalContext.Root+"prefab/Bag/ItemIcon");l.scale=.8,l.getComponent(s.default).ItemData(i[n],!0,null,!0),e.contentList.addChild(l)}},this),this.labelDesc.string=this._itemData.getTypeName+"",this.richText.string=this._itemData.getStatusDesc+"",a.default.setNodeActive(this.nodeButton,null),this._itemData.getRewardType){case 0:this.nodeButton[1].active=!0,this.nodeButton[1].getComponent(cc.Button).interactable=!1,this.nodeButton[1].getChildByName("Background").getComponent(f.default).setGray(!0);break;case 1:this.nodeButton[1].active=!0,this.nodeButton[1].getComponent(cc.Button).interactable=!0,this.nodeButton[1].getChildByName("Background").getComponent(f.default).setGray(!1);break;case 2:this.nodeButton[2].active=!0}},t.prototype.onClilckReward=function(){c.default.instance.sendCmdGetReward(this._itemData.getIndex)},t.prototype.onClickGoTo=function(){switch(this._itemData.getType){case 1:d.GameEventDispatcher.instance.emit(h.EventDefiner.ChangeActivityStatus,p.ActivityStatus.Chapter);break;case 2:l.default.instance.openWindow(r.WindowType.WarTeam);break;case 3:l.default.instance.openWindow(r.WindowType.Artifact);break;case 4:l.default.instance.openWindow(r.WindowType.Totems,function(){d.GameEventDispatcher.instance.emit(h.EventDefiner.ToeamsJumpPage,u.TotemsPageType.Strengthen)},this);break;case 5:l.default.instance.openWindow(r.WindowType.DrawCard);break;case 6:case 7:l.default.instance.openWindow(r.WindowType.WarTeam)}},__decorate([v(cc.Node)],t.prototype,"contentList",void 0),__decorate([v(cc.RichText)],t.prototype,"richText",void 0),__decorate([v(cc.Label)],t.prototype,"labelDesc",void 0),__decorate([v(cc.Node)],t.prototype,"nodeButton",void 0),t=__decorate([C],t)}(n.default);i.default=_,cc._RF.pop()},{"../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/LoadManager":"LoadManager","../../../Core/Widget":"Widget","../../../Core/WindowType":"WindowType","../../../GlobalContext":"GlobalContext","../../../Util/GrayEffect":"GrayEffect","../../../Util/Utils":"Utils","../../Commons/RewardUtils":"RewardUtils","../../Item/ItemIcon":"ItemIcon","../../OpenWin/OpenWinController":"OpenWinController","../../Status/StatusType":"StatusType","../../Totems/TotemsConst":"TotemsConst","./ActivityReturnController":"ActivityReturnController"}],ActivityReturnView:[function(e,t,i){"use strict";cc._RF.push(t,"e914cdWfx1N3I4TWJu0Ws4R","ActivityReturnView"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../Commons/ListViewCtrl"),a=e("./ActivityReturnController"),r=e("../../../Core/GameEventDispatcher"),s=e("./ActivityReturnEvent"),l=e("./ActivityReturnItem"),c=e("../../Commons/Image"),d=e("../../../GlobalContext"),p=e("../../../Core/Event"),h=cc._decorator,u=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.contentList=null,t.lsitViewCtrl=null,t.spriteTitle=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),r.GameEventDispatcher.instance.on(s.ActivityReturnEvent.MainInfo,this.onShowPage,this),a.default.instance.sendCmdGetMain(),r.GameEventDispatcher.instance.emit(p.EventDefiner.Activity_countdown,this)},t.prototype.hide=function(){e.prototype.hide.call(this),r.GameEventDispatcher.instance.off(s.ActivityReturnEvent.MainInfo,this.onShowPage,this)},t.prototype.onShowPage=function(){this.contentList.removeAllChildren(),this.setData(a.default.instance.getReturnList),this.spriteTitle.getComponent(c.default).loadImageByHttps(d.GlobalContext.ResRoot+"resources/Activity/OpenService/ActivityReturn/bg_hdfh"+a.default.instance.dayIndex+".png")},t.prototype.setData=function(e){this.lsitViewCtrl.refreshItem=this.updateitem,this.lsitViewCtrl.refreshItemThis=this,this.lsitViewCtrl.initialize(e),this.lsitViewCtrl.scrollToTop()},t.prototype.updateitem=function(e,t){var i=this.lsitViewCtrl.dataLsit[t];e.getComponent(l.default).onInitData(i)},__decorate([f(cc.Node)],t.prototype,"contentList",void 0),__decorate([f(o.default)],t.prototype,"lsitViewCtrl",void 0),__decorate([f(cc.Node)],t.prototype,"spriteTitle",void 0),t=__decorate([u],t)}(n.default);i.default=g,cc._RF.pop()},{"../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Widget":"Widget","../../../GlobalContext":"GlobalContext","../../Commons/Image":"Image","../../Commons/ListViewCtrl":"ListViewCtrl","./ActivityReturnController":"ActivityReturnController","./ActivityReturnEvent":"ActivityReturnEvent","./ActivityReturnItem":"ActivityReturnItem"}],ActivityView:[function(e,t,i){"use strict";cc._RF.push(t,"14622Hj0vFNvpcmWjRiei1a","ActivityView"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("./ActivityCtrl"),a=e("./ActivityCfg"),r=e("../../Core/LoadManager"),s=e("../../Core/TimeController"),l=e("../../Core/GameEventDispatcher"),c=e("../../Core/Event"),d=e("../OpenWin/OpenWinController"),p=e("../../Core/WindowType"),h=e("../Commons/RewardUtils"),u=e("../Tips/RewardTips"),f=e("../Functionicon/UtilsFunClick"),g=e("../Commons/ListViewCtrl"),y=e("../../Util/DateUtil"),m=e("../../Util/Utils"),C=cc._decorator,v=C.ccclass,_=C.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.leftNode=null,t.tabBtnNode=null,t.rightNode=null,t.commonDrap1=null,t.activityTimeNode=null,t._windowIDList=[],t._selectIndex=null,t._viewWindowIDMap={},t._showViewID=null,t._viewNodeMap={},t.timeOut=null,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.show=function(){e.prototype.show.call(this);var t=o.default.instance.data.getActivityType();this._windowIDList=o.default.instance.data.getOpenActivityIDs(t),this.setLeftData(),this.setTabBtn(0),this.setBG(),l.GameEventDispatcher.instance.on(c.EventDefiner.Activity_YunyingUP,this.upSHow,this),l.GameEventDispatcher.instance.on(c.EventDefiner.rewardpanel_showEffect,this.playEffect,this),l.GameEventDispatcher.instance.on(c.EventDefiner.Activity_upTabRed,this.upTabRed,this),l.GameEventDispatcher.instance.on("SETLEFTDATA",this.upTabNmae,this),l.GameEventDispatcher.instance.on(c.EventDefiner.Activity_countdown,this.TimeOut,this),l.GameEventDispatcher.instance.on(c.EventDefiner.Activity_resetTimeout,this.resetTimeout,this)},t.prototype.hide=function(){this._selectIndex=null,this.reset(),this.resetTimeout(),e.prototype.hide.call(this),l.GameEventDispatcher.instance.off(c.EventDefiner.Activity_YunyingUP,this.upSHow,this),l.GameEventDispatcher.instance.off(c.EventDefiner.rewardpanel_showEffect,this.playEffect,this),l.GameEventDispatcher.instance.off(c.EventDefiner.Activity_upTabRed,this.upTabRed,this),l.GameEventDispatcher.instance.off("SETLEFTDATA",this.upTabNmae,this),l.GameEventDispatcher.instance.off(c.EventDefiner.Activity_countdown,this.TimeOut,this),l.GameEventDispatcher.instance.off(c.EventDefiner.Activity_resetTimeout,this.resetTimeout,this)},t.prototype.resetTimeout=function(){this.timeOut&&clearInterval(this.timeOut),this.timeOut=null},t.prototype.reset=function(){this.leftNode.getChildByName("TabbTnList").getComponent(cc.ScrollView).content.removeAllChildren(),this.rightNode.removeAllChildren(),this._viewWindowIDMap={},this._viewNodeMap={},this._showViewID=null,this._windowIDList=[]},t.prototype.upSHow=function(){this.reset();var e=o.default.instance.data.getActivityType();this._windowIDList=o.default.instance.data.getOpenActivityIDs(e),this.setLeftData(),this.setTabBtn(this._selectIndex?this._selectIndex:0)},t.prototype.setLeftData=function(){var e=this.node.getChildByName("ListViewCtrl");e.getComponent(g.default).refreshItem=this.updateitem,e.getComponent(g.default).refreshItemThis=this,e.getComponent(g.default).initialize(this._windowIDList),e.getComponent(g.default).scrollToTop()},t.prototype.updateitem=function(e,t){var i=this.commonDrap1.getSpriteFrame("btn_fenye1"),n=e.getChildByName("tabBtn");n.getComponent(cc.Sprite).spriteFrame=i;n.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=null;var a=o.default.instance.data.getTabName(this._windowIDList[t]);n.getChildByName("Label").getComponent(cc.Label).string=a,e.getChildByName("red").active=!1,this._viewWindowIDMap[t]=this._windowIDList[t];var r=o.default.instance.data.getRedFlag(this._windowIDList[t]);e.getChildByName("red").active=r},t.prototype.setRightShow=function(e){var t=this;if(e){if(this._viewNodeMap[this._showViewID]&&(this._viewNodeMap[this._showViewID].active=!1),!this._viewNodeMap[e]){var i=a.default.instance.getPrefabURL(e);r.default.instance.loadResByType(i,cc.Prefab,function(n){if(!t._viewNodeMap[e]){var o=m.default.getNodeByUrl(n,i);t.rightNode.addChild(o),t._viewNodeMap[e]=o,t._showViewID||(t._showViewID=e);var a=t._showViewID==e;t._viewNodeMap[e].active=a}},this)}this._showViewID=e,this._viewNodeMap[this._showViewID]&&(this._viewNodeMap[this._showViewID].active=!0)}},t.prototype.onClickTabBtn=function(e){var t=e.currentTarget.parent.getSiblingIndex();if(this._selectIndex!=t){this.setTabBtn(t);var i=this.getWindowID(t);f.default.instance.onClickWin(i)}},t.prototype.setTabBtn=function(e){this.selectTabBtn(e);var t=this.getWindowID(e);this.setRightShow(t)},t.prototype.selectTabBtn=function(e){var t=this.leftNode.getChildByName("TabbTnList").getComponent(cc.ScrollView).content;t.children[this._selectIndex]&&(t.children[this._selectIndex].getChildByName("tabBtn").getComponent(cc.Sprite).spriteFrame=this.commonDrap1.getSpriteFrame("btn_fenye1"));(this._selectIndex=e,t.children[this._selectIndex])&&(t.children[this._selectIndex].getChildByName("tabBtn").getComponent(cc.Sprite).spriteFrame=this.commonDrap1.getSpriteFrame("btn_fenye1_HL"))},t.prototype.upTabNmae=function(){var e=this.leftNode.getChildByName("TabbTnList").getComponent(cc.ScrollView).content;for(var t in this._viewWindowIDMap){var i=o.default.instance.data.getTabName(this._windowIDList[t]);e.children[t].getChildByName("tabBtn").getChildByName("Label").getComponent(cc.Label).string=i}},t.prototype.getIndex=function(e){var t=0;for(var i in this._viewWindowIDMap)this._viewWindowIDMap[i]==e&&(t=parseInt(i));return t},t.prototype.getWindowID=function(e){return this._viewWindowIDMap[e]},t.prototype.setRed=function(e){var t=this.getIndex(e),i=o.default.instance.data.getRedFlag(e);this.node.getChildByName("ListViewCtrl").getComponent(g.default).items[t].getChildByName("red").active=i},t.prototype.upTabRed=function(e){var t=e.getUserData().winID;t&&this.setRed(t)},t.prototype.setBG=function(){var e="resources/Activity/Bg/bg_0"+o.default.instance.data.getActivityType()+".png";m.default.setImage(this.node.getChildByName("bg"),e)},t.prototype.setTabBtnByWindowID=function(e){var t=this.getIndex(e);this.setTabBtn(t),this.setRightShow(e)},t.prototype.setActivityTime=function(e,t){void 0===t&&(t=cc.color(211,0,0,255)),this.activityTimeNode.active=!(!e||""==e);var i=this.activityTimeNode.getChildByName("Node").getChildByName("time");i.getComponent(cc.Label).string=e,i.color=t},t.prototype.TimeOut=function(){var e=this;this.resetTimeout();var t=s.default.instance.ServerTimeMins,i=Date.parse(new Date(new Date(new Date(s.default.instance.ServerTimeMins).toLocaleDateString()).getTime()+864e5-1).toString());this.setActivityTime(y.DateUtil.setTimeToChineseHMStrTwo(i-t)),this.timeOut=s.default.instance.setInterval(function(){t+=1e3,e.setActivityTime(y.DateUtil.setTimeToChineseHMStrTwo(i-t))},this,1e3)},t.prototype.playEffect=function(e){var t=e.getUserData().data;109!=t.paneltype&&108!=t.paneltype||d.default.instance.openWindow(p.WindowType.RewardTips,function(){u.default.instance.setData(h.default.instance.getItemListByServerData(t.reward))})},t.instance=null,__decorate([_(cc.Node)],t.prototype,"leftNode",void 0),__decorate([_(cc.Node)],t.prototype,"tabBtnNode",void 0),__decorate([_(cc.Node)],t.prototype,"rightNode",void 0),__decorate([_(cc.SpriteAtlas)],t.prototype,"commonDrap1",void 0),__decorate([_(cc.Node)],t.prototype,"activityTimeNode",void 0),t=i=__decorate([v],t)}(n.default);i.default=b,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/Window":"Window","../../Core/WindowType":"WindowType","../../Util/DateUtil":"DateUtil","../../Util/Utils":"Utils","../Commons/ListViewCtrl":"ListViewCtrl","../Commons/RewardUtils":"RewardUtils","../Functionicon/UtilsFunClick":"UtilsFunClick","../OpenWin/OpenWinController":"OpenWinController","../Tips/RewardTips":"RewardTips","./ActivityCfg":"ActivityCfg","./ActivityCtrl":"ActivityCtrl"}],ActorPools:[function(e,t,i){"use strict";cc._RF.push(t,"b8a44t+RSNC5KkZYmMP6Zw4","ActorPools"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Monster"),o=e("../../../Core/Widget"),a=e("../Player"),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.createPlayer=function(e){return e?((t=this._playerPool.size()>0?this._playerPool.get():cc.instantiate(this.playerPre)).opacity=255,t.getComponent(a.Player).prop=e,t.getComponent(a.Player).handle=e.handle,t.active=!0,t):null;var t},t.recoverPlayer=function(e){return e&&(e.parent&&(e.getComponent(a.Player).clear(),e.removeFromParent(!1)),e.active=!1,this._playerPool.put(e)),e},t.returnMonster=function(e){if(0!=e.spineId){var t=void 0;return(t=this._monsterPool.size()>0?this._monsterPool.get():cc.instantiate(this.monsterPre)).opacity=255,t.getComponent(n.default).prop=e,t.getComponent(n.default).handle=e.handle,t.active=!0,t}return null},t.recoverMonster=function(e){return e&&(e.parent&&(e.getComponent(n.default).clear(),e.removeFromParent(!1)),e.active=!1,this._monsterPool.put(e)),e},t.clearAll=function(){this._playerPool.clear(),this._monsterPool.clear()},t.errorSitActorHandle="null",t.monsterPre=null,t.playerPre=null,t._playerPool=new cc.NodePool,t._monsterPool=new cc.NodePool,t}(o.default);i.ActorPools=r,cc._RF.pop()},{"../../../Core/Widget":"Widget","../Monster":"Monster","../Player":"Player"}],ActorsBigSkillLayer:[function(e,t,i){"use strict";cc._RF.push(t,"2f09daKzE5GuYu6sjfh9+L8","ActorsBigSkillLayer"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../Skill/BigSkillIcon"),a=e("../../../GlobalContext"),r=e("../../../Core/LoadManager"),s=e("../../Status/StatusType"),l=e("../Controller/SkillController"),c=e("../../../Global/GlobalValue"),d=e("../Manager/SceneManager"),p=e("../Unit/FightLog"),h=e("../Controller/FightTimeController"),u=e("../../../Core/TimeController"),f=e("../../WarTeam/MonsterController"),g=e("../../../Util/Utils"),y=e("../Controller/GuideFightController"),m=e("../../../Core/WindowType"),C=e("../../../Core/GameEventDispatcher"),v=e("../../../Core/Event"),_=e("../../Artifact/ArtifactCtrl"),b=e("../Controller/SceneController"),T=e("../../Guide/GuideNewController"),S=e("../../Fight/fightlogic"),I=e("../../SandTable/SandTableMain"),w=cc._decorator,D=w.ccclass,R=w.property,A=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pre=null,t.isInited=!1,t.prepool=new cc.NodePool,t.hasBigEntityDicLsit={},t.skillNodeDic={},t.updateBigInfoTime=0,t.listcontain=null,t.fightActiveSkill=null,t.isShow=!0,t.autoUseBigSkillHandle={},t.delayAutoUseSkills=[],t.delayTime=0,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){this.node.width=a.GlobalContext.StageWidth,i.instance=this,this.fightActiveSkill.active=!1},t.prototype.start=function(){e.prototype.start.call(this),C.GameEventDispatcher.instance.on(v.EventDefiner.C_Fight_Start,this.setFightActiveSkill,this),C.GameEventDispatcher.instance.on(v.EventDefiner.ChangeGameScene,this.setRoleSkill,this)},t.prototype.setFightActiveSkill=function(){this.fightActiveSkill.active=s.ActivityStatus.Arena!=s.ActivityStatus.value&&!!_.default.instance.getData().illusionSkillId},t.prototype.clearUpdateBigInfoTime=function(){this.isShow=!0,this.updateBigInfoTime>0&&(u.default.instance.clearInterval(this.updateBigInfoTime),this.updateBigInfoTime=0)},t.prototype.setRoleSkill=function(){var e=this;b.default.instance.scenestatus==c.GameScene.Fight&&_.default.instance.getData().getSkillIndex()&&this.fightActiveSkill.childrenCount<=0&&r.default.instance.loadResByType(a.GlobalContext.Root+"prefab/fightinfopanel/FightActiveSkill",cc.Prefab,function(t){var i=g.default.getNodeByPool(m.PoolType.FightActiveSkill,t,a.GlobalContext.Root+"prefab/fightinfopanel/FightActiveSkill");e.fightActiveSkill.addChild(i)},this)},t.prototype.isHaveCard=function(){var e=f.MonsterType.MonsterWarTeam[f.MonsterType.MonsterBattle],t=!1;for(var i in this.hasBigEntityDicLsit)if(this.hasBigEntityDicLsit.hasOwnProperty(i)&&-1==e.indexOf(parseInt(i))){t=!0;break}return t},t.prototype.getIsRein=function(){var e=!1;for(var t in this.hasBigEntityDicLsit)if(this.hasBigEntityDicLsit[t][0].monster.prop.addtype==c.ADD_ACTOR_TYPE.REINFORCEMENTS){e=!0;break}return e},t.prototype.updateBigInfo=function(){if(this.getIsRein()){var e=0;for(var t in this.hasBigEntityDicLsit)this.hasBigEntityDicLsit.hasOwnProperty(t)&&(this.skillNodeDic[e]?this.hasBigEntityDicLsit[t][0].monster.skillCanUse(this.hasBigEntityDicLsit[t][0].skillid)&&(y.default.instance.guideskill>=0||this.isHaveCard()||this.getIsRein())?(this.skillNodeDic[e].active!=this.isShow&&(this.skillNodeDic[e].active=this.isShow),this.skillNodeDic[e].getComponent(o.default).setData(this.hasBigEntityDicLsit[t][0].monster,this.hasBigEntityDicLsit[t][0].skillid,this.hasBigEntityDicLsit[t][0].skilllv)):this.skillNodeDic[e].active&&(this.skillNodeDic[e].active=!1):this.addSkillBigIcon(this.hasBigEntityDicLsit[t][0].monster,this.hasBigEntityDicLsit[t][0].skillid,this.hasBigEntityDicLsit[t][0].skilllv,this.hasBigEntityDicLsit[t][0].autoUseBigSkill,e,!1),e++)}else if(s.ActivityStatus.value==s.ActivityStatus.Guide||this.isHaveCard()){for(var t in this.hasBigEntityDicLsit)if(this.hasBigEntityDicLsit.hasOwnProperty(t)){e=0;this.skillNodeDic[e]?this.hasBigEntityDicLsit[t][0].monster.skillCanUse(this.hasBigEntityDicLsit[t][0].skillid)&&(y.default.instance.guideskill>=0||this.isHaveCard()||this.getIsRein())?(this.skillNodeDic[e].active!=this.isShow&&(this.skillNodeDic[e].active=this.isShow),this.skillNodeDic[e].getComponent(o.default).setData(this.hasBigEntityDicLsit[t][0].monster,this.hasBigEntityDicLsit[t][0].skillid,this.hasBigEntityDicLsit[t][0].skilllv)):this.skillNodeDic[e].active&&(this.skillNodeDic[e].active=!1):this.addSkillBigIcon(this.hasBigEntityDicLsit[t][0].monster,this.hasBigEntityDicLsit[t][0].skillid,this.hasBigEntityDicLsit[t][0].skilllv,this.hasBigEntityDicLsit[t][0].autoUseBigSkill,e,!1)}}else{for(var n=f.MonsterType.MonsterWarTeam[f.MonsterType.MonsterBattle],a=0,r=0;r<n.length;r++){t=n[r];var l=[];if(this.hasBigEntityDicLsit[t])for(var c=0;c<this.hasBigEntityDicLsit[t].length;c++)this.hasBigEntityDicLsit[t][c].monster.isLive&&this.hasBigEntityDicLsit[t][c].monster.skillCanUse(this.hasBigEntityDicLsit[t][c].skillid)&&l.push(this.hasBigEntityDicLsit[t][c]);l.length>0?(l.sort(function(e,t){return e.monster.prop.grade-t.monster.prop.grade}),l.sort(function(e,t){return e.monster.hp/e.monster.prop.maxHP-t.monster.hp/t.monster.prop.maxHP}),this.skillNodeDic[r]?(this.skillNodeDic[r].active||(this.skillNodeDic[r].active=!0),this.skillNodeDic[r].getComponent(o.default).setData(l[0].monster,l[0].skillid,l[0].skilllv)):this.addSkillBigIcon(l[0].monster,l[0].skillid,l[0].skilllv,l[0].autoUseBigSkill,r,!1),a++):this.skillNodeDic[r]&&(this.skillNodeDic[r].getComponent(o.default).recovery(),i.instance.recycle(this.skillNodeDic[r]),delete this.skillNodeDic[r],I.default.instance&&I.default.instance.isHaveMasSenior&&T.default.instance.curGuideSkip())}a||this.clearUpdateBigInfoTime()}this.listcontain.active=this.listcontain.childrenCount>0},t.prototype.loadComplete=function(e){this.pre=e,this.isInited=!0,this.updateBigInfo()},t.prototype.addSkillBigIcon=function(e,t,i,n,p,h){if(void 0===n&&(n=!0),void 0===p&&(p=0),void 0===h&&(h=!0),s.ActivityStatus.value!=s.ActivityStatus.Guide||26==e.prop.cardid){var u=l.default.instance.getSkillBySkillId(t);if(void 0!==u.effectTypeName&&r.default.instance.loadResByType(a.GlobalContext.Root+c.SPINE_RES_DIR+"monster/"+e.prop.spineId+"/"+u.effectTypeName,sp.SkeletonData,null,null),s.ActivityStatus.value!=s.ActivityStatus.Arena)if(n&&s.ActivityStatus.value!=s.ActivityStatus.Guide&&this.addAutoOneSkill(t,i,e),e.prop.copyEntity&&s.ActivityStatus.value!=s.ActivityStatus.Guide)this.setUpdateBigInfoTime();else if(e.prop.selfMonster){var f={monster:e,skillid:t,skilllv:i,autoUseBigSkill:n};if(h&&(this.hasBigEntityDicLsit[e.prop.cardid]||(this.hasBigEntityDicLsit[e.prop.cardid]=[]),this.hasBigEntityDicLsit[e.prop.cardid].push(f),this.setUpdateBigInfoTime()),this.isInited){var y;if(d.default.instance.fightstatus==d.FIGHTSTATUS.FIGHT)(y=this.prepool.size()>0?this.prepool.get():g.default.getNodeByUrl(this.pre,a.GlobalContext.Root+"prefab/bigskillicon/BigSkillIcon")).getComponent(o.default).setData(e,t,i),y.active=!1,y.x=100-100*p,this.listcontain.addChild(y),this.skillNodeDic[p]=y,C.GameEventDispatcher.instance.emit(v.EventDefiner.C_SetBigSkill)}else{var m=a.GlobalContext.Root+"prefab/bigskillicon/BigSkillIcon";r.default.instance.loadResByType(m,cc.Prefab,this.loadComplete,this)}}}},t.prototype.setUpdateBigInfoTime=function(){this.updateBigInfoTime<=0&&(this.updateBigInfoTime=u.default.instance.setInterval(this.updateBigInfo,this,100))},t.prototype.dispose=function(){this.clearAllIcons(),e.prototype.dispose.call(this)},t.prototype.clear=function(){for(var e in this.hasBigEntityDicLsit={},this.fightActiveSkill.active=!1,this.clearAllIcons(),this.clearUpdateBigInfoTime(),this.skillNodeDic)this.skillNodeDic[e].getComponent(o.default).recovery(),i.instance.recycle(this.skillNodeDic[e]);this.skillNodeDic={}},t.prototype.recycle=function(e){this.prepool.put(e)},t.prototype.clearAllIcons=function(){for(;this.listcontain.childrenCount>0;)this.listcontain.children[0].getComponent(o.default).recovery(),i.instance.recycle(this.listcontain.children[0]);this.clearAllAutoSkill()},t.prototype.addAutoOneSkill=function(e,t,i){if(i.skillCanUse(e)&&0==(i.prop.status&S.StateBit.Dizzy)){var n=l.default.instance.getSkillBySkillId(e);if(!n.autoUseParams)return;var o=n.autoUseParams[0],a={skillid:e,skilllv:t,entity:i,type:o.type,param:o.value1,time:o.value1};this.autoUseBigSkillHandle[i.prop.handle+"_"+e]=a,p.default.log(i.prop.originalName+"\u6dfb\u52a0\u81ea\u52a8\u4f7f\u7528\u6280\u80fd: "+e,t,this.autoUseBigSkillHandle)}},t.prototype.updateSkillTime=function(e){if(0!=e&&(this.delayTime-=e,!(this.delayTime>0)&&d.default.instance.specialskillstatus==c.SPECIAL_SKILL_STATUS.NONE&&d.default.instance.fightstatus==d.FIGHTSTATUS.FIGHT))for(var t in this.autoUseBigSkillHandle){var i=this.autoUseBigSkillHandle[t],n=d.default.instance.fightlogic.getFightEntityByHandle(i.entity.prop.handle);if(n&&n.attr.buff.IsHasBuffByType(c.BuffType.Silence)){p.default.log("\u6c89\u9ed8\u4e2d,\u81ea\u52a8\u91ca\u653e\u5927\u62db\u9700\u6c89\u9ed8\u7ed3\u675f");break}if(i.entity.isLive)switch(i.type){case 1:i.param-=e,s.ActivityStatus.value==s.ActivityStatus.LoardCrusade&&C.GameEventDispatcher.instance.emit("setProgressBar",{curr:i.param,max:i.time}),i.param<=0&&this.delayTime<=0&&(this.userSkill(i,t),i.param=i.time,this.delayTime=1800);break;case 2:for(var o=0,a=i.entity.selfMonster?d.default.instance.leftlives:d.default.instance.rightlives;o<a.length;o++){var r=a[o];if(r.hp/r.maxHP<=i.param/100&&this.delayTime<=0){this.userSkill(i,t),i.param=i.time,this.delayTime=1800;break}}break;case 3:i.entity.prop.hp/i.entity.prop.maxHP<=i.param/100&&this.delayTime<=0&&(this.userSkill(i,t),i.param=i.time,this.delayTime=1800)}else this.autoUseBigSkillHandle[t]&&(delete this.autoUseBigSkillHandle[t],p.default.log("\u602a\u7269\u6b7b\u4ea1\u79fb\u9664\u81ea\u52a8\u4f7f\u7528\u6280\u80fd: "+t))}},t.prototype.userSkill=function(e,t){e&&e.entity?e.entity.skillCanUse(e.skillid)?(e.entity.useInitiativeSkill(e.skillid,e.skilllv,!0),e.entity.prop.openautobigskill=!0):h.default.instance.hasInterval("autousebigskill"+e.skillid)?e.entity.oneWarCanUseSkill(e.skillid)||(h.default.instance.clearInterval("autousebigskill"+e.skillid),delete this.autoUseBigSkillHandle[t]):h.default.instance.setInterval("autousebigskill"+e.skillid,this.userSkill,this,1e3,[e,t]):h.default.instance.clearInterval("autousebigskill"+e.skillid)},t.prototype.clearAllAutoSkill=function(){for(var e in this.autoUseBigSkillHandle)delete this.autoUseBigSkillHandle[e];this.delayAutoUseSkills=[],this.delayTime=0},__decorate([R(cc.Node)],t.prototype,"listcontain",void 0),__decorate([R(cc.Node)],t.prototype,"fightActiveSkill",void 0),t=i=__decorate([D],t)}(n.default);i.default=A,cc._RF.pop()},{"../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/LoadManager":"LoadManager","../../../Core/TimeController":"TimeController","../../../Core/Widget":"Widget","../../../Core/WindowType":"WindowType","../../../Global/GlobalValue":"GlobalValue","../../../GlobalContext":"GlobalContext","../../../Util/Utils":"Utils","../../Artifact/ArtifactCtrl":"ArtifactCtrl","../../Fight/fightlogic":"fightlogic","../../Guide/GuideNewController":"GuideNewController","../../SandTable/SandTableMain":"SandTableMain","../../Skill/BigSkillIcon":"BigSkillIcon","../../Status/StatusType":"StatusType","../../WarTeam/MonsterController":"MonsterController","../Controller/FightTimeController":"FightTimeController","../Controller/GuideFightController":"GuideFightController","../Controller/SceneController":"SceneController","../Controller/SkillController":"SkillController","../Manager/SceneManager":"SceneManager","../Unit/FightLog":"FightLog"}],ActorsLayer:[function(e,t,i){"use strict";cc._RF.push(t,"20cf7gOMvVK6ajH+kOdA49J","ActorsLayer"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../LayerableCompent"),o=e("../Monster"),a=e("../../../Core/TimeController"),r=e("../Animal"),s=e("../Manager/SceneManager"),l=e("../Effect/AttackEffectUtils"),c=e("../Controller/FightController"),d=e("../../../Global/GlobalValue"),p=e("../Controller/FightTimeController"),h=e("../Controller/SpecialSkillEffectController"),u=e("./ActorsBigSkillLayer"),f=e("../Controller/ZFController"),g=cc._decorator,y=g.ccclass,m=(g.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.entities=[],t._monsters=[],t}var i;return __extends(t,e),i=t,Object.defineProperty(t.prototype,"monsters",{get:function(){return this._monsters},enumerable:!0,configurable:!0}),t.prototype.start=function(){e.prototype.start.call(this),i.instance=this},t.prototype.dispose=function(){this.clearAllEntities(!0),e.prototype.dispose.call(this)},t.prototype.clear=function(){this.clearAllEntities(!1)},t.prototype.getSceneEntity=function(e){return this.entities[e]},t.prototype.addActorObj_toScene=function(e){this.addChildAtLayer(e,e.y),this.entities[e.prop.handle]=e,e instanceof o.default&&this.monsters.push(e)},t.prototype.removeActorObj_fromScene=function(e){var t=this.entities[e];if(delete this.entities[e],t instanceof o.default&&this.monsters.indexOf(t)>=0&&this.monsters.splice(this.monsters.indexOf(t),1),t){if(t.isDraging)return void a.default.instance.setTimeout(this.removeNow,this,200,t);this.removeNow(t)}},t.prototype.removeNow=function(e){e.recovery()},t.prototype.clearAllEntities=function(e){var t;for(var i in void 0===e&&(e=!1),this.entities)(t=this.entities[i]).node.parent&&t.node.parent==this.node&&t instanceof r.default&&this.removeNow(t);this.entities=[],this.monsters.length=0,1==e&&(s.default.instance.myRole=null),this.node.destroyAllChildren()},t.prototype.updateData=function(e,t){c.default.instance.checkWaitSkillResultList(),this.updateEntities(e,t),s.default.instance.specialskillstatus==d.SPECIAL_SKILL_STATUS.NONE&&(p.default.instance.updateTime(e),c.default.instance.updateData(e),u.default.instance.updateSkillTime(e),f.default.instance.update(e))},t.prototype.updateActorsSit=function(e,t){},t.prototype.showentitys=function(){for(var e in this.entities){this.entities[e].node.active=!0}},t.prototype.updateEntities=function(e,t){var i=this.entities;if(s.default.instance.specialskillstatus!=d.SPECIAL_SKILL_STATUS.NONE)h.default.instance.updateEntities(e,t);else{if(0==s.default.instance.fightViewPlayRate){for(var n in i){(o=i[n])&&o.getPlayRate()!=s.default.instance.fightViewPlayRate&&o.setPlayRate(s.default.instance.fightViewPlayRate)}return}for(var n in i){var o=i[n];0==s.default.instance.fightMode||1==s.default.instance.fightMode?o&&(o.updateData(e*s.default.instance.fightViewPlayRate,t),o.getPlayRate()!=s.default.instance.fightViewPlayRate&&o.setPlayRate(s.default.instance.fightViewPlayRate)):2==s.default.instance.fightMode&&o&&t%2==o.delayNum&&(o.updateData(e*s.default.instance.fightViewPlayRate,t),o.getPlayRate()!=s.default.instance.fightViewPlayRate&&o.setPlayRate(s.default.instance.fightViewPlayRate))}}l.default.instance.moving(e,t)},t.prototype.setEntitysOpacity=function(e){for(var t in this.entities)this.entities.hasOwnProperty(t)&&this.entities[t].node&&(this.entities[t].node.opacity=e);l.default.instance.setAttacksActive(e)},t=i=__decorate([y],t)}(n.default));i.default=m,cc._RF.pop()},{"../../../Core/TimeController":"TimeController","../../../Global/GlobalValue":"GlobalValue","../Animal":"Animal","../Controller/FightController":"FightController","../Controller/FightTimeController":"FightTimeController","../Controller/SpecialSkillEffectController":"SpecialSkillEffectController","../Controller/ZFController":"ZFController","../Effect/AttackEffectUtils":"AttackEffectUtils","../LayerableCompent":"LayerableCompent","../Manager/SceneManager":"SceneManager","../Monster":"Monster","./ActorsBigSkillLayer":"ActorsBigSkillLayer"}],ActorsMaskLayer:[function(e,t,i){"use strict";cc._RF.push(t,"c7cf1KTCGxNvbJv7HXZ1C+H","ActorsMaskLayer"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../LayerableCompent"),o=cc._decorator,a=o.ccclass,r=(o.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.entities=[],t._monsters=[],t}var i;return __extends(t,e),i=t,Object.defineProperty(t.prototype,"monsters",{get:function(){return this._monsters},enumerable:!0,configurable:!0}),t.prototype.start=function(){e.prototype.start.call(this),i.instance=this},t.prototype.addActorObj_toScene=function(e,t){void 0===t&&(t=!1),e.node.setPosition(e.x,e.y),this.addChildAtLayer(e,e.y,t)},t.prototype.dispose=function(){e.prototype.dispose.call(this)},t.prototype.clear=function(){this.node.destroyAllChildren()},t=i=__decorate([a],t)}(n.default));i.default=r,cc._RF.pop()},{"../LayerableCompent":"LayerableCompent"}],Animal:[function(e,t,i){"use strict";cc._RF.push(t,"28307lfMWFDxY6kJHNWylJy","Animal"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./SceneEntity"),o=e("../../Util/ComFun"),a=e("../../Global/GlobalValue"),r=e("../../Util/Scene/MoveUtil"),s=e("../Fight/fightlogic"),l=e("./Controller/SkillController"),c=e("./Manager/SceneManager"),d=e("./Effect/AttackEffectUtils"),p=e("./View/ActorsLayer"),h=e("./View/FightView"),u=e("./Controller/FightController"),f=e("../../Core/Const/EntityType"),g=e("./Effect/ThundercloudEffect"),y=e("./Controller/SpecialSkillEffectController"),m=e("./Effect/MonsterIndividualityUtils"),C=e("./Unit/FightLog"),v=e("./Controller/GuideFightController"),_=e("../Status/StatusType"),b=e("./Unit/FightConst"),T=e("../WarTeam/MonsterController"),S=e("../Sound/SoundController"),I=e("../Role/RoleController"),w=cc._decorator,D=w.ccclass,R=(w.property,function(e){function t(){var t=e.call(this)||this;return t._atkTarget=[],t.cd=0,t.attackRangeHasTarget=!1,t._movingTag=!1,t._moveRoad=[],t.userskillindex=-1,t.rolecurfightaction=-1,t}return __extends(t,e),Object.defineProperty(t.prototype,"atkTarget",{get:function(){return this._atkTarget},set:function(e){this._atkTarget=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"movingTag",{get:function(){return this._movingTag},set:function(e){this._movingTag=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"moveRoad",{get:function(){return this._moveRoad},enumerable:!0,configurable:!0}),t.prototype.clear=function(){this.setSingBar(!1),this.movingTag=!1,e.prototype.clear.call(this)},t.prototype.dispose=function(){e.prototype.dispose.call(this)},t.prototype.incHp=function(e,t){var i;if(t)i=t;else{var n=Math.floor(this.prop.maxHP*e);i=this.prop.maxHP+n<this.prop.maxHP?this.prop.maxHP+n:this.prop.maxHP}this.updateHp(i)},t.prototype.decHp=function(e,t){if(!(this.prop.hp<=0)){var i=t||this.prop.hp-e;this.updateHp(i)}},t.prototype.hpOverDead=function(){this.avatar&&(this.prop.type!=f.EntityType.enActor&&m.default.instance.clearByCardid(this),e.prototype.hpOverDead.call(this),this.dead(),this.atkTarget=[],this.disappear())},t.prototype.idle=function(e){this.avatar&&this.avatar.play(a.ACTION.STAND)},t.prototype.run=function(e){this.avatar&&this.avatar.play(a.ACTION.WALK)},t.prototype.dead=function(t){this.avatar&&(C.default.log("\u6d88\u5931",this.prop.originalName,this.prop.handle),e.prototype.dead.call(this),this.avatar.visible=!1,this.movingTag=!1)},t.prototype.rescure=function(){C.default.log("\u590d\u6d3b"+this.prop.handle),e.prototype.rescure.call(this),this.movingTag=!0},t.prototype.updateData=function(t,i){if(0!=this.getPlayRate()&&this.parabola.updataData(),c.default.instance.fightstatus!=c.FIGHTSTATUS.NONE){if(c.default.instance.fightstatus!=c.FIGHTSTATUS.FIGHTEND&&c.default.instance.specialskillstatus==a.SPECIAL_SKILL_STATUS.NONE&&this.hitStatus==a.HIT_STATUS.NONE&&1==v.default.instance.guidefightstatus)if(0==(this.prop.status&s.StateBit.Sing))if(0!=(this.prop.status&s.StateBit.Dizzy)||this.prop.deadman)-1==this.avatar.body.spine.animation.indexOf(a.ACTION.STAND)&&this.stopMoveAndIdle();else{e.prototype.updateData.call(this,t,i);var n=h.default.instance.loopIntervalRate[c.default.instance.fightMode][0]*c.default.instance.fightViewPlayRate;if(this.prop)for(var o=0,r=Object.keys(this.prop.skillCdDic);o<r.length;o++){var l=r[o];this.prop.skillCdDic[l]&&(this.prop.skillCdDic[l].time-=n)}this.cd>0&&(this.cd-=n),this.attacking||this.checkActivityStatue()}else-1==this.avatar.body.spine.animation.indexOf("fight2")&&this.attack(2)}else this.stopMoveAndIdle()},t.prototype.checkActivityStatue=function(){this.prop&&this.isLive&&(c.default.instance.fightstatus==c.FIGHTSTATUS.FIGHT||c.default.instance.fightstatus==c.FIGHTSTATUS.PLAYSKILL)&&(this.playPrewarSkillNums.length>0?this.checkplayPrewarSkill():c.default.instance.fightstatus==c.FIGHTSTATUS.FIGHT&&this.checkCanUseSkill())},t.prototype.hasWeapon=function(){return!1},t.prototype.setTarget=function(e){this._atkTarget=e},t.prototype.setTargetPoint=function(e,t){this.targetPointX=e,this.targetPointY=t},t.prototype.checkCanUseSkill=function(){for(var e=this.prop.skillList,t=e.length-1;t>=0;--t){var i=e[t].skillid,n=e[t].skilllv,o=l.default.instance.getSkillBySkillId(i);if(this.prop.angerskill&&this.prop.anger>=100&&(this.checkAttackTarget(this.prop.angerskill.skillid,this.prop.angerskill.skilllv),this.atkTarget.length>0))return;if(o&&!o.prewarskill&&(o.triggerway==a.TRIGGER_WAY.PERIOD||o.triggerway==a.TRIGGER_WAY.COMMON)&&this.skillCanUse(i)&&0==(this.prop.status&s.StateBit.Dizzy)&&(this.checkAttackTarget(i,n),this.atkTarget.length>0))break}this.userskillindex++,this.userskillindex>e.length-1&&(this.userskillindex=0),e[this.userskillindex]||(this.userskillindex=0)},t.prototype.oneWarCanUseSkill=function(e){var t=!1,i=this.prop.skillCdDic[e];return i?void 0==i.onewarcanusenum&&void 0==i.allcanusenum?t=!0:0==i.onewarcanusenum&&0==i.allcanusenum?t=!0:i.allcanusenum>0&&i.curusenum<i.allcanusenum?i.onewarcanusenum>0&&i.onewarcanusenum>i.onewarusenum&&(t=!0):i.onewarcanusenum>0&&i.onewarcanusenum>i.onewarusenum&&i.curusenum<i.allcanusenum&&(t=!0):t=!0,t},t.prototype.skillCanUse=function(e){var t=!1,i=this.prop.skillCdDic[e];if(i?i.time<=0&&(void 0==i.onewarcanusenum&&void 0==i.allcanusenum&&(t=!0),0==i.onewarcanusenum&&0==i.allcanusenum?t=!0:i.allcanusenum>0&&i.curusenum<i.allcanusenum?i.onewarcanusenum>0&&i.onewarcanusenum>i.onewarusenum&&(t=!0):i.onewarcanusenum>0&&i.onewarcanusenum>i.onewarusenum&&i.curusenum<i.allcanusenum&&(t=!0)):t=!0,l.default.instance.getSkillBySkillId(e).triggerway!=a.TRIGGER_WAY.COMMON&&c.default.instance.fightlogic){var n=c.default.instance.fightlogic.getFightEntityByHandle(this.prop.handle);n&&n.attr?(n.attr.buff.IsHasBuffByType(a.BuffType.Silence)||n.IsDie())&&(t=!1):t=!1}return t},t.prototype.useSkill=function(e,t,i,n){void 0===i&&(i=!1),void 0===n&&(n=!0);var r=l.default.instance.getSkillBySkillId(e);if(this.atkTarget&&this.atkTarget.length>0||r.attackTarget==a.ATTACK_TARGE.DRIFTLESS){if(r.triggerway==a.TRIGGER_WAY.INITIATIVE&&i&&r.effectType)return c.default.instance.oldfightViewPlayRate=c.default.instance.fightViewPlayRate,h.default.instance.SetFightViewPlayRate(0),c.default.instance.specialskillstatus=r.effectType,c.default.instance.effectShowType=r.effectShowType,y.default.instance.showSpecialEffect([this],e,t,this.atkTarget,this.atkTarget.length),void(this.cd=800);r.triggerway==a.TRIGGER_WAY.INITIATIVE&&this.node.parent&&p.default.instance.changeByLayer(this,this.node.parent.childrenCount+1),r.attackTarget==a.ATTACK_TARGE.ENEMY&&this.atkTarget.length&&this.changeDir(o.ComFun.getDiretion(this.x,this.y,this.atkTarget[0].x,this.atkTarget[0].y)),m.default.instance.checkIndividualityType(a.INDIVIDUALITY.TYPE3,this,e);var s=l.default.instance.getSkillResultBySkillIdAndLv(e,t)[0];c.default.instance.specialskillEntityComEffect=!(r.animationId>0)||s.type==b.SKILL_WAY_TYPE.Sing,r.animationId&&r.animationId>0?(this.prop.type==f.EntityType.enActor&&(-1==this.rolecurfightaction?this.rolecurfightaction=1:this.rolecurfightaction=1==this.rolecurfightaction?2:1),r.frameEvent&&_.ActivityStatus.value!=_.ActivityStatus.Arena?this.avatar.body.setAnimEventCall("skill",this.skillresult,this,[e,t]):this.skillresult(e,t,!1),this.prop.type==f.EntityType.enActor?c.default.instance.artifactSkill()?this.skillresult(e,t,n):this.attack(this.rolecurfightaction):this.attack(r.animationId),r.actionMusic&&(void 0!==r.effectType&&3!=r.effectType&&4!=r.effectType&&6!=r.effectType||S.default.instance.PlayEffect("audio/BattleSound/"+r.actionMusic))):this.skillresult(e,t,n),s.type!=b.SKILL_WAY_TYPE.Sing&&y.default.instance.setAvatarCom(this),this.cd=800,this.prop.angerskill&&(r.triggerway==a.TRIGGER_WAY.COMMON&&(this.prop.anger=Math.min(100,this.prop.anger+10+.5*Math.round(t/2)),C.default.log("\u6012\u6c14   "+this.prop.anger)),r.triggerway==a.TRIGGER_WAY.ANGER&&(this.prop.anger=0,C.default.log("\u6012\u6c14\u6280\u80fd   "+this.prop.anger))),this.movingTag=!1,this.addSkillCdInfo(e,t)}else{if(c.default.instance.fightlogic&&c.default.instance.fightlogic.entityHandle[this.prop.handle]&&c.default.instance.fightlogic.entityHandle[this.prop.handle].attr&&c.default.instance.fightlogic.entityHandle[this.prop.handle].attr.buff.IsHasBuffByType(a.BuffType.Puzzle))return void this.stopMove();this.prop.selfMonster?this.checkPoint(c.default.instance.rightlives,c.default.instance.otherRole):this.checkPoint(c.default.instance.leftlives,c.default.instance.myRole)}},t.prototype.addSkillCdInfo=function(e,t){var i=l.default.instance.getSkillBySkillId(e),n=l.default.instance.getSkillBySkillIdAndLv(e,1).cooldownTimes;this.prop.skillCdDic[e]?(this.prop.skillCdDic[e].curusenum++,this.prop.skillCdDic[e].onewarusenum++,this.prop.skillCdDic[e].time=n):this.setSkillCDInfo(e,n,1,i.allcanusenum,1,i.onewarcanusenum)},t.prototype.checkPoint=function(e,t){var i;if(this.tauntTagets.length>0)return i=p.default.instance.getSceneEntity(this.tauntTagets[0].handle),void this.setactorpoint(i);e.length>0?(i=p.default.instance.getSceneEntity(e[0].handle),this.setactorpoint(i)):t?this.moveTowardTarget(t.x,this.prop.y):this.moveTowardTarget(this.targetPointX,this.prop.y)},t.prototype.setactorpoint=function(e){e&&(this.prop.type==f.EntityType.enMonster&&this.prop.grade<=3&&T.default.instance.getCardConfCardType(this.prop.cardid)==a.CardType.Front?this.moveTowardTarget(e.prop.x,e.prop.y):this.moveTowardTarget(e.x,this.prop.y))},t.prototype.skillresult=function(e,t,i){void 0===i&&(i=!0);var n=l.default.instance.getSkillBySkillId(e);if(n.skillMusic&&5!=n.effectType&&S.default.instance.PlayEffect("audio/BattleSound/"+n.skillMusic),!(i&&0!=(this.prop.status&s.StateBit.Sing)||c.default.instance.specialskillstatus!=a.SPECIAL_SKILL_STATUS.NONE&&n.triggerway!=a.TRIGGER_WAY.INITIATIVE)){for(var o=[],r=!0,p=0,h=this.atkTarget;p<h.length;p++){var y=h[p];o.push(y.prop.handle),r&&y.prop.isLive&&(r=!1)}if(!r)if(n.attackway==a.ATTACK_TYPE.ATTACK_TYPE_1||n.attackway==a.ATTACK_TYPE.ATTACK_TYPE_3)u.default.instance.actorUseSkill(this.prop.handle,o,e,t);else if(n.attackway==a.ATTACK_TYPE.ATTACK_TYPE_2||n.attackway==a.ATTACK_TYPE.ATTACK_TYPE_5)if(n.attackEffect)for(var m=!1,C=0,v=this.atkTarget;C<v.length;C++){y=v[C];if(this.prop.type==f.EntityType.enActor)m=I.default.instance.getModelAtkEfcByModelId(this.prop.spineId)[this.rolecurfightaction-1].type==a.ROLE_ATTACK_EFFECT.TAPHROGENIC;d.default.instance.playOneEffect(this,y,e,t,m)}else u.default.instance.actorUseSkill(this.prop.handle,o,e,t);else n.attackway==a.ATTACK_TYPE.ATTACK_TYPE_4?g.default.instance.show(this,e,t):u.default.instance.actorUseSkill(this.prop.handle,o,e,t)}},t.prototype.setSkillCDInfo=function(e,t,i,n,o,a){var r={time:t,curusenum:i,allcanusenum:n,onewarusenum:o,onewarcanusenum:a};this.prop.skillCdDic[e]=r},t.prototype.checkAttackTarget=function(e,t,i,n){void 0===i&&(i=!1),void 0===n&&(n=!0),this.atkTarget=c.default.instance.seekTarget(this,e,t),this.useSkill(e,t,i,n)},t.prototype.useInitiativeSkill=function(e,t,i){void 0===i&&(i=!1),this.checkAttackTarget(e,t,i,!1)},t.prototype.playPrewarSkill=function(){for(var e=this.prop.skillList,t=e.length-1;t>=0;t--){var i=e[t],n=l.default.instance.getSkillBySkillId(i.skillid);n&&n.prewarskill&&-1==this.playPrewarSkillNums.indexOf(i)&&this.playPrewarSkillNums.push(i)}},t.prototype.checkplayPrewarSkill=function(){if(C.default.log("\u6218\u524d\u6280\u80fd\u4f7f\u7528\u5f00\u59cb",this.playPrewarSkillNums.length),this.playPrewarSkillNums.length>0){var e=this.playPrewarSkillNums[0];this.attacking||(this.playPrewarSkillNums.shift(),this.checkAttackTarget(e.skillid,e.skilllv))}},t.prototype.playSkillAction=function(e,t){this.isLive&&(t||(this.atkTarget?this.judgeDir(this.atkTarget[0].worldX,this.atkTarget[0].worldY):this.dir))},t.prototype.playSkillEffect=function(e,t,i,n,o,a,r,s){this.showFigure},t.prototype.attack=function(e,t){this.avatar&&this.avatar.play("fight"+e,null,t)},t.prototype.noticeUpdateBodyMoveTargetXY=function(e,t){},t.prototype.calcMoveRoad=function(e){void 0===e&&(e=!1),e||(this.moveRoad.length=0,this.moveRoad.push(cc.v2(this.targetPointX,this.targetPointY)))},t.prototype.moveTowardTarget=function(e,t){if(e&&(this.targetPointX=e),t&&(this.targetPointY=t),!this.attacking)if(this.targetPointX!=this.worldX||this.targetPointY!=this.worldY){if(this.movingTag=!0,this.calcMoveRoad(),this.moveRoad.length>0){var i=this.moveRoad[0].x,n=this.moveRoad[0].y,a=Math.atan2(n-this.worldY,i-this.worldX);this.run(o.ComFun.calcLRByRadian(a)),this.noticeUpdateBodyMoveTargetXY(this.targetPointX,this.targetPointY)}}else this.moveRoad.length=0},t.prototype.stopMove=function(){this.movingTag=!1,this.noticeUpdateBodyMoveTargetXY(this.worldX,this.worldY),this.status!=a.ACTION.STAND&&this.idle()},t.prototype.stopMoveAndIdle=function(){this.stopMove()},t.prototype.moving=function(e){if(_.ActivityStatus.value!=_.ActivityStatus.Guide||1==v.default.instance.guidefightstatus){if(this.prop&&this.prop.move&&this.prop.isLive&&c.default.instance.fightstatus==c.FIGHTSTATUS.FIGHT&&c.default.instance.specialskillstatus==a.SPECIAL_SKILL_STATUS.NONE&&!this.attacking&&!(this.atkTarget&&this.atkTarget.length>0)&&this.movingTag){if(this.status!=a.ACTION.WALK&&this.run(),this.moveRoad.length<=0)return void this.stopMove();var t=this.targetPointX,i=this.targetPointY,n=t-this.prop.x,s=i-this.prop.y,l=Math.atan2(s,n),d=(o.ComFun.calcDirByRadian8(l),this.prop.x),p=this.prop.y,h=void 0,u=void 0,f=r.MoveUtil.getSpeedByMoveTime(e,this.prop.moveSpeed,this.prop.dir);o.ComFun.distance(this.node.x,this.node.y,t,i)<=f?this.moveEnd():(h=Math.round(f*Math.cos(l)),u=Math.round(f*Math.sin(l)),l>3.14?(h=Math.round(f*Math.cos(0)),h=-Math.ceil(h)):h=Math.ceil(h),u=u>0?Math.ceil(u):Math.floor(u),d=this.prop.x+h,p=this.prop.y+u),this.prop.x!=d&&this.changeDir(o.ComFun.getDiretion(this.x,this.y,d,p)),this.prop.x=d,this.prop.y=p,this.updateSit(d,p)}}else this.status!=a.ACTION.STAND&&this.idle()},t.prototype.moveEnd=function(){this.stopMove()},Object.defineProperty(t.prototype,"attacking",{get:function(){return _.ActivityStatus.value!=_.ActivityStatus.Arena?this.cd>0||-1!=this.status.indexOf("fight"):this.cd>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"deading",{get:function(){return this.status==a.ACTION.DEAD},enumerable:!0,configurable:!0}),t.prototype.setSingBar=function(e,t,i){this.isLive?(this.setSingVisible(e&&i>0),this.singBar&&this.singBar.node.active&&(this.singBar.progress=i/t)):this.setSingVisible(e)},t=__decorate([D],t)}(n.default));i.default=R,cc._RF.pop()},{"../../Core/Const/EntityType":"EntityType","../../Global/GlobalValue":"GlobalValue","../../Util/ComFun":"ComFun","../../Util/Scene/MoveUtil":"MoveUtil","../Fight/fightlogic":"fightlogic","../Role/RoleController":"RoleController","../Sound/SoundController":"SoundController","../Status/StatusType":"StatusType","../WarTeam/MonsterController":"MonsterController","./Controller/FightController":"FightController","./Controller/GuideFightController":"GuideFightController","./Controller/SkillController":"SkillController","./Controller/SpecialSkillEffectController":"SpecialSkillEffectController","./Effect/AttackEffectUtils":"AttackEffectUtils","./Effect/MonsterIndividualityUtils":"MonsterIndividualityUtils","./Effect/ThundercloudEffect":"ThundercloudEffect","./Manager/SceneManager":"SceneManager","./SceneEntity":"SceneEntity","./Unit/FightConst":"FightConst","./Unit/FightLog":"FightLog","./View/ActorsLayer":"ActorsLayer","./View/FightView":"FightView"}],AnimationFunction:[function(e,t,i){"use strict";cc._RF.push(t,"1a723kQ9htEmrRbKB3UuIE8","AnimationFunction"),Object.defineProperty(i,"__esModule",{value:!0});var n=cc._decorator,o=n.ccclass,a=(n.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._animation=null,t.StopCallback=null,t.StopCallbackThisObj=null,t.StopCallbackParam=null,t}return __extends(t,e),t.prototype.start=function(){this._animation=this.node.getComponent(cc.Animation)},t.prototype.animationStop=function(){this._animation.pause(),console.log("\u52a8\u753b\u6682\u505c"),this.node.emit("GameAnimationStop"),this.playEnd()},t.prototype.animationEnd=function(){this._animation.stop(),console.log("\u52a8\u753b\u505c\u6b62"),this.node.emit("GameAnimationStop"),this.playEnd()},t.prototype.playEnd=function(){var e=this.StopCallback,t=this.StopCallbackThisObj,i=this.StopCallbackParam;this.StopCallback=null,this.StopCallbackThisObj=null,this.StopCallbackParam=null,e&&e.apply(t,i)},t=__decorate([o],t)}(cc.Component));i.default=a,cc._RF.pop()},{}],AnimationUtils:[function(e,t,i){"use strict";cc._RF.push(t,"f1ef15XVVhH7oZpvbMn1asc","AnimationUtils"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./AnimationFunction"),o=cc._decorator,a=o.ccclass,r=o.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Queue=[],t.QueueAnimationName=[],t.PlayOnLoad=!0,t._queueIndex=-1,t._queueNodeOriginDataList=[],t}return __extends(t,e),t.prototype.onLoad=function(){this.initQueue()},t.prototype.start=function(){this.initQueue()},t.prototype.onEnable=function(){1==this.PlayOnLoad&&this.Queue.length>0&&(this._queueIndex=-1,this.resetQueue(),this.playQueue())},t.prototype.onDisable=function(){this.resetQueue()},t.prototype.playQueueAnimation=function(){this._queueIndex=-1,this.resetQueue(),this.playQueue()},t.prototype.clear=function(){this._queueIndex=-1,this.resetQueue()},t.prototype.initQueue=function(){this._queueNodeOriginDataList.length=0;for(var e=0;e<this.Queue.length;e++){var t=this.Queue[e].node;this._queueNodeOriginDataList.push({active:t.active})}},t.prototype.resetQueue=function(){for(var e=0;e<this.Queue.length;e++){var t=this.Queue[e].node;t.off("GameAnimationStop",this.queueGameAnimationStop,this),t.getComponent(cc.Animation).stop(),t.getComponent(cc.Animation).setCurrentTime(0),t.active=this._queueNodeOriginDataList[e].active}},t.prototype.playQueue=function(){if(this._queueIndex>=0&&this.Queue[this._queueIndex].node.off("GameAnimationStop",this.queueGameAnimationStop,this),this._queueIndex++,this._queueIndex<this.Queue.length){this.Queue[this._queueIndex].node.on("GameAnimationStop",this.queueGameAnimationStop,this);var e=this.Queue[this._queueIndex].node;e.active=!0,this._queueIndex>=this.QueueAnimationName.length||!this.QueueAnimationName[this._queueIndex]||""==this.QueueAnimationName[this._queueIndex]?e.getComponent(cc.Animation).play():e.getComponent(cc.Animation).play(this.QueueAnimationName[this._queueIndex])}else console.log("\u961f\u5217\u52a8\u753b\u64ad\u653e\u5b8c\u6210")},t.prototype.queueGameAnimationStop=function(){this.playQueue()},__decorate([r([n.default])],t.prototype,"Queue",void 0),__decorate([r([cc.String])],t.prototype,"QueueAnimationName",void 0),__decorate([r(cc.Boolean)],t.prototype,"PlayOnLoad",void 0),t=__decorate([a],t)}(cc.Component);i.default=s,cc._RF.pop()},{"./AnimationFunction":"AnimationFunction"}],ArenaController:[function(e,t,i){"use strict";cc._RF.push(t,"791cfifud1LpoQ55IC2JhhX","ArenaController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../NetConnect/NetConnet"),a=e("../../Core/ConfigsManager"),r=e("../../Core/GameEventDispatcher"),s=e("../../Core/Event"),l=e("../Scene/Manager/SceneManager"),c=e("../Status/StatusType"),d=e("../OpenWin/OpenWinController"),p=e("../../Core/WindowType"),h=e("../../Core/Const/EntityType"),u=e("../Scene/Controller/FightController"),f=e("../Scene/Controller/ServerFightController"),g=e("../Scene/Controller/EntityQiPaoController"),y=e("../Fight/staticattr"),m=e("../Scene/Controller/SkillController"),C=e("../WarTeam/MonsterController"),v=e("../../Core/TimeController"),_=e("../Gamelayer/Interface/EventInterface"),b=e("../Fight/FightUtils"),T=cc._decorator,S=T.ccclass,I=(T.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.arenaConfigs=void 0,t.rewardConfigs=void 0,t.matchInfo=void 0,t.redPoint=!1,t.arenaInfo=null,t.oldarenaInfo=null,t.lastarenaInfo=null,t.changeGrade=0,t.changeStar=1,t.otherinfoStar=null,t.init=!1,t.isArenaNextFight=-1,t.resultShowItemList=void 0,t.saveServerEntitys=[],t.arenaSaveMonsters=[],t.isAddSaveServerEntitysCom=!1,t.readylist=[],t.enterfailnumber=0,t.waittype=0,t.matchresult={0:0,1:0},t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.arenaConfigs=a.ConfigsManager.instance.getConfigs("matchraceconf"),this.rewardConfigs=a.ConfigsManager.instance.getConfigs("stdrewardconf")},t.prototype.start=function(){e.prototype.start.call(this),i.instance=this},t.prototype.listNotification=function(){this.addProto("matchrival",this.matchComplete,this),this.addProto("matchrace",this.updateInfo,this),this.addProto("matchreset",this.getArenaInfo,this),this.addProto("matchround",this.matchfightresult,this),this.addProto("newround",this.matchfightaddstep,this),this.addProto("matchface",this.matchface,this),this.addProto("clientloaded",this.clientloaded,this),r.GameEventDispatcher.instance.on(s.EventDefiner.FightUpdateArenaWait,this.updateArenaWait,this)},t.prototype.updateArenaWait=function(e){e&&(this.waittype=e.detail.type)},t.prototype.clientloaded=function(e){this.readylist.push(e.actorid),this.readylist.length>=2?(d.default.instance.openWindow(p.WindowType.SandTable),r.GameEventDispatcher.instance.emit(s.EventDefiner.FightUpdateArenaWait,{type:-1})):r.GameEventDispatcher.instance.emit(s.EventDefiner.FightUpdateArenaWait,{type:1})},t.prototype.matchface=function(e){l.default.instance.otherRole&&g.default.instance.showQiPaoFace(l.default.instance.otherRole,e.msg,2e3)},t.prototype.sendface=function(e){var t={cmd:"matchface",msg:e};o.default.instance.sendProto(t)},t.prototype.sendcliententer=function(){o.default.instance.sendProto({cmd:"cliententer"}),0!=this.enterfailnumber&&v.default.instance.clearTimeout(this.enterfailnumber)},t.prototype.sendCmdCancleMatch=function(){o.default.instance.sendProto({cmd:"cancelmatch"})},t.prototype.matchfightaddstep=function(e){l.default.instance.steptime=e.timeout?e.timeout:0},t.prototype.matchfightresult=function(e){f.default.instance.isstartfight=!1,this.matchresult[e.winner]=e.count,r.GameEventDispatcher.instance.emit(s.EventDefiner.ArenaMatchFightResult,e),c.ActivityStatus.value!=c.ActivityStatus.Arena||(2==this.matchresult[0]||2==this.matchresult[1]?this.isArenaNextFight=0:(this.isAddSaveServerEntitysCom=!1,this.isArenaNextFight=1,d.default.instance.openWindow(p.WindowType.ArenaSingleResultWin)))},t.prototype.matchComplete=function(e){l.default.instance.steptime=v.default.instance.ServerTimeMins+3e4,this.otherinfoStar=e,r.GameEventDispatcher.instance.emit(s.EventDefiner.ArenaMatchRival,e),0==this.enterfailnumber&&(this.enterfailnumber=v.default.instance.setTimeout(function(){u.default.instance.sendclientresult(2),l.default.instance.steptime=0},this,3e4))},t.prototype.updateInfo=function(e){r.GameEventDispatcher.instance.emit(s.EventDefiner.ArenaMatchRace,e),this.updateMatchInfo(e)},t.prototype.getArenaInfo=function(e){this.lastarenaInfo=e,r.GameEventDispatcher.instance.emit(s.EventDefiner.ArenaMatchReset,e)},t.prototype.updateMatchInfo=function(e){this.oldarenaInfo=this.arenaInfo,this.arenaInfo=e,this.redPoint=e.redpoint,1==this.redPoint?r.GameEventDispatcher.instance.emit(_.EventInterface.ArenaRed,!0):r.GameEventDispatcher.instance.emit(_.EventInterface.ArenaRed,!1),this.oldarenaInfo&&(this.changeGrade=this.getDuanWeiResIndex(this.arenaInfo.grade)-this.getDuanWeiResIndex(this.oldarenaInfo.grade),this.changeGrade>0?this.changeStar=this.arenaInfo.star:this.changeStar=this.arenaInfo.star-this.oldarenaInfo.star)},t.prototype.sendMatch=function(){this.matchresult={0:0,1:0};this.isArenaNextFight=0,this.readylist.length=0,o.default.instance.sendProto({cmd:"match"})},t.prototype.addServerEntitys=function(){this.saveServerEntitys.forEach(function(e){f.default.instance.createEntity(e)}),this.saveServerEntitys=[],this.isAddSaveServerEntitysCom=!0},t.prototype.getCardFlyFight=function(e,t){var i=C.default.instance.GetMonsterInfo(e),n=this.arenaConfigs.prop[i.rarity][i.cardType][t].attr,o=new y.StaticAttr;for(var a in n){var r=n[a];o.Push(parseInt(a),r)}o=b.FightUtils.setFightAttr(e,o,!0);var s=m.default.instance.getBigSkillList(e,t);return o.skills=s.concat(m.default.instance.getSmallSkillList(e,t,30)),o.GetFight()},t.prototype.addArenaSaveMonster=function(){for(var e in this.addServerEntitys(),this.arenaSaveMonsters){var t=this.arenaSaveMonsters[e],i={handle:t.handle,id:t.cardid,model:t.spineId,type:t.type,level:t.cultivateLv,grade:t.grade,camp:t.camp,attr:t.attr,skills:t.skillList};f.default.instance.createEntity(i,!1)}this.arenaSaveMonsters=[],this.saveServerEntitys=[]},t.prototype.saveArenaMonsters=function(){var e=[];l.default.instance.fightresult?l.default.instance.leftlives.length>0&&(e=l.default.instance.leftlives):l.default.instance.rightlives.length>0&&(e=l.default.instance.rightlives);for(var t=[],i=0,n=e;i<n.length;i++){var o=n[i];o.copyEntity||o.specialMonster||o.type==h.EntityType.enActor||t.push(o)}t.length>0&&(t.sort(u.default.instance.sortSaveEntity),t=t.slice(0,2)),this.arenaSaveMonsters=t},t.prototype.getDuanWeiResIndex=function(e){return Math.floor((25-e)/5)+1},t.prototype.sendBack=function(){this.sendProto({cmd:"clientexitfight"})},t.instance=null,t=i=__decorate([S],t)}(n.default));i.default=I,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Const/EntityType":"EntityType","../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/TimeController":"TimeController","../../Core/WindowType":"WindowType","../../NetConnect/NetConnet":"NetConnet","../Fight/FightUtils":"FightUtils","../Fight/staticattr":"staticattr","../Gamelayer/Interface/EventInterface":"EventInterface","../OpenWin/OpenWinController":"OpenWinController","../Scene/Controller/EntityQiPaoController":"EntityQiPaoController","../Scene/Controller/FightController":"FightController","../Scene/Controller/ServerFightController":"ServerFightController","../Scene/Controller/SkillController":"SkillController","../Scene/Manager/SceneManager":"SceneManager","../Status/StatusType":"StatusType","../WarTeam/MonsterController":"MonsterController"}],ArenaLineup:[function(e,t,i){"use strict";cc._RF.push(t,"2060eo9CFpIEr0O6RtPKOnx","ArenaLineup"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../Commons/MonsterPreview"),a=e("../../Core/WindowType"),r=e("../../Util/Utils"),s=e("../../Core/ConfigsManager"),l=e("../../Core/CommonsResManager"),c=e("../WarTeam/MonsterController"),d=e("../Commons/Image"),p=e("../Equip/equip/EquipCtrl"),h=e("../../Util/UtilsFight"),u=e("../WarTeam/WarTeamMonsterInfo"),f=cc._decorator,g=f.ccclass,y=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.btnLineup=null,t.stance=null,t.config=null,t.cardId=null,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this),this.btnLineup.active=!1},t.prototype.initInfo=function(e,t){this.cardId=e,this.config=t,this.setToUpdateInfo()},t.prototype.setToUpdateInfo=function(){if(this.cardId){this.node.getChildByName("teaminfo").active=!0;for(var e=s.ConfigsManager.instance.getConfigs("cardConf"),t=cc.find("teaminfo/MonsterLayer",this.node).childrenCount-1;t>=0;t--){cc.find("teaminfo/MonsterLayer",this.node).children[t].getComponent(o.default).clear(),r.default.setNodeToPool(a.PoolType.MonsterPreview,cc.find("teaminfo/MonsterLayer",this.node).children[t])}var i=c.default.instance,n=c.default.instance.GetMonsterData(this.cardId),p=e.Card[this.cardId].rarity,h=e.Card[this.cardId].fiveLineAttributes;cc.find("teaminfo/bg",this.node).getComponent(d.default).loadSpriteAtlas("ui/arena/ResArena","fightbg"+p),cc.find("teaminfo/InfoLayer/Rarity",this.node).getComponent(cc.Sprite).spriteFrame=l.default.instance.getSpriteFrameByName("rarity_"+p),cc.find("teaminfo/InfoLayer/FiveLine",this.node).getComponent(cc.Sprite).spriteFrame=l.default.instance.getSpriteFrameByName("series"+h),this.stance=e.Card[this.cardId].cardType,n&&n.level&&(cc.find("teaminfo/InfoLayer/Level",this.node).getComponent(cc.Label).string=n.level+"",cc.find("teaminfo/InfoLayer/CombatPower/value",this.node).getComponent(cc.Label).string=""+i.getCarFight(this.cardId,n.level,i.data.defaultGrade)),cc.find("teaminfo/Occupation/stance",this.node).getComponent(cc.Sprite).spriteFrame=l.default.instance.getSpriteFrameByName("stance_"+this.stance),cc.find("teaminfo/TouchNode",this.node).getComponent("MonsterLayout").setData(this.cardId)}else this.node.getChildByName("teaminfo").active=!1},t.prototype.getEquipFight=function(e,t){var i=p.default.instance.data.getEquipList(this.cardId),n=p.default.instance.data.getEequipWearAttr(i);return h.default.cptFight(t,n)},t.prototype.btn_Info=function(){c.default.instance.openMonsterInfoPrefab(this.cardId,u.CardTag.info,null,null,null,!0)},__decorate([y(cc.Node)],t.prototype,"btnLineup",void 0),t=__decorate([g],t)}(n.default);i.default=m,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/ConfigsManager":"ConfigsManager","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../Util/Utils":"Utils","../../Util/UtilsFight":"UtilsFight","../Commons/Image":"Image","../Commons/MonsterPreview":"MonsterPreview","../Equip/equip/EquipCtrl":"EquipCtrl","../WarTeam/MonsterController":"MonsterController","../WarTeam/WarTeamMonsterInfo":"WarTeamMonsterInfo"}],ArenaResultWin:[function(e,t,i){"use strict";cc._RF.push(t,"c3699cvq6RDo4f4JRYAokUy","ArenaResultWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../FightResultWin/FightResultCommon"),o=e("./ArenaController"),a=e("../Commons/Image"),r=e("../../Core/TimeController"),s=e("../Scene/Manager/SceneManager"),l=e("../../Core/WindowType"),c=e("../../Core/WindowManager"),d=e("../../Core/Language"),p=e("../../Util/Utils"),h=e("../Item/ItemIcon"),u=e("../Status/StatusController"),f=e("../../Core/LoadManager"),g=e("../../GlobalContext"),y=cc._decorator,m=y.ccclass,C=y.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dipan=null,t.upsp=null,t.downsp=null,t.d1=null,t.d2=null,t.ani=null,t.startnode=null,t.conditionlist=[],t.layerTips=null,t.layerTipsContent=null,t.duanweiLabel=null,t.sp=null,t.time=0,t.cro=null,t}return __extends(t,e),t.prototype.show=function(){this.cro=o.default.instance,this.conditionlist[0].parent.active=!0,this.layerTips.active=!1;for(var e=0;e<this.startnode.childrenCount;e++)e<this.cro.oldarenaInfo.star?this.playStar(this.startnode.children[e],1):this.playStar(this.startnode.children[e],2);this.d1.active=!1,this.d2.active=!1,this.upsp.active=!0,this.downsp.active=!0,this.upsp.opacity=255,this.downsp.opacity=255,this.node.getChildByName("33").getChildByName("bg_jjc6").active=!1,this.upsp.getComponent(a.default).clear(),this.downsp.getComponent(a.default).clear(),this.dipan.node.active=!1,this.startnode.active=!1,this.onInitResult(!1,this.setData,this,null,!0),this.setConditions()},t.prototype.setData=function(){this.onInitContent(0,null),this.startnode.active=this.cro.arenaInfo.grade>0,this.dipan.node.active=!0,0==this.cro.changeGrade?(this.d1.active=!1,this.d2.active=!1,this.upsp.active=!1,this.downsp.getComponent(a.default).loadSpriteAtlas("ui/arena/ResArena","icon_duanwei "+o.default.instance.getDuanWeiResIndex(o.default.instance.oldarenaInfo.grade)),this.playStarEffect(),this.dipan.spriteFrame=this.sp.getSpriteFrame("bg_jjc5")):this.cro.changeGrade>0?(this.d1.active=!0,this.d2.active=!1,this.downsp.getComponent(a.default).loadSpriteAtlas("ui/arena/ResArena","icon_duanwei "+o.default.instance.getDuanWeiResIndex(this.cro.oldarenaInfo.grade)),this.upsp.getComponent(a.default).loadSpriteAtlas("ui/arena/ResArena","icon_duanwei "+o.default.instance.getDuanWeiResIndex(this.cro.arenaInfo.grade)),this.ani.play("33up")):(this.d1.active=!1,this.d2.active=!0,this.downsp.getComponent(a.default).loadSpriteAtlas("ui/arena/ResArena","icon_duanwei "+o.default.instance.getDuanWeiResIndex(this.cro.arenaInfo.grade)),this.upsp.getComponent(a.default).loadSpriteAtlas("ui/arena/ResArena","icon_duanwei "+o.default.instance.getDuanWeiResIndex(this.cro.oldarenaInfo.grade)),this.ani.play("33down")),this.ani.once("finished",this.playStarEffect,this),this.clearTime(),s.default.instance.fightresult||this.setContentItemPos(new cc.Vec2(0,-100)),this.setRewards()},t.prototype.playStarEffect=function(){var e=o.default.instance.arenaConfigs.level[this.cro.arenaInfo.grade].gradeName+d.default.getStr("arenastart",this.cro.arenaInfo.star);if(this.duanweiLabel.node.y=-133,this.cro.arenaInfo.grade||(this.duanweiLabel.node.y=-153,e=o.default.instance.arenaConfigs.level[this.cro.arenaInfo.grade].gradeName+"  "+this.cro.arenaInfo.point),this.duanweiLabel.string=e,1!=this.cro.arenaInfo.grade)if(this.cro.changeGrade>0)for(var t=0;t<this.startnode.childrenCount;t++)t<this.cro.changeStar?this.playStar(this.startnode.children[t],3):this.playStar(this.startnode.children[t],2);else if(0==this.cro.changeGrade)for(t=0;t<this.startnode.childrenCount;t++)0<this.cro.changeStar?t+1>this.cro.oldarenaInfo.star&&t+1<=this.cro.oldarenaInfo.star+this.cro.changeStar&&this.playStar(this.startnode.children[t],3):t+1<=this.cro.oldarenaInfo.star&&t+1>this.cro.arenaInfo.star&&this.playStar(this.startnode.children[t],4);else for(t=0;t<this.startnode.childrenCount;t++)t<this.cro.arenaInfo.star?this.playStar(this.startnode.children[t],1):this.playStar(this.startnode.children[t],2)},t.prototype.setConditions=function(){if(this.conditionlist[4].active=s.default.instance.fightresult&&this.cro.arenaInfo.todaywin>10,s.default.instance.fightresult){for(var e=0;e<this.conditionlist.length;e++)this.conditionlist[e].getChildByName("conditionLabel").getComponent(cc.Label).string=0==e?d.default.getStr("condition"+e,Math.ceil(this.cro.arenaInfo.todaywin)):d.default.getStr("condition"+e);this.conditionlist[0].active=this.cro.arenaInfo.todaywin<=10,this.conditionlist[1].active=!0,this.conditionlist[2].active=this.cro.arenaInfo.swin>=3&&o.default.instance.getDuanWeiResIndex(this.cro.arenaInfo.grade)<5}else this.conditionlist[0].active=!1,this.conditionlist[1].active=!1,this.conditionlist[2].active=!1,this.conditionlist[4].active=!1;this.conditionlist[3].active=!s.default.instance.fightresult&&this.cro.arenaInfo.star<this.cro.oldarenaInfo.star},t.prototype.clearTime=function(){this.time&&r.default.instance.clearTimeout(this.time)},t.prototype.playStar=function(e,t){switch(t){case 1:case 2:e.getChildByName("icon_xing1").active=1==t,e.getChildByName("icon_xing2").active=2==t;break;case 3:case 4:e.getChildByName("icon_xing1").active=!0,e.getChildByName("icon_xing2").active=!0,3==t?e.getComponent(cc.Animation).play("31star_2"):e.getComponent(cc.Animation).play("31star_1")}},t.prototype.onClearItem=function(){for(var e=this.layerTipsContent.childrenCount-1;e>=0;e--)p.default.setNodeToPool(l.PoolType.ItemIcon,this.layerTipsContent.children[e]);this.layerTipsContent.removeAllChildren()},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),this.onClearItem()},t.prototype.setRewards=function(){var e=this,t=0;this.layerTips.active=this.cro.arenaInfo.todaywin<10&&s.default.instance.fightresult,this.onClearItem(),f.default.instance.loadResByType(g.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(i){var n=o.default.instance.resultShowItemList;if(e.layerTips.active&&void 0!==n&&n.length>0){var a=function(){if(t>=n.length)e.unschedule(a);else{var o=p.default.getNodeByPool(l.PoolType.ItemIcon,i,g.GlobalContext.Root+"prefab/Bag/ItemIcon");o.getComponent(h.default).ItemData(n[t],!0,null,!0);e.layerTipsContent.addChild(o),e.layerTips.active=!0,t++}};e.schedule(a,.2,n.length,.5)}},this)},t.prototype.hide=function(){this.clearTime()},t.prototype.closewin=function(){c.default.instance.close(l.WindowType.ArenaResultWin),u.default.instance.activityStatusHandle(!0)},t.instance=null,__decorate([C(cc.Sprite)],t.prototype,"dipan",void 0),__decorate([C(cc.Node)],t.prototype,"upsp",void 0),__decorate([C(cc.Node)],t.prototype,"downsp",void 0),__decorate([C(cc.Node)],t.prototype,"d1",void 0),__decorate([C(cc.Node)],t.prototype,"d2",void 0),__decorate([C(cc.Animation)],t.prototype,"ani",void 0),__decorate([C(cc.Node)],t.prototype,"startnode",void 0),__decorate([C([cc.Node])],t.prototype,"conditionlist",void 0),__decorate([C(cc.Node)],t.prototype,"layerTips",void 0),__decorate([C(cc.Node)],t.prototype,"layerTipsContent",void 0),__decorate([C(cc.Label)],t.prototype,"duanweiLabel",void 0),__decorate([C(cc.SpriteAtlas)],t.prototype,"sp",void 0),t=__decorate([m],t)}(n.default);i.default=v,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/Image":"Image","../FightResultWin/FightResultCommon":"FightResultCommon","../Item/ItemIcon":"ItemIcon","../Scene/Manager/SceneManager":"SceneManager","../Status/StatusController":"StatusController","./ArenaController":"ArenaController"}],ArenaRewardInfoPage:[function(e,t,i){"use strict";cc._RF.push(t,"f6183PxfTZKVqnVz3Aw7+B7","ArenaRewardInfoPage"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Commons/CommonPageBG"),o=e("../../Core/Language"),a=e("./ArenaController"),r=e("../Commons/RewardUtils"),s=e("../../Core/WindowType"),l=e("../../Util/Utils"),c=e("../Item/ItemIcon"),d=e("../../Core/CommonsResManager"),p=e("../../Core/LoadManager"),h=e("../../GlobalContext"),u=e("../Commons/Image"),f=e("../../Core/GameEventDispatcher"),g=e("../../Core/Event"),y=cc._decorator,m=y.ccclass,C=y.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layerReset=null,t.layerRewardInfo=null,t.layerRewardContent=null,t._rewardList=[],t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this,this.onInit(895,678,o.default.getStr("arena_rewardinfo_title"),!0)},t.prototype.close=function(){this.onClose()},t.prototype.onInitData=function(e,t){void 0===e&&(e=1),void 0===t&&(t=null),this.layerRewardInfo.active=1==e,this.layerReset.active=2==e,this._rewardList=a.default.instance.arenaConfigs.rewardInfo[1],1==e?this.onShowReward():this.onShowResetNodeInfo(t)},t.prototype.onShowReward=function(){var e=this;l.default.setNodeChildDestoryByUrl(this.layerRewardContent,h.GlobalContext.Root+"prefab/Arena/RewardInfoCell"),p.default.instance.loadResByType(h.GlobalContext.Root+"prefab/Arena/RewardInfoCell",cc.Prefab,function(t){for(var i=0;i<e._rewardList.length;i++){var n=l.default.getNodeByUrl(t,h.GlobalContext.Root+"prefab/Arena/RewardInfoCell");e.updateItemList(n,i),e.layerRewardContent.addChild(n)}},this)},t.prototype.updateItemList=function(e,t){var i=this;p.default.instance.loadResByType(h.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(n){for(var o=i._rewardList[t],s=a.default.instance.rewardConfigs.reward[o.showreward],p=r.default.instance.getItemListByServerData(s),u=0;u<p.length;u++){var f=l.default.getNodeByUrl(n,h.GlobalContext.Root+"prefab/Bag/ItemIcon");f.getComponent(c.default).ItemData(p[u],!0,null,!0);f.scale=.8,e.getChildByName("rewardNode").getChildByName("view").getChildByName("content").addChild(f),e.getChildByName("treasurebox1").getComponent(cc.Sprite).spriteFrame=d.default.instance.getSpriteFrameByName("treasurebox"+(t+1)),e.getChildByName("label").getComponent(cc.Label).string=o.rewardName}},this)},t.prototype.onShowResetNodeInfo=function(e){a.default.instance.arenaConfigs.levelInfo[1];var t=0==e.oldgrade,i=this.layerReset.getChildByName("left").getChildByName("sprLevelNormal"),n="";n=t?e.oldpoint:a.default.instance.arenaConfigs.level[e.oldgrade].gradeName+o.default.getStr("arenastart",e.oldstar),i.getComponent(u.default).loadSpriteAtlas("ui/arena/ResArena","icon_duanwei "+a.default.instance.getDuanWeiResIndex(e.oldgrade)),i.getChildByName("textLevel").getComponent(cc.Label).string=n,this.updateStarNum(this.layerReset.getChildByName("left").getChildByName("starNode"),e.oldstar);var r=this.layerReset.getChildByName("right").getChildByName("sprLevelNormal");r.getComponent(u.default).loadSpriteAtlas("ui/arena/ResArena","icon_duanwei "+a.default.instance.getDuanWeiResIndex(e.newgrade)),r.getChildByName("textLevel").getComponent(cc.Label).string=a.default.instance.arenaConfigs.level[e.newgrade].gradeName+o.default.getStr("arenastart",e.newstar),this.updateStarNum(this.layerReset.getChildByName("right").getChildByName("starNode"),e.newstar)},t.prototype.updateStarNum=function(e,t){for(var i in e.children)e.children[i].getComponent(cc.Sprite).spriteFrame=d.default.instance.getSpriteFrameByName("icon_xing2");for(var n=0;n<t;n++)e.children[n].getComponent(cc.Sprite).spriteFrame=d.default.instance.getSpriteFrameByName("icon_xing1")},t.prototype.onRuleBtn=function(){f.GameEventDispatcher.instance.emit(g.EventDefiner.OpenRulePage,s.WindowType.ArenaRewardInfo)},t.instance=null,__decorate([C(cc.Node)],t.prototype,"layerReset",void 0),__decorate([C(cc.Node)],t.prototype,"layerRewardInfo",void 0),__decorate([C(cc.Node)],t.prototype,"layerRewardContent",void 0),t=i=__decorate([m],t)}(n.default);i.default=v,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/CommonPageBG":"CommonPageBG","../Commons/Image":"Image","../Commons/RewardUtils":"RewardUtils","../Item/ItemIcon":"ItemIcon","./ArenaController":"ArenaController"}],ArenaSingleResultWin:[function(e,t,i){"use strict";cc._RF.push(t,"e5d3da4jltLMo53qJXEqRQA","ArenaSingleResultWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("./ArenaController"),a=e("../../Core/GameEventDispatcher"),r=e("../../Core/Event"),s=e("../Gamelayer/RoleHead"),l=e("../Role/RoleInfo"),c=e("../../Core/CommonsResManager"),d=e("../Scene/Manager/SceneManager"),p=e("../../Core/TimeController"),h=e("../../Core/Language"),u=e("../OpenWin/OpenWinController"),f=e("../../Core/WindowType"),g=e("../Commons/Image"),y=e("../Scene/View/FightView"),m=e("../Scene/Controller/SceneController"),C=e("../../GlobalContext"),v=cc._decorator,_=v.ccclass,b=v.property,T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.title=null,t.icon=null,t.mystatus=null,t.otherstatus=null,t.myinfonode=null,t.otherinfonode=null,t.rule=null,t.spAtlas=null,t.time=5,t.fightend=!1,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.show=function(){this.setTimeLabel(),this.setMyData(),this.setReuslt(),d.default.instance.enemystep=-1,a.GameEventDispatcher.instance.emit(r.EventDefiner.Updata_StepNum),m.default.instance.clear(),this.fightend=!1,a.GameEventDispatcher.instance.on(r.EventDefiner.WindowOpenlink,this.windowOpenlink,this)},t.prototype.windowOpenlink=function(e){e.detail==f.WindowType.ArenaResultWin&&(this.fightend=!0)},t.prototype.hide=function(){a.GameEventDispatcher.instance.off(r.EventDefiner.WindowOpenlink,this.windowOpenlink,this)},t.prototype.setMyData=function(){this.title.spriteFrame=this.spAtlas.getSpriteFrame(d.default.instance.fightresult?"bg_jjc17":"bg_jjc16");var e=C.GlobalContext.ResRoot+"resources/monster/Lineup/"+(d.default.instance.fightresult?"Lineup17-1":"Lineup27-1")+".png";this.icon.loadImageByHttps(e),this.myinfonode.getChildByName("RoleHead").getComponent(s.default).SetHead(l.MyRoleInfo.icon),this.myinfonode.getChildByName("layout").getChildByName("sex").getComponent(cc.Sprite).spriteFrame=c.default.instance.getSpriteFrameByName("gender_"+l.MyRoleInfo.sex),this.myinfonode.getChildByName("layout").getChildByName("name").getComponent(cc.Label).string=l.MyRoleInfo.name},t.prototype.setReuslt=function(){var e=this;this.setArenaInfo(this.myinfonode.getChildByName("jiangbei"),o.default.instance.matchresult[d.default.instance.mycamp]),this.setArenaInfo(this.otherinfonode.getChildByName("jiangbei"),o.default.instance.matchresult[d.default.instance.mycamp?0:1]);var t=o.default.instance.otherinfoStar,i=d.default.instance.fightresult?"i18n_shenglifang":"i18n_shibaifang",n=d.default.instance.fightresult?"i18n_shibaifang":"i18n_shenglifang";this.mystatus.spriteFrame=this.spAtlas.getSpriteFrame(i),this.otherstatus.spriteFrame=this.spAtlas.getSpriteFrame(n),this.otherinfonode.getChildByName("RoleHead").getComponent(s.default).SetHead(t.icon),this.otherinfonode.getChildByName("layout").getChildByName("sex").getComponent(cc.Sprite).spriteFrame=c.default.instance.getSpriteFrameByName("gender_"+t.gender),this.otherinfonode.getChildByName("layout").getChildByName("name").getComponent(cc.Label).string=t.name;var a=p.default.instance.setInterval(function(){e.time--,e.setTimeLabel(),e.time||(e.time=5,e.close(),p.default.instance.clearInterval(a),e.fightend||(u.default.instance.openWindow(f.WindowType.SandTable),y.default.instance.SetFightViewPlayRate(1),o.default.instance.addArenaSaveMonster()))},this,1e3)},t.prototype.setTimeLabel=function(){var e=d.default.instance.fightresult?"arenasingles":"arenasinglef";this.rule.string=h.default.getStr(e,this.time)},t.prototype.setArenaInfo=function(e,t){for(var i=0;i<e.childrenCount;i++)e.children[i].getComponent(cc.Sprite).spriteFrame=t-1>=i?c.default.instance.getSpriteFrameByName("icon_jiangbei2"):c.default.instance.getSpriteFrameByName("icon_jiangbei3")},t.instance=null,__decorate([b(cc.Sprite)],t.prototype,"title",void 0),__decorate([b(g.default)],t.prototype,"icon",void 0),__decorate([b(cc.Sprite)],t.prototype,"mystatus",void 0),__decorate([b(cc.Sprite)],t.prototype,"otherstatus",void 0),__decorate([b(cc.Node)],t.prototype,"myinfonode",void 0),__decorate([b(cc.Node)],t.prototype,"otherinfonode",void 0),__decorate([b(cc.RichText)],t.prototype,"rule",void 0),__decorate([b(cc.SpriteAtlas)],t.prototype,"spAtlas",void 0),t=i=__decorate([_],t)}(n.default);i.default=T,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/TimeController":"TimeController","../../Core/Window":"Window","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../Commons/Image":"Image","../Gamelayer/RoleHead":"RoleHead","../OpenWin/OpenWinController":"OpenWinController","../Role/RoleInfo":"RoleInfo","../Scene/Controller/SceneController":"SceneController","../Scene/Manager/SceneManager":"SceneManager","../Scene/View/FightView":"FightView","./ArenaController":"ArenaController"}],ArenaTeamInfo:[function(e,t,i){"use strict";cc._RF.push(t,"bd5f5vFT7pEpa5GBVzqs7KS","ArenaTeamInfo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../WarTeam/MonsterController"),a=cc._decorator,r=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sprLevel=null,t.sprStance=null,t.textName=null,t.sprLevelList=[],t.sprStanceList=[],t.cardId=0,t.config=0,t.cardName=0,t.cardLevel=0,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.onEnable=function(){e.prototype.onEnable.call(this)},t.prototype.onDisable=function(){e.prototype.onDisable.call(this)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.initInfo=function(e,t){this.cardId=e,this.config=t;var i=o.default.instance.GetMonsterInfo(this.cardId),n=this.node.getChildByName("animNode");n.removeAllChildren();for(var a=[0,50,-50,25,-25],r=0;r<5;r++)o.default.instance.infoPreview(n,cc.v2(a[r],20-15*Math.floor((r+1)/2)),this.cardId,5-r,0==r?.5:.2,-1);this.textName.string=i.cardName,this.sprLevel.getComponent(cc.Sprite).spriteFrame=this.sprLevelList[i.rarity-1],this.sprStance.getComponent(cc.Sprite).spriteFrame=this.sprStanceList[i.cardType-1]},__decorate([s(cc.Node)],t.prototype,"sprLevel",void 0),__decorate([s(cc.Node)],t.prototype,"sprStance",void 0),__decorate([s(cc.Label)],t.prototype,"textName",void 0),__decorate([s([cc.SpriteFrame])],t.prototype,"sprLevelList",void 0),__decorate([s([cc.SpriteFrame])],t.prototype,"sprStanceList",void 0),t=__decorate([r],t)}(n.default);i.default=l,cc._RF.pop()},{"../../Core/Widget":"Widget","../WarTeam/MonsterController":"MonsterController"}],ArenaWindow:[function(e,t,i){"use strict";cc._RF.push(t,"bdea4u1QJ1AgYdGE9ZxZl5/","ArenaWindow"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../../Core/TimeController"),a=e("../../GlobalContext"),r=e("../../Core/GameEventDispatcher"),s=e("../../Core/Event"),l=e("../../Global/GlobalValue"),c=e("../../Core/Language"),d=e("../../NetConnect/NetConnet"),p=e("../../Core/WindowType"),h=e("../WarTeam/WarTeam"),u=e("./ArenaController"),f=e("../Role/RoleInfo"),g=e("../WarTeam/MonsterController"),y=e("../../Util/Utils"),m=e("../OpenWin/OpenWinController"),C=e("../../Core/WindowType"),v=e("../Item/ItemIcon"),_=e("../Commons/Image"),b=e("./ArenaLineup"),T=e("../../Core/CommonsResManager"),S=e("../Gamelayer/RoleHead"),I=e("./ArenaRewardInfoPage"),w=e("../../Core/LoadManager"),D=e("../Shop/ShopController"),R=e("../Shop/ShopConst"),A=e("../Shop/ShopModel"),N=e("../../Util/NumberUtil"),L=cc._decorator,E=L.ccclass,B=L.property,M=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mainNode=null,t.matchNode=null,t.sprLevelNormal=null,t.starNode=null,t.textTime=null,t.textLevel=null,t.textWinNum=null,t.lineUpNodeList=[],t.arenaPlist=null,t.lineupNode=null,t.BtnLineupLayer=null,t.rewardima=null,t.rewardbox=null,t.translateNum=null,t.teamNum=1,t.matchtime=0,t.newDataInfo=void 0,t.oldDataInfo=void 0,t.inveltime=0,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){this.onInit(p.WindowType.Arena,!0),e.prototype.onLoad.call(this)},t.prototype.show=function(){r.GameEventDispatcher.instance.on(s.EventDefiner.ArenaMatchRival,this.matchComplete,this),r.GameEventDispatcher.instance.on(s.EventDefiner.ArenaMatchReset,this.updateInfo,this),r.GameEventDispatcher.instance.on(s.EventDefiner.ArenaMatchRace,this.updateInfo,this),this.updateInfo()},t.prototype.start=function(){e.prototype.start.call(this),i.instance=this},t.prototype.updateInfo=function(e){void 0===e&&(e=null),this.initInfo(u.default.instance.arenaInfo,u.default.instance.lastarenaInfo),this.initTime(),this.initTeamModel(),this.showTranslate()},t.prototype.close=function(){e.prototype.close.call(this),r.GameEventDispatcher.instance.off(s.EventDefiner.ArenaMatchRival,this.matchComplete,this),r.GameEventDispatcher.instance.off(s.EventDefiner.ArenaMatchReset,this.updateInfo,this),r.GameEventDispatcher.instance.off(s.EventDefiner.ArenaMatchRace,this.updateInfo,this),r.GameEventDispatcher.instance.emit(s.EventDefiner.ArenaClean)},t.prototype.formatTime=function(e){var t=36e5,i=864e5,n=Math.ceil(e/i),o=Math.ceil((e-n*i)/t),a=Math.ceil((e-n*i-o*t)/6e4),r=Math.ceil((e-n*i-o*t-6e4*a)/1e3);Math.ceil(e-n*i-o*t-6e4*a-1e3*r);return n>1?n+c.default.getStr("Last_Time1"):c.default.getStr("Last_Time2")+"1"+c.default.getStr("Last_Time1")},t.prototype.initTime=function(){this.textTime.string=this.formatTime(this.newDataInfo.leftTime)},t.prototype.update=function(e){},t.prototype.shipAction=function(e,t,i,n){n.x=e*Math.cos(t*i*Math.PI/180)-82,n.y=e*Math.sin(t*i*Math.PI/180)-20},t.prototype.initInfo=function(e,t){this.newDataInfo=e;u.default.instance.arenaConfigs.levelInfo[1];e.todaywin>10&&(e.todaywin=10),this.textWinNum.string=e.todaywin+"";var i="";0==e.grade?(i=e.point,this.starNode.active=!1):(this.starNode.active=!0,i=u.default.instance.arenaConfigs.level[e.grade].gradeName+c.default.getStr("arenastart",e.star)),this.sprLevelNormal.getComponent(_.default).loadSpriteAtlas("ui/arena/ResArena","icon_duanwei "+u.default.instance.getDuanWeiResIndex(e.grade)),this.sprLevelNormal.getChildByName("textLevel").getComponent(cc.Label).string=i,this.updateStarNum(this.starNode,e.star),this.updateMatchInfo(e),null!=t&&(this.showPagePanel(2,t),this.showRewardBox())},t.prototype.onClearItem=function(){for(var e=this.rewardbox.getChildByName("rewardNode").getChildByName("layoutNode"),t=e.childrenCount-1;t>=0;t--)y.default.setNodeToPool(C.PoolType.ItemIcon,e.children[t]);e.removeAllChildren()},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),this.onClearItem()},t.prototype.onGetRewardBox=function(){this.rewardbox.getChildByName("34UIani_treasure box").active=!1,this.rewardbox.getChildByName("rewardNode").active=!0;var e=this.rewardbox.getChildByName("rewardNode").getChildByName("layoutNode");this.onClearItem(),w.default.instance.loadResByType(a.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(t){var i=Math.floor(u.default.instance.resultShowItemList.length/6);e.width=i>=1?900:150*u.default.instance.resultShowItemList.length;for(var n=0;n<u.default.instance.resultShowItemList.length;n++){var o=u.default.instance.resultShowItemList[n],r=y.default.getNodeByPool(C.PoolType.ItemIcon,t,a.GlobalContext.Root+"prefab/Bag/ItemIcon");r.getComponent(v.default).ItemData(o,!0,null,!0);e.addChild(r)}},this)},t.prototype.showRewardBox=function(){this.rewardbox.getChildByName("rewardNode").active=!1,this.rewardbox.getChildByName("34UIani_treasure box").active=!0,this.rewardbox.active=!0,this.rewardima.getComponent(cc.Sprite).spriteFrame=T.default.instance.getSpriteFrameByName("treasurebox"+u.default.instance.getDuanWeiResIndex(u.default.instance.lastarenaInfo.oldgrade))},t.prototype.onReceive=function(){this.rewardbox.active&&(this.onClearItem(),this.rewardbox.active=!1,u.default.instance.lastarenaInfo=null)},t.prototype.updateStarNum=function(e,t){for(var i in e.children)e.children[i].getComponent(cc.Sprite).spriteFrame=T.default.instance.getSpriteFrameByName("icon_xing2");for(var n=0;n<t;n++)e.children[n].getComponent(cc.Sprite).spriteFrame=T.default.instance.getSpriteFrameByName("icon_xing1")},t.prototype.initTeamModel=function(){this.teamNum=g.MonsterType.MonsterBattle+1,this.initTeam()},t.prototype.onChangeTeam=function(e,t){if(this.teamNum!=parseInt(t)){this.teamNum=parseInt(t),this.selectTeam();var i={cmd:"cardconf",battle:this.teamNum-1,config:g.MonsterType.MonsterWarTeam};d.default.instance.sendProto(i)}},t.prototype.selectTeam=function(){for(var e in this.lineUpNodeList)this.lineUpNodeList[e].getChildByName("btn").active=!0,this.lineUpNodeList[e].getChildByName("di").active=!1;this.lineUpNodeList[this.teamNum-1].getChildByName("btn").active=!1,this.lineUpNodeList[this.teamNum-1].getChildByName("di").active=!0,this.setBtnLineupInfo(this.teamNum-1)},t.prototype.initTeam=function(){this.selectTeam()},t.prototype.setBtnLineupInfo=function(e){Number(e);g.MonsterType.MonsterBattle=e,this.setLineup(e)},t.prototype.setLineup=function(e){var t=Number(e);if(this.lineupNode)for(var i in g.MonsterType.MonsterWarTeam[t]){var n=g.MonsterType.MonsterCardArr[g.MonsterType.MonsterWarTeam[t][i]];this.lineupNode.children[i].getComponent(b.default).initInfo(n.id,i)}},t.prototype.onStart=function(){if(u.default.instance.otherinfoStar=null,!this.matchNode.active){this.matchNode.active=!0,this.matchNode.getChildByName("exitmatch").active=!0;var e=this.matchNode.getChildByName("30UIani_pk").getChildByName("matchinfo");e.getChildByName("matching").active=!0,e.getChildByName("OtherInfo").active=!1,this.matchtime=0,this.matchNode.getChildByName("30UIani_pk").active=!0,this.matchNode.getChildByName("30UIani_pk").getComponent(cc.Animation).play("30ani_1"),this.inveltime=o.default.instance.setInterval(this.updateMatch,this,1e3),this.updateMatch(),a.PlayerData.TopPanel.active=!1,u.default.instance.sendMatch()}},t.prototype.updateMatch=function(){this.matchtime++,this.matchNode.getChildByName("30UIani_pk").getChildByName("matchinfo").getChildByName("matching").getChildByName("matchtime").getComponent(cc.Label).string=this.matchtime+""},t.prototype.clearMatch=function(){this.inveltime&&(o.default.instance.clearInterval(this.inveltime),this.inveltime=0,this.matchtime=0)},t.prototype.updateMatchInfo=function(e){u.default.instance.arenaConfigs.levelInfo[1];var t=this.matchNode.getChildByName("30UIani_pk"),i=t.getChildByName("matchinfo");i.getChildByName("matching").active=!0,i.getChildByName("OtherInfo").active=!1,i.getChildByName("MyInfo").getChildByName("RoleHead").getComponent(S.default).SetHead(f.MyRoleInfo.icon),i.getChildByName("MyInfo").getChildByName("myname").getComponent(cc.Label).string=f.MyRoleInfo.name,i.getChildByName("MyInfo").getChildByName("sex").getComponent(cc.Sprite).spriteFrame=T.default.instance.getSpriteFrameByName("gender_"+f.MyRoleInfo.sex);var n=t.getChildByName("icon_duanwei 4").getChildByName("starNode");t.getChildByName("icon_duanwei 4").getComponent(_.default).loadSpriteAtlas("ui/arena/ResArena","icon_duanwei "+u.default.instance.getDuanWeiResIndex(e.grade));var o="";0!=e.grade?(n.active=!0,o=u.default.instance.arenaConfigs.level[e.grade].gradeName+c.default.getStr("arenastart",e.star),this.updateStarNum(n,e.star)):(n.active=!1,o=e.point),t.getChildByName("icon_duanwei 4").getChildByName("mystart").getComponent(cc.Label).string=o},t.prototype.matchComplete=function(e){var t=this;this.clearMatch(),this.matchNode.getChildByName("exitmatch").active=!1;var i=e.getUserData(),n=this.matchNode.getChildByName("30UIani_pk"),a=n.getChildByName("matchinfo");a.getChildByName("matching").active=!1,a.getChildByName("OtherInfo").active=!0,a.getChildByName("OtherInfo").getChildByName("RoleHead").getComponent(S.default).SetHead(i.icon),a.getChildByName("OtherInfo").getChildByName("myname").getComponent(cc.Label).string=i.name,a.getChildByName("OtherInfo").getChildByName("sex").getComponent(cc.Sprite).spriteFrame=T.default.instance.getSpriteFrameByName("gender_"+i.gender);var d=n.getChildByName("icon_duanwei 5").getChildByName("starNode");n.getChildByName("icon_duanwei 5").getComponent(_.default).loadSpriteAtlas("ui/arena/ResArena","icon_duanwei "+u.default.instance.getDuanWeiResIndex(i.grade));var p="";0!=i.grade?(d.active=!0,p=u.default.instance.arenaConfigs.level[i.grade].gradeName+c.default.getStr("arenastart",i.star),this.updateStarNum(d,i.star)):(d.active=!1,p=i.point),n.getChildByName("icon_duanwei 5").getChildByName("otherstart").getComponent(cc.Label).string=p,this.matchNode.getChildByName("30UIani_pk").getComponent(cc.Animation).play("30ani_2"),this.matchNode.getChildByName("30UIani_pk").getComponent(cc.Animation).once("finished",function(){var e=o.default.instance.setTimeout(function(){t.oldDataInfo=t.newDataInfo,r.GameEventDispatcher.instance.emit(s.EventDefiner.ChangeGameScene,{status:l.GameScene.Fight,guanqiaId:l.GQIdType.Arena}),t.matchNode.active=!1,o.default.instance.clearTimeout(e)},t,500)},this)},t.prototype.onRanking=function(){m.default.instance.openWindow(p.WindowType.RankList)},t.prototype.onAdjust=function(){var e=this;m.default.instance.openWindow(p.WindowType.WarTeam,function(t){h.default.instance.closeCallback(e.initTeam,e)},this)},t.prototype.onCloseMatching=function(){u.default.instance.otherinfoStar||(this.clearMatch(),this.matchNode.active&&(this.matchNode.active=!1,a.PlayerData.TopPanel.active=!0,u.default.instance.sendCmdCancleMatch()))},t.prototype.showPagePanel=function(e,t){void 0===t&&(t=null),m.default.instance.openWindow(p.WindowType.ArenaRewardInfo,function(){I.default.instance.onInitData(e,t)},this)},t.prototype.onReward=function(){this.showPagePanel(1)},t.prototype.onJumpShop=function(){m.default.instance.openWindow(p.WindowType.Shop,function(){var e=D.default.instance.nowSortIndex[R.ShopConst.Honor];A.default.instance.openShopByTab(e)})},t.prototype.showTranslate=function(){this.translateNum.string=N.NumberUtil.getNumber(f.MyRoleInfo.honor)},t.prototype.hide=function(){e.prototype.hide.call(this),y.default.clearPoolToType(C.PoolType.arenaReward)},t.instance=null,__decorate([B(cc.Node)],t.prototype,"mainNode",void 0),__decorate([B(cc.Node)],t.prototype,"matchNode",void 0),__decorate([B(cc.Node)],t.prototype,"sprLevelNormal",void 0),__decorate([B(cc.Node)],t.prototype,"starNode",void 0),__decorate([B(cc.Label)],t.prototype,"textTime",void 0),__decorate([B(cc.Label)],t.prototype,"textLevel",void 0),__decorate([B(cc.Label)],t.prototype,"textWinNum",void 0),__decorate([B([cc.Node])],t.prototype,"lineUpNodeList",void 0),__decorate([B(cc.SpriteAtlas)],t.prototype,"arenaPlist",void 0),__decorate([B(cc.Node)],t.prototype,"lineupNode",void 0),__decorate([B(cc.Node)],t.prototype,"BtnLineupLayer",void 0),__decorate([B(cc.Node)],t.prototype,"rewardima",void 0),__decorate([B(cc.Node)],t.prototype,"rewardbox",void 0),__decorate([B(cc.Label)],t.prototype,"translateNum",void 0),t=i=__decorate([E],t)}(n.default);i.default=M,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/Window":"Window","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../NetConnect/NetConnet":"NetConnet","../../Util/NumberUtil":"NumberUtil","../../Util/Utils":"Utils","../Commons/Image":"Image","../Gamelayer/RoleHead":"RoleHead","../Item/ItemIcon":"ItemIcon","../OpenWin/OpenWinController":"OpenWinController","../Role/RoleInfo":"RoleInfo","../Shop/ShopConst":"ShopConst","../Shop/ShopController":"ShopController","../Shop/ShopModel":"ShopModel","../WarTeam/MonsterController":"MonsterController","../WarTeam/WarTeam":"WarTeam","./ArenaController":"ArenaController","./ArenaLineup":"ArenaLineup","./ArenaRewardInfoPage":"ArenaRewardInfoPage"}],ArtifactAttrItem:[function(e,t,i){"use strict";cc._RF.push(t,"7f476O/nMFDmpiJXfYvVxqS","ArtifactAttrItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Util/AttrUtil"),a=e("../Commons/CommonProgress"),r=e("../../Core/TimeController"),s=cc._decorator,l=s.ccclass,c=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.attrIcons=null,t.icon=null,t.attrName=null,t.addNum=null,t.pieceNode=null,t.tipsbg=null,t}return __extends(t,e),t.prototype.initData=function(e,t){this.type=e;var i=o.default.getAttrIconID(e);this.icon.spriteFrame=this.attrIcons.getSpriteFrame("attrIcon_"+i),this.attrName.string=o.default.getAttrName(e),this.tipsbg.active=t%2==0},t.prototype.updateData=function(e,t){this.pieceNode.getComponent(a.default).value=t,this.pieceNode.getChildByName("Label").getComponent(cc.Label).string=e.baseValue},t.prototype.updateAddNum=function(e){var t=this,i=this.pieceNode.getChildByName("Label").getComponent(cc.Label).string,n=Number(i)-e;this.pieceNode.getChildByName("Label").getComponent(cc.Label).string=n+"+"+e,this._timeOut=r.default.instance.setTimeout(function(){t.pieceNode&&(t.pieceNode.getChildByName("Label").getComponent(cc.Label).string=i),r.default.instance.clearTimeout(t._timeOut),t._timeOut=null},this,1e3)},Object.defineProperty(t.prototype,"type",{get:function(){return this._type},set:function(e){this._type=e},enumerable:!0,configurable:!0}),__decorate([c(cc.SpriteAtlas)],t.prototype,"attrIcons",void 0),__decorate([c(cc.Sprite)],t.prototype,"icon",void 0),__decorate([c(cc.Label)],t.prototype,"attrName",void 0),__decorate([c(cc.Label)],t.prototype,"addNum",void 0),__decorate([c(cc.Node)],t.prototype,"pieceNode",void 0),__decorate([c(cc.Node)],t.prototype,"tipsbg",void 0),t=__decorate([l],t)}(n.default);i.default=d,cc._RF.pop()},{"../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../../Util/AttrUtil":"AttrUtil","../Commons/CommonProgress":"CommonProgress"}],ArtifactCollectionCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"7110cRs2MVDAI6Y8Sdu3v6e","ArtifactCollectionCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("./ArtifactCollectionData"),a=e("../../Core/Event"),r=e("../../NetConnect/NetConnet"),s=e("../../Core/GameEventDispatcher"),l=cc._decorator,c=l.ccclass,d=(l.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.data=null,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.listNotification=function(){this.data=new o.default,i.instance=this},t.prototype.resArtifactCollectionInfo=function(e){this.data.setData(e),s.GameEventDispatcher.instance.emit(a.EventDefiner.ArtifactCollection_up_info)},t.prototype.reqArtifactCollectionInfo=function(){r.default.instance.sendProto({cmd:"artifactcollectioninfo"})},t.prototype.reqArtifactColleactivearti=function(e){var t={cmd:"artifactcolleactivearti",artiType:e};r.default.instance.sendProto(t)},t.prototype.reqArtifactColleactiveChip=function(e,t){var i={cmd:"artifactcolleactivechip",artiType:e,chipType:t};r.default.instance.sendProto(i)},t.prototype.reqArtifactcollection=function(e){var t={cmd:"artifactcollection",index:e};r.default.instance.sendProto(t)},t.instance=null,t=i=__decorate([c],t)}(n.default));i.default=d,cc._RF.pop()},{"../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../NetConnect/NetConnet":"NetConnet","./ArtifactCollectionData":"ArtifactCollectionData"}],ArtifactCollectionData:[function(e,t,i){"use strict";cc._RF.push(t,"93e17oA3q5MqIm8DLTEHaea","ArtifactCollectionData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/ConfigsManager"),o=e("../../Global/GlobalValue"),a=function(){function e(){this._cfg=null,this._curArtifact=null,this._curChip=null,this._data=null,this._cfg=n.ConfigsManager.instance.getConfigs("artifactcollectionconf")}return e.prototype.setData=function(e){this._curArtifact=e.curArtifact,this._curChip=e.curChip,this._data=e.data},e.prototype.getCurArtifact=function(){return this._curArtifact?this._curArtifact:0},e.prototype.getCurChip=function(){return this._curChip?this._curChip:0},e.prototype.getArtifacType=function(){var e=this.getCurArtifact()+1;return e>o.MaxArtifactNum&&(e=o.MaxArtifactNum),e},e.prototype.getAllChipInfo=function(){var e=this.getCurArtifact();return this._data[e]?this._data[e].chipInfo:null},e.prototype.getChipInfo=function(){var e=this.getCurArtifact();this._data&&e>=this._data.length&&(e-=1);var t=this.getCurChip();return this._data[e].chipInfo.length<=t?this._data[e].chipInfo[t-1]:this._data[e].chipInfo[t]},e.prototype.getArtifactName=function(){var e=this.getArtifacType();return this._cfg.artifactConf[e].name},e.prototype.getArtifacFragmentTotalNum=function(){var e=this.getArtifacType(),t=this._cfg.artifactConf[e].chip;return this._cfg.chip[t].length},e.prototype.getArtifacFragmentNum=function(){var e=this.getChipInfo();return e&&this.getArtifacFragmentTotalNum()>this.getCurChip()?e.active?0:this.getCurChip():this.getArtifacFragmentTotalNum()},e.prototype.getTaskData=function(){var e=this.getArtifacType(),t=this._cfg.artifactConf[e].chip,i=0;return i=this._cfg.chip[t].length<=this._curChip?this._cfg.chip[t][this._curChip-1].goal:this._cfg.chip[t][this._curChip]?this._cfg.chip[t][this._curChip].goal:0,this._cfg.goal[i]},e.prototype.getCurProg=function(){var e=0,t=this.getChipInfo();if(t){var i=t.rewardInfo;for(var n in i)i[n].rewardState>1&&(e+=1)}return e},e.prototype.getRewardFlag=function(){var e=this.getChipInfo();if(e){var t=e.rewardInfo;for(var i in t)if(1==t[i].rewardState)return!0}return!1},e}();i.default=a,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Global/GlobalValue":"GlobalValue"}],ArtifactCollectionItem:[function(e,t,i){"use strict";cc._RF.push(t,"d283aFofilEDpJANxtL3vl8","ArtifactCollectionItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/Language"),a=e("../Commons/RewardUtils"),r=e("../Item/ItemIcon"),s=e("./ArtifactCollectionCtrl"),l=e("../../Core/WindowType"),c=e("../Functionicon/FunctionIconController"),d=e("../OpenWin/OpenWinController"),p=e("../Commons/WindowOpenUtils"),h=e("../WarTeam/MonsterController"),u=e("../WarTeam/WarTeamMonsterInfo"),f=e("../../Core/LoadManager"),g=e("../../GlobalContext"),y=e("../../Util/Utils"),m=cc._decorator,C=m.ccclass,v=(m.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._taskData=null,t._rewardInfo=null,t._index=null,t}return __extends(t,e),t.prototype.setData=function(e,t,i){this.name="itemNode"+i,this._taskData=e,this._rewardInfo=t,this._index=i,this.setShowData()},t.prototype.setShowData=function(){var e=null;e=4==this._taskData.condType?o.default.getStr1(this._taskData.desc,[o.default.getStr("type"+this._taskData.condVal)]):24==this._taskData.condType?o.default.getStr1(this._taskData.desc,[o.default.getStr(""+this._taskData.condVal)]):o.default.getStr1(this._taskData.desc,this._taskData.condVal),this.node.getChildByName("title").getComponent(cc.Label).string=e;var t=a.default.instance.getItemList(this._taskData.rewardId),i=this.node.getChildByName("itemList").getComponent(cc.ScrollView);f.default.instance.loadResByType(g.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(e){for(var n in y.default.setNodeChildDestoryByUrl(i.content,g.GlobalContext.Root+"prefab/Bag/ItemIcon"),t){var o=y.default.getNodeByUrl(e,g.GlobalContext.Root+"prefab/Bag/ItemIcon");o.scale=.65,o.getComponent(r.default).ItemData(t[n],!0,null,!0),i.content.addChild(o)}},this),i.scrollToLeft(),this.node.getChildByName("img").active=2==this._rewardInfo.rewardState,this.node.getChildByName("btn").active=1==this._rewardInfo.rewardState,this.node.getChildByName("btn2").active=0==this._rewardInfo.rewardState},t.prototype.onClickBtn=function(e,t){if(e.type==cc.Node.EventType.TOUCH_END)switch(parseInt(t)){case 0:s.default.instance.reqArtifactcollection(this._index);break;case 1:var i=-1;switch(this._taskData.condType){case 1:return void p.default.instance.openWindowType(1);case 2:case 3:case 4:i=l.WindowType.RoleWin;break;case 5:case 6:case 7:case 8:case 9:case 10:i=l.WindowType.WarTeam;case 11:return void d.default.instance.openWindow(l.WindowType.WarTeam,function(){h.default.instance.openMonsterInfoPrefab(h.MonsterType.MonsterWarTeam[h.MonsterType.MonsterBattle][0],u.CardTag.upgrade,null,null,!1)});case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:return void d.default.instance.openWindow(l.WindowType.WarTeam,function(){h.default.instance.openMonsterInfoPrefab(h.MonsterType.MonsterWarTeam[h.MonsterType.MonsterBattle][0],u.CardTag.equip,null,null,!1)});case 21:return void d.default.instance.openWindow(l.WindowType.WarTeam,function(){h.default.instance.openMonsterInfoPrefab(h.MonsterType.MonsterWarTeam[h.MonsterType.MonsterBattle][0],u.CardTag.skill,null,null,!1)});case 22:i=l.WindowType.Artifact;break;case 23:case 24:i=l.WindowType.Totems}if(i>0)c.default.instance.checkIsOpenbyWindowtype(i,!0)&&d.default.instance.openWindow(i)}},t=__decorate([C],t)}(n.default));i.default=v,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/RewardUtils":"RewardUtils","../Commons/WindowOpenUtils":"WindowOpenUtils","../Functionicon/FunctionIconController":"FunctionIconController","../Item/ItemIcon":"ItemIcon","../OpenWin/OpenWinController":"OpenWinController","../WarTeam/MonsterController":"MonsterController","../WarTeam/WarTeamMonsterInfo":"WarTeamMonsterInfo","./ArtifactCollectionCtrl":"ArtifactCollectionCtrl"}],ArtifactCollectionView:[function(e,t,i){"use strict";cc._RF.push(t,"975dclnNWhAvLNSSoA+foHg","ArtifactCollectionView"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../../GlobalContext"),a=e("./ArtifactCollectionCtrl"),r=e("../../Util/GrayEffect"),s=e("../../Core/Language"),l=e("../Commons/Image"),c=e("../Commons/ListViewCtrl"),d=e("./ArtifactCollectionItem"),p=e("../../Core/GameEventDispatcher"),h=e("../../Core/Event"),u=e("../OpenWin/OpenWinController"),f=e("../../Core/WindowType"),g=e("../Guide/GuideNewController"),y=cc._decorator,m=y.ccclass,C=y.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layerContent=null,t._data=null,t._effectFlag=!1,t}return __extends(t,e),t.prototype.onLoad=function(){var t=this;this.onInit(f.WindowType.ArtifactCollection,!0);this.onInit(f.WindowType.ArtifactCollection,!0),this.loadWindowCom=function(){t.layerContent.setSiblingIndex(1)},this.loadWindowComThis=this,e.prototype.onLoad.call(this),this.node.getChildByName("node").width=o.GlobalContext.StageWidth,this.node.getChildByName("node").height=o.GlobalContext.StageHeight},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this),this._data=a.default.instance.data,a.default.instance.reqArtifactCollectionInfo(),p.GameEventDispatcher.instance.on(h.EventDefiner.ArtifactCollection_up_info,this.playEffect,this),this.upshowData()},t.prototype.hide=function(){e.prototype.hide.call(this),this._data=null,p.GameEventDispatcher.instance.off(h.EventDefiner.ArtifactCollection_up_info,this.playEffect,this)},t.prototype.upshowData=function(){this.setItemList(),this.setCenterData()},t.prototype.playEffect=function(){this.upshowData(),this._effectFlag&&this.effectOne()},t.prototype.setCenterData=function(){var e=this._data.getAllChipInfo();if(e){var t=this.node.getChildByName("node").getChildByName("center"),i=t.getChildByName("effectNode");for(var n in i.children){this.setImage(i.children[n],parseInt(n));var o=!!e&&e[n].active;this.setGrayEffect(i.children[n],o)}var a=this._data.getArtifactName(),r=this._data.getCurArtifact();t.getChildByName("desc").getChildByName("Label").getComponent(cc.Label).string=s.default.getStr("ac_"+r)+s.default.getStr("robbery_house_Exp",this._data.getArtifacFragmentNum(),this._data.getArtifacFragmentTotalNum()),t.getChildByName("desc2").getChildByName("Label").getComponent(cc.Label).string=s.default.getStr("\u6fc0\u6d3b{0}\u795e\u5668\u788e\u7247\u53ef\u6fc0\u6d3b:{1}",this._data.getArtifacFragmentTotalNum(),a);var l=this._data.getTaskData().length,c=this._data.getCurProg();t.getChildByName("desc3").getChildByName("node").getChildByName("Label").getComponent(cc.Label).string=s.default.getStr("ac_"+r)+s.default.getStr(""+(this._data.getCurChip()+1))+"(",t.getChildByName("desc3").getChildByName("node").getChildByName("Label2").getComponent(cc.Label).string=c+"/"+l;var d=null;d=c==l?new cc.Color(0,202,71):new cc.Color(255,0,0),t.getChildByName("desc3").getChildByName("node").getChildByName("Label2").color=d,t.getChildByName("btn").getComponent(cc.Button).interactable=c==l}},t.prototype.setItemList=function(){var e=this._data.getTaskData(),t=this.node.getChildByName("node").getChildByName("hightNode"),i=this.node.getChildByName("node").getChildByName("hightNode").getChildByName("ListViewCtrl");i.getComponent(c.default).refreshItem=this.updateitem,i.getComponent(c.default).refreshItemThis=this,i.getComponent(c.default).initialize(e),i.getComponent(c.default).scrollToTop(),t.getChildByName("desc1").getComponent(cc.Label).string=s.default.getStr("\u5b8c\u6210{0}\u4e2a\u6761\u4ef6\u53ef\u6fc0\u6d3b",e.length),t.getChildByName("desc2").getComponent(cc.Label).string=s.default.getStr("ac_"+this._data.getCurArtifact())+s.default.getStr(""+(this._data.getCurChip()+1))},t.prototype.updateitem=function(e,t){var i=this._data.getChipInfo();if(i){var n=this.node.getChildByName("node").getChildByName("hightNode").getChildByName("ListViewCtrl").getComponent(c.default).dataLsit[t];e.name="itemNode"+t,e.getComponent(d.default).setData(n,i.rewardInfo[t],t)}},t.prototype.onClickTips=function(){},t.prototype.onClickBtn=function(){a.default.instance.reqArtifactColleactiveChip(this._data.getCurArtifact(),this._data.getCurChip()),this._effectFlag=!0},t.prototype.setImage=function(e,t){var i="AC_"+this._data.getCurArtifact()+"_"+t,n=o.GlobalContext.ResRoot+"resources/ArtifactCollection/"+i+".png";e.getComponent(l.default).loadImageByHttps(n)},t.prototype.setGrayEffect=function(e,t){(e.getComponent(r.default)?e.getComponent(r.default):e.addComponent(r.default)).setGray(!t)},t.prototype.effectOne=function(){var e=this;this._effectFlag=!1;var t=this.node.getChildByName("node").getChildByName("effectNode");t.active=!0;var i=this._data.getCurChip(),n=this.node.getChildByName("node").getChildByName("center").getChildByName("effectNode").children[i-1].convertToWorldSpaceAR(cc.v2(0,0)),o=t.getChildByName("effect1");o.active=!0;var a=o.convertToNodeSpaceAR(n),r=o.getChildByName("img");this.setImage(r,i-1),r.active=!0,r.stopAllActions(),r.scale=0,r.opacity=255,r.x=0,r.y=0,r.runAction(cc.sequence(cc.scaleTo(.4,1,1),cc.moveTo(.6,a),cc.fadeOut(.2),cc.callFunc(function(){e._data.getArtifacFragmentNum()>=e._data.getArtifacFragmentTotalNum()?(g.default.instance.checkCondition(19,e._data.getCurArtifact()),e.effectTwo()):e.onClickMask()})))},t.prototype.effectTwo=function(){var e=this.node.getChildByName("node").getChildByName("effectNode").getChildByName("effect2");e.active=!0;var t=e.getChildByName("bg");t.stopAllActions(),t.scale=0,t.runAction(cc.sequence(cc.scaleTo(.4,1.2,1.2),cc.callFunc(function(){t.getChildByName("title").runAction(cc.sequence(cc.scaleTo(.2,1.5,1.5),cc.scaleTo(.2,1,1)))}),cc.scaleTo(.4,1,1),cc.callFunc(this.effecThree,this)))},t.prototype.effecThree=function(){var e=this,t=this.node.getChildByName("node").getChildByName("effectNode"),i=t.getChildByName("effect2"),n=i.getChildByName("img");n.active=!1;var r=i.getChildByName("btn");r.active=!1;var s=o.GlobalContext.ResRoot+"resources/Artifact/icon_"+this._data.getCurArtifact()+".png";n.getComponent(l.default).loadSpriteFrame(s,function(){n.active=!0,n.stopAllActions(),n.scale=0,n.runAction(cc.sequence(cc.scaleTo(.4,1.2,1.2),cc.scaleTo(.4,1,1),cc.callFunc(function(){t.getChildByName("MaskBg").on(cc.Node.EventType.TOUCH_START,e.onClickMask,e),a.default.instance.reqArtifactColleactivearti(e._data.getCurArtifact()),r.active=!0})))})},t.prototype.onClickJump=function(){u.default.instance.openWindow(f.WindowType.Artifact),this.onClickMask()},t.prototype.onClickMask=function(){var e=this.node.getChildByName("node").getChildByName("effectNode");e.active=!1,e.getChildByName("effect1").active=!1,e.getChildByName("effect2").active=!1},__decorate([C(cc.Node)],t.prototype,"layerContent",void 0),t=__decorate([m],t)}(n.default);i.default=v,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/Window":"Window","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/GrayEffect":"GrayEffect","../Commons/Image":"Image","../Commons/ListViewCtrl":"ListViewCtrl","../Guide/GuideNewController":"GuideNewController","../OpenWin/OpenWinController":"OpenWinController","./ArtifactCollectionCtrl":"ArtifactCollectionCtrl","./ArtifactCollectionItem":"ArtifactCollectionItem"}],ArtifactCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"a1f9e/7BAhJNKeHAOPmq65m","ArtifactCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("./ArtifactData"),a=e("../../NetConnect/NetConnet"),r=e("../../Core/Event"),s=e("../../Core/GameEventDispatcher"),l=e("../Functionicon/FunctionIconController"),c=e("../../Core/WindowType"),d=e("../Gamelayer/Interface/EventInterface"),p=e("../Status/StatusType"),h=cc._decorator,u=h.ccclass,f=(h.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.data=null,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.listNotification=function(){this.data=new o.default,i.instance=this,this.addProto(r.EventDefiner.ARTIFACT_INFO,this.resArtifactInfo,this),this.addProto(r.EventDefiner.ARTIFACT_UPGRADE_RESULT,this.resUpgraderesult,this),this.addProto(r.EventDefiner.ARTIFACT_FOSTER_RESULT,this.resFosterresult,this),this.addProto(r.EventDefiner.ARTIFACT_ATFCURSKILL_ID,this.resatfsetskill,this),this.addProto("atfinfo",this.setSkillId,this),s.GameEventDispatcher.instance.on("BagPackInfoChange",this.SetRedPoint,this)},t.prototype.setSkillId=function(e){var t=e.data;this.data.skillIdx=t.index,this.data.illusionSkillId=t.skillId,this.data.viceSkillIdx=t.vice_idx,this.data.viceSkillId=t.vice_skillId},t.prototype.getData=function(){return this.data},t.prototype.resArtifactInfo=function(e){this.data.setData(e.data),s.GameEventDispatcher.instance.emit(r.EventDefiner.ARTIFACT_UPDATE_ALL_SHOW),this.SetRedPoint()},t.prototype.resUpgraderesult=function(e){this.data.upData(e),s.GameEventDispatcher.instance.emit(r.EventDefiner.ARTIFACT_UPGRADE_STATUS,{data:e}),this.SetRedPoint()},t.prototype.resFosterresult=function(e){this.data.upData(e),s.GameEventDispatcher.instance.emit(r.EventDefiner.ARTIFACT_UPDATE_ELEMENT_SHOW,e.attr),this.SetRedPoint()},t.prototype.resatfsetskill=function(e){this.data.skillIdx=e.idx,this.data.viceSkillIdx=e.vice_idx,this.data.illusionSkillId=e.skillId,this.data.viceSkillId=e.vice_id,s.GameEventDispatcher.instance.emit(r.EventDefiner.ARTIFACT_SKILL)},t.prototype.reqArtifactInfo=function(){a.default.instance.sendProto({cmd:"atfinfo"})},t.prototype.reqArtifactLevelUp=function(e,t){var i={cmd:"atfstageup",idx:e,isauto:t};a.default.instance.sendProto(i)},t.prototype.reqArtifactConvert=function(e,t){var i={cmd:"atffoster",idx:e,isauto:t};a.default.instance.sendProto(i)},t.prototype.reqatfsetskill=function(e,t){void 0===t&&(t=1);var i={cmd:"atfsetskill",idx:e,type:t};a.default.instance.sendProto(i)},t.prototype.SetRedPoint=function(){var e=l.default.instance.checkIsOpenbyWindowtype(c.WindowType.Artifact);l.default.instance.FuncIconRedDeal(c.WindowType.Artifact,e&&this.upReddot()),s.GameEventDispatcher.instance.emit(d.EventInterface.ArtifactRed,e&&this.upReddot())},t.prototype.upReddot=function(){var e=this.data.artifactInfo;for(var t in e)if(this.data.getRedPoitFlag(parseInt(t)))return!0;return!1},t.prototype.sendCurUseSkill=function(){var e={cmd:"atfuseskill",skillId:this.data.illusionSkillId,type:p.ActivityStatus.value};a.default.instance.sendProto(e)},t.instance=null,t=i=__decorate([u],t)}(n.default));i.default=f,cc._RF.pop()},{"../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/WindowType":"WindowType","../../NetConnect/NetConnet":"NetConnet","../Functionicon/FunctionIconController":"FunctionIconController","../Gamelayer/Interface/EventInterface":"EventInterface","../Status/StatusType":"StatusType","./ArtifactData":"ArtifactData"}],ArtifactData:[function(e,t,i){"use strict";cc._RF.push(t,"5497butXdZOUaZxroaYig5U","ArtifactData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Global/GlobalValue"),o=e("../../Core/ConfigsManager"),a=e("../../Util/AttrUtil"),r=e("../Role/RoleInfo"),s=e("../Item/ItemController"),l=function(){function e(){this._artifactInfo=null,this._cfg=null,this._artifactAttr={},this._attrMap={},this.ArtifactFiveAttr={},this.artifactFiveFlag=!1,this._tabIndex=5,this._beforePower=0,this._skillIdx=0,this._viceSkillIdx=0,this._viceSkillId=0,this.skillIdsData={},this._cfg=o.ConfigsManager.instance.getConfigs("artifactconf");var e=this._cfg.artifactConf,t=1;for(var i in e)this.skillIdsData[e[i].skillId]={index:t,skillCD:e[i].skillCD},t++}return e.prototype.getSkillIndex=function(){if(this.illusionSkillId>=0)return this.skillIdsData[this.illusionSkillId].index},e.prototype.setData=function(e){this._artifactInfo=e.weaponry,this.artifactFiveFlag=!0,this.skillIdx=e.index,this.viceSkillIdx=e.vice_idx,this.setFightMap()},e.prototype.upData=function(e){this.artifactInfo[e.idx]=e.weaponry},Object.defineProperty(e.prototype,"artifactInfo",{get:function(){return this._artifactInfo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cfg",{get:function(){return this._cfg||(this._cfg=o.ConfigsManager.instance.getConfigs("artifactconf")),this._cfg},enumerable:!0,configurable:!0}),e.prototype.getFightVal=function(e){return Math.floor(this.cptFightValue(e))},e.prototype.cptFightValue=function(e){var t={},i=this.artifactInfo[e].attr;for(var n in i){var o=Number(n);i[n].baseValue&&(t[o]=i[n].baseValue)}return r.MyRoleInfo.Fight-r.MyRoleInfo.attr.TempCalCurrentFight(t,!0)},e.prototype.getAttrInocnIdxByType=function(e){var t=1;switch(e){case n.AttrType.ThunderAttack:case n.AttrType.ThunderDef:t=1;break;case n.AttrType.EarthAttack:case n.AttrType.EarthDef:t=2;break;case n.AttrType.WaterAttack:case n.AttrType.WaterDef:t=3;break;case n.AttrType.FireAttack:case n.AttrType.FireDef:t=4;break;case n.AttrType.WindAttack:case n.AttrType.WindDef:t=5;break;case n.AttrType.ThunderAttackRate:case n.AttrType.ThunderDefRate:t=1;break;case n.AttrType.EarthAttackRate:case n.AttrType.EarthDefRate:t=2;break;case n.AttrType.WaterAttackRate:case n.AttrType.WaterDefRate:t=3;break;case n.AttrType.FireAttackRate:case n.AttrType.FireDefRate:t=4;break;case n.AttrType.WindAttackRate:case n.AttrType.WindDefRate:t=5}return t},e.prototype.cptAttrRate=function(e){return Math.floor(e.baseValue/e.maxValue*1e4/100)/100},e.prototype.cptAttrVlaue=function(){this._attrMap={};for(var e=0;e<this._artifactInfo.length;++e){var t=this._artifactInfo[e].attr;for(var i in t)this.cptAttr(Number(i),t[i].baseValue)}},e.prototype.cptAttr=function(e,t){this._attrMap[e]?this._attrMap[e]+=t:this._attrMap[e]=t},e.prototype.setFightMap=function(){this._artifactAttr={};for(var e=0;e<this._artifactInfo.length;++e){this._artifactAttr[e]||(this._artifactAttr[e]=new Array);var t=this._artifactInfo[e].attr;for(var i in t){var n;n=t[i].baseValue,this._artifactAttr[e].push(n)}}},e.prototype.getSingleAttrNum=function(e){this.setArtifactFiveAttr();var t=0;for(var i in this.ArtifactFiveAttr){var n=a.default.getAttrIconID(Number(i));if(n==e){var o=1+this.ArtifactFiveAttr[Number(i)];t=this._attrMap[n]?this._attrMap[n]:0,t*=o}}return t},e.prototype.getSingleAttrNumTwo=function(e){return this.setArtifactFiveAttr(),e>=n.AttrType.ThunderAttackRate&&e<=n.AttrType.WindDefRate?this.ArtifactFiveAttr[Number(e)]?1e4*this.ArtifactFiveAttr[Number(e)]:0:this._attrMap[e]?this._attrMap[e]:0},e.prototype.setArtifactFiveAttr=function(){if(this.artifactFiveFlag){this.ArtifactFiveAttr={};for(var e=n.AttrType.ThunderAttackRate;e<=n.AttrType.WindDefRate;++e)if(this._attrMap[e]>=0){var t=this._attrMap[e]?this._attrMap[e]:0;this.ArtifactFiveAttr[e]=t}this.artifactFiveFlag=!1}},e.prototype.getRedPoitFlag=function(e){var t=this.artifactInfo[e];if(t.isActive){var i=this.cfg.artifactConf[e].stage,n=this.cfg.stage[i][t.stage],o=!1;for(var a in t.attr){if(!(this.cptAttrRate(t.attr[a])>=1)){o=!1;break}o=!0}var r=o?n.stageNeedItem:n.fosterNeedItem;if(s.default.instance.getItemNum(r[0].id)>=r[0].count)return!0}return!1},Object.defineProperty(e.prototype,"MorphologicalTag",{get:function(){return this._tabIndex},set:function(e){this._tabIndex!=e&&(this._tabIndex=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"beforePower",{get:function(){return this._beforePower},set:function(e){this._beforePower!=e&&(this._beforePower=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"skillIdx",{get:function(){return this._skillIdx},set:function(e){this._skillIdx!=e&&(this._skillIdx=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viceSkillIdx",{get:function(){return this._viceSkillIdx},set:function(e){this._viceSkillIdx!=e&&(this._viceSkillIdx=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"illusionSkillId",{get:function(){return this._illusionSkillId},set:function(e){this._illusionSkillId!=e&&(this._illusionSkillId=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viceSkillId",{get:function(){return this._viceSkillId},set:function(e){this._viceSkillId!=e&&(this._viceSkillId=e)},enumerable:!0,configurable:!0}),e}();i.default=l,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Global/GlobalValue":"GlobalValue","../../Util/AttrUtil":"AttrUtil","../Item/ItemController":"ItemController","../Role/RoleInfo":"RoleInfo"}],ArtifactEffectItem:[function(e,t,i){"use strict";cc._RF.push(t,"111defTQ8dBi4F4/EkRWqtf","ArtifactEffectItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Util/AttrUtil"),a=cc._decorator,r=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.attrIcons=null,t.attrIcon=null,t.attrName=null,t.attrUp=null,t.attrNum=null,t}return __extends(t,e),t.prototype.initData=function(e,t,i){var n=o.default.getAttrIconID(e);this.attrIcon.spriteFrame=this.attrIcons.getSpriteFrame("attrIcon_"+n),this.attrNum.string=t+"","left"==i?(this.attrName.string=o.default.getAttrName(e,!0),this.attrNum.node.color=new cc.Color(255,255,255),this.attrUp.active=!1):(this.attrName.string=o.default.getAttrName(e)+"\u4e0a\u9650",this.attrNum.node.color=new cc.Color(0,202,71),this.attrUp.active=!0)},__decorate([s(cc.SpriteAtlas)],t.prototype,"attrIcons",void 0),__decorate([s(cc.Sprite)],t.prototype,"attrIcon",void 0),__decorate([s(cc.Label)],t.prototype,"attrName",void 0),__decorate([s(cc.Node)],t.prototype,"attrUp",void 0),__decorate([s(cc.Label)],t.prototype,"attrNum",void 0),t=__decorate([r],t)}(n.default);i.default=l,cc._RF.pop()},{"../../Core/Widget":"Widget","../../Util/AttrUtil":"AttrUtil"}],ArtifactEffect:[function(e,t,i){"use strict";cc._RF.push(t,"3fd8emu+31B6orqPWhe0iiZ","ArtifactEffect"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/TimeController"),a=e("../../Core/WindowManager"),r=e("../../Util/NumberUtil"),s=e("../../Util/Utils"),l=e("../../GlobalContext"),c=e("../../Core/LoadManager"),d=e("../../Core/WindowType"),p=e("./ArtifactEffectItem"),h=e("../WarTeam/MonsterController"),u=cc._decorator,f=u.ccclass,g=u.property,y=function(e){function t(){var t=e.call(this)||this;return t.leftGroup=null,t.rightGroup=null,t.effect=null,i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.show=function(){var t=this;e.prototype.show.call(this);var i=this.effect.getChildByName("tishen2").getComponent(cc.Animation);i.play(),i&&i.on("finished",function(){var e=o.default.instance.setTimeout(function(){t.isClick=!0,o.default.instance.clearTimeout(e)},t,1e3)},this)},t.prototype.setActive=function(){this.isClick&&this.close()},t.prototype.close=function(){this.node.active=!1,a.default.instance.closeWindow(this.node)},t.prototype.initdata=function(e,t,i){var n=t.stage,o=e.stage[n][i.stage-1].attr,a=t.name,u=(i.stage,i.attr,e.attr[o]);this.leftGroup.getChildByName("img").getChildByName("Label").getComponent(cc.Label).string=r.NumberUtil.unitsDigitToText(i.stage)+"\u9636 "+a;var f=this.leftGroup.getChildByName("skill");f.getChildByName("skillName").getComponent(cc.Label).string=a,f.getChildByName("skillLevel").getComponent(cc.Label).string="Lv."+i.stage;var g=f.getChildByName("skillIcon").getChildByName("icon").getComponent(cc.Sprite);h.default.instance.setSkillPic(t.skillId,g);var y=this.leftGroup.getChildByName("attrCont");s.default.setNodeChildDestoryByUrl(y,l.GlobalContext.Root+"prefab/Artifact/ArtifactEffectItem"),c.default.instance.loadResByType(l.GlobalContext.Root+"prefab/Artifact/ArtifactEffectItem",cc.Prefab,function(e){for(var t in u){var i=s.default.getNodeByPool(d.PoolType.ArtifactEffectItem,e,l.GlobalContext.Root+"prefab/Artifact/ArtifactEffectItem");i.getComponent(p.default).initData(u[t].type,u[t].maxValue,"left"),y.addChild(i)}},this);var m=i.attr;this.rightGroup.getChildByName("img").getChildByName("Label").getComponent(cc.Label).string=r.NumberUtil.unitsDigitToText(i.stage+1)+"\u9636 "+a;var C=this.rightGroup.getChildByName("skill");C.getChildByName("skillName").getComponent(cc.Label).string=a,C.getChildByName("skillLevel").getComponent(cc.Label).string="Lv."+(i.stage+1);var v=C.getChildByName("skillIcon").getChildByName("icon").getComponent(cc.Sprite);h.default.instance.setSkillPic(t.skillId,v);var _=this.rightGroup.getChildByName("attrCont");s.default.setNodeChildDestoryByUrl(_,l.GlobalContext.Root+"prefab/Artifact/ArtifactEffectItem"),c.default.instance.loadResByType(l.GlobalContext.Root+"prefab/Artifact/ArtifactEffectItem",cc.Prefab,function(e){for(var t in m){var i=s.default.getNodeByPool(d.PoolType.ArtifactEffectItem,e,l.GlobalContext.Root+"prefab/Artifact/ArtifactEffectItem");i.getComponent(p.default).initData(Number(t),m[t].maxValue,"right"),_.addChild(i)}},this)},t.instance=null,__decorate([g(cc.Node)],t.prototype,"leftGroup",void 0),__decorate([g(cc.Node)],t.prototype,"rightGroup",void 0),__decorate([g(cc.Node)],t.prototype,"effect",void 0),t=i=__decorate([f],t)}(n.default);i.default=y,cc._RF.pop()},{"../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/NumberUtil":"NumberUtil","../../Util/Utils":"Utils","../WarTeam/MonsterController":"MonsterController","./ArtifactEffectItem":"ArtifactEffectItem"}],ArtifactEquip:[function(e,t,i){"use strict";cc._RF.push(t,"5f83eZ+rIlIcpQ8T2B5iZoS","ArtifactEquip"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/Language"),a=e("./ArtifactCtrl"),r=e("../Tips/OpTipsController"),s=e("../Scene/Controller/SkillController"),l=cc._decorator,c=l.ccclass,d=l.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.arfimgs=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.hide=function(){e.prototype.hide.call(this)},t.prototype.initData=function(e,t){this._index=e,this._type=t,this.node.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=this.arfimgs.getSpriteFrame("artifactIcon_"+e),this.node.getChildByName("name").getComponent(cc.Sprite).spriteFrame=this.arfimgs.getSpriteFrame("i18n_artifact_"+e)},t.prototype.onclick=function(){if(a.default.instance.reqatfsetskill(this._index,this._type),this.node.parent.parent.active=!1,1==this._type)r.default.instance.ShowMsg(o.default.getStr("\u51fa\u6218\u6210\u529f"));else{var e=a.default.instance.getData(),t=e.artifactInfo[this._index].stage+1,i=e.cfg.artifactConf[this._index],n=s.default.instance.getSkillDescBySkillIdAndLv(i.viceSkillId,t);r.default.instance.ShowMsg(o.default.getStr("\u6fc0\u6d3b\u526f\u795e\u5668,{0}",n))}},__decorate([d(cc.SpriteAtlas)],t.prototype,"arfimgs",void 0),t=__decorate([c],t)}(n.default);i.default=p,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/Widget":"Widget","../Scene/Controller/SkillController":"SkillController","../Tips/OpTipsController":"OpTipsController","./ArtifactCtrl":"ArtifactCtrl"}],ArtifactSkillTips:[function(e,t,i){"use strict";cc._RF.push(t,"83376giQqtIYbZq++eg8ZsV","ArtifactSkillTips"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../Scene/Controller/SkillController"),a=e("../WarTeam/MonsterController"),r=cc._decorator,s=r.ccclass,l=r.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.skillName=null,t.skillIcon=null,t.skillText=null,t.viceSkillText=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.hide=function(){e.prototype.hide.call(this)},t.prototype.init=function(e,t){var i=e.cfg.artifactConf[t];this.skillName.string=i.name;var n=e.artifactInfo[t].stage+1;this.skillText.string=o.default.instance.getSkillDescBySkillIdAndLv(i.skillId,n),this.viceSkillText.string=o.default.instance.getSkillDescBySkillIdAndLv(i.viceSkillId,n);var r=this.skillIcon.getComponent(cc.Sprite);a.default.instance.setSkillPic(i.skillId,r)},__decorate([l(cc.Label)],t.prototype,"skillName",void 0),__decorate([l(cc.Node)],t.prototype,"skillIcon",void 0),__decorate([l(cc.Label)],t.prototype,"skillText",void 0),__decorate([l(cc.Label)],t.prototype,"viceSkillText",void 0),t=__decorate([s],t)}(n.default);i.default=c,cc._RF.pop()},{"../../Core/Widget":"Widget","../Scene/Controller/SkillController":"SkillController","../WarTeam/MonsterController":"MonsterController"}],ArtifactUtils:[function(e,t,i){"use strict";cc._RF.push(t,"6cd9d9+hANGTLf8kRshJxSS","ArtifactUtils"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./ArtifactCtrl"),o=function(){function e(){}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.prototype.setArtifactProp=function(e){var t=n.default.instance.getData(),i=t.cfg.artifactConf[t.viceSkillIdx];if(i)for(var o=i.skillAttr,a=0;a<o.length;a+=2){var r=o[a],s=o[a+1];o[r]?o[r]+=s:o[r]=s}return{}},e}();i.default=o,cc._RF.pop()},{"./ArtifactCtrl":"ArtifactCtrl"}],ArtifactView:[function(e,t,i){"use strict";cc._RF.push(t,"25907Xt+sNAOLwQ+iVv8TVq","ArtifactView"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("./ArtifactCtrl"),a=e("../../Core/Language"),r=e("../../GlobalContext"),s=e("../../Core/GameEventDispatcher"),l=e("../../Core/Event"),c=e("../Item/ItemModel"),d=e("../../Global/GlobalValue"),p=e("../Commons/CommonProgress"),h=e("../Item/ItemData"),u=e("../../Core/TimeController"),f=e("../../Util/AttrUtil"),g=e("../Commons/Image"),y=e("../Role/RoleInfo"),m=e("../../Core/WindowType"),C=e("../../Core/LoadManager"),v=e("../../Util/Utils"),_=e("../Item/ItemController"),b=e("../../Util/RechargeUtils"),T=e("../../Util/RechargeConst"),S=e("../Role/RoleStrengthen/RoleStrengthenController"),I=e("../Role/RoleStrengthen/RoleStrengthenEvent"),w=e("../../Util/NumberUtil"),D=e("../Sound/SoundController"),R=e("./ArtifactAttrItem"),A=e("../Item/ItemIcon"),N=e("../../Core/WindowManager"),L=e("./ArtifactEffect"),E=e("./ArtifactSkillTips"),B=e("../Tips/OpTipsController"),M=e("../WarTeam/MonsterController"),x=e("../Scene/Pool/SpinePools"),k=e("../../Core/SpineBase"),P=e("../Tips/TipsWinController"),G=cc._decorator,F=G.ccclass,W=G.property,U=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.equipListNode=[],t.pieceNode=null,t.otherNode=null,t.toggle=null,t.damage=null,t.combatGroup=null,t.weaponName=null,t.btnLabel=null,t.itemNum=null,t.autoBuyLabel=null,t.openLabel=null,t.artifactNode=null,t.artifactImgs=null,t.artifactGray=null,t.layerContent=null,t.attrContent=null,t.peiyang=null,t.tupo=null,t.openCondition=null,t.openCondLabel=null,t.iconNum=null,t.skillLevel=null,t.skillName=null,t.titleLabel=null,t.rightGroup=null,t.skillTips=null,t.fireBtn=null,t.fightNode=null,t.isFrist=!1,t.artifactIndex=null,t.data=null,t._bless=0,t.timeOut=null,t}return __extends(t,e),t.prototype.onLoad=function(){var t=this;this.onInit(m.WindowType.Artifact,!0),this.loadWindowCom=function(){t.layerContent.setSiblingIndex(1)},this.loadWindowComThis=this,e.prototype.onLoad.call(this),this.node.getChildByName("node").width=r.GlobalContext.StageWidth,this.node.getChildByName("node").height=r.GlobalContext.StageHeight},t.prototype.show=function(){e.prototype.show.call(this),this.artifactIndex=0,this.toggle.isChecked=!1,r.PlayerData.TopPanel.active=!1,this.data=o.default.instance.getData(),o.default.instance.reqArtifactInfo(),this.initLeftShow(),this.upSpine(),s.GameEventDispatcher.instance.on(l.EventDefiner.ARTIFACT_UPDATE_ALL_SHOW,this.upShow,this),s.GameEventDispatcher.instance.on(l.EventDefiner.ARTIFACT_UPGRADE_STATUS,this.effect,this),s.GameEventDispatcher.instance.on(l.EventDefiner.ARTIFACT_UPDATE_ELEMENT_SHOW,this.upElemeentShow,this),s.GameEventDispatcher.instance.on(l.EventDefiner.MorphologicalTags_onClick,this.MorphologicalTag,this),s.GameEventDispatcher.instance.on(l.EventDefiner.ARTIFACT_SKILL,this.setSkill,this),s.GameEventDispatcher.instance.on("BagPackInfoChange",this.upShow,this)},t.prototype.initMorphological=function(){},t.prototype.hide=function(){e.prototype.hide.call(this),this.artifactIndex=null,this.data.beforePower=0,this.data=null,r.PlayerData.TopPanel.active=!0,this.isFrist=!1,s.GameEventDispatcher.instance.off(l.EventDefiner.ARTIFACT_UPDATE_ALL_SHOW,this.upShow,this),s.GameEventDispatcher.instance.off(l.EventDefiner.ARTIFACT_UPGRADE_STATUS,this.effect,this),s.GameEventDispatcher.instance.off(l.EventDefiner.ARTIFACT_UPDATE_ELEMENT_SHOW,this.upElemeentShow,this),s.GameEventDispatcher.instance.off(l.EventDefiner.MorphologicalTags_onClick,this.MorphologicalTag,this),s.GameEventDispatcher.instance.off(l.EventDefiner.ARTIFACT_SKILL,this.setSkill,this),s.GameEventDispatcher.instance.off("BagPackInfoChange",this.upShow,this);var t=this.artifactNode.children[0];x.SpinePools.recoverSpineNoder(t),this.artifactNode.removeAllChildren()},t.prototype.effect=function(e){var t=e.getUserData().data;t.ret.isSuc&&(D.default.instance.PlayEffect(D.SoundType.upSucceeds),this.playEffect(t),this.isClick=!1),this.data.beforePower=0,this.effectAddAttr("zhufu",t.ret.value),this.upShow()},t.prototype.playEffect=function(e){var t=this.data.cfg,i=t.artifactConf[this.artifactIndex];N.default.instance.open(m.WindowType.ArtifactEffect,function(){L.default.instance.initdata(t,i,e.weaponry)},this)},t.prototype.setSkill=function(){var e=this.data.artifactInfo;if(e){var t=e[this.artifactIndex];this.fireBtn.active=t.isActive;var i=this.data.cfg.artifactConf[this.artifactIndex],n=this.fightNode.getChildByName("skillBtn").getChildByName("skillIcon"),o=n.getComponent(cc.Sprite);M.default.instance.setSkillPic(i.skillId,o);var a=n.getComponent(cc.Button);for(var r in t.isActive?(a.interactable=!0,this.artifactIndex==this.data.skillIdx?(this.fireBtn.active=!1,this.fightNode.getChildByName("infire").active=!0):(this.fireBtn.active=!0,this.fightNode.getChildByName("infire").active=!1)):(a.interactable=!1,this.fightNode.getChildByName("infire").active=!1),this.equipListNode)this.equipListNode[r].getChildByName("fireicon").active=!1;if(this.data.skillIdx>=0){var s=this.equipListNode[this.data.skillIdx].getChildByName("fireicon");s.active=!0,s.getComponent(cc.Sprite).spriteFrame=this.artifactImgs.getSpriteFrame("i18n_zhan")}if(this.data.viceSkillIdx>=0){var l=this.equipListNode[this.data.viceSkillIdx].getChildByName("fireicon");l.active=!0,l.getComponent(cc.Sprite).spriteFrame=this.artifactImgs.getSpriteFrame("i18n_fu")}}},t.prototype.upElemeentShow=function(e){var t=Number(e.detail.type),i=e.detail.value;D.default.instance.PlayEffect(D.SoundType.upSucceeds),this.fosterEffect(t),this.effectAddAttr(t,i)},t.prototype.fosterEffect=function(e){var t=this,i=this.attrContent.getChildByName("ArtifactAttrItem"+e).getComponent(R.default),n=this.artifactNode.convertToWorldSpaceAR(new cc.Vec2(0,0));n=this.node.convertToNodeSpaceAR(n);var o=i.node.convertToWorldSpaceAR(new cc.Vec2(0,0));o=this.node.convertToNodeSpaceAR(o),C.default.instance.loadResByType(r.GlobalContext.Root+"effects/prefabs/cardLevel/effect",cc.Prefab,function(e){var i=v.default.getNodeByUrl(e,r.GlobalContext.Root+"effects/prefabs/cardLevel/effect");i.position=cc.v2(n.x,n.y);var a=cc.v2(o.x,o.y);t.node.addChild(i),i.runAction(cc.sequence(cc.moveTo(1,a.x,a.y),cc.fadeOut(.5),cc.callFunc(function(){t.node.removeChild(i),v.default.setNodeDestoryByUrl(i,r.GlobalContext.Root+"effects/prefabs/cardLevel/effect")})))},this),this.upShow()},t.prototype.effectAddAttr=function(e,t){var i=this.otherNode.getChildByName("addNum"),n=i.getChildByName("label");n.getComponent(cc.Label).string="zhufu"==e?"\u795d\u798f\u503c+"+t:f.default.getAttrName(e)+"+"+t,i.stopAllActions(),i.y=0,i.opacity=0,i.runAction(cc.sequence(cc.spawn(cc.moveBy(.5,0,40),cc.fadeIn(1)),cc.delayTime(.5),cc.spawn(cc.moveBy(.5,0,80),cc.fadeOut(1))))},t.prototype.initLeftShow=function(){var e=this.data.artifactInfo;if(e)for(var t=0;t<this.equipListNode.length;++t)this.equipListNode[t].getChildByName("bg2").active=t==this.artifactIndex,this.equipListNode[t].getChildByName("artifactName").active=e[t].isActive,this.equipListNode[t].getChildByName("lock").active=!e[t].isActive},t.prototype.upShow=function(){this.initLeftShow(),this.upElement(),this.upFightingCapacity(),this.upOther(),this.upMoney(),this.setSkill(),this.upRedPoit()},t.prototype.upElement=function(){var e=this,t=this.data.artifactInfo;if(t){var i=t[this.artifactIndex].attr,n=0;v.default.setNodeChildDestoryByUrl(this.attrContent,r.GlobalContext.Root+"prefab/Artifact/ArtifactAttrItem"),C.default.instance.loadResByType(r.GlobalContext.Root+"prefab/Artifact/ArtifactAttrItem",cc.Prefab,function(t){for(var o in i){var a=v.default.getNodeByPool(m.PoolType.ArtifactAttrItem,t,r.GlobalContext.Root+"prefab/Artifact/ArtifactAttrItem");a.getComponent(R.default).initData(Number(o),n),e.attrContent.addChild(a),a.name="ArtifactAttrItem"+Number(o),e.setElementData(a,i[o]),n++}},this)}},t.prototype.setElementData=function(e,t){var i=this.data.cptAttrRate(t);i>1&&(i=1),e.getComponent(R.default).updateData(t,i)},t.prototype.setOneAtter=function(e,t){this.attrContent.getChildByName("ArtifactAttrItem"+e).getComponent(R.default).updateAddNum(t)},t.prototype.getLevStr=function(e){var t="",i=f.default.getAttrName(e.attr[0].type);if(e.attr.length>1){var n=f.default.getAttrName(e.attr[1].type);t=a.default.getStr("{0}/{1} lv:{2}",i,n,e.level)}else t=a.default.getStr("{0} lv:{1}",i,e.level);return t},t.prototype.getAttrValueStr=function(e){return e.attr[0].type>=d.AttrType.ThunderAttackRate&&e.attr[0].type<=d.AttrType.WindDefRate?a.default.getStr("{0}/{1}",e.attr[0].curVal/100+"%",e.attr[0].needVal/100+"%"):a.default.getStr("{0}/{1}",e.attr[0].curVal,e.attr[0].needVal)},t.prototype.getUpFlag=function(e){e.stage;var t,i=e.attr;for(var n in i){if(!(this.data.cptAttrRate(i[n])>=1)){t=!1;break}t=!0}return!!t},t.prototype.upSpine=function(){var e=this,t=this.data.artifactInfo,i=t[this.artifactIndex];if(t){if(i.isActive){var n=this.artifactNode.children[0];x.SpinePools.recoverSpineNoder(n),this.artifactNode.removeAllChildren();var o="sp"+(Number(this.artifactIndex)+1),a="sp"+(Number(this.artifactIndex)+1)+"_2";if(0==this.artifactNode.childrenCount){var s=x.SpinePools.addSpineNoder(this.artifactNode,cc.v2(0,0)),l=s.getComponent(k.default);l.readlySpineCall=function(){var t=u.default.instance.setTimeout(function(){s.stopAllActions(),l.loop=!0,u.default.instance.clearTimeout(t)},e,100)},l.readlySpineCallThisObj=this,l.initSpineData("spine/Artifact/Artifact",o,a,!0)}}else{var c=r.GlobalContext.ResRoot+"resources/Artifact/bg_hui"+(this.artifactIndex+1)+".png";switch(this.artifactGray.getComponent(g.default).loadImageByHttps(c),this.artifactIndex){case 0:this.artifactGray.rotation=50;break;case 2:case 4:this.artifactGray.rotation=-30;break;default:this.artifactGray.rotation=0}}this.artifactNode.active=i.isActive,this.artifactGray.active=!i.isActive}},t.prototype.upFightingCapacity=function(){var e=this.data.getFightVal(this.artifactIndex);this.damage.string=e+"";this.data.beforePower;this.data.beforePower=e,u.default.instance.clearTimeout(this.timeOut),this.timeOut=null},t.prototype.upOther=function(){var e=this.data.artifactInfo;if(e){var t=e[this.artifactIndex];this.otherNode.getChildByName("node").active=t.isActive,this.otherNode.getChildByName("notOpen").active=!t.isActive;var i=this.getUpFlag(t),n=this.data.cfg,o=n.artifactConf[this.artifactIndex];if(t.stage+1>=d.MaxArtifactAttrLevel&&i)return this.rightGroup.getChildByName("bg_ditu").active=!1,this.rightGroup.getChildByName("otherNode").active=!1,this.rightGroup.getChildByName("man").active=!0,this.openCondition.active=!1,this.titleLabel.string=w.NumberUtil.unitsDigitToText(t.stage+1)+"\u9636 "+o.name,this.skillLevel.string=a.default.getStr("lv.{0}",t.stage+1),this.skillName.string=o.skillName,void(this.weaponName.string=o.name);this.rightGroup.getChildByName("bg_ditu").active=!0,this.rightGroup.getChildByName("otherNode").active=!0,this.rightGroup.getChildByName("man").active=!1;var r=o.stage,s=n.stage[r][t.stage],l=i?s.stageNeedItem:s.fosterNeedItem,c=h.default.creatItem(l[0].id,1),u=_.default.instance.getItemNum(l[0].id);if(u>=l[0].count)var f=!0;else f=!1;if(this.skillLevel.string=a.default.getStr("lv.{0}",t.stage+1),this.skillName.string=o.skillName,this.titleLabel.string=o.name,this.weaponName.string=o.name,t.isActive){this.openCondition.active=!1;t.attr;this.btnLabel.string=i?a.default.getStr("\u7a81 \u7834"):a.default.getStr("\u6ce8 \u7075"),this.tupo.active=i,this.peiyang.active=!i;var g=this.otherNode.getChildByName("node").getChildByName("num");if(g.getChildByName("icon").active=i,g.getChildByName("value").active=i,this.titleLabel.string=w.NumberUtil.unitsDigitToText(t.stage+1)+"\u9636 "+o.name,i){this.itemNum.string=a.default.getStr("{0}/{1}",u,l[0].count),this.autoBuyLabel.string="\u81ea\u52a8\u8d2d\u4e70",this.setItemIcon(c),this._bless=t.bless;var y=s.needBlessValue,m=t.bless/y;this.pieceNode.getComponent(p.default).value=m,this.pieceNode.getChildByName("Label").getComponent(cc.Label).string=a.default.getStr("{0}/{1}",t.bless?t.bless:0,y)}else{this.openLabel.string="<color=#5c3c34>\u6240\u6709\u5c5e\u6027\u6ce8\u7075\u6ee1\u540e\u53ef</c><color=#87361c>\u5347\u9636</color>";var C=(b=this.iconNum.getChildByName("layout")).getChildByName("iconHaveNum"),v=b.getChildByName("iconNeedNum");C.color=f?new cc.Color(255,255,255):new cc.Color(255,0,0),C.getComponent(cc.Label).string=u+"",v.getComponent(cc.Label).string=l[0].count+"",this.itemNum.string="",this.autoBuyLabel.string="\u9053\u5177\u4e0d\u8db3\u65f6\u81ea\u52a8\u8d2d\u4e70",this.setPeiyangIcon(c)}}else{this.openCondition.active=!0,this.tupo.active=!1,this.peiyang.active=!0,this.skillLevel.string="";var b;C=(b=this.iconNum.getChildByName("layout")).getChildByName("iconHaveNum"),v=b.getChildByName("iconNeedNum");C.color=f?new cc.Color(255,255,255):new cc.Color(255,0,0),C.getComponent(cc.Label).string=u+"",v.getComponent(cc.Label).string=l[0].count+"",this.setPeiyangIcon(c),this.openLabel.string="<color=#5c3c34>\u6fc0\u6d3b\u795e\u5668\u53ef\u6ce8\u7075</c><color=#87361c>\u5347\u7ea7</color><color=#5c3c34>\u5c5e\u6027</c>";var T=this.data.cfg.artifactConf,S=T[this.artifactIndex].chapter,I=T[this.artifactIndex].section;this.openCondLabel.string=a.default.getStr("\u901a\u8fc7\u4e3b\u7ebf{0}\u7ae0{1}\u5173",S,I)}}},t.prototype.onClickdArtifact=function(e,t){this.artifactIndex!=t&&(this.equipListNode[this.artifactIndex].getChildByName("bg2").active=!1,this.artifactIndex=Number(t),this.data.beforePower=0,this.upShow(),this.upSpine())},t.prototype.onclickElement=function(e,t){},t.prototype.onClickBtn=function(){var e=this,t=this.data.artifactInfo[this.artifactIndex],i=this.getUpFlag(t),n=this.data.cfg,a=n.artifactConf[this.artifactIndex].stage,r=n.stage[a][t.stage],s=i?r.stageNeedItem:r.fosterNeedItem;if(c.default.getCountByid(s[0].id)<s[0].count&&!this.isFrist&&!this.toggle.isChecked){this.isFrist=!0;P.default.instance.ShowTips("\u662f\u5426\u4f7f\u7528\u81ea\u52a8\u8d2d\u4e70",function(){e.toggle.isChecked=!0},null,null,1,null,null,function(){b.default.PurchaseItemOrRechage(T.RechargeTypeConst.Prop,s[0].count,null,e,s[0].id)})}else i?o.default.instance.reqArtifactLevelUp(this.artifactIndex,this.toggle.isChecked):(S.default.instence.setImgState(I.RoleImgType.Injection),o.default.instance.reqArtifactConvert(this.artifactIndex,this.toggle.isChecked))},t.prototype.setItemIcon=function(e){var t=this.otherNode.getChildByName("node").getChildByName("num").getChildByName("icon"),i=r.GlobalContext.ResRoot+"resources/itemicon/"+e.ItemIcon+".png";v.default.setImage(t,i)},t.prototype.setPeiyangIcon=function(e){var t=this.peiyang.getChildByName("icon");t.getComponent(A.default).ItemData(e,!0,null,!0),t.scale=.8},t.prototype.upMoney=function(){this.node.getChildByName("node").getChildByName("gold").getChildByName("num").getComponent(cc.Label).string=w.NumberUtil.getDiamondNum(y.MyRoleInfo.diamond)},t.prototype.upRedPoit=function(){this.data.artifactInfo;for(var e=0;e<this.equipListNode.length;++e){var t=o.default.instance.getData().getRedPoitFlag(e);this.equipListNode[e].getChildByName("red").active=t}this.otherNode.getChildByName("node").getChildByName("btn").getChildByName("red").active=o.default.instance.getData().getRedPoitFlag(this.artifactIndex)},t.prototype.MorphologicalTag=function(e){var t=e.getUserData().tabIndex;o.default.instance.getData().MorphologicalTag=t,this.upShow()},t.prototype.onclickOpenTips=function(){this.skillTips.active=!0,this.skillTips.getComponent(E.default).init(this.data,this.artifactIndex)},t.prototype.onClickCloseTips=function(){this.skillTips.active=!1},t.prototype.onClickSetSkill=function(){B.default.instance.ShowMsg(a.default.getStr("\u51fa\u6218\u6210\u529f")),o.default.instance.reqatfsetskill(this.artifactIndex,1)},__decorate([W([cc.Node])],t.prototype,"equipListNode",void 0),__decorate([W(cc.Node)],t.prototype,"pieceNode",void 0),__decorate([W(cc.Node)],t.prototype,"otherNode",void 0),__decorate([W(cc.Toggle)],t.prototype,"toggle",void 0),__decorate([W(cc.Label)],t.prototype,"damage",void 0),__decorate([W(cc.Node)],t.prototype,"combatGroup",void 0),__decorate([W(cc.Label)],t.prototype,"weaponName",void 0),__decorate([W(cc.Label)],t.prototype,"btnLabel",void 0),__decorate([W(cc.Label)],t.prototype,"itemNum",void 0),__decorate([W(cc.Label)],t.prototype,"autoBuyLabel",void 0),__decorate([W(cc.RichText)],t.prototype,"openLabel",void 0),__decorate([W(cc.Node)],t.prototype,"artifactNode",void 0),__decorate([W(cc.SpriteAtlas)],t.prototype,"artifactImgs",void 0),__decorate([W(cc.Node)],t.prototype,"artifactGray",void 0),__decorate([W(cc.Node)],t.prototype,"layerContent",void 0),__decorate([W(cc.Node)],t.prototype,"attrContent",void 0),__decorate([W(cc.Node)],t.prototype,"peiyang",void 0),__decorate([W(cc.Node)],t.prototype,"tupo",void 0),__decorate([W(cc.Node)],t.prototype,"openCondition",void 0),__decorate([W(cc.Label)],t.prototype,"openCondLabel",void 0),__decorate([W(cc.Node)],t.prototype,"iconNum",void 0),__decorate([W(cc.Label)],t.prototype,"skillLevel",void 0),__decorate([W(cc.Label)],t.prototype,"skillName",void 0),__decorate([W(cc.Label)],t.prototype,"titleLabel",void 0),__decorate([W(cc.Node)],t.prototype,"rightGroup",void 0),__decorate([W(cc.Node)],t.prototype,"skillTips",void 0),__decorate([W(cc.Node)],t.prototype,"fireBtn",void 0),__decorate([W(cc.Node)],t.prototype,"fightNode",void 0),t=__decorate([F],t)}(n.default);i.default=U,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/SpineBase":"SpineBase","../../Core/TimeController":"TimeController","../../Core/Window":"Window","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/AttrUtil":"AttrUtil","../../Util/NumberUtil":"NumberUtil","../../Util/RechargeConst":"RechargeConst","../../Util/RechargeUtils":"RechargeUtils","../../Util/Utils":"Utils","../Commons/CommonProgress":"CommonProgress","../Commons/Image":"Image","../Item/ItemController":"ItemController","../Item/ItemData":"ItemData","../Item/ItemIcon":"ItemIcon","../Item/ItemModel":"ItemModel","../Role/RoleInfo":"RoleInfo","../Role/RoleStrengthen/RoleStrengthenController":"RoleStrengthenController","../Role/RoleStrengthen/RoleStrengthenEvent":"RoleStrengthenEvent","../Scene/Pool/SpinePools":"SpinePools","../Sound/SoundController":"SoundController","../Tips/OpTipsController":"OpTipsController","../Tips/TipsWinController":"TipsWinController","../WarTeam/MonsterController":"MonsterController","./ArtifactAttrItem":"ArtifactAttrItem","./ArtifactCtrl":"ArtifactCtrl","./ArtifactEffect":"ArtifactEffect","./ArtifactSkillTips":"ArtifactSkillTips"}],AsyncResObj:[function(e,t,i){"use strict";cc._RF.push(t,"9b6231whuBFRJq3/ocDmc65","AsyncResObj"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Global/GlobalValue"),o=e("../../../Core/SpineBase"),a=e("../Manager/SceneManager"),r=e("../../../GlobalContext"),s=cc._decorator,l=s.ccclass,c=(s.property,function(e){function t(){var t=e.call(this)||this;return t.scale=1,t.dir=n.DIR.NONE,t.status=n.ACTION.STAND,t.hasShade=!1,t.priority=0,t}return __extends(t,e),t.prototype.initData=function(){e.prototype.initData.call(this)},t.prototype.recovery=function(){this.dispose()},t.prototype.dispose=function(){this.spine&&this.stopAnim(),this.spine=null,e.prototype.dispose.call(this)},t.prototype.clear=function(){this.stopAnim(),this.node.active=!1,e.prototype.clear.call(this)},t.prototype.init=function(e,t,i,o,a,s,l,c,d){void 0===i&&(i="skin"),void 0===s&&(s=!1),void 0===l&&(l=n.ACTION.STAND),void 0===c&&(c=n.DIR.RIGHT),void 0===d&&(d=null),this.hasShade=s,this.type=e,this.modeid=t,this.priority=a,this.status=n.ACTION.STAND,this.defaultsAKey=n.ACTOR_STS_NAME[1];var p=r.GlobalContext.Root+n.SPINE_RES_DIR+e+"/"+t+"/"+i;this.loop=-1==n.ACTOR_STS_NAME_NO_LOOP.indexOf(l),d?this.initSpineData(r.GlobalContext.Root+n.SPINE_RES_DIR+e+"/"+t+"/effect",null,d,!0):this.initSpineData(p,o,l,-1==n.ACTOR_STS_NAME_NO_LOOP.indexOf(l)),this.completeCallback=this.completeCall,this.completeCallbackThisObj=this,this.changeDir(c)},t.prototype.completeCall=function(e){this.changeAnim(n.ACTION.STAND),this.animEndCall&&(a.default.instance.specialskillEntityComEffect=!0,this.animEndCall.apply(this.animEndCallThisObj,this.animEndCallThisParam))},t.prototype.stopAnim=function(){this.spine&&this.stop()},t.prototype.changeDir=function(e){this.dir=e,this.changeScaleX()},t.prototype.changeScaleX=function(){this.spine&&this.spine.node&&(this.spine.node.scaleX=this.dir*this.scale)},t.prototype.changeAnim=function(t,i){this.status=t,this.loop=-1==n.ACTOR_STS_NAME_NO_LOOP.indexOf(t),e.prototype.play.call(this,t,i)},t.prototype.changeAnimAndDir=function(e,t,i){e==this.status&&e==n.ACTION.WALK&&(!i||i&&i==this.dir)||(i&&this.changeDir(i),this.changeAnim(e,t))},t.prototype.enVisible=function(){this.node.active=!0},t=__decorate([l],t)}(o.default));i.default=c,cc._RF.pop()},{"../../../Core/SpineBase":"SpineBase","../../../Global/GlobalValue":"GlobalValue","../../../GlobalContext":"GlobalContext","../Manager/SceneManager":"SceneManager"}],AttackEffectUtils:[function(e,t,i){"use strict";cc._RF.push(t,"ad1c1sTuBtGbZlOEQvMJNal","AttackEffectUtils"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./AttackEffect"),o=e("../../../GlobalContext"),a=e("../../../Core/LoadManager"),r=e("../View/ActorsLayer"),s=e("../Controller/SkillController"),l=e("../Manager/SceneManager"),c=e("../../../Global/GlobalValue"),d=e("../View/ActorsMaskLayer"),p=e("../Controller/SpecialSkillEffectController"),h=e("../../../Util/Utils"),u=e("../Controller/FightController"),f=e("../../Status/StatusType"),g=cc._decorator,y=g.ccclass,m=(g.property,function(){function e(){this.nodePool=new cc.NodePool,this.nodeList=[],this.isInited=!1,this.iscombo=!1,this.handleAttackIndexDic={}}var t;return t=e,Object.defineProperty(e,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),e.prototype.initPre=function(){for(var e=this,t=o.GlobalContext.Root+"prefab/attackeffect/AttackEffect",i=0;i<5;i++)a.default.instance.loadResByType(t,cc.Prefab,function(i){var n=h.default.getNodeByUrl(i,t);e.nodePool.put(n)},this)},e.prototype.playOneEffect=function(e,t,i,g,y){var m,C=this,v=function(o){o.active=!0,o.scale=1,o.rotation=0;var a=s.default.instance.getSkillBySkillId(i);14==e.prop.cardid&&a.triggerway==c.TRIGGER_WAY.INITIATIVE&&(C.handleAttackIndexDic[e.prop.handle+i]?(C.handleAttackIndexDic[e.prop.handle+i]++,C.handleAttackIndexDic[e.prop.handle+i]=C.handleAttackIndexDic[e.prop.handle+i]>2?1:C.handleAttackIndexDic[e.prop.handle+i]):C.handleAttackIndexDic[e.prop.handle+i]=1,C.handleAttackIndexDic[e.prop.handle+i]&&p.default.instance.otereffect.push(o)),l.default.instance.specialskillstatus>c.SPECIAL_SKILL_STATUS.SPECIAL_SKILL_STATUS1?d.default.instance.node.addChild(o):r.default.instance.node.addChild(o),o.getComponent(n.default).initData(e,t,i,g,y),C.nodeList.push(o)};if(f.ActivityStatus.Arena!=f.ActivityStatus.value&&e.avatar.body.spine.findBone("zidan")){var _=t.prop.x+Math.abs(e.avatar.body.spine.findBone("zidan").x)*e.avatar.dir>e.prop.x?-1:1;if(e.avatar.dir!=_)if(s.default.instance.getSkillBySkillId(i).attackway!=c.ATTACK_TYPE.ATTACK_TYPE_5)return void u.default.instance.actorUseSkill(e.prop.handle,[t.prop.handle],i,g)}if(this.nodePool.size()>0)m=this.nodePool.get(),v(m);else{var b=o.GlobalContext.Root+"prefab/attackeffect/AttackEffect";a.default.instance.loadResByType(b,cc.Prefab,function(e){var t=h.default.getNodeByUrl(e,b);v(t)},this)}},e.prototype.recycleNode=function(e){this.nodePool.put(e),this.nodeList.splice(this.nodeList.indexOf(e),1)},e.prototype.moving=function(e,t){for(var i=0,o=this.nodeList;i<o.length;i++){var a=o[i];if(!a.parent)return;var r=a.getComponent(n.default);if(r.targetlive)if(l.default.instance.specialskillstatus==c.SPECIAL_SKILL_STATUS.NONE)0==l.default.instance.fightMode||1==l.default.instance.fightMode?r.moving(e):2==l.default.instance.fightMode&&t%2==r.delayNum&&r.moving(e);else{var s=r.skillId.toString();parseInt(s.charAt(s.length-1))>=8&&(0==l.default.instance.fightMode||1==l.default.instance.fightMode?r.moving(e):2==l.default.instance.fightMode&&t%2==r.delayNum&&r.moving(e))}else r.getComponent(n.default).taphrogenic?r.moving(e):r.getComponent(n.default).recovery()}},e.prototype.recoveryAll=function(){for(var e in r.default.instance.node.children){var t=r.default.instance.node.children[e];t.getComponent(n.default)&&t.getComponent(n.default).recovery()}this.nodeList.length=0,this.handleAttackIndexDic={}},e.prototype.clearPool=function(){for(var e=0,t=this.nodeList;e<t.length;e++){t[e].destroy()}this.nodeList.length=0,this.nodePool.clear()},e.prototype.setAttacksActive=function(e){for(var t=0,i=this.nodeList;t<i.length;t++){i[t].opacity=e}},e.prototype.getSourceAtkOffPos=function(e,t){var i=t.prop.x>e.prop.x?-1:1,n=0,o=e.height/2;return f.ActivityStatus.Arena!=f.ActivityStatus.value&&e.avatar.body.spine.findBone("zidan")&&(o=e.avatar.body.spine.findBone("zidan").y*e.prop.monsterConf.scenescale,n=e.avatar.body.spine.findBone("zidan").x*e.prop.monsterConf.scenescale*i),new cc.Vec2(n,o)},e=t=__decorate([y],e)}());i.default=m,cc._RF.pop()},{"../../../Core/LoadManager":"LoadManager","../../../Global/GlobalValue":"GlobalValue","../../../GlobalContext":"GlobalContext","../../../Util/Utils":"Utils","../../Status/StatusType":"StatusType","../Controller/FightController":"FightController","../Controller/SkillController":"SkillController","../Controller/SpecialSkillEffectController":"SpecialSkillEffectController","../Manager/SceneManager":"SceneManager","../View/ActorsLayer":"ActorsLayer","../View/ActorsMaskLayer":"ActorsMaskLayer","./AttackEffect":"AttackEffect"}],AttackEffect:[function(e,t,i){"use strict";cc._RF.push(t,"c018aLFbCRBOI8eoQ9r/j6A","AttackEffect"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Util/ComFun"),o=e("../../../Util/Scene/MoveUtil"),a=e("../LayerableCompent"),r=e("./AttackEffectUtils"),s=e("../../../Core/GameEventDispatcher"),l=e("../../../Core/Event"),c=e("../Controller/SkillController"),d=e("../../../Global/GlobalValue"),p=e("../Controller/FightController"),h=e("../../../Core/Const/EntityType"),u=e("../../../Util/Parabola"),f=e("../Manager/SceneManager"),g=e("../../../Core/SpineBase"),y=e("../Controller/ServerFightController"),m=e("../../Status/StatusType"),C=e("../Pool/SpinePools"),v=cc._decorator,_=v.ccclass,b=v.property,T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.effectSpine=null,t.target=null,t.source=null,t.conf=null,t.skillId=null,t.skilllv=null,t.url=null,t.movespeed=300,t.delayNum=Math.floor(2*Math.random()),t.effectindex=0,t.effectmoveCom=!1,t.taphrogenic=!1,t.taphrogenicx=0,t.taphrogenicy=0,t.nodeList=[],t.sceleList=[.7,.9,1.1,1.3],t.posxList=[0,130,140,160,160],t.alldistance=430,t.taphrogenicpass=0,t.delayTaphrogenic=50,t.totaBlowCount=0,t.curBlowCount=0,t._parabola=null,t}return __extends(t,e),t.prototype.start=function(){},t.prototype.changeSpeed=function(){this.nodeList.forEach(function(e){e.getComponent(g.default).playRate=f.default.instance.fightViewPlayRate}),this.effectSpine.playRate=f.default.instance.fightViewPlayRate},t.prototype.initData=function(e,t,i,o,a){void 0===a&&(a=!1),s.GameEventDispatcher.instance.on(l.EventDefiner.Fight_Speed_Change,this.changeSpeed,this),this.conf=c.default.instance.getSkillBySkillId(i);var p=t.prop.x>e.prop.x?-1:1;this.node.scale=1,this.target=t,this.source=e,this.skilllv=o,this.skillId=i,this.taphrogenic=a,this.nodeList=[],this.conf.attackway!=d.ATTACK_TYPE.ATTACK_TYPE_5&&(this.node.scale=e.prop.monsterConf.scenescale,this.node.scaleX=p*e.prop.monsterConf.scenescale);var u=0,f=e.height/2;m.ActivityStatus.Arena!=m.ActivityStatus.value&&e.avatar.body.spine.findBone("zidan")&&(f=e.avatar.body.spine.findBone("zidan").y*e.prop.monsterConf.scenescale,u=e.avatar.body.spine.findBone("zidan").x*e.prop.monsterConf.scenescale*p);var g=c.default.instance.getSkillBySkillId(this.skillId);if(this.totaBlowCount=0,this.taphrogenic){this.taphrogenicpass=0,this.curBlowCount=0,this.taphrogenicx=0,this.node.setPosition(e.prop.x+Math.floor(u),e.prop.y+Math.floor(f));var C=r.default.instance.getSourceAtkOffPos(this.source,this.target),v=n.ComFun.distance(this.source.prop.x+C.x,this.source.prop.y,this.target.prop.x,this.target.prop.y);if(v<this.alldistance){for(var _=0,b=0;b<this.posxList.length;b++)if((_+=this.posxList[b])>v){this.totaBlowCount=b;break}}else this.totaBlowCount=4+Math.floor((v-this.alldistance)/this.posxList[this.posxList.length-1]);this.updateTaphrogenic()}else{var T=void 0;if(r.default.instance.handleAttackIndexDic[this.source.prop.handle+this.skillId])this.effectindex=r.default.instance.handleAttackIndexDic[this.source.prop.handle+this.skillId],T=this.source.prop.type==h.EntityType.enActor?"skin1_fight"+g.attackEffect+"_a"+this.effectindex:"skin"+this.source.prop.grade+"_fight"+g.animationId+"_a"+this.effectindex;else{this.skillId.toString();T=g.ballistics?this.source.prop.type==h.EntityType.enActor?"skin1_fight"+g.attackEffect+"_a"+this.effectindex:"skin"+this.source.prop.grade+"_fight"+g.animationId+"_a"+Math.round(1+y.default.instance.Random()):this.source.prop.type==h.EntityType.enActor?"skin1_fight"+g.attackEffect+"_a":"skin"+this.source.prop.grade+"_fight"+g.animationId+"_a"}this.effectSpine.initSpineData(e.prop.getAttackEffectUrl(),null,T,!0),this.node.setPosition(e.prop.x+Math.floor(u),e.prop.y+Math.floor(f))}},t.prototype.addtaphrogenic=function(){var e=this,t=this.target.prop.x>this.source.prop.x?-1:1,i=this.curBlowCount>=this.sceleList.length?this.sceleList.length-1:this.curBlowCount;this.taphrogenicx+=this.source.prop.dir*this.posxList[i];var n=C.SpinePools.addSpineNoder(this.node,new cc.Vec2(this.node.x+this.taphrogenicx,0));this.nodeList.push(n),n.scaleX=t*this.sceleList[i],n.scaleY=Math.abs(n.scaleX);var o=n.getComponent(g.default);o.initSpineData(this.source.prop.getAttackEffectUrl(),"default","skin1_fight2_a2",!1),o.completeCallbackThisObj=this,o.completeCallbackParam=[n],o.completeCallback=function(t){e.nodeList.splice(e.nodeList.indexOf(t),1),C.SpinePools.recoverSpineNoder(t),e.curBlowCount==e.totaBlowCount&&(e.source.isLive&&e.target.isLive?e.moveEnd():e.recovery())}},t.prototype.updateTaphrogenic=function(){this.taphrogenicpass>=this.delayTaphrogenic*this.curBlowCount&&this.curBlowCount<this.totaBlowCount&&(this.addtaphrogenic(),this.curBlowCount++)},Object.defineProperty(t.prototype,"targetlive",{get:function(){return this.conf.attackway==d.ATTACK_TYPE.ATTACK_TYPE_5||this.target.isLive},enumerable:!0,configurable:!0}),t.prototype.moving=function(e){if(this.taphrogenic)return this.taphrogenicpass+=e,void this.updateTaphrogenic();if(f.default.instance.specialskillstatus==d.SPECIAL_SKILL_STATUS.NONE||f.default.instance.specialskillid==this.skillId)if(this.conf.attackway==d.ATTACK_TYPE.ATTACK_TYPE_5){if(!this.effectmoveCom){if(!this.parabola.isMoveing){this.parabola.onCompleteCallback=this.moveEnd1,this.parabola.onCompleteCallbackThisObj=this,this.point=cc.v2(this.target.prop.x,this.source.prop.y);var t=cc.v2(this.target.prop.x,this.target.prop.y+350),i=cc.v2(this.target.prop.x,this.source.prop.y);this.parabola.MoveBySpeed(t,i,this.movespeed/f.default.instance.fightViewPlayRate,!1,1.5/f.default.instance.fightViewPlayRate)}this.parabola.updataData()}}else{var a=this.target.x+(this.target.x>this.source.x?-this.target.width/4:this.target.width/4),r=this.target.height/2,s=this.target.y+r,l=a-this.node.x,c=s-this.node.y,p=Math.atan2(c,l),h=(n.ComFun.calcDirByRadian8(p),this.node.x),u=this.node.y,g=void 0,y=void 0,m=1500;this.conf.iscombo&&(m=700);var C=o.MoveUtil.getSpeedByMoveTime(e,m,2);n.ComFun.distance(this.node.x,this.node.y,a,s)<=C?this.moveEnd():(g=Math.round(C*Math.cos(p)),y=Math.round(C*Math.sin(p)),p>3.14?(g=Math.round(C*Math.cos(0)),g=-Math.ceil(g)):g=Math.ceil(g),y=y>0?Math.ceil(y):Math.floor(y),h=this.node.x+g,u=this.node.y+y);var v=void 0;0!=(v=u>this.node.y?Math.atan2(this.node.y-u,h-this.node.x)*(180/Math.PI):u<this.node.y?-Math.atan2(u-this.node.y,h-this.node.x)*(180/Math.PI):0)&&(this.source.prop.selfMonster||(v=v<0?180+v:-180+v)),this.node.rotation=v,this.node.setPosition(h,u)}else console.log("\u4e0d\u662f\u5927\u62db\u653b\u51fb\u7279\u6548\u522b\u52a8",this.skillId)},t.prototype.moveEnd1=function(){var e=this,t=c.default.instance.getSkillBySkillId(this.skillId);if(this.effectmoveCom=!0,1==this.effectindex){p.default.instance.actorUseSkill(this.source.prop.handle,[this.target.prop.handle],this.skillId,this.skilllv,this.point);var i=this.source.prop.type==h.EntityType.enActor?"skin1_fight"+t.isHitEffect+"_b":"skin"+this.source.prop.grade+"_fight"+t.isHitEffect+"_b";this.effectSpine.loop=!1,this.effectSpine.changeAction(null,i),this.effectSpine.completeCallbackThisObj=this,this.effectSpine.completeCallback=function(){0==e.effectSpine.loop&&e.recovery()}}else this.recovery()},t.prototype.moveEnd=function(){this.recovery(),p.default.instance.actorUseSkill(this.source.prop.handle,[this.target.prop.handle],this.skillId,this.skilllv)},t.prototype.recovery=function(){for(s.GameEventDispatcher.instance.off(l.EventDefiner.Fight_Speed_Change,this.changeSpeed,this),this._parabola&&(this._parabola.clear(),this._parabola=null),this.effectSpine.clear(),this.node.parent&&this.node.parent.removeChild(this.node);this.nodeList.length>0;)C.SpinePools.recoverSpineNoder(this.nodeList.shift());this.effectmoveCom=!1,this.url="",this.node.active=!1,r.default.instance.recycleNode(this.node)},Object.defineProperty(t.prototype,"parabola",{get:function(){return null==this._parabola&&(this._parabola=new u.default,this._parabola.targetNode=this.node),this._parabola},enumerable:!0,configurable:!0}),__decorate([b(g.default)],t.prototype,"effectSpine",void 0),t=__decorate([_],t)}(a.default);i.default=T,cc._RF.pop()},{"../../../Core/Const/EntityType":"EntityType","../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/SpineBase":"SpineBase","../../../Global/GlobalValue":"GlobalValue","../../../Util/ComFun":"ComFun","../../../Util/Parabola":"Parabola","../../../Util/Scene/MoveUtil":"MoveUtil","../../Status/StatusType":"StatusType","../Controller/FightController":"FightController","../Controller/ServerFightController":"ServerFightController","../Controller/SkillController":"SkillController","../LayerableCompent":"LayerableCompent","../Manager/SceneManager":"SceneManager","../Pool/SpinePools":"SpinePools","./AttackEffectUtils":"AttackEffectUtils"}],AttrNode:[function(e,t,i){"use strict";cc._RF.push(t,"2fbc38ioEdKdrTzQE943YnU","AttrNode"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Global/GlobalValue"),a=e("../../../Core/Language"),r=e("../../../Util/AttrUtil"),s=cc._decorator,l=s.ccclass,c=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.attrIcons=null,t}return __extends(t,e),t.prototype.setData=function(e,t){var i=0;switch(e){case o.AttrNodeType.TYPE:this.setAttr(this.node.getChildByName("type"),t),i=o.AttrNodeType.TYPE}for(var n in this.node.children)this.node.children[n].active=parseInt(n)==i;this.node.width=this.node.children[i].width,this.node.height=this.node.children[i].height},t.prototype.setAttr=function(e,t){var i=r.default.getAttrIconID(t[0].type),n=r.default.getAttrName(t[0].type);e.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=this.attrIcons.getSpriteFrame("attrIcon_"+i);var o=a.default.getStr("{0}\uff1a{1}",n,t[0].value);e.getChildByName("Label").getComponent(cc.Label).string=o,e.getChildByName("Label2").getComponent(cc.Label).string=t[1].value,e.getChildByName("Label3").getComponent(cc.Label).string=a.default.getStr("+{0}",t[1].value-t[0].value)},__decorate([c(cc.SpriteAtlas)],t.prototype,"attrIcons",void 0),t=__decorate([l],t)}(n.default);i.default=d,cc._RF.pop()},{"../../../Core/Language":"Language","../../../Core/Widget":"Widget","../../../Global/GlobalValue":"GlobalValue","../../../Util/AttrUtil":"AttrUtil"}],AttrUtil:[function(e,t,i){"use strict";cc._RF.push(t,"c026cf5YFxOUowYQufXXi0v","AttrUtil"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Global/GlobalValue"),o=e("../Core/Language"),a=e("../Module/Scene/Controller/SkillController"),r=cc._decorator,s=r.ccclass,l=(r.property,function(){function e(){}return e.getAttrIconID=function(e){var t=0;if(e>=n.AttrType.MaxHp&&e<=n.AttrType.LWindDefRate&&(t=this.getBaseAttrIcon(e%100)),e>=n.AttrType.ThuHp&&e<=n.AttrType.WinDefCriRate){var i=Math.floor(e/100);e>=n.AttrType.ThuHp&&e<=n.AttrType.WinDefCri&&(t=2*i-9),e>=n.AttrType.ThuHpRate&&e<=n.AttrType.WinDefCriRate&&(t=2*i-19)}if(e>=n.AttrType.RetainStep&&e<=n.AttrType.CardPassiveHurtRate){i=Math.floor(e/100);t=e>=n.AttrType.SkillOne&&e<=n.AttrType.SkillThree?n.AttrType.SkillOne:e}return t},e.getBaseAttrIcon=function(e){var t=n.AttrType.MaxHp;switch(e){case n.AttrType.MaxHp:t=n.AttrType.MaxHp;break;case n.AttrType.Attack:t=n.AttrType.Attack;break;case n.AttrType.Defence:t=n.AttrType.Defence;break;case n.AttrType.Hit:t=n.AttrType.Hit;break;case n.AttrType.Dodge:t=n.AttrType.Dodge;break;case n.AttrType.Critical:t=n.AttrType.Critical;break;case n.AttrType.DefCri:t=n.AttrType.DefCri;break;case n.AttrType.ThunderAttack:t=n.AttrType.ThunderAttack;break;case n.AttrType.ThunderDef:t=n.AttrType.ThunderDef;break;case n.AttrType.EarthAttack:t=n.AttrType.EarthAttack;break;case n.AttrType.EarthDef:t=n.AttrType.EarthDef;break;case n.AttrType.WaterAttack:t=n.AttrType.WaterAttack;break;case n.AttrType.WaterDef:t=n.AttrType.WaterDef;break;case n.AttrType.FireAttack:t=n.AttrType.FireAttack;break;case n.AttrType.FireDef:t=n.AttrType.FireDef;break;case n.AttrType.WindAttack:t=n.AttrType.WindAttack;break;case n.AttrType.WindDef:t=n.AttrType.WindDef}return t},e.getAttrName=function(e,t){void 0===t&&(t=!1);var i="",a=e;return t&&e<=16&&(i="_blank"),a>=n.AttrType.ThunderAttackRate&&a<=n.AttrType.WindDefRate&&(a=a-n.AttrType.ThunderAttackRate+n.AttrType.ThunderAttack),a>=n.AttrType.HpRate&&a<=n.AttrType.DefCriRate&&(a-=n.AttrType.HpRate),a>=n.AttrType.MaxHp_P&&a<=n.AttrType.DefCri_P&&(a-=n.AttrType.MaxHp_P),a>=n.AttrType.ThuHpRate&&a<=n.AttrType.WinDefCriRate&&(a-=n.AttrType.ThuHpRate-n.AttrType.ThuHp),(a>=288800||a==n.AttrType.SkillOne||a==n.AttrType.SkillTwo||a==n.AttrType.SkillThree)&&(a=603),i=o.default.getStr("attr_type_"+a+i)},e.getAttrNameTwo=function(e){var t="";switch(e){case n.AttrType.MaxHp:t=o.default.getStr("ornamen_MaxHp");break;case n.AttrType.Attack:t=o.default.getStr("ornamen_Attack");break;case n.AttrType.Defence:t=o.default.getStr("ornamen_Defence");break;case n.AttrType.MaxHp_P:t=o.default.getStr("ornamen_MaxHp_P");break;case n.AttrType.Attack_P:t=o.default.getStr("ornamen_Attack_P");break;case n.AttrType.Defence_P:t=o.default.getStr("ornamen_Defence_P")}return t},e.getEquipEffectAttrDesc=function(e,t){var i="";if(e>=288800){var r=a.default.instance.getSkillBySkillId(e/100).name;i=o.default.getStr("equipEffectAttr_1",r)}else if(e==n.AttrType.RetainStep)i=o.default.getStr("equipEffectAttr_6");else if(e==n.AttrType.FubenStep)i=o.default.getStr("equipEffectAttr_3");else if(e==n.AttrType.ExtraHurt||e==n.AttrType.CardHurtRate)i=o.default.getStr("equipEffectAttr_4")+this.getAttrName(e);else{if(e==n.AttrType.CardPassiveHurtRate)return o.default.getStr("equipEffectAttr_5")+"  "+t;i=this.getAttrName(e)}return i+o.default.getStr("equipEffectAttr_2")+t},e=__decorate([s],e)}());i.default=l,cc._RF.pop()},{"../Core/Language":"Language","../Global/GlobalValue":"GlobalValue","../Module/Scene/Controller/SkillController":"SkillController"}],Attribute:[function(e,t,i){"use strict";cc._RF.push(t,"b05bfuEWHJGR5uNZXB2gwCC","Attribute"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Util/AttrUtil"),a=cc._decorator,r=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.iconNode=null,t.attrName=null,t.num=null,t.numTwo=null,t.imgs=null,t.attrStr=null,t.iconIndex=-1,t.color=[cc.color(243,232,223),cc.color(194,3,242)],t.color2=[cc.color(0,202,71),cc.color(255,0,0)],t}return __extends(t,e),t.prototype.setData=function(e,t){void 0===t&&(t=null),this.attrStr=o.default.getAttrName(e.type),this.attrName.node.active=!!this.attrStr,this.attrStr&&(this.attrName.string=this.attrStr),this.iconNode.active=this.iconIndex>0,this.iconIndex>0&&(this.iconNode.getComponent(cc.Sprite).spriteFrame=this.imgs.getSpriteFrame("statusType"+this.iconIndex));var i=!!t;this.node.getChildByName("node").active=i,this.num.node.active=i,t&&(this.num.string=t+""),this.numTwo.string=e.curVal+""},t.prototype.setDataTwo=function(e,t,i){this.iconNode.active=!1,this.attrName.string=e,this.num.string=t,this.numTwo.string=i,this.node.getChildByName("node").active=!0},t.prototype.setDataThree=function(e,t,i){this.attrStr=o.default.getAttrName(e),this.attrName.node.active=!!this.attrStr,this.attrStr&&(this.attrName.string=this.attrStr)},__decorate([s(cc.Node)],t.prototype,"iconNode",void 0),__decorate([s(cc.Label)],t.prototype,"attrName",void 0),__decorate([s(cc.Label)],t.prototype,"num",void 0),__decorate([s(cc.Label)],t.prototype,"numTwo",void 0),__decorate([s(cc.SpriteAtlas)],t.prototype,"imgs",void 0),t=__decorate([r],t)}(n.default);i.default=l,cc._RF.pop()},{"../../Core/Widget":"Widget","../../Util/AttrUtil":"AttrUtil"}],AvatarBase:[function(e,t,i){"use strict";cc._RF.push(t,"e2d61rP5ApFhpw2X1slIMXB","AvatarBase"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Unit/AsyncResObj"),o=e("../../../Global/GlobalValue"),a=e("../LayerableCompent"),r=cc._decorator,s=r.ccclass,l=r.property,c=function(e){function t(){var t=e.call(this)||this;return t.canTouch=!1,t.bodyIndex=10,t._height=0,t._width=0,t._playRate=1,t.body=null,t._avatarVisible=!0,t}return __extends(t,e),t.prototype.setPlayRate=function(e){this._playRate=e,this.body&&(this.body.playRate=e)},t.prototype.getPlayRate=function(){return this._playRate},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dir",{get:function(){var e=o.DIR.NONE;return this.body&&(e=this.body.dir),e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"status",{get:function(){var e=o.ACTION.NONE;return this.body&&(e=this.body.status),e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{set:function(e){this._avatarVisible=e,this.setRawVisible(e)},enumerable:!0,configurable:!0}),t.prototype.setRawVisible=function(e){this.node.active=e},t.prototype.init=function(e,t,i,n,a,r,s,l,c){void 0===i&&(i="skin"),void 0===r&&(r=!1),void 0===s&&(s=o.ACTION.STAND),void 0===l&&(l=o.DIR.RIGHT),void 0===c&&(c=null),this.setRawVisible(!0),this.body.init(e,t,i,n,a,r,s,l,c)},t.prototype.scaleBody=function(e){this.body.scale=e,this.body.node.setScale(e)},t.prototype.play=function(e,t,i){this.body&&this.body.changeAnimAndDir(e,t,i)},t.prototype.bodyAnimEndCall=function(){this.status>=o.ACTION.FIGHT1&&this.play(o.ACTION.STAND)},t.prototype.changeDir=function(e){this.dir!=e&&this.play(this.status,null,e)},t.prototype.recovery=function(){this.dispose()},t.prototype.clear=function(){this.body&&this.body.clear()},t.prototype.dispose=function(){this.clear(),this.body&&(this.body.stopAnim(),this.body.dispose(),this.body=null),e.prototype.dispose.call(this)},__decorate([l(n.default)],t.prototype,"body",void 0),t=__decorate([s],t)}(a.default);i.default=c,cc._RF.pop()},{"../../../Global/GlobalValue":"GlobalValue","../LayerableCompent":"LayerableCompent","../Unit/AsyncResObj":"AsyncResObj"}],BackStageUtils:[function(e,t,i){"use strict";cc._RF.push(t,"2b71enbvblK54cXw3vPU06i","BackStageUtils"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./SDKUtils"),o=e("../Module/Role/RoleInfo"),a=e("../Module/Tips/OpTipsController"),r=e("../Core/Language"),s=function(){function e(){}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.prototype.sendOpinionHttps=function(e,t,i){var s=n.default.instance.BackstageSendUrl+":81/report?appv=2.0&counter=feedback&env=dev&key=7a415b8aac48aa9f1135b48af03eafc1&data="+n.default.instance.plat_id+"|"+n.default.instance.ditch_id+"|"+o.MyRoleInfo.id+"|"+o.MyRoleInfo.name+"|"+e+"|"+t+"|"+i;n.default.instance.sendToHttps(s,function(){a.default.instance.ShowMsg(r.default.getStr("7215"))},this)},e}();i.BackStageUtils=s,cc._RF.pop()},{"../Core/Language":"Language","../Module/Role/RoleInfo":"RoleInfo","../Module/Tips/OpTipsController":"OpTipsController","./SDKUtils":"SDKUtils"}],BagpackWin:[function(e,t,i){"use strict";cc._RF.push(t,"095benLNhZPrbUaGMrssiBu","BagpackWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./ItemIcon"),o=e("./ItemModel"),a=e("../../Core/Window"),r=e("./ItemType"),s=e("../../Util/NumberUtil"),l=e("../../Core/GameEventDispatcher"),c=e("../../Core/Event"),d=e("../../NetConnect/NetConnet"),p=e("../../Core/WindowType"),h=e("../Tips/BatchUsageTips"),u=e("../Tips/OpTipsController"),f=e("../../Core/Language"),g=e("../OpenWin/OpenWinController"),y=e("./ItemController"),m=e("../../Core/ConfigsManager"),C=e("../../Core/Controller"),v=e("../Commons/RewardUtils"),_=e("../../Core/WindowManager"),b=e("../WarTeam/MonsterController"),T=e("../Equip/ReplaceWin"),S=e("../Tips/RewardTips"),I=e("../Equip/Attr/EquipAttrTileNode"),w=e("../Equip/equip/EquipCtrl"),D=e("../Functionicon/FunctionIconController"),R=e("../../Global/GlobalValue"),A=e("../WarTeam/WarTeamMonsterInfo"),N=e("./GiftBagWin"),L=e("../Commons/ListViewCtrl"),E=e("../Commons/WindowBg1"),B=e("../../Core/TimeController"),M=e("../../Core/LoadManager"),x=e("../../GlobalContext"),k=e("../../Util/Utils"),P=e("../Ornament/OrnamentCtrl"),G=e("../Commons/WindowOpenUtils"),F=e("../Shop/Shop"),W=e("../Shop/ShopConst"),U=e("../Role/RoleInfo"),O=e("../Shop/ShopController"),V=e("../Role/RoleController"),q=cc._decorator,H=q.ccclass,j=q.property,K=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Itemicon=null,t.ItemDesc=null,t.ItemPrice=null,t.ItemName=null,t.ItemCount=null,t.content=null,t.SellBtn=null,t.UseBtn=null,t.BagList=null,t.Firstcheck=[],t.equipment=null,t.otheritem=null,t.breakDownNode=null,t.noBreakNode=null,t.resolve=null,t.apparel=null,t.number=null,t.listViewCtrNode=null,t.ItemIconpool=new cc.NodePool,t.ItemArr=[],t.ChooseInfo=null,t.chooseBtn=0,t.ChooseIndex=-1,t.selectNode=null,t.NowChooseType=1,t.equipConfigs=null,t._cardConfigs=null,t.isFrist=!1,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.equipConfigs=m.ConfigsManager.instance.getConfigs("equipconf"),this._cardConfigs=m.ConfigsManager.instance.getConfigs("cardConf")},t.prototype.start=function(){e.prototype.start.call(this),i.instance=this},t.prototype.addProto=function(e,t,i){C.default.ProtoCallbackDic[e]||(C.default.ProtoCallbackDic[e]=[]),C.default.ProtoCallbackDic[e].push([t,i])},t.prototype.rewardpanel=function(e){if(98==e.paneltype){var t=v.default.instance.getItemListByServerData(e.reward);this.showGet(t)}},t.prototype.showGet=function(e){g.default.instance.openWindow(p.WindowType.RewardTips,function(){S.default.instance.setData(e)},this)},t.prototype.show=function(){var t=this;e.prototype.show.call(this),l.GameEventDispatcher.instance.on(c.EventDefiner.BackpackItemChange,this.AddItem,this),l.GameEventDispatcher.instance.on(c.EventDefiner.AddBackpackItem,this.AddItem,this),l.GameEventDispatcher.instance.on(c.EventDefiner.DelBackpackItem,this.AddItem,this),l.GameEventDispatcher.instance.on(c.EventDefiner.GetBackpackListinfo,this.AddItem,this),this.isFrist&&this.scheduleOnce(function(){t.Itemclassify(null,t.NowChooseType+"")},.3),this.noBreakNode.active=!1,this.noBreakNode.stopAllActions(),this.noBreakNode.setPosition(new cc.Vec2(0,0))},t.prototype.hide=function(){e.prototype.hide.call(this),this.selectNode=null,l.GameEventDispatcher.instance.off(c.EventDefiner.BackpackItemChange,this.AddItem,this),l.GameEventDispatcher.instance.off(c.EventDefiner.AddBackpackItem,this.AddItem,this),l.GameEventDispatcher.instance.off(c.EventDefiner.DelBackpackItem,this.AddItem,this),l.GameEventDispatcher.instance.off(c.EventDefiner.GetBackpackListinfo,this.AddItem,this),this.clearNodeInfo(),this.noBreakNode.active=!1,this.noBreakNode.stopAllActions(),this.noBreakNode.setPosition(new cc.Vec2(0,0)),this.isFrist=!0},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this),this.ItemIconpool.clear(),this.isFrist=!1},t.prototype.useItem=function(e,t){var i=this;if(!this.ChooseInfo||7!=this.ChooseInfo.ItemType&&12!=this.ChooseInfo.ItemType)switch(this.ChooseInfo.ItemType){case 1:"1"!=t&&this.goEqui();break;case 2:for(var n in this._cardConfigs.Card)if(this._cardConfigs.Card[n].pieceId==this.ChooseInfo.id)for(var a=this._cardConfigs.Card[n].id,r=b.default.instance.GetAllCardArr(),s=0;s<r.length;s++)if(r[s].id==a)return void b.default.instance.openMonsterInfoPrefab(a,A.CardTag.info);0==this.goCard()&&u.default.instance.ShowMsg("\u4f60\u8fd8\u672a\u62e5\u6709\u8be5\u5361\u7247");break;case 3:this.GoUpgrade();break;case 4:g.default.instance.openWindow(p.WindowType.Artifact);break;case 5:_.default.instance.open(p.WindowType.ReelWin);break;case 8:this.materia(this.ChooseInfo);break;case 9:g.default.instance.openWindow(p.WindowType.Totems,function(){});break;case 10:g.default.instance.openWindow(p.WindowType.GiftBagWin,function(){N.default.instance.OpenGift(!0,v.default.instance.getItemList(m.ConfigsManager.instance.getConfigs("Itemconf").ItemConf[i.ChooseInfo.baseid].reward),i.ChooseInfo,0,i.ChooseInfo.dealPrice)});break;case 11:g.default.instance.openWindow(p.WindowType.GiftBagWin,function(){N.default.instance.OpenGift(!1,v.default.instance.getItemList(m.ConfigsManager.instance.getConfigs("Itemconf").ItemConf[i.ChooseInfo.baseid].reward),i.ChooseInfo,i.ChooseInfo.count)});break;case 13:this.openRelpaceByOrnament();break;case 15:G.default.instance.openWindowType(p.WindowType.RoleGpUp,2);break;case 16:g.default.instance.openWindow(p.WindowType.Shop,function(){var e=O.default.instance.nowSortIndex[W.ShopConst.Equip]?O.default.instance.nowSortIndex[W.ShopConst.Equip]:0;F.default.instance.TabBtnList2.selectItem(e)});break;case 17:G.default.instance.openWindowType(p.WindowType.Synthesis);break;case 18:V.default.instance.setSelectionIndex(this.ChooseInfo.id);break;case 999:U.MyRoleInfo.energy<U.MyRoleInfo.maxEnergy?this.ChooseInfo&&this.ChooseInfo.count&&this.ChooseInfo.count>1?g.default.instance.openWindow(p.WindowType.BatchUsageTips,function(){h.default.instance.ShowTips1("\u6279\u91cf\u4f7f\u7528",i.UseItemBtn,i,[i.ChooseInfo.guid],i.ChooseInfo,1)}):this.ChooseInfo&&this.ChooseInfo.count&&1==this.ChooseInfo.count&&o.default.UseItembyId(this.ChooseInfo.guid):u.default.instance.ShowMsg(f.default.getStr1(f.default.getStr("usetitem1"),[U.MyRoleInfo.maxEnergy]));break;default:G.default.instance.openWindowType(this.ChooseInfo.ItemType)}else"0"==t&&(this.ChooseInfo&&this.ChooseInfo.count&&this.ChooseInfo.count>1?g.default.instance.openWindow(p.WindowType.BatchUsageTips,function(){h.default.instance.ShowTips1("\u6279\u91cf\u4f7f\u7528",i.UseItemBtn,i,[i.ChooseInfo.guid],i.ChooseInfo,1)}):this.ChooseInfo&&this.ChooseInfo.count&&1==this.ChooseInfo.count&&o.default.UseItembyId(this.ChooseInfo.guid));"1"==t&&(console.log("%c%s","color: #C703F8;font-size: 20px","\u7269\u54c1\u5206\u89e3\u6309\u94ae\u529f\u80fd:"+t),this.ChooseInfo&&-1==this.ChooseInfo.ower||this.ChooseInfo&&-1!=this.ChooseInfo.ower&&this.noMoneyNodeAction())},t.prototype.goCard=function(){for(var e in this._cardConfigs.Card)if(this._cardConfigs.Card[e].pieceId==this.ChooseInfo.id)for(var t=this._cardConfigs.Card[e].id,i=b.default.instance.GetAllCardArr(),n=0;n<i.length;n++)return i[n].id==t},t.prototype.goEqui=function(){var e=w.default.instance.data.getJumpCard(this.ChooseInfo),t=0,i=B.default.instance.setTimeout(function(){500==(t+=500)&&g.default.instance.openWindow(p.WindowType.EquipRelpace,function(t){t.getComponent(T.default).setData(e.cardID,e.equipType,!1)},this),B.default.instance.clearTimeout(i)},this,500)},t.prototype.openRelpaceByOrnament=function(){var e=P.default.instance.data.getOrnamentType(this.ChooseInfo.id),t=b.default.instance.getCardIDByOrnamentType(e);g.default.instance.openWindow(p.WindowType.EquipRelpace,function(i){i.getComponent(T.default).setData(t,e,!0)},this)},t.prototype.GoUpgrade=function(){var e=b.default.instance.GetWarTeamConfig();for(var t in e)1==this.GoUpgrade2()?b.default.instance.openMonsterInfoPrefab(e[t].id,A.CardTag.upgrade):b.default.instance.openMonsterInfoPrefab(e[0].id,A.CardTag.upgrade)},t.prototype.GoUpgrade2=function(){var e=b.default.instance.GetWarTeamConfig();for(var t in e)for(var i in r.MyBagItem.ItemList)return this._cardConfigs.Card[e[t].id].pieceId==r.MyBagItem.ItemList[i].id&&r.MyBagItem.ItemList[i].count>=this._cardConfigs.Card[e[t].id].pieceNum},t.prototype.sellItem=function(e,t){var i=this;"0"==t?this.ChooseInfo.isTrading?u.default.instance.ShowMsg(f.default.getStr("Dontpremit")):this.ChooseInfo&&this.ChooseInfo.count&&this.ChooseInfo.count>1?g.default.instance.openWindow(p.WindowType.BatchUsageTips,function(){h.default.instance.ShowTips1("\u6279\u91cf\u51fa\u552e",i.SellItemBtn,i,[i.ChooseInfo.guid],i.ChooseInfo,1,"\u51fa\u552e")}):this.ChooseInfo&&this.ChooseInfo.count&&1==this.ChooseInfo.count&&o.default.SellItembyId(this.ChooseInfo.guid):(console.log("%c%s","color: #C703F8;font-size: 20px","\u7269\u54c1\u5f3a\u5316\u529f\u80fd\u6309\u94ae\u4e8b\u4ef6:"+t),this.ChooseInfo)},t.prototype.Itemclassify=function(e,t){if(this.NowChooseType=parseInt(t),this.BagList.stopAutoScroll(),this.BagList.scrollToTop(.05),this.ChooseInfo=null,console.log("\u9009\u62e9\u9053\u5177\u5206\u7c7b\u7c7b\u578b:"+t),this.ItemArr=o.default.instance.getBagTypeListbyType(this.NowChooseType),console.log("%c%s","color: #C703F8;font-size: 20px","\u5206\u7c7b\u9053\u5177\u683c\u5b50\u6570:"+this.ItemArr.length),this.setlistinfo(this.ItemArr),t==r.ItemType.equipment+""?(this.UseBtn.node.getComponentInChildren(cc.Label).string=f.default.getStr("Resolve"),this.SellBtn.node.getComponentInChildren(cc.Label).string=f.default.getStr("Intensify"),this.apparel.active=!0,this.resolve.active=!1,this.UseBtn.node.active=!1,this.SellBtn.clickEvents[0].customEventData="1",this.UseBtn.clickEvents[0].customEventData="1"):(this.apparel.active=!1,this.resolve.active=!1,this.UseBtn.node.active=!0,this.UseBtn.node.getComponentInChildren(cc.Label).string=f.default.getStr("Use"),this.SellBtn.node.getComponentInChildren(cc.Label).string=f.default.getStr("Sell"),this.SellBtn.clickEvents[0].customEventData="0",this.UseBtn.clickEvents[0].customEventData="0"),this.equipment.active=t==r.ItemType.equipment+"",this.otheritem.active=t!=r.ItemType.equipment+"",-1==this.ChooseIndex&&(this.ChooseIndex=0),this.chooseGrid(null),this.ItemArr.length<=0)return this.apparel.getComponent(cc.Button).interactable=!1,this.apparel.getComponent(cc.Button).enableAutoGrayEffect=!0,this.resolve.getComponent(cc.Button).interactable=!1,this.resolve.getComponent(cc.Button).enableAutoGrayEffect=!0,this.UseBtn.interactable=!1,this.UseBtn.enableAutoGrayEffect=!0,this.SellBtn.interactable=!1,this.SellBtn.enableAutoGrayEffect=!0,void(this.content.children[0]&&this.content.children[0].getChildByName("msk")&&(this.content.children[0].getChildByName("msk").active=!1));this.UseBtn.interactable=!0,this.UseBtn.enableAutoGrayEffect=!0,this.SellBtn.interactable=!0,this.SellBtn.enableAutoGrayEffect=!0,this.apparel.getComponent(cc.Button).interactable=!0,this.apparel.getComponent(cc.Button).enableAutoGrayEffect=!0,this.resolve.getComponent(cc.Button).interactable=!0,this.resolve.getComponent(cc.Button).enableAutoGrayEffect=!0},t.prototype.chooseGrid=function(e){var t=e?this.listViewCtrNode.getComponent(L.default).getItemIndex(e.currentTarget.x,e.currentTarget.y):0,i=this.ItemArr[t];if(i||(i=""),console.log(this.ItemArr.length+"\u4e2a\u683c\u5b50\uff0c\u9009\u4e2d\u683c\u5b50"+t),this.Itemicon.getComponent("ItemIcon").ItemData(i,!1),this.ItemName.string=i.name?i.name:"",this.ItemCount.string=i.count?i.count:"",""==this.ItemCount.string?this.number.node.active=!1:this.number.node.active=!0,this.ItemDesc.string=i.desc?i.desc:"",this.ItemPrice.string=i.dealPrice?s.NumberUtil.getNumber(i.dealPrice):"0",this.ChooseInfo=i,this.selectNode&&this.selectNode.getChildByName("Choose")&&(this.selectNode.getChildByName("Choose").active=!1),this.selectNode=e?e.currentTarget:null,this.ChooseIndex=t,this.selectNode&&this.selectNode.getChildByName("Choose")&&""!=i&&(this.selectNode.getChildByName("Choose").active=!0),this.NowChooseType==r.ItemType.equipment&&i&&""!=i){this.clearNodeInfo();this.equipConfigs;var n=i,o=w.default.instance.data.getEquipInfoById(n.id),a=n.level>0?"LV:"+n.level:"";this.Itemicon.getComponent("ItemIcon").ItemData(i,!0,a);var l=n.stage>0?s.NumberUtil.unitsDigitToText(n.stage)+f.default.getStr("rank"):"";for(var c in this.ItemName.string=l+n.name,this.number.string="\u4f7f\u7528\u6218\u961f:",o.range)1==o.range[c]?this.ItemCount.string=f.default.getStr("\u524d\u6392"):2==o.range[c]?this.ItemCount.string=f.default.getStr("\u4e2d\u6392"):3==o.range[c]&&(this.ItemCount.string=f.default.getStr("\u540e\u6392"));this.setEqiupAttrInfo(n)}else this.setEqiupAttrInfo(null),this.number.string="\u6570\u91cf:"},t.prototype.clearNodeInfo=function(){var e=this.equipment.getChildByName("ScrollView").getComponent(cc.ScrollView).content;k.default.setNodeChildDestoryByUrl(e,x.GlobalContext.Root+"prefab/Equip/attr/EquipAttrTileNode")},t.prototype.Bagsort=function(e,t){var i={cmd:"sortitem"};d.default.instance.sendProto(i),console.log("\u53d1\u9001\u80cc\u5305\u6574\u7406\u534f\u8bae\uff1a"+JSON.stringify(i))},t.prototype.tabBtnSelectedChange=function(e){this.Itemclassify(void 0,e+1+"")},t.prototype.AddItem=function(e){this.Itemclassify(null,this.NowChooseType+"")},t.prototype.upCell=function(){this.Itemclassify(null,this.NowChooseType+"")},t.prototype.UseItemBtn=function(e,t){void 0===t&&(t=1),o.default.UseItembyId(e,t)},t.prototype.SellItemBtn=function(e,t){void 0===t&&(t=1),o.default.SellItembyId(e,t)},t.prototype.onShowTips=function(){this.ChooseInfo&&y.default.instance.openItemTips(this.ChooseInfo)},t.prototype.onSureBreak=function(){var e={cmd:"equipdecompose",equipGuid:this.ChooseInfo.guid};d.default.instance.sendProto(e),this.breakDownNode.active=!1},t.prototype.onNoBreak=function(){this.breakDownNode.active=!1},t.prototype.noMoneyNodeAction=function(){var e=this;this.noBreakNode.active||(this.noBreakNode.active=!0,this.noBreakNode.runAction(cc.sequence(cc.moveBy(1,new cc.Vec2(0,200)),cc.callFunc(function(){e.noBreakNode.setPosition(new cc.Vec2(0,0)),e.noBreakNode.active=!1}))))},t.prototype.setbarckData=function(e,t){var i=e.getChildByName("content"),o=f.default.getStr(this.ChooseInfo.stage+1+f.default.getStr("rank"));i.getChildByName("title").getChildByName("text2").getComponent(cc.Label).string=o+this.ChooseInfo.name;for(var a=i.getChildByName("itemlist"),r=0;r<a.childrenCount;++r)t[r]?(a.children[r].active=!0,a.children[r].getComponent(n.default).ItemData(t[r],!0,""+t[r].count,!1)):a.children[r].active=!1},t.prototype.setEqiupAttrInfo=function(e){var t=this.equipment.getChildByName("ScrollView").getComponent(cc.ScrollView).content;if(k.default.setNodeChildDestoryByUrl(t,x.GlobalContext.Root+"prefab/Equip/attr/EquipAttrTileNode"),e){var i=w.default.instance.data.getEquipCfg(),n=w.default.instance.data.getEquipInfoById(e.id),o={};if(w.default.instance.data.getEquipBaseAttrMap(e.id,o),o=b.default.instance.getAttrPrecentByGradeAndType(1,o),this.setEquipAttr(t,1,o),D.default.instance.checkIsOpenbyWindowtype(p.WindowType.Strengthen)&&e.level>0){o={};var a=w.default.instance.data.getCalculateEquipStrengthenAttr(e.id,e.level);w.default.instance.data.getEquipStrengthenAttr(o,a),o=b.default.instance.getAttrPrecentByGradeAndType(1,o),this.setEquipAttr(t,2,o,e.level)}if(D.default.instance.checkIsOpenbyWindowtype(p.WindowType.Strengthen)&&e.stage>0){var r=i.stage[n.stage][e.stage].randomAttr,s=i.randomAttr[r];o={},w.default.instance.data.getEquipStageAttr(o,s),o=b.default.instance.getAttrPrecentByGradeAndType(1,o),this.setEquipAttr(t,5,o,e.stage+1)}if(e.gem.length>0&&(e.gem[0]||e.gem[1]||e.gem[2])&&this.setEquipAttr(t,4,e.gem,null,null,!0,e.id),e.effect&&e.effect.length>0){var l={};for(var c in e.effect)if(e.effect[c]>=0){var d=w.default.instance.data.getEquipEffectAttrCfg(e.effect[c],e.stage);l[d.type]=d.value}this.setEquipAttr(t,6,l,e.stage+1)}}},t.prototype.setEquipAttr=function(e,t,i,n,o,a,r){M.default.instance.loadResByType(x.GlobalContext.Root+"prefab/Equip/attr/EquipAttrTileNode",cc.Prefab,function(s){var l=k.default.getNodeByUrl(s,x.GlobalContext.Root+"prefab/Equip/attr/EquipAttrTileNode");e.addChild(l),l.getComponent(I.default).setData(t,i,n,o,a,r)},this)},t.prototype.materia=function(e){var t=w.default.instance.data.getWarTeamCardId(),i=null;switch(e.ClientType){case r.ItemType.forging:case r.ItemType.order:this.openEquip(t.cardId,p.WindowType.Strengthen,R.EquipWinBtnTag.TYPE);break;case r.ItemType.gemstone:i=t.equipFlag?R.EquipWinBtnTag.TYPE1:R.EquipWinBtnTag.TYPE,this.openEquip(t.cardId,p.WindowType.Gemstone,i);break;case r.ItemType.Refined:i=t.equipFlag?R.EquipWinBtnTag.TYPE2:R.EquipWinBtnTag.TYPE,this.openEquip(t.cardId,p.WindowType.Refine,i)}},t.prototype.openEquip=function(e,t,i){var n=D.default.instance.checkIsOpenbyWindowtype(p.WindowType.CardEquip,!0),o=D.default.instance.checkIsOpenbyWindowtype(t,!0);n&&o&&this.openEquipTab(e,i)},t.prototype.openEquipTab=function(e,t){g.default.instance.openWindow(p.WindowType.WarTeam,function(){b.default.instance.openMonsterInfoPrefab(e,A.CardTag.equip,null,null,null,!1,t)},this)},t.prototype.setlistinfo=function(e){if(e.length<16)for(var t=e.length;t<16;++t)e.push(null);this.listViewCtrNode.getComponent(L.default).refreshItem=this.updateitem,this.listViewCtrNode.getComponent(L.default).refreshItemThis=this,this.listViewCtrNode.getComponent(L.default).initialize(e)},t.prototype.updateitem=function(e,t){var i=this.ItemArr[t],o=!!i;e.getChildByName("bg").active=!o,i?(e.getChildByName("itemNew").active=y.default.instance.itemisNew[i.guid],y.default.instance.itemisNew[i.guid]=!1):e.getChildByName("itemNew").active=!1,e.getChildByName("equipFlag").active=i&&i.ower&&i.ower>-1,e.getChildByName("Choose")&&(e.getChildByName("Choose").active=!1),e.getChildByName("ItemIcon").active=o,o&&e.getChildByName("ItemIcon").getComponent(n.default).ItemData(i)},t.prototype.onClickTab=function(e){this.windowBg&&this.windowBg.getComponent(E.default).TabBtnList.selectItem(e)},t.instance="",__decorate([j(cc.Node)],t.prototype,"Itemicon",void 0),__decorate([j(cc.RichText)],t.prototype,"ItemDesc",void 0),__decorate([j(cc.Label)],t.prototype,"ItemPrice",void 0),__decorate([j(cc.Label)],t.prototype,"ItemName",void 0),__decorate([j(cc.Label)],t.prototype,"ItemCount",void 0),__decorate([j(cc.Node)],t.prototype,"content",void 0),__decorate([j(cc.Button)],t.prototype,"SellBtn",void 0),__decorate([j(cc.Button)],t.prototype,"UseBtn",void 0),__decorate([j(cc.ScrollView)],t.prototype,"BagList",void 0),__decorate([j(cc.Toggle)],t.prototype,"Firstcheck",void 0),__decorate([j(cc.Node)],t.prototype,"equipment",void 0),__decorate([j(cc.Node)],t.prototype,"otheritem",void 0),__decorate([j(cc.Node)],t.prototype,"breakDownNode",void 0),__decorate([j(cc.Node)],t.prototype,"noBreakNode",void 0),__decorate([j(cc.Node)],t.prototype,"resolve",void 0),__decorate([j(cc.Node)],t.prototype,"apparel",void 0),__decorate([j(cc.Label)],t.prototype,"number",void 0),__decorate([j(cc.Node)],t.prototype,"listViewCtrNode",void 0),t=i=__decorate([H],t)}(a.default);i.default=K,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/Window":"Window","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../NetConnect/NetConnet":"NetConnet","../../Util/NumberUtil":"NumberUtil","../../Util/Utils":"Utils","../Commons/ListViewCtrl":"ListViewCtrl","../Commons/RewardUtils":"RewardUtils","../Commons/WindowBg1":"WindowBg1","../Commons/WindowOpenUtils":"WindowOpenUtils","../Equip/Attr/EquipAttrTileNode":"EquipAttrTileNode","../Equip/ReplaceWin":"ReplaceWin","../Equip/equip/EquipCtrl":"EquipCtrl","../Functionicon/FunctionIconController":"FunctionIconController","../OpenWin/OpenWinController":"OpenWinController","../Ornament/OrnamentCtrl":"OrnamentCtrl","../Role/RoleController":"RoleController","../Role/RoleInfo":"RoleInfo","../Shop/Shop":"Shop","../Shop/ShopConst":"ShopConst","../Shop/ShopController":"ShopController","../Tips/BatchUsageTips":"BatchUsageTips","../Tips/OpTipsController":"OpTipsController","../Tips/RewardTips":"RewardTips","../WarTeam/MonsterController":"MonsterController","../WarTeam/WarTeamMonsterInfo":"WarTeamMonsterInfo","./GiftBagWin":"GiftBagWin","./ItemController":"ItemController","./ItemIcon":"ItemIcon","./ItemModel":"ItemModel","./ItemType":"ItemType"}],BaiBeiFanLiConst:[function(e,t,i){"use strict";cc._RF.push(t,"a5137uCfAlEKqSvnp/uTCdg","BaiBeiFanLiConst"),Object.defineProperty(i,"__esModule",{value:!0}),function(e){e[e.Buy=0]="Buy",e[e.ButNoReceive=1]="ButNoReceive",e[e.ButAlreadyReceive=2]="ButAlreadyReceive"}(i.BaiBeiFanLiReceiveState||(i.BaiBeiFanLiReceiveState={})),cc._RF.pop()},{}],BaiBeiFanLiCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"68044SPAt5EQ6aVilcUepHY","BaiBeiFanLiCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../Commons/RewardUtils"),a=e("../OpenWin/OpenWinController"),r=e("../../Core/WindowType"),s=e("../Tips/RewardTips"),l=e("../../Util/SDKUtils"),c=e("../../NetConnect/NetConnet"),d=e("../Tips/OpTipsController"),p=e("../../Core/Language"),h=e("./BaiBeiFanLiConst"),u=e("../../Core/GameEventDispatcher"),f=e("../../Core/Event"),g=e("../Functionicon/FunctionIconController"),y=e("../ActivityView/ActivityCtrl"),m=cc._decorator,C=m.ccclass,v=(m.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.redState=!1,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this),i.instance=this},t.prototype.listNotification=function(){this.addProto("bbrebateinfo",this.setSerData,this),this.addProto("bbrebatereward",this.rewardPanel,this),u.GameEventDispatcher.instance.on(f.EventDefiner.Activity_YunyingUP,this.serStateData,this)},t.prototype.gerSerData=function(){return this.parameter},t.prototype.serStateData=function(){var e=y.default.instance.data.getActivityState(r.WindowType.BaiBeiFanLi);this.activityId||(this.activityId=y.default.instance.data.getYunyingId(r.WindowType.BaiBeiFanLi)),e?this.bbrebateinfo():g.default.instance.FuncIconHideDeal(r.WindowType.BaiBeiFanLi,!0)},t.prototype.callBack=function(){var e=this.gerSerData();this.rewardPanel(e.id)},t.prototype.setSerData=function(e){this.status=e.status,this.parameter=e.conf,this.index=e.index,u.GameEventDispatcher.instance.emit(f.EventDefiner.BaiBeiFanLiUpdate),g.default.instance.FuncIconRedDeal(r.WindowType.BaiBeiFanLi,this.getReddot()),g.default.instance.FuncIconHideDeal(r.WindowType.BaiBeiFanLi,this.isHide()),u.GameEventDispatcher.instance.emit(f.EventDefiner.ShowBtnPic)},t.prototype.rewardPanel=function(e){var t=o.default.instance.getItemList(e.reward);a.default.instance.openWindow(r.WindowType.RewardTips,function(){s.default.instance.setData(t)},this)},t.prototype.getReddot=function(){return this.status==h.BaiBeiFanLiReceiveState.ButNoReceive},t.prototype.isHide=function(){return this.status==h.BaiBeiFanLiReceiveState.ButAlreadyReceive},t.prototype.bbrebateinfo=function(){var e={cmd:"bbrebateinfo",actid:this.activityId};c.default.instance.sendProto(e)},t.prototype.bbrecharge=function(){l.default.instance.rechargeByIndex(this.parameter.rechargeId,function(e){e&&d.default.instance.ShowMsg(p.default.getStr("\u5145\u503c\u6210\u529f"))},this)},t.prototype.bbgetreward=function(){var e={cmd:"bbgetreward",actid:this.activityId};c.default.instance.sendProto(e)},t.prototype.isOpen=function(e){var t=e.section[2];return 2==e.chapter&&t&&3==t.length&&this.status!=h.BaiBeiFanLiReceiveState.ButAlreadyReceive},t.prototype.isCanOpen=function(){return null!=this.status&&this.status!=h.BaiBeiFanLiReceiveState.ButAlreadyReceive},t.prototype.isOneSeckillOpen=function(e){var t=e.section[4];return 4==e.chapter&&t&&5==t.length&&y.default.instance.data.getActivityState(r.WindowType.OneSeckill)},t.prototype.isFristBag=function(){return!this.index},t.instance=null,t=i=__decorate([C],t)}(n.default));i.default=v,cc._RF.pop()},{"../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/WindowType":"WindowType","../../NetConnect/NetConnet":"NetConnet","../../Util/SDKUtils":"SDKUtils","../ActivityView/ActivityCtrl":"ActivityCtrl","../Commons/RewardUtils":"RewardUtils","../Functionicon/FunctionIconController":"FunctionIconController","../OpenWin/OpenWinController":"OpenWinController","../Tips/OpTipsController":"OpTipsController","../Tips/RewardTips":"RewardTips","./BaiBeiFanLiConst":"BaiBeiFanLiConst"}],BaiBeiFanLiVo:[function(e,t,i){"use strict";cc._RF.push(t,"17de7fVd/FCQrkHOTe1r/IX","BaiBeiFanLiVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){return function(e){for(var t in e)this[t]=e[t]}}();i.BaiBeiFanLiVo=n,cc._RF.pop()},{}],BaiBeiFanLiWin:[function(e,t,i){"use strict";cc._RF.push(t,"7a2760jLH5BYYY0fJNRSO9j","BaiBeiFanLiWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/GameEventDispatcher"),o=e("../../Core/Event"),a=e("./BaiBeiFanLiCtrl"),r=e("../../Core/Window"),s=e("../../Core/Language"),l=e("../../Util/Utils"),c=e("../../Core/WindowType"),d=e("../Commons/RewardUtils"),p=e("../Item/ItemIcon"),h=e("./BaiBeiFanLiConst"),u=e("../WarTeam/MonsterController"),f=e("../Commons/MonsterPreview"),g=e("../../Global/GlobalValue"),y=e("../../Core/LoadManager"),m=e("../../GlobalContext"),C=e("../Commons/Image"),v=e("../Vip/VipCtrl"),_=cc._decorator,b=_.ccclass,T=_.property,S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.reward=null,t.label=null,t.btn=null,t.bg=null,t.model=null,t.title=null,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this),i.instance=this},t.prototype.show=function(){e.prototype.show.call(this),this.initData(),this.updateData(),n.GameEventDispatcher.instance.on(o.EventDefiner.BaiBeiFanLiUpdate,this.updateData,this)},t.prototype.close=function(){e.prototype.close.call(this),v.default.instance.openVipUPtips()},t.prototype.hide=function(){e.prototype.hide.call(this);for(var t=this.reward.childrenCount-1;t>=0;t--)l.default.setNodeToPool(c.PoolType.ItemIcon,this.reward.children[t]);l.default.setNodeToPool(c.PoolType.MonsterPreview,this.model.children[0]),n.GameEventDispatcher.instance.off(o.EventDefiner.BaiBeiFanLiUpdate,this.updateData,this)},t.prototype.initData=function(){var e=this;this.label.string=s.default.getStr("7003");var t,i=a.default.instance.gerSerData();l.default.setNodeChildDestoryByUrl(this.reward,m.GlobalContext.Root+"prefab/Bag/ItemIcon"),y.default.instance.loadResByType(m.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(n){var o=d.default.instance.getItemList(i.id);if(!e.reward.childrenCount)for(var a in o){var r=o[a];(t=l.default.getNodeByPool(c.PoolType.ItemIcon,n,m.GlobalContext.Root+"prefab/Bag/ItemIcon")).getComponent(p.default).ItemData(o[a],!0,r.count+"",!0),e.reward.addChild(t)}},this);var n=m.GlobalContext.ResRoot+"resources/Activity/BaiBeiFanLi/"+i.ui+".png";this.title.getComponent(C.default).loadImageByHttps(n),t=l.default.getNodeByPool(c.PoolType.MonsterPreview,u.default.instance.MonsterPreview),this.model.removeAllChildren(),this.model.addChild(t),this.model.children[0].getComponent(f.default).init("monster",i.model,5,g.DEFAULTS_SKIN+5,g.PRIORITY.MONSTER)},t.prototype.updateData=function(){var e=a.default.instance.status;e=null!=e?e:0,this.initData(),this.btn.getChildByName("label").getComponent(cc.Label).string=s.default.getStr("700"+e),this.btn.getComponent(cc.Button).interactable=e!=h.BaiBeiFanLiReceiveState.ButAlreadyReceive;var t=a.default.instance.isFristBag()?"1":"",i=m.GlobalContext.ResRoot+"resources/Activity/BaiBeiFanLi/bg_beijing"+t+".png";this.bg.loadImageByHttps(i)},t.prototype.onClickSend=function(e){var t=a.default.instance.status;switch(t=null!=t?t:0,a.default.instance.status){case h.BaiBeiFanLiReceiveState.Buy:a.default.instance.bbrecharge();break;case h.BaiBeiFanLiReceiveState.ButNoReceive:a.default.instance.bbgetreward()}},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.update=function(){},t.instance=null,__decorate([T(cc.Node)],t.prototype,"reward",void 0),__decorate([T(cc.Label)],t.prototype,"label",void 0),__decorate([T(cc.Node)],t.prototype,"btn",void 0),__decorate([T(C.default)],t.prototype,"bg",void 0),__decorate([T(cc.Node)],t.prototype,"model",void 0),__decorate([T(cc.Node)],t.prototype,"title",void 0),t=i=__decorate([b],t)}(r.default);i.default=S,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/Window":"Window","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/Image":"Image","../Commons/MonsterPreview":"MonsterPreview","../Commons/RewardUtils":"RewardUtils","../Item/ItemIcon":"ItemIcon","../Vip/VipCtrl":"VipCtrl","../WarTeam/MonsterController":"MonsterController","./BaiBeiFanLiConst":"BaiBeiFanLiConst","./BaiBeiFanLiCtrl":"BaiBeiFanLiCtrl"}],BarrageTips:[function(e,t,i){"use strict";cc._RF.push(t,"f3cd40UsQ1LJI7OJYl2moXi","BarrageTips"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../Util/Utils"),a=e("../../Core/WindowType"),r=cc._decorator,s=r.ccclass,l=r.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Container=null,t.Item=null,t._PositionDic={},t._PositionCount=20,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.start=function(){},t.prototype.Clear=function(){for(var e=this.Container.childrenCount-1;e>=0;e--){var t=this.Container.children[e];t.stopAllActions(),o.default.setNodeToPool(a.PoolType.BarrageTipsItem,t)}},t.prototype.ShowMsg=function(e){var t=this.Container,i=o.default.getNodeByPool(a.PoolType.BarrageTipsItem,this.Item);i.getComponent(cc.Label).string=e,t.addChild(i);var n=t.height/2-t.height/this._PositionCount*this.GetRandomPosition(1);i.setPosition(t.width/2,n);var r=(t.width+i.width)/330;i.runAction(cc.sequence(cc.moveTo(r,-t.width/2,n),cc.callFunc(function(){o.default.setNodeToPool(a.PoolType.BarrageTipsItem,i)},this)))},t.prototype.InitPosition=function(e){var t=[],i=[];this._PositionDic[e]=[t,i];for(var n=0;n<this._PositionCount;n++)n%2==0?t.push(n):i.push(n)},t.prototype.GetRandomPosition=function(e){if(this._PositionDic[e]){var t=this._PositionDic[e][0],i=this._PositionDic[e][1],n=0;if(t.length>0)return n=o.default.RandomBy(1,t.length)-1,t.splice(n,1)[0];if(i.length>0)return n=o.default.RandomBy(1,i.length)-1,i.splice(n,1)[0]}return this.InitPosition(e),this.GetRandomPosition(e)},t.instance=null,__decorate([l(cc.Node)],t.prototype,"Container",void 0),__decorate([l(cc.Node)],t.prototype,"Item",void 0),t=i=__decorate([s],t)}(n.default);i.default=c,cc._RF.pop()},{"../../Core/Controller":"Controller","../../Core/WindowType":"WindowType","../../Util/Utils":"Utils"}],BatchUsageTips:[function(e,t,i){"use strict";cc._RF.push(t,"c39a8rVV/JBl6ZP11/JT/L/","BatchUsageTips"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../../Core/TimeController"),a=cc._decorator,r=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Type2Icon=null,t.GoodsName=null,t.GoodsNumber=null,t.Type2=null,t.CurNumber=null,t.TitleLabel=null,t.InitIcon=null,t.Handle=null,t.BuyNumber=null,t.CostMoney=null,t.Bag=null,t.Shop=null,t.ShopNum=null,t.ShopDec=null,t.count=null,t._BtnClickCallback=null,t._BtnClickCallbackThisObj=null,t._BtnClickCallbackParam=[],t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this,this.node.getChildByName("MaskBg").getComponent("StopClickEventComponent").MaskClickIsClose=!0},t.prototype.hide=function(){e.prototype.hide.call(this)},t.prototype.ShowTips1=function(e,t,i,n,o,a,r,s){void 0===t&&(t=null),void 0===i&&(i=null),void 0===n&&(n=null),void 0===r&&(r=null),this.node.active&&(this.Type2.active=!0,this._BtnClickCallbackParam=n,r=r||"\u4f7f\u7528",this.Type2Icon.getComponent("ItemIcon").ItemData(o,!1),this.GoodsName.string=o.name,this.BuyNumber.string="1",this.CostMoney.string=s?s+"":1*Number(o.dealPrice)+"",this.Price=s||Number(o.dealPrice),this.GoodsNumber.string=o.count+"",this.TitleLabel.string=e,this.count=o.count,this.CurNumber.string="1",this._BtnClickCallback=t,this._BtnClickCallbackThisObj=i,1==a?(this.Handle.progress=0,this.Bag.active=!0,this.Shop.active=!1,this.Type2.getChildByName("Bag").getChildByName("Button3").getChildByName("Label").getComponent(cc.Label).string=r):2==a&&(this.Bag.active=!1,this.Shop.active=!0,this.ShopNum.string=o.count+"",this.ShopDec.string=o.desc,this.Type2.getChildByName("Shop").getChildByName("Button3").getChildByName("Label").getComponent(cc.Label).string=r))},t.prototype.onMove=function(e){this.count/2==1?this.CurNumber.string=e.progress<.5?"1":Math.floor(e.progress*this.count)+"":this.CurNumber.string=e.progress*this.count<=1?"1":Math.floor(e.progress*this.count)+""},t.prototype.onBtn1Click=function(e,t){if(1==parseInt(t))i=(i=parseInt(this.CurNumber.string))-1<=0?1:i-1,this.CurNumber.string=i+"",this.Handle.progress=i/this.count;else if(2==parseInt(t)&&this.BuyNumber.string>"1"){var i=Number(this.BuyNumber.string)-1;this.BuyNumber.string=i+"",this.CostMoney.string=i*this.Price+""}},t.prototype.onBtn2Click=function(e,t){if(1==parseInt(t))i=(i=parseInt(this.CurNumber.string))+1>this.count?this.count:i+1,this.CurNumber.string=i+" ",this.Handle.progress=i/this.count;else if(2==parseInt(t)&&this.BuyNumber.string>="1"){var i=Number(this.BuyNumber.string)+1;this.BuyNumber.string=i+"",this.CostMoney.string=i*this.Price+""}},t.prototype.onBtn3Click=function(e,t){var i=this;this.close(),1==parseInt(t)?this._BtnClickCallbackParam.push(Number(this.CurNumber.string)):2==parseInt(t)&&this._BtnClickCallbackParam.push(Number(this.BuyNumber.string));var n=o.default.instance.setTimeout(function(){i._BtnClickCallback&&i._BtnClickCallback.apply(i._BtnClickCallbackThisObj,i._BtnClickCallbackParam),i._BtnClickCallback=i._BtnClickCallbackThisObj=i._BtnClickCallbackParam=null,o.default.instance.clearTimeout(n)},this,100)},t.instance=null,__decorate([s(cc.Node)],t.prototype,"Type2Icon",void 0),__decorate([s(cc.Label)],t.prototype,"GoodsName",void 0),__decorate([s(cc.Label)],t.prototype,"GoodsNumber",void 0),__decorate([s(cc.Node)],t.prototype,"Type2",void 0),__decorate([s(cc.Label)],t.prototype,"CurNumber",void 0),__decorate([s(cc.Label)],t.prototype,"TitleLabel",void 0),__decorate([s(cc.SpriteFrame)],t.prototype,"InitIcon",void 0),__decorate([s(cc.Slider)],t.prototype,"Handle",void 0),__decorate([s(cc.Label)],t.prototype,"BuyNumber",void 0),__decorate([s(cc.Label)],t.prototype,"CostMoney",void 0),__decorate([s(cc.Node)],t.prototype,"Bag",void 0),__decorate([s(cc.Node)],t.prototype,"Shop",void 0),__decorate([s(cc.Label)],t.prototype,"ShopNum",void 0),__decorate([s(cc.Label)],t.prototype,"ShopDec",void 0),t=i=__decorate([r],t)}(n.default);i.default=l,cc._RF.pop()},{"../../Core/TimeController":"TimeController","../../Core/Window":"Window"}],BigSkill18Controller:[function(e,t,i){"use strict";cc._RF.push(t,"8a5ef1g3WBE4rLySri8RgWW","BigSkill18Controller"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Controller/FightController"),o=e("../View/FightView"),a=e("../Pool/SpinePools"),r=e("../../../Core/SpineBase"),s=e("../Controller/SkillController"),l=e("../../../Global/GlobalValue"),c=e("../Controller/SpecialSkillEffectController"),d=function(){function e(){this.ins=null,this.effectnode=[],this.effectbg=null,this.effectnodeNum=0}return Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e,e.instance.init()),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.ins=c.default.instance},e.prototype.showSpecialEffect=function(){this.showSpecialEffect3()},e.prototype.showSpecialEffect3=function(){var e=this;this.effectbg=a.SpinePools.addSpineNoder(n.default.instance.ActorsMaskLayer.node,new cc.Vec2(0,0)),this.effectbg.setSiblingIndex(n.default.instance.ActorsMaskLayer.node.childrenCount-1),this.effectbg.scaleX=this.ins.specialskillattackentitys[0].prop.dir;var t=this.effectbg.getComponent(r.default),i=s.default.instance.getSkillBySkillId(this.ins.skill);o.default.instance.SetFightViewPlayRate(c.default.instance.specialrate),this.ins.spskillcom=!1,t.playRate=c.default.instance.specialrate,t.setAnimEventCall("skill",this.addHitEffect,this,null),t.completeCallbackThisObj=this,t.completeCallbackParam=[this.effectbg],t.completeCallback=function(t){e.ins.spskillcom=!0,a.SpinePools.recoverSpineNoder(t)},t.initSpineData(l.SPINE_RES_DIR+"monster/"+this.ins.specialskillattackentitys[0].prop.spineId+"/"+i.effectTypeName,l.DEFAULTS_SKIN+this.ins.specialskillattackentitys[0].prop.grade,"fight2",!1)},e.prototype.addHitEffect=function(){var e=this.ins.specialskillhitentitys;this.ins.specialskillhitentitys.sort(this.sortX),this.addOneEffect(e[Math.floor(e.length-.5)])},e.prototype.addOneEffect=function(e){var t=this;this.effectnodeNum++;var i=e.prop.x,o=a.SpinePools.addSpineNoder(n.default.instance.ActorsMaskLayer.node,cc.v2(i,-300));o.scaleX=this.ins.specialskillattackentitys[0].prop.dir,this.effectnode.push(o);var l=o.getComponent(r.default),c=(s.default.instance.getSkillBySkillId(this.ins.skill),"skin"+this.ins.specialskillattackentitys[0].prop.grade+"_fight2_b");l.setAnimEventCall("skill",this.userskill,this,null),l.completeCallbackThisObj=this,l.completeCallbackParam=[o],l.completeCallback=function(e){t.effectnode=t.effectnode.slice(t.effectnode.indexOf(e),1),a.SpinePools.recoverSpineNoder(e),t.effectnodeNum--,0==t.effectnodeNum&&(t.ins.othereffect=!0,t.ins.complete(),t.clear())},l.initSpineData(this.ins.specialskillattackentitys[0].prop.getAttackEffectUrl(),null,c,!1)},e.prototype.userskill=function(){this.ins.useSkill1()},e.prototype.clear=function(){this.effectnodeNum=0,this.ins.othereffect=!0;for(var e=0,t=this.effectnode;e<t.length;e++){var i=t[e];a.SpinePools.recoverSpineNoder(i)}this.effectbg&&a.SpinePools.recoverSpineNoder(this.effectbg),this.effectbg=null,this.effectnode=[]},e.prototype.sortX=function(e,t){return e.prop.x-t.prop.x},e._instance=null,e}();i.default=d,cc._RF.pop()},{"../../../Core/SpineBase":"SpineBase","../../../Global/GlobalValue":"GlobalValue","../Controller/FightController":"FightController","../Controller/SkillController":"SkillController","../Controller/SpecialSkillEffectController":"SpecialSkillEffectController","../Pool/SpinePools":"SpinePools","../View/FightView":"FightView"}],BigSkill22Controller:[function(e,t,i){"use strict";cc._RF.push(t,"1964aTTfB1Niq+hIUHTKdJ4","BigSkill22Controller"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../View/FightView"),o=e("../Controller/SpecialSkillEffectController"),a=e("../Pool/SpinePools"),r=e("../Controller/FightController"),s=e("../../../Core/SpineBase"),l=e("../Controller/SkillController"),c=e("../../../Global/GlobalValue"),d=e("../../../Core/TimeController"),p=e("../../../Util/Scene/MoveUtil"),h=e("../../../Util/Shake"),u=e("../../Sound/SoundController"),f=function(){function e(){this.ins=null,this.effectnode=[],this.effectbg=null,this.effectnodeNum=0}return Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e,e.instance.init()),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.ins=o.default.instance},e.prototype.showSpecialEffect=function(){r.default.instance.ActorsMaskLayer.node.opacity=255,this.showSpecialEffect3();for(var e=0,t=this.ins.specialskillhitentitys;e<t.length;e++){var i=t[e];i.node.y=i.prop.y-200,i.node.opacity=0}},e.prototype.showSpecialEffect3=function(){var e=this;this.effectbg=a.SpinePools.addSpineNoder(r.default.instance.ActorsMaskLayer.node,new cc.Vec2(0,0)),this.effectbg.setSiblingIndex(r.default.instance.ActorsMaskLayer.node.childrenCount-1),this.effectbg.scaleX=this.ins.specialskillattackentitys[0].prop.dir;var t=this.effectbg.getComponent(s.default),i=l.default.instance.getSkillBySkillId(this.ins.skill);n.default.instance.SetFightViewPlayRate(o.default.instance.specialrate),this.ins.spskillcom=!1,t.playRate=o.default.instance.specialrate,t.setAnimEventCall("skill",this.addFireEffect,this,null),t.completeCallbackThisObj=this,t.completeCallbackParam=[this.effectbg],t.completeCallback=function(t){e.ins.spskillcom=!0,a.SpinePools.recoverSpineNoder(t)},t.initSpineData(c.SPINE_RES_DIR+"monster/"+this.ins.specialskillattackentitys[0].prop.spineId+"/"+i.effectTypeName,c.DEFAULTS_SKIN+this.ins.specialskillattackentitys[0].prop.grade,"fight2",!1)},e.prototype.addFireEffect=function(){var e=l.default.instance.getSkillBySkillId(this.ins.skill);e.skillMusic&&u.default.instance.PlayEffect("audio/BattleSound/"+e.skillMusic);var t=this.ins.specialskillhitentitys;this.ins.specialskillhitentitys.sort(this.sortX),p.MoveUtil.getPixelDis(t[0].prop.x,0,t[t.length-1].prop.x,0)>200?(this.addOneEffect(t[0]),this.addOneEffect(t[t.length-1])):this.addOneEffect(t[Math.floor(t.length-.5)])},e.prototype.addOneEffect=function(e){var t=this;this.effectnodeNum++;var i=760*Math.tan(Math.PI/180*40),o=e.prop.x>0?e.prop.x-i:e.prop.x+i,c=a.SpinePools.addSpineNoder(r.default.instance.ActorsMaskLayer.node,cc.v2(o,300)),u=e.prop.x>0?-1:1;c.scale=.2,c.scaleX=.2*u,this.effectnode.push(c);var f=c.getComponent(s.default),g=(l.default.instance.getSkillBySkillId(this.ins.skill),"skin"+this.ins.specialskillattackentitys[0].prop.grade+"_fight2_a"),y=p.MoveUtil.getPixelDis(c.x,0,e.prop.x,0),m=p.MoveUtil.getPixelDis(0,c.y,0,e.prop.y);f.readlySpineCall=function(){var i=d.default.instance.setTimeout(function(){c.stopAllActions(),c.runAction(cc.sequence(cc.delayTime(.2),cc.spawn(cc.moveBy(.5,cc.v2(.2*-y*u,.2*-m)),cc.scaleTo(.5,.4*u,.4)),cc.callFunc(function(){t.showMosnter(),c.runAction(cc.sequence(cc.spawn(cc.moveTo(.2,cc.v2(e.prop.x,e.prop.y)),cc.scaleTo(.2,1*u,1)),cc.callFunc(function(){t.ins.useSkill1(),f.loop=!1,f.play("skin"+t.ins.specialskillattackentitys[0].prop.grade+"_fight2_b");var e=h.Shake.create(1,15,15);n.default.instance.node.runAction(e),f.completeCallbackThisObj=t,f.completeCallbackParam=[c],f.completeCallback=function(i){t.effectnode=t.effectnode.slice(t.effectnode.indexOf(i),1),a.SpinePools.recoverSpineNoder(i),t.effectnodeNum--,0==t.effectnodeNum&&(t.ins.othereffect=!0,t.ins.complete(),t.clear(),e.stop())}},t)))},t))),d.default.instance.clearTimeout(i)},t,100)},f.readlySpineCallThisObj=this,f.initSpineData(this.ins.specialskillattackentitys[0].prop.getAttackEffectUrl(),null,g,!0)},e.prototype.clear=function(){this.effectnodeNum=0,this.ins.othereffect=!0;for(var e=0,t=this.effectnode;e<t.length;e++){var i=t[e];a.SpinePools.recoverSpineNoder(i)}this.effectbg&&a.SpinePools.recoverSpineNoder(this.effectbg),this.effectbg=null,this.effectnode=[]},e.prototype.sortX=function(e,t){return e.prop.x-t.prop.x},e.prototype.showMosnter=function(){for(var e=0,t=this.ins.specialskillhitentitys;e<t.length;e++){var i=t[e];i.node.opacity=255,i.node.runAction(cc.moveTo(.2,i.prop.x,i.prop.y))}},e._instance=null,e}();i.default=f,cc._RF.pop()},{"../../../Core/SpineBase":"SpineBase","../../../Core/TimeController":"TimeController","../../../Global/GlobalValue":"GlobalValue","../../../Util/Scene/MoveUtil":"MoveUtil","../../../Util/Shake":"Shake","../../Sound/SoundController":"SoundController","../Controller/FightController":"FightController","../Controller/SkillController":"SkillController","../Controller/SpecialSkillEffectController":"SpecialSkillEffectController","../Pool/SpinePools":"SpinePools","../View/FightView":"FightView"}],BigSkillArf2Controller:[function(e,t,i){"use strict";cc._RF.push(t,"33f2a9jorpJvL37VdC6x8sh","BigSkillArf2Controller"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Controller/SpecialSkillEffectController"),o=e("../Manager/SceneManager"),a=e("../Pool/SpinePools"),r=e("../Controller/FightController"),s=e("../../../Core/SpineBase"),l=e("../../../Global/GlobalValue"),c=e("../../../Core/TimeController"),d=function(){function e(){this.ins=null,this.effectnode=[],this.effectbg=null,this.effectnodeNum=0}return Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e,e.instance.init()),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.ins=n.default.instance},e.prototype.showSpecialEffect=function(){var e=this.ins.specialskillattackentitys[0];e.setloop(!1),e.playAnimation(l.ACTION.FIGHT1);c.default.instance.setTimeout(this.addFireEffect,this,200)},e.prototype.addFireEffect=function(){o.default.instance.rightlives;this.ins.specialskillhitentitys.sort(this.sortX);var e=Math.floor(this.ins.specialskillhitentitys.length/2),t=this.ins.specialskillhitentitys[e];this.addOneEffect(t)},e.prototype.addOneEffect=function(e){var t=this,i=e.prop.x,n=e.prop.y,o=a.SpinePools.addSpineNoder(r.default.instance.ActorsMaskLayer.node,cc.v2(i,n));this.effectnode.push(o);var l=o.getComponent(s.default),d=a.SpinePools.addSpineNoder(r.default.instance.ActorsMaskLayer.node,cc.v2(i,n));d.setSiblingIndex(1),this.effectnode.push(d);var p=d.getComponent(s.default);c.default.instance.setTimeout(function(){t.ins.useSkill1()},this,1600);l.readlySpineCall=function(){var e=c.default.instance.setTimeout(function(){o.stopAllActions(),l.loop=!1,l.completeCallbackThisObj=t,l.completeCallbackParam=[o],l.completeCallback=function(e){t.effectnode.slice(t.effectnode.indexOf(e),1),a.SpinePools.recoverSpineNoder(e),t.ins.complete(),t.clear()},c.default.instance.clearTimeout(e)},t,500)},l.readlySpineCallThisObj=this,l.initSpineData("spine/Artifact/Artifact2",null,"sq2-1",!0);p.readlySpineCall=function(){var e=c.default.instance.setTimeout(function(){d.stopAllActions(),p.loop=!1,p.completeCallbackThisObj=t,p.completeCallbackParam=[d],p.completeCallback=function(e){t.effectnode.slice(t.effectnode.indexOf(e),1),a.SpinePools.recoverSpineNoder(e)},c.default.instance.clearTimeout(e)},t,500)},p.readlySpineCallThisObj=this,p.initSpineData("spine/Artifact/Artifact2",null,"sq2-2",!0)},e.prototype.clear=function(){if(!(this.effectnode.length<=0)){this.effectnodeNum=0,this.ins.othereffect=!0;for(var e=0,t=this.effectnode;e<t.length;e++){var i=t[e];i.stopAllActions(),a.SpinePools.recoverSpineNoder(i)}this.effectbg&&a.SpinePools.recoverSpineNoder(this.effectbg),this.effectbg=null,this.effectnode=[]}},e.prototype.sortX=function(e,t){return e.prop.x-t.prop.x},e.prototype.showMosnter=function(){for(var e=0,t=this.ins.specialskillhitentitys;e<t.length;e++){var i=t[e];i.node.opacity=255,i.node.runAction(cc.moveTo(.2,i.prop.x,i.prop.y))}},e._instance=null,e}();i.default=d,cc._RF.pop()},{"../../../Core/SpineBase":"SpineBase","../../../Core/TimeController":"TimeController","../../../Global/GlobalValue":"GlobalValue","../Controller/FightController":"FightController","../Controller/SpecialSkillEffectController":"SpecialSkillEffectController","../Manager/SceneManager":"SceneManager","../Pool/SpinePools":"SpinePools"}],BigSkillArf3Controller:[function(e,t,i){"use strict";cc._RF.push(t,"2e40aSt6wVMcI9IB6Vj0FJU","BigSkillArf3Controller"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Controller/SpecialSkillEffectController"),o=e("../Manager/SceneManager"),a=e("../Pool/SpinePools"),r=e("../Controller/FightController"),s=e("../../../Core/SpineBase"),l=e("../../../Global/GlobalValue"),c=e("../../../Core/TimeController"),d=function(){function e(){this.ins=null,this.effectnode=[],this.effectbg=null,this.effectnodeNum=0}return Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e,e.instance.init()),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.ins=n.default.instance},e.prototype.showSpecialEffect=function(){var e=this.ins.specialskillattackentitys[0];e.setloop(!1),e.playAnimation(l.ACTION.FIGHT1);c.default.instance.setTimeout(this.addFireEffect,this,200)},e.prototype.addFireEffect=function(){o.default.instance.rightlives;this.ins.specialskillhitentitys.sort(this.sortX);var e=Math.floor(this.ins.specialskillhitentitys.length/2),t=this.ins.specialskillhitentitys[e];this.addOneEffect(t)},e.prototype.addOneEffect=function(e){var t=this,i=e.prop.x,n=e.prop.y,o=a.SpinePools.addSpineNoder(r.default.instance.ActorsMaskLayer.node,cc.v2(i,n));this.effectnode.push(o);var l=o.getComponent(s.default),d=a.SpinePools.addSpineNoder(r.default.instance.ActorsMaskLayer.node,cc.v2(i,n));d.setSiblingIndex(1),this.effectnode.push(d);var p=d.getComponent(s.default);l.readlySpineCall=function(){var e=c.default.instance.setTimeout(function(){o.stopAllActions(),l.loop=!1;var i=c.default.instance.setInterval(function(){t.ins.useSkill1(),c.default.instance.clearInterval(i)},t,650);l.completeCallbackThisObj=t,l.completeCallbackParam=[o],l.completeCallback=function(e){t.effectnode.slice(t.effectnode.indexOf(e),1),a.SpinePools.recoverSpineNoder(e),t.ins.complete(),t.clear()},c.default.instance.clearTimeout(e)},t,500)},l.readlySpineCallThisObj=this,l.initSpineData("spine/Artifact/Artifact3",null,"sq3-1",!0);p.readlySpineCall=function(){var e=c.default.instance.setTimeout(function(){d.stopAllActions(),p.loop=!1,p.completeCallbackThisObj=t,p.completeCallbackParam=[d],p.completeCallback=function(e){t.effectnode.slice(t.effectnode.indexOf(e),1),a.SpinePools.recoverSpineNoder(e)},c.default.instance.clearTimeout(e)},t,500)},p.readlySpineCallThisObj=this,p.initSpineData("spine/Artifact/Artifact3",null,"sq3-2",!0)},e.prototype.clear=function(){if(!(this.effectnode.length<=0)){this.effectnodeNum=0,this.ins.othereffect=!0;for(var e=0,t=this.effectnode;e<t.length;e++){var i=t[e];i.stopAllActions(),a.SpinePools.recoverSpineNoder(i)}this.effectbg&&a.SpinePools.recoverSpineNoder(this.effectbg),this.effectbg=null,this.effectnode=[]}},e.prototype.sortX=function(e,t){return e.prop.x-t.prop.x},e.prototype.showMosnter=function(){for(var e=0,t=this.ins.specialskillhitentitys;e<t.length;e++){var i=t[e];i.node.opacity=255,i.node.runAction(cc.moveTo(.2,i.prop.x,i.prop.y))}},e._instance=null,e}();i.default=d,cc._RF.pop()},{"../../../Core/SpineBase":"SpineBase","../../../Core/TimeController":"TimeController","../../../Global/GlobalValue":"GlobalValue","../Controller/FightController":"FightController","../Controller/SpecialSkillEffectController":"SpecialSkillEffectController","../Manager/SceneManager":"SceneManager","../Pool/SpinePools":"SpinePools"}],BigSkillArf4Controller:[function(e,t,i){"use strict";cc._RF.push(t,"88857uZPR1KbIShslD7LX8T","BigSkillArf4Controller"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Controller/SpecialSkillEffectController"),o=e("../Manager/SceneManager"),a=e("../Pool/SpinePools"),r=e("../Controller/FightController"),s=e("../../../Core/SpineBase"),l=e("../../../Global/GlobalValue"),c=e("../../../Core/TimeController"),d=function(){function e(){this.ins=null,this.effectnode=[],this.effectbg=null,this.effectnodeNum=0}return Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e,e.instance.init()),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.ins=n.default.instance},e.prototype.showSpecialEffect=function(){var e=this.ins.specialskillattackentitys[0];e.setloop(!1),e.playAnimation(l.ACTION.FIGHT1);c.default.instance.setTimeout(this.addFireEffect,this,200)},e.prototype.addFireEffect=function(){o.default.instance.rightlives;this.ins.specialskillhitentitys.sort(this.sortX);var e=Math.floor(this.ins.specialskillhitentitys.length/2),t=this.ins.specialskillhitentitys[e];this.addOneEffect(t)},e.prototype.addOneEffect=function(e){var t=this,i=e.prop.x,n=e.prop.y,o=a.SpinePools.addSpineNoder(r.default.instance.ActorsMaskLayer.node,cc.v2(i,n));this.effectnode.push(o);var l=o.getComponent(s.default),d=a.SpinePools.addSpineNoder(r.default.instance.ActorsMaskLayer.node,cc.v2(i,n));d.setSiblingIndex(1),this.effectnode.push(d);var p=d.getComponent(s.default);l.readlySpineCall=function(){var e=c.default.instance.setTimeout(function(){o.stopAllActions(),l.loop=!1,l.completeCallbackThisObj=t,l.completeCallbackParam=[o],l.completeCallback=function(e){t.effectnode.slice(t.effectnode.indexOf(e),1),a.SpinePools.recoverSpineNoder(e),t.ins.useSkill1(),t.ins.complete(),t.clear()},c.default.instance.clearTimeout(e)},t,500)},l.readlySpineCallThisObj=this,l.initSpineData("spine/Artifact/Artifact4",null,"sq4-1",!0);p.readlySpineCall=function(){var e=c.default.instance.setTimeout(function(){d.stopAllActions(),p.loop=!1,p.completeCallbackThisObj=t,p.completeCallbackParam=[d],p.completeCallback=function(e){t.effectnode.slice(t.effectnode.indexOf(e),1),a.SpinePools.recoverSpineNoder(e)},c.default.instance.clearTimeout(e)},t,500)},p.readlySpineCallThisObj=this,p.initSpineData("spine/Artifact/Artifact4",null,"sq4-2",!0)},e.prototype.clear=function(){if(!(this.effectnode.length<=0)){this.effectnodeNum=0,this.ins.othereffect=!0;for(var e=0,t=this.effectnode;e<t.length;e++){var i=t[e];i.stopAllActions(),a.SpinePools.recoverSpineNoder(i)}this.effectbg&&a.SpinePools.recoverSpineNoder(this.effectbg),this.effectbg=null,this.effectnode=[]}},e.prototype.sortX=function(e,t){return e.prop.x-t.prop.x},e.prototype.showMosnter=function(){for(var e=0,t=this.ins.specialskillhitentitys;e<t.length;e++){var i=t[e];i.node.opacity=255,i.node.runAction(cc.moveTo(.2,i.prop.x,i.prop.y))}},e._instance=null,e}();i.default=d,cc._RF.pop()},{"../../../Core/SpineBase":"SpineBase","../../../Core/TimeController":"TimeController","../../../Global/GlobalValue":"GlobalValue","../Controller/FightController":"FightController","../Controller/SpecialSkillEffectController":"SpecialSkillEffectController","../Manager/SceneManager":"SceneManager","../Pool/SpinePools":"SpinePools"}],BigSkillArf5Controller:[function(e,t,i){"use strict";cc._RF.push(t,"07c8c4+owFNUqc3achO64i+","BigSkillArf5Controller"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Controller/SpecialSkillEffectController"),o=e("../Manager/SceneManager"),a=e("../Pool/SpinePools"),r=e("../Controller/FightController"),s=e("../../../Core/SpineBase"),l=e("../../../Global/GlobalValue"),c=e("../../../Core/TimeController"),d=function(){function e(){this.ins=null,this.effectnode=[],this.effectbg=null,this.effectnodeNum=0}return Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e,e.instance.init()),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.ins=n.default.instance},e.prototype.showSpecialEffect=function(){var e=this.ins.specialskillattackentitys[0];e.setloop(!1),e.playAnimation(l.ACTION.FIGHT1);c.default.instance.setTimeout(this.addFireEffect,this,200)},e.prototype.addFireEffect=function(){o.default.instance.rightlives;this.ins.specialskillhitentitys.sort(this.sortX);var e=this.ins.specialskillhitentitys[0];this.addOneEffect(e)},e.prototype.addOneEffect=function(e){var t=this,i=e.prop.x,n=e.prop.y,o=a.SpinePools.addSpineNoder(r.default.instance.ActorsMaskLayer.node,cc.v2(i,n));this.effectnode.push(o);var l=o.getComponent(s.default),d=a.SpinePools.addSpineNoder(r.default.instance.ActorsMaskLayer.node,cc.v2(i,n));d.setSiblingIndex(1),this.effectnode.push(d);var p=d.getComponent(s.default);l.readlySpineCall=function(){var e=c.default.instance.setTimeout(function(){o.stopAllActions(),l.loop=!1;var i=c.default.instance.setInterval(function(){t.ins.useSkill1(),c.default.instance.clearInterval(i)},t,850);l.completeCallbackThisObj=t,l.completeCallbackParam=[o],l.completeCallback=function(e){t.effectnode.slice(t.effectnode.indexOf(e),1),a.SpinePools.recoverSpineNoder(e),t.ins.complete(),t.clear()},c.default.instance.clearTimeout(e)},t,500)},l.readlySpineCallThisObj=this,l.initSpineData("spine/Artifact/Artifact5",null,"sq5-1",!0);p.readlySpineCall=function(){var e=c.default.instance.setTimeout(function(){d.stopAllActions(),p.loop=!1,p.completeCallbackThisObj=t,p.completeCallbackParam=[d],p.completeCallback=function(e){t.effectnode.slice(t.effectnode.indexOf(e),1),a.SpinePools.recoverSpineNoder(e)},c.default.instance.clearTimeout(e)},t,100)},p.readlySpineCallThisObj=this,p.initSpineData("spine/Artifact/Artifact5",null,"sq5-2",!0)},e.prototype.clear=function(){if(!(this.effectnode.length<=0)){this.effectnodeNum=0,this.ins.othereffect=!0;for(var e=0,t=this.effectnode;e<t.length;e++){var i=t[e];i.stopAllActions(),a.SpinePools.recoverSpineNoder(i)}this.effectbg&&a.SpinePools.recoverSpineNoder(this.effectbg),this.effectbg=null,this.effectnode=[]}},e.prototype.sortX=function(e,t){return e.prop.x-t.prop.x},e.prototype.showMosnter=function(){for(var e=0,t=this.ins.specialskillhitentitys;e<t.length;e++){var i=t[e];i.node.opacity=255,i.node.runAction(cc.moveTo(.2,i.prop.x,i.prop.y))}},e._instance=null,e}();i.default=d,cc._RF.pop()},{"../../../Core/SpineBase":"SpineBase","../../../Core/TimeController":"TimeController","../../../Global/GlobalValue":"GlobalValue","../Controller/FightController":"FightController","../Controller/SpecialSkillEffectController":"SpecialSkillEffectController","../Manager/SceneManager":"SceneManager","../Pool/SpinePools":"SpinePools"}],BigSkillArfController:[function(e,t,i){"use strict";cc._RF.push(t,"147c6Vyf81JTYnAVBu9rA8i","BigSkillArfController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Controller/SpecialSkillEffectController"),o=e("../Manager/SceneManager"),a=e("../Pool/SpinePools"),r=e("../Controller/FightController"),s=e("../../../Core/SpineBase"),l=e("../../../Global/GlobalValue"),c=e("../../../Core/TimeController"),d=function(){function e(){this.ins=null,this.effectnode=[],this.effectbg=null,this.effectnodeNum=0}return Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e,e.instance.init()),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.ins=n.default.instance},e.prototype.showSpecialEffect=function(){var e=this.ins.specialskillattackentitys[0];e.setloop(!1),e.playAnimation(l.ACTION.FIGHT1);c.default.instance.setTimeout(this.addFireEffect,this,200)},e.prototype.addFireEffect=function(){o.default.instance.rightlives;this.ins.specialskillhitentitys.sort(this.sortX);var e=Math.floor(this.ins.specialskillhitentitys.length/2),t=this.ins.specialskillhitentitys[e];this.addOneEffect(t)},e.prototype.addOneEffect=function(e){var t=this,i=e.prop.x,n=e.prop.y,o=a.SpinePools.addSpineNoder(r.default.instance.ActorsMaskLayer.node,cc.v2(i,n));this.effectnode.push(o);var l=o.getComponent(s.default),d=a.SpinePools.addSpineNoder(r.default.instance.ActorsMaskLayer.node,cc.v2(i,n));d.setSiblingIndex(1),this.effectnode.push(d);var p=d.getComponent(s.default);l.readlySpineCall=function(){var e=c.default.instance.setTimeout(function(){o.stopAllActions(),l.loop=!1;var i=c.default.instance.setInterval(function(){t.ins.useSkill1(),c.default.instance.clearInterval(i)},t,250);l.completeCallbackThisObj=t,l.completeCallbackParam=[o],l.completeCallback=function(e){t.effectnode.slice(t.effectnode.indexOf(e),1),a.SpinePools.recoverSpineNoder(e),t.ins.complete(),t.clear()},c.default.instance.clearTimeout(e)},t,500)},l.readlySpineCallThisObj=this,l.initSpineData("spine/Artifact/Artifact1",null,"sq1-1",!0);p.readlySpineCall=function(){var e=c.default.instance.setTimeout(function(){d.stopAllActions(),p.loop=!1,p.completeCallbackThisObj=t,p.completeCallbackParam=[d],p.completeCallback=function(e){t.effectnode.slice(t.effectnode.indexOf(e),1),a.SpinePools.recoverSpineNoder(e)},c.default.instance.clearTimeout(e)},t,500)},p.readlySpineCallThisObj=this,p.initSpineData("spine/Artifact/Artifact1",null,"sq1-2",!0)},e.prototype.clear=function(){if(!(this.effectnode.length<=0)){this.effectnodeNum=0,this.ins.othereffect=!0;for(var e=0,t=this.effectnode;e<t.length;e++){var i=t[e];i.stopAllActions(),a.SpinePools.recoverSpineNoder(i)}this.effectbg&&a.SpinePools.recoverSpineNoder(this.effectbg),this.effectbg=null,this.effectnode=[]}},e.prototype.sortX=function(e,t){return e.prop.x-t.prop.x},e.prototype.showMosnter=function(){for(var e=0,t=this.ins.specialskillhitentitys;e<t.length;e++){var i=t[e];i.node.opacity=255,i.node.runAction(cc.moveTo(.2,i.prop.x,i.prop.y))}},e._instance=null,e}();i.default=d,cc._RF.pop()},{"../../../Core/SpineBase":"SpineBase","../../../Core/TimeController":"TimeController","../../../Global/GlobalValue":"GlobalValue","../Controller/FightController":"FightController","../Controller/SpecialSkillEffectController":"SpecialSkillEffectController","../Manager/SceneManager":"SceneManager","../Pool/SpinePools":"SpinePools"}],BigSkillIcon:[function(e,t,i){"use strict";cc._RF.push(t,"5c2a6/kYcZBrI5l4pqxMwT7","BigSkillIcon"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../Commons/CommonProgress"),a=e("../Scene/Manager/SceneManager"),r=e("../Scene/Controller/SkillController"),s=e("../WarTeam/MonsterController"),l=e("../../Global/GlobalValue"),c=e("../Status/StatusType"),d=e("../Scene/Controller/GuideFightController"),p=e("../Tips/OpTipsController"),h=e("../../Core/Language"),u=e("../Guide/GuideNewController"),f=e("../../Core/CommonsResManager"),g=e("../Scene/View/ActorsBigSkillLayer"),y=e("../../Core/ConfigsManager"),m=e("../Commons/Image"),C=e("../../Core/SimpleActionEffect"),v=e("../../Core/WindowType"),_=e("../../Util/Utils"),b=e("../Commons/MonsterPreview"),T=e("../../GlobalContext"),S=e("../Fight/fightlogic"),I=cc._decorator,w=I.ccclass,D=I.property,R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bg=null,t.model=null,t.skill=null,t.grade=null,t.gradeLb=null,t.carNameLb=null,t.precentLb=null,t.monsterSprite=null,t.monsterSpriteBG=null,t.barNode=null,t.skillEffect=null,t.source=null,t.skillId=null,t.skilllv=null,t.handle=null,t}return __extends(t,e),t.prototype.onload=function(){e.prototype.onLoad.call(this)},t.prototype.show=function(){e.prototype.show.call(this),this.clickSkillEffect()},t.prototype.hide=function(){e.prototype.hide.call(this),this.handle=null,this.model.childrenCount&&(this.model.getComponentInChildren(b.default).clear(),_.default.setNodeToPool(v.PoolType.MonsterPreview,this.model.children[0]))},t.prototype.onclick=function(){if(u.default.instance.guideCanClick&&a.default.instance.specialskillstatus==l.SPECIAL_SKILL_STATUS.NONE&&this.source&&this.source.isLive)if(c.ActivityStatus.value==c.ActivityStatus.Guide)d.default.instance.guideskill>-1&&d.default.instance.guideskill==this.skillId&&(this.source.useSkill(this.skillId,this.skilllv,!0),d.default.instance.reover(),d.default.instance.checkStep(),g.default.instance.updateBigInfo());else if(a.default.instance.specialskillstatus==l.SPECIAL_SKILL_STATUS.NONE){if(!this.source.isLive)return void p.default.instance.ShowMsg(h.default.getStr("bigskilltip4"));if(0!=(this.source.prop.status&S.StateBit.Dizzy))return void p.default.instance.ShowMsg(h.default.getStr("bigskilltip3"));this.source.setTarget(a.default.instance.seekTarget(this.source,this.skillId,this.skilllv));var e=r.default.instance.getSkillBySkillId(this.skillId);if(this.source.atkTarget.length<=0&&e.attackTarget!=l.ATTACK_TARGE.DRIFTLESS)return r.default.instance.getSkillBySkillId(this.skillId).attackway==l.ATTACK_TYPE.ATTACK_TYPE_3?void p.default.instance.ShowMsg(h.default.getStr("bigskilltip2")):void p.default.instance.ShowMsg(h.default.getStr("bigskilltip1"));if(a.default.instance.fightlogic.getFightEntityByHandle(this.source.prop.handle).attr.buff.IsHasBuffByType(l.BuffType.Silence))return void p.default.instance.ShowMsg(h.default.getStr("bigskilltip3"));this.source.useSkill(this.skillId,this.skilllv,!0),g.default.instance.updateBigInfo()}},t.prototype.setModel=function(e){if(!this.model.childrenCount){var t=_.default.getNodeByPool(v.PoolType.MonsterPreview,s.default.instance.MonsterPreview);this.model.addChild(t)}var i=this.source.prop.grade;this.bg.updateBg("resources/Card/di_"+i+".png"),this.model.getComponentInChildren(b.default).init("monster",e,i,l.DEFAULTS_SKIN+i,l.PRIORITY.MONSTER)},t.prototype.setData=function(e,t,i){var n=this;this.handle!=e.prop.handle&&function(e,t,i){console.log("mondel==",n.source,e),n.handle=e.prop.handle,n.source=e,n.skillId=t,n.skilllv=i,n.node.active=!0,n.carNameLb.string=n.source.prop.originalName,n.gradeLb.string=h.default.getStr("grade_"+n.source.prop.grade),n.grade.spriteFrame=f.default.instance.getSpriteFrameByName("form_"+n.source.prop.grade),s.default.instance.setSkillPic(t,n.skill);var o=e.prop.cardid;n.setModel(o);var a=y.ConfigsManager.instance.getConfigs("cardConf").Card[o].pieceId,r=y.ConfigsManager.instance.getConfigs("Itemconf").ItemConf[a];n.monsterSpriteBG.spriteFrame=f.default.instance.getSpriteFrameByName("bag"+r.ItemColor);var l=n.monsterSprite;n.headIcon(l,r)}(e,t,i),this.updateHp()},t.prototype.updateHp=function(){this.handle&&this.source&&(this.barNode.getComponent(o.default).value=this.source.hp/this.source.prop.maxHP,this.precentLb.string=(this.source.hp/this.source.prop.maxHP*100).toFixed(0)+"%")},t.prototype.headIcon=function(e,t){var i=T.GlobalContext.ResRoot+"resources/itemicon/"+t.ItemIcon+".png";_.default.setImage(e,i)},t.prototype.recovery=function(){this.source=null,this.skillId=0,this.skilllv=0,this.node.removeFromParent(!1)},t.prototype.clickSkillEffect=function(){this.skillEffect.getComponent(C.default).playById(6,"skillEffect",!0,null,this)},__decorate([D(m.default)],t.prototype,"bg",void 0),__decorate([D(cc.Node)],t.prototype,"model",void 0),__decorate([D(cc.Sprite)],t.prototype,"skill",void 0),__decorate([D(cc.Sprite)],t.prototype,"grade",void 0),__decorate([D(cc.Label)],t.prototype,"gradeLb",void 0),__decorate([D(cc.Label)],t.prototype,"carNameLb",void 0),__decorate([D(cc.Label)],t.prototype,"precentLb",void 0),__decorate([D(cc.Node)],t.prototype,"monsterSprite",void 0),__decorate([D(cc.Sprite)],t.prototype,"monsterSpriteBG",void 0),__decorate([D(cc.Node)],t.prototype,"barNode",void 0),__decorate([D(cc.Node)],t.prototype,"skillEffect",void 0),t=__decorate([w],t)}(n.default);i.default=R,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/ConfigsManager":"ConfigsManager","../../Core/Language":"Language","../../Core/SimpleActionEffect":"SimpleActionEffect","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/CommonProgress":"CommonProgress","../Commons/Image":"Image","../Commons/MonsterPreview":"MonsterPreview","../Fight/fightlogic":"fightlogic","../Guide/GuideNewController":"GuideNewController","../Scene/Controller/GuideFightController":"GuideFightController","../Scene/Controller/SkillController":"SkillController","../Scene/Manager/SceneManager":"SceneManager","../Scene/View/ActorsBigSkillLayer":"ActorsBigSkillLayer","../Status/StatusType":"StatusType","../Tips/OpTipsController":"OpTipsController","../WarTeam/MonsterController":"MonsterController"}],BilibiliSDK:[function(e,t,i){"use strict";cc._RF.push(t,"7b32dlufFZCVoJxKMQczuo0","BilibiliSDK"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Role/RoleInfo"),o=e("../Tips/OpTipsController"),a=e("../Login/LoginController"),r=e("../../Util/SDKUtils"),s=e("../../Core/ConfigsManager"),l=e("../../Core/Language"),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.server_id="3531",t.server_name="bilibili\u533a",t.app_id="4390",t.merchant_id="1122",t.app_key="189abe244cd04fccb5ad7fcf55bfb6f0",t}return __extends(t,e),t.prototype.getGameData=function(){1==cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID?r.default.instance.callStaticMethod("getGameData","()V"):window.tdGame_jsbFun("getGameData",null)},t.prototype.login=function(){e.prototype.login.call(this);r.default.instance.callStaticMethod("sendMsgToPhone","(Ljava/lang/String;)V",JSON.stringify({func_name:"login"}))},t.prototype.loginBack=function(t){this.uid="",this.openId="",this.userInfo.nickname="",this.username="",t&&(console.log("\u8bbe\u7f6eopenid",t,t.uid,t.nickname,t.username,this.openId),this.uid=t.uid,this.openId=this.app_id+t.uid,this.userInfo.nickname=n.MyRoleInfo.name,this.username=t.username,this.access_token=t.access_token),e.prototype.loginBack.call(this,t)},t.prototype.pay=function(t,i,a,c){var d=this;void 0===i&&(i=null),void 0===a&&(a=null),void 0===c&&(c=null);var p=r.default.instance.BackstageUrl+"/"+r.default.instance.plat_id+"-"+r.default.instance.ditch_id+"/payment/orderid?uid="+this.uid+"&extension_info="+n.MyRoleInfo.id+"|"+n.MyRoleInfo.serverid+"|"+t;r.default.instance.sendToHttps(p,function(p){if(p&&p.orderid){e.prototype.pay.call(d,t,i,a,c);var h=s.ConfigsManager.instance.getConfigs("rechargeconf").RechargeConf,u=h[t].diamondVal,f=100*h[t].price,g=p.orderid,y=h[t].name,m=h[t].name,C=n.MyRoleInfo.id+"|"+n.MyRoleInfo.serverid+"|"+t,v=r.default.instance.BackstageUrl+"/"+r.default.instance.plat_id+"-"+r.default.instance.ditch_id+"/payment/index",_=p.sign,b={func_name:"pay",uid:d.uid,username:d.username,role:n.MyRoleInfo.name,serverId:d.server_id,total_fee:f,game_money:u,out_trade_no:g,subject:y,body:m,extension_info:C,notify_url:v,order_sign:_};r.default.instance.callStaticMethod("sendMsgToPhone","(Ljava/lang/String;)V",JSON.stringify(b))}else o.default.instance.ShowMsg(l.default.getStr("pay"))},this)},t.prototype.createRole=function(){e.prototype.createRole.call(this);var t={func_name:"createRole",role:n.MyRoleInfo.name,role_id:n.MyRoleInfo.id};r.default.instance.callStaticMethod("sendMsgToPhone","(Ljava/lang/String;)V",JSON.stringify(t))},t.prototype.notifyroleInfo=function(){e.prototype.notifyroleInfo.call(this);var t={func_name:"notifyZone",server_id:this.server_id,server_name:this.server_name,role_id:n.MyRoleInfo.id,role_name:n.MyRoleInfo.name};r.default.instance.callStaticMethod("sendMsgToPhone","(Ljava/lang/String;)V",JSON.stringify(t))},t.prototype.exit=function(){e.prototype.exit.call(this),r.default.instance.callStaticMethod("sendMsgToPhone","(Ljava/lang/String;)V",JSON.stringify({func_name:"sdkExit"}))},t.prototype.onAccountInvalid=function(){e.prototype.onAccountInvalid.call(this)},t.prototype.logout=function(){a.default.instance.resetGame(),r.default.instance.callStaticMethod("sendMsgToPhone","(Ljava/lang/String;)V",JSON.stringify({func_name:"logout"})),e.prototype.logout.call(this)},t}(e("./GameBaseSDK").GameBaseSDK);i.default=c,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Language":"Language","../../Util/SDKUtils":"SDKUtils","../Login/LoginController":"LoginController","../Role/RoleInfo":"RoleInfo","../Tips/OpTipsController":"OpTipsController","./GameBaseSDK":"GameBaseSDK"}],BitmapObj:[function(e,t,i){"use strict";cc._RF.push(t,"ca6fc9rcHxHGZpB8ed6gwfZ","BitmapObj"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../LayerableCompent"),o=e("../../../Core/LoadManager"),a=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.initByTexture=function(e){this.image?this.image.getComponent(cc.Sprite).spriteFrame=e:(this.image=new cc.Node,this.image.addComponent(cc.Sprite),this.image.getComponent(cc.Sprite).spriteFrame=e,this.node.addChild(this.image)),this.image.anchorX=this.image.width>>1,this.image.anchorY=this.image.height},t.prototype.initByUrl=function(e,t){o.default.instance.loadResByType(e,cc.SpriteFrame,this.endFunPng,this,[e])},t.prototype.endFunPng=function(e,t){this.initByTexture(e)},t.prototype.clear=function(){},t}(n.default);i.BitmapObj=a,cc._RF.pop()},{"../../../Core/LoadManager":"LoadManager","../LayerableCompent":"LayerableCompent"}],BossBigSkillProgBar:[function(e,t,i){"use strict";cc._RF.push(t,"8c735iQIe9JA6qWDI7uHRY3","BossBigSkillProgBar"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/GameEventDispatcher"),a=e("../Scene/Controller/ServerFightController"),r=cc._decorator,s=r.ccclass,l=r.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.progressBar=null,t.bossHead=null,t.layout=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),o.GameEventDispatcher.instance.on("setProgressBar",this.setProgressBar,this),this.layout.getChildByName("attackLabe").getComponent(cc.Label).string=a.default.instance.bossAttack+"",this.layout.getChildByName("defenseLabe").getComponent(cc.Label).string=a.default.instance.bossDefence+""},t.prototype.hide=function(){e.prototype.hide.call(this),o.GameEventDispatcher.instance.off("setProgressBar",this.setProgressBar,this)},t.prototype.setProgressBar=function(e){this.progressBar.progress=(e.detail.max-e.detail.curr)/e.detail.max;var t=(e.detail.max-e.detail.curr)/e.detail.max*100;this.node.getChildByName("Label").getComponent(cc.Label).string=Math.floor(t)+"%"},__decorate([l(cc.ProgressBar)],t.prototype,"progressBar",void 0),__decorate([l(cc.Sprite)],t.prototype,"bossHead",void 0),__decorate([l(cc.Node)],t.prototype,"layout",void 0),t=__decorate([s],t)}(n.default);i.default=c,cc._RF.pop()},{"../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Widget":"Widget","../Scene/Controller/ServerFightController":"ServerFightController"}],BossComming:[function(e,t,i){"use strict";cc._RF.push(t,"50eb5OficVAeoKr5TfZItxs","BossComming"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../../Core/LoadManager"),a=e("../../Util/Utils"),r=e("../../GlobalContext"),s=e("../Commons/MonsterPreview"),l=e("../../Core/WindowType"),c=e("../WarTeam/MonsterController"),d=e("../Scene/Controller/SkillController"),p=e("../../Core/ConfigsManager"),h=e("../../Core/CommonsResManager"),u=e("../../Core/TimeController"),f=e("../Sound/SoundController"),g=e("../Guide/GuideNewController"),y=e("../SandTable/SandTableMain"),m=e("../SandTable/SandTableController"),C=cc._decorator,v=C.ccclass,_=C.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.BossInfo=null,t.AnimNode=null,t.MonsterNode=null,t.SkillContent=null,t.spineNode=null,t.CardConf=null,t.SkillConf=null,t.sandtableAuto=!1,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this,this.CardConf=p.ConfigsManager.instance.getConfigs("cardConf"),this.SkillConf=p.ConfigsManager.instance.getConfigs("skillconf"),this.spineNode.setCompleteListener(this.effectEnd)},t.prototype.show=function(){e.prototype.show.call(this),f.default.instance.PlayEffect(f.SoundType.bossComming),this.sandtableAuto=m.default.instance.automatic,m.default.instance.automatic=!1,g.default.instance.pause()},t.prototype.hide=function(){e.prototype.hide.call(this),f.default.instance.StopEffectByType(f.SoundType.bossComming),y.default.instance.setAutomatic(this.sandtableAuto?1:2),g.default.instance.resume()},t.prototype.Info=function(e){var t=this,i=[];this.SkillContent.x=r.GlobalContext.UIWidth/2-this.SkillContent.width-100,a.default.setNodeChildDestoryByUrl(this.MonsterNode,r.GlobalContext.Root+"effects/prefabs/CardSynthesis/hecheng03"),this.BossInfo.getChildByName("pos").getComponent(cc.Sprite).spriteFrame=h.default.instance.getSpriteFrameByName("stance_"+this.CardConf.Card[e.cardId].cardType),this.BossInfo.getChildByName("NameLabe").getComponent(cc.Label).string=this.CardConf.Card[e.cardId].cardFamilyName,this.BossInfo.getChildByName("raity").getComponent(cc.Sprite).spriteFrame=h.default.instance.getSpriteFrameByName("rarity_"+this.CardConf.Card[e.cardId].rarity);for(var n=this.MonsterNode.childrenCount-1;n>0;n++){this.MonsterNode.children[n].getComponent(s.default).clear(),a.default.setNodeToPool(l.PoolType.MonsterPreview,this.MonsterNode.children[n])}c.default.instance.infoPreview(this.MonsterNode,cc.v2(0,0),e.cardId,e.grade,1,-1);var p=d.default.instance.getSmallSkillList(e.cardId,e.grade),u=d.default.instance.getBigSkillList(e.cardId,e.grade);o.default.instance.loadResByType(r.GlobalContext.Root+"prefab/Chapter/skillItem",cc.Prefab,function(e){for(var n=103,o=0;o<p.length;o++)i.push(p[o]);for(o=0;o<u.length;o++)i.push(u[o]);for(var o in i){var s=a.default.getNodeByUrl(e,r.GlobalContext.Root+"prefab/Chapter/skillItem"),l=s.getChildByName("skill_btn");c.default.instance.setSkillPic(i[o].skillid,s.getChildByName("skill_btn").getChildByName("sp").getChildByName("pic").getComponent(cc.Sprite));var d=30;3==Number(o)&&(d=2),l.getChildByName("SkillLevel").getComponent(cc.Label).string="\u6280\u80fd\u7b49\u7ea7\uff1a"+d,l.getChildByName("NameLabe").getComponent(cc.Label).string=t.SkillConf.skillconf[i[o].skillid].name,s.x=n,n-=20,t.SkillContent.addChild(s)}},this)},t.prototype.effectEnd=function(){i.instance.spineNode.clearTracks(),i.instance.spineNode.setAnimation(0,"animation2",!0)},t.prototype.closeNode=function(){var e=this;this.node.active=!1;var t=u.default.instance.setTimeout(function(){a.default.setNodeDestoryByUrl(e.node,r.GlobalContext.Root+"prefab/Chapter/BossComming"),u.default.instance.clearTimeout(t)},this,5e3)},t.instance=null,__decorate([_(cc.Node)],t.prototype,"BossInfo",void 0),__decorate([_(cc.Node)],t.prototype,"AnimNode",void 0),__decorate([_(cc.Node)],t.prototype,"MonsterNode",void 0),__decorate([_(cc.Node)],t.prototype,"SkillContent",void 0),__decorate([_(sp.Skeleton)],t.prototype,"spineNode",void 0),t=i=__decorate([v],t)}(n.default);i.default=b,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/ConfigsManager":"ConfigsManager","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/Window":"Window","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/MonsterPreview":"MonsterPreview","../Guide/GuideNewController":"GuideNewController","../SandTable/SandTableController":"SandTableController","../SandTable/SandTableMain":"SandTableMain","../Scene/Controller/SkillController":"SkillController","../Sound/SoundController":"SoundController","../WarTeam/MonsterController":"MonsterController"}],BoxTips:[function(e,t,i){"use strict";cc._RF.push(t,"8559cYI9nZJfqZ+soV7Q6lR","BoxTips"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/WindowType"),o=e("../../Core/WindowManager"),a=e("../../Core/Widget"),r=e("../../Core/TimeController"),s=e("../../GlobalContext"),l=e("../../Util/Utils"),c=cc._decorator,d=c.ccclass,p=(c.property,function(e){function t(){var t=e.call(this)||this;return t._saveBoxId=[],t._savePos=[],i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.onClose=function(){o.default.instance.close(n.WindowType.BoxTips)},t.prototype.onInitBox=function(e,t){void 0===e&&(e=[]),void 0===t&&(t=null),e.length>0&&t&&(this._saveBoxId.push(e),this._savePos.push(t)),this.onShowEffect()},t.prototype.onShowEffect=function(){var e=this;if(this._saveBoxId.length>0&&this._savePos.length>0)for(var t=this._saveBoxId.shift(),i=this._savePos.shift(),n=function(n){var a=new cc.Node,c=s.GlobalContext.ResRoot+"resources/itemicon/ItemIcon_box"+t[n]+".png";l.default.setImage(a,c),o.node.addChild(a),a.opacity=1,a.name="name"+n,r.default.instance.setTimeout(function(){e.onShowBoxEffect(a,n,i)},o,300*n)},o=this,a=0;a<t.length;a++)n(a);else this.onClose()},t.prototype.finished=function(e){e&&e.parent&&e.parent.removeChild(e),this.node.childrenCount<1&&this.onShowEffect()},t.prototype.onShowBoxEffect=function(e,t,i){e.runAction(cc.sequence(cc.spawn(cc.scaleTo(.2,2.5),cc.fadeTo(.2,200)),cc.spawn(cc.scaleTo(.1,2),cc.fadeTo(.1,255)),cc.spawn(cc.moveTo(.8,i),cc.fadeTo(.8,60),cc.scaleTo(.8,.5)),cc.callFunc(function(e){this.finished(e)},this)))},t.instance=null,t=i=__decorate([d],t)}(a.default));i.default=p,cc._RF.pop()},{"../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils"}],BuffCell:[function(e,t,i){"use strict";cc._RF.push(t,"05139X7/jNN+KDnjlWH6dvJ","BuffCell"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/WindowType"),a=e("../../Util/Utils"),r=cc._decorator,s=r.ccclass,l=r.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buffsp=null,t.conduceSp=null,t.spatlas=null,t.spriteIndex=0,t.strindex="",t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.setData=function(e,t){this.spriteIndex=e,this.strindex=e+"_"+t,this.buffsp.spriteFrame=this.spatlas.getSpriteFrame(e+""),this.conduceSp.spriteFrame=null},t.prototype.recovery=function(){this.spriteIndex=0,this.strindex="",a.default.setNodeToPool(o.PoolType.BuffCell,this.node)},__decorate([l(cc.Sprite)],t.prototype,"buffsp",void 0),__decorate([l(cc.Sprite)],t.prototype,"conduceSp",void 0),__decorate([l(cc.SpriteAtlas)],t.prototype,"spatlas",void 0),t=__decorate([s],t)}(n.default);i.default=c,cc._RF.pop()},{"../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../Util/Utils":"Utils"}],BuffController:[function(e,t,i){"use strict";cc._RF.push(t,"7626767IUhDvp1a+7PEoNCk","BuffController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Scene/Effect/MonsterIndividualityUtils"),o=e("../../Global/GlobalValue"),a=e("../Scene/Effect/BuffTypeEffectUtils"),r=e("../../Util/Utils"),s=e("../../Core/WindowType"),l=e("./BuffCell"),c=e("../Scene/View/ActorsLayer"),d=e("../../Core/LoadManager"),p=e("../../GlobalContext"),h=e("../Scene/Unit/FightLog"),u=e("../../Core/ConfigsManager"),f=cc._decorator,g=f.ccclass,y=(f.property,function(){function e(){this._configs=null,this._buffcell=null,this.entityHandles=null,this._init=!1,this._initwait=[],this.buffdic={}}var t;return t=e,Object.defineProperty(e,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),e.prototype.getBuffById=function(e){var t=u.ConfigsManager.instance.getConfigs("buffconf").BuffConf[e];return t||h.default.log("\u83b7\u53d6buff\u8868\u9519\u8bef id: "+e),t},e.prototype.loadComplete=function(e){this._init=!0,this._buffcell=e;for(var t=0,i=this._initwait;t<i.length;t++){var n=i[t];this.addBuff(n.entity,n.buffid)}this._initwait=[]},e.prototype.addBuff=function(e,t){if(this._init){var i=this.getBuffById(t);if(i&&e.isLive){if(e.prop.otherAttr==o.OtherAttr.ExtraCombohurt&&i.type==o.BuffType.SuperArmor)return;if(a.default.instance.addBuffTip(t,e),i.type==o.BuffType.MoveSpeed&&(e.prop.moveSpeed*=i.param),i.effectname&&a.default.instance.addOneEffect(e,i.effectname),i.spriteIndex)if(this.buffdic[e.prop.handle]||(this.buffdic[e.prop.handle]={}),this.buffdic[e.prop.handle][i.spriteIndex+"_"+i.conduce])this.buffdic[e.prop.handle][i.spriteIndex+"_"+i.conduce].count++;else if(this.buffdic[e.prop.handle][i.spriteIndex+"_"+i.conduce]={conduce:i.conduce,count:1},e.buffbox.childrenCount<4){var c=r.default.getNodeByPool(s.PoolType.BuffCell,this._buffcell);c.getComponent(l.default).setData(i.spriteIndex,i.conduce),h.default.log("\u6dfb\u52a0buff\uff1abuff "+t+"buff.spriteIndex"+i.spriteIndex,this.buffdic),e.addBuff(c)}n.default.instance.checkIndividualityType(o.INDIVIDUALITY.TYPE2,e,i.type)}}else{d.default.instance.loadResByType(p.GlobalContext.Root+"prefab/bufftype/BuffCell",cc.Prefab,this.loadComplete,this);var u={entity:e,buffid:t};this._initwait.push(u)}},e.prototype.removeBuff=function(e,t){var i=this.getBuffById(t);i&&(i.type==o.BuffType.MoveSpeed&&(e.prop.moveSpeed=e.prop.moveSpeed/i.param),i.effectname&&a.default.instance.recovery(e.prop.handle,i.effectname),this.buffdic[e.prop.handle]&&this.buffdic[e.prop.handle][i.spriteIndex+"_"+i.conduce]&&(this.buffdic[e.prop.handle][i.spriteIndex+"_"+i.conduce].count--,this.buffdic[e.prop.handle][i.spriteIndex+"_"+i.conduce].count<=0&&(delete this.buffdic[e.prop.handle][i.spriteIndex+"_"+i.conduce],e.removeBuff(i.spriteIndex+"_"+i.conduce),this.updateBuffCellShhow(e))))},e.prototype.updateBuffCellShhow=function(e){var t=e.prop.handle;for(var i in this.buffdic[t]){if(e.buffbox.childrenCount>=4)return;for(var n=!0,o=0;o<e.buffbox.childrenCount;o++){e.buffbox.children[o].getComponent(l.default).strindex==i&&(n=!1)}if(n){var a=r.default.getNodeByPool(s.PoolType.BuffCell,this._buffcell);a.getComponent(l.default).setData(parseInt(i),this.buffdic[t][i].conduce),e.addBuff(a)}}},e.prototype.clearEntityAllBuff=function(e){for(var t=e.buffbox.childrenCount,i=0;i<t;i++){e.buffbox.children[0].getComponent(l.default).recovery()}delete this.buffdic[e.prop.handle]},e.prototype.clearAllBuff=function(){for(var e in this.buffdic){var t=c.default.instance.getSceneEntity(parseInt(e));this.clearEntityAllBuff(t)}a.default.instance.recoveryAll()},e=t=__decorate([g],e)}());i.default=y,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/LoadManager":"LoadManager","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Scene/Effect/BuffTypeEffectUtils":"BuffTypeEffectUtils","../Scene/Effect/MonsterIndividualityUtils":"MonsterIndividualityUtils","../Scene/Unit/FightLog":"FightLog","../Scene/View/ActorsLayer":"ActorsLayer","./BuffCell":"BuffCell"}],BuffIcon:[function(e,t,i){"use strict";cc._RF.push(t,"cbe1dRG3GBJMZdFbIRESvk8","BuffIcon"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("./BuffController"),a=e("../../GlobalContext"),r=e("../../Util/Utils"),s=cc._decorator,l=s.ccclass,c=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.spriteBuff=null,t}return __extends(t,e),t.prototype.onInitData=function(e){var t=o.default.instance.getBuffById(e);if(t){var i=a.GlobalContext.ResRoot+"resources/itemicon/"+t.buffIcon+".png";r.default.setImage(this.spriteBuff,i)}},__decorate([c(cc.Node)],t.prototype,"spriteBuff",void 0),t=__decorate([l],t)}(n.default);i.default=d,cc._RF.pop()},{"../../Core/Widget":"Widget","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","./BuffController":"BuffController"}],BuffTipHurt:[function(e,t,i){"use strict";cc._RF.push(t,"40f91jHtMhOGLPHp6Q7nz4v","BuffTipHurt"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../Buff/BuffController"),a=cc._decorator,r=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.conduce=null,t.txytSprite=null,t.spatlas=null,t}return __extends(t,e),t.prototype.setData=function(e){var t=o.default.instance.getBuffById(e);if(t&&t.bufftip)if(this.node.active=!0,this.conduce.node.active=!0,this.txytSprite.spriteFrame=this.spatlas.getSpriteFrame("i18n_bufftxt"+t.bufftip),"undefined"!==t.arrow){var i=t.arrow?"up":"down";this.conduce.spriteFrame=this.spatlas.getSpriteFrame(i)}else this.conduce.spriteFrame=null},t.prototype.setOther=function(e){this.conduce.node.active=!1,this.txytSprite.spriteFrame=this.spatlas.getSpriteFrame(e)},__decorate([s(cc.Sprite)],t.prototype,"conduce",void 0),__decorate([s(cc.Sprite)],t.prototype,"txytSprite",void 0),__decorate([s(cc.SpriteAtlas)],t.prototype,"spatlas",void 0),t=__decorate([r],t)}(n.default);i.default=l,cc._RF.pop()},{"../../../Core/Widget":"Widget","../../Buff/BuffController":"BuffController"}],BuffTypeEffectUtils:[function(e,t,i){"use strict";cc._RF.push(t,"b3cd8PtTuNKiYGrNHXwhQom","BuffTypeEffectUtils"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../GlobalContext"),o=e("../../../Core/LoadManager"),a=e("../View/ActorsLayer"),r=e("../Controller/SceneController"),s=e("../../../Util/Utils"),l=e("../Pool/SpinePools"),c=e("../../../Core/SpineBase"),d=e("../Manager/SceneManager"),p=e("../../../Global/GlobalValue"),h=e("../Controller/FightTimeController"),u=e("../Unit/FightLog"),f=e("../../../Core/TimeController"),g=e("./BuffTipHurt"),y=e("../View/ActorsMaskLayer");i.BUFF_EFFEC_TYPE1=[p.BuffEffectName.JIAGONGJILI,p.BuffEffectName.JIAFANG,p.BuffEffectName.JIANGONG,p.BuffEffectName.JIANFANG],i.BUFF_EFFEC_TYPE2=[p.BuffEffectName.MIANYIZHUANGTAI,p.BuffEffectName.MIANYIJIFEI],i.BUFF_EFFEC_TYPE3=[p.BuffEffectName.ZENGYI,p.BuffEffectName.JIANYI];var m=cc._decorator,C=m.ccclass,v=(m.property,function(){function e(){this.handleDic={},this.waitInitTodoList=[],this.waitInitTodoTime=0,this.elseTime=null,this.waitList=[],this.bufftippre=null,this.moveKey={},this.handlekey={}}var t;return t=e,Object.defineProperty(e,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),e.prototype.waitInitTodo=function(){if(this.waitInitTodoList&&this.waitInitTodoList.length>0){for(var e=this.waitInitTodoList.shift();e[0]&&e[0].parent&&!e[0].isLive;){e=this.waitInitTodoList.shift();break}!e||e[0]&&e[0].parent&&!e[0].isLive?this.clearTime():this.addBuffEffect(e[0],e[1]),this.waitInitTodoList.length<=0&&this.clearTime()}else this.clearTime()},e.prototype.addBuffEffect=function(e,t){var n=this;if(void 0===t&&(t=""),e.isLive){var o=e.prop.handle;this.handleDic[o]||(this.handleDic[o]={}),t==p.BuffEffectName.ZHAOHUAN2&&(!this.elseTime||this.elseTime<(new Date).getTime())&&(this.elseTime=(new Date).getTime()+200);var a=this.handleDic[o],r=0,s=!0;if(-1!=i.BUFF_EFFEC_TYPE1.indexOf(t))r=1;else if(-1!=i.BUFF_EFFEC_TYPE2.indexOf(t))r=2;else if(-1!=i.BUFF_EFFEC_TYPE3.indexOf(t))r=3;else if(a[t])return void a[t].node.getComponent(c.default).play();r>0&&(s=void 0===a[r]);var h=null;if(s){var u=e.prop.monsterConf;h=l.SpinePools.addSpineNoder(e.node,new cc.Vec2(0,0)),t==p.BuffEffectName.ZHAOHUAN3&&h.setSiblingIndex(0);var f=h.getComponent(c.default);f.initSpineData(p.SPINE_RES_DIR+"effect/monstereffect/effect",null,t),f.playRate=d.default.instance.fightViewPlayRate,f.loop=-1==p.BUFF_TYPE_NO_LOOP.indexOf(t),f.completeCallbackThisObj=this,f.completeCallbackParam=[h],f.completeCallback=function(e){n.recovery(o,t)},u&&(h.scale=u.scenescale)}r>0?this.addLoopBuffEffectInfo(o,t,r,h):this.handleDic[o][t]={node:h,count:1}}},e.prototype.addOneEffect=function(e,t){void 0===t&&(t=""),""!=t&&(this.waitInitTodoList.push([e,t]),0==this.waitInitTodoTime&&(this.waitInitTodoTime=f.default.instance.setInterval(this.waitInitTodo,this,50)))},e.prototype.addLoopBuffEffectInfo=function(e,t,i,n){this.handleDic[e][i]||(this.handleDic[e][i]={node:n,list:[],curanimation:""}),h.default.instance.clearTimeout(e+"BuffTypeEffectUtils"+i);for(var o=0,a=this.handleDic[e][i].list;o<a.length;o++){var r=a[o];if(r.effectname==t)return r.count++,this.updateBuffectLoopPlay(i,e,this.handleDic[e][i],t),void h.default.instance.setInterval(e+"BuffTypeEffectUtils"+i,this.updateBuffectLoopPlay,this,3e3,i,e,this.handleDic[e][i])}var s={count:1,effectname:t};this.updateBuffectLoopPlay(i,e,this.handleDic[e][i],t),this.handleDic[e][i].list.push(s),h.default.instance.setInterval(e+"BuffTypeEffectUtils"+i,this.updateBuffectLoopPlay,this,3e3,i,e,this.handleDic[e][i])},e.prototype.updateBuffectLoopPlay=function(e,t,i,n){if(d.default.instance.fightstatus!=d.FIGHTSTATUS.FIGHTEND&&this.waitInitTodoTime&&this.handleDic[t]&&this.handleDic[t][e]){if(1==e&&d.default.instance.fightlogic){var o=d.default.instance.fightlogic.entity.find(function(e){return e.handle==t});if(!o)return void console.log("buff\u7279\u6548\u9519\u8bef",t,e,n);var a=void 0,r=void 0;switch(n){case p.BuffEffectName.JIAFANG:case p.BuffEffectName.JIANFANG:r=(a=o.attr.buff.GetBuffValue(4))>0?p.BuffEffectName.JIAFANG:p.BuffEffectName.JIANFANG;break;case p.BuffEffectName.JIAGONGJILI:case p.BuffEffectName.JIANGONG:r=(a=o.attr.buff.GetBuffValue(2))>0?p.BuffEffectName.JIAGONGJILI:p.BuffEffectName.JIANGONG}return i.curanimation=r,i.node.getComponent(c.default).play(r),void u.default.log(n+"\u52a0\u653b\u52a0\u9632 \u7b97\u6700\u7ec8\u503c\uff1a"+a,r)}var s="";if(i.list.length>1)if(n)i.curanimation=n,i.node.getComponent(c.default).play(n);else{for(var l=0;l<i.list.length;l++)if(i.list[l].effectname==i.curanimation){s=l<i.list.length-1?i.list[l+1].effectname:i.list[0].effectname;break}s!=i.curanimation&&(i.curanimation=s,i.node.getComponent(c.default).play(s))}}},e.prototype.recoveryLoopEffect=function(e,t,i,n){if(t&&t.list)for(var o=0,a=t.list;o<a.length;o++){var r=a[o];if(r.effectname==n){r.count--,r.count<=0&&(t.list.length>1?(t.list.slice(t.list.indexOf(n),1),this.updateBuffectLoopPlay(e,i,t)):(l.SpinePools.recoverSpineNoder(t.node),u.default.log("1\u79fb\u9664\u5faa\u73af\u7279\u6548"+i+"\u7279\u6548"+n),delete this.handleDic[i][e],h.default.instance.clearTimeout(i+"BuffTypeEffectUtils"+e),u.default.log("2\u79fb\u9664\u5faa\u73af\u7279\u6548"+i+"\u7279\u6548"+n)));break}}},e.prototype.recovery=function(e,t){var n=this.handleDic[e];n&&(-1!=i.BUFF_EFFEC_TYPE1.indexOf(t)?this.recoveryLoopEffect(1,this.handleDic[e][1],e,t):-1!=i.BUFF_EFFEC_TYPE2.indexOf(t)?this.recoveryLoopEffect(2,this.handleDic[e][2],e,t):-1!=i.BUFF_EFFEC_TYPE3.indexOf(t)?this.recoveryLoopEffect(3,this.handleDic[e][3],e,t):n[t]&&(n[t].count--,n[t].count<=0&&(n[t].node.parent?l.SpinePools.recoverSpineNoder(n[t].node):n[t].node.destroy(),delete n[t])))},e.prototype.recoveryAllLoopType=function(e,t){l.SpinePools.recoverSpineNoder(this.handleDic[e][t].node),delete this.handleDic[e][t]},e.prototype.recoveryhandle=function(e){if(this.handleDic[e]){for(var t in this.handleDic[e])switch(t){case"1":case"2":case"3":this.recoveryAllLoopType(e,t),h.default.instance.clearTimeout(e+"BuffTypeEffectUtils"+t);break;default:this.recovery(e,t)}delete this.handleDic[e]}},e.prototype.recoveryAll=function(){for(var e in this.handleDic)this.recoveryhandle(parseInt(e));this.handleDic={},this.clearAllBuffTip(),this.clearTime()},e.prototype.updateEffectsPlayRate=function(){for(var e in this.handleDic){var t=this.handleDic[e];for(var i in t){var n=void 0;switch(i){case"1":case"2":case"3":default:n=t[i].node}n.parent&&n.getComponent(c.default)&&(n.getComponent(c.default).playRate=d.default.instance.fightViewPlayRate)}}},e.prototype.clearTime=function(){this.waitInitTodoTime&&(f.default.instance.clearInterval(this.waitInitTodoTime),this.waitInitTodoTime=0),this.waitInitTodoList.length=0},e.prototype.addBuffTip=function(e,t,i){t.isLive&&(this.waitList.push([e,t,i]),o.default.instance.loadResByType(n.GlobalContext.Root+"prefab/bufftype/BuffTipHurt",cc.Prefab,this.loadCompleteBuffTip,this))},e.prototype.addBuffTipTwo=function(e,t,i){var o=this;if(t.isLive){var l=s.default.getNodeByUrl(this.bufftippre,n.GlobalContext.Root+"prefab/bufftype/BuffTipHurt");l.setPosition(t.prop.x,t.prop.y+t.height),i?(l.getComponent(g.default).setOther("i18n_dodge"),l.scale=1):(l.getComponent(g.default).setData(e),l.scale=.8),d.default.instance.specialskillstatus==p.SPECIAL_SKILL_STATUS.NONE?a.default.instance.node.addChild(l):y.default.instance.node.addChild(l);var c=r.default.instance.allocHandle();this.handlekey[c]=l,l.runAction(cc.sequence(cc.delayTime(.1),cc.moveTo(.8,l.x,l.y+100),cc.callFunc(function(){o.recoveryBuffTip(c)},this)))}},e.prototype.recoveryBuffTip=function(e){var t=this.handlekey[e];t&&(t.stopAllActions(),s.default.setNodeDestoryByUrl(t,n.GlobalContext.Root+"prefab/bufftype/BuffTipHurt")),delete this.handlekey[e]},e.prototype.clearAllBuffTip=function(){for(var e in this.handlekey)this.recoveryBuffTip(e);this.handlekey={}},e.prototype.loadCompleteBuffTip=function(e){var t=this;this.bufftippre=e;var i=f.default.instance.setInterval(function(){if(t.waitList.length>0){var e=t.waitList.shift();t.addBuffTipTwo.apply(t,e)}t.waitList.length<=0&&f.default.instance.clearInterval(i)},this,500)},e=t=__decorate([C],e)}());i.default=v,cc._RF.pop()},{"../../../Core/LoadManager":"LoadManager","../../../Core/SpineBase":"SpineBase","../../../Core/TimeController":"TimeController","../../../Global/GlobalValue":"GlobalValue","../../../GlobalContext":"GlobalContext","../../../Util/Utils":"Utils","../Controller/FightTimeController":"FightTimeController","../Controller/SceneController":"SceneController","../Manager/SceneManager":"SceneManager","../Pool/SpinePools":"SpinePools","../Unit/FightLog":"FightLog","../View/ActorsLayer":"ActorsLayer","../View/ActorsMaskLayer":"ActorsMaskLayer","./BuffTipHurt":"BuffTipHurt"}],CacheManager:[function(e,t,i){"use strict";cc._RF.push(t,"b5c6clDEKBKyrkpt1/3vVor","CacheManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./LoadManager"),o=e("./CommonsResManager"),a=e("./TimeController"),r=e("../Global/GlobalValue"),s=cc._decorator,l=s.ccclass,c=(s.property,function(){function e(){this._useRecordDic={},this._useDepsDic={},this._checkUseRecordTime=0,this._cachePreDicCount={},this.depsCount=100}var t;return t=e,Object.defineProperty(e,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataDic",{get:function(){return n.default.instance._loadedDic},enumerable:!0,configurable:!0}),e.prototype.releasePrefab=function(e,t){void 0===t&&(t=null),this.deleteDataDic(e);for(var i=cc.loader.getDependsRecursively(e),n=[],o=i.length-1;o>=0;o--){var a=i[o];1==this.checkCanRelease(a)&&(this._useDepsDic[a]&&console.error("CacheManager.releasePrefab, \u8fd8\u6709\u4f9d\u8d56\u4f60\u5c31\u6e05\uff1f prefabUrl:"+e+", itemUrl:"+a),n.push(a))}cc.loader.release(n),cc.loader.releaseRes(e),this.showCachedTextureInfo()},e.prototype.releaseRes=function(e){var t=this.dataDic[e],i=!0;if(this.dataDic[e]&&this.dataDic[e]instanceof cc.SpriteAtlas){for(var n=this.dataDic[e],o=n.getSpriteFrames(),a=o.length-1;a>=0;a--)o[a].destroy(),this.releaseItem(o[a]);this.releaseItem(n)}else if(this.dataDic[e]&&this.dataDic[e]instanceof cc.SpriteFrame){var r=this.dataDic[e];r.destroy(),this.releaseItem(r)}else if(this.dataDic[e]&&"dir"==this.dataDic[e].type){var s=this.dataDic[e].resource;for(a=s.length-1;a>=0;a--)s[a].destroy(),this.releaseItem(s[a]),this.releaseItem(this.dataDic[e].urls[a]);cc.loader.releaseResDir(e),i=!1}else if(this.dataDic[e]&&this.dataDic[e]instanceof cc.Texture2D)return cc.loader.release(e),void this.deleteDataDic(e);this.deleteDataDic(e),1==i&&(t&&this.releaseItem(t),e.indexOf("http")>=0?cc.loader.release(e):cc.loader.releaseRes(e))},e.prototype.releaseItem=function(e){for(var t=cc.loader.getDependsRecursively(e),i=t.length-1;i>=0;i--){var n=t[i];if(this._useDepsDic[n]&&this._useDepsDic[n].count>0)return void console.warn("CacheManager.releaseItem, \u8fd8\u6709\u4f9d\u8d56\u4f60\u5c31\u6e05\uff1f itemUrl:"+n,e,this._useDepsDic[n]);if(0==this.checkCanRelease(n))return void console.warn("CacheManager.releaseItem, checkCanRelease = false, itemUrl:"+n)}cc.loader.release(e),cc.loader.release(t)},e.prototype.releaseUrl=function(e){if(this.dataDic[e]){for(var t=cc.loader.getDependsRecursively(this.dataDic[e]),i=t.length-1;i>=0;i--){var n=t[i];if(this._useDepsDic[n])return void console.error("CacheManager.releaseUrl, \u8fd8\u6709\u4f9d\u8d56\u4f60\u5c31\u6e05\uff1furl:"+e+", itemUrl:"+n);if(0==this.checkCanRelease(n))return void console.error("CacheManager.releaseUrl, checkCanRelease = false, url:"+e+", itemUrl:"+n)}cc.loader.release(e),cc.loader.release(t)}},e.prototype.checkCanRelease=function(e){return!o.default.instance.commonDependsDic[e]},e.prototype.showCachedTextureInfo=function(){cc.sys.garbageCollect()},e.prototype.deleteDataDic=function(e){this.dataDic&&this.dataDic[e]&&(this.dataDic[e]=null,delete this.dataDic[e])},e.prototype.clearUseRecord=function(e){if(e&&""!=e){this._useRecordDic[e]||(this._useRecordDic[e]={},this._useRecordDic[e].count=0);var t=Number(this._useRecordDic[e].count);--t<=0&&(t=0),this._useRecordDic[e].count=t,this._useRecordDic[e].time=Date.now(),this.logaa("\u6e05\u7406pre\u7d22\u5f15 \uff1a ",e,t,this._useRecordDic[e].time)}},e.prototype.logaa=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},e.prototype.setUseRecord=function(e){if(e&&""!=e){this._useRecordDic[e]||(this._useRecordDic[e]={},this._useRecordDic[e].count=0);var t=Number(this._useRecordDic[e].count);t++,this._useRecordDic[e].count=t,this._useRecordDic[e].time=Date.now(),this.logaa("\u8bbe\u7f6epre\u7d22\u5f15 \uff1a ",e,t,this._useRecordDic[e].time)}},e.prototype.clearDeopsRecord=function(e,t){if(e&&""!=e){this._useDepsDic[e]||(this._useDepsDic[e]={},this._useDepsDic[e].count=0);var i=Number(this._useDepsDic[e].count);--i<=0&&(i=0),this._useDepsDic[e].count=i,this._useDepsDic[e][t]&&(this._useDepsDic[e][t].count--,this._useRecordDic[t]&&this._useRecordDic[t].time?this._useDepsDic[e].time=this._useRecordDic[t].time:this._useDepsDic[e].time=Date.now(),this.logaa("\u6e05\u7406dep \u7d22\u5f15 \uff1a ",e,t,i,this._useDepsDic[e]))}},e.prototype.setDeopsRecord=function(e,t){if(e&&""!=e){this._useDepsDic[e]||(this._useDepsDic[e]={},this._useDepsDic[e].count=0);var i=Number(this._useDepsDic[e].count);i++,this._useDepsDic[e].count=i,this._useDepsDic[e][t]||(this._useDepsDic[e][t]={},this._useDepsDic[e][t].count=0),this._useDepsDic[e][t].count++,this._useRecordDic[t]&&this._useRecordDic[t].time?this._useDepsDic[e].time=this._useRecordDic[t].time:this._useDepsDic[e].time=Date.now(),this.logaa("\u8bbe\u7f6edep \u7d22\u5f15 \uff1a ",e,t,i,this._useDepsDic[e])}},e.prototype.invUseRecord=function(){var e=this,t=Date.now();console.log("\u5f00\u59cb\u7f13\u5b58\u6570\u91cf \uff1a "+Object.keys(cc.loader._cache).length);var i=function(){var i=e.recordAllList.splice(0,e.depsCount),n=r.CACHE_DISPOS_TIME;if(i&&i.length>0)for(var o=0;o<i.length;o++){var s=i[o];if(s){var l=e._useRecordDic[s];if(l&&l.count<=0&&t-l.time>n){for(var c=!1,d=cc.loader.getDependsRecursively(s),p=null,h=0;h<d.length;h++){var u=e._useDepsDic[d[h]];if(!e.checkCanRelease(d[h])||u&&u.count>0){c=!0,p=d[h];break}}if(1==c){e.logaa("\u8fd8\u6709\u901a\u7528\u8d44\u6e90\u5f15\u7528\u6682\u4e0d\u6e05\u7406\uff1a"+s,p);continue}e.logaa("\u6e05\u7406\u8d44\u6e90\uff1a"+s),e.releaseRes(s);for(var f=0;f<d.length;f++)if(e.checkCanRelease(d[f])){var g=e._useDepsDic[d[f]];g&&g.count<=0&&t-g.time>n&&(e.deleteDataDic(d[f]),e.logaa("\u6e05\u7406deps\u8d44\u6e90\uff1a"+d[f],e._useDepsDic[d[f]],s),cc.loader.release(d[f]),e._useDepsDic[d[f]])}e._useRecordDic[s]=null,delete e._useRecordDic[s]}else e.logaa("\u7f13\u5b58 url:"+s+" , \u5f15\u7528\u8bb0\u5f55 count:"+l.count+", time:"+(t-l.time)+", \u6682\u65f6\u4e0d\u6e05\u7406",Date.now(),l)}}if(e.recordAllList.length<=0)return a.default.instance.clearInterval(e.invUseDepstime),e.invUseDepstime=0,console.log("\u6e05\u7406\u540e\u7f13\u5b58\u6570\u91cf \uff1a "+Object.keys(cc.loader._cache).length),console.log("\u6e05\u7406\u7f13\u5b58\u7528\u65f6 \uff1a "+(Date.now()-t)),void e.showCachedTextureInfo()};this.invUseDepstime||(console.log("\u5f00\u59cb\u6e05\u7406",t),this.recordAllList=Object.keys(this._useRecordDic),this.invUseDepstime=a.default.instance.setInterval(i,this,50),i())},e.prototype.deteleRecordUrlDic=function(e){this._useRecordDic[e]=null,delete this._useRecordDic[e],this.releaseUrl(e)},e=t=__decorate([l],e)}());i.default=c,cc._RF.pop()},{"../Global/GlobalValue":"GlobalValue","./CommonsResManager":"CommonsResManager","./LoadManager":"LoadManager","./TimeController":"TimeController"}],CardData:[function(e,t,i){"use strict";cc._RF.push(t,"f5bebjvhN5GXq0BaJjeu6T2","CardData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/ConfigsManager"),o=e("./MonsterController"),a=e("../../Global/GlobalValue"),r=e("../Item/ItemModel"),s=e("./WarTeam"),l=e("../Role/RoleInfo"),c=e("../Functionicon/FunctionIconController"),d=e("../../Core/WindowType"),p=e("../Scene/Controller/SkillController"),h=e("../Role/RoleController"),u=e("../../Core/WindowManager"),f=function(){function e(){this._cardConfigs=null,this.cardInfo={},this._autoReplaceData={flag:!1,cardID:-1,cardIDTwo:-1,type:-1},this._tabIndex=1,this._defaultGrade=1}return e.prototype.initCfg=function(){this._cardConfigs=n.ConfigsManager.instance.getConfigs("cardConf"),this.initCardInfoByItemId()},e.prototype.initCardInfoByItemId=function(){var e=this._cardConfigs.Card;for(var t in e){var i=e[t];this.cardInfo[i.pieceId]=i}},e.prototype.getCardCfg=function(){return this._cardConfigs},e.prototype.getCardIdByItemId=function(e){return this.cardInfo[e]},e.prototype.setAutoReplaceData=function(e){this._autoReplaceData.flag=e.flag,this._autoReplaceData.cardID=e.cardID,this._autoReplaceData.cardIDTwo=e.cardIDTwo,this._autoReplaceData.type=e.type},e.prototype.getAutoReplaceData=function(){return this._autoReplaceData},e.prototype.getCardTotalFight=function(){var e=0,t=o.MonsterType.MonsterWarTeam[o.MonsterType.MonsterBattle],i=o.default.instance;for(var n in t){var a=t[n],r=i.GetMonsterData(a);e+=i.getCarFight(a,r.level,r.grade,!0,null,!1)}return e},e.prototype.cardShowDataSort=function(){var e=[],t=[],i=[],n=this._cardConfigs,a=o.default.instance;for(var l in n.Card)if(1==n.Card[l].isDisplay){r.default.getCountByid(n.Card[l].pieceId);a.getIsMonsterCard(n.Card[l].id)?e.push(n.Card[l].id):n.Card[l].pieceNum>0?t.push(n.Card[l].id):i.push(n.Card[l].id)}e.sort(function(e,t){if(n.Card[e].rarity<n.Card[t].rarity)return 1;if(n.Card[e].rarity>n.Card[t].rarity)return-1;var i=a.GetMonsterData(e),o=a.GetMonsterData(t);if(i&&o){var r=a.getCarFight(i.id,i.level,a.data.defaultGrade,!0,null,!1);return a.getCarFight(o.id,o.level,a.data.defaultGrade,!0,null,!1)-r}}),t.sort(function(e,t){return n.Card[e].rarity<n.Card[t].rarity?1:n.Card[e].rarity>n.Card[t].rarity?-1:r.default.getCountByid(n.Card[t].pieceId)-r.default.getCountByid(n.Card[e].pieceId)}),i.sort(function(e,t){return n.Card[e].rankings-n.Card[t].rankings});for(var c=0;c<=e.length;c++)if(a.getIsLineup(e[c])){e.splice(c,1)[0];c--}var p=!0;u.default.instance.isOpenWindow(d.WindowType.WarTeam)&&(p=s.default.instance.cheakInit());var h=[];for(var f in o.MonsterType.MonsterWarTeam[o.MonsterType.MonsterBattle])o.MonsterType.MonsterWarTeam[o.MonsterType.MonsterBattle][f]&&h.push(o.MonsterType.MonsterWarTeam[o.MonsterType.MonsterBattle][f]);if(u.default.instance.isOpenWindow(d.WindowType.WarTeam)&&null!=s.default.instance.changeConfig&&h.splice(s.default.instance.changeConfig,1),u.default.instance.isOpenWindow(d.WindowType.WarTeam)&&s.default.instance.newCardChange)for(f=0;f<=e.length;f++)if(e[f]==s.default.instance.newCardId){var g=e.splice(f,1);h.unshift(g);break}return p?h.concat(e,t,i):h.concat(e,i)},e.prototype.getCarArrByType=function(e){void 0===e&&(e=0);var t=this.cardShowDataSort(),i=[];if(0==e)return t;for(var n=0;n<t.length;n++)0!=t[n]&&e==this._cardConfigs.Card[t[n]].cardType&&i.push(t[n]);return i},e.prototype.getRedByCardid=function(e){var t=!1,i=o.default.instance,n=i.GetMonsterData(e),a=r.default.getCountByid(this._cardConfigs.Card[e].pieceId);if(n&&n.level){var s=this.getFiveLineAttributes(e),l=i.cardStageData.getlineFive(s,n.stage);if(l)if(a>=l.pieceNum)if(t=!0,l.itemId&&!t)t=r.default.getCountByid(l.propType)<l.count}return t},e.prototype.getFiveLineAttributes=function(e){return this._cardConfigs.Card[e].fiveLineAttributes},e.prototype.getCardRarity=function(e){return this._cardConfigs.Card[e].rarity},e.prototype.getCardPieceId=function(e){return this._cardConfigs.Card[e].pieceId},e.prototype.getCardUPlevFlag=function(e){if(!c.default.instance.checkIsOpenbyWindowtype(d.WindowType.CardStage))return!1;var t=o.default.instance,i=t.GetMonsterData(e);if(!i)return!1;var n=t.cardStageData.getCardMaxLevel(e),a=this.getFiveLineAttributes(e),s=t.cardStageData.getlineFive(a,i.level);if(n<=i.level||!s||s.needLevel>l.MyRoleInfo.level)return!1;var p=t.data.getCardPieceId(e);return!(s.needMoney>l.MyRoleInfo.money)&&(!(r.default.getCountByid(p)<s.pieceNum)&&!(s.itemId&&r.default.getCountByid(s.itemId)<s.count))},e.prototype.getCardUpSkillFlag=function(e){if(!c.default.instance.checkIsOpenbyWindowtype(d.WindowType.CardSkill))return!1;var t=this._cardConfigs.Card[e].skillId,i=o.default.instance.GetMonsterData(e);if(!i)return!1;for(var n=[],r=0;r<t.length;++r){for(var s=0,l=0;l<i.skill.length;++l)if(t[r]==i.skill[l].id){s=i.skill[l].level;break}n.push({id:t[r],level:s})}var u=p.default.instance.skillConfigs;for(r=0;r<n.length;++r){var f=p.default.instance.getSkillBySkillIdAndLv(n[r].id,n[r].level+1),g=u.skillconf[n[r].id].maxSkillLevel,y=p.default.instance.getSkillBySkillId(n[r].id);if(u.levelConf[y.levelConf][0].unlockStage<=i.level&&g&&n[r].level<i.level&&n[r].level<g&&h.default.instance.GetMyWealth(a.WealthType.Money)>=u.consume[f.consume].amount)return!0}return!1},Object.defineProperty(e.prototype,"MorphologicalTag",{get:function(){return this._tabIndex},set:function(e){this._tabIndex!=e&&(this._tabIndex=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultGrade",{get:function(){return this._defaultGrade},enumerable:!0,configurable:!0}),e.prototype.getRarityFlag=function(e,t){for(var i in void 0===t&&(t=0),o.MonsterType.MonsterCardArr)if(t){var n=o.default.instance.GetMonsterInfo(o.MonsterType.MonsterCardArr[i].id).cardType;for(var a in o.MonsterType.MonsterCardArr){r=this.getCardRarity(o.MonsterType.MonsterCardArr[a].id);if(t==n&&r==e)return!0}}else for(var a in o.MonsterType.MonsterCardArr){var r;if((r=this.getCardRarity(o.MonsterType.MonsterCardArr[a].id))==e)return!0}return!1},e}();i.default=f,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../Functionicon/FunctionIconController":"FunctionIconController","../Item/ItemModel":"ItemModel","../Role/RoleController":"RoleController","../Role/RoleInfo":"RoleInfo","../Scene/Controller/SkillController":"SkillController","./MonsterController":"MonsterController","./WarTeam":"WarTeam"}],CardEffect:[function(e,t,i){"use strict";cc._RF.push(t,"e80f0vG9XZJsKAbvigHI/bw","CardEffect"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../WarTeam/MonsterController"),a=e("../Commons/MonsterPreview"),r=e("../../Util/Utils"),s=e("../../Core/WindowType"),l=e("../../Core/CommonsResManager"),c=e("../../Core/GameEventDispatcher"),d=e("../../Core/Event"),p=e("./DrawController"),h=cc._decorator,u=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bgImgs=null,t.cardImgs=null,t.effectNode=null,t.cardBgNode=null,t.cardNode=null,t.flag=!1,t.clickFlag=!0,t.rarity=null,t._cardData=null,t}return __extends(t,e),t.prototype.onLoad=function(){},t.prototype.show=function(){e.prototype.show.call(this),c.GameEventDispatcher.instance.on(d.EventDefiner.DrawCard_CardEffect,this.setClickFlag,this)},t.prototype.hide=function(){e.prototype.hide.call(this),this.flag=!1,this.clickFlag=!0,c.GameEventDispatcher.instance.on(d.EventDefiner.DrawCard_CardEffect,this.setClickFlag,this)},t.prototype.setData=function(e){this._cardData=e;var t=o.default.instance.data.getCardCfg(),i=o.default.instance.data.getCardIdByItemId(e.id);this.rarity=t.Card[i.id].rarity,this.flag=!1,this.rarity>3?this.effectNode.active=!0:this.effectNode.active=!1,this.cardNode.getChildByName("rarityNode").getChildByName("rarity").getComponent(cc.Sprite).spriteFrame=l.default.instance.getSpriteFrameByName("rarity_"+this.rarity),this.cardNode.getChildByName("node").getChildByName("Label").getComponent(cc.Label).string=e.count+"",this.cardBgNode.getComponent(cc.Sprite).spriteFrame=this.bgImgs.getSpriteFrame("cardBg_"+p.default.instance.clickType),this.cardNode.active=!1},t.prototype.setClickFlag=function(e){var t=e.getUserData();this.clickFlag=t.flag,this.node.getComponent(cc.Button).interactable=t.flag},t.prototype.getCardFlag=function(){return this.flag},t.prototype.setMode=function(){this.cardNode.getChildByName("model").scale=1;for(var e=this.cardNode.getChildByName("model").childrenCount-1;e>=0;e--){var t=this.cardNode.getChildByName("model").children[e].getComponent(a.default);r.default.setNodeToPool(s.PoolType.MonsterPreview,this.cardNode.getChildByName("model").children[e]),t.clear()}var i=o.default.instance.data.getCardIdByItemId(this._cardData.id);o.default.instance.infoPreview(this.cardNode.getChildByName("model"),cc.v2(0,0),i.id,5,.4,-1,!0)},t.prototype.rolloverEffect=function(){var e=this;!this.flag&&this.clickFlag&&(c.GameEventDispatcher.instance.emit("DRAWLIGHTOVER"),this.flag=!0,this.cardBgNode.rotationX=0,this.cardBgNode.rotationY=0,this.cardBgNode.runAction(cc.sequence(cc.scaleTo(.15,0,1),cc.callFunc(function(){e.cardBgNode.getComponent(cc.Sprite).spriteFrame=e.cardImgs.getSpriteFrame("di_"+e.rarity),e.cardNode.active=!0},this),cc.scaleTo(.15,1,1))))},__decorate([f(cc.SpriteAtlas)],t.prototype,"bgImgs",void 0),__decorate([f(cc.SpriteAtlas)],t.prototype,"cardImgs",void 0),__decorate([f(cc.Node)],t.prototype,"effectNode",void 0),__decorate([f(cc.Node)],t.prototype,"cardBgNode",void 0),__decorate([f(cc.Node)],t.prototype,"cardNode",void 0),t=__decorate([u],t)}(n.default);i.default=g,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../Util/Utils":"Utils","../Commons/MonsterPreview":"MonsterPreview","../WarTeam/MonsterController":"MonsterController","./DrawController":"DrawController"}],CardEquipAddUtils:[function(e,t,i){"use strict";cc._RF.push(t,"3e0b2gpesFCyK4vOtn7QdFG","CardEquipAddUtils"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Global/GlobalValue"),o=e("../../WarTeam/MonsterController"),a=e("../../Equip/equip/EquipCtrl"),r=cc._decorator,s=r.ccclass,l=(r.property,function(){function e(){}var t;return t=e,Object.defineProperty(e,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),e.prototype.setCardEquipAddProp=function(e){return o.default.instance.getEquipInfoByCardId(e.cardid)},e.prototype.setCardEquipEffectAddAttr=function(e,t){void 0===t&&(t=!0);for(var i=[],r=a.default.instance.data.getEquipEffectAddAttr(e.cardid),s=o.default.instance.data.getFiveLineAttributes(e.cardid),l=t?n.AttrType.MaxHp:n.AttrType.HpRate,c=t?n.AttrType.WindDef:n.AttrType.WindDefRate;l<=c;){var d=t?l:l-n.AttrType.HpRate,p=r[l]?r[l]:0,h=this.getFiveElementType(s,t),u=r[h+d]?r[h+d]:0;i[l]=p+u,l+=1}return i},e.prototype.getFiveElementType=function(e,t){if(void 0===t&&(t=!0),t)switch(e){case n.ElementType.thunder:return n.AttrType.ThuHp;case n.ElementType.soil:return n.AttrType.EarHp;case n.ElementType.water:return n.AttrType.WatHp;case n.ElementType.fire:return n.AttrType.FirHp;case n.ElementType.wind:return n.AttrType.WinHp}else switch(e){case n.ElementType.thunder:return n.AttrType.ThuHpRate;case n.ElementType.soil:return n.AttrType.EarHpRate;case n.ElementType.water:return n.AttrType.WatHpRate;case n.ElementType.fire:return n.AttrType.FirHpRate;case n.ElementType.wind:return n.AttrType.WinHpRate}},e=t=__decorate([s],e)}());i.default=l,cc._RF.pop()},{"../../../Global/GlobalValue":"GlobalValue","../../Equip/equip/EquipCtrl":"EquipCtrl","../../WarTeam/MonsterController":"MonsterController"}],CardGroupAttrItem:[function(e,t,i){"use strict";cc._RF.push(t,"2349bK0R5RK3oAaHxgN2MqO","CardGroupAttrItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Util/AttrUtil"),a=cc._decorator,r=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.title=null,t.attrNode=null,t.attrListNode=null,t.attrIconAtlas=null,t}return __extends(t,e),t.prototype.setData=function(e,t){for(var i in void 0===t&&(t=""),this.title.string=t,e){var n=cc.instantiate(this.attrNode);n.active=!0,this.setAttr(n,parseInt(i),e[i]),this.attrListNode.addChild(n)}},t.prototype.setAttr=function(e,t,i){e.children[0].getComponent(cc.Sprite).spriteFrame=this.attrIconAtlas.getSpriteFrame("attrIcon_"+t),e.children[1].getComponent(cc.Label).string=o.default.getAttrName(t),e.children[2].getComponent(cc.Label).string=i.toString()},__decorate([s(cc.Label)],t.prototype,"title",void 0),__decorate([s(cc.Node)],t.prototype,"attrNode",void 0),__decorate([s(cc.Node)],t.prototype,"attrListNode",void 0),__decorate([s(cc.SpriteAtlas)],t.prototype,"attrIconAtlas",void 0),t=__decorate([r],t)}(n.default);i.default=l,cc._RF.pop()},{"../../../Core/Widget":"Widget","../../../Util/AttrUtil":"AttrUtil"}],CardGroupAttrTips:[function(e,t,i){"use strict";cc._RF.push(t,"3ec82PEmv9KSYnTQ0YPv4XP","CardGroupAttrTips"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Window"),o=e("../MonsterController"),a=e("../../../Util/Utils"),r=e("../../../Core/WindowType"),s=e("../../Commons/WindowOpenUtils"),l=e("../../../Core/WindowManager"),c=e("../../../Core/Language"),d=e("../../../GlobalContext"),p=e("../../../Core/LoadManager"),h=e("./CardGroupAttrItem"),u=e("../../../Global/GlobalValue"),f=e("../../../Util/UtilsFight"),g=cc._decorator,y=g.ccclass,m=g.property,C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.desc=null,t.prefabNode=null,t.listNode=null,t}return __extends(t,e),t.prototype.setData=function(e){var t=this;this.desc.string=c.default.getStr("cardGroup_text_10");var i=this.getShowAttrData(e);a.default.setNodeChildDestoryByUrl(this.listNode,d.GlobalContext.Root+"prefab/Card/CardGroup/CardGroupAttrItem"),p.default.instance.loadResByType(d.GlobalContext.Root+"prefab/Card/CardGroup/CardGroupAttrItem",cc.Prefab,function(e){for(var n in i){var o=a.default.getNodeByUrl(e,d.GlobalContext.Root+"prefab/Card/CardGroup/CardGroupAttrItem");o.getComponent(h.default).setData(i[n].attr,i[n].title),t.listNode.addChild(o)}},this)},t.prototype.openCardGroup=function(){l.default.instance.closeAll(),s.default.instance.openWindowType(r.WindowType.AssistFight)},t.prototype.getShowAttrData=function(e){var t=[],i=o.default.instance.GetMonsterData(e),n={},r={};if(i){var s=o.default.instance.cardGroupData.getAllCardGroupAttr();r=o.default.instance.getAttrPrecentByGradeAndType(o.default.instance.data.defaultGrade,a.default.getCardBaseAttr(e,i.level)),this.setMap(n,s),this.setMap(n,r);var l=o.default.instance.getCardConfCardType(e),c=o.default.instance.data.getFiveLineAttributes(e);f.default.countAdditionAttrs(n,l,c)}return this.attrFilter(n,t,r),t},t.prototype.attrFilter=function(e,t,i){for(var n={},o={},r={},s=0;s<=u.AttrType.WindDef;++s){var l=e[s]?e[s]:0,d=i[s]?i[s]:0;s<=u.AttrType.DefCri?a.default.setAttrMap(n,s,l-d):s%2==1?a.default.setAttrMap(o,s,l-d):a.default.setAttrMap(r,s,l-d)}t.push({title:c.default.getStr("Role_6"),attr:n}),t.push({title:c.default.getStr("cardGroup_text_11"),attr:o}),t.push({title:c.default.getStr("cardGroup_text_12"),attr:r})},t.prototype.setMap=function(e,t){for(var i in t)a.default.setAttrMap(e,parseInt(i),t[i])},__decorate([m(cc.RichText)],t.prototype,"desc",void 0),__decorate([m(cc.Node)],t.prototype,"prefabNode",void 0),__decorate([m(cc.Node)],t.prototype,"listNode",void 0),t=__decorate([y],t)}(n.default);i.default=C,cc._RF.pop()},{"../../../Core/Language":"Language","../../../Core/LoadManager":"LoadManager","../../../Core/Window":"Window","../../../Core/WindowManager":"WindowManager","../../../Core/WindowType":"WindowType","../../../Global/GlobalValue":"GlobalValue","../../../GlobalContext":"GlobalContext","../../../Util/Utils":"Utils","../../../Util/UtilsFight":"UtilsFight","../../Commons/WindowOpenUtils":"WindowOpenUtils","../MonsterController":"MonsterController","./CardGroupAttrItem":"CardGroupAttrItem"}],CardGroupChildTag:[function(e,t,i){"use strict";cc._RF.push(t,"21292l8pxNKcZ1TKIiIgxq0","CardGroupChildTag"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=cc._decorator,a=o.ccclass,r=o.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.img=null,t.tagName=null,t._tagIndex=null,t._selectedCallback=null,t._selectedCallbackObj=null,t}var i;return __extends(t,e),i=t,t.prototype.setData=function(e,t,i){this._tagIndex=e.cardGroupIdx,this.tagName.string=e.cardGroupNmae,this.img.active=!1,this._selectedCallback=t,this._selectedCallbackObj=i},t.prototype.onClickTag=function(e){if(e.type==cc.Node.EventType.TOUCH_END){var t=e.currentTarget,i=t.getSiblingIndex();this.selectItem(t.parent,i)}},t.prototype.selectItem=function(e,t){for(var n in e.children)e.children[n].getComponent(i).setSelectedFlag(t==parseInt(n))},t.prototype.setSelectedFlag=function(e){this.img.active=e,e&&this.Callback(this._tagIndex)},t.prototype.Callback=function(e){this._selectedCallback&&this._selectedCallback.call(this._selectedCallbackObj,e)},__decorate([r(cc.Node)],t.prototype,"img",void 0),__decorate([r(cc.Label)],t.prototype,"tagName",void 0),t=i=__decorate([a],t)}(n.default);i.default=s,cc._RF.pop()},{"../../../Core/Widget":"Widget"}],CardGroupData:[function(e,t,i){"use strict";cc._RF.push(t,"2a608bLcTBDs7wZDMwrGxBi","CardGroupData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/ConfigsManager"),o=e("../MonsterController"),a=e("../../Functionicon/FunctionIconController"),r=e("../../../Util/Utils"),s=function(){function e(){this._cfg=null,this._cardGroupAttr={},this._cardGroupAttrCptFlag=!1}return Object.defineProperty(e.prototype,"cfg",{get:function(){return this._cfg||(this._cfg=n.ConfigsManager.instance.getConfigs("cardGroupConf")),this._cfg},enumerable:!0,configurable:!0}),e.prototype.getTabData=function(){var e={};for(var t in this.cardGroupCfg){var i=this.cardGroupCfg[t].tagName,n=this.cardGroupCfg[t].name;e[i]||(e[i]=new Array),e[i].push({cardGroupIdx:parseInt(t),cardGroupNmae:n})}return e},e.prototype.getTagName=function(e){return this.cfg.tagName[e].tagName},e.prototype.getCardGruopFlag=function(t){var i=this.cardGroupCfg[t].compose;for(var n in i){var a=e[n];if(!o.default.instance.getIsMonsterCard(a))return!1}return!0},e.prototype.getCardGroupSectionFlag=function(e){var t=this.getChapter(e),i=this.getSection(e);return a.default.instance.checkIsPass(t-1,i-1)},e.prototype.getChapter=function(e){return this.cardGroupCfg[e].chapter},e.prototype.getSection=function(e){return this.cardGroupCfg[e].section},e.prototype.getCardGroupCfgAttr=function(e,t){var i=this.cardGroupCfg[e].attr,n=t>0?t-1:0;return this.attrCfg[i][n].value?this.attrCfg[i][n].value:null},e.prototype.getCardGroupMaxLevel=function(e){var t=0;if(this.cardGroupCfg[e]){var i=this.cardGroupCfg[e].attr;t=this.attrCfg[i].length}return t},Object.defineProperty(e.prototype,"cardGroupCfg",{get:function(){return this.cfg.cardGroup[1]},enumerable:!0,configurable:!0}),e.prototype.getGroupUPLevel=function(e,t){var i=t>0?t-1:0;return this.getLevelCfg(e)[i].upLevel},e.prototype.cptCardGroupLevel=function(e){var t=0,i=this.getCardMinLevel(e),n=this.getLevelCfg(e);for(var o in n)n[o].upLevel<=i&&(t+=1);return t},e.prototype.getCardGroupAttr=function(e){if(!e)return null;var t=this.getGardGroupList(e),i={};for(var n in t)for(var o=this.getCardGroupCfgAttr(t[n],this.cptCardGroupLevel(t[n])),a=0;o[a];)r.default.setAttrMap(i,o[a],o[a+1]),a+=2;return i},e.prototype.getAllCardGroupAttr=function(){if(!this._cardGroupAttrCptFlag){for(var e in this._cardGroupAttr={},this.cardGroupCfg){var t=parseInt(e);if(this.cptCardGroupLevel(t)>0&&this.getCardGroupSectionFlag(t))for(var i=this.getCardGroupCfgAttr(t,this.cptCardGroupLevel(t)),n=0;i[n];)r.default.setAttrMap(this._cardGroupAttr,i[n],i[n+1]),n+=2}this._cardGroupAttrCptFlag=!0}return this._cardGroupAttr},e.prototype.getGardGroupList=function(e){var t=[];for(var i in this.cardGroupCfg)if(this.cptCardGroupLevel(parseInt(i))>0){var n=this.cardGroupCfg[i].compose;for(var o in n)n[o]==e&&t.push(parseInt(i))}return t},e.prototype.getLevelCfg=function(e){var t=this.cardGroupCfg[e].level;return this.cfg.level[t]},Object.defineProperty(e.prototype,"attrCfg",{get:function(){return this.cfg.attr},enumerable:!0,configurable:!0}),e.prototype.getCardMinLevel=function(e){var t=this.cardGroupCfg[e].compose,i=0;for(var n in t){var a=o.default.instance.GetMonsterData(t[n]);if(!a)return 0;i>0&&a.level<i?i=a.level:0==i&&(i=a.level)}return i},Object.defineProperty(e.prototype,"cardGroupAttrCptFlag",{set:function(e){this._cardGroupAttrCptFlag=e},enumerable:!0,configurable:!0}),e}();i.default=s,cc._RF.pop()},{"../../../Core/ConfigsManager":"ConfigsManager","../../../Util/Utils":"Utils","../../Functionicon/FunctionIconController":"FunctionIconController","../MonsterController":"MonsterController"}],CardGroupTag:[function(e,t,i){"use strict";cc._RF.push(t,"444509IxWFEt7Nu0R57Jo3Z","CardGroupTag"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../MonsterController"),a=e("./CardGroupChildTag"),r=cc._decorator,s=r.ccclass,l=r.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tagName=null,t.tagSprite=null,t.imgNode=null,t.childTagList=null,t.childTagNode=null,t.btnBg=[],t._tagIdx=null,t._childTagData=null,t._selectedCallback=null,t._selectedCallbackObj=null,t._isSelected=!1,t}var i;return __extends(t,e),i=t,t.prototype.setData=function(e,t,i,n){this._tagIdx=e,this._childTagData=t,this._selectedCallback=i,this._selectedCallbackObj=n,this.tagName.string=o.default.instance.cardGroupData.getTagName(this._tagIdx),this.resetShow()},t.prototype.resetShow=function(){this.tagSprite.spriteFrame=this.btnBg[0],this.imgNode.active=!1,this.node.getComponent(cc.Sprite).enabled=!1,this.childTagList.active=!1,this._isSelected=!1},t.prototype.setChildTagShow=function(){var e=this._childTagData.length>0;if(this.node.getComponent(cc.Sprite).enabled=e,this.childTagList.active=e,e){for(var t in this._childTagData){if(!this.childTagList.children[t]){var i=cc.instantiate(this.childTagNode);i.active=!0,this.childTagList.addChild(i)}this.childTagList.children[t].getComponent(a.default).setData(this._childTagData[t],this.onClickChildTag,this)}this.childTagList.children[0].getComponent(a.default).setSelectedFlag(!0)}},t.prototype.onClickTag=function(e){if(e.type==cc.Node.EventType.TOUCH_END){var t=e.currentTarget,i=t.parent.getSiblingIndex();this.selectTag(t.parent.parent,i)}},t.prototype.setSelectedFlag=function(e){this.tagSprite.spriteFrame=e?this.btnBg[1]:this.btnBg[0],this.imgNode.active=e,e&&!this._isSelected?(this._isSelected=e,this.setChildTagShow()):this.resetShow()},t.prototype.selectTag=function(e,t){for(var n in e.children)e.children[n].getComponent(i).setSelectedFlag(t==parseInt(n))},t.prototype.onClickChildTag=function(e){this.Callback(e)},t.prototype.Callback=function(e){this._selectedCallback&&this._selectedCallback.call(this._selectedCallbackObj,e)},__decorate([l(cc.Label)],t.prototype,"tagName",void 0),__decorate([l(cc.Sprite)],t.prototype,"tagSprite",void 0),__decorate([l(cc.Node)],t.prototype,"imgNode",void 0),__decorate([l(cc.Node)],t.prototype,"childTagList",void 0),__decorate([l(cc.Node)],t.prototype,"childTagNode",void 0),__decorate([l([cc.SpriteFrame])],t.prototype,"btnBg",void 0),t=i=__decorate([s],t)}(n.default);i.default=c,cc._RF.pop()},{"../../../Core/Widget":"Widget","../MonsterController":"MonsterController","./CardGroupChildTag":"CardGroupChildTag"}],CardGroupView:[function(e,t,i){"use strict";cc._RF.push(t,"b3e0fxAS1xD8YMheBN1sP0k","CardGroupView"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Window"),o=e("../MonsterController"),a=e("./CardGroupTag"),r=e("../../../GlobalContext"),s=e("../../../Core/LoadManager"),l=e("../../../Util/Utils"),c=e("../../Item/ItemData"),d=e("../../Item/ItemIcon"),p=e("../../../Core/Language"),h=e("../../../Util/AttrUtil"),u=e("../../../Global/GlobalValue"),f=cc._decorator,g=f.ccclass,y=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollView=null,t.title=null,t.itemList=null,t.textNode=null,t.levelNode=null,t.attrListNode=null,t.flagImgNode=null,t.attrIcons=null,t._cardGroupIdx=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),this.initTagList()},t.prototype.hide=function(){e.prototype.hide.call(this),this._cardGroupIdx=null},t.prototype.initTagList=function(){var e=this,t=o.default.instance.cardGroupData.getTabData();l.default.setNodeChildDestoryByUrl(this.scrollView.content,r.GlobalContext.Root+"prefab/Card/CardGroup/CardGroupTag"),s.default.instance.loadResByType(r.GlobalContext.Root+"prefab/Card/CardGroup/CardGroupTag",cc.Prefab,function(i){for(var n in t){var o=l.default.getNodeByUrl(i,r.GlobalContext.Root+"prefab/Card/CardGroup/CardGroupTag");o.active=!0,o.getComponent(a.default).setData(parseInt(n),t[n],e.onClickTag,e),e.scrollView.content.addChild(o)}e.scrollView.content.children[0].getComponent(a.default).setSelectedFlag(!0)},this)},t.prototype.onClickTag=function(e){this._cardGroupIdx=e,this.rightShow()},t.prototype.rightShow=function(){if(null!=this._cardGroupIdx){var e=o.default.instance.cardGroupData.cardGroupCfg[this._cardGroupIdx],t=e.name,i=o.default.instance.cardGroupData.cptCardGroupLevel(this._cardGroupIdx);this.title.string=t+p.default.getStr("{0}\u7ea7",i),this.setItems(e.compose),this.setOther()}},t.prototype.setItems=function(e){var t=this,i=o.default.instance.cardGroupData.cptCardGroupLevel(this._cardGroupIdx),n=o.default.instance.cardGroupData.getGroupUPLevel(this._cardGroupIdx,i+1),a=n||i;l.default.setNodeChildDestoryByUrl(this.itemList,r.GlobalContext.Root+"prefab/Bag/ItemIcon"),s.default.instance.loadResByType(r.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(i){for(var n in e){var s=l.default.getNodeByUrl(i,r.GlobalContext.Root+"prefab/Bag/ItemIcon"),h=o.default.instance.data.getCardPieceId(e[n]),u=o.default.instance.GetMonsterData(e[n]),f=c.default.creatItem(h,1);s.getComponent(d.default).ItemData(f,!0,p.default.getStr("7747",a+""),!0,!1,!(u&&u.level>=a)),t.itemList.addChild(s)}},this)},t.prototype.setOther=function(){var e=o.default.instance.cardGroupData.getCardGroupSectionFlag(this._cardGroupIdx),t=o.default.instance.cardGroupData.cptCardGroupLevel(this._cardGroupIdx),i=o.default.instance.cardGroupData.getGroupUPLevel(this._cardGroupIdx,t+1);this.setTextStr(e,i),this.setLeveStr(e,i,t),this.setAttr(e),this.setImgShow(e,i)},t.prototype.setTextStr=function(e,t){var i=p.default.getStr("cardGroup_text_06"),n=p.default.getStr("\u89e3\u9501"),a=p.default.getStr("cardGroup_text_07");if(e)t||(i=p.default.getStr("cardGroup_text_02"),n=p.default.getStr("cardGroup_text_01"),a=p.default.getStr("cardGroup_text_03"));else{var r=o.default.instance.cardGroupData.getChapter(this._cardGroupIdx),s=o.default.instance.cardGroupData.getSection(this._cardGroupIdx);i=p.default.getStr("cardGroup_text_04",r,s),n=p.default.getStr("2009"),a=p.default.getStr("cardGroup_text_05")}this.textNode.getChildByName("Label").getComponent(cc.Label).string=i,this.textNode.getChildByName("Label2").getComponent(cc.Label).string=n,this.textNode.getChildByName("Label3").getComponent(cc.Label).string=a},t.prototype.setImgShow=function(e,t){this.flagImgNode.active=!e||!t,this.flagImgNode.active&&(this.flagImgNode.getChildByName("img").active=!t,this.flagImgNode.getChildByName("img2").active=!e)},t.prototype.setLeveStr=function(e,t,i){var n=!!(e&&t&&i>0),o=p.default.getStr("cardGroup_text_08",i),a=p.default.getStr("cardGroup_text_09",i+1);this.levelNode.getChildByName("level").getComponent(cc.RichText).string=n?o:a,this.levelNode.getChildByName("node2").active=n,this.levelNode.getChildByName("level2").getComponent(cc.RichText).string=n?a:""},t.prototype.setAttr=function(e){var t=o.default.instance.cardGroupData.cptCardGroupLevel(this._cardGroupIdx),i=o.default.instance.cardGroupData.getCardGroupCfgAttr(this._cardGroupIdx,t),n=o.default.instance.cardGroupData.getCardGroupCfgAttr(this._cardGroupIdx,t+1),a=!!(e&&e&&t>0),r=(a?i.length:n.length)/2;for(var s in this.attrListNode.children){var l=this.attrListNode.children[s];if(Number(s)<r){if(a){var c=n[2*parseInt(s)],d=n[2*parseInt(s)+1];l.getChildByName("node2").children[1].getComponent(cc.Label).string=h.default.getAttrName(c)+" +"+this.getAttrStr(c,d),l.getChildByName("node2").active=!0}var p=a?i[2*parseInt(s)]:n[2*parseInt(s)],u=a?i[2*parseInt(s)+1]:n[2*parseInt(s)+1],f=h.default.getAttrIconID(p);l.getChildByName("node").children[0].getComponent(cc.Sprite).spriteFrame=this.attrIcons.getSpriteFrame("attrIcon_"+f),l.getChildByName("node").children[1].getComponent(cc.Label).string=h.default.getAttrName(p)+" +"+this.getAttrStr(p,u),l.getChildByName("node").children[1].color=a?new cc.Color(255,255,255):new cc.Color(246,255,0),l.getChildByName("node2").active=a,l.active=!0}else l.active=!1}},t.prototype.getAttrStr=function(e,t){return e>u.AttrType.WindDef?t/100+"%":t.toString()},__decorate([y(cc.ScrollView)],t.prototype,"scrollView",void 0),__decorate([y(cc.Label)],t.prototype,"title",void 0),__decorate([y(cc.Node)],t.prototype,"itemList",void 0),__decorate([y(cc.Node)],t.prototype,"textNode",void 0),__decorate([y(cc.Node)],t.prototype,"levelNode",void 0),__decorate([y(cc.Node)],t.prototype,"attrListNode",void 0),__decorate([y(cc.Node)],t.prototype,"flagImgNode",void 0),__decorate([y(cc.SpriteAtlas)],t.prototype,"attrIcons",void 0),t=__decorate([g],t)}(n.default);i.default=m,cc._RF.pop()},{"../../../Core/Language":"Language","../../../Core/LoadManager":"LoadManager","../../../Core/Window":"Window","../../../Global/GlobalValue":"GlobalValue","../../../GlobalContext":"GlobalContext","../../../Util/AttrUtil":"AttrUtil","../../../Util/Utils":"Utils","../../Item/ItemData":"ItemData","../../Item/ItemIcon":"ItemIcon","../MonsterController":"MonsterController","./CardGroupTag":"CardGroupTag"}],CardInfoLayer:[function(e,t,i){"use strict";cc._RF.push(t,"38d73ZacohL6aZdWw4Y9C+D","CardInfoLayer"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./MonsterController"),o=e("../../Core/Language"),a=e("../../Core/Widget"),r=e("../Equip/grailAttributeNode"),s=e("../../Global/GlobalValue"),l=e("../Artifact/ArtifactCtrl"),c=e("../Equip/equip/EquipCtrl"),d=e("../../Core/GameEventDispatcher"),p=e("../../Core/Event"),h=e("../../Util/Utils"),u=cc._decorator,f=u.ccclass,g=u.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.infobg=null,t.title=null,t.attributeTxt=null,t.elementList=[],t.cardData=null,t._cardID=null,t._grade=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),this.title.string=o.default.getStr("Role_7"),this.attributeTxt.string=o.default.getStr("attribute"),d.GameEventDispatcher.instance.on(p.EventDefiner.Card_updataCardInfo,this.upShow,this)},t.prototype.hide=function(){e.prototype.hide.call(this),this.cardData=null,d.GameEventDispatcher.instance.off(p.EventDefiner.Card_updataCardInfo,this.upShow,this)},t.prototype.setData=function(e,t){this._cardID=e,this._grade=t,this.upShow()},t.prototype.upShow=function(){var e=n.default.instance;this.cardData||(this.cardData=e.data);for(var t=e.GetMonsterData(this._cardID),i=(e.getIsMonsterCard(this._cardID),n.default.instance.getCardAttr(this._cardID,t.level,this._grade)),o=this.infobg.children,a=0;a<7;a++){var c=h.default.getVal(i.attr_,a);o[a].children[0].getComponent(cc.Label).string=c+""}l.default.instance.getData();var d=0;for(a=s.AttrType.ThunderAttack;a<s.AttrType.WindDef;)this.elementList[d].getComponent(r.default).setData(a,[Math.floor(i.attr_[a]),Math.floor(i.attr_[a+1])]),d+=1,a+=2},t.prototype.equipData=function(e){var t=n.default.instance.GetMonsterData(e),i=[0,0,0,0,0,0,0];if(t&&t.equip&&0!=t.equip.length){var o=c.default.instance.data.getEquipList(e),a=c.default.instance.data.getEequipWearAttr(o);for(var r in i)a[r]&&(i[r]=i[r]+a[r]);return i}return i},__decorate([g(cc.Node)],t.prototype,"infobg",void 0),__decorate([g(cc.Label)],t.prototype,"title",void 0),__decorate([g(cc.Label)],t.prototype,"attributeTxt",void 0),__decorate([g([cc.Node])],t.prototype,"elementList",void 0),t=__decorate([f],t)}(a.default);i.default=y,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/Widget":"Widget","../../Global/GlobalValue":"GlobalValue","../../Util/Utils":"Utils","../Artifact/ArtifactCtrl":"ArtifactCtrl","../Equip/equip/EquipCtrl":"EquipCtrl","../Equip/grailAttributeNode":"grailAttributeNode","./MonsterController":"MonsterController"}],CardInfo:[function(e,t,i){"use strict";cc._RF.push(t,"5ef60quJdBGzKcx8NP4NpVL","CardInfo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./WarTeam"),o=e("./MonsterController"),a=e("../../Core/Widget"),r=e("../../Util/Utils"),s=e("../../Core/WindowType"),l=e("../Commons/MonsterPreview"),c=e("../../Core/CommonsResManager"),d=e("./WarTeamMonsterInfo"),p=e("../Equip/equip/EquipCtrl"),h=e("../../Core/Language"),u=e("../Ornament/OrnamentCtrl"),f=e("../../Core/Event"),g=e("../../Core/GameEventDispatcher"),y=cc._decorator,m=y.ccclass,C=y.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.btnInfo=null,t.btnUpgrade=null,t.btnGotoBattle=null,t.fightingCapacity=null,t.cardId=null,t.cardTag=null,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this),g.GameEventDispatcher.instance.on(f.EventDefiner.itemchangeUP,this.upRed,this)},t.prototype.hide=function(){e.prototype.hide.call(this),g.GameEventDispatcher.instance.off(f.EventDefiner.itemchangeUP,this.upRed,this)},t.prototype.initInfo=function(e){this.cardId=e,n.default.instance.LineupCardId=e;for(var t=cc.find("OneLayer/Monsterpic",this.node).childrenCount-1;t>=0;t--){cc.find("OneLayer/Monsterpic",this.node).children[t].getComponent(l.default).clear(),r.default.setNodeToPool(s.PoolType.MonsterPreview,cc.find("OneLayer/Monsterpic",this.node).children[t])}var i=n.default.instance._cardConfigs.Card[this.cardId].cardType,a=o.default.instance;if(a.getIsMonsterCard(this.cardId)){var d=a.getIsLineupArr(this.cardId),p=this.btnGotoBattle.getChildByName("Label"),u=d[o.MonsterType.MonsterBattle];p.getComponent(cc.Label).string=h.default.getStr("\u4e0a\u9635"),this.btnGotoBattle.active=!u}else this.btnGotoBattle.active=!1;var f=n.default.instance._cardConfigs.Card[this.cardId].rarity,g=n.default.instance._cardConfigs.Card[this.cardId].fiveLineAttributes;cc.find("OneLayer/MonsterBg",this.node).getComponent(cc.Sprite).spriteFrame=n.default.instance.cardAtlas.getSpriteFrame("di_"+f),cc.find("OneLayer/bg",this.node).getComponent(cc.Sprite).spriteFrame=n.default.instance.cardAtlas.getSpriteFrame("di_0"+f),cc.find("OneLayer/MonsterRarity",this.node).getComponent(cc.Sprite).spriteFrame=c.default.instance.getSpriteFrameByName("rarity_"+f),cc.find("OneLayer/MonsterFiveLine",this.node).getComponent(cc.Sprite).spriteFrame=c.default.instance.getSpriteFrameByName("series"+g),cc.find("OneLayer/Red",this.node).active=this.redPointFlag();for(t=0;t<3;t++){var y=i-1==t;cc.find("OneLayer/MonsterType",this.node).children[t].active=y}this.updateInfo();var m=a.getIsMonsterCard(this.cardId);a.infoPreview(cc.find("OneLayer/Monsterpic",this.node),cc.v2(0,0),this.cardId,5,.4,-1,m)},t.prototype.updateInfo=function(){if(this.cardId){var e=o.default.instance,t=e.GetMonsterData(this.cardId),i=!(!t||!t.flag||1!=t.flag),a=e.data.getCardUPlevFlag(this.cardId);this.cardTag=d.CardTag.upgrade,this.btnUpgrade.active=!1,i||a||(a=e.data.getCardUpSkillFlag(this.cardId),this.cardTag=d.CardTag.skill),cc.find("OneLayer/MonsterLevel",this.node).getComponent(cc.Label).string=t?t.level.toString():"0",t&&!i?(this.btnUpgrade.active=a,this.btnInfo.active=!a,this.node.active=!0):(this.node.active=!0,this.btnInfo.active=!0);var r=e.GetMonsterData(this.cardId);n.default.instance._cardConfigs.Card[this.cardId].cardType;this.fightingCapacity.string=r?e.getCarFight(r.id,r.level,e.data.defaultGrade,!0,null,!1)+"":"0"}},t.prototype.btn_upgrade=function(e,t){this.btnUpgrade.active&&(t=this.cardTag);var i=o.default.instance;i.getIsMonsterCard(this.cardId)||(t=d.CardTag.skill),i.openMonsterInfoPrefab(this.cardId,t)},t.prototype.btn_Lineup=function(){n.default.instance.cheakInit()&&n.default.instance.clickShowCard(),n.default.instance.LineupCardId=this.cardId,n.default.instance.cancelLineup(!0),this.node.active=!1,n.default.instance.clickRightChane=!0,n.default.instance.effect.active=!0,n.default.instance.inChange=!0,n.default.instance.clickCardGoBattle(this.cardId)},t.prototype.btn_close=function(){n.default.instance.listViewCtrl.items.forEach(function(e){e.getComponent("MonsterCard").cancelInfo()}),this.node.active=!1},t.prototype.redPointFlag=function(){var e=o.default.instance;return!(!e.getIsLineup(this.cardId)||!(e.data.getCardUPlevFlag(this.cardId)||e.data.getCardUpSkillFlag(this.cardId)||p.default.instance.data.getEquipFlag(this.cardId)||p.default.instance.data.getEquipWearFlag(this.cardId)||u.default.instance.data.getCardOrnamentFlag(this.cardId)))},t.prototype.newCard_Lineup=function(){this.btn_Lineup()},t.prototype.upRed=function(){cc.find("OneLayer/Red",this.node).active=this.redPointFlag()},__decorate([C(cc.Node)],t.prototype,"btnInfo",void 0),__decorate([C(cc.Node)],t.prototype,"btnUpgrade",void 0),__decorate([C(cc.Node)],t.prototype,"btnGotoBattle",void 0),__decorate([C(cc.Label)],t.prototype,"fightingCapacity",void 0),t=__decorate([m],t)}(a.default);i.default=v,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../Util/Utils":"Utils","../Commons/MonsterPreview":"MonsterPreview","../Equip/equip/EquipCtrl":"EquipCtrl","../Ornament/OrnamentCtrl":"OrnamentCtrl","./MonsterController":"MonsterController","./WarTeam":"WarTeam","./WarTeamMonsterInfo":"WarTeamMonsterInfo"}],CardItem:[function(e,t,i){"use strict";cc._RF.push(t,"9b27cs06Q1GOqDWk+sOpqRX","CardItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Core/CommonsResManager"),a=e("../../Item/ItemData"),r=e("../MonsterController"),s=e("../../Item/ItemIcon"),l=cc._decorator,c=l.ccclass,d=l.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.item=null,t.qualityImg=null,t.level=null,t.lockNode=null,t}return __extends(t,e),t.prototype.setData=function(e,t){var i=r.default.instance.data.getCardPieceId(e),n=a.default.creatItem(i);this.item.getComponent(s.default).ItemData(n,!1,null,!0),this.item.getChildByName("ItemIcon")&&(this.item.getChildByName("ItemIcon").getChildByName("debris").active=!1),this.qualityImg.spriteFrame=o.default.instance.getSpriteFrameByName("rarity_"+(n.colorIndex+1)),this.level.string=t.toString(),this.lockNode.active=!r.default.instance.getIsMonsterCard(e)},__decorate([d(cc.Node)],t.prototype,"item",void 0),__decorate([d(cc.Sprite)],t.prototype,"qualityImg",void 0),__decorate([d(cc.Label)],t.prototype,"level",void 0),__decorate([d(cc.Node)],t.prototype,"lockNode",void 0),t=__decorate([c],t)}(n.default);i.default=p,cc._RF.pop()},{"../../../Core/CommonsResManager":"CommonsResManager","../../../Core/Widget":"Widget","../../Item/ItemData":"ItemData","../../Item/ItemIcon":"ItemIcon","../MonsterController":"MonsterController"}],CardNews:[function(e,t,i){"use strict";cc._RF.push(t,"8ad22SMMWJJ7rXYDAplLmAA","CardNews"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/ConfigsManager"),a=e("../../Util/Utils"),r=e("../../Core/WindowType"),s=e("./MonsterController"),l=e("../Commons/MonsterPreview"),c=e("../../Global/GlobalValue"),d=e("../../Core/CommonsResManager"),p=e("../Commons/Image"),h=e("./CardUtils"),u=cc._decorator,f=u.ccclass,g=u.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.monsterBg=null,t.bg=null,t.monsterpic=null,t.monsterRarity=null,t.stance=null,t.monsterFiveLine=null,t.monsterLevel=null,t.notGet=null,t._cardConfigs=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this._cardConfigs=o.ConfigsManager.instance.getConfigs("cardConf")},t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.hide=function(){if(e.prototype.hide.call(this),this.monsterpic.childrenCount){var t=this.monsterpic.getComponentInChildren(l.default);t.clear(),a.default.setNodeToPool(r.PoolType.MonsterPreview,t.node)}this.isCanClick&&(this.isCanClick=null,this.node.off(cc.Node.EventType.TOUCH_END,this.onClick,this)),this.id=null},t.prototype.onClick=function(){h.default.instance.jumpCardInfo(this.id)},t.prototype.setData=function(e,t){if(void 0===t&&(t=!1),"number"==typeof e)this.notGet.active=!0,this.monsterBg.getComponent(p.default).updateBg("resources/warTeam/di_1.png"),this.bg.getComponent(p.default).updateBg("resources/warTeam/di_01.png"),this.stance.getComponent(cc.Sprite).spriteFrame=d.default.instance.getSpriteFrameByName("stance_"+e),this.monsterRarity.getComponent(cc.Sprite).spriteFrame=d.default.instance.getSpriteFrameByName("rarity_1"),this.monsterFiveLine.getComponent(cc.Sprite).spriteFrame=null,this.monsterLevel.getComponent(cc.Label).string="0";else{this.notGet.active=!1;var i=e.id,n=e.level;this.isCanClick=t,this.id=i,this.isCanClick&&this.node.on(cc.Node.EventType.TOUCH_END,this.onClick,this);var o=this._cardConfigs.Card[i];if(!this.monsterpic.childrenCount){var h=a.default.getNodeByPool(r.PoolType.MonsterPreview,s.default.instance.MonsterPreview);this.monsterpic.addChild(h)}this.monsterpic.getComponentInChildren(l.default).init("monster",i,5,c.DEFAULTS_SKIN+5,c.PRIORITY.MONSTER),this.monsterBg.getComponent(p.default).updateBg("resources/warTeam/di_"+o.rarity+".png"),this.bg.getComponent(p.default).updateBg("resources/warTeam/di_0"+o.rarity+".png"),this.stance.getComponent(cc.Sprite).spriteFrame=d.default.instance.getSpriteFrameByName("stance_"+o.cardType),this.monsterRarity.getComponent(cc.Sprite).spriteFrame=d.default.instance.getSpriteFrameByName("rarity_"+o.rarity),this.monsterFiveLine.getComponent(cc.Sprite).spriteFrame=d.default.instance.getSpriteFrameByName("series"+o.fiveLineAttributes),this.monsterLevel.getComponent(cc.Label).string=""+n}},__decorate([g(cc.Node)],t.prototype,"monsterBg",void 0),__decorate([g(cc.Node)],t.prototype,"bg",void 0),__decorate([g(cc.Node)],t.prototype,"monsterpic",void 0),__decorate([g(cc.Node)],t.prototype,"monsterRarity",void 0),__decorate([g(cc.Node)],t.prototype,"stance",void 0),__decorate([g(cc.Node)],t.prototype,"monsterFiveLine",void 0),__decorate([g(cc.Node)],t.prototype,"monsterLevel",void 0),__decorate([g(cc.Node)],t.prototype,"notGet",void 0),t=__decorate([f],t)}(n.default);i.default=y,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/ConfigsManager":"ConfigsManager","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../Util/Utils":"Utils","../Commons/Image":"Image","../Commons/MonsterPreview":"MonsterPreview","./CardUtils":"CardUtils","./MonsterController":"MonsterController"}],CardRecommendOfficialItem:[function(e,t,i){"use strict";cc._RF.push(t,"a8424s+blZENqjtmnoKBk8K","CardRecommendOfficialItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/LoadManager"),a=e("../../GlobalContext"),r=e("../../Util/Utils"),s=e("../../Core/WindowType"),l=e("../../Core/Language"),c=cc._decorator,d=c.ccclass,p=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.img=null,t.content=null,t.group1=null,t.group2=null,t.i18nAtlas=null,t.i18ns=["i18n_gftj","i18n_sgtg","i18n_zdzl"],t.str=["7504","7502","7502"],t}return __extends(t,e),t.prototype.hide=function(){e.prototype.hide.call(this);for(var t=this.content.childrenCount-1;t>=0;t--)r.default.setNodeToPool(s.PoolType.CardNews,this.content.children[t])},t.prototype.setContent=function(e,t,i){var n=this;this.img.spriteFrame=this.i18nAtlas.getSpriteFrame(this.i18ns[t]),this.group1.active=0!=t,this.group2.active=0==t;var c=this.group2;0!=t&&(c=this.group1),e?(c.getComponentInChildren(cc.Label).string=i,o.default.instance.loadResByType(a.GlobalContext.Root+"prefab/WarTeam/CardNews",cc.Prefab,function(t){for(var i in e){var o=r.default.getNodeByPool(s.PoolType.CardNews,t,a.GlobalContext.Root+"prefab/WarTeam/CardNews");n.content.addChild(o),o.getComponent("CardNews").setData(e[i],!0)}},this)):(c.getComponentInChildren(cc.Label).string=l.default.getStr(this.str[t]),o.default.instance.loadResByType(a.GlobalContext.Root+"prefab/WarTeam/CardNews",cc.Prefab,function(e){for(var t=1;t<=3;t++){var i=r.default.getNodeByPool(s.PoolType.CardNews,e,a.GlobalContext.Root+"prefab/WarTeam/CardNews");n.content.addChild(i),i.getComponent("CardNews").setData(t,!0)}},this))},__decorate([p(cc.Sprite)],t.prototype,"img",void 0),__decorate([p(cc.Node)],t.prototype,"content",void 0),__decorate([p(cc.Node)],t.prototype,"group1",void 0),__decorate([p(cc.Node)],t.prototype,"group2",void 0),__decorate([p(cc.SpriteAtlas)],t.prototype,"i18nAtlas",void 0),t=__decorate([d],t)}(n.default);i.default=h,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils"}],CardRecommendOfficialWin:[function(e,t,i){"use strict";cc._RF.push(t,"7027euDuKFPAI6vTTKB28fl","CardRecommendOfficialWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Commons/CommonPageBG"),o=e("../../Core/Language"),a=e("../WarTeam/MonsterController"),r=e("../../Core/LoadManager"),s=e("../../GlobalContext"),l=e("../../Util/Utils"),c=e("../../Core/WindowType"),d=e("./CardRecommendOfficialItem"),p=cc._decorator,h=p.ccclass,u=p.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.onInit(774,645,o.default.getStr("7500"),!1)},t.prototype.show=function(){e.prototype.show.call(this),this.updateData()},t.prototype.hide=function(){e.prototype.hide.call(this);for(var t=this.content.childrenCount-1;t>=0;t--)l.default.setGrayEffect(this.content.children[t],!0),l.default.setNodeToPool(c.PoolType.CardRecommendOfficialItem,this.content.children[t])},t.prototype.updateData=function(){var e=this,t=a.default.instance.firstPass,i=a.default.instance.firstPass;r.default.instance.loadResByType(s.GlobalContext.Root+"prefab/WarTeam/CardNews",cc.Prefab,function(n){r.default.instance.loadResByType(s.GlobalContext.Root+"prefab/Card/CardRecommendOfficialItem",cc.Prefab,function(n){for(var o,r=a.default.instance.getRecommendCards(),p=0;p<=2;p++){var h=void 0,u=void 0;switch(o=l.default.getNodeByPool(c.PoolType.CardRecommendOfficialItem,n,s.GlobalContext.Root+"prefab/Card/CardRecommendOfficialItem"),p){case 0:for(var f in h=[],u=r[0].text,r)h.push({id:r[f].cardId,level:r[f].lv});break;case 1:t&&(h=t.card,u=t.info.name);break;default:i&&(u=i.info.name,h=i.card)}e.content.addChild(o),o.getComponent(d.default).setContent(h,p,u),l.default.setGrayEffect(o,!!h)}},e)},this)},__decorate([u(cc.Node)],t.prototype,"content",void 0),t=__decorate([h],t)}(n.default);i.default=f,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/CommonPageBG":"CommonPageBG","../WarTeam/MonsterController":"MonsterController","./CardRecommendOfficialItem":"CardRecommendOfficialItem"}],CardRecommendedVo:[function(e,t,i){"use strict";cc._RF.push(t,"02320kokIVEIaNF3pLfKGZA","CardRecommendedVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){return function(){}}();i.CardRecommendedVo=n,cc._RF.pop()},{}],CardRecommended:[function(e,t,i){"use strict";cc._RF.push(t,"88f92ImQ3FLC5jdllXPkSax","CardRecommended"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Commons/CommonPageBG"),o=e("../../Core/Language"),a=e("../WarTeam/MonsterController"),r=e("../../Core/ConfigsManager"),s=e("../../Core/LoadManager"),l=e("../../GlobalContext"),c=e("../../Util/Utils"),d=e("./RecommendItem"),p=e("../../Core/GameEventDispatcher"),h=e("./UltimateTeamItem"),u=cc._decorator,f=u.ccclass,g=u.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.currContent=null,t.ultimateTeam=null,t.toggle=null,t.toggle2=null,t.rightBtnNode=null,t.leftBtnNode=null,t.conf=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.conf=r.ConfigsManager.instance.getConfigs("cardRemmendconf")},t.prototype.show=function(){e.prototype.show.call(this),this.onInit(936,636,o.default.getStr("\u5361\u724c\u63a8\u8350"),!0),this.isUltimateTeam()?this.toggle2.isChecked=!0:this.toggle.isChecked=!0,this.inIt(),this.moveBtnClick(null,null,this.isGetUltimateTeam()),p.GameEventDispatcher.instance.on("CloseRecommend",this.onClose,this)},t.prototype.hide=function(){e.prototype.hide.call(this),p.GameEventDispatcher.instance.off("CloseRecommend",this.onClose,this)},t.prototype.inIt=function(){var e=this,t=a.default.instance.GetMyCardRarity(),i=a.default.instance.getRecommendCards();this.toggle.isChecked?(this.currContent.node.active=!0,this.ultimateTeam.node.active=!1,c.default.setNodeChildDestoryByUrl(this.currContent.content,l.GlobalContext.Root+"prefab/CardRecommend/RecommendItem"),s.default.instance.loadResByType(l.GlobalContext.Root+"prefab/CardRecommend/RecommendItem",cc.Prefab,function(n){for(var o,r,s,p,h=0;h<t.length;h++)t[h]&&(o=i[h].cardId,r=c.default.getNodeByUrl(n,l.GlobalContext.Root+"prefab/CardRecommend/RecommendItem"),s=a.default.instance.baseNews[o],p=a.default.instance.GetMonsterInfo(o),t[h].rarity>=p.rarity&&(s=e.conf.remmend[t[h].rarity][h],p=a.default.instance.GetMonsterInfo(s.cardID)),r.getComponent(d.default).Init(p.rarity,p.cardType,p.cardFamilyName,s.path,s.describe,s.itemID,s.windID),e.currContent.content.addChild(r))},this)):(this.currContent.node.active=!1,this.ultimateTeam.node.active=!0,c.default.setNodeChildDestoryByUrl(this.ultimateTeam.content,l.GlobalContext.Root+"prefab/CardRecommend/page_1"),this.ultimateTeam.removeAllPages(),s.default.instance.loadResByType(l.GlobalContext.Root+"prefab/CardRecommend/page_1",cc.Prefab,function(t){for(var i=0;i<3;i++){var n=c.default.getNodeByUrl(t,l.GlobalContext.Root+"prefab/CardRecommend/page_1");e.ultimateTeam.insertPage(n,i);var o=e.conf.remmend[7][i],r=a.default.instance.GetMonsterInfo(o.cardID);n.getComponent(h.default).Init(r.rarity,r.cardType,r.cardFamilyName,o.describe,o.path,o.cardID,o.windID)}e.moveBtnClick(null,null,e.isGetUltimateTeam())},this))},t.prototype.isUltimateTeam=function(){var e=a.default.instance.GetMyCardRarity();for(var t in e)if(e[t].rarity<5)return!1;return!0},t.prototype.isGetUltimateTeam=function(){var e=a.default.instance.GetMyCardRarity();for(var t in e)if(Number(t)<e.length-1){if(e[t].rarity<6&&0==Number(t))return t;if(6==e[t].rarity&&e[Number(t)+1].rarity<6)return Number(t)+1}else if(e[t].rarity<6)return t;return 0},t.prototype.moveBtnClick=function(e,t,i){var n=i?Number(i):this.ultimateTeam.getCurrentPageIndex();1==Number(t)?n++:2==Number(t)&&n--,this.ultimateTeam.scrollToPage(n,.5),this.rightBtnNode.active=!(2==n),this.leftBtnNode.active=!(0==n)},__decorate([g(cc.ScrollView)],t.prototype,"currContent",void 0),__decorate([g(cc.PageView)],t.prototype,"ultimateTeam",void 0),__decorate([g(cc.Toggle)],t.prototype,"toggle",void 0),__decorate([g(cc.Toggle)],t.prototype,"toggle2",void 0),__decorate([g(cc.Node)],t.prototype,"rightBtnNode",void 0),__decorate([g(cc.Node)],t.prototype,"leftBtnNode",void 0),t=__decorate([f],t)}(n.default);i.default=y,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/CommonPageBG":"CommonPageBG","../WarTeam/MonsterController":"MonsterController","./RecommendItem":"RecommendItem","./UltimateTeamItem":"UltimateTeamItem"}],CardSkillData:[function(e,t,i){"use strict";cc._RF.push(t,"9db58H2lcRONZKTfS1qu3l8","CardSkillData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../MonsterController"),o=e("../../Scene/Controller/SkillController"),a=function(){function e(){this._cardCfg=null,this._skillCfg=null,this._cardCfg=n.default.instance.data.getCardCfg(),this._skillCfg=o.default.instance.skillConfigs}return e.prototype.getBaseSkillList=function(e){return this._cardCfg.Card[e].skillId},e.prototype.getBigSkillList=function(e){var t=n.default.instance.GetMonsterData(e),i=!t||t.grade<=3?4:t.grade-1;return this._cardCfg.grade[this._cardCfg.Card[e].grade][i].bigSkill},e.prototype.getSkillMaxLevel=function(e){return this._skillCfg.skillconf[e].maxSkillLevel},e.prototype.getSkillUnlockLevel=function(e){var t=o.default.instance.getSkillBySkillId(e);return this._skillCfg.levelConf[t.levelConf][0].unlockStage},e.prototype.getGoldNum=function(e,t){var i=o.default.instance.getSkillBySkillIdAndLv(e,t);return this._skillCfg.consume[i.consume].amount},e.prototype.getSkillLev=function(e,t){var i=n.default.instance.GetMonsterData(e),o=0;if(i&&i.skill)for(var a=0;a<i.skill.length;a++)t==i.skill[a].id&&(o=i.skill[a].level);return o},e}();i.default=a,cc._RF.pop()},{"../../Scene/Controller/SkillController":"SkillController","../MonsterController":"MonsterController"}],CardSkillItem:[function(e,t,i){"use strict";cc._RF.push(t,"2d454FLXgJGeLq7Wo6jtKnN","CardSkillItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../MonsterController"),a=e("../../../Core/SimpleActionEffect"),r=e("../../Role/RoleController"),s=e("../../../Global/GlobalValue"),l=e("../../Equip/equip/EquipCtrl"),c=cc._decorator,d=c.ccclass,p=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.selectedImg=null,t.skillImg=null,t.lockNode=null,t.skillLevel=null,t.redPointNode=null,t.effectNode=null,t}return __extends(t,e),t.prototype.setData=function(e,t,i,n,a){void 0===n&&(n=!1),void 0===a&&(a=5);var c=0,d=o.default.instance;if((c=n?5==a?2:1:d.CardSkillData.getSkillLev(e,t))>0){var p=l.default.instance.data.getEquipEffectAddAttr(e),h=d.CardSkillData.getSkillMaxLevel(t),u=0;p[100*t]&&(u=p[100*t]),p[i]&&(u=p[i]),c=h<(c+=u)?h:c}this.skillLevel.string=c.toString(),d.setSkillPic(t,this.skillImg),this.lockNode.active=!(c>0);var f=!1,g=d.GetMonsterData(e);g&&o.default.instance.getIsLineup(e)&&!n&&c<g.level&&c<d.CardSkillData.getSkillMaxLevel(t)&&d.CardSkillData.getSkillUnlockLevel(t)<=g.level&&r.default.instance.GetMyWealth(s.WealthType.Money)>=d.CardSkillData.getGoldNum(t,c+1)&&(f=!0),this.redPointNode.active=f},t.prototype.setSelectedFlag=function(e){this.selectedImg.active=e},t.prototype.playEffect=function(){this.effectNode.getComponent(a.default).playById(5,"upSKIllEffect",!1,null,this)},__decorate([p(cc.Node)],t.prototype,"selectedImg",void 0),__decorate([p(cc.Sprite)],t.prototype,"skillImg",void 0),__decorate([p(cc.Node)],t.prototype,"lockNode",void 0),__decorate([p(cc.Label)],t.prototype,"skillLevel",void 0),__decorate([p(cc.Node)],t.prototype,"redPointNode",void 0),__decorate([p(cc.Node)],t.prototype,"effectNode",void 0),t=__decorate([d],t)}(n.default);i.default=h,cc._RF.pop()},{"../../../Core/SimpleActionEffect":"SimpleActionEffect","../../../Core/Widget":"Widget","../../../Global/GlobalValue":"GlobalValue","../../Equip/equip/EquipCtrl":"EquipCtrl","../../Role/RoleController":"RoleController","../MonsterController":"MonsterController"}],CardSkill:[function(e,t,i){"use strict";cc._RF.push(t,"67c402fhTVLNYXtXw7NwTJL","CardSkill"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../MonsterController"),a=e("../../../Core/GameEventDispatcher"),r=e("../../../Core/Event"),s=e("../../Scene/Controller/SkillController"),l=e("../../Role/RoleController"),c=e("../../../Global/GlobalValue"),d=e("../../../Core/Language"),p=e("../../Tips/OpTipsController"),h=e("../../Role/RoleStrengthen/RoleStrengthenController"),u=e("../../Role/RoleStrengthen/RoleStrengthenEvent"),f=e("../../Sound/SoundController"),g=e("./CardSkillItem"),y=e("../../Equip/equip/EquipCtrl"),m=cc._decorator,C=m.ccclass,v=m.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.skillListNode=null,t.skillName=null,t.bigSkillFlagNode=null,t.skillDesc=null,t.upSkillNode=null,t.goldNum=null,t.goldNode=null,t.unlockNode=null,t.unlockStr=null,t.upSkillStr=null,t.upSkillBtnNode=null,t.onclickSkillIndex=1,t.cardId=0,t.cfg=null,t.isupskill=null,t.num=0,t.baseSkillList=[],t.bigSkillID=null,t.skillList=[],t.grade=5,t}return __extends(t,e),t.prototype.setCarId=function(e,t){if(this.cardId!=e){this.cardId=e,this.grade=t,this.cfg||(this.cfg=o.default.instance.data.getCardCfg()),this.resetSkillData();var i=o.default.instance;this.baseSkillList=i.CardSkillData.getBaseSkillList(this.cardId),this.bigSkillID=i.CardSkillData.getBigSkillList(this.cardId),this.skillList.push(this.bigSkillID),this.skillList=this.skillList.concat(this.baseSkillList),this.onClickSkill(null,1)}},t.prototype.show=function(){e.prototype.show.call(this),a.GameEventDispatcher.instance.on(r.EventDefiner.Card_updataCardInfo,this.updataCardInfo,this)},t.prototype.hide=function(){e.prototype.hide.call(this),this.cardId=0,this.cfg=null,this.isupskill=null,this.num=0,this.grade=5,this.resetSkillData(),a.GameEventDispatcher.instance.off(r.EventDefiner.Card_updataCardInfo,this.updataCardInfo,this)},t.prototype.resetSkillData=function(){this.onclickSkillIndex=1,this.baseSkillList=[],this.bigSkillID=null,this.skillList=[];for(var e=0;e<this.skillListNode.children.length;e++)this.skillListNode.children[e].active=!1},t.prototype.setSkillListData=function(){for(var e=0;e<this.skillList.length;++e){var t=this.skillListNode.children[e];t.getComponent(g.default).setData(this.cardId,this.skillList[e],this.getSkillAttrType(e),0==e,this.grade),t.active=!0}},t.prototype.upShow=function(){!this.cfg&&this.cardId<=0||(this.setSkillListData(),this.setSkillDesc(this.skillList[this.onclickSkillIndex],this.getSkillAttrType(this.onclickSkillIndex),0==this.onclickSkillIndex),this.setOther(this.skillList[this.onclickSkillIndex],0==this.onclickSkillIndex))},t.prototype.onClickSkill=function(e,t){for(var i in this.onclickSkillIndex=Number(t),this.skillListNode.children)this.skillListNode.children[i].getComponent(g.default).setSelectedFlag(Number(t)==parseInt(i));this.upShow()},t.prototype.btn_skillUpgrade=function(){var e=o.default.instance,t=e.GetMonsterData(this.cardId);if(!(!t||!t.flag||1!=t.flag))p.default.instance.ShowMsg(d.default.getStr("\u4e34\u65f6\u5361\u724c\u65e0\u6cd5\u63d0\u5347\u6280\u80fd\u7b49\u7ea7"));else{var i=s.default.instance.skillConfigs,n=s.default.instance.getSkillBySkillId(this.skillList[this.onclickSkillIndex]);if(i.levelConf[n.levelConf][0].unlockStage>t.level)p.default.instance.ShowMsg(d.default.getStr("\u5361\u724c\u7b49\u7ea7\u8fc7\u4f4e\uff0c\u8bf7\u5148\u5347\u7ea7"));else{var a=e.CardSkillData.getSkillLev(this.cardId,this.skillList[this.onclickSkillIndex]);if(i.skillconf[this.skillList[this.onclickSkillIndex]].maxSkillLevel&&a<i.skillconf[this.skillList[this.onclickSkillIndex]].maxSkillLevel){var r=s.default.instance.getSkillBySkillIdAndLv(this.skillList[this.onclickSkillIndex],a+1);if(l.default.instance.GetMyWealth(c.WealthType.Money)<i.consume[r.consume].amount)return void p.default.instance.ShowMsg(d.default.getStr("tishi3"));if(a>=e.GetMonsterData(this.cardId).level){p.default.instance.ShowMsg(d.default.getStr("\u8bf7\u63d0\u5347\u5361\u724c\u7b49\u7ea7"));var f=this.onclickSkillIndex+1>this.skillList.length-1?1:this.onclickSkillIndex+1;return this.num+=1,void this.setSHowData(f)}a&&h.default.instence.setImgState(u.RoleImgType.Upgrade),e.SendCardSkillUpgrade(this.cardId,this.skillList[this.onclickSkillIndex]),this.isupskill=!0}}}},t.prototype.updataCardInfo=function(){f.default.instance.PlayEffect(f.SoundType.upSucceeds),this.upSkillEffect(),this.upShow()},t.prototype.upSkillEffect=function(){this.isupskill&&(this.skillListNode.children[this.onclickSkillIndex].getComponent(g.default).playEffect(),this.isupskill=!1)},t.prototype.setSHowData=function(e){if(this.num>=this.baseSkillList.length)this.num=0;else{var t=0,i=o.default.instance,n=i.GetMonsterData(this.cardId);s.default.instance.getSkillUnlockFlag(this.skillList[e],n.level)||(e=e+1>this.skillList.length-1?1:e+1);for(var a=i.GetMonsterData(this.cardId),r=0;r<a.skill.length;r++)if(this.skillList[e]==a.skill[r].id){t=a.skill[r].level;break}var d=s.default.instance.skillConfigs,p=s.default.instance.getSkillBySkillIdAndLv(this.skillList[e],t+1);l.default.instance.GetMyWealth(c.WealthType.Money)<d.consume[p.consume].amount||(t<d.skillconf[this.skillList[e]].maxSkillLevel&&s.default.instance.getSkillUnlockFlag(this.skillList[e],n.level)&&t<n.level?this.onClickSkill(null,e):(this.num+=1,e=e+1>this.skillList.length-1?1:e+1,this.setSHowData(e)))}},t.prototype.onCardSet=function(){var e=o.default.instance.GetMonsterData(this.cardId),t=!0;return(!e||0==this.onclickSkillIndex||e&&e.flag&&1==e.flag)&&(t=!1),t},t.prototype.setSkillDesc=function(e,t,i){void 0===i&&(i=!1);var n=s.default.instance.getSkillBySkillId(e),a=o.default.instance.GetMonsterData(this.cardId),r=n.name;r.length>5&&(r=r.substring(0,6));var l=0,c=0,p=o.default.instance;i?c=l=5==this.grade?2:1:(l=p.CardSkillData.getSkillLev(this.cardId,e),c=p.CardSkillData.getSkillMaxLevel(e));var h=l;if(h>0){var u=y.default.instance.data.getEquipEffectAddAttr(this.cardId),f=p.CardSkillData.getSkillMaxLevel(e),g=0;u[100*e]&&(g=u[100*e]),u[t]&&(g=u[t]),h=f<(h+=g)?f:h}this.skillName.string=r+" "+d.default.getStr("LV\uff1a{0}/{1}",h,c),this.bigSkillFlagNode.active=i;var m=!0;0!=this.onclickSkillIndex&&(m=s.default.instance.getSkillUnlockFlag(e,a?a.level:0));var C=m&&s.default.instance.getSkillBySkillIdAndLv(e,0==this.onclickSkillIndex?1:l)?s.default.instance.getSkillDescBySkillIdAndLv(e,0==this.onclickSkillIndex?1:l):d.default.getStr("\u6280\u80fd\u672a\u89e3\u9501");if(0!=this.onclickSkillIndex&&!s.default.instance.getSkillBySkillIdAndLv(e,l)){C+="\n";var v=s.default.instance.getSkillDescBySkillIdAndLv(e,l+1);C+=v=v.substring(0,v.indexOf("\u4e0b\u4e00\u7ea7"))}this.skillDesc.string=C},t.prototype.setOther=function(e,t){void 0===t&&(t=!1);var i=this.onCardSet();this.upSkillNode.active=i;var n=o.default.instance.GetMonsterData(this.cardId);if(i){var a=!0;if(0!=this.onclickSkillIndex&&(a=s.default.instance.getSkillUnlockFlag(e,n?n.level:0)),this.unlockNode.active=!a,this.upSkillBtnNode.getComponent(cc.Button).interactable=a,this.goldNode.active=a,this.upSkillStr.string=d.default.getStr("\u89e3\u9501"),a){var r=0,p=0;if(t?p=r=5==this.grade?2:1:(r=o.default.instance.CardSkillData.getSkillLev(this.cardId,e),p=o.default.instance.CardSkillData.getSkillMaxLevel(e)),r<p){var h=o.default.instance.CardSkillData.getGoldNum(e,r+1);this.goldNum.string=h,this.goldNum.node.color=h>l.default.instance.GetMyWealth(c.WealthType.Money)?new cc.Color(255,0,0):new cc.Color(48,24,16)}else if(this.goldNum.string="",this.upSkillBtnNode.getComponent(cc.Button).interactable=!1,0!=this.onclickSkillIndex){var u=this.onclickSkillIndex+1>this.skillList.length-1?1:this.onclickSkillIndex+1;this.num+=1,this.setSHowData(u)}n&&s.default.instance.getSkillBySkillIdAndLv(e,r)&&(this.upSkillStr.string=d.default.getStr("\u5347\u7ea7"))}else this.unlockStr.string=d.default.getStr("{0}\u7ea7\u53ef\u89e3\u9501",o.default.instance.CardSkillData.getSkillUnlockLevel(e)),this.upSkillStr.string=d.default.getStr("\u89e3\u9501")}},t.prototype.getSkillAttrType=function(e){var t=-1;switch(e-1){case 0:t=c.AttrType.SkillOne;break;case 1:t=c.AttrType.SkillTwo;break;case 2:t=c.AttrType.SkillThree}return t},__decorate([v(cc.Node)],t.prototype,"skillListNode",void 0),__decorate([v(cc.Label)],t.prototype,"skillName",void 0),__decorate([v(cc.Node)],t.prototype,"bigSkillFlagNode",void 0),__decorate([v(cc.RichText)],t.prototype,"skillDesc",void 0),__decorate([v(cc.Node)],t.prototype,"upSkillNode",void 0),__decorate([v(cc.Label)],t.prototype,"goldNum",void 0),__decorate([v(cc.Node)],t.prototype,"goldNode",void 0),__decorate([v(cc.Node)],t.prototype,"unlockNode",void 0),__decorate([v(cc.Label)],t.prototype,"unlockStr",void 0),__decorate([v(cc.Label)],t.prototype,"upSkillStr",void 0),__decorate([v(cc.Node)],t.prototype,"upSkillBtnNode",void 0),t=__decorate([C],t)}(n.default);i.default=_,cc._RF.pop()},{"../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Core/Widget":"Widget","../../../Global/GlobalValue":"GlobalValue","../../Equip/equip/EquipCtrl":"EquipCtrl","../../Role/RoleController":"RoleController","../../Role/RoleStrengthen/RoleStrengthenController":"RoleStrengthenController","../../Role/RoleStrengthen/RoleStrengthenEvent":"RoleStrengthenEvent","../../Scene/Controller/SkillController":"SkillController","../../Sound/SoundController":"SoundController","../../Tips/OpTipsController":"OpTipsController","../MonsterController":"MonsterController","./CardSkillItem":"CardSkillItem"}],CardStageData:[function(e,t,i){"use strict";cc._RF.push(t,"4f51d87AMpHcrZTdn7ng72F","CardStageData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/ConfigsManager"),o=e("../MonsterController"),a=e("../../../Global/GlobalValue"),r=e("../../../Util/Utils"),s=function(){function e(){this._cardstageCfg=null}return Object.defineProperty(e.prototype,"cardstageCfg",{get:function(){return this._cardstageCfg||(this._cardstageCfg=n.ConfigsManager.instance.getConfigs("cardstageConf")),this._cardstageCfg},enumerable:!0,configurable:!0}),e.prototype.getPotential=function(e,t){var i=this.cardstageCfg.potential[e];for(var n in i)if(i[n].needLv&&i[n].needLv==t)return i[n]},e.prototype.getPotentialCfg=function(e,t){var i=this.cardstageCfg.potential[e];for(var n in i)if(i[n].needLv&&i[n].needLv>t)return i[n];return null},e.prototype.getAllPotentialByCardId=function(e){return this.cardstageCfg.potential[e]},e.prototype.getPotentialDesc=function(e){return this.cardstageCfg.potentialDesc[e]},e.prototype.getPotentialAttr=function(e){return{}},e.prototype.getCardPotentialAttr=function(e,t){return{}},e.prototype.hasCardPotentialByType=function(e,t){if(-1==o.MonsterType.MonsterWarTeam[o.MonsterType.MonsterBattle].indexOf(e))return!1;for(var i=o.default.instance.GetMonsterData(e),n=0;n<i.level;++n){var a=this.getPotential(e,n+1);if(a){var r=this.getPotentialAttr(a.attr);for(var s in r){if(parseInt(s)==t)return!0}}}return!1},e.prototype.getCardPotential=function(e){var t={},i=o.MonsterType.MonsterWarTeam[o.MonsterType.MonsterBattle];for(var n in i){var s=parseInt(i[n]);if(s>0)for(var l=o.default.instance.GetMonsterData(s),c=0;c<l.level;++c){var d=this.getPotential(parseInt(i[n]),c);if(d){var p=this.getPotentialAttr(d.attr);for(var h in p){var u=parseInt(h);u<=a.AttrType.WindDef&&e==u&&r.default.setAttrMap(t,u,p[h]?p[h]:0)}}}}return t},e.prototype.getlineFive=function(e,t){return this.cardstageCfg.lineFive[e][t-1]},e.prototype.getPotentialNum=function(e,t){var i=0,n=this.cardstageCfg.potential[e];if(n){for(var o in n)n[o].needLv&&n[o].needLv<=t&&++i;return i}},e.prototype.getCardMaxLevel=function(e){return this.cardstageCfg.stage[e][0].maxLevel},e}();i.default=s,cc._RF.pop()},{"../../../Core/ConfigsManager":"ConfigsManager","../../../Global/GlobalValue":"GlobalValue","../../../Util/Utils":"Utils","../MonsterController":"MonsterController"}],CardStage:[function(e,t,i){"use strict";cc._RF.push(t,"80ba1YvcYlClI8UlEvrK/zF","CardStage"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Core/GameEventDispatcher"),a=e("../../../Core/Event"),r=e("../MonsterController"),s=e("../../../Util/AttrUtil"),l=e("../../../Util/Utils"),c=e("../../../GlobalContext"),d=e("../../Item/ItemData"),p=e("../../Item/ItemModel"),h=e("../../Role/RoleInfo"),u=e("../../../Core/LoadManager"),f=e("../../Item/ItemIcon"),g=e("../../../Core/Language"),y=e("../../OpenWin/OpenWinController"),m=e("../../../Core/WindowType"),C=e("../../Tips/PotentialTips"),v=e("../../Tips/OpTipsController"),_=e("../../../Util/RechargeUtils"),b=e("../../../Util/RechargeConst"),T=e("../../Sound/SoundController"),S=e("../../../Util/NumberUtil"),I=e("../../Guide/GuideNewController"),w=e("../../Tips/TipsWinController"),D=e("../../Equip/equip/EquipCtrl"),R=e("../../../Global/GlobalValue"),A=cc._decorator,N=A.ccclass,L=A.property,E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.attrNode=null,t.attrIcons=null,t.toggle=null,t._cardId=null,t._levFlag=!1,t._itemFlag=!1,t._onClickBtn=!1,t.isFrist=!1,t.effectNode=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.start=function(){e.prototype.start.call(this),this.effectNode=this.node.getChildByName("effectNode")},t.prototype.show=function(){e.prototype.show.call(this),o.GameEventDispatcher.instance.on(a.EventDefiner.Card_updataCardInfo,this.upEffect,this),o.GameEventDispatcher.instance.on("BagPackInfoChange",this.upShow,this),o.GameEventDispatcher.instance.on(a.EventDefiner.WarTeamMonsterInfoHide,this.hideInfo,this)},t.prototype.setActive=function(){this.isClick&&(this.effectNode.removeFromParent(),this.node.addChild(this.effectNode),this.effectNode.active=!1)},t.prototype.hideInfo=function(){this.toggle.isChecked=!1,this.isFrist=!1},t.prototype.hide=function(){e.prototype.hide.call(this),this._cardId=null,this._levFlag=!1,this._itemFlag=!1,this._onClickBtn=!1,o.GameEventDispatcher.instance.off(a.EventDefiner.Card_updataCardInfo,this.upEffect,this),o.GameEventDispatcher.instance.off("BagPackInfoChange",this.upShow,this),o.GameEventDispatcher.instance.off(a.EventDefiner.WarTeamMonsterInfoHide,this.hideInfo,this)},t.prototype.setData=function(e,t){this._cardId=e,this.upShow()},t.prototype.upEffect=function(){this._cardId&&(this._onClickBtn&&!I.default.instance.isGuide&&(this.playEffect(),this.isClick=!0,this._onClickBtn=!1),this.upShow())},t.prototype.upShow=function(){this.setDesc(),this.setAttr(),this.setItem(),this.setFight()},t.prototype.setFight=function(){var e=r.default.instance,t=e.GetMonsterData(this._cardId);if(t){var i=e.cardStageData.getCardMaxLevel(this._cardId),n=e.getCarFight(this._cardId,t.level,e.data.MorphologicalTag,!0,null,!1),o=i>=t.level+1?e.getCarFight(this._cardId,t.level+1,e.data.MorphologicalTag,!0,null,!1):"",a=this.node.getChildByName("fightNode");a.getChildByName("value").getComponent(cc.Label).string=(n||0)+"",a.getChildByName("value2").getComponent(cc.Label).string=(o||0)+""}},t.prototype.setAttr=function(){var e=r.default.instance,t=e.GetMonsterData(this._cardId);if(t){var i=e.cardStageData.getCardMaxLevel(this._cardId),n=e.getAttrPrecentByGradeAndType(e.data.MorphologicalTag,l.default.getCardBaseAttr(this._cardId,t.level)),o=i>=t.level+1?e.getAttrPrecentByGradeAndType(e.data.MorphologicalTag,l.default.getCardBaseAttr(this._cardId,t.level+1)):[],a=this.node.getChildByName("attrList");if(a.destroyAllChildren(),Object.keys(n).length>0)for(var s in n)t.level>0&&n[s]>0&&this.setAttrNode(a,parseInt(s),n,o)}},t.prototype.setAttrNode=function(e,t,i,n,o){void 0===o&&(o=!1);var a=cc.instantiate(this.attrNode);a.active=!0,a.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=this.attrIcons.getSpriteFrame("attrIcon_"+t),a.getChildByName("name").getComponent(cc.Label).string=s.default.getAttrName(t),a.getChildByName("value").getComponent(cc.Label).string=""+l.default.getVal(i,t),o&&(a.getChildByName("value").color=new cc.Color(255,255,255)),a.getChildByName("value2").getComponent(cc.Label).string=""+l.default.getVal(n,t),o&&(a.getChildByName("value2").color=new cc.Color(0,202,71),a.getChildByName("value").color=new cc.Color(255,255,255),a.getChildByName("name").color=new cc.Color(255,255,255)),e.addChild(a)},t.prototype.setItem=function(){var e=r.default.instance,t=e.GetMonsterData(this._cardId);if(t){var i=e.data.getCardPieceId(this._cardId),n=e.data.getFiveLineAttributes(this._cardId),o=e.cardStageData.getlineFive(n,t.level),a=this.node.getChildByName("itemList");l.default.setNodeChildDestoryByUrl(a,c.GlobalContext.Root+"prefab/Bag/ItemIcon"),this._itemFlag=!1;var s=e.cardStageData.getCardMaxLevel(this._cardId);o&&s>t.level&&(this.setItemNode(a,d.default.creatItem(i,p.default.getCountByid(i)),o.pieceNum),this._itemFlag=p.default.getCountByid(i)>=o.pieceNum,o.itemId&&(this.setItemNode(a,d.default.creatItem(o.itemId,p.default.getCountByid(o.itemId)),o.count),this._itemFlag&&(this._itemFlag=p.default.getCountByid(o.itemId)>=o.count)),o.needMoney&&this.setItemNode(a,d.default.creatItem(1,o.needMoney),null)),this._levFlag=!!o&&o.needLevel<=h.MyRoleInfo.level}},t.prototype.setItemNode=function(e,t,i){u.default.instance.loadResByType(c.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(n){var o=l.default.getNodeByUrl(n,c.GlobalContext.Root+"prefab/Bag/ItemIcon");o.setScale(.8);var a=i&&i>0?t.count+"/"+i:S.NumberUtil.getNumber(t.count);o.getComponent(f.default).ItemData(t,!0,a,!0),e.addChild(o)},this)},t.prototype.setDesc=function(){var e=r.default.instance,t=e.GetMonsterData(this._cardId),i=e.getIsMonsterCard(this._cardId);if(t){this.node.getChildByName("img").active=i,this.node.getChildByName("LabelTwo").active=!i;var n=e.cardStageData.getCardMaxLevel(this._cardId),o=this.node.getChildByName("levelNode"),a=t.level?t.level:0;if(a>0){var s=D.default.instance.data.getEquipEffectAddAttr(this._cardId);a=n<(a+=s[R.AttrType.CardLevel]?s[R.AttrType.CardLevel]:0)?n:a}o.getChildByName("level").getChildByName("Label").getComponent(cc.Label).string=g.default.getStr("Lv {0}",a),o.getChildByName("level2").getChildByName("Label").getComponent(cc.Label).string=g.default.getStr("Lv {0}",a+1);var l=n>=t.level+1?e.cardStageData.getPotentialCfg(this._cardId,t.level):null;this.node.getChildByName("img2").active=n<t.level+1,this.node.getChildByName("Label").active=n<t.level+1,o.getChildByName("img10").active=n>=t.level+1,o.getChildByName("level2").active=n>=t.level+1;var c="",d="";if(l&&l.potentialDesc>=0&&t.level<n)d=e.cardStageData.getPotentialDesc(l.potentialDesc).name,c=g.default.getStr("{0}\u7ea7\u53ef\u89e3\u9501\u6f5c\u80fd:",l.needLv);var p=this.node.getChildByName("img").getChildByName("LabelNode");p.active=!1,p.getChildByName("Label1").getComponent(cc.Label).string=c,p.getChildByName("Label2").getComponent(cc.Label).string=d,this.node.getChildByName("btn").getComponent(cc.Button).interactable=!0,this.node.getChildByName("btn").active=n>=t.level+1,this.node.getChildByName("Toggle").active=n>=t.level+1,this.node.getChildByName("btn").getChildByName("Label").getComponent(cc.Label).string=n>=t.level+1?g.default.getStr("\u5347  \u7ea7"):g.default.getStr("\u6ee1  \u7ea7")}else i||(this.node.getChildByName("btn").getComponent(cc.Button).interactable=!1,this.node.getChildByName("btn").getChildByName("Label").getComponent(cc.Label).string=g.default.getStr("\u5347  \u7ea7"),this.node.getChildByName("img").active=i,this.node.getChildByName("LabelTwo").active=!i)},t.prototype.onClickTips=function(){var e=this;y.default.instance.openWindow(m.WindowType.PotentialTips,function(){C.default.instance.setData(e._cardId)},this)},t.prototype.onClickBtn=function(){var e=this;if(this._levFlag){var t=r.default.instance,i=t.GetMonsterData(this._cardId);if(i)if(!(!i||!i.flag||1!=i.flag))v.default.instance.ShowMsg(g.default.getStr("\u4e34\u65f6\u5361\u724c\u65e0\u6cd5\u63d0\u5347\u5361\u724c\u7b49\u7ea7"));else{var n=t.data.getCardPieceId(this._cardId),o=t.data.getFiveLineAttributes(this._cardId),a=t.cardStageData.getlineFive(o,i.level),s=p.default.getCountByid(n)>=a.pieceNum,l=a.itemId>0&&p.default.getCountByid(a.itemId)<a.count;if(s&&l&&!this.isFrist&&!this.toggle.isChecked){return this.isFrist=!0,void w.default.instance.ShowTips("\u662f\u5426\u81ea\u52a8\u8d2d\u4e70",function(){e.toggle.isChecked=!0},null,null,1,null,null,function(){_.default.PurchaseItemOrRechage(b.RechargeTypeConst.Prop,a.count,null,e,a.itemId)})}if(!this.toggle.isChecked&&a){if(a.needMoney>h.MyRoleInfo.money)return void _.default.PurchaseItemOrRechage(b.RechargeTypeConst.Prop,a.needMoney,null,this,1);if(p.default.getCountByid(n)<a.pieceNum)return void _.default.PurchaseItemOrRechage(b.RechargeTypeConst.Prop,a.pieceNum,null,this,n);if(a.itemId>0&&p.default.getCountByid(a.itemId)<a.count)return void _.default.PurchaseItemOrRechage(b.RechargeTypeConst.Prop,a.count,null,this,a.itemId)}t.reqCardstageup(this._cardId,this.toggle.isChecked),this._onClickBtn=!0}}else v.default.instance.ShowMsg(g.default.getStr("\u4eba\u7269\u7b49\u7ea7\u4e0d\u8db3"))},t.prototype.playEffect=function(){T.default.instance.PlayEffect(T.SoundType.upSucceeds),this.effectNode.removeFromParent(),this.node.parent.parent.addChild(this.effectNode),this.effectNode.active=!0,this.effectNode.setPosition(0,0),this.setEffectAttr();var e=this.effectNode.getChildByName("tishen2").getComponent(cc.Animation);this.effectNode.getChildByName("tishen2").stopAllActions(),e.pause("tishen2_ani1"),e.play("tishen2_ani1")},t.prototype.setEffectAttr=function(){var e=r.default.instance,t=e.GetMonsterData(this._cardId);if(t){var i=e.getAttrPrecentByGradeAndType(e.data.MorphologicalTag,l.default.getCardBaseAttr(this._cardId,t.level-1)),n=e.getAttrPrecentByGradeAndType(e.data.MorphologicalTag,l.default.getCardBaseAttr(this._cardId,t.level)),o=this.effectNode.getChildByName("attr"),a=o.getChildByName("initInfo");if(a.destroyAllChildren(),Object.keys(i).length>0)for(var s in i)t.level>0&&i[s]>0&&this.setAttrNode(a,parseInt(s),i,n,!0);var c=e.cardStageData.getCardMaxLevel(this._cardId),d=t.level?t.level:0;if(d>0){var p=D.default.instance.data.getEquipEffectAddAttr(this._cardId);d=c<(d+=p[R.AttrType.CardLevel]?p[R.AttrType.CardLevel]:0)?c:d}o.getChildByName("img").getChildByName("Label").getComponent(cc.Label).string=g.default.getStr("Lv {0}",d-1),o.getChildByName("img2").getChildByName("Label").getComponent(cc.Label).string=g.default.getStr("Lv {0}",d);var h=e.data.getCardRarity(this._cardId),u=e.cardStageData.getPotentialCfg(h,t.level-1),f="";if(u&&u.needLv<=t.level&&u.potentialDesc>=0)f=e.cardStageData.getPotentialDesc(u.potentialDesc).name;o.getChildByName("Label").active=!1,o.getChildByName("Label").getComponent(cc.Label).string=g.default.getStr("\u89e3\u9501\u6f5c\u80fd:{0}",f)}},__decorate([L(cc.Node)],t.prototype,"attrNode",void 0),__decorate([L(cc.SpriteAtlas)],t.prototype,"attrIcons",void 0),__decorate([L(cc.Toggle)],t.prototype,"toggle",void 0),t=__decorate([N],t)}(n.default);i.default=E,cc._RF.pop()},{"../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Core/LoadManager":"LoadManager","../../../Core/Widget":"Widget","../../../Core/WindowType":"WindowType","../../../Global/GlobalValue":"GlobalValue","../../../GlobalContext":"GlobalContext","../../../Util/AttrUtil":"AttrUtil","../../../Util/NumberUtil":"NumberUtil","../../../Util/RechargeConst":"RechargeConst","../../../Util/RechargeUtils":"RechargeUtils","../../../Util/Utils":"Utils","../../Equip/equip/EquipCtrl":"EquipCtrl","../../Guide/GuideNewController":"GuideNewController","../../Item/ItemData":"ItemData","../../Item/ItemIcon":"ItemIcon","../../Item/ItemModel":"ItemModel","../../OpenWin/OpenWinController":"OpenWinController","../../Role/RoleInfo":"RoleInfo","../../Sound/SoundController":"SoundController","../../Tips/OpTipsController":"OpTipsController","../../Tips/PotentialTips":"PotentialTips","../../Tips/TipsWinController":"TipsWinController","../MonsterController":"MonsterController"}],CardSynthesisEnd:[function(e,t,i){"use strict";cc._RF.push(t,"eaed8aOrTNF6pXd7HVgCSVj","CardSynthesisEnd"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Core/ConfigsManager"),a=e("../../../Core/CommonsResManager"),r=e("../../../Core/Language"),s=e("../../WarTeam/MonsterController"),l=e("../../Commons/MonsterPreview"),c=e("../../../Util/Utils"),d=e("../../../Core/WindowType"),p=e("../../../Global/GlobalValue"),h=e("../../../Core/WindowManager"),u=cc._decorator,f=u.ccclass,g=u.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.monsterNode=null,t.monsterRarity=null,t.nonName=null,t.labelDesc=null,t.experience=null,t.stance=null,t.btnGo=null,t.isShow=!1,t.callFunc=void 0,t._cardConfigs=null,t.cardId=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this,this.experience.string=r.default.getStr("7229"),this.btnGo.getComponentInChildren(cc.Label).string=r.default.getStr("7228"),this.labelDesc.string=r.default.getStr("7230")},t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.hide=function(){(e.prototype.hide.call(this),this.monsterNode.childrenCount)&&(this.monsterNode.getComponentInChildren(l.default).clear(),c.default.setNodeToPool(d.PoolType.MonsterPreview,this.monsterNode.children[0]))},t.prototype.initInfo=function(e){if(this.cardId=e,this._cardConfigs||(this._cardConfigs=o.ConfigsManager.instance.getConfigs("cardConf").Card),!this.monsterNode.childrenCount){var t=c.default.getNodeByPool(d.PoolType.MonsterPreview,s.default.instance.MonsterPreview);this.monsterNode.addChild(t)}var i=this._cardConfigs[this.cardId];this.nonName.string=i.cardName,this.monsterRarity.spriteFrame=a.default.instance.getSpriteFrameByName("rarity_"+i.rarity),this.stance.spriteFrame=a.default.instance.getSpriteFrameByName("stance_"+i.cardType),this.monsterNode.getComponentInChildren(l.default).init("monster",i.id,5,p.DEFAULTS_SKIN+5,p.PRIORITY.MONSTER)},t.prototype.btn_close=function(){this.onclearcheck()},t.prototype.setCallFunc=function(e){this.callFunc=e},t.prototype.onclearcheck=function(){this.isShow=!1,this.node.active=!1,h.default.instance.closeWindow(this.node),this.callFunc(),this.callFunc=void 0},t.instance=null,__decorate([g(cc.Node)],t.prototype,"monsterNode",void 0),__decorate([g(cc.Sprite)],t.prototype,"monsterRarity",void 0),__decorate([g(cc.Label)],t.prototype,"nonName",void 0),__decorate([g(cc.Label)],t.prototype,"labelDesc",void 0),__decorate([g(cc.RichText)],t.prototype,"experience",void 0),__decorate([g(cc.Sprite)],t.prototype,"stance",void 0),__decorate([g(cc.Node)],t.prototype,"btnGo",void 0),t=i=__decorate([f],t)}(n.default);i.default=y,cc._RF.pop()},{"../../../Core/CommonsResManager":"CommonsResManager","../../../Core/ConfigsManager":"ConfigsManager","../../../Core/Language":"Language","../../../Core/Widget":"Widget","../../../Core/WindowManager":"WindowManager","../../../Core/WindowType":"WindowType","../../../Global/GlobalValue":"GlobalValue","../../../Util/Utils":"Utils","../../Commons/MonsterPreview":"MonsterPreview","../../WarTeam/MonsterController":"MonsterController"}],CardSynthesis:[function(e,t,i){"use strict";cc._RF.push(t,"f2843L08wdNiJwe8IxFkqQ4","CardSynthesis"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../WarTeam/MonsterController"),o=e("../../../Core/ConfigsManager"),a=e("../../../Util/SDKUtils"),r=e("../../../Core/CommonsResManager"),s=e("../../Item/ItemIcon"),l=e("../../Item/ItemData"),c=e("../../WarTeam/WarTeamMonsterInfo"),d=e("../../Guide/GuideNewController"),p=e("../../../Core/GameEventDispatcher"),h=e("../../../Core/Event"),u=e("../../../Core/LoadManager"),f=e("../../../Util/Utils"),g=e("../../../Core/WindowType"),y=e("../../OpenWin/OpenWinController"),m=e("../../../Core/Window"),C=cc._decorator,v=C.ccclass,_=C.property,b=function(e){function t(){var t=e.call(this)||this;return t.effectNode=null,t.effectNode2=null,t.effectNode3=null,t.ItemIconList=[],t.monsterNode=null,t.TextNode=null,t.btnshare=null,t.btncardInfo=null,t.btnjoin=null,t.btn_autoReplace=null,t.isShow=!1,t.callFunc=void 0,t._cardConfigs=null,t._flag=!1,t._cardType=-1,t._cardIDTwo=-1,t._cardIndex=-1,t.cardId=null,i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.show=function(){e.prototype.show.call(this),this.node.active=!0},t.prototype.initInfo=function(e,t){var i=this;if(void 0===t&&(t=0),this.cardId!=e){switch(this.cardId=e,this._cardConfigs||(this._cardConfigs=o.ConfigsManager.instance.getConfigs("cardConf").Card),d.default.instance.checkCondition(14),this.btnjoin.active=!1,this.btnshare.active=!1,this.btncardInfo.active=!1,this.effectNode.active=!0,this.effectNode2.active=!1,this.effectNode3.active=!1,this.TextNode.active=!1,this.btn_autoReplace.active=!1,t){case 1:this.btnshare.active=this.btncardInfo.active=!1,this.btnjoin.active=!0}this.monsterNode.destroyAllChildren();var a=this.node.getChildByName("MaskBg");a.getComponent(cc.Button).interactable=!1,console.log("\u5408\u6210\u5361\u724c"+this.cardId);var c=this._cardConfigs[this.cardId].rarity;if(this.TextNode.getChildByName("name").getComponent(cc.Label).string=this._cardConfigs[this.cardId].cardName,this.TextNode.getChildByName("MonsterRarity").getComponent(cc.Sprite).spriteFrame=r.default.instance.getSpriteFrameByName("rarity_"+c),this.cardId<=3)this.btnjoin.active=!0;else{var p=n.default.instance.GetMonsterData(this.cardId);if(!!(!d.default.instance.isGuide&&p&&p.flag<1)){var h=7,g=this._cardConfigs[this.cardId].cardType,y=7,m=-1;for(var C in n.MonsterType.MonsterWarTeam[n.MonsterType.MonsterBattle]){var v=n.MonsterType.MonsterWarTeam[n.MonsterType.MonsterBattle][C];if(v&&v>0){var _=this._cardConfigs[v].cardType,b=this._cardConfigs[v].rarity;_==g&&b<y&&(y=b,m=v,this._cardIndex=parseInt(C)),b<h&&(m=v,h=b)}}this._cardIndex>=0&&y<=6&&m>0?c>y?(this._flag=!0,this._cardIDTwo=this.cardId,this.cardId=m,this._cardType=g,this.btn_autoReplace.active=!0,this.btnshare.active=!1,this.btncardInfo.active=!1):this.cardId>3&&(this.btnshare.active=this.btncardInfo.active=!0):c>h?(this._flag=!0,this._cardIDTwo=this.cardId,this.cardId=m,this._cardType=g,this.btn_autoReplace.active=!0):this.btnshare.active=this.btncardInfo.active=!0}else this.btnshare.active=this.btncardInfo.active=!0}n.default.instance.infoPreview(this.monsterNode,cc.v2(0,0),e,5,.4,-1);var T=this._cardConfigs[e].pieceId,S=l.default.creatItem(T,1);u.default.instance.loadResByType("prefab/Bag/ItemIcon",cc.Prefab,function(e){for(var t=0;t<i.ItemIconList.length;++t){var n=f.default.getNodeByUrl(e,"prefab/Bag/ItemIcon");i.ItemIconList[t].addChild(n),n.getComponent(s.default).ItemData(S,!1)}},this);var I=this.effectNode.getChildByName("hecheng01").getComponent(cc.Animation),w=this.effectNode2.getChildByName("hecheng02").getComponent(cc.Animation),D=this.effectNode3.getChildByName("hecheng03").getComponent(cc.Animation);I&&I.on("finished",function(){i.effectNode.active=!1,i.effectNode2.active=!0,w.play()},this),I.play(),w&&w.on("finished",function(){i.effectNode2.active=!1,i.effectNode3.active=!0,D.play(),i.TextNode.active=!0,a.getComponent(cc.Button).interactable=!0},this)}},t.prototype.btn_share=function(){var e=this;a.default.instance.shareAppMessage(function(){console.log("\u5206\u4eab\u6210\u529f\uff0c\u9000\u51fa\u754c\u9762"),e.btn_close()},this)},t.prototype.btn_close=function(){this.cardId<=3&&(d.default.instance.checkCondition(3),p.GameEventDispatcher.instance.emit(h.EventDefiner.CardPushWarm)),this.btn_autoReplace.active?this.onClickAutoReplace():this.onclearcheck()},t.prototype.setCallFunc=function(e){this.callFunc=e},t.prototype.onclearcheck=function(){this.close(),this.isShow=!1,this.node.active=!1,this._flag=!1,this._cardType=-1,this._cardIDTwo=-1,this._cardIndex=-1,this.callFunc(),this.callFunc=void 0},t.prototype.openCardInfo=function(){this.onclearcheck(),n.default.instance.openMonsterInfoPrefab(this.cardId,c.CardTag.info)},t.prototype.onClickAutoReplace=function(){this.btn_autoReplace.active=!1,n.default.instance.data.setAutoReplaceData({flag:this._flag,type:this._cardType,cardID:this.cardId,cardIDTwo:this._cardIDTwo}),this.onclearcheck();var e=n.default.instance.data.getAutoReplaceData();e.flag&&e.cardID>0&&e.cardIDTwo>0&&y.default.instance.openWindow(g.WindowType.WarTeam,function(t){p.GameEventDispatcher.instance.emit("newCard",{flag:e})})},t.instance=null,__decorate([_(cc.Node)],t.prototype,"effectNode",void 0),__decorate([_(cc.Node)],t.prototype,"effectNode2",void 0),__decorate([_(cc.Node)],t.prototype,"effectNode3",void 0),__decorate([_([cc.Node])],t.prototype,"ItemIconList",void 0),__decorate([_(cc.Node)],t.prototype,"monsterNode",void 0),__decorate([_(cc.Node)],t.prototype,"TextNode",void 0),__decorate([_(cc.Node)],t.prototype,"btnshare",void 0),__decorate([_(cc.Node)],t.prototype,"btncardInfo",void 0),__decorate([_(cc.Node)],t.prototype,"btnjoin",void 0),__decorate([_(cc.Node)],t.prototype,"btn_autoReplace",void 0),t=i=__decorate([v],t)}(m.default);i.default=b,cc._RF.pop()},{"../../../Core/CommonsResManager":"CommonsResManager","../../../Core/ConfigsManager":"ConfigsManager","../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/LoadManager":"LoadManager","../../../Core/Window":"Window","../../../Core/WindowType":"WindowType","../../../Util/SDKUtils":"SDKUtils","../../../Util/Utils":"Utils","../../Guide/GuideNewController":"GuideNewController","../../Item/ItemData":"ItemData","../../Item/ItemIcon":"ItemIcon","../../OpenWin/OpenWinController":"OpenWinController","../../WarTeam/MonsterController":"MonsterController","../../WarTeam/WarTeamMonsterInfo":"WarTeamMonsterInfo"}],CardUtils:[function(e,t,i){"use strict";cc._RF.push(t,"922beIE7Z9GZrAVKRvE8saa","CardUtils"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./MonsterController"),o=e("../Totems/TotemsUtils"),a=e("../Functionicon/FunctionIconController"),r=e("../../Core/WindowType"),s=e("../../Util/Utils"),l=e("./WarTeamMonsterInfo"),c=function(){function e(){}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.prototype.setCardProp=function(e){var t={},i=n.default.instance,l=a.default.instance.checkIsOpenbyWindowtype(r.WindowType.AssistFight);l&&s.default.accumulationAttrs(t,i.cardGroupData.getAllCardGroupAttr());var c=i.getCardConfCardType(e.cardid);s.default.accumulationAttrs(t,o.TotemsUtils.getCardIdAttr(c));var d=i.GetMonsterData(e.cardid);return d&&(s.default.accumulationAttrs(t,i.cardStageData.getCardPotentialAttr(e.cardid,d.level)),l&&s.default.accumulationAttrs(t,i.cardStageData.getCardPotential(e.cardid))),t},e.prototype.jumpCardInfo=function(e,t){var i=t,o=n.default.instance;i||(i=o.getIsMonsterCard(e)?l.CardTag.info:l.CardTag.skill),o.openMonsterInfoPrefab(e,i)},e}();i.default=c,cc._RF.pop()},{"../../Core/WindowType":"WindowType","../../Util/Utils":"Utils","../Functionicon/FunctionIconController":"FunctionIconController","../Totems/TotemsUtils":"TotemsUtils","./MonsterController":"MonsterController","./WarTeamMonsterInfo":"WarTeamMonsterInfo"}],CashGiftBag:[function(e,t,i){"use strict";cc._RF.push(t,"35a1bcyiUxNsa/OoJOoXG2J","CashGiftBag"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../NetConnect/NetConnet"),a=e("../../../Util/SDKUtils"),r=e("../../Tips/OpTipsController"),s=cc._decorator,l=s.ccclass,c=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.editBox=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),this.editBox.string=""},t.prototype.hide=function(){e.prototype.hide.call(this)},t.prototype.CashBtnClick=function(){if(this.editBox.string){var e=this.editBox.string,t=Number(a.default.instance.ditch_id);this.SendCdKey(e,t),this.editBox.string=""}else r.default.instance.ShowMsg("\u8f93\u5165\u6846\u4e3a\u7a7a")},t.prototype.SendCdKey=function(e,t){var i={cmd:"usecdkey",key:e,ditch_id:t};o.default.instance.sendProto(i)},__decorate([c(cc.EditBox)],t.prototype,"editBox",void 0),t=__decorate([l],t)}(n.default);i.default=d,cc._RF.pop()},{"../../../Core/Widget":"Widget","../../../NetConnect/NetConnet":"NetConnet","../../../Util/SDKUtils":"SDKUtils","../../Tips/OpTipsController":"OpTipsController"}],ChallengePlayer:[function(e,t,i){"use strict";cc._RF.push(t,"2dd9c/m02JKRJS42kNVzkaA","ChallengePlayer"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("./HighLadderData"),a=e("./HighLadderWin"),r=e("../Tips/OpTipsController"),s=e("../../Core/Language"),l=e("../Role/RoleInfo"),c=e("./HighLadderController"),d=e("../Gamelayer/RoleHead"),p=e("../../Util/NumberUtil"),h=e("../Tips/TipsWinController"),u=cc._decorator,f=u.ccclass,g=u.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Ranking=null,t.playerName=null,t.playerFight=null,t.highAtlas=null,t.roleHead=null,t.w=null,t.info=null,t.index=null,t}return __extends(t,e),t.prototype.start=function(){},t.prototype.show=function(){switch(e.prototype.show.call(this),this.Ranking.getComponent(cc.Sprite).spriteFrame=this.highAtlas.getSpriteFrame("bg_tianti12"),this.Ranking.getComponentInChildren(cc.Label).string=this.info.rank,this.playerName.string=this.info.name,this.playerFight.string=p.NumberUtil.getNumberW(this.info.fight),this.w.active=(this.info.fight+"").length>=5,this.roleHead.SetHead(this.info.icon),this.index){case 0:this.Ranking.getComponent(cc.Sprite).spriteFrame=this.highAtlas.getSpriteFrame("bg_tianti6");break;case 1:this.Ranking.getComponent(cc.Sprite).spriteFrame=this.highAtlas.getSpriteFrame("bg_tianti7");break;case 2:this.Ranking.getComponent(cc.Sprite).spriteFrame=this.highAtlas.getSpriteFrame("bg_tianti8")}},t.prototype.hide=function(){e.prototype.hide.call(this)},t.prototype.ChallengeOtherPlayer=function(){if(a.default.instance.Is_Fight=!0,o.SelfHighLadderData.Lineup&&0!=o.SelfHighLadderData.Lineup.length)if(0==o.SelfHighLadderData.ranking){if(!(o.SelfHighLadderData.ranking>10)&&this.info.rank<=3)return void r.default.instance.ShowMsg(s.default.getStr("Ladder_9"));0==Number(a.default.instance.MyChangeNumber.string)?a.default.instance.onAddBtn():0!=Number(a.default.instance.MyChangeNumber.string)&&(a.default.instance.lastRank=o.SelfHighLadderData.ranking,c.default.instance.sendCmdChallenge(this.info.actorid,this.info.rank))}else o.SelfHighLadderData.ranking&&o.SelfHighLadderData.ranking>10&&this.info.rank<=3?r.default.instance.ShowMsg(s.default.getStr("Ladder_9")):l.MyRoleInfo.name==this.info.name?r.default.instance.ShowMsg(s.default.getStr("Ladder_10")):0!=o.SelfHighLadderData.Lineup.length&&(0==Number(a.default.instance.MyChangeNumber.string)?a.default.instance.onAddBtn():0!=Number(a.default.instance.MyChangeNumber.string)&&(a.default.instance.lastRank=o.SelfHighLadderData.ranking,c.default.instance.sendCmdChallenge(this.info.actorid,this.info.rank)));else h.default.instance.ShowTips(s.default.getStr("Ladder_16"),function(){a.default.instance.onSetSquad()},this,null,1)},__decorate([g(cc.Node)],t.prototype,"Ranking",void 0),__decorate([g(cc.Label)],t.prototype,"playerName",void 0),__decorate([g(cc.Label)],t.prototype,"playerFight",void 0),__decorate([g(cc.SpriteAtlas)],t.prototype,"highAtlas",void 0),__decorate([g(d.default)],t.prototype,"roleHead",void 0),__decorate([g(cc.Node)],t.prototype,"w",void 0),t=__decorate([f],t)}(n.default);i.default=y,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/Widget":"Widget","../../Util/NumberUtil":"NumberUtil","../Gamelayer/RoleHead":"RoleHead","../Role/RoleInfo":"RoleInfo","../Tips/OpTipsController":"OpTipsController","../Tips/TipsWinController":"TipsWinController","./HighLadderController":"HighLadderController","./HighLadderData":"HighLadderData","./HighLadderWin":"HighLadderWin"}],ChannelItem:[function(e,t,i){"use strict";cc._RF.push(t,"a68d7ajjHJE/KHYPc2kMJTt","ChannelItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../Status/StatusType"),a=e("../Item/ItemModel"),r=e("../Commons/WindowOpenUtils"),s=e("../Functionicon/FunctionIconController"),l=e("../../Core/GameEventDispatcher"),c=e("../../Core/Event"),d=e("./OpTipsController"),p=e("../../Util/Utils"),h=cc._decorator,u=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t}return __extends(t,e),t.prototype.initData=function(e){var t=a.default.instance.getItemRoadOfInfo();this.label.string=t[e].name,this.index=e},t.prototype.onBtn=function(e){var t,i=a.default.instance.getItemRoadOfInfo();t=i[this.index].windType;var n=i[this.index].childIndex;if(1!=t||o.ActivityStatus.value!=o.ActivityStatus.Chapter){if(s.default.instance.checkIsOpenbyWindowtype(t,!0)){var h=n||0;r.default.instance.openWindowType(p.default.getWinowTypeByJumpType(this.index),h)}l.GameEventDispatcher.instance.emit(c.EventDefiner.ChannelItem_onClick)}else d.default.instance.ShowMsg("\u5df2\u7ecf\u5728\u4e3b\u7ebf\u5267\u60c5\u4e86")},__decorate([f(cc.Label)],t.prototype,"label",void 0),t=__decorate([u],t)}(n.default);i.default=g,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Widget":"Widget","../../Util/Utils":"Utils","../Commons/WindowOpenUtils":"WindowOpenUtils","../Functionicon/FunctionIconController":"FunctionIconController","../Item/ItemModel":"ItemModel","../Status/StatusType":"StatusType","./OpTipsController":"OpTipsController"}],ChapterController:[function(e,t,i){"use strict";cc._RF.push(t,"90093JoJpVI24FeugvViU7M","ChapterController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../Core/ConfigsManager"),a=e("../Role/RoleInfo"),r=e("../../Util/SDKUtils"),s=e("../../Util/LocalStorageUtils"),l=e("../../Core/GameEventDispatcher"),c=e("../../Core/Event"),d=e("../../Core/WindowType"),p=e("../BaiBeiFanLi/BaiBeiFanLiCtrl"),h=e("../Guide/GuideNewController"),u=e("./ChapterReward/ChapterRewardWin"),f=e("../../Core/WindowManager"),g=e("../Scene/Manager/SceneManager"),y=e("../../Core/Language"),m=e("../Tips/OpTipsController"),C=e("../../NetConnect/NetConnet"),v=e("../Gamelayer/Interface/EventInterface"),_=e("../WarTeam/MonsterController"),b=cc._decorator,T=b.ccclass,S=(b.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._configs=null,t.findId=-1,t.findData=new Object,t.enterChapterId=0,t.currentChapterId=0,t.currentGuanqiaId=0,t.currentAreaId=0,t.currentMaxGuanqia=0,t.readyPath=0,t.previousSaveInfo=null,t.currentChaptername="",t.currentGuanqianame="",t.currentAreaname="",t.currentChapteranim=0,t.isPlayChapteranim=!1,t.isLastGuanqia=!1,t.challengeLevel=0,t.showRewardTips=!1,t.resetSec=0,t.chapterKey=0,t.section=[],t.guanqiaIndex=0,t.guanqianum=-1,t.chapternum=-1,t.GuanQiaBoss=null,t.rewardArray=null,t.resetTimes=null,t.sweepChapterTimes=null,t.currChapterID=0,t.sweepEnergy=0,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this,this._configs=o.ConfigsManager.instance.getConfigs("chapterconf")},t.prototype.start=function(){e.prototype.start.call(this),this.sweepEnergy=o.ConfigsManager.instance.getConfigs("chaptersweepingconf").SweepingConfig[1].energy},t.prototype.getPlotMonsters=function(e){return this._configs.monsters[e]},t.prototype.listNotification=function(){this.addProto("chapter",this.getChapterInfo,this),this.addProto("chapterenter",this.permitEnter,this),this.addProto("sweepingresettimes",this.sweepTimes,this),this.addProto("sweeping",this.sweep,this)},t.prototype.permitEnter=function(e){e.permit&&(this.previousSaveInfo=e)},t.prototype.getAreaConfig=function(e){return this._configs.area[e]},t.prototype.getChapterConfigList=function(e){var t=this.getAreaConfig(e).chapter;return this._configs.chapter[t]},t.prototype.getChapterList=function(){var e=[];for(var t in this._configs.chapter){var i=this._configs.chapter[t];e.push.apply(e,i)}return e},t.prototype.getChapterData=function(e){return this.getChapterList()[e]},t.prototype.getChapterData1=function(){var e=this.getChapterList();return this._configs.guanqia[e[this.currentChapterId].chapterId][0].id},t.prototype.getChapterLength=function(){var e=this.getChapterList();return this._configs.guanqia[e[this.currentChapterId].chapterId].length},t.prototype.getChapterConfig=function(e,t){if(void 0===t&&(t=-1),t>=0){if((o=this.getChapterConfigList(t))&&o.length>0)for(var i=0;i<o.length;i++)if(o[i].chapterId==e)return o[i]}else for(var n in this._configs.chapter){var o;if((o=this._configs.chapter[n])&&o.length>0)for(i=0;i<o.length;i++)if(o[i].chapterId==e)return o[i]}return null},t.prototype.getGuanqiaConfigList=function(e,t){void 0===t&&(t=-1);var i=null,n=this.getChapterConfig(e,t);return n&&(i=this._configs.guanqia[n.guanqia]),i},t.prototype.getGuanqiaConfig=function(e,t,i){if(void 0===t&&(t=-1),void 0===i&&(i=-1),t>=0){if((a=this.getGuanqiaConfigList(t,i))&&a.length>0)for(var n=0;n<a.length;n++)if(a[n].guanqiaId==e)return a[n]}else for(var o in this._configs.guanqia){var a;if((a=this._configs.guanqia[o])&&a.length>0)for(n=0;n<a.length;n++)if(a[n].guanqiaId==e)return a[n]}return null},t.prototype.getPlotconfig=function(e){return this._configs.plot[e]},t.prototype.setChapterSandTable=function(e,t){void 0===t&&(t=-1),t<0&&(t=this.enterChapterId);var i="tdgame"+r.default.instance.gameID+"_chapterSandTable_"+t;s.default.instance.setItem(i,e)},t.prototype.getChapterSandTable=function(e){void 0===e&&(e=-1),e<0&&(e=this.enterChapterId);var t="tdgame"+r.default.instance.gameID+"_chapterSandTable_"+e,i=s.default.instance.getItem(t);if(!i||i.length<=0){var n="",o=this.getChapterConfig(e);o&&(n=o.sandTable),n=(n=n.replace(/\s*/g,"")).replace(/\\n/g,""),i=JSON.parse("["+n+"]")}return i},t.prototype.clearChapterSandTable=function(e){void 0===e&&(e=-1),e<0&&(e=this.enterChapterId);var t="tdgame"+r.default.instance.gameID+"_chapterSandTable_"+e;s.default.instance.removeItem(t)},t.prototype.checkGuanqiaIsPass=function(e){return e<this.readyPath},t.prototype.checkGuanqiaCanFight=function(e){var t=!0,i=this.getGuanqiaConfig(e);if(i&&i.parentGuanqiaId&&i.parentGuanqiaId.length>0&&i.costEnergy<=a.MyRoleInfo.energy)for(var n=0;n<i.parentGuanqiaId.length;n++){var o=Number(i.parentGuanqiaId[n]);if(0==this.checkGuanqiaIsPass(o)){t=!1;break}}return t},t.prototype.checkChapterIsPass=function(e){return e<=this.currentChapterId},t.prototype.checkChapterCanFight=function(e){var t=!0,i=this.getChapterConfig(e);if(i&&i.minLevel&&a.MyRoleInfo.level<i.minLevel)t=!1;else{var n=e-1;n>0&&0==this.checkChapterIsPass(n)&&(t=!1)}return t},t.prototype.checkGuanqiainfobyid=function(e){if(this.findData[e])return this.findData[e];var t=o.ConfigsManager.instance.getConfigs("chapterconf").area,i=0;for(var n in t)for(var a=o.ConfigsManager.instance.getConfigs("chapterconf").chapter[t[n].chapter],r=0;r<a.length;r++)for(var s=o.ConfigsManager.instance.getConfigs("chapterconf").guanqia[a[r].guanqia],l=0;l<s.length;l++){var c={area:t[n],chapter:a[r],guanqia:s[l]};if(this.findData[e]=c,i==e)return c;i++}return this.findData[e-1]},t.prototype.isBaoXiangCourse=function(){return 0==this.currentChapterId&&this.currentGuanqiaId<=1},t.prototype.getChapterInfo=function(e){this.currentChapterId!=e.chapter&&0!=this.readyPath&&(this.showRewardTips=!0);var t=!1;this.currentChapterId==e.chapter&&this.currentGuanqiaId==e.section||(t=!0),this.openWin=null,0!=this.currentChapterId&&g.default.instance.fightresult&&(p.default.instance.isOpen(e)&&(this.openWin=d.WindowType.BaiBeiFanLi),p.default.instance.isOneSeckillOpen(e)&&(this.openWin=d.WindowType.OneSeckill));var i=o.ConfigsManager.instance.getConfigs("chapterconf").guanqia;e.chapter>Object.keys(i).length-1?this.currentChapterId=Object.keys(i).length-1:this.currentChapterId=e.chapter,this.section=e.section,this.chapterKey=e.key,this.resetSec=e.resetsec,this.rewardArray=e.rewardchap,0!=e.chapter&&e.chapter>=e.video&&(this.isPlayChapteranim=!0),this.currentMaxGuanqia=e.maxsec?e.maxsec:0,this.setCurrentGuanqiaId(),this.setReadyPath(),l.GameEventDispatcher.instance.emit(c.EventDefiner.ChapterReset,t);var n=this.getGuanqiainfo();l.GameEventDispatcher.instance.emit(v.EventInterface.ThreadRed,n);var r=this.checkGuanqiainfobyid(this.readyPath);this.currentChaptername=r.chapter.chapterName,this.currentGuanqianame=r.guanqia.guanqiaName,this.currChapterID=r.chapter.chapterId,this.currentAreaname=r.area.areaName,f.default.instance.isOpenWindow(d.WindowType.ChapterRewardWin)&&this.chapterDataRest(),a.MyRoleInfo.firstgame||h.default.instance.checkCondition(2),_.default.instance.cardGroupData.cardGroupAttrCptFlag=!1},t.prototype.setCurrentGuanqiaId=function(){for(var e=o.ConfigsManager.instance.getConfigs("chapterconf").guanqia[this.currentChapterId+1],t=0;t<e.length;t++)this.chapterKey>=e[t].needKey&&(this.currentGuanqiaId=t)},t.prototype.setReadyPath=function(e){var t=o.ConfigsManager.instance.getConfigs("chapterconf"),i=t.area,n=t.chapter,a=t.guanqia,r=0;r=e>=0?e:this.currentGuanqiaId,this.guanqiaIndex=r,this.readyPath=0;var s=!1;for(var l in i){for(var c=0;c<n[i[l].chapter].length;c++)if(this.readyPath+=a[n[i[l].chapter][c].guanqia].length,n[i[l].chapter][c].chapterId==this.currentChapterId+1){this.currentAreaId=i[l].areaId,s=!0,this.readyPath-=a[n[i[l].chapter][c].guanqia].length-r;break}if(s)break}},t.prototype.chapterDataRest=function(){u.default.instance.Info()},t.prototype.sweep=function(e){this.sweepChapterTimes=e.sweeping},t.prototype.sweepTimes=function(e){this.resetTimes=e.times,l.GameEventDispatcher.instance.emit("RESETTIMES",this)},t.prototype.getChapterReward=function(e){var t=e.chapterId;e.reward;if(t<i.instance.currentChapterId+1){i.instance.getChapterConfig(t);var n={cmd:"chapterreward",rewardidx:t};C.default.instance.sendProto(n)}else m.default.instance.ShowMsg(y.default.getStr("ChapterTips5"))},t.prototype.islastChapter=function(){var e=this.checkGuanqiainfobyid(this.readyPath),t=e.guanqia.id,i=o.ConfigsManager.instance.getConfigs("chapterconf").guanqia[e.chapter.guanqia];return t==i[i.length-1].id},t.prototype.SweepIsRed=function(){for(var e in this.sweepChapterTimes)if(!this.sweepChapterTimes[e]||3!=this.sweepChapterTimes[e])return!1;return!0},t.prototype.getGuanqiainfo=function(){var e=this.readyPath+1,t=this.checkGuanqiainfobyid(e);return t||(e-=1,t=this.checkGuanqiainfobyid(e)),this.guanqianum!=this.readyPath&&(this.guanqianum=this.readyPath),0==this.rewardArray&&this.rewardArray<this.currentChapterId||!(!this.rewardArray||!(this.rewardArray.length<this.currentChapterId||-1!=this.rewardArray.indexOf(null)))},t.prototype.chekcSatisfyChapteridAndGqid=function(e,t){return void 0===t&&(t=-1),this.currentChapterId>e||this.currentChapterId==e&&this.currentGuanqiaId>=t},t.instance=null,t=i=__decorate([T],t)}(n.default));i.default=S,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../NetConnect/NetConnet":"NetConnet","../../Util/LocalStorageUtils":"LocalStorageUtils","../../Util/SDKUtils":"SDKUtils","../BaiBeiFanLi/BaiBeiFanLiCtrl":"BaiBeiFanLiCtrl","../Gamelayer/Interface/EventInterface":"EventInterface","../Guide/GuideNewController":"GuideNewController","../Role/RoleInfo":"RoleInfo","../Scene/Manager/SceneManager":"SceneManager","../Tips/OpTipsController":"OpTipsController","../WarTeam/MonsterController":"MonsterController","./ChapterReward/ChapterRewardWin":"ChapterRewardWin"}],ChapterLevelInfo:[function(e,t,i){"use strict";cc._RF.push(t,"057b2Lpb5ZGOqeR+H0pqtd+","ChapterLevelInfo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../../Core/Widget"),o=e("./ChapterMapView"),a=e("../../../Commons/MonsterPreview"),r=e("../../../../Util/Utils"),s=e("../../../../Core/WindowType"),l=e("../../../../GlobalContext"),c=e("../../../../Core/LoadManager"),d=e("../../../Commons/CombatValue"),p=e("../../../PlotWin/PlotController"),h=cc._decorator,u=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.model=null,t.nevt=null,t.spriteCombat=null,t.porwer=0,t._x=0,t._index=0,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.combatValue=function(e){var t=this;r.default.setNodeChildDestoryByUrl(this.spriteCombat,l.GlobalContext.Root+"prefab/CombatVal"),c.default.instance.loadResByType(l.GlobalContext.Root+"prefab/CombatVal",cc.Prefab,function(i){var n=r.default.getNodeByUrl(i,l.GlobalContext.Root+"prefab/CombatVal");t.spriteCombat.addChild(n),t.spriteCombat.getComponentInChildren(d.default).onInit(e,22)},this)},t.prototype.initIndex=function(e){this._index=e},t.prototype.hide=function(){(e.prototype.hide.call(this),this.model.childrenCount>0)&&(this.model.children[0].getComponent(a.default).clear(),r.default.setNodeToPool(s.PoolType.MonsterPreview,this.model.children[0]));this.nevt.childrenCount>0&&this.nevt.removeAllChildren()},t.prototype.onClick=function(e){p.default.instance.iscomplete&&o.default.instance&&o.default.instance.clickLevel(e,this._index)},__decorate([f(cc.Node)],t.prototype,"model",void 0),__decorate([f(cc.Node)],t.prototype,"nevt",void 0),__decorate([f(cc.Node)],t.prototype,"spriteCombat",void 0),t=__decorate([u],t)}(n.default);i.default=g,cc._RF.pop()},{"../../../../Core/LoadManager":"LoadManager","../../../../Core/Widget":"Widget","../../../../Core/WindowType":"WindowType","../../../../GlobalContext":"GlobalContext","../../../../Util/Utils":"Utils","../../../Commons/CombatValue":"CombatValue","../../../Commons/MonsterPreview":"MonsterPreview","../../../PlotWin/PlotController":"PlotController","./ChapterMapView":"ChapterMapView"}],ChapterMapView:[function(e,t,i){"use strict";cc._RF.push(t,"2d791w9gVdDiY+siUn4p3JI","ChapterMapView"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Chapter/ChapterController"),o=e("./MapUnitMoveCtrl"),a=e("../../../../Core/GameEventDispatcher"),r=e("../../../../Core/Event"),s=e("../../../../Global/GlobalValue"),l=e("../../../../Core/ConfigsManager"),c=e("../../../Tips/OpTipsController"),d=e("../../../../Core/Language"),p=e("../../../Role/RoleInfo"),h=e("../../../../NetConnect/NetConnet"),u=e("../../../../Core/WindowManager"),f=e("../../../../Core/WindowType"),g=e("../../../WarTeam/MonsterController"),y=e("./ListControl"),m=e("../../../Commons/MonsterPreview"),C=e("../../../../Core/LoadManager"),v=e("../../../OpenWin/OpenWinController"),_=e("../../../../GlobalContext"),b=e("../../../PlotWin/PlotController"),T=e("../../Controller/FightController"),S=e("../../../LoadingPanel/LoadingPanel"),I=e("../../../Status/StatusType"),w=e("../../../../Core/TimeController"),D=e("../../../Guide/GuideNewController"),R=e("../../../Functionicon/FunctionIconController"),A=e("../../../Effects/UIBtnEffect/UIBtnEffectController"),N=e("../../../../Util/Utils"),L=e("../../../Commons/RewardUtils"),E=e("../../../../Util/RechargeUtils"),B=e("../../../../Util/RechargeConst"),M=e("../../../Chapter/ChapterRewardTips"),x=e("../../../../Core/Widget"),k=e("../../Pool/SpinePools"),P=e("../../../../Core/SpineBase"),G=e("../../../Commons/Image"),F=e("../../../Chapter/GuanqiaController"),W=e("./ChapterLevelInfo"),U=e("../../../Tips/TipsWinController"),O=e("../../../../Util/NumberUtil"),V=cc._decorator,q=V.ccclass,H=V.property,j=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.levelInfo=null,t.DragNode=null,t.BgContainer=null,t.Container=null,t.RunchapterName=null,t.RewardBox=null,t.mopUp=null,t.ResetBtn=null,t.ChapterName=null,t.GuanqiaName=null,t.layerBottomBtn=null,t.chapterRewardTips=null,t.allKeyNum=null,t.monsterHead=null,t.RunningLevelId=0,t.Nowlevelpower=0,t.mitemMove=!1,t.GuanqiaPool=new cc.NodePool,t.currentGaunaqiaId=-1,t.MapsceneId=1,t.endlevelPosi=null,t.isleft=!1,t.maxX=0,t._effect=null,t._rightX=0,t._fingerArr=[],t._XArr=[],t.dragNodex=0,t.chapterMapViewIsReady=!1,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){},t.prototype.start=function(){e.prototype.start.call(this),this.node.setContentSize(_.GlobalContext.UIWidth,_.GlobalContext.UIHeight),this.RunchapterName.node.parent.parent.setPosition(-_.GlobalContext.UIWidth/2+this.RunchapterName.node.parent.width-20,_.GlobalContext.UIHeight/2+this.RunchapterName.node.parent.height/2-27),this.RewardBox.x=-_.GlobalContext.UIWidth/2+this.RewardBox.width/2+20+_.PlayerData.SceneBorld,this.mopUp.x=-_.GlobalContext.UIWidth/2+this.mopUp.width/2+20+_.PlayerData.SceneBorld,this.ResetBtn.x=-_.GlobalContext.UIWidth/2+this.ResetBtn.width/2+20+_.PlayerData.SceneBorld,i.instance=this},t.prototype.curGuideStart=function(){var e=this.Container.children[this.Container.childrenCount-n.default.instance.currentGuanqiaId-1];e&&(e.getChildByName("Nevt").active=!1),M.default.instance&&M.default.instance.onhide()},t.prototype.curGuideComplete=function(){var e=this.Container.children[this.Container.childrenCount-n.default.instance.currentGuanqiaId-1];e&&(e.getChildByName("Nevt").active=!0),this.canOpenRewardTips()},t.prototype.show=function(){e.prototype.show.call(this);var t=n.default.instance.checkGuanqiainfobyid(n.default.instance.readyPath),i=O.NumberUtil.unitsDigitToText(t.chapter.chapterId);this.RunchapterName.string=d.default.getStr("chapterNumber",i),this.ChapterName.string=t.area.areaName,this.GuanqiaName.string=t.chapter.chapterName,this.mitemMove=!1,this.openMap(),a.GameEventDispatcher.instance.on(r.EventDefiner.ChapterReset,this.openMap,this),a.GameEventDispatcher.instance.on(r.EventDefiner.PermitEnter,this.PermitEnter,this),a.GameEventDispatcher.instance.on(r.EventDefiner.ChapterLoadComplete,this.onPageComplete,this),a.GameEventDispatcher.instance.on("CHAPTERNOTENTER",this.CheckIsPlay,this),a.GameEventDispatcher.instance.on(r.EventDefiner.WindowCloselink,this.canOpenRewardTips,this),a.GameEventDispatcher.instance.on(r.EventDefiner.CurGuideStart,this.curGuideStart,this),a.GameEventDispatcher.instance.on(r.EventDefiner.CurGuideComplete,this.curGuideComplete,this),this.monsterHead.on(cc.Node.EventType.TOUCH_END,this.setFingerAndX,this),this.DragNode.on(cc.Node.EventType.TOUCH_MOVE,this.DragNodeTouchMove,this),this.CheckIsPlay(),y.default.instance.OpenList(8,this.layerBottomBtn),this.monsterHeadScale()},t.prototype.checkPlotReady=function(){this.chapterMapViewIsReady=!0,this.startPlot()},t.prototype.startPlot=function(){var e=this;this.chapterMapViewIsReady&&b.default.instance.checkPlot(b.PlotType.EnterMap,function(){e.chapterMapViewIsReady=!1},this)},t.prototype.openMap=function(){if(b.default.instance.getPlotInfo(b.PlotType.EnterMap),n.default.instance.isPlayChapteranim&&this.startPlot(),this.currentGaunaqiaId!=n.default.instance.readyPath){this.currentGaunaqiaId=n.default.instance.readyPath;var e=n.default.instance.checkGuanqiainfobyid(n.default.instance.readyPath),t=this.MapsceneId;e||(e=n.default.instance.checkGuanqiainfobyid(n.default.instance.readyPath-1)),t=e.guanqia.MapsceneId,this.MapsceneId=t,this.realyShow()}this.RewardBox.getChildByName("RedNode").active=n.default.instance.getGuanqiainfo(),A.default.instance.onSetEffect(this.RewardBox,0,n.default.instance.getGuanqiainfo())},t.prototype.resetChapter=function(){U.default.instance.ShowTips("\u91cd\u7f6e"+this.RunchapterName.string+"\u4e0d\u4f1a\u8fd4\u8fd8\u5df2\u7ecf\u6d88\u8017\u7684\u5377\u8f74\u6280\u80fd",function(){h.default.instance.sendProto({cmd:"chapterreset"})},this)},t.prototype.onOpenResetChapter=function(){this.resetChapter()},t.prototype.onPageComplete=function(){},t.prototype.hide=function(){e.prototype.hide.call(this),this.currentGaunaqiaId=-1,this.Container.getChildByName("MoveRole")&&this.Container.getChildByName("MoveRole").getComponent(o.default).clearMovePath(),a.GameEventDispatcher.instance.off(r.EventDefiner.ChapterReset,this.openMap,this),a.GameEventDispatcher.instance.off(r.EventDefiner.PermitEnter,this.PermitEnter,this),a.GameEventDispatcher.instance.off(r.EventDefiner.ChapterLoadComplete,this.onPageComplete,this),a.GameEventDispatcher.instance.off(r.EventDefiner.WindowCloselink,this.canOpenRewardTips,this),a.GameEventDispatcher.instance.off(r.EventDefiner.CurGuideStart,this.curGuideStart,this),a.GameEventDispatcher.instance.off(r.EventDefiner.CurGuideComplete,this.curGuideComplete,this),this.monsterHead.off(cc.Node.EventType.TOUCH_END,this.setFingerAndX,this),this.DragNode.off(cc.Node.EventType.TOUCH_MOVE,this.DragNodeTouchMove,this),this.onCloseChapterTips(),this.GuanqiaPool.clear(),this.BgContainer.getComponent(G.default).clear(),k.SpinePools.recoverSpineNoder(this._effect),this._effect=null,this.layerBottomBtn.getChildByName("FunBottomList")&&N.default.setNodeDestoryByUrl(this.layerBottomBtn.getChildByName("FunBottomList"),_.GlobalContext.Root+"prefab/FunList/FunBottomBtnList")},t.prototype.DragNodeTouchMove=function(e){if(!D.default.instance.isGuide){var t=e.getPreviousLocation(),i=e.getLocation(),n=this.DragNode.position.x+(i.x-t.x);if(n<-(this._rightX-_.GlobalContext.UIWidth/2))return(n=-(this._rightX-_.GlobalContext.UIWidth/2))>-_.GlobalContext.UIWidth/2&&(n=-_.GlobalContext.UIWidth/2),void this.DragNode.setPosition(n,0);this.checkDragNodePosition(n)}},t.prototype.checkDragNodePosition=function(e){e>-_.GlobalContext.UIWidth/2&&(e=-_.GlobalContext.UIWidth/2),e<-(this.DragNode.width-_.GlobalContext.UIWidth/2)&&(e=-(this.DragNode.width-_.GlobalContext.UIWidth/2)),this.DragNode.setPosition(e,0),this.dragNodex=e,this.setMonsterHead()},t.prototype.plotComResetDragNodex=function(){this.DragNode.setPosition(this.dragNodex,0)},t.prototype.realyShow=function(){var e=this;null==this.levelInfo?C.default.instance.loadResByType(_.GlobalContext.Root+"prefab/Chapter/LevelInfo",cc.Prefab,function(t){e.levelInfo=t,e.initGuanqia()},this):this.initGuanqia()},t.prototype.startFight=function(){var e=n.default.instance.checkGuanqiainfobyid(n.default.instance.readyPath);if(e&&e.guanqia.costEnergy>p.MyRoleInfo.energy)c.default.instance.ShowMsg(d.default.getStr("\u4f53\u529b\u4e0d\u8db3\uff0c\u9700\u8981\u6d88\u8017\u4f53\u529b {0}",n.default.instance.checkGuanqiainfobyid(n.default.instance.readyPath).guanqia.costEnergy));else if(p.MyRoleInfo.level<e.chapter.minLevel)c.default.instance.ShowMsg(d.default.getStr("ChapterTips4",e.chapter.minLevel));else{this.mitemMove=!0;var t;t=n.default.instance.readyPath;n.default.instance.checkGuanqiainfobyid(t).guanqia.guanqiaId;this.enterGamescene()}},t.prototype.initGuanqia=function(){this._fingerArr=[],this.allKeyNum.node.parent.getComponent(cc.Layout).paddingLeft=-1!=this.GuanqiaName.string.indexOf("\uff09")?-26:0,this.allKeyNum.string="x"+n.default.instance.chapterKey,this.ResetBtn.active=n.default.instance.currChapterID>6;console.log(n.default.instance.readyPath);var e=n.default.instance.checkGuanqiainfobyid(n.default.instance.readyPath),t=e.chapter.mapID;0==t&&(t=1);var i=_.GlobalContext.ResRoot+"resources/chaptermap/"+t+".jpg";this.BgContainer.getComponent(G.default).loadImageByHttps(i,function(){console.log("\u5730\u56fe\u56fe\u7247\u52a0\u8f7d\u5b8c\u6210"),S.default.instance.showSceneLoadingFinish()},this);var o=n.default.instance.getGuanqiaConfigList(e.chapter.guanqia);this._rightX=324.5*o.length;for(var a=0;a<o.length;a++){var r=void 0;this.Container.children[a]&&"MoveRole"!=this.Container.children[a].name?r=this.Container.children[a]:((r=this.GuanqiaPool.size()>0?this.GuanqiaPool.get():N.default.getNodeByUrl(this.levelInfo,_.GlobalContext.Root+"prefab/Chapter/LevelInfo")).active=!0,this.Container.addChild(r,a,99+a+"")),r.attr({data_td:o[a],data_tdindex:e.chapter,data_td_num:a});var l=1;a%2!=0&&(l=0),r.setPosition(300*a+200,-140*l);var c=o[a].id,d=a,p=F.default.instance.config,h=p.guanqiaconf[c].playgames,u=p.playgames[h],y=void 0;y=u.length>=2?p.playgames[h][u.length-1].monsters:p.playgames[h][0].monsters;var C=p.monsters[y].concat();C.sort(function(e,t){return t.grade-e.grade});var v=C[0].cardId,b=C[0].grade;r.zIndex=o.length-a,r.getComponent(cc.Button).interactable=!0,r.getChildByName("Nevt").active=!1,r.getChildByName("powerDown").active=!1,r.getChildByName("GRAVE1").active=!1,r.getChildByName("model").active=!1,r.getChildByName("lock").active=!0,r.getChildByName("LabelGroup").active=!0,r.getChildByName("spriteCombat").active=!1,r.getComponent(W.default).initIndex(d);var I=n.default.instance.chapterKey,w=parseInt(o[a].needKey);if(r.getChildByName("LabelGroup").getChildByName("haveKeyNum").getComponent(cc.Label).string=I+"",r.getChildByName("LabelGroup").getChildByName("needKeyNum").getComponent(cc.Label).string=w+"",n.default.instance.section[n.default.instance.currentChapterId]||(n.default.instance.section[n.default.instance.currentChapterId]=[]),n.default.instance.section[n.default.instance.currentChapterId][a])r.getComponent(cc.Button).interactable=!1,r.getChildByName("Nevt").active=!1,r.getChildByName("powerDown").active=!0,r.getChildByName("GRAVE1").active=!0,r.getChildByName("GRAVE1").scale=1,r.getChildByName("model").active=!1,r.getChildByName("lock").active=!1,r.getChildByName("LabelGroup").active=!1;else if(I>=w){if(!r.getChildByName("model").childrenCount){var D=N.default.getNodeByPool(f.PoolType.MonsterPreview,g.default.instance.MonsterPreview);r.getChildByName("model").addChild(D)}r.getChildByName("model").children[0].getComponent(m.default).init("monster",v,b,s.DEFAULTS_SKIN+b,s.PRIORITY.MONSTER,!1,s.ACTION.STAND,s.DIR.LEFT),r.getChildByName("model").scale=.8,r.getChildByName("lock").active=!1,r.getChildByName("model").active=!0,r.getChildByName("LabelGroup").active=!1,r.getChildByName("spriteCombat").active=!0;var R=0;if(u[u.length-1].fight)R=u[u.length-1].fight;else for(var A=0;A<C.length;A++){var L=C[A].num;L||(L=1),R+=T.default.instance.getGQMonsterAttr(c,C[A].skilllevel,C[A],1).GetFight()*L}r.getComponent(W.default).porwer=R,r.getComponent(W.default)._x=300*a+200,r.getComponent(W.default).combatValue(R),this._fingerArr.push(r)}}this.setFingerAndX();for(a=this.Container.childrenCount-1;a>=o.length;a--)"MoveRole"!=this.Container.children[a].name&&this.GuanqiaPool.put(this.Container.children[a]);this._fingerArr.length<=0&&(this.ResetBtn.active=!1)},t.prototype.test=function(){console.log("--------------------test")},t.prototype.setFingerAndX=function(){if(!(this._fingerArr.length<=0)){this._fingerArr.sort(function(e,t){return e.getComponent(W.default).porwer-t.getComponent(W.default).porwer});var e=this._fingerArr[0];e.getChildByName("Nevt").active=!D.default.instance.isGuide;var t=e.getChildByName("Nevt");if(t.childrenCount<=0)this._effect=k.SpinePools.addSpineNoder(t,new cc.Vec2(0,0)),this._effect.getComponent(P.default).initSpineData(s.SPINE_RES_DIR+"effect/dailytipseffect/effect",null,"1",!0);var i=-e.getComponent(W.default)._x;i<-(this._rightX-_.GlobalContext.UIWidth/2)?((i=-(this._rightX-_.GlobalContext.UIWidth/2))>-_.GlobalContext.UIWidth/2&&(i=-_.GlobalContext.UIWidth/2),this.dragNodex=i,this.DragNode.setPosition(i,0)):this.checkDragNodePosition(i)}},t.prototype.monsterHeadScale=function(){this.monsterHead.active=!0,this.monsterHead.stopAllActions();var e=cc.scaleTo(1,.9),t=cc.scaleTo(1,1.1),i=cc.sequence([e,t]),n=cc.repeatForever(i);this.monsterHead.runAction(n),this.monsterHead.active=!1},t.prototype.setMonsterHead=function(){if(!(this._fingerArr.length<=0)){var e=this.DragNode.position.x,t=this.DragNode.position.x-_.GlobalContext.UIWidth;for(var i in this._fingerArr){var n=-this._fingerArr[i].getComponent(W.default)._x-_.GlobalContext.UIWidth/2;if(n<e&&n>t)return void(this.monsterHead.active=!1)}var o=-this._fingerArr[0].getComponent(W.default)._x-_.GlobalContext.UIWidth/2;o>e?this.monsterHead.x=-_.GlobalContext.UIWidth/2+this.monsterHead.width:o<t&&(this.monsterHead.x=_.GlobalContext.UIWidth/2-this.monsterHead.width),this.monsterHead.active=!0}},t.prototype.clickLevel=function(e,t){a.GameEventDispatcher.instance.emit(r.EventDefiner.ChangeActivityStatus,I.ActivityStatus.Chapter);var i=e.currentTarget,o=(i.getSiblingIndex(),i.data_td.guanqiaName.replace(/[^0-9]/gi,""),i.data_td.guanqiaId,parseInt(i.data_td.needKey));n.default.instance.section[n.default.instance.currentChapterId]||(n.default.instance.section[n.default.instance.currentChapterId]=[]),n.default.instance.section[n.default.instance.currentChapterId][t]?c.default.instance.ShowMsg(d.default.getStr("\u5df2\u901a\u5173\uff0c\u4e0d\u53ef\u518d\u6b21\u6311\u6218")):n.default.instance.chapterKey>=o?i.data_td.costEnergy<=p.MyRoleInfo.energy?p.MyRoleInfo.level>=i.data_tdindex.minLevel?(this.mitemMove=!0,n.default.instance.setReadyPath(t),this.enterGamescene()):U.default.instance.ShowTips(d.default.getStr("ChapterTips11",i.data_tdindex.minLevel,n.default.instance.currentChapterId+1),function(){a.GameEventDispatcher.instance.emit(r.EventDefiner.ChangeGameScene,{status:s.GameScene.Main}),D.default.instance.checkCondition(28)},this,null,2,d.default.getStr("ChapterTips12")):E.default.PurchaseItemOrRechage(B.RechargeTypeConst.Prop,i.data_td.costEnergy,null,this,L.RewardType.Energy):c.default.instance.ShowMsg(d.default.getStr("\u6536\u96c6{0}\u628a\u94a5\u5319\u540e\u53ef\u6311\u6218",o))},t.prototype.PermitEnter=function(){var e=n.default.instance.checkGuanqiainfobyid(n.default.instance.readyPath),t=e.guanqia.id,i=l.ConfigsManager.instance.getConfigs("chapterconf").guanqia[e.chapter.guanqia];n.default.instance.isLastGuanqia=t==i[i.length-1].id,a.GameEventDispatcher.instance.emit(r.EventDefiner.ChangeGameScene,{status:s.GameScene.Fight,guanqiaId:t})},t.prototype.enterGamescene=function(){b.default.instance.getPlotInfo(b.PlotType.EnterChapterBefore),b.default.instance.stepTypeDic[b.PlotType.EnterChapterBefore].length>0?this.isenterPlot():g.default.instance.activeCar()||v.default.instance.openWindow(f.WindowType.FightInfo)},t.prototype.isenterPlot=function(){var e=this;b.default.instance.checkPlot(b.PlotType.EnterChapterBefore,function(){e.enterGamescene(),e.chapterMapViewIsReady=!1},this)},t.prototype.ClickSweeping=function(){R.default.instance.checkIsOpenbyWindowtype(f.WindowType.ChapterSouring,!0),R.default.instance.checkIsOpenbyWindowtype(f.WindowType.ChapterSouring)&&u.default.instance.open(f.WindowType.ChapterSouring)},t.prototype.CheckIsPlay=function(){var e=this;w.default.instance.setTimeout(function(){n.default.instance.checkChapterCanFight(n.default.instance.currChapterID)?e.mopUp.getChildByName("red").active=!1:n.default.instance.SweepIsRed()&&p.MyRoleInfo.energy>=n.default.instance.sweepEnergy?e.mopUp.getChildByName("red").active=!0:e.mopUp.getChildByName("red").active=!1},this,500)},t.prototype.gotoChapter=function(){this.realyShow()},t.prototype.OpenRewardWin=function(){v.default.instance.openWindow(f.WindowType.ChapterRewardWin),n.default.instance.showRewardTips=!1,M.default.instance&&M.default.instance.onhide()},t.prototype.onCloseChapterTips=function(){M.default.instance&&M.default.instance.onhide()},t.prototype.canOpenRewardTips=function(){R.default.instance.OpenserverList.length<=0&&!D.default.instance.isGuide&&n.default.instance.showRewardTips&&!_.GlobalContext.ItemLoading.active&&_.PlayerData.WindowLayer.childrenCount<=0&&this.openRewardTips()},t.prototype.openRewardTips=function(){var e=this;n.default.instance.showRewardTips=!1,M.default.instance&&M.default.instance.onClose(),C.default.instance.loadResByType(_.GlobalContext.Root+"prefab/ChapterReward/ChapterRewardTips",cc.Prefab,function(t){var i;i=N.default.getNodeByUrl(t,_.GlobalContext.Root+"prefab/ChapterReward/ChapterRewardTips"),e.chapterRewardTips.addChild(i)},this)},t.instance=null,__decorate([H(cc.Node)],t.prototype,"DragNode",void 0),__decorate([H(cc.Node)],t.prototype,"BgContainer",void 0),__decorate([H(cc.Node)],t.prototype,"Container",void 0),__decorate([H(cc.Label)],t.prototype,"RunchapterName",void 0),__decorate([H(cc.Node)],t.prototype,"RewardBox",void 0),__decorate([H(cc.Node)],t.prototype,"mopUp",void 0),__decorate([H(cc.Node)],t.prototype,"ResetBtn",void 0),__decorate([H(cc.Label)],t.prototype,"ChapterName",void 0),__decorate([H(cc.Label)],t.prototype,"GuanqiaName",void 0),__decorate([H(cc.Node)],t.prototype,"layerBottomBtn",void 0),__decorate([H(cc.Node)],t.prototype,"chapterRewardTips",void 0),__decorate([H(cc.Label)],t.prototype,"allKeyNum",void 0),__decorate([H(cc.Node)],t.prototype,"monsterHead",void 0),t=i=__decorate([q],t)}(x.default);i.default=j,cc._RF.pop()},{"../../../../Core/ConfigsManager":"ConfigsManager","../../../../Core/Event":"Event","../../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../../Core/Language":"Language","../../../../Core/LoadManager":"LoadManager","../../../../Core/SpineBase":"SpineBase","../../../../Core/TimeController":"TimeController","../../../../Core/Widget":"Widget","../../../../Core/WindowManager":"WindowManager","../../../../Core/WindowType":"WindowType","../../../../Global/GlobalValue":"GlobalValue","../../../../GlobalContext":"GlobalContext","../../../../NetConnect/NetConnet":"NetConnet","../../../../Util/NumberUtil":"NumberUtil","../../../../Util/RechargeConst":"RechargeConst","../../../../Util/RechargeUtils":"RechargeUtils","../../../../Util/Utils":"Utils","../../../Chapter/ChapterController":"ChapterController","../../../Chapter/ChapterRewardTips":"ChapterRewardTips","../../../Chapter/GuanqiaController":"GuanqiaController","../../../Commons/Image":"Image","../../../Commons/MonsterPreview":"MonsterPreview","../../../Commons/RewardUtils":"RewardUtils","../../../Effects/UIBtnEffect/UIBtnEffectController":"UIBtnEffectController","../../../Functionicon/FunctionIconController":"FunctionIconController","../../../Guide/GuideNewController":"GuideNewController","../../../LoadingPanel/LoadingPanel":"LoadingPanel","../../../OpenWin/OpenWinController":"OpenWinController","../../../PlotWin/PlotController":"PlotController","../../../Role/RoleInfo":"RoleInfo","../../../Status/StatusType":"StatusType","../../../Tips/OpTipsController":"OpTipsController","../../../Tips/TipsWinController":"TipsWinController","../../../WarTeam/MonsterController":"MonsterController","../../Controller/FightController":"FightController","../../Pool/SpinePools":"SpinePools","./ChapterLevelInfo":"ChapterLevelInfo","./ListControl":"ListControl","./MapUnitMoveCtrl":"MapUnitMoveCtrl"}],ChapterRewardItem:[function(e,t,i){"use strict";cc._RF.push(t,"6b72f020mBOZbmPWtzmoCo/","ChapterRewardItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../Commons/RewardUtils"),a=e("../../../Core/LoadManager"),r=e("../../../GlobalContext"),s=e("../../../Core/WindowType"),l=e("../../../Util/Utils"),c=e("../../Item/ItemIcon"),d=e("../ChapterController"),p=e("../../Scene/View/Chapter/ChapterMapView"),h=e("../../../Core/GameEventDispatcher"),u=e("../../../Core/Event"),f=e("../../../Util/NumberUtil"),g=e("../../../Core/Language"),y=cc._decorator,m=y.ccclass,C=y.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ItemIconItem=null,t.title=null,t.chapterNum=null,t.chapterName=null,t.getReward=null,t.goToReward=null,t.spriteReward=null,t.rewardGroup=null,t.redSprite=null,t._ChapterRewardItemData=null,t}return __extends(t,e),t.prototype.onInitData=function(e){this._ChapterRewardItemData=e,this.onShowPage()},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),l.default.setNodeChildDestoryByUrl(this.rewardGroup,r.GlobalContext.Root+"prefab/Bag/ItemIcon")},t.prototype.onShowPage=function(){this.setChapterRewardShow();var e=f.NumberUtil.unitsDigitToText(this._ChapterRewardItemData.chapterId);this.title.string=this._ChapterRewardItemData.rewardName,this.chapterNum.string=g.default.getStr("chapterNumber",e),this.chapterName.string=this._ChapterRewardItemData.chapterName,this.btnInit()},t.prototype.btnInit=function(){switch(this.getReward.active=!1,this.goToReward.active=!1,this.spriteReward.active=!1,this.redSprite.active=!1,this._ChapterRewardItemData.btn){case 0:this.spriteReward.active=!0;break;case 1:this.goToReward.active=!0;break;case 2:this.getReward.active=!0,this.redSprite.active=!0}},t.prototype.setChapterRewardShow=function(){for(var e=this,t=this._ChapterRewardItemData.reward,i=o.default.instance.getItemList(t),n=0;n<this.rewardGroup.childrenCount;n++)this.rewardGroup.children[n].active=!1;if(this.rewardGroup.childrenCount<i.length)a.default.instance.loadResByType(r.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(t){for(var n=0;n<i.length;n++){var o=void 0;(o=l.default.getNodeByPool(s.PoolType.ItemIcon,t,r.GlobalContext.Root+"prefab/Bag/ItemIcon")).scale=.8,e.rewardGroup.addChild(o),o.getComponent(c.default).ItemData(i[n],!0,null,!0),o.attr({index_td:i[n].id})}},this);else for(n=0;n<i.length;n++)this.rewardGroup.children[n].getComponent(c.default).ItemData(i[n],!0,null,!0),this.rewardGroup.children[n].attr({index_td:i[n].id}),this.rewardGroup.children[n].active=!0},t.prototype.gotoReward=function(){h.GameEventDispatcher.instance.emit(u.EventDefiner.CloseCommonPage4),p.default.instance.gotoChapter()},t.prototype.getOpenReward=function(){this._ChapterRewardItemData.chapterId<d.default.instance.currentChapterId+1?d.default.instance.getChapterReward(this._ChapterRewardItemData):this.gotoReward()},__decorate([C(cc.Label)],t.prototype,"title",void 0),__decorate([C(cc.Label)],t.prototype,"chapterNum",void 0),__decorate([C(cc.Label)],t.prototype,"chapterName",void 0),__decorate([C(cc.Node)],t.prototype,"getReward",void 0),__decorate([C(cc.Node)],t.prototype,"goToReward",void 0),__decorate([C(cc.Node)],t.prototype,"spriteReward",void 0),__decorate([C(cc.Node)],t.prototype,"rewardGroup",void 0),__decorate([C(cc.Node)],t.prototype,"redSprite",void 0),t=__decorate([m],t)}(n.default);i.default=v,cc._RF.pop()},{"../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Core/LoadManager":"LoadManager","../../../Core/Widget":"Widget","../../../Core/WindowType":"WindowType","../../../GlobalContext":"GlobalContext","../../../Util/NumberUtil":"NumberUtil","../../../Util/Utils":"Utils","../../Commons/RewardUtils":"RewardUtils","../../Item/ItemIcon":"ItemIcon","../../Scene/View/Chapter/ChapterMapView":"ChapterMapView","../ChapterController":"ChapterController"}],ChapterRewardTips:[function(e,t,i){"use strict";cc._RF.push(t,"e7293vkjPlJJqUWu1vUnrqF","ChapterRewardTips"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("./ChapterController"),a=e("../../Util/Utils"),r=e("../../Core/LoadManager"),s=e("../Commons/RewardUtils"),l=e("../../GlobalContext"),c=e("../../Core/WindowType"),d=e("../Item/ItemIcon"),p=e("../Scene/View/Chapter/ChapterMapView"),h=e("../PlotWin/PlotController"),u=cc._decorator,f=u.ccclass,g=u.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rewardTitle=null,t.rewardCont=null,t.tipTitleGroup=null,t.tipBtnGroup=null,t._itemdata=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.show=function(){e.prototype.show.call(this),this.resetData(),h.default.instance.iscomplete||this.onhide()},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),a.default.setNodeChildDestoryByUrl(this.rewardCont,l.GlobalContext.Root+"prefab/Bag/ItemIcon")},t.prototype.setPositin=function(){this.node.x=p.default.instance.RewardBox.x+200,this.node.y=p.default.instance.RewardBox.y-p.default.instance.RewardBox.height/2},t.prototype.resetData=function(){this.setPositin(),this._itemdata=o.default.instance.getChapterData(o.default.instance.currentChapterId-1),this.Info()},t.prototype.Info=function(){this.node.active=!0,this.rewardTitle.string=this._itemdata.rewardName,this.setChapterRewardShow()},t.prototype.setChapterRewardShow=function(){var e=this,t=this._itemdata.reward,i=s.default.instance.getItemList(t);this.rewardNum(i.length);for(var n=0;n<this.rewardCont.childrenCount;n++)this.rewardCont.children[n].active=!1;if(this.rewardCont.childrenCount<i.length)r.default.instance.loadResByType(l.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(t){for(var n=0;n<i.length;n++){var o=void 0;(o=a.default.getNodeByPool(c.PoolType.ItemIcon,t,l.GlobalContext.Root+"prefab/Bag/ItemIcon")).scale=.6,e.rewardCont.addChild(o),o.getComponent(d.default).ItemData(i[n],!0,null,!0),o.attr({index_td:i[n].id})}},this);else for(n=0;n<i.length;n++)this.rewardCont.children[n].getComponent(d.default).ItemData(i[n],!0,null,!0),this.rewardCont.children[n].attr({index_td:i[n].id}),this.rewardCont.children[n].active=!0},t.prototype.rewardNum=function(e){e<4?(this.node.height=220,this.tipTitleGroup.y=69.5,this.rewardCont.y=-5,this.tipBtnGroup.y=-70,this.node.y=80):(this.node.height=290,this.tipTitleGroup.y=104.5,this.rewardCont.y=30,this.tipBtnGroup.y=-105,this.node.y=45)},t.prototype.onClickOpenRewardWin=function(){p.default.instance.OpenRewardWin()},t.prototype.onClose=function(){this.node&&this.node.parent&&this.node.parent.removeAllChildren()},t.prototype.onhide=function(){this.node&&this.node.parent&&(this.node.active=!1)},t.prototype.onShow=function(){return!!this.node.parent},t.instance=null,__decorate([g(cc.Label)],t.prototype,"rewardTitle",void 0),__decorate([g(cc.Node)],t.prototype,"rewardCont",void 0),__decorate([g(cc.Node)],t.prototype,"tipTitleGroup",void 0),__decorate([g(cc.Node)],t.prototype,"tipBtnGroup",void 0),t=i=__decorate([f],t)}(n.default);i.default=y,cc._RF.pop()},{"../../Core/LoadManager":"LoadManager","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/RewardUtils":"RewardUtils","../Item/ItemIcon":"ItemIcon","../PlotWin/PlotController":"PlotController","../Scene/View/Chapter/ChapterMapView":"ChapterMapView","./ChapterController":"ChapterController"}],ChapterRewardWin:[function(e,t,i){"use strict";cc._RF.push(t,"4af35SX8UFH0ZNOkO4t0GLF","ChapterRewardWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./ChapterRewardItem"),o=e("../../Commons/CommonPageBG"),a=e("../../../Core/Language"),r=e("../ChapterController"),s=e("../../Commons/ListViewCtrl"),l=cc._decorator,c=l.ccclass,d=l.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ChapterItem=null,t.listViewCtrl=null,t._info=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this,this.listViewCtrl.refreshItem=this.updateCardItem,this.listViewCtrl.refreshItemThis=this,this.onInit(1075,638,a.default.getStr("ChapterTips8"),!0)},t.prototype.show=function(){e.prototype.show.call(this),this.Info()},t.prototype.Info=function(){this._info=r.default.instance.getChapterList(),this._info=this.itemDataInit(),this.sortList(),this.listViewCtrl.initialize(this._info),this.listViewCtrl.scrollToTop()},t.prototype.itemDataInit=function(){var e=r.default.instance.currentChapterId+1,t=r.default.instance.rewardArray,i=[];i=this._info;for(var n=0;n<i.length;n++)i[n].chapterId<e?t[n]?i[n].btn=0:i[n].btn=2:i[n].btn=1;return i},t.prototype.sortList=function(){this._info.sort(function(e,t){return e.btn-t.btn>0?-1:e.btn-t.btn<0?1:e.chapterId-t.chapterId})},t.prototype.updateCardItem=function(e,t){e.getComponent(n.default).onInitData(this.listViewCtrl.dataLsit[t])},t.prototype.hide=function(){e.prototype.hide.call(this)},t.instance=null,__decorate([d(s.default)],t.prototype,"listViewCtrl",void 0),t=i=__decorate([c],t)}(o.default);i.default=p,cc._RF.pop()},{"../../../Core/Language":"Language","../../Commons/CommonPageBG":"CommonPageBG","../../Commons/ListViewCtrl":"ListViewCtrl","../ChapterController":"ChapterController","./ChapterRewardItem":"ChapterRewardItem"}],ChapterReward:[function(e,t,i){"use strict";cc._RF.push(t,"f88f6sitoBA+YdIDl6tsFOX","ChapterReward"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Chapter/ChapterController"),o=e("../../../Commons/RewardUtils"),a=e("../../../../Util/Utils"),r=e("../../../../Core/WindowType"),s=e("../../../Item/ItemIcon"),l=e("../../../../NetConnect/NetConnet"),c=e("../../../../Core/Language"),d=e("../../../Tips/OpTipsController"),p=e("../../../Item/ItemModel"),h=e("../../../../Util/GrayEffect"),u=e("../../../../Util/NumberUtil"),f=e("../../../../Core/Window"),g=e("../../../../Core/LoadManager"),y=e("../../../../GlobalContext"),m=e("../../../Item/ItemData"),C=e("../../../Item/ItemController"),v=cc._decorator,_=v.ccclass,b=v.property,T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.redNode=null,t.rewardNode=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.hide=function(){e.prototype.hide.call(this),this.onClear()},t.prototype.onClear=function(){for(var e=this.rewardNode.childrenCount-1;e>=0;e--){this.rewardNode.children[e].getComponent(s.default)&&a.default.setNodeToPool(r.PoolType.ItemIcon,this.rewardNode.children[e])}this.rewardNode.removeAllChildren()},t.prototype.setChapterRewardShow=function(e){var t=this;this.onClear();var i=e.reward,n=o.default.instance.getItemList(i),l=e.chapterId;this.node.getChildByName("Label").getComponent(cc.Label).string="\u7b2c"+u.NumberUtil.unitsDigitToText(l)+"\u7ae0\u901a\u5173\u5956\u52b1",g.default.instance.loadResByType(y.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(e){for(var i=0;i<n.length;i++){var o=void 0;o=a.default.getNodeByPool(r.PoolType.ItemIcon,e,y.GlobalContext.Root+"prefab/Bag/ItemIcon"),t.rewardNode.addChild(o),o.getComponent(s.default).ItemData(n[i],!0,null,!0),o.attr({index_td:n[i].id})}},this)},t.prototype.setButtonInfo=function(e,t){if(e.getComponent(cc.Button)?e.getComponent(cc.Button):e.addComponent(cc.Button),e.getChildByName("ItemIcon")){var i=e.getChildByName("ItemIcon").getComponent(h.default);i||(i=e.getChildByName("ItemIcon").addComponent(h.default)),i.setGray(t)}},t.prototype.getChapterReward=function(e){var t=e.chapterId;e.reward;if(t<n.default.instance.currentChapterId+1){var i=n.default.instance.getChapterConfig(t);this.setChapterRewardShow(i);var o={cmd:"chapterreward",rewardidx:t};l.default.instance.sendProto(o)}else d.default.instance.ShowMsg(c.default.getStr("ChapterTips5"))},t.prototype.getItemTips=function(e){var t=e.currentTarget,i=p.default.getCountByid(t.index_td);C.default.instance.openItemTips(m.default.creatItem(t.index_td,i))},t.instance=null,__decorate([b(cc.Node)],t.prototype,"redNode",void 0),__decorate([b(cc.Node)],t.prototype,"rewardNode",void 0),t=i=__decorate([_],t)}(f.default);i.default=T,cc._RF.pop()},{"../../../../Core/Language":"Language","../../../../Core/LoadManager":"LoadManager","../../../../Core/Window":"Window","../../../../Core/WindowType":"WindowType","../../../../GlobalContext":"GlobalContext","../../../../NetConnect/NetConnet":"NetConnet","../../../../Util/GrayEffect":"GrayEffect","../../../../Util/NumberUtil":"NumberUtil","../../../../Util/Utils":"Utils","../../../Chapter/ChapterController":"ChapterController","../../../Commons/RewardUtils":"RewardUtils","../../../Item/ItemController":"ItemController","../../../Item/ItemData":"ItemData","../../../Item/ItemIcon":"ItemIcon","../../../Item/ItemModel":"ItemModel","../../../Tips/OpTipsController":"OpTipsController"}],ChapterScouring:[function(e,t,i){"use strict";cc._RF.push(t,"49dd1rrNxhGNItFX99VDo1h","ChapterScouring"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/ConfigsManager"),o=e("./ChapterController"),a=e("./SweepingItem"),r=e("../Role/RoleInfo"),s=e("../../Core/GameEventDispatcher"),l=e("../../Core/WindowManager"),c=e("../../Core/WindowType"),d=e("../Commons/RewardUtils"),p=e("../Tips/RewardTips"),h=e("../Commons/CommonPageBG"),u=e("../../Core/Language"),f=e("../../Core/LoadManager"),g=e("../../GlobalContext"),y=e("../../Util/Utils"),m=cc._decorator,C=m.ccclass,v=m.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.SweepingItem=null,t.content=null,t.conf=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this,this.onInit(1156,678,u.default.getStr("ChapterTips7"),!0)},t.prototype.show=function(){e.prototype.show.call(this),s.GameEventDispatcher.instance.on("SWEEPING",this.OpenReward,this),s.GameEventDispatcher.instance.on("RESETTIMES",this.Info,this),this.Info()},t.prototype.Info=function(){var e=this;this.conf=n.ConfigsManager.instance.getConfigs("chaptersweepingconf"),y.default.setNodeChildDestoryByUrl(this.content,g.GlobalContext.Root+"prefab/ChapterMapView/SweepingItem"),f.default.instance.loadResByType(g.GlobalContext.Root+"prefab/ChapterMapView/SweepingItem",cc.Prefab,function(t){e.SweepingItem=t;for(var i=1;i<=o.default.instance.currentChapterId;i++){var n=3;o.default.instance.sweepChapterTimes&&o.default.instance.sweepChapterTimes[i-1]&&(n=3-o.default.instance.sweepChapterTimes[i-1]);var s=y.default.getNodeByUrl(e.SweepingItem,g.GlobalContext.Root+"prefab/ChapterMapView/SweepingItem");s.active=!0;var l=e.conf.randreward[i].chaptername+":"+e.conf.randreward[i].chapterName;s.getComponent(a.default).Info(e.conf.reward[r.MyRoleInfo.level],e.conf.randreward[i],n+"",e.conf.SweepingConfig[1].energy+"",l,i),e.content.addChild(s)}},this)},t.prototype.hide=function(){e.prototype.hide.call(this),s.GameEventDispatcher.instance.off("SWEEPING",this.OpenReward,this),s.GameEventDispatcher.instance.off("RESETTIMES",this.Info,this)},t.prototype.OpenReward=function(e){l.default.instance.open(c.WindowType.RewardTips,function(){p.default.instance.setData(d.default.instance.getItemListByServerData(e.getUserData().reward))},this)},t.instance=null,__decorate([v(cc.Node)],t.prototype,"content",void 0),t=i=__decorate([C],t)}(h.default);i.default=_,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/CommonPageBG":"CommonPageBG","../Commons/RewardUtils":"RewardUtils","../Role/RoleInfo":"RoleInfo","../Tips/RewardTips":"RewardTips","./ChapterController":"ChapterController","./SweepingItem":"SweepingItem"}],ChatCell:[function(e,t,i){"use strict";cc._RF.push(t,"f503fMl4fFJmpupwsNhFw2E","ChatCell"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../Gamelayer/RoleHead"),a=e("./Chatentrance"),r=e("../../Core/Language"),s=e("./ChatController"),l=e("../../Core/GameEventDispatcher"),c=e("../../Core/Event"),d=e("../Vip/VipLev"),p=e("../OpenWin/OpenWinController"),h=e("../../Core/WindowType"),u=e("../../Core/CommonsResManager"),f=cc._decorator,g=f.ccclass,y=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.RoleHead=null,t.Sex=null,t.Dan=null,t.bubbles=null,t.RoleName=null,t.Level=null,t.Msg=null,t.VipButton=null,t.vipNode=null,t.infoData=null,t.isVip=null,t.BaoQing=[200,201,204,206,207,208,209,212,216,217],t}return __extends(t,e),t.prototype.initChatinfo=function(e,t){if(this.vipNode.getComponent(d.default).setData(e.viplv,!0,function(){p.default.instance.openWindow(h.WindowType.VIP)},this),this.infoData=e,this.Level.string=e.level+"",this.node.attr({indexId:e.id}),this.RoleName.string=e.name,this.isVip=!1,t&&(this.RoleName.string=r.default.getStr("1000",e.serverid,e.name)),e.word){this.infoData.lineheight?this.infoData.lineheight:(this.Msg.lineHeight,this.infoData.lineheight=this.Msg.lineHeight);this.Msg.maxWidth=0;var i=e.word,n=i.match(/0\d+/g);if(this.Msg.lineHeight=30,n&&n[0].length>1&&n[0].length<=4&&parseInt(n[0])>0){var l=parseInt(i.substring(1,n[0].length));i="<img src='"+l+"'/>",l>=200?(this.Msg.imageAtlas=a.default.instance.vipExpression,this.BaoQing.indexOf(l)>=0?this.Msg.lineHeight=75:this.Msg.lineHeight=49):this.Msg.imageAtlas=a.default.instance.expression,this.vipExp=l+""}n&&4==n[0].length&&(this.isVip=!0),this.Msg.string=i;this.Msg.node.width>=400&&(this.Msg.maxWidth=400),this.Msg.node.parent.width=this.Msg.node.width+56}var c=u.default.instance.getSpriteFrameByName("gender_"+e.gender);e.gender>=0&&c&&(this.Sex.spriteFrame=c),e.icon&&this.RoleHead.getComponent(o.default).SetHead(e.icon),this.VipButton&&(this.VipButton.node.active=!1),this.VipButton&&this.isVip&&s.default.instance.isUnlock()&&(this.VipButton.node.active=!0)},t.prototype.resetNode=function(){this.RoleHead.Image.spriteFrame=null,this.RoleName.string=""},t.prototype.sendVipButton=function(){s.default.instance.VipExpression=this.vipExp,l.GameEventDispatcher.instance.emit(c.EventDefiner.ChatConfirm)},__decorate([y(o.default)],t.prototype,"RoleHead",void 0),__decorate([y(cc.Sprite)],t.prototype,"Sex",void 0),__decorate([y(cc.Sprite)],t.prototype,"Dan",void 0),__decorate([y(cc.Sprite)],t.prototype,"bubbles",void 0),__decorate([y(cc.Label)],t.prototype,"RoleName",void 0),__decorate([y(cc.Label)],t.prototype,"Level",void 0),__decorate([y(cc.RichText)],t.prototype,"Msg",void 0),__decorate([y(cc.Button)],t.prototype,"VipButton",void 0),__decorate([y(cc.Node)],t.prototype,"vipNode",void 0),t=__decorate([g],t)}(n.default);i.default=m,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../Gamelayer/RoleHead":"RoleHead","../OpenWin/OpenWinController":"OpenWinController","../Vip/VipLev":"VipLev","./ChatController":"ChatController","./Chatentrance":"Chatentrance"}],ChatConst:[function(e,t,i){"use strict";cc._RF.push(t,"37e6eqfgaVOZasR3+AraYWd","ChatConst"),Object.defineProperty(i,"__esModule",{value:!0}),function(e){e[e.Word=0]="Word",e[e.PrivateChat=1]="PrivateChat"}(i.ChatTypeConst||(i.ChatTypeConst={})),function(e){e[e.ContentLong=1]="ContentLong",e[e.ContentNull=2]="ContentNull",e[e.CoolingCd=3]="CoolingCd",e[e.ForbiddenWords=4]="ForbiddenWords"}(i.ChatErrConst||(i.ChatErrConst={})),function(e){e[e.SystemOperation=1]="SystemOperation",e[e.SystemNotice=2]="SystemNotice",e[e.SystemLazyWeight=3]="SystemLazyWeight"}(i.ChatTipsTypeConst||(i.ChatTipsTypeConst={})),cc._RF.pop()},{}],ChatController:[function(e,t,i){"use strict";cc._RF.push(t,"c5dc74BFGJOb5Ig80qBj3k3","ChatController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../Core/GameEventDispatcher"),a=e("../../Core/Event"),r=e("../PartnerPanel/FriendsController"),s=e("../../Core/Language"),l=e("../../Core/ConfigsManager"),c=e("./ChatVo"),d=e("../Role/RoleInfo"),p=e("../../Util/LocalStorageUtils"),h=e("../../NetConnect/NetConnet"),u=e("./ChatNoticeController"),f=e("./ChatNoticeVo"),g=e("../../Core/TimeController"),y=e("../LoadingPanel/LoadingPanel"),m=e("../Scene/Controller/SceneController"),C=e("../../Global/GlobalValue"),v=e("../Tips/OpTipsController"),_=e("../Vip/VipCtrl"),b=e("./ChatConst"),T=e("../OpenWin/OpenWinController"),S=e("../../Core/WindowType"),I=e("../AcquistionPathWin/AcquistionPathWin"),w=e("../Item/ItemController"),D=e("../Tips/BatchUsageTips"),R=e("../Item/ItemModel"),A=e("../Item/ItemData"),N=e("../SandTable/SandTableMain"),L=e("../Guide/GuideNewController"),E=e("../OpenFuncTips/OpenFuncTips"),B=e("../Commons/WindowOpenUtils"),M=cc._decorator,x=M.ccclass,k=(M.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Worldchat=[],t.Worldchat1=[],t.Systemchat=[],t.Fridchat=null,t.fridList=null,t.BlackLsit=new Object,t.FridnewTips=new Object,t.FridnewSrot=[],t.FridnewSrotopen=!0,t.config=null,t.CanClick=!0,t.IsOpenPush=!0,t.MsgList=[],t.TimeOut=null,t.newMsg=[],t.TimeChatOut=null,t.pos={x:-180,y:-306},t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this),i.instance=this,this.config=l.ConfigsManager.instance.getConfigs("ChatConf"),this.UpperLimit=this.config.ChatConf[1].ChatCountLineCount,this.openLevel=this.config.ChatConf[1].OpenLevel,this.NoticeConf=this.config.ChatNotice;var n=g.default.instance.setTimeout(function(){var e=new c.ChatVo({word:s.default.getStr("3006",d.MyRoleInfo.name),cmd:"chat",id:999,channel:b.ChatTypeConst.Word});t.Worldchat.push(e),o.GameEventDispatcher.instance.emit(a.EventDefiner.ChatInfo,e);var i=p.default.instance.getItem(d.MyRoleInfo.id+"IsOpenPush");null!=i&&(t.IsOpenPush=i),t.setFirlMassage(),g.default.instance.clearTimeout(n)},this,900)},t.prototype.openTimeOut=function(){var e=this;this.TimeOut=g.default.instance.setInterval(function(){if(e.MsgList.length){var t=e.MsgList.shift();y.default.instance.isLoadingFinish&&m.default.instance.scenestatus!=C.GameScene.Fight&&e.IsOpenPush&&u.default.instance.ShowMsg(t)}else e.closeTimeOut()},this,250)},t.prototype.openTimeChatOut=function(){var e=this;this.TimeChatOut=g.default.instance.setInterval(function(){e.Worldchat1.length?o.GameEventDispatcher.instance.emit(a.EventDefiner.ChatInfo,e.Worldchat1.shift()):e.closeTimeChatOutt()},this,100)},t.prototype.closeTimeOut=function(){g.default.instance.clearInterval(this.TimeOut),this.TimeOut=null},t.prototype.closeTimeChatOutt=function(){g.default.instance.clearInterval(this.TimeChatOut),this.TimeChatOut=null},t.prototype.getNoticePush=function(){return this.IsOpenPush},t.prototype.setNoticePush=function(e){this.IsOpenPush=e,p.default.instance.setItem(d.MyRoleInfo.id+"IsOpenPush",this.IsOpenPush)},t.prototype.setCanClick=function(){var e=this;this.CanClick=!1;var t=g.default.instance.setTimeout(function(i){e.CanClick=!0,g.default.instance.clearTimeout(t)},this,800)},t.prototype.getFridList=function(){this.Fridchat||this.setFirlMassage();var e=[];for(var t in this.fridList)e.push(this.fridList[t]);return e.sort(this.chatFieldListSort),e},t.prototype.chatFieldListSort=function(e,t){var n=i.instance.newMsg;return n[e.actorId]<-1&&n[t.actorId]>-1?1:e.online&&t.online?e.fight<t.fight?1:e.fight>t.fight?-1:0:!e.online&&t.online?1:e.online&&!t.online?-1:e.fight<t.fight?1:e.fight>t.fight?-1:0},t.prototype.listNotification=function(){this.addProto("chat",this.getChatmessage,this),this.addProto("tipmsg",this.setTipMsg,this),this.addProto("chaterr",this.chaterr,this)},t.prototype.setFirlMassage=function(){if(!this.Fridchat){var e=p.default.instance.getItem(d.MyRoleInfo.id+"FridChat");if(this.Fridchat=e||new Object,e)for(var t in this.Fridchat)this.getFridinfobyId(t)||delete this.Fridchat[t]}if(!this.fridList){this.fridList=new Object;e=r.default.instance.getFriendArr();for(var t in e)this.fridList[e[t].actorId]=e[t]}},t.prototype.clearFriendsId=function(e){this.fridList||this.setFirlMassage();var t=this.ChooseFrid;t&&t.actorId==e&&(this.ChooseFrid=null,delete this.Fridchat[e]),delete this.fridList[e]},t.prototype.addFriendsId=function(e){this.fridList||this.setFirlMassage(),this.fridList[e.actorId]=e},t.prototype.removeFriendIdNew=function(e){delete this.Fridchat[e],p.default.instance.setItem(d.MyRoleInfo.id+"FridChat",this.Fridchat)},t.prototype.addMsgId=function(e){d.MyRoleInfo.id==e+""||this.ChooseFrid&&this.ChooseFrid.actorId==e||-1==this.newMsg.indexOf(e)&&this.newMsg.push(e)},t.prototype.removeMsgId=function(e){var t=this.newMsg.indexOf(e);t>-1&&this.newMsg.splice(t,1)},t.prototype.setFriendsId=function(e){if(e){if(e.id)this.ChooseFrid=e,this.ChooseFrid.actorId=e.id;else{if(this.ChooseFrid=this.getFridinfobyId(e),this.ChooseFrid||(this.ChooseFrid=this.fridList[e]),!this.ChooseFrid)return;this.ChooseFrid.id=this.ChooseFrid.actorId}this.FridnewSrot.indexOf(this.ChooseFrid.id)>-1&&this.FridnewSrot.splice(this.FridnewSrot.indexOf(this.ChooseFrid.id),1),this.FridnewSrot.unshift(this.ChooseFrid.id),this.fridList||this.setFirlMassage(),this.fridList[this.ChooseFrid.id]=this.ChooseFrid,this.removeMsgId(this.ChooseFrid.actorId)}},t.prototype.getFridmessage=function(e){var t=d.MyRoleInfo.id==e.actorId+""?this.ChooseFrid.actorId:e.actorId,i=this.getFridinfobyId(t);if(i||(i=e.info?e.info:this.ChooseFrid),i){var n={cmd:"frichat",id:e.actorId,gender:e.actorId==d.MyRoleInfo.id?d.MyRoleInfo.sex:i.gender,icon:e.info.icon,name:e.actorId==d.MyRoleInfo.id?d.MyRoleInfo.name:i.name,word:e.info.word,actorId:e.actorId,viplv:e.info.viplv,level:e.actorId==d.MyRoleInfo.id?d.MyRoleInfo.level:i.level,channel:e.channel};this.Fridchat||this.setFirlMassage(),this.Fridchat[t]||(this.Fridchat[t]=[]),this.Fridchat[t].push(n),this.FridnewTips[t]=!0,this.FridnewSrotopen&&(this.FridnewSrot.indexOf(t)>-1&&this.FridnewSrot.splice(this.FridnewSrot.indexOf(t),1),this.FridnewSrot.unshift(t)),d.MyRoleInfo.id!=e.actorId&&(this.addMsgId(e.actorId),i.id?i.actorId=i.id:i.id=i.actorId,this.FridnewSrot.indexOf(i.id)>-1&&this.FridnewSrot.splice(this.FridnewSrot.indexOf(i.id),1),this.FridnewSrot.unshift(i.id),this.fridList[i.id]=i);var r={};for(var s in this.Fridchat)if(this.getFridinfobyId(s)){var l=this.Fridchat[s];if(l.length>this.UpperLimit){var c=l.length-1-this.UpperLimit;l.splice(c,l.length-1)}r[s]=l}p.default.instance.setItem(d.MyRoleInfo.id+"FridChat",r),o.GameEventDispatcher.instance.emit(a.EventDefiner.ChatInfo,n)}},t.prototype.setTipMsg=function(e){switch(e.type){case b.ChatTipsTypeConst.SystemOperation:v.default.instance.ShowMsg(e.tip);break;case b.ChatTipsTypeConst.SystemNotice:this.sendSystemChat(e);break;case b.ChatTipsTypeConst.SystemLazyWeight:this.OpenAcquistionPathWin(e.data.items[0])}},t.prototype.OpenAcquistionPathWin=function(e){var t=this;if((3==e||20023==e)&&w.default.instance.getItemNum(20023)>0){var i=A.default.creatItem(20023,w.default.instance.getItemNum(20023)),n=w.default.instance.getItemByid(20023);T.default.instance.openWindow(S.WindowType.BatchUsageTips,function(){D.default.instance.ShowTips1("\u6279\u91cf\u4f7f\u7528",R.default.UseItembyId,t,[n.guid],i,1)})}else T.default.instance.openWindow(S.WindowType.AcquistionPathWin,function(){I.default.instance.Init(e)})},t.prototype.sendSystemChat=function(e){var t={cmd:"systemChat",msg:e.tip},i=new f.ChatNoticeVo;i.initData(t),this.Systemchat.push(i),o.GameEventDispatcher.instance.emit(a.EventDefiner.ChatNotice,i),this.MsgList.push(i),this.MsgList.length>=4&&this.MsgList.shift(),this.TimeOut||this.openTimeOut()},t.prototype.chaterr=function(e){switch(e.errno){case b.ChatErrConst.CoolingCd:var t=g.default.instance.ServerTimeMins,i=Math.ceil((e.cd-t)/1e3);v.default.instance.ShowMsg(s.default.getStr("301"+e.errno,i),this.pos);break;default:v.default.instance.ShowMsg(s.default.getStr("301"+e.errno),this.pos)}},t.prototype.getChatmessage=function(e){switch(e.channel){case b.ChatTypeConst.Word:if(this.getblackinfobyId(e.info.id))return;this.Worldchat.push(e),this.Worldchat1.push(e);var t=2*this.UpperLimit;this.Worldchat.length-t>0&&(this.Worldchat.splice(0,1),this.Worldchat1.splice(0,1)),this.TimeChatOut||this.openTimeChatOut();break;case b.ChatTypeConst.PrivateChat:e.actorId=e.info.id,this.getFridmessage(e)}},t.prototype.getFridinfobyId=function(e){var t,i=r.default.instance.getFriendArr();for(var n in i)if(i[n].actorId==e){t=i[n];break}return t},t.prototype.getblackinfobyId=function(e){for(var t=r.default.instance.getBlackLsit(),i=0;i<t.length;i++)if(t[i].actorId==e)return t[i]},t.prototype.getLinkbyId=function(e){return this.config.Link[e+""]},t.prototype.isUnlock=function(){var e=_.default.instance.data.getprivilegeData(d.MyRoleInfo.vipLevel,C.VipPrivilegeType.VIPExpression);return e&&!!e.param[0]},t.prototype.gmCall=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(t[0]instanceof Array&&(t=t[0]),!cc.sys.isNative){switch(e){case"openwin":return void B.default.instance.openWindowType(t[0]);case"addmonster":for(var n=t[4]||1,r=0;r<n;r++){var s={cardid:t[0],grade:t[1],level:t[2],self:t[3],num:1,autoUseSkill:!self};o.GameEventDispatcher.instance.emit(a.EventDefiner.C_Scene_Add_Actor,s)}return;case"fightstart":return void o.GameEventDispatcher.instance.emit(a.EventDefiner.C_Fight_Start);case"step":return void(N.default.instance._moveNum=t[0]);case"recharge":if(t[1]){if(!window.time)return void(window.time=g.default.instance.setInterval(function(){var e={cmd:"gm",type:"recharge",param:t};h.default.instance.sendProto(e)},this,10))}else window.time&&(g.default.instance.clearInterval(window.time),window.time=null);break;case"guide":L.default.instance.open=t[0],L.default.instance.curGuideEnd();for(r=1;r<=6;r++)L.default.instance.sent(r);break;case"setmodel":d.MyRoleInfo.currentsurface=t[0],console.log("\u5207\u6362\u76ae\u80a4 "+t[0]);break;case"setStep":return void(N.default.instance._moveNum=t[0]);case"shapan":return void cc.director.loadScene("SandTable")}if("openfun"==e)return void T.default.instance.openWindow(31200,function(){E.default.instance.onShowPage(t[0])},this)}t||(t=[]);var l={cmd:"gm",type:e,param:t};h.default.instance.sendProto(l),console.log("\u53d1\u9001gm\u547d\u4ee4",l)},t.instance=null,t=i=__decorate([x],t)}(n.default));i.default=k,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/TimeController":"TimeController","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../NetConnect/NetConnet":"NetConnet","../../Util/LocalStorageUtils":"LocalStorageUtils","../AcquistionPathWin/AcquistionPathWin":"AcquistionPathWin","../Commons/WindowOpenUtils":"WindowOpenUtils","../Guide/GuideNewController":"GuideNewController","../Item/ItemController":"ItemController","../Item/ItemData":"ItemData","../Item/ItemModel":"ItemModel","../LoadingPanel/LoadingPanel":"LoadingPanel","../OpenFuncTips/OpenFuncTips":"OpenFuncTips","../OpenWin/OpenWinController":"OpenWinController","../PartnerPanel/FriendsController":"FriendsController","../Role/RoleInfo":"RoleInfo","../SandTable/SandTableMain":"SandTableMain","../Scene/Controller/SceneController":"SceneController","../Tips/BatchUsageTips":"BatchUsageTips","../Tips/OpTipsController":"OpTipsController","../Vip/VipCtrl":"VipCtrl","./ChatConst":"ChatConst","./ChatNoticeController":"ChatNoticeController","./ChatNoticeVo":"ChatNoticeVo","./ChatVo":"ChatVo"}],ChatFridLaunch:[function(e,t,i){"use strict";cc._RF.push(t,"1c814hVnNFPaqzj6sSSYI2S","ChatFridLaunch"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../Gamelayer/RoleHead"),a=e("../../Core/Language"),r=e("../../Util/GrayEffect"),s=e("./ChatController"),l=e("./Chatentrance"),c=e("../../Core/CommonsResManager"),d=e("../Vip/VipLev"),p=e("../../Core/WindowType"),h=e("../OpenWin/OpenWinController"),u=cc._decorator,f=u.ccclass,g=u.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Name=null,t.Level=null,t.Online=null,t.RoleHead=null,t.Commons1=null,t.Commons2=null,t.Sex=null,t.ChatContent=null,t.infoData=null,t.Temporary=null,t.OnlineBg=null,t.vipNode=null,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.choose=function(e){var t;e?(t="bg_di_2",this.Name.node.color=cc.color(40,24,16),this.ChatContent.node.color=this.isBaoQing?cc.color(255,255,255):cc.color(40,24,16)):(this.ChatContent.node.color=this.isBaoQing?cc.color(255,255,255):cc.color(201,173,153),this.Name.node.color=cc.color(201,173,153),t="bg_di_3"),this.node.getComponent(cc.Sprite).spriteFrame=this.Commons1.getSpriteFrame(t),this.updateRed()},t.prototype.getIsChoose=function(){return this.node.getComponent(cc.Sprite).spriteFrame==this.Commons1.getSpriteFrame("bg_di_2")},t.prototype.setChatContent=function(){var e=s.default.instance.Fridchat[this.infoData.actorId];if(e){var t=e[e.length-1];if(t.word){var i=t.word,n=i.match(/0\d+/g);if(this.isBaoQing=!1,n&&n[0].length<5){this.isBaoQing=!0;var o=parseInt(i.substring(1,n[0].length));i="<img src='"+o+"'/>",this.ChatContent.imageAtlas=o>=200?l.default.instance.vipExpression:l.default.instance.expression,this.ChatContent.string=i}else this.ChatContent.string=i.length>5?i.slice(0,5)+"...":i}this.choose(this.getIsChoose())}},t.prototype.updateTem=function(){this.Temporary.node.active=!s.default.instance.getFridinfobyId(this.infoData.actorId),this.playerOline(),this.updateRed()},t.prototype.initData=function(e){this.infoData=e,this.vipNode.getComponent(d.default).setData(e.viplv,!0,function(){h.default.instance.openWindow(p.WindowType.VIP)},this),this.infoData.SiblingIndex=this.node.getSiblingIndex(),this.Level.string=e.level+"",this.Name.string=e.name.length>4?e.name.slice(0,4)+"...":e.name,this.node.attr({indexId:e.actorId,Flag:e.Flag}),e.icon&&this.RoleHead.SetHead(e.icon),this.node.name=e.actorId+"",s.default.instance.FridnewTips&&this.infoData&&s.default.instance.FridnewTips[e.actorId]&&(this.node.Flag=s.default.instance.FridnewTips[e.actorId],delete s.default.instance.FridnewTips[e.actorId]),e.gender>=0&&(this.Sex.spriteFrame=c.default.instance.getSpriteFrameByName("gender_"+e.gender)),this.node.x=0,this.setChatContent()},t.prototype.updateRed=function(){var e=s.default.instance.newMsg.indexOf(this.infoData.actorId)>-1;e&&this.getIsChoose()&&(s.default.instance.removeMsgId(this.infoData.actorId),e=!1),this.node.getChildByName("msk").active=e},t.prototype.playerOline=function(e){var t=null;if(t=this.RoleHead.getComponent(r.default)?this.RoleHead.getComponent(r.default):this.RoleHead.addComponent(r.default),this.Online.node.color=cc.color(40,24,16),this.OnlineBg.getComponent(cc.Sprite).spriteFrame=c.default.instance.getSpriteFrameByName("icon_lixian"),this.Temporary.node.active)this.infoData&&this.infoData.online?this.setOnlineState():this.infoData&&!this.infoData.online&&(t.setGray(!0),this.Online.string=a.default.getStr("state_2"));else{var i=s.default.instance.getFridinfobyId(this.infoData.actorId);i&&i.online?this.setOnlineState():(this.Online.string=a.default.getStr("state_2"),t.setGray(!0))}1==e&&(this.node.getChildByName("msk").active=!1,this.node.Flag=!1,s.default.instance.FridnewTips&&this.infoData&&s.default.instance.FridnewTips[this.infoData.actorId]&&delete s.default.instance.FridnewTips[this.infoData.actorId])},t.prototype.setOnlineState=function(){(this.RoleHead.getComponent(r.default)?this.RoleHead.getComponent(r.default):this.RoleHead.addComponent(r.default)).setGray(!1),this.Online.string=a.default.getStr("state_1"),this.Online.node.color=cc.color(55,206,25),this.OnlineBg.getComponent(cc.Sprite).spriteFrame=c.default.instance.getSpriteFrameByName("icon_zaixian")},__decorate([g(cc.Label)],t.prototype,"Name",void 0),__decorate([g(cc.Label)],t.prototype,"Level",void 0),__decorate([g(cc.Label)],t.prototype,"Online",void 0),__decorate([g(o.default)],t.prototype,"RoleHead",void 0),__decorate([g(cc.SpriteAtlas)],t.prototype,"Commons1",void 0),__decorate([g(cc.SpriteAtlas)],t.prototype,"Commons2",void 0),__decorate([g(cc.Sprite)],t.prototype,"Sex",void 0),__decorate([g(cc.RichText)],t.prototype,"ChatContent",void 0),__decorate([g(cc.Sprite)],t.prototype,"Temporary",void 0),__decorate([g(cc.Sprite)],t.prototype,"OnlineBg",void 0),__decorate([g(cc.Node)],t.prototype,"vipNode",void 0),t=__decorate([f],t)}(n.default);i.default=y,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Language":"Language","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../Util/GrayEffect":"GrayEffect","../Gamelayer/RoleHead":"RoleHead","../OpenWin/OpenWinController":"OpenWinController","../Vip/VipLev":"VipLev","./ChatController":"ChatController","./Chatentrance":"Chatentrance"}],ChatFridcell:[function(e,t,i){"use strict";cc._RF.push(t,"7138f+5IhlIuKVKfplC9yLn","ChatFridcell"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../Gamelayer/RoleHead"),a=e("../../Core/Language"),r=e("../../Util/GrayEffect"),s=e("./ChatController"),l=e("../../Core/CommonsResManager"),c=cc._decorator,d=c.ccclass,p=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Name=null,t.Online=null,t.Level=null,t.RoleHead=null,t.Sex=null,t.infoData=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),s.default.instance.FridnewTips&&this.infoData&&s.default.instance.FridnewTips[this.infoData.id]&&(this.node.Flag=s.default.instance.FridnewTips[this.infoData.id],delete s.default.instance.FridnewTips[this.infoData.id]),this.node.getChildByName("msk").active=!1},t.prototype.initData=function(e){e&&(this.infoData=e,this.infoData.SiblingIndex=this.node.getSiblingIndex(),this.Level.string=e.level+"",this.node.attr({indexId:e.id,Flag:e.Flag}),e.gender>=0&&(this.Sex.spriteFrame=l.default.instance.getSpriteFrameByName("gender_"+e.gender)),this.Name.string=e.name,e.icon&&this.RoleHead.SetHead(e.icon),this.node.name=e.id+"",s.default.instance.FridnewTips&&this.infoData&&s.default.instance.FridnewTips[this.infoData.id]&&(this.node.Flag=s.default.instance.FridnewTips[this.infoData.id],delete s.default.instance.FridnewTips[this.infoData.id]),this.playerOline())},t.prototype.getOnLineTime=function(){var e=(new Date).getTime()-this.infoData.lastlogouttime,t=Math.floor(e/864e5),i=Math.floor(e/36e5),n=Math.floor(e/6e4);return(t>0?a.default.getStr("day",t):i>0?a.default.getStr("hours",i):n>0?a.default.getStr("minutes",n):a.default.getStr("oneMinute"))+a.default.getStr("qian")},t.prototype.playerOline=function(e){var t=null;t=this.RoleHead.getComponent(r.default)?this.RoleHead.getComponent(r.default):this.RoleHead.addComponent(r.default),this.infoData&&this.infoData.online?(this.Online.string=a.default.getStr("state_1"),t.setGray(!1)):this.infoData&&!this.infoData.online&&(this.Online.string=this.getOnLineTime(),t.setGray(!0)),1==e&&(this.node.Flag=!1,s.default.instance.FridnewTips&&this.infoData&&s.default.instance.FridnewTips[this.infoData.id]&&delete s.default.instance.FridnewTips[this.infoData.id])},__decorate([p(cc.Label)],t.prototype,"Name",void 0),__decorate([p(cc.Label)],t.prototype,"Online",void 0),__decorate([p(cc.Label)],t.prototype,"Level",void 0),__decorate([p(o.default)],t.prototype,"RoleHead",void 0),__decorate([p(cc.Sprite)],t.prototype,"Sex",void 0),t=__decorate([d],t)}(n.default);i.default=h,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Language":"Language","../../Core/Widget":"Widget","../../Util/GrayEffect":"GrayEffect","../Gamelayer/RoleHead":"RoleHead","./ChatController":"ChatController"}],ChatNoticeController:[function(e,t,i){"use strict";cc._RF.push(t,"de882mduA9JoJ9ikAKgfCaQ","ChatNoticeController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../Util/Utils"),a=e("../../Core/WindowType"),r=e("../../Core/TimeController"),s=e("../../Core/LoadManager"),l=e("../../GlobalContext"),c=cc._decorator,d=c.ccclass,p=c.property,h=function(e){function t(){var t=e.call(this)||this;return t.nodes=null,t.Item=null,t.pos=[220,160,100],t.moveNum=70,t.time={},t.stopTime=1e4,t.index=0,i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this),s.default.instance.loadResByType(l.GlobalContext.Root+"prefab/Chat/Notice",cc.Prefab,this.loadComPlete,this)},t.prototype.loadComPlete=function(e,t){this.Item=e},t.prototype.Clear=function(){for(var e=this.nodes.childrenCount-1;e>=0;e--){var t=this.nodes.children[e];t.stopAllActions(),this.clearMsg(t)}this.index=0},t.prototype.clearMsg=function(e){if(e){o.default.setNodeToPool(a.PoolType.ChatNotice,e);var t=this.time[e.name];r.default.instance.clearTimeout(t),delete this.time[e.name]}},t.prototype.ShowMsg=function(e){var t=this;if(this.Item){3==this.nodes.childrenCount&&this.clearMsg(this.nodes.children[0]);var i=o.default.getNodeByPool(a.PoolType.ChatNotice,this.Item),n=this.index++;this.time[n]=r.default.instance.setTimeout(function(e){var i=t.nodes.getChildByName(e+"");t.clearMsg(i)},this,this.stopTime,n),i.setPosition(0,this.pos[this.nodes.childrenCount]),i.name=n+"",this.nodes.addChild(i),i.getComponent("ChatNotice").initData(e)}},t.prototype.update=function(){if(this.nodes){var e=this.nodes.children;if(e.length&&e[0].y!==this.pos[0])for(var t=0;t<e.length;t++)e[t].y=this.pos[t]}},t.prototype.ShowMsgHandle=function(e){e.runAction(cc.spawn(cc.scaleTo(.5,1,1),cc.fadeIn(.5)))},t.instance=null,__decorate([p(cc.Node)],t.prototype,"nodes",void 0),t=i=__decorate([d],t)}(n.default);i.default=h,cc._RF.pop()},{"../../Core/Controller":"Controller","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils"}],ChatNoticeVo:[function(e,t,i){"use strict";cc._RF.push(t,"009a0ojry9MZ5EwqVoxNRYr","ChatNoticeVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(){this.cmd=null,this.Msg=null}return e.prototype.initData=function(e){this.Msg=e.msg,this.cmd=e.cmd},e}();i.ChatNoticeVo=n,cc._RF.pop()},{}],ChatNotice:[function(e,t,i){"use strict";cc._RF.push(t,"2bf7cim2MJBnp2YlAo5dr7s","ChatNotice"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../OpenWin/OpenWinController"),a=e("../../Core/WindowType"),r=e("./Chatwin"),s=e("./ChatController"),l=e("../../Core/TimeController"),c=cc._decorator,d=c.ccclass,p=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.RichText=null,t.maxWidth=880,t.wid=350,t.speedWidth=4,t.moveWidth=null,t.moveDirection=null,t.isDing=null,t.initX=null,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.hide=function(){e.prototype.hide.call(this)},t.prototype.initData=function(e){var t=this;this.RichText.string="<img src='icon_xitongxx'/>"+e.Msg,this.isDing=!1,this.RichText.node.x=1e3,this.RichText.node.scaleX=this.RichText.node.scaleY=0;var i=l.default.instance.setTimeout(function(){var e=t.RichText.node.width;t.RichText.node.x=e,t.moveWidth=e,e>t.maxWidth?(t.moveWidth=e-t.maxWidth,t.RichText.node.x=t.maxWidth,t.node.width=t.wid+t.maxWidth):t.node.width=e+t.wid,t.initX=t.RichText.node.x,t.RichText.node.parent.width=t.initX+10,l.default.instance.clearTimeout(i),t.RichText.node.scaleX=t.RichText.node.scaleY=1,t.isDing=!0},this,100)},t.prototype.update=function(){if(this.isDing){var e=this.RichText.node;Math.abs(e.x-this.initX)<this.moveWidth&&(e.x-=this.speedWidth)}},t.prototype.clickChatNotice=function(){s.default.instance.CanClick&&o.default.instance.openWindow(a.WindowType.ChatWin,function(){r.default.instance.ToggleBtn(null,"3"),r.default.instance.scrollTobottom(null,1)},this)},__decorate([p(cc.RichText)],t.prototype,"RichText",void 0),t=__decorate([d],t)}(n.default);i.default=h,cc._RF.pop()},{"../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../OpenWin/OpenWinController":"OpenWinController","./ChatController":"ChatController","./Chatwin":"Chatwin"}],ChatSystemInfo:[function(e,t,i){"use strict";cc._RF.push(t,"cb0b7y482dIhKvv/oNNKCMG","ChatSystemInfo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=cc._decorator,a=o.ccclass,r=o.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Bg=null,t.richText=null,t}return __extends(t,e),t.prototype.initChatinfo=function(e){this.richText.lineHeight=30,this.richText.string=e.Msg,this.richText.node.width>=440&&(this.richText.maxWidth=440),this.richText.node.parent.height=this.richText.node.height,this.richText.node.parent.width=this.richText.node.width},__decorate([r(cc.Sprite)],t.prototype,"Bg",void 0),__decorate([r(cc.RichText)],t.prototype,"richText",void 0),t=__decorate([a],t)}(n.default);i.default=s,cc._RF.pop()},{"../../Core/Widget":"Widget"}],ChatTips:[function(e,t,i){"use strict";cc._RF.push(t,"5c31ajAg+BITb+eoedbcxHR","ChatTips"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("./ChatController"),a=e("../../Core/Language"),r=e("../PartnerPanel/FriendsController"),s=e("../../Core/GameEventDispatcher"),l=e("../../Core/Event"),c=e("../Gamelayer/RoleHead"),d=e("./Chatwin"),p=e("../Tips/OpTipsController"),h=e("../Role/RoleInfo"),u=e("../../Core/CommonsResManager"),f=e("../OpenWin/OpenWinController"),g=e("../../Core/WindowType"),y=e("../PartnerPanel/FriendUtils"),m=cc._decorator,C=m.ccclass,v=m.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.RoleHead=null,t.Name=null,t.Sex=null,t.Link=null,t.maskInput=null,t.Level=null,t.content=null,t.LinkPool=new cc.NodePool,t.infoData=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),this.maskInput&&(this.maskInput.active=!0,this.maskInput.on("touchstart",this.closehide,this))},t.prototype.hide=function(){e.prototype.hide.call(this),this.maskInput&&(this.maskInput.active=!1,this.maskInput.off("touchstart",this.closehide,this));for(var t=this.LinkPool.size()-1;t>0;t--)this.LinkPool.get().destroy()},t.prototype.closehide=function(){this.node.active=!1},t.prototype.initData=function(e,t){void 0===e&&(e=1),t.id||(t.id=t.actorId),this.infoData=t;var i=o.default.instance.config;this.Name.string=t.name,this.Sex.spriteFrame=u.default.instance.getSpriteFrameByName("gender_"+t.gender),this.Level.string=""+(t.level?t.level:1),this.RoleHead.getComponent(c.default).SetHead(t.icon);var n=[],a=i.Link;1==e?n=i.ChatConf[1].WorldChatLink.concat():2==e&&(n=i.ChatConf[1].FridChatLink.concat());for(var r=0;r<n.length;r++){var s=void 0;r<this.content.childrenCount?s=this.content.children[r]:(this.LinkPool.size()>0?s=this.LinkPool.get():((s=cc.instantiate(this.Link)).active=!0,s.getComponent(cc.Button).target=s),this.content.addChild(s)),this.content.children[r].active=!0,o.default.instance.getFridinfobyId(t.id)||1!=n[r]||(n[r]=6),o.default.instance.getFridinfobyId(t.id)&&6==n[r]&&(n[r]=1),o.default.instance.getblackinfobyId(t.id)&&5==n[r]&&(n[r]=7),s.name=n[r]+"";var l=t.id;l||(l=t.actorId),s.attr({linkId:n[r],actorId:l,data:t}),s.getComponentInChildren(cc.Label).string=a[n[r]].Linkname}if(this.content.childrenCount>n.length)for(var d=this.content.childrenCount-1;d<=n.length;d--)this.content.children[d].active=!1,this.LinkPool.put(this.content.children[d]);this.node.active=!0},t.prototype.openLink=function(e){var t=e.currentTarget.linkId,i=e.currentTarget.actorId,n=e.currentTarget.data,c=!1;switch(n.serverid||(c=!!o.default.instance.fridList[i]),c||(c=n.serverid==h.MyRoleInfo.serverid),t){case 1:r.default.instance.delfri(i);break;case 2:case 3:break;case 4:s.GameEventDispatcher.instance.emit(l.EventDefiner.Chatdelfrid,i);break;case 5:var u=r.default.instance;if(u.cfg[1].maxShieldNum<u.data.blackArr.length+1)return void p.default.instance.ShowMsg(a.default.getStr("BlacklistUpLimit"));r.default.instance.addblack(i),p.default.instance.ShowMsg(a.default.getStr("3500")),s.GameEventDispatcher.instance.emit(l.EventDefiner.Chatdelfrid,i),o.default.instance.clearFriendsId(i);break;case 6:if(!c)return void p.default.instance.ShowMsg(a.default.getStr("3002"));r.default.instance.reqaddfri(i);break;case 7:r.default.instance.delblack(i);break;case 8:if(!c)return void p.default.instance.ShowMsg(a.default.getStr("3005"));o.default.instance.setFriendsId(n),f.default.instance.openWindow(g.WindowType.ChatWin,function(){d.default.instance.ToggleBtn(null,"2",i)},this);break;case 9:y.FriendUtils.onClickFriend(i)}this.node.active=!1},__decorate([v(c.default)],t.prototype,"RoleHead",void 0),__decorate([v(cc.Label)],t.prototype,"Name",void 0),__decorate([v(cc.Sprite)],t.prototype,"Sex",void 0),__decorate([v(cc.Node)],t.prototype,"Link",void 0),__decorate([v(cc.Node)],t.prototype,"maskInput",void 0),__decorate([v(cc.Label)],t.prototype,"Level",void 0),__decorate([v(cc.Node)],t.prototype,"content",void 0),t=__decorate([C],t)}(n.default);i.default=_,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../Gamelayer/RoleHead":"RoleHead","../OpenWin/OpenWinController":"OpenWinController","../PartnerPanel/FriendUtils":"FriendUtils","../PartnerPanel/FriendsController":"FriendsController","../Role/RoleInfo":"RoleInfo","../Tips/OpTipsController":"OpTipsController","./ChatController":"ChatController","./Chatwin":"Chatwin"}],ChatVo:[function(e,t,i){"use strict";cc._RF.push(t,"a1a00WU1+RPS6rIFiob8u7M","ChatVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){return function(e){for(var t in this.cmd=null,this.gender=null,this.icon=null,this.id=null,this.lineheight=null,this.name=null,this.word=null,this.serverid=null,this.level=null,this.viplv=null,e)this[t]=e[t]}}();i.ChatVo=n,cc._RF.pop()},{}],Chatentrance:[function(e,t,i){"use strict";cc._RF.push(t,"a6609yftQ1D7JlxVM6Hf+sV","Chatentrance"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/WindowType"),a=e("../../Core/Language"),r=e("../../Core/GameEventDispatcher"),s=e("../../Core/Event"),l=e("./Chatwin"),c=e("../Role/RoleInfo"),d=e("./ChatController"),p=e("../OpenWin/OpenWinController"),h=e("../../Core/TimeController"),u=e("./ChatConst"),f=cc._decorator,g=f.ccclass,y=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.richText=null,t.chatTips=null,t.spriteType=null,t.spriteAtlas=null,t.getActorId="",t.showTips=!0,t.expression=null,t.vipExpression=null,t}var i;return __extends(t,e),i=t,t.prototype.show=function(){e.prototype.show.call(this),this.chatTips.active=!1,i.instance=this,this.richText.node.height=60,this.chatTips.getComponentInChildren(cc.Label).string=a.default.getStr("Chat_Tips4"),this.richText.string=a.default.getStr("Chat_Tips1"),r.GameEventDispatcher.instance.on(s.EventDefiner.ChatInfo,this.getNewmeassage,this)},t.prototype.onShowRich=function(){var e=this;h.default.instance.setTimeout(function(){e.richText.node.height>40?(e.richText.maxWidth=350,e.richText.string="           "+e.richText.string,e.richText.node.x=-150,e.spriteType.node.y=12,e.richText.node.height=60):(e.richText.maxWidth=300,e.richText.string=e.richText.string,e.richText.node.x=-95,e.spriteType.node.y=0)},this,1)},t.prototype.OpenChatWin=function(e,t){var i=this;void 0===e&&(e="1"),d.default.instance.setFriendsId(t),p.default.instance.openWindow(o.WindowType.ChatWin,function(){l.default.instance.ToggleBtn(null,e,t),i.chatTips.active=!1},this)},t.prototype.getNewmeassage=function(e){var t=e.detail,n=t.info?t.info:t;switch(t.channel){case u.ChatTypeConst.Word:var o=n.word;if(999==n.id)this.richText.string="\u7cfb\u7edf\u6d88\u606f: "+o,this.spriteType.spriteFrame=this.spriteAtlas.getSpriteFrame("i18n_icon_12");else{var a=o.match(/0\d+/g);if(a&&a[0].length>1&&a[0].length<=4&&parseInt(a[0])>0){var r=parseInt(o.substring(1,a[0].length));o="<img src='"+r+"'/>",this.richText.imageAtlas=r>=200?i.instance.vipExpression:i.instance.expression,this.richText.string=n.name+": "+o}else this.richText.string=n.name+": "+o}break;case u.ChatTypeConst.PrivateChat:n.id!=c.MyRoleInfo.id&&this.showTips&&(this.chatTips.active=!0),this.getActorId=n.id}},t.prototype.openNewmessage=function(e,t){this.OpenChatWin(t,this.getActorId)},t.instance=null,__decorate([y(cc.RichText)],t.prototype,"richText",void 0),__decorate([y(cc.Node)],t.prototype,"chatTips",void 0),__decorate([y(cc.Sprite)],t.prototype,"spriteType",void 0),__decorate([y(cc.SpriteAtlas)],t.prototype,"spriteAtlas",void 0),__decorate([y(cc.SpriteAtlas)],t.prototype,"expression",void 0),__decorate([y(cc.SpriteAtlas)],t.prototype,"vipExpression",void 0),t=i=__decorate([g],t)}(n.default);i.default=m,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../OpenWin/OpenWinController":"OpenWinController","../Role/RoleInfo":"RoleInfo","./ChatConst":"ChatConst","./ChatController":"ChatController","./Chatwin":"Chatwin"}],Chatwin:[function(e,t,i){"use strict";cc._RF.push(t,"cfbfbonCiVF5pVoXxddq1jg","Chatwin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Language"),o=e("../../Core/Window"),a=e("../../NetConnect/NetConnet"),r=e("../../Core/GameEventDispatcher"),s=e("../../Core/Event"),l=e("../Role/RoleInfo"),c=e("./ChatController"),d=e("../PartnerPanel/FriendsController"),p=e("./ChatFridLaunch"),h=e("./ChatFridcell"),u=e("./ChatTips"),f=e("../Tips/OpTipsController"),g=e("./ChatCell"),y=e("./Chatentrance"),m=e("../../Core/WindowType"),C=e("../../Core/WindowManager"),v=e("./ChatSystemInfo"),_=e("../../Core/TimeController"),b=e("../Gamelayer/ClickLayer"),T=e("../OpenWin/OpenWinController"),S=e("../Tips/TipsWinController"),I=cc._decorator,w=I.ccclass,D=I.property,R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.inputContent=null,t.BgWhite=null,t.channel=null,t.fridNum=null,t.fridOnline=null,t.content=null,t.MskInput=null,t.fridList=null,t.TypeList=null,t.fridContent=null,t.NewmessageTip=null,t.ChatTips=null,t.SendBtn=null,t.ClickChatBtn=null,t.Sysmask=null,t.InputBox=null,t.contentscroll=null,t.contentcell=[],t.fridCell=null,t.BgWidget=null,t.pageview=null,t.Expression=null,t.VipExpression=null,t.VipPageview=null,t.toggle=null,t.frilistwid=400,t.frilistspeed=20,t.ToggleNotice=null,t.BgW=732,t.Channelcontent=null,t.Messagecontent=null,t.cellPool_left=new cc.NodePool,t.cellPool_right=new cc.NodePool,t.cellPool_system=new cc.NodePool,t.fridCellPool=new cc.NodePool,t.FieldCellPool=new cc.NodePool,t.expressionPool=new cc.NodePool,t.vipExpressionPool=new cc.NodePool,t.showopen=!0,t.chooseFrid=null,t.onlineCount=0,t.ChannelNum=0,t.newMessagecount=0,t.noMessagecount="",t.fristshow=!0,t.contentposi=["","",""],t.expressionAtlas=null,t.VipExpressionAtlas=null,t.fridmove=!1,t.closemove=!1,t.chooseName="toggle1",t.w1=null,t.w2=null,t.w3=null,t.tipPos=[{x:-400,y:0},{x:-860,y:80},{x:-860,y:-80}],t.initId=999,t.isDong=[!0,!0],t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){i.instance=this},t.prototype.start=function(){e.prototype.start.call(this),this.SendBtn.getComponentInChildren(cc.Label).string=n.default.getStr("sendBtn"),this.ClickChatBtn.getComponentInChildren(cc.Label).string=n.default.getStr("3000"),this.Sysmask.getComponentInChildren(cc.Label).string=n.default.getStr("channel_4"),this.MskInput.getComponentInChildren(cc.Label).string=n.default.getStr("Chat_Tips7"),this.NewmessageTip.getComponentInChildren(cc.Label).string=n.default.getStr("Chat_Tips5"),this.inputContent.maxLength=c.default.instance.config.ChatConf[1].ChatCount+10},t.prototype.startHide=function(){this.BgWidget.left=0,this.BgWidget.node.opacity=0,this.BgWidget.node.setScale(0)},t.prototype.show=function(){e.prototype.show.call(this),this.CloseChatTip(),this.startHide(),d.default.instance.getFriendArr(),this.expressionAtlas||(this.expressionAtlas=y.default.instance.expression),this.VipExpressionAtlas||(this.VipExpressionAtlas=y.default.instance.vipExpression),y.default.instance.showTips=!1,this.showopen=!0,this.inputContent.placeholder=n.default.getStr("Chat_Tips2"),d.default.instance.friendList(),this.ToggleBtn(null,"1"),r.GameEventDispatcher.instance.on(s.EventDefiner.ChatInfo,this.getMessage,this),r.GameEventDispatcher.instance.on(s.EventDefiner.ChatConfirm,this.ClickVipExpression,this),r.GameEventDispatcher.instance.on(s.EventDefiner.ChatNotice,this.addNoticeNew,this),r.GameEventDispatcher.instance.on(s.EventDefiner.Chatdelfrid,this.removeFireld,this),r.GameEventDispatcher.instance.on(s.EventDefiner.ChatAddfrid,this.updatePlayerState,this),this.toggle.node.on(cc.Node.EventType.MOUSE_UP,this.onClickToggle,this),this.ToggleNotice.node.on(cc.Node.EventType.TOUCH_END,this.onClickToggleNotice,this),this.contentscroll.node.on("scroll-to-bottom",this.scrollTobottom,this),this.contentscroll.node.on("scroll-began",this.hideNew,this),this.w1?(this.fridList.parent.width=this.w1,this.fridList.parent.parent.width=this.w2,this.fridList.parent.parent.parent.width=this.w3):(this.w1=this.fridList.parent.width,this.w2=this.fridList.parent.parent.width,this.w3=this.fridList.parent.parent.parent.width),this.BgWidget.node.runAction(cc.spawn(cc.scaleTo(.5,1,1),cc.fadeIn(.5))),this.updatePrivateChatRed(),this.changeFirdNum()},t.prototype.onClickToggleNotice=function(){var e=this,t=_.default.instance.setTimeout(function(){c.default.instance.setNoticePush(!e.ToggleNotice.isChecked),_.default.instance.clearTimeout(t)},this,100)},t.prototype.hide=function(){e.prototype.hide.call(this),this.startHide(),y.default.instance.showTips=!0,c.default.instance.FridnewSrotopen=!0,r.GameEventDispatcher.instance.off(s.EventDefiner.ChatInfo,this.getMessage,this),r.GameEventDispatcher.instance.off(s.EventDefiner.ChatConfirm,this.ClickVipExpression,this),r.GameEventDispatcher.instance.off(s.EventDefiner.FriDel,this.FridelList,this),r.GameEventDispatcher.instance.off(s.EventDefiner.ChatNotice,this.addNoticeNew,this),r.GameEventDispatcher.instance.off(s.EventDefiner.Chatdelfrid,this.removeFireld,this),r.GameEventDispatcher.instance.off(s.EventDefiner.ChatAddfrid,this.updatePlayerState,this),this.contentscroll.node.off("scroll-to-bottom",this.scrollTobottom,this),this.contentscroll.node.off("scroll-began",this.hideNew,this),this.ToggleNotice.node.off(cc.Node.EventType.TOUCH_END,this.onClickToggleNotice,this)},t.prototype.changeFirdNum=function(){this.fridNum.string=n.default.getStr("3007",d.default.instance.getFriendOnlineLen(),d.default.instance.getFriendLen())},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this),this.fridCellPool.clear(),this.FieldCellPool.clear(),this.cellPool_left.clear(),this.cellPool_right.clear()},t.prototype.onClickToggle=function(e){var t=e.target.name;if(this.chooseName!=t)switch(this.chooseName=t,e.target.name){case"toggle1":this.Expression.active=!0,this.VipExpression.active=!1;break;case"toggle2":this.Expression.active=!1,this.VipExpression.active=!0}},t.prototype.chooseField=function(){for(var e=this,t=0;t<this.fridContent.childrenCount;t++){var i=this.fridContent.children[t],n=i.getComponent(p.default),o=c.default.instance.ChooseFrid&&c.default.instance.ChooseFrid.actorId==n.infoData.actorId;n.choose(o),i.getComponent(p.default).playerOline(2)}2==this.ChannelNum&&this.scheduleOnce(function(){e.Messagecontent.height-e.contentscroll.node.height+60>0?(e.contentscroll.scrollToBottom(),e.NewmessageTip.active=!1):e.contentscroll.scrollToTop()},.2)},t.prototype.removeFireld=function(e){var t=e.detail;c.default.instance.removeFriendIdNew(t);var i=this.content.getChildByName("content2").getChildByName(t.toString());i&&i.removeAllChildren()},t.prototype.addNoticeNew=function(e){3==this.ChannelNum&&this.getMessage(e)},t.prototype.ToggleBtn=function(e,t,i){var o=this;if("string"==typeof t){c.default.instance.FridnewSrotopen=!0,this.ChannelNum&&(this.contentposi[this.ChannelNum-1]=this.contentscroll.getContentPosition()),this.Expression.active=!1,this.VipExpression.active=!1,this.toggle.node.active=!1,this.ChannelNum=Number(t),this.channel.string=n.default.getStr("channel_"+t);for(var a=1;a<=3;a++){this.content.getChildByName("content"+a).active=a==this.ChannelNum}this.Channelcontent=this.content.getChildByName("content"+this.ChannelNum),this.Messagecontent=this.Channelcontent;for(a=0;a<this.TypeList.childrenCount;a++)this.TypeList.children[a].getComponent(cc.Toggle).isChecked=!1;switch(this.TypeList.children[this.ChannelNum-1].getComponent(cc.Toggle).isChecked=!0,this.inputContent.string="",this.InputBox.active=!0,this.NewmessageTip.active=!1,this.Sysmask.active=!1,r.GameEventDispatcher.instance.off(s.EventDefiner.FriOnline,this.FriOnline,this),t){case"1":this.clearChooseState(),this.MskInput.active=!1;for(a=this.Channelcontent.childrenCount;a<c.default.instance.Worldchat.length;a++){var l={detail:c.default.instance.Worldchat[a]};this.getMessage(l,0)}this.isAutoScroll();break;case"2":for(a=0;a<this.Channelcontent.childrenCount;a++)this.Channelcontent.children[a].active=!1;for(var d in c.default.instance.FridnewSrotopen=!1,this.switchChoose(i),this.fridContent.children)this.fridContent.children[d].getComponent(p.default).setChatContent();r.GameEventDispatcher.instance.on(s.EventDefiner.FriDel,this.FridelList,this),r.GameEventDispatcher.instance.on(s.EventDefiner.FriOnline,this.FriOnline,this);break;case"3":this.clearChooseState(),this.MskInput.active=!1,this.InputBox.active=!1,this.Sysmask.active=!0,this.isDong[1]=this.Channelcontent.childrenCount>=c.default.instance.Systemchat.length,this.ToggleNotice.isChecked=!c.default.instance.getNoticePush(),this.isAutoScroll()}this.contentposi[this.ChannelNum-1]&&""!=this.contentposi[this.ChannelNum-1]&&!i?this.contentscroll.setContentPosition(this.contentposi[this.ChannelNum-1]):i&&this.scheduleOnce(function(){o.scrollTobottom(null,1)},.3),this.fridmove=!0}},t.prototype.clickDown=function(){var e=this;if(3===this.ChannelNum)for(var t=function(t){var n={detail:c.default.instance.Systemchat[t]},o=_.default.instance.setTimeout(function(t){e.getMessage(t),_.default.instance.clearInterval(o)},i,100,n)},i=this,n=this.Channelcontent.childrenCount;n<c.default.instance.Systemchat.length;n++)t(n)},t.prototype.updatePrivateChatRed=function(){cc.find("Frid/Label/red",this.TypeList).active=!!c.default.instance.newMsg.length},t.prototype.clearChooseState=function(){c.default.instance.ChooseFrid=this.chooseFrid=null,this.chooseField()},t.prototype.switchChoose=function(e){e||this.clearChooseState();var t=c.default.instance.ChooseFrid;t&&(this.chooseFrid=t),this.MskInput.active=!this.chooseFrid,this.InputBox.active=!!this.chooseFrid,this.friList(e),this.chooseField()},t.prototype.CloseChatTip=function(){this.ChatTips.active=!1},t.prototype.confirmInput=function(){var e=null,t=this.inputContent.string;if(t.indexOf("gm(")>=0){var i=t.slice(t.indexOf("(")+1,t.length-1).split(","),o=i.shift();c.default.instance.gmCall(o,i)}else if(l.MyRoleInfo.level<c.default.instance.openLevel)f.default.instance.ShowMsg(n.default.getStr("Chat_Tips8",c.default.instance.openLevel),c.default.instance.pos);else{switch(this.ChannelNum){case 1:e={cmd:"chat",word:t,channel:0};break;case 2:e={cmd:"chat",word:t,channel:1,recvid:this.chooseFrid.actorId},this.fridContent.getChildByName(this.chooseFrid.actorId+"").setSiblingIndex(0)}a.default.instance.sendProto(e),this.inputContent.string=""}},t.prototype.getMessage=function(e,t){var i=this,n=e.detail,o=n.info?n.info.id:n.id;if(2!=this.ChannelNum||this.Messagecontent.name==o||"frichat"==e.detail.cmd){var a=c.default.instance.config.ChatConf[1].ChatCountLineCount,r=n.info?n.info:n,s=["chat","frichat","systemChat"];if(s[this.ChannelNum-1]!=n.cmd||2==this.ChannelNum&&(!this.chooseFrid||this.chooseFrid&&this.chooseFrid.actorId!=o&&o!=l.MyRoleInfo.id))return n.cmd==s[1]&&this.fridContent.getChildByName(o+"")&&(this.fridContent.getChildByName(o.toString()).getChildByName("msk").active=!0,this.fridContent.getChildByName(o.toString()).setSiblingIndex(0),this.fridContent.getChildByName(o.toString()).getComponent(p.default).setChatContent()),void this.updatePrivateChatRed();if(this.chooseFrid&&!t&&o&&o!=l.MyRoleInfo.id&&n.cmd==s[1]&&(this.fridContent.getChildByName(o.toString()).setSiblingIndex(0),delete c.default.instance.FridnewTips[o]),"systemChat"!=n.cmd){if(this.Messagecontent.childrenCount>=a&&c.default.instance.Worldchat1.length<=0){switch(n.cmd){case"chat":c.default.instance.Worldchat.shift();break;case"frichat":c.default.instance.Fridchat[o].shift()}for(var d=this.Messagecontent.childrenCount-a;d>=0;d--)"chat"!=n.cmd||this.Messagecontent.children[d].indexId!=this.initId?this.Messagecontent.children[d].indexId!=l.MyRoleInfo.id?(this.Messagecontent.children[d].off("touchstart",this.openChatTips,this),this.cellPool_left.put(this.Messagecontent.children[d])):this.cellPool_right.put(this.Messagecontent.children[d]):this.Messagecontent.removeChild(this.Messagecontent.children[d])}}else if(this.Messagecontent.childrenCount>=a)for(d=this.Messagecontent.childrenCount-a;d>=0;d--)this.Messagecontent.removeChild(this.Messagecontent.children[d]),c.default.instance.Systemchat.splice(0,1),0==t&&(this.contentscroll.getScrollOffset().y+=this.Messagecontent.children[d].height);var h=null;if(3!=this.ChannelNum)if(o==this.initId){if(this.Messagecontent.getChildByName(this.initId+""))return;(h=this.cellPool_system.size()>0?this.cellPool_system.get():cc.instantiate(this.contentcell[2])).getComponent(v.default).initChatinfo({Msg:n.word}),h.name=this.initId+""}else{o==l.MyRoleInfo.id?(2==this.ChannelNum&&(o=this.chooseFrid?this.chooseFrid.actorId+"":o),h=this.cellPool_right.size()>0?this.cellPool_right.get():cc.instantiate(this.contentcell[1])):(h=this.cellPool_left.size()>0?this.cellPool_left.get():cc.instantiate(this.contentcell[0]),cc.find("RoleInfo/RoleHead",h)&&cc.find("RoleInfo/RoleHead",h).on("touchstart",this.openChatTips,this)),h.getComponent(g.default).initChatinfo(r,1==this.ChannelNum);var u=this.fridContent.getChildByName(o+"");u&&u.getComponent(p.default).setChatContent()}else(h=this.cellPool_system.size()>0?this.cellPool_system.get():cc.instantiate(this.contentcell[2])).getComponent(v.default).initChatinfo(r);var f=this.Messagecontent.height-this.contentscroll.node.height;if(this.Messagecontent.addChild(h),2!=this.ChannelNum){var y=!0;this.contentscroll.getScrollOffset().y<f&&(y=!1),y&&0==t&&(y=!1),this.scheduleOnce(function(){o==l.MyRoleInfo.id&&3!==i.ChannelNum&&(y=!0),i.Messagecontent.height-i.contentscroll.node.height+60>0?y?(i.contentscroll.scrollToBottom(),i.NewmessageTip.active=!1):(i.NewmessageTip.active=!0,i.dongDi(!1)):(i.contentscroll.scrollToTop(),i.dongDi(!0))},.3)}else this.scheduleOnce(function(){i.Messagecontent.height-i.contentscroll.node.height+60>0?(i.contentscroll.scrollToBottom(),i.NewmessageTip.active=!1):(i.contentscroll.scrollToTop(),i.dongDi(!0))},.3)}},t.prototype.dongDi=function(e){if(2!==this.ChannelNum){var t;t=1==this.ChannelNum?0:1,this.isDong[t]=e}},t.prototype.isAutoScroll=function(){var e;e=1==this.ChannelNum?0:1,this.NewmessageTip.active=!this.isDong[e]},t.prototype.openChatFirdTips=function(e){if(this.ChatTips.active)this.ChatTips.active=!1;else{var t,i=e.target.parent.getComponent(p.default);i&&(t=i.infoData,this.ChatTips.active=!0,this.ChatTips.getComponent(u.default).initData(this.ChannelNum,t));var n;n=b.default.instance.clickPos.y<320?2:1,this.ChatTips.x=this.tipPos[n].x,this.ChatTips.y=this.tipPos[n].y}},t.prototype.openChatTips=function(e){var t;t=e.target.parent.parent.getComponent(g.default)?e.target.parent.parent.getComponent(g.default).infoData:e.target.parent.getComponent(h.default).infoData,this.ChatTips.active=!0,this.ChatTips.getComponent(u.default).initData(this.ChannelNum,t),this.ChatTips.x=this.tipPos[0].x,this.ChatTips.y=this.tipPos[0].y},t.prototype.hideNew=function(){this.NewmessageTip.active=!1},t.prototype.scrollTobottom=function(e,t){(this.dongDi(!0),this.NewmessageTip.active=!1,this.clickDown(),this.contentposi[this.ChannelNum-1]=this.contentscroll.getContentPosition(),t)&&(this.Messagecontent.height-this.contentscroll.node.height>0&&this.contentscroll.scrollToBottom())},t.prototype.updatePlayerState=function(){var e=c.default.instance.fridList;for(var t in e){var i=this.fridContent.getChildByName(t);i&&(i.getComponent(p.default).infoData.online=e[t].online,i.getComponent(p.default).updateTem())}this.changeFirdNum()},t.prototype.friList=function(e){var t=c.default.instance.getFridList();if(e&&(this.MskInput.active=!1),t&&0==this.fridContent.childrenCount){for(var i=0;i<t.length;i++){var n=null;this.fridContent.childrenCount>i?n=this.fridContent.children[i]:(this.fridCellPool.size()>0?n=this.fridCellPool.get():((n=cc.instantiate(this.fridCell)).on(cc.Node.EventType.TOUCH_END,this.fridmessageDeal,this),cc.find("click",n).on("touchstart",this.openChatFirdTips,this)),this.fridContent.addChild(n)),t[i].Flag&&(n.getChildByName("msk").active=!0),n.getComponent(p.default).initData(t[i])}if(this.fridContent.childrenCount>t.length)for(var o=this.fridContent.childrenCount-1;o>=t.length;o--)this.fridCellPool.put(this.fridContent.children[o])}else if(t){if(t&&this.fridContent.childrenCount<t.length)for(var a=0,r=t;a<r.length;a++){var s=r[a];if(!this.fridContent.getChildByName(s.actorId+"")){var l={detail:{type:0,info:s}};this.fridAdd(l)}}else if(t&&this.fridContent.childrenCount>t.length)for(var d=0,h=this.fridContent.children;d<h.length;d++){s=h[d];for(var u=!1,f=0,g=t;f<g.length;f++){var y=g[f];if(s.indexId==y.actorId){u=!0;break}}if(!u){l={detail:{type:0,info:s.getComponent(p.default).infoData}};this.FridelList(l)}}}else for(o=this.fridContent.childrenCount-1;o>=0;o--)this.fridCellPool.put(this.fridContent.children[o]);var m=0;e&&this.fridContent.getChildByName(e+"")&&this.fridmessageDeal({currentTarget:this.fridContent.getChildByName(e+"")});for(var C=0,v=c.default.instance.FridnewSrot;C<v.length;C++){s=v[C];var _=this.fridContent.getChildByName(s+"");_&&(_.setSiblingIndex(m),m++)}c.default.instance.FridnewSrot=[],this.updatePlayerState(),this.fridList.getComponentInChildren(cc.ScrollView).scrollToTop()},t.prototype.fridmessageDeal=function(e){var t=e.currentTarget.getComponent(h.default),i=e.currentTarget.getComponent(p.default),n=t||i,o=t?t.infoData:i.infoData;this.chooseFrid!=o&&(this.NewmessageTip.active=!1),c.default.instance.removeMsgId(o.actorId),this.chooseFrid=c.default.instance.ChooseFrid=o,this.MskInput.active=!1,this.InputBox.active=!0;for(var a=this.Channelcontent.getChildByName(this.chooseFrid.actorId+""),r=0;r<this.Channelcontent.childrenCount;r++)this.Channelcontent.children[r].active=!1;if(!a){var s=cc.instantiate(this.Channelcontent.getChildByName("cell"));s.name=this.chooseFrid.actorId+"",this.Channelcontent.addChild(s),s.active=!1}a=this.Channelcontent.getChildByName(this.chooseFrid.actorId+""),this.Messagecontent=a,a.active=!0;var l=parseInt(this.Messagecontent.name);if(c.default.instance.Fridchat[l]&&c.default.instance.Fridchat[l].length>0)for(r=this.Messagecontent.childrenCount;r<c.default.instance.Fridchat[l].length;r++){var d={detail:c.default.instance.Fridchat[l][r]};this.getMessage(d,1)}this.chooseField(),n.playerOline(1),e.currentTarget.getChildByName("msk").active=!1,this.updatePrivateChatRed()},t.prototype.setExpressionNode=function(){var e=new cc.Node;e.width=676,e.height=195,e.addComponent(cc.Layout);var t=e.getComponent(cc.Layout);return t.type=cc.Layout.Type.GRID,t.spacingY=0,t.spacingX=0,t.paddingLeft=3,e},t.prototype.openExpression=function(){if(this.toggle.node.active?this.toggle.node.active=this.Expression.active=this.VipExpression.active=!1:"toggle1"==this.chooseName?(this.toggle.node.active=!this.Expression.active,this.Expression.active=!this.Expression.active,this.VipExpression.active=!1):(this.toggle.node.active=!this.VipExpression.active,this.VipExpression.active=!this.VipExpression.active,this.Expression.active=!1),!this.pageview.node.children[1].children[0].childrenCount){for(var e=this.pageview.node.getChildByName("1"),t=this.setExpressionNode(),i=this.expressionAtlas.getSpriteFrames().length,n=0,o=0;o<i;o++){21==t.childrenCount&&(this.pageview.insertPage(t,n),n++,t=this.setExpressionNode());var a=void 0;this.vipExpressionPool.size()>0?a=this.vipExpressionPool.get():((a=cc.instantiate(e)).name=this.expressionAtlas.getSpriteFrames()[o].name,a.getComponent(cc.Button).target=t),a.active=!0,a.getComponentInChildren(cc.Sprite).spriteFrame=this.expressionAtlas.getSpriteFrames()[o],t.addChild(a),o+1==i&&(this.pageview.insertPage(t,n),n++)}var r=this.VipPageview.node.getChildByName("2");t=this.setExpressionNode(),i=this.VipExpressionAtlas.getSpriteFrames().length,n=0;for(o=0;o<i;o++){6==t.childrenCount&&(this.VipPageview.insertPage(t,n),n++,t=this.setExpressionNode());a=void 0;this.vipExpressionPool.size()>0?a=this.vipExpressionPool.get():((a=cc.instantiate(r)).name=this.VipExpressionAtlas.getSpriteFrames()[o].name,a.getComponent(cc.Button).target=t),a.active=!0,a.getComponentInChildren(cc.Sprite).spriteFrame=this.VipExpressionAtlas.getSpriteFrames()[o],t.addChild(a),o+1==i&&(this.VipPageview.insertPage(t,n),n++)}}},t.prototype.ClickVipExpression=function(){var e=parseInt(c.default.instance.VipExpression);this.inputContent.string="",(this.inputContent.string+"0"+e).length<=c.default.instance.config.ChatConf[1].ChatCount&&(this.inputContent.string+="0"+e),this.confirmInput()},t.prototype.chooseExpression=function(e){var t=parseInt(e.currentTarget.name);if(this.Expression.active=!1,this.VipExpression.active=!1,this.toggle.node.active=!1,t>=200&&!c.default.instance.isUnlock()){S.default.instance.ShowTips(n.default.getStr("3008"),function(){T.default.instance.openWindow(m.WindowType.VIP)},this,null,2,n.default.getStr("3010"))}else this.inputContent.string="",(this.inputContent.string+"0"+t).length<=c.default.instance.config.ChatConf[1].ChatCount&&(this.inputContent.string+="0"+t),this.confirmInput()},t.prototype.FridelList=function(e){if(0==e.detail.type){this.changeFirdNum();var t=e.detail.info.actorId+"";this.fridContent.getChildByName(t)&&this.fridCellPool.put(this.fridContent.getChildByName(t)),this.Channelcontent.getChildByName(t)&&this.Channelcontent.getChildByName(t).destroy(),this.chooseFrid&&this.chooseFrid.actorId==t&&(this.MskInput.active=!0,this.InputBox.active=!1)}},t.prototype.FriOnline=function(e){var t=e.detail.actorId;if(this.fridContent.getChildByName(t)){this.fridContent.getChildByName(t).getComponent(p.default).infoData.online=e.detail.online;var i=void 0;this.chooseFrid&&this.chooseFrid.actorId==t&&(i=1),this.fridContent.getChildByName(t).getComponent(p.default).playerOline(i)}},t.prototype.fridAdd=function(e){var t=e.detail;if(0==t.type){var i=void 0;this.fridCellPool.size()>0?i=this.fridCellPool.get():((i=cc.instantiate(this.fridCell)).on("touchstart",this.fridmessageDeal,this),cc.find("click",i).on("touchstart",this.openChatFirdTips,this));var n=(t.info.actorId,t.info.actorId),o=this.fridContent.getChildByName(n+"");o?o.getComponent(p.default).initData(t.info):(this.fridContent.addChild(i),i.getComponent(p.default).initData(t.info))}},t.prototype.EdiboxInputlength=function(e,t){if(e.length>c.default.instance.config.ChatConf[1].ChatCount?this.inputContent.string=this.noMessagecount:this.noMessagecount=e,"%%%%%"==this.inputContent.string)return this.BtnClickToOpenWin(null,m.WindowType.Cmd+""),void(this.inputContent.string="")},t.prototype.closeScene=function(){this.closemove=!0},t.prototype.update=function(e){this.fridmove&&(2==this.ChannelNum&&this.fridList.width<this.frilistwid?(this.fridList.width+=this.frilistspeed,this.fridList.parent.width+=this.frilistspeed,this.fridList.parent.parent.width+=this.frilistspeed,this.fridList.parent.parent.parent.width+=this.frilistspeed,this.BgWhite.node.width+=this.frilistspeed,this.fridList.width>=this.frilistwid&&(this.fridList.width=this.frilistwid,this.BgWhite.node.width=this.BgW+this.frilistwid,this.fridmove=!1)):this.fridList.width>10&&(this.fridList.width-=this.frilistspeed,this.fridList.parent.width-=this.frilistspeed,this.fridList.parent.parent.width-=this.frilistspeed,this.fridList.parent.parent.parent.width-=this.frilistspeed,this.BgWhite.node.width-=this.frilistspeed,this.fridList.width<=10&&(this.fridList.width=10,this.BgWhite.node.width=this.BgW,this.fridmove=!1))),this.closemove&&(this.BgWidget.left-=1.5*this.frilistspeed,this.BgWidget.left<=-this.BgWidget.node.width&&(this.closemove=!1,this.fridList.width=10,this.BgWhite.node.width=this.BgW,this.fridList.parent.parent.width=this.fridList.parent.width,C.default.instance.close(m.WindowType.ChatWin)))},t.instance=null,__decorate([D(cc.EditBox)],t.prototype,"inputContent",void 0),__decorate([D(cc.Sprite)],t.prototype,"BgWhite",void 0),__decorate([D(cc.Label)],t.prototype,"channel",void 0),__decorate([D(cc.RichText)],t.prototype,"fridNum",void 0),__decorate([D(cc.Label)],t.prototype,"fridOnline",void 0),__decorate([D(cc.Node)],t.prototype,"content",void 0),__decorate([D(cc.Node)],t.prototype,"MskInput",void 0),__decorate([D(cc.Node)],t.prototype,"fridList",void 0),__decorate([D(cc.Node)],t.prototype,"TypeList",void 0),__decorate([D(cc.Node)],t.prototype,"fridContent",void 0),__decorate([D(cc.Node)],t.prototype,"NewmessageTip",void 0),__decorate([D(cc.Node)],t.prototype,"ChatTips",void 0),__decorate([D(cc.Node)],t.prototype,"SendBtn",void 0),__decorate([D(cc.Node)],t.prototype,"ClickChatBtn",void 0),__decorate([D(cc.Node)],t.prototype,"Sysmask",void 0),__decorate([D(cc.Node)],t.prototype,"InputBox",void 0),__decorate([D(cc.ScrollView)],t.prototype,"contentscroll",void 0),__decorate([D(cc.Prefab)],t.prototype,"contentcell",void 0),__decorate([D(cc.Prefab)],t.prototype,"fridCell",void 0),__decorate([D(cc.Widget)],t.prototype,"BgWidget",void 0),__decorate([D(cc.ScrollView),D(cc.PageView)],t.prototype,"pageview",void 0),__decorate([D(cc.Node)],t.prototype,"Expression",void 0),__decorate([D(cc.Node)],t.prototype,"VipExpression",void 0),__decorate([D(cc.PageView)],t.prototype,"VipPageview",void 0),__decorate([D(cc.ToggleContainer)],t.prototype,"toggle",void 0),__decorate([D(cc.Integer)],t.prototype,"frilistwid",void 0),__decorate([D(cc.Integer)],t.prototype,"frilistspeed",void 0),__decorate([D(cc.Toggle)],t.prototype,"ToggleNotice",void 0),t=i=__decorate([w],t)}(o.default);i.default=R,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/TimeController":"TimeController","../../Core/Window":"Window","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../NetConnect/NetConnet":"NetConnet","../Gamelayer/ClickLayer":"ClickLayer","../OpenWin/OpenWinController":"OpenWinController","../PartnerPanel/FriendsController":"FriendsController","../Role/RoleInfo":"RoleInfo","../Tips/OpTipsController":"OpTipsController","../Tips/TipsWinController":"TipsWinController","./ChatCell":"ChatCell","./ChatController":"ChatController","./ChatFridLaunch":"ChatFridLaunch","./ChatFridcell":"ChatFridcell","./ChatSystemInfo":"ChatSystemInfo","./ChatTips":"ChatTips","./Chatentrance":"Chatentrance"}],ClickLayer:[function(e,t,i){"use strict";cc._RF.push(t,"1e4d4MrLBNGh5+4g8OVC5e4","ClickLayer"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../GlobalContext"),a=e("../../Core/GameEventDispatcher"),r=e("../../Core/Event"),s=cc._decorator,l=s.ccclass,c=(s.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.startposi=null,t.clickanimPool=new cc.NodePool,t.movecount=0,t.clickPos=new cc.Vec2,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this),i.instance=this,this.node.setContentSize(o.GlobalContext.UIWidth,o.GlobalContext.UIHeight),this.node.setPosition(-o.GlobalContext.UIWidth/2,-o.GlobalContext.UIHeight/2)},t.prototype.show=function(){e.prototype.show.call(this),this.node.on("touchstart",this.clickplay,this)},t.prototype.hide=function(){e.prototype.hide.call(this),this.node.off("touchstart",this.clickplay,this),this.node.off("touchmove",this.clickenddeal,this),this.clickanimPool.clear()},t.prototype.clickplay=function(e){var t=this;this.movecount=0,e.target._touchListener.setSwallowTouches(!1);var i,n=this.node.convertToNodeSpaceAR(e.getLocation());this.clickPos=n,(i=this.clickanimPool.size()>0?this.clickanimPool.get():cc.instantiate(this.node.children[0])).setPosition(n),this.node.addChild(i),i.active=!0,i.getComponent(cc.Animation).play("Clickeffect",0),i.getComponent(cc.Animation).once("finished",function(){0!=i.getSiblingIndex()&&t.clickanimPool.put(i)},this),a.GameEventDispatcher.instance.emit(r.EventDefiner.TreasureDialog),e.getLocation().x},t.prototype.clickenddeal=function(e){var t,i=this,n=this.node.convertTouchToNodeSpaceAR(e.touch);(this.movecount++,this.movecount>=3)&&(this.startposi=n,t=this.clickanimPool&&this.clickanimPool.size()>0?this.clickanimPool.get():cc.instantiate(this.node.children[0]),this.node.addChild(t),t.getComponent(cc.Animation).node.setPosition(n),t.getComponent(cc.Animation).play("Clickeffect",0),t.getComponent(cc.Animation).once("finished",function(){0!=t.getSiblingIndex()&&i.clickanimPool.put(t)},this),this.movecount=0)},t.instance=null,t=i=__decorate([l],t)}(n.default));i.default=c,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Widget":"Widget","../../GlobalContext":"GlobalContext"}],CloudMove:[function(e,t,i){"use strict";cc._RF.push(t,"d83e2hYQshLs4ARgdoiZ4eb","CloudMove"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Core/LoadManager"),a=e("../Controller/SceneController"),r=e("../../../Core/CacheManager"),s=cc._decorator,l=s.ccclass,c=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Cloud1=null,t.Cloud2=null,t.ResUrl="",t.ResName="",t.MoveSpeed=0,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this),this.checkCloudMove()},t.prototype.hide=function(){e.prototype.hide.call(this),this.Cloud1&&this.Cloud1.node.stopAllActions(),this.Cloud2&&this.Cloud2.node.stopAllActions(),this.clear()},t.prototype.clear=function(){this.clearUseRecord(),this.ResUrl=null,this.Cloud1&&this.Cloud1.isValid&&(this.Cloud1.spriteFrame=null),this.Cloud2&&this.Cloud2.isValid&&(this.Cloud2.spriteFrame=null)},t.prototype.checkCloudMove=function(){this.Cloud1&&this.Cloud2&&this.ResUrl&&""!=this.ResUrl&&(o.default.instance.loadResByType(this.ResUrl,cc.SpriteAtlas,this.loadComplete,this,[this.ResUrl]),this.setUseRecord())},t.prototype.loadComplete=function(e,t){if(this.Cloud1&&this.Cloud2&&this.ResUrl&&this.ResUrl==t){var i=e.getSpriteFrame(this.ResName),n=i.getRect().width/a.default.instance.sceneScale,o=i.getRect().height/a.default.instance.sceneScale;this.Cloud1.spriteFrame=i,this.Cloud2.spriteFrame=i,this.Cloud1.node.width=n,this.Cloud1.node.height=o,this.Cloud2.node.width=n,this.Cloud2.node.height=o,this.Cloud1.node.setPosition(0,0),this.MoveCloudFun(this.Cloud1.node),this.Cloud2.node.setPosition(n,0),this.MoveCloudFun(this.Cloud2.node)}},t.prototype.MoveCloudFun=function(e){var t=this;if(e){var i=-e.width,n=Math.abs(i-e.position.x)/this.MoveSpeed;e.runAction(cc.sequence(cc.moveTo(n,i,e.position.y),cc.callFunc(function(){e.x=-i,t.MoveCloudFun(e)},this)))}},t.prototype.dispose=function(){this.clear(),e.prototype.dispose.call(this)},t.prototype.onDestroy=function(){this.clear(),e.prototype.onDestroy.call(this)},t.prototype.clearUseRecord=function(){this.ResUrl&&""!=this.ResUrl&&r.default.instance.clearUseRecord(this.ResUrl)},t.prototype.setUseRecord=function(){this.ResUrl&&""!=this.ResUrl&&r.default.instance.setUseRecord(this.ResUrl)},__decorate([c(cc.Sprite)],t.prototype,"Cloud1",void 0),__decorate([c(cc.Sprite)],t.prototype,"Cloud2",void 0),__decorate([c(cc.String)],t.prototype,"ResUrl",void 0),__decorate([c(cc.String)],t.prototype,"ResName",void 0),__decorate([c(cc.Integer)],t.prototype,"MoveSpeed",void 0),t=__decorate([l],t)}(n.default);i.default=d,cc._RF.pop()},{"../../../Core/CacheManager":"CacheManager","../../../Core/LoadManager":"LoadManager","../../../Core/Widget":"Widget","../Controller/SceneController":"SceneController"}],CmdUtils:[function(e,t,i){"use strict";cc._RF.push(t,"90b53i96uVC3JEPqQw3bzwM","CmdUtils"),Object.defineProperty(i,"__esModule",{value:!0});e("../../Core/GameEventDispatcher"),e("../../Util/DateUtil");var n=cc._decorator,o=n.ccclass,a=(n.property,function(){function e(){this.startTime=0,this.hasCmdWindow=!1,this.logStr="",this.errorLogStr="",this.reportUrl=""}var t;return t=e,Object.defineProperty(e,"instance",{get:function(){return t._instance||(t._instance=new t,t._instance.init()),t._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){if(0!=cc.sys.isNative);},e.prototype.clear=function(){t._instance=null},e=t=__decorate([o],e)}());i.default=a,cc._RF.pop()},{"../../Core/GameEventDispatcher":"GameEventDispatcher","../../Util/DateUtil":"DateUtil"}],CmdWindow:[function(e,t,i){"use strict";cc._RF.push(t,"c7848bSMiZItrVnlHHGU+qx","CmdWindow"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../../Core/GameEventDispatcher"),a=e("./CmdUtils"),r=cc._decorator,s=r.ccclass,l=r.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ScrollView=null,t.Label=null,t.EditBox=null,t.ErrorLogScrollView=null,t.ErrorLogLabel=null,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this),a.default.instance.hasCmdWindow=!0},t.prototype.show=function(){e.prototype.show.call(this),o.GameEventDispatcher.instance.on("CmdUtilsLog",this.CmdUtilsLog,this),this.CmdUtilsLog(),o.GameEventDispatcher.instance.on("CmdUtilsErrorLog",this.CmdUtilsErrorLog,this),this.CmdUtilsErrorLog()},t.prototype.hide=function(){e.prototype.hide.call(this),o.GameEventDispatcher.instance.off("CmdUtilsLog",this.CmdUtilsLog,this),o.GameEventDispatcher.instance.off("CmdUtilsErrorLog",this.CmdUtilsErrorLog,this)},t.prototype.dispose=function(){a.default.instance.logStr=this.Label.string+a.default.instance.logStr,e.prototype.dispose.call(this)},t.prototype.clearLog=function(){this.Label.string="",this.ScrollView.content.y=0},t.prototype.CmdUtilsLog=function(){var e=a.default.instance.logStr;this.Label.string+=e,a.default.instance.logStr="",this.ScrollView.scrollToBottom()},t.prototype.SendBtnClick=function(){var e=this.EditBox.string.match(/\((.*?)\)/);if(e&&e[1]&&""!=e[1]){var t=e[1].split(",");window.gm.apply(window,t)}},t.prototype.CmdUtilsErrorLog=function(){this.ErrorLogLabel.string=a.default.instance.errorLogStr,this.ErrorLogScrollView.scrollToBottom()},__decorate([l(cc.ScrollView)],t.prototype,"ScrollView",void 0),__decorate([l(cc.Label)],t.prototype,"Label",void 0),__decorate([l(cc.EditBox)],t.prototype,"EditBox",void 0),__decorate([l(cc.ScrollView)],t.prototype,"ErrorLogScrollView",void 0),__decorate([l(cc.Label)],t.prototype,"ErrorLogLabel",void 0),t=__decorate([s],t)}(n.default);i.default=c,cc._RF.pop()},{"../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Window":"Window","./CmdUtils":"CmdUtils"}],ColorUtil:[function(e,t,i){"use strict";cc._RF.push(t,"25f3205pjtEtoqey7cZ7Ex6","ColorUtil"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(){}return Object.defineProperty(e,"miaoShu1",{get:function(){return 8861212},enumerable:!0,configurable:!0}),Object.defineProperty(e,"miaoShu2",{get:function(){return 6044724},enumerable:!0,configurable:!0}),Object.defineProperty(e,"miaoShu3",{get:function(){return 3151888},enumerable:!0,configurable:!0}),Object.defineProperty(e,"miaoShu4",{get:function(){return 15984863},enumerable:!0,configurable:!0}),e.colorStr=function(e){return"#"+this.color[e].substring(2)},Object.defineProperty(e,"WHITE_STR",{get:function(){return"#"+this.color[0].substring(2)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"GREEN_STR",{get:function(){return"#"+this.color[1].substring(2)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"BLUE_STR",{get:function(){return"#"+this.color[2].substring(2)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"PRUPLE_STR",{get:function(){return"#"+this.color[3].substring(2)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ORANGE_STR",{get:function(){return"#"+this.color[4].substring(2)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"RED_STR",{get:function(){return"#"+this.color[5].substring(2)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"YELLOW_STR",{get:function(){return"#"+this.color[6].substring(2)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"MIAOSHU_1",{get:function(){return"#"+this.color[7].substring(2)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"MIAOSHU_2",{get:function(){return"#"+this.color[8].substring(2)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"MIAOSHU_3",{get:function(){return"#"+this.color[9].substring(2)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"MIAOSHU_4",{get:function(){return"#"+this.color[10].substring(2)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"WHITE",{get:function(){return 16777215},enumerable:!0,configurable:!0}),Object.defineProperty(e,"GREEN",{get:function(){return 51783},enumerable:!0,configurable:!0}),Object.defineProperty(e,"BLUE",{get:function(){return 54773},enumerable:!0,configurable:!0}),Object.defineProperty(e,"RED",{get:function(){return 16711680},enumerable:!0,configurable:!0}),Object.defineProperty(e,"YELLOW",{get:function(){return 7488540},enumerable:!0,configurable:!0}),Object.defineProperty(e,"GRAY",{get:function(){return 14802397},enumerable:!0,configurable:!0}),Object.defineProperty(e,"DEEP_BLUE",{get:function(){return 1590917},enumerable:!0,configurable:!0}),e.getRightColor=function(t,i){return t>=i?e.GREEN:e.RED},e.UBB_red=function(t){return"[color="+e.RED_STR+"]"+t+"[/color]"},e.UBB_Orange=function(t){return"[color="+e.ORANGE_STR+"]"+t+"[/color]"},e.UBB_Yellow=function(t){return"[color="+e.YELLOW_STR+"]"+t+"[/color]"},e.UBB_deepBule=function(e){return"[color=#184685]"+e+"[/color]"},e.UBB_Green=function(t){return"[color="+e.GREEN_STR+"]"+t+"[/color]"},e.setColor=function(e,t){return"[color="+t+"]"+e+"[/color]"},e.color={0:"0xffffff",1:"0x00ca47",2:"0x00d5f5",3:"0xc203f2",4:"0xffc600",5:"0xff0000",6:"0x72441c",7:"0x87361c",8:"0x5c3c34",9:"0x301810",10:"0xf3e8df"},e.INDEX_ORANGE=4,e}();i.ColorUtil=n,cc._RF.pop()},{}],ComFun:[function(e,t,i){"use strict";cc._RF.push(t,"95a3bsyLkJAYaGOOeteCdTx","ComFun"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Global/GlobalValue"),o=function(){function e(){}return e.numBetweenAB=function(e,t,i){return e>=t&&e<=i},e.checkMinMax=function(e,t,i){var n=e;return n<t?n=t:n>i&&(n=i),n},e.distance=function(e,t,i,n){var o=Math.abs(e-i),a=Math.abs(t-n);return Math.floor(Math.sqrt(o*o+a*a))},e.getDiretion=function(t,i,n,o){var a=Math.atan2(o-i,n-t);return e.calcLRByRadian(a)},e.calcDirByRadian8=function(e){var t=Math.PI/8;return Math.abs(e)<t?n.DIR.RIGHT:Math.abs(e)<=3*t?n.DIR.RIGHT:(Math.abs(e),n.DIR.LEFT)},e.calcRadianByDir8=function(e){var t=Math.PI;return[-t/2,-t/4,0,t/4,t/2,3*t/4,t,3*-t/4][e]},e.calcLRByRadian=function(e){var t=180*e/Math.PI;return t>=-90&&t<90?n.DIR.RIGHT:n.DIR.LEFT},e.calcDirByRadian4=function(e){var t=180*e/Math.PI;return t>=0&&t<90?n.DIR.RIGHT:t>=90&&t<180?n.DIR.LEFT:t>=-90&&t<0?n.DIR.RIGHT:n.DIR.LEFT},e.calcJoyStickDirByRadian=function(e){var t=Math.PI/16;return Math.abs(e)<t?n.DIR.RIGHT:Math.abs(e)<=7*t?n.DIR.RIGHT:(Math.abs(e),n.DIR.LEFT)},e.calcTwoPointAngle=function(e,t,i,n){var o=i-e,a=n-t;return 180*Math.atan2(a,o)/Math.PI},e.calcTwoPointAngle2=function(e,t,i,n){var o=i-e,a=n-t;return Math.atan2(a,o)},e.calcDirTarget=function(e,t,i,n){var o=i-e,a=n-t,r=180*Math.atan2(a,o)/Math.PI,s=0,l=0;return r>=0&&r<90?(s=1,l=1):r>=90&&r<180?(s=-1,l=1):r>=-90&&r<0?(s=-1,l=-1):(s=1,l=-1),[s,l]},e.roundPosition=function(e,t,i,n,o){void 0===n&&(n=40),void 0===o&&(o=40);for(var a=Math.sqrt(i),r=Math.floor(a),s=Math.ceil(a),l=Math.round(e-n*(s-1)/2),c=Math.round(t-o*(r-1)/2),d=[],p=0;p<i;p++)d.push(l+p%s*n),d.push(c+Math.floor(p/s)*o);return d},e.getJsonLength=function(e){var t=0;for(var i in e)t++;return t},e.minIndexOfArray=function(e){for(var t=e.length,i=0==t?-1:0,n=0==t?0:e[0],o=1;o<t;o++)n>e[o]&&(n=e[o],i=o);return i},e.maxIndexOfArray=function(e){for(var t=e.length,i=0==t?-1:0,n=0==t?0:e[0],o=1;o<t;o++)n<e[o]&&(n=e[o],i=o);return i},e.averageOfArray=function(e){var t=e.length,i=void 0;if(t>0){i=0;for(var n=0;n<t;n++)i+=e[n];i/=t}return i},e.averageOfArrayExceptMaxMin=function(t){var i=t.length,n=0;if(i<3)n=e.averageOfArray(t);else{for(var o=e.minIndexOfArray(t),a=e.maxIndexOfArray(t),r=0;r<i;r++)r!=o&&r!=a&&(n+=t[r]);n/=i-2}return n},e.IsMobile=function(){var e=navigator.userAgent,t=!1;return/Mobile/i.test(e)&&(t=!0),t},e}();i.ComFun=o,cc._RF.pop()},{"../Global/GlobalValue":"GlobalValue"}],ComUtils:[function(e,t,i){"use strict";cc._RF.push(t,"c6a529b6RtHUZmLQuJQ4+vA","ComUtils"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Item/ItemController"),o=e("../Item/ItemData"),a=e("../../Core/Widget"),r=cc._decorator,s=r.ccclass,l=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onClickTips=function(e,t){var i=n.default.instance.getItemNum(t),a=o.default.creatItem(t,i);n.default.instance.openItemTips(a)},t=__decorate([s],t)}(a.default));i.default=l,cc._RF.pop()},{"../../Core/Widget":"Widget","../Item/ItemController":"ItemController","../Item/ItemData":"ItemData"}],CombatValue:[function(e,t,i){"use strict";cc._RF.push(t,"5f0c8L8lklAUIOpm8ZIXV3P","CombatValue"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/TimeController"),a=cc._decorator,r=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.combatTitle=null,t.combatAll=null,t.combatCount=null,t.combatCountX=26,t.combatTitleW=56,t.combatTitleH=29,t.combatAllW=32,t.combatAllH=32,t}return __extends(t,e),t.prototype.onInit=function(e,t,i,n,a){var r=this;void 0===t&&(t=24),void 0===i&&(i=1),void 0===n&&(n=!1),void 0===a&&(a=!0),this.combatCount.string=e+"",this.combatCount.fontSize=t,this.combatAll.active=n,this.combatTitle.setContentSize(this.combatTitleW*i,this.combatTitleH*i),this.combatAll.setContentSize(this.combatAllW*i,this.combatAllH*i),a&&(this.node.opacity=1,o.default.instance.setTimeout(function(){r.node&&r.node.runAction(cc.fadeTo(.05,255))},this,30))},__decorate([s(cc.Node)],t.prototype,"combatTitle",void 0),__decorate([s(cc.Node)],t.prototype,"combatAll",void 0),__decorate([s(cc.Label)],t.prototype,"combatCount",void 0),t=__decorate([r],t)}(n.default);i.default=l,cc._RF.pop()},{"../../Core/TimeController":"TimeController","../../Core/Widget":"Widget"}],CommonBtn:[function(e,t,i){"use strict";cc._RF.push(t,"8a4d6BUQIVG6rv+m6ZE3/LS","CommonBtn"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./Image"),o=e("../../GlobalContext"),a=e("../../Core/Widget"),r=cc._decorator,s=r.ccclass,l=r.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.backGroudUrl="",t.backGroudName="",t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.backGroudName&&""!=this.backGroudName&&this.onShowPage()},t.prototype.onShowPage=function(){this.spriteBG=new cc.Node,this.backGroudUrl&&""!=this.backGroudUrl?this.spriteBG.addComponent(n.default).loadSpriteAtlas(o.GlobalContext.Root+this.backGroudUrl,this.backGroudName):this.spriteBG.addComponent(n.default).loadSpriteAtlas(o.GlobalContext.Root+"ui/functionIcon/FunIcon",this.backGroudName),this.node.insertChild(this.spriteBG,0)},__decorate([l(cc.String)],t.prototype,"backGroudUrl",void 0),__decorate([l(cc.String)],t.prototype,"backGroudName",void 0),t=__decorate([s],t)}(a.default);i.default=c,cc._RF.pop()},{"../../Core/Widget":"Widget","../../GlobalContext":"GlobalContext","./Image":"Image"}],CommonPageBG:[function(e,t,i){"use strict";cc._RF.push(t,"e3df2asyzRPMbIOO5mQ62/T","CommonPageBG"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("./WindowBg4"),a=e("../../Core/GameEventDispatcher"),r=e("../../Core/Event"),s=e("../../GlobalContext"),l=e("../../Util/Utils"),c=e("../../Core/LoadManager"),d=e("../../Core/WindowManager"),p=cc._decorator,h=p.ccclass,u=(p.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pageItem=null,t._titleHei=0,t._tittleWid=0,t._isClilckBGClose=!0,t._windowFlag=0,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this._windowFlag<1&&(this._windowFlag=l.default.RandomBy(1,1e7))},t.prototype.show=function(){e.prototype.show.call(this),this.pageItem&&(this.node.opacity=1,this.node.setScale(.05),this.pageItem.getComponent(o.default)&&this.pageItem.getComponent(o.default).setMaskActive(!1),this.onShowWindow()),a.GameEventDispatcher.instance.on(r.EventDefiner.CloseCommonPage4,this.onCloseNode,this)},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),a.GameEventDispatcher.instance.off(r.EventDefiner.CloseCommonPage4,this.onCloseNode,this)},t.prototype.onInit=function(e,t,i,n,o,a,r){void 0===n&&(n=!0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===r&&(r=0),this._width=e,this._heigth=t,this._tittle=i,this._titleHei=a,this._tittleWid=o,this._isClilckBGClose=n,this._windowFlag=r>0?r:this._windowFlag,this.node.opacity=1,this.node.setScale(.05),this.node.setContentSize(s.GlobalContext.UIWidth,s.GlobalContext.UIHeight),c.default.instance.loadResByType(s.GlobalContext.Root+"prefab/commons/WindowBg4",cc.Prefab,this.loadComplete,this)},t.prototype.onResetTitle=function(e){this._tittle=e,this.pageItem&&this.pageItem.getComponent(o.default).onResetTitle(this._tittle)},t.prototype.loadComplete=function(e){1!=this.isDestroyed&&(this.pageItem||(this.pageItem=l.default.getNodeByUrl(e,s.GlobalContext.Root+"prefab/commons/WindowBg4"),this.pageItem.getComponent(o.default).setMaskActive(!1),this.node.insertChild(this.pageItem,0),this.pageItem.setPosition(0,0),this.onShowWindow()),this.pageItem.getComponent(o.default).initData(this._width,this._heigth,this._tittle,this._isClilckBGClose,this._tittleWid,this._titleHei,this._windowFlag))},t.prototype.onShowWindow=function(){this.node.runAction(cc.sequence(cc.spawn(cc.scaleTo(.22,1.1),cc.fadeTo(.22,200),cc.callFunc(function(e){this.onOneFinish()},this)),cc.spawn(cc.scaleTo(.05,1),cc.fadeTo(.05,255)),cc.callFunc(function(e){this.onAllfinished()},this)))},t.prototype.onOneFinish=function(){this.pageItem&&this.pageItem.getComponent(o.default)&&this.pageItem.getComponent(o.default).setMaskActive(!0)},t.prototype.onAllfinished=function(){this.pageItem&&this.pageItem.getComponent(o.default)&&this.pageItem.getComponent(o.default).onShowCloseTips(this._isClilckBGClose)},t.prototype.onCloseNode=function(e){e&&Number(e.detail)!=this._windowFlag||this.node.parent&&this.node.active&&this.onClose()},t.prototype.onClose=function(){d.default.instance.closeWindow(this.node)},t=__decorate([h],t)}(n.default));i.default=u,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/LoadManager":"LoadManager","../../Core/Widget":"Widget","../../Core/WindowManager":"WindowManager","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","./WindowBg4":"WindowBg4"}],CommonProgress:[function(e,t,i){"use strict";cc._RF.push(t,"215c9uNEX1Nuav/gC73dhGc","CommonProgress"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=cc._decorator,a=o.ccclass,r=o.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._width=100,t._value=1,t.barleft=null,t.barcenter=null,t.barbgleft=null,t.barbgcenter=null,t._maxnum=1,t.maskbar=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e,this.showUI()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e,this.maskbar.width=this._value*this._maxnum},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.showUI()},t.prototype.showUI=function(){var e=this.node.getChildByName("BarBg"),t=e.getChildByName("Left"),i=e.getChildByName("Right"),n=e.getChildByName("Center");t.getComponent(cc.Sprite).spriteFrame=this.barbgleft,i.getComponent(cc.Sprite).spriteFrame=this.barbgleft,n.getComponent(cc.Sprite).spriteFrame=this.barbgcenter;var o=this.maskbar.getChildByName("Left"),a=this.maskbar.getChildByName("Right"),r=this.maskbar.getChildByName("Center");o.getComponent(cc.Sprite).spriteFrame=this.barleft,a.getComponent(cc.Sprite).spriteFrame=this.barleft,r.getComponent(cc.Sprite).spriteFrame=this.barcenter,n.width=this.width-2*t.width,r.width=n.width,n.x=t.x+t.width,i.x=n.x+n.width+i.width,r.x=o.x+o.width,a.x=r.x+r.width+a.width,this.maskbar.width=o.width+a.width+r.width,this.maskbar.height=o.height,this._maxnum=o.width+a.width+r.width},__decorate([r(cc.Integer)],t.prototype,"_width",void 0),__decorate([r],t.prototype,"width",null),__decorate([r(cc.Integer)],t.prototype,"_value",void 0),__decorate([r],t.prototype,"value",null),__decorate([r(cc.SpriteFrame)],t.prototype,"barleft",void 0),__decorate([r(cc.SpriteFrame)],t.prototype,"barcenter",void 0),__decorate([r(cc.SpriteFrame)],t.prototype,"barbgleft",void 0),__decorate([r(cc.SpriteFrame)],t.prototype,"barbgcenter",void 0),__decorate([r(cc.Node)],t.prototype,"maskbar",void 0),t=__decorate([a],t)}(n.default);i.default=s,cc._RF.pop()},{"../../Core/Widget":"Widget"}],CommonRes:[function(e,t,i){"use strict";cc._RF.push(t,"c173bQSo0pAlqKq/jD3XTCD","CommonRes"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./Widget"),o=cc._decorator,a=o.ccclass,r=o.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.commons=[],t.numberFont=[],t.commonpre=[],t}return __extends(t,e),__decorate([r(cc.SpriteAtlas)],t.prototype,"commons",void 0),__decorate([r(cc.Font)],t.prototype,"numberFont",void 0),__decorate([r(cc.Prefab)],t.prototype,"commonpre",void 0),t=__decorate([a],t)}(n.default);i.default=s,cc._RF.pop()},{"./Widget":"Widget"}],CommonTabItem:[function(e,t,i){"use strict";cc._RF.push(t,"7da7aUkt2VFCpsB5hbeoqIi","CommonTabItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./Widget"),o=cc._decorator,a=o.ccclass,r=(o.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._index=-1,t}return __extends(t,e),Object.defineProperty(t.prototype,"index",{get:function(){return this._index},set:function(e){this._index=e},enumerable:!0,configurable:!0}),t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.hide=function(){e.prototype.hide.call(this)},t.prototype.setData=function(e){},t.prototype.select=function(){},t.prototype.cancal=function(){},t=__decorate([a],t)}(n.default));i.default=r,cc._RF.pop()},{"./Widget":"Widget"}],CommonTabList:[function(e,t,i){"use strict";cc._RF.push(t,"6baf7UCEChH+bv7aINDg5MD","CommonTabList"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./Widget"),o=e("./LoadManager"),a=e("../GlobalContext"),r=e("../Util/Utils"),s=e("./CommonTabItem"),l=cc._decorator,c=l.ccclass,d=l.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.listContainer=null,t.smallListContainer=null,t.bigItemUrl="",t.smallItemUrl="",t._curSelectBigItemIndex=-1,t._curSelectSmallItemIndex=-1,t._datalist=[],t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.hide=function(){e.prototype.hide.call(this),this.clear()},t.prototype.clear=function(){r.default.setNodeChildDestoryByUrl(this.listContainer),r.default.setNodeChildDestoryByUrl(this.smallListContainer)},t.prototype.initLlisData=function(e){var t=this;this.clear(),this._datalist=e,o.default.instance.loadResByType(a.GlobalContext.Root+this.bigItemUrl,cc.Prefab,function(e){for(var i=0;i<t._datalist.length;i++){var n=t._datalist[i],o=r.default.getNodeByUrl(e,a.GlobalContext.Root+t.bigItemUrl);o.getComponent(s.default).index=i,o.getComponent(s.default).setData(n[0]);var l=o.getChildByName("bigIitemBtn"),c=void 0;l?c=l.getComponent(cc.Button):o.addComponent(cc.Button),c.clickEvents[0].target=t.node,c.clickEvents[0].component="CommonTabList",c.clickEvents[0].handler="itemBigClick",t.listContainer.addChild(o)}},null)},t.prototype.itemBigClick=function(e){var t=e.currentTarget;this.selectBigItem(t.parent.getComponent(s.default).index)},t.prototype.selectBigItem=function(e){var t=this;-1!=this._curSelectBigItemIndex&&this.listContainer.children[0].getComponent(s.default).cancal(),this._curSelectBigItemIndex=e,this.listContainer.children[0].getComponent(s.default).select(),this._datalist[this._curSelectBigItemIndex][1]?o.default.instance.loadResByType(a.GlobalContext.Root+this.smallItemUrl,cc.Prefab,function(i){if(e==t._curSelectBigItemIndex){for(var n=t._datalist[t._curSelectBigItemIndex][1],o=0;o<n.length;o++){var l=n[o],c=r.default.getNodeByUrl(i,a.GlobalContext.Root+t.smallItemUrl);c.getComponent(s.default).setData(l);var d=c.getChildByName("bigIitemBtn"),p=void 0;d?p=d.getComponent(cc.Button):c.addComponent(cc.Button),p.clickEvents[0].target=t.node,p.clickEvents[0].component="CommonTabList",p.clickEvents[0].handler="itemSmallClick",t.smallListContainer.addChild(c)}t.smallListContainer.removeFromParent(),t.listContainer.insertChild(t.smallListContainer,t._curSelectBigItemIndex+1)}},null,e):this.smallListContainer.removeFromParent()},t.prototype.itemSmallClick=function(e){var t=e.currentTarget.parent.getSiblingIndex();this.selectSmallItem(t)},t.prototype.selectSmallItem=function(e){-1!=this._curSelectSmallItemIndex&&this.smallListContainer.children[0].getComponent(s.default).cancal(),this._curSelectSmallItemIndex=e,this.smallListContainer.children[0].getComponent(s.default).select()},__decorate([d(cc.Node)],t.prototype,"listContainer",void 0),__decorate([d(cc.Node)],t.prototype,"smallListContainer",void 0),__decorate([d(cc.String)],t.prototype,"bigItemUrl",void 0),__decorate([d(cc.String)],t.prototype,"smallItemUrl",void 0),t=__decorate([c],t)}(n.default);i.default=p,cc._RF.pop()},{"../GlobalContext":"GlobalContext","../Util/Utils":"Utils","./CommonTabItem":"CommonTabItem","./LoadManager":"LoadManager","./Widget":"Widget"}],CommonUtil:[function(e,t,i){"use strict";cc._RF.push(t,"299cbhWJetIVLu5mASO1/pi","CommonUtil"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Module/Vip/VipCtrl"),o=e("../Global/GlobalValue"),a=e("../Module/Role/RoleInfo"),r=e("../Module/Tips/OpTipsController"),s=e("../Core/Language"),l=e("../Core/WindowType"),c=e("../Module/Commons/WindowOpenUtils"),d=e("../Module/Chat/ChatController"),p=e("../Module/OpenWin/OpenWinController"),h=e("../Module/Chat/Chatwin"),u=e("../GlobalContext"),f=e("../Module/Item/ItemData"),g=e("./Utils"),y=e("../Module/Chapter/GuanqiaController"),m=e("../Module/Status/StatusType"),C=e("../Module/WarTeam/MonsterController"),v=e("../Module/Scene/Controller/FightController"),_=e("../Module/Scene/Controller/SceneController"),b=e("../Module/Scene/Prop/EntityProperty"),T=e("../Core/Const/EntityType"),S=e("../Module/TreasureMap/TreasureMapController"),I=e("../Module/Scene/Controller/SkillController"),w=function(){function e(){}return e.getNextTimes=function(e){var t,i,o=n.default.instance.data.getPrivilegList();for(var r in o){var s=o[r];if(s)for(var l in s)if(s[l].type==e){if(t=Number(r),i=this.getNum(s[l].param,e),a.MyRoleInfo.vipLevel<t)return[t,i];break}}return[t,i]},e.getNextAddTimes=function(e){var t,i,o=n.default.instance.data.getPrivilegList(),a=this.getTimes(e);for(var r in o){var s=o[r];if(s)for(var l in s)if(s[l].type==e){if(t=Number(r),a<(i=this.getNum(s[l].param,e)))return[t,i];break}}return[t,i]},e.getTimes=function(e){var t=n.default.instance.data.getprivilegeData(a.MyRoleInfo.vipLevel,e),i=0;return t&&(i=this.getNum(t.param,e)),i},e.getBadTimes=function(e){return this.getNextAddTimes(e)[1]-this.getTimes(e)},e.getNum=function(e,t){var i;switch(t){case o.VipPrivilegeType.ExpCopyBuyNum:i=e.length;break;default:i=e[0]}return i},e.showAddVip=function(e){a.MyRoleInfo.vipLevel>=o.MaxVipLev?r.default.instance.ShowMsg(s.default.getStr("robbery_add_rob_count_error")):(n.default.instance.type=e,c.default.instance.openWindowType(l.WindowType.VipAddCount))},e.OpenChatWin=function(e,t){void 0===e&&(e="1"),d.default.instance.setFriendsId(t),p.default.instance.openWindow(l.WindowType.ChatWin,function(){h.default.instance.ToggleBtn(null,e,t)},this)},e.setClickEvent=function(e,t,i,n){void 0===n&&(n=1);var o=new cc.Component.EventHandler;t.addComponent(cc.Button),o.target=e;var a=u.GlobalContext.ResRoot+"resources/itemicon/"+f.default.creatItem(i).ItemIcon+".png";g.default.setImage(t,a),t.setScale(n),e.addComponent("ComUtils"),o.component="ComUtils",o.handler="onClickTips",o.customEventData=""+i,t.getComponent(cc.Button).clickEvents.push(o)},e.mergeReward=function(e,t){var i=!0;for(var n in t){for(var o in e)if(e[o].id==t[n].id){e[o].count+=t[n].count,i=!1;break}i&&e.push(t[n])}return e},e.getMonster=function(e,t){void 0===t&&(t=1);var i=y.default.instance.getGuanqiaMonsters(e,t),n=[];if(i&&i.length>0)for(var o=0;o<i.length;o++)for(var a=i[o].num,r=0;r<a;r++){var s=0;s=m.ActivityStatus.value==m.ActivityStatus.TreasureMap?C.default.instance.getHigherCardLV():i[o].level;var l=v.default.instance.getGQMonsterAttr(e,s,i[o],t);l=v.default.instance.specialMonster(l);var c={cardid:i[o].cardId,grade:i[o].grade,level:s,num:1,self:!1,attr:l,autoUseSkill:!!i[o].autousebigskill,skills:l.skills,playeffect:!1,ismoveenter:!0};n.push(this.addActor(c))}return n},e.addActor=function(e){void 0!==e.playeffect&&e.playeffect;for(var t=0;t<e.num;t++){var i=new b.EntityProperty;i.addlevel=e.addlevel?e.addlevel:0,i.addtype=e.addtype?e.addtype:-1;if(e.prop?i=e.prop:(i.init(T.EntityType.enMonster,e),e.currentHp>0&&m.ActivityStatus.value==m.ActivityStatus.TreasureMap&&(i.hp=e.currentHp)),e.self||m.ActivityStatus.value==m.ActivityStatus.TreasureMap&&S.default.instance.onChangeAttrByCoefficient(i),e.handle?i.handle=e.handle:i.handle=_.default.instance.allocHandle(),i.hp<.9*i.maxHP&&i.otherAttr==o.OtherAttr.MaxHpchange)return;if(e.skills)i.skillList=e.skills;else{var n=!0;void 0!==e.reinforcement&&(n=!1),i.skillList=I.default.instance.getSkills(i,null,n)}if(i.attr.skills=i.skillList,e.skillcdDic)for(var a in e.skillcdDic){var r={time:0,curusenum:e.skillcdDic[a].curusenum,allcanusenum:e.skillcdDic[a].allcanusenum,onewarusenum:0,onewarcanusenum:e.skillcdDic[a].onewarcanusenum};i.skillCdDic[a]=r}return i.originalName=i.originalName,i.autobigskill=!!e.autoUseSkill&&e.autoUseSkill,i}},e.getShowNum=function(e,t){var i=0;for(var n in e)e[n]==t&&i++;return i},e}();i.CommonUtil=w,cc._RF.pop()},{"../Core/Const/EntityType":"EntityType","../Core/Language":"Language","../Core/WindowType":"WindowType","../Global/GlobalValue":"GlobalValue","../GlobalContext":"GlobalContext","../Module/Chapter/GuanqiaController":"GuanqiaController","../Module/Chat/ChatController":"ChatController","../Module/Chat/Chatwin":"Chatwin","../Module/Commons/WindowOpenUtils":"WindowOpenUtils","../Module/Item/ItemData":"ItemData","../Module/OpenWin/OpenWinController":"OpenWinController","../Module/Role/RoleInfo":"RoleInfo","../Module/Scene/Controller/FightController":"FightController","../Module/Scene/Controller/SceneController":"SceneController","../Module/Scene/Controller/SkillController":"SkillController","../Module/Scene/Prop/EntityProperty":"EntityProperty","../Module/Status/StatusType":"StatusType","../Module/Tips/OpTipsController":"OpTipsController","../Module/TreasureMap/TreasureMapController":"TreasureMapController","../Module/Vip/VipCtrl":"VipCtrl","../Module/WarTeam/MonsterController":"MonsterController","./Utils":"Utils"}],CommonsResManager:[function(e,t,i){"use strict";cc._RF.push(t,"036bahwt29Daoa1hzF5K7yx","CommonsResManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./Widget"),o=e("./LoadManager"),a=e("../GlobalContext"),r=e("./TimeController"),s=cc._decorator,l=s.ccclass,c=s.property,d=function(e){function t(){var t=e.call(this)||this;return t.commonchange=null,t.url=a.GlobalContext.Root+"prefab/Common/CommonRes",t.commonDependsDic={},i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){var e=this,t=r.default.instance.setTimeout(function(){o.default.instance.loadResByType(e.url,cc.Prefab,function(t){for(var i=cc.loader.getDependsRecursively(e.url),n=i.length-1;n>=0;n--){var o=i[n];e.commonDependsDic[o]||(e.commonDependsDic[o]=o)}},e),r.default.instance.clearTimeout(t)},this,15e3)},t.prototype.getSpriteFrameByName=function(e){var t=this.commonchange.getSpriteFrame(e);return t||void console.warn("\u56fe\u96c6commonchange\u7f3a\u5c11\u56fe\u7247\uff1a"+e)},t.instance=null,__decorate([c(cc.SpriteAtlas)],t.prototype,"commonchange",void 0),t=i=__decorate([l],t)}(n.default);i.default=d,cc._RF.pop()},{"../GlobalContext":"GlobalContext","./LoadManager":"LoadManager","./TimeController":"TimeController","./Widget":"Widget"}],ConfigsManager:[function(e,t,i){"use strict";cc._RF.push(t,"c4741kP9aBN0pyBZJ6uYibf","ConfigsManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../GlobalContext"),o=e("./LoadManager"),a=e("../Configs/rolenameconf"),r=e("../Configs/loadingtipconf"),s=function(){function e(){this.loadConfigsName=["accessoriesconf","achievementconf","activityInfoconf","ActivityRepayConf","animationconf","artifactcollectionconf","artifactconf","boxconf","buffconf","cardConf","cardgiftconf","cardGroupConf","cardstageConf","chapterconf","chaptersweepingconf","ChatConf","cheapseckillConf","DailyCopyConf","DailyMealConf","Dailymission","dailysignconf","decompose","diamondshopconf","elitebossconf","equipconf","equipeffect","equipfbconf","ExpeditionConf","firstrechargeconf","firstrechargegroupbuyConf","freeenergy","friendbossconf","friendConf","functioniconconf","gemconf","guanqiaconf","guideconf","guidefightconf","help","highladderconf","investplanconf","inviteconf","Itemconf","levelconf","loadmonsterconf","lotteryconf","matchraceconf","monsterinitpoint","onlinerewardsconf","paypackageconf","PrivilegeCardConf","rechargecarnivalconf","rechargeconf","RechargeRebateConf","reinforcements","RoleDevelopConf","roletitleconf","sandtableconf","scrollconf","sevendaygoalsconf","sevendayrank","sevendayrechargeconf","ShopConf","signinconf","skillconf","stdrewardconf","strongconf","syntheticConf","talentconf","TotemConf","TotemsCopyConf","treasureMapConf","vipbenefitsConf","vipConf","welfarelobbyconf","worldbossconf","yunyingconf","guideconf","sevendayloginconf","systemopentipconf","ExpCopyConf","cardinherit","cardRemmendconf","attributeconf","SevenDayGoalConf","SevenDayLoginReward","mineConf","devilconf"],this._configsDic={}}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.clear=function(){e._instance=null},e.prototype.init=function(e,t,i,a){console.log("\u52a0\u8f7d\u8868");var r=[];if(this.loadConfigsName&&this.loadConfigsName.length>0)for(var s=0;s<this.loadConfigsName.length;s++)r.push(n.GlobalContext.Root+"configs/"+this.loadConfigsName[s]);r&&r.length>0&&o.default.instance.loadResArray(r,cc.JsonAsset,this.loadComplete,this,[this.loadConfigsName,i,a],e,t)},e.prototype.loadComplete=function(e,t,i,n){for(var o=0;o<t.length;o++){var a=e[o].json;this._configsDic[t[o]]=a,console.log("\u914d\u7f6e\u8868\u52a0\u8f7d\u5b8c\u6bd5\uff1a"+t[o]),console.rawLog&&console.rawLog("\u914d\u7f6e\u8868\u6570\u636e\uff1a"+t[o]+"=",a)}i&&i.call(n)},e.prototype.getConfigs=function(e){var t=this._configsDic[e];if(!t){switch(e){case"rolenameconf":return a.rolenameconf;case"loadingtipconf":return r.loadingtipconf}console.log("\u627e\u4e0d\u5230\u8868: "+e)}return t},e.prototype.setConfigs=function(e,t){this._configsDic[e]=t},e}();i.ConfigsManager=s,cc._RF.pop()},{"../Configs/loadingtipconf":"loadingtipconf","../Configs/rolenameconf":"rolenameconf","../GlobalContext":"GlobalContext","./LoadManager":"LoadManager"}],Controller:[function(e,t,i){"use strict";cc._RF.push(t,"60978qkclJIX5ZecWex2J0n","Controller"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../NetConnect/NetConnet"),o=e("./Widget"),a=cc._decorator,r=a.ccclass,s=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){this.listNotification()},t.prototype.listNotification=function(){},t.prototype.addProto=function(e,t,n){i.ProtoCallbackDic[e]||(i.ProtoCallbackDic[e]=[]),i.ProtoCallbackDic[e].push([t,n])},t.prototype.sendProto=function(e){n.default.instance.sendProto(e)},t.ProtoCallbackDic={},t=i=__decorate([r],t)}(o.default));i.default=s,cc._RF.pop()},{"../NetConnect/NetConnet":"NetConnet","./Widget":"Widget"}],CreateRole:[function(e,t,i){"use strict";cc._RF.push(t,"77b6aanFzlH5bAS4YvFXC0H","CreateRole"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/GameEventDispatcher"),o=e("../../Core/Event"),a=e("../../NetConnect/NetConnet"),r=e("./RoleInfo"),s=e("../../Core/Widget"),l=e("../../Core/Language"),c=e("../../GlobalContext"),d=e("../../Core/ConfigsManager"),p=e("../../Global/GlobalValue"),h=e("../Login/LoginController"),u=e("../Scene/Pool/SpinePools"),f=e("../../Core/SpineBase"),g=e("../../Util/SDKUtils"),y=e("../../Core/LoadManager"),m=e("../../Util/ReportSdkUtils"),C=e("../../Core/TimeController"),v=e("../Sound/SoundController"),_=cc._decorator,b=_.ccclass,T=_.property,S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Panl=null,t.MRole=null,t.WRole=null,t.aureole=null,t.SignEditBox=null,t.Model=null,t.topUpNode=null,t.BGNode=null,t.cheakClickNode=null,t.RoleSex=1,t._configs=null,t.Model_Ready=!1,t._preLoading=!1,t.aureoleNode=null,t.bgNode=null,t.model=null,t.timeOut=null,t.time=2e4,t.loadcount=0,t}return __extends(t,e),t.prototype.start=function(){if(this.loadcount=0,e.prototype.start.call(this),m.default.instance.loginPointOut(m.default.LoginPointKingdom_3),h.default.instance.beginAniCom=!1,this._configs=d.ConfigsManager.instance.getConfigs("rolenameconf"),""!=g.default.instance.help&&""!=g.default.instance.topupinfo){var t=g.default.instance.help,i=JSON.parse(g.default.instance.topupinfo),n=g.default.instance.helpname;this.topUpNode.active=!0,"ios"==qq.getSystemInfoSync().platform?this.topUpNode.getComponent("TopupNode").initDiamondInfo(i,"4",t,n):this.topUpNode.getComponent("TopupNode").initDiamondInfo(i,"3",t,qq.getLaunchOptionsSync().query.userId,n),g.default.instance.help="",g.default.instance.topupinfo=""}this.GetBg(),this.bgNode=u.SpinePools.addSpineNoder(this.BGNode,new cc.Vec2(0,0));var o=this.bgNode.getComponent(f.default);o.initSpineData(p.SPINE_RES_DIR+"effect/creatRole/BG",null,"animation"),o.loop=!0,o.completeCallbackThisObj=this,o.completeCallbackParam=[this.bgNode],o.readlySpineCallThisObj=this},t.prototype.show=function(){this.RoleSex=h.default.instance.roleSex,this.initAnim(),n.GameEventDispatcher.instance.on(o.EventDefiner.CreateResult,this.GetCreateRoleResult,this),n.GameEventDispatcher.instance.on(o.EventDefiner.DiamondShop,this.topUp,this),this.cheakClickNode.on("touchstart",this.CheackNode,this)},t.prototype.hide=function(){n.GameEventDispatcher.instance.off(o.EventDefiner.CreateResult,this.GetCreateRoleResult,this),n.GameEventDispatcher.instance.off(o.EventDefiner.DiamondShop,this.topUp,this),this.timeOut&&C.default.instance.clearInterval(this.timeOut),this.timeOut=null,u.SpinePools.recoverSpineNoder(this.model),u.SpinePools.recoverSpineNoder(this.aureoleNode)},t.prototype.topUp=function(e){var t=e.getUserData();if(t.help&&t.topupinfo){var i=t.help,n=JSON.parse(t.topupinfo),o=t.name;this.topUpNode.active=!0,"ios"==qq.getSystemInfoSync().platform?this.topUpNode.getComponent("TopupNode").initDiamondInfo(n,"4",i,null,o):this.topUpNode.getComponent("TopupNode").initDiamondInfo(n,"3",i,t.userId,o)}},t.prototype.onBookAnim=function(){Math.min(this.node.height,950);this.IsShow()},t.prototype.aureoleAnim=function(e,t){if(!(0==Number(t)&&1==this.MRole.active||1==Number(t)&&1==this.WRole.active)){switch(Number(t)){case 0:this.MRole.active=!0,this.WRole.active=!1;break;case 1:this.MRole.active=!1,this.WRole.active=!0}this.onRoleClick(t)}},t.prototype.initAnim=function(){var e=Math.min(this.node.height,750),t=(Math.min(this.node.width,1624),cc.find("Game/Title1",this.node));t.y=e/2-t.height/2+2},t.prototype.GetBg=function(){this.onBookAnim()},t.prototype.checkLoadPre=function(){this.loadcount++,this.Model_Ready&&0==this._preLoading&&this.loadcount>=2&&(this._preLoading=!0,this.preloadSceneMian())},t.prototype.onRoleClick=function(e){var t=this;this.aureole.childrenCount>0&&(this.aureole.runAction(cc.fadeTo(.2,0)),this.aureole.children[0].getComponent(f.default).clear(),u.SpinePools.recoverSpineNoder(this.aureoleNode));var i=C.default.instance.setTimeout(function(){t.aureoleNode=u.SpinePools.addSpineNoder(t.aureole,new cc.Vec2(0,0));var e=t.aureoleNode.getComponent(f.default);e.initSpineData(p.SPINE_RES_DIR+"effect/creatRole/effect",null,"effect"),e.loop=!0,t.aureole.runAction(cc.fadeTo(.3,255)),C.default.instance.clearTimeout(i)},this,300);if(0==Number(e)){if(this.Model.childrenCount>0){this.Model.runAction(cc.spawn(cc.moveTo(.2,-138,-250),cc.fadeTo(.2,0))),this.RoleSex=0;var n=C.default.instance.setTimeout(function(){t.MRole.active=!0,t.WRole.active=!1,t.MondelInit("man"),t.Model.x=127,t.Model.runAction(cc.spawn(cc.moveTo(.2,-11,-250),cc.fadeTo(.3,255))),C.default.instance.clearTimeout(n)},this,300)}}else if(this.Model.childrenCount>0){this.Model.runAction(cc.spawn(cc.moveTo(.2,127,-250),cc.fadeTo(.2,0))),this.RoleSex=1;var o=C.default.instance.setTimeout(function(){t.MRole.active=!1,t.WRole.active=!0,t.MondelInit("woman"),t.Model.x=-138,t.Model.runAction(cc.spawn(cc.moveTo(.2,-11,-250),cc.fadeTo(.3,255))),C.default.instance.clearTimeout(o)},this,300)}this.onRandomClick()},t.prototype.MondelInit=function(e){(void 0===e&&(e="man"),this.Model.childrenCount)&&(this.Model.children[0].getComponent(f.default).clear(),u.SpinePools.recoverSpineNoder(this.model));this.model=u.SpinePools.addSpineNoder(this.Model,new cc.Vec2(0,0));var t=this.model.getComponent(f.default);t.node.setScale(1.5),t.initSpineData(p.SPINE_RES_DIR+"effect/creatRole/"+e+"/skin",null,"stand"),t.readlySpineCall=this.checkLoadPre,t.readlySpineCallThisObj=this,t.loop=!0,t.completeCallbackThisObj=this,t.completeCallbackParam=[this.model],t.readlySpineCallThisObj=this},t.prototype.IsShow=function(){c.PlayerData.userInfo&&null!=c.PlayerData.userInfo.nickname?this.SignEditBox.string=c.PlayerData.userInfo.nickname:this.onRandomClick(),this.aureoleNode=u.SpinePools.addSpineNoder(this.aureole,new cc.Vec2(0,0));var e=this.aureoleNode.getComponent(f.default);e.initSpineData(p.SPINE_RES_DIR+"effect/creatRole/effect",null,"effect"),e.readlySpineCall=this.checkLoadPre,e.readlySpineCallThisObj=this,e.loop=!0,1==h.default.instance.roleSex?(this.RoleSex=0,this.MRole.active=!0,this.WRole.active=!1,this.MondelInit("man"),this.Model_Ready=!0,this.checkLoadPre()):(this.RoleSex=1,this.MRole.active=!1,this.WRole.active=!0,this.MondelInit("woman"),this.Model_Ready=!0,this.checkLoadPre())},t.prototype.onRandomClick=function(){this.SignEditBox.string="";var e=this._configs.Randomname[1].Names,t=this._configs.Randomname[2].Names,i=this._configs.Randomname[3].Names,n=this._configs.Randomname[4].Names,o=this._configs.Randomname[5].Names,a=this._configs.Randomname[6].Names,r=Math.floor(Math.random()*this._configs.Names[e].length),s=Math.floor(Math.random()*this._configs.Names[t].length),l=Math.floor(Math.random()*this._configs.Names[i].length),c=Math.floor(Math.random()*this._configs.Names[n].length),d=Math.floor(Math.random()*this._configs.Names[o].length),p=Math.floor(Math.random()*this._configs.Names[a].length);0==this.RoleSex?r>this._configs.Names[e].length/2?this.SignEditBox.string=this.RandomName(e,r)+this.RandomName(t,s):r<=this._configs.Names[e].length/2&&(this.SignEditBox.string=this.RandomName(e,r)+this.RandomName(t,s)+this.RandomName(i,l)):1==this.RoleSex&&(c>this._configs.Names[n].length/2?this.SignEditBox.string=this.RandomName(n,c)+this.RandomName(o,d):c<=this._configs.Names[n].length/2&&(this.SignEditBox.string=this.RandomName(n,c)+this.RandomName(o,d)+this.RandomName(a,p)))},t.prototype.RandomName=function(e,t){return this._configs.Names[e][t].name},t.prototype.SendRoleInfo=function(){if(this.SignEditBox.string&&""!=this.SignEditBox.string){console.log("\u53d1\u9001\u521b\u5efa\u89d2\u8272");var e={cmd:"new",name:this.SignEditBox.string,gender:this.RoleSex};a.default.instance.sendProto(e),m.default.instance.loginPointOut(m.default.LoginPointKingdom_4),this.preloadSceneMian()}else this.ShowMsg(l.default.getStr("\u8f93\u5165\u4e0d\u80fd\u4e3a\u7a7a"))},t.prototype.preloadSceneMian=function(){var e=this;cc.director.preloadScene("Main"),console.log("\u52a0\u8f7dMain   create"),d.ConfigsManager.instance.init(null,null,null,null),y.default.instance.loadResByType("ui/scene/beginanim/anim",sp.SkeletonData,function(t){y.default.instance.loadResByType(v.SoundType.firstPlot,cc.AudioClip,function(e){h.default.instance.beginAniCom=!0},e)},this)},t.prototype.GetCreateRoleResult=function(){var e=cc.find("Game/RightPanl/ti1",this.node);e.y=-148;var t=cc.find("Game/RightPanl/ti1/content",this.node);switch(t.getComponent(cc.Label).string="",e.active=!0,r.MyRoleInfo.result){case 1:t.getComponent(cc.Label).string=l.default.getStr("error1");break;case 2:t.getComponent(cc.Label).string=l.default.getStr("error2");break;case 3:t.getComponent(cc.Label).string=l.default.getStr("error3");break;case 4:t.getComponent(cc.Label).string=l.default.getStr("error4");break;case 5:t.getComponent(cc.Label).string=l.default.getStr("error5")}e.stopAllActions(),e.runAction(cc.moveTo(.8,47,-30));var i=C.default.instance.setTimeout(function(){e.active=!1,C.default.instance.clearTimeout(i)},this,2e3)},t.prototype.ShowMsg=function(e){var t=cc.find("Game/RightPanl/ti1",this.node);t.y=-148;var i=cc.find("Game/RightPanl/ti1/content",this.node);i.getComponent(cc.Label).string="",t.active=!0,i.getComponent(cc.Label).string=e,t.stopAllActions(),t.runAction(cc.moveTo(.8,47,-30));var n=C.default.instance.setTimeout(function(){t.active=!1,C.default.instance.clearTimeout(n)},this,2e3)},t.prototype.CheackNode=function(){this.time=2e4,this.time<=1e3&&(this.time=0)},t.prototype.editorBox=function(){this.SignEditBox.string.length>=6&&this.ShowMsg(l.default.getStr("\u540d\u5b57\u5df2\u8fbe\u5230\u6700\u5927\u957f\u5ea6\u3002\u6700\u5927\u957f\u5ea6\u4e3a\u5fae\u4fe1\u540d\u5b57\u7684\u6700\u5927\u957f\u5ea6"))},__decorate([T(cc.Node)],t.prototype,"Panl",void 0),__decorate([T(cc.Node)],t.prototype,"MRole",void 0),__decorate([T(cc.Node)],t.prototype,"WRole",void 0),__decorate([T(cc.Node)],t.prototype,"aureole",void 0),__decorate([T(cc.EditBox)],t.prototype,"SignEditBox",void 0),__decorate([T(cc.Node)],t.prototype,"Model",void 0),__decorate([T(cc.Node)],t.prototype,"topUpNode",void 0),__decorate([T(cc.Node)],t.prototype,"BGNode",void 0),__decorate([T(cc.Node)],t.prototype,"cheakClickNode",void 0),t=__decorate([b],t)}(s.default);i.default=S,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/SpineBase":"SpineBase","../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../NetConnect/NetConnet":"NetConnet","../../Util/ReportSdkUtils":"ReportSdkUtils","../../Util/SDKUtils":"SDKUtils","../Login/LoginController":"LoginController","../Scene/Pool/SpinePools":"SpinePools","../Sound/SoundController":"SoundController","./RoleInfo":"RoleInfo"}],CutscenesEffect:[function(e,t,i){"use strict";cc._RF.push(t,"16697DAnoNOsIeLJzzY5gEW","CutscenesEffect"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../Core/LoadManager"),a=cc._decorator,r=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Container=null,t.UpImage=null,t.DownImage=null,t.BallContainer=null,t.Loading=null,t.LoadComplete=!1,t.PlayEffectComplete=!1,t.PreLoadCompleteCallback=null,t.PreLoadCompleteCallbackThisObj=null,t.PreLoadCompleteCallbackParam=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.start=function(){this.Container.active=!1},t.prototype.LoadCutscenesEffectRes=function(){this.UpImage.getComponent(cc.Sprite).spriteFrame||o.default.instance.loadResByType("texture/CutscenesEffectBg",cc.Texture2D,this.LoadCutscenesEffectResComplete,this)},t.prototype.LoadCutscenesEffectResComplete=function(e){var t=new cc.SpriteFrame(e);this.UpImage.getComponent(cc.Sprite).spriteFrame=t,this.DownImage.getComponent(cc.Sprite).spriteFrame=t},t.prototype.PlayCloseEffect=function(e,t,i,n){var a=this;void 0===n&&(n=null),console.log("\u64ad\u653e\u8fc7\u573a\u52a8\u753b,"+e),this.UpImage.stopAllActions(),this.DownImage.stopAllActions(),this.BallContainer.stopAllActions(),this.Container.active=!0,this.BallContainer.active=!1,this.Loading.active=!1,this.LoadComplete=!1,this.PlayEffectComplete=!1,this.PreLoadCompleteCallback=t,this.PreLoadCompleteCallbackThisObj=i,this.PreLoadCompleteCallbackParam=n,o.default.instance.loadResArray(e,cc.Animation,this.PreLoadComplete,this);this.UpImage.y=this.UpImage.height,this.UpImage.runAction(cc.sequence(cc.moveTo(1,0,0),cc.callFunc(function(){},this))),this.DownImage.y=-this.DownImage.height,this.DownImage.runAction(cc.sequence(cc.moveTo(1,0,0),cc.callFunc(function(){a.BallContainer.active=!0,a.BallContainer.setScale(3),a.Loading.active=!0,a.BallContainer.runAction(cc.sequence(cc.delayTime(.5),cc.scaleTo(.5,1),cc.delayTime(1),cc.callFunc(function(){a.PlayEffectComplete=!0,a.CheckStatus()},a)))},this)))},t.prototype.PreLoadComplete=function(){this.LoadComplete=!0,this.CheckStatus()},t.prototype.CheckStatus=function(){1==this.LoadComplete&&1==this.PlayEffectComplete&&(this.PreLoadCompleteCallback&&this.PreLoadCompleteCallback.apply(this.PreLoadCompleteCallbackThisObj,this.PreLoadCompleteCallbackParam),this.PreLoadCompleteCallback=null,this.PreLoadCompleteCallbackThisObj=null,this.PreLoadCompleteCallbackParam=null,this.PlayOpenEffect())},t.prototype.PlayOpenEffect=function(){var e=this;this.UpImage.stopAllActions(),this.DownImage.stopAllActions(),this.BallContainer.stopAllActions(),this.Container.active=!0,this.BallContainer.active=!1,this.Loading.active=!1;this.UpImage.y=0,this.UpImage.runAction(cc.sequence(cc.moveTo(1,0,this.UpImage.height),cc.callFunc(function(){},this))),this.DownImage.y=0,this.DownImage.runAction(cc.sequence(cc.moveTo(1,0,-this.DownImage.height),cc.callFunc(function(){e.Container.active=!1},this)))},t.instance=null,__decorate([s(cc.Node)],t.prototype,"Container",void 0),__decorate([s(cc.Node)],t.prototype,"UpImage",void 0),__decorate([s(cc.Node)],t.prototype,"DownImage",void 0),__decorate([s(cc.Node)],t.prototype,"BallContainer",void 0),__decorate([s(cc.Node)],t.prototype,"Loading",void 0),t=i=__decorate([r],t)}(n.default);i.default=l,cc._RF.pop()},{"../../Core/Controller":"Controller","../../Core/LoadManager":"LoadManager"}],DailyCopyConst:[function(e,t,i){"use strict";cc._RF.push(t,"4c238abVYNF8J+GRAIFX3B7","DailyCopyConst"),Object.defineProperty(i,"__esModule",{value:!0}),function(e){e[e.Artifact=1]="Artifact",e[e.Money=2]="Money",e[e.Gem=3]="Gem",e[e.Refine=4]="Refine"}(i.DailyCopyType||(i.DailyCopyType={})),cc._RF.pop()},{}],DailyCopyCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"725ecCt+oRNZoGURiUPvXpq","DailyCopyCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../NetConnect/NetConnet"),a=e("../../Core/ConfigsManager"),r=e("./DailyCopyConst"),s=e("../Role/RoleInfo"),l=e("./DailyCopyMoneyData"),c=e("./DailyCopyData"),d=e("../Status/StatusType"),p=e("./DailyCopySerVo"),h=e("../../Core/GameEventDispatcher"),u=e("../../Core/Event"),f=e("../Functionicon/FunctionIconController"),g=e("../../Core/WindowType"),y=e("../Tips/OpTipsController"),m=e("../../Core/Language"),C=e("../../Global/GlobalValue"),v=e("../../Util/CommonUtil"),_=e("../../Core/TimeController"),b=e("../Scene/Manager/SceneManager"),T=cc._decorator,S=T.ccclass,I=(T.property,function(e){function t(){var t=e.call(this)||this;return t.serDailydata={},t.selectCopyIndex=r.DailyCopyType.Artifact,t.nowIndex=1,t.dailyCopyData={},t.activityStatus={},t.activityStr={},t.prop=null,t.coin=0,t.per=0,t.vipId=[C.VipPrivilegeType.DailyCopyEquipNum,C.VipPrivilegeType.DailyCopyMoneyNum,C.VipPrivilegeType.DailyCopyGemNum,C.VipPrivilegeType.DailyCopyArtifactNum],i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){var t,i;e.prototype.onLoad.call(this);var n=a.ConfigsManager.instance.getConfigs("DailyCopyConf");this.allboxReward=n.BoxReward,t=[d.ActivityStatus.MoneyDailyCopy,d.ActivityStatus.RefineDailyCopy,d.ActivityStatus.GemDailyCopy,d.ActivityStatus.ArtifactDailyCopy],this.activityStatus[r.DailyCopyType.Money]=t[0],this.activityStatus[r.DailyCopyType.Refine]=t[1],this.activityStatus[r.DailyCopyType.Gem]=t[2],this.activityStatus[r.DailyCopyType.Artifact]=t[3],i=["moneycopysweep","refinecopysweep","gemcopysweep","artifactcopysweep"],this.activityStr[r.DailyCopyType.Money]=i[0],this.activityStr[r.DailyCopyType.Refine]=i[1],this.activityStr[r.DailyCopyType.Gem]=i[2],this.activityStr[r.DailyCopyType.Artifact]=i[3],this.setUnlockListData(n.Artifact[1],n.ArtifactConf,r.DailyCopyType.Artifact),this.setUnlockListData(n.Money[1],n.MoneyConf,r.DailyCopyType.Money),this.setUnlockListData(n.Gem[1],n.GemConf,r.DailyCopyType.Gem),this.setUnlockListData(n.Refine[1],n.RefineConf,r.DailyCopyType.Refine),this.setCopyInitData(r.DailyCopyType.Money),this.setCopyInitData(r.DailyCopyType.Refine),this.setCopyInitData(r.DailyCopyType.Gem),this.setCopyInitData(r.DailyCopyType.Artifact),this.sweepVip=n.DailyCopy[1].SweepVip},t.prototype.getAddMoneyNum=function(e){var t=0;if(e)for(var i=this.boxReward.length-1;i>=0;i--)if(e>=this.boxReward[i].per){t=this.boxReward[i].moneyNum;break}return t},t.prototype.getBoxNum=function(){var e=this.boxReward.length;for(var t in this.boxReward)this.boxReward[t].per<=this.per&&e--;return e},t.prototype.getNowHp=function(e,t){var i=this.boxReward.length-this.getBoxNum(),n=i>0?this.boxReward[i-1].per:0;i==this.boxReward.length&&(n=this.boxReward[i-2].per);var o,a=i==this.boxReward.length?this.boxReward[i-1].per:this.boxReward[i].per,r=b.default.instance.rightlives[0],s=0,l=0,c=0;return r&&r.maxHP?(this.maxHP=r.maxHP,l=r.maxHP,c=r.hp):this.maxHP&&(l=this.maxHP),s=Math.floor(l-c-n/100*l),o=Math.floor((a-n)/100*l),(s<0||100==this.per)&&(s=o),s>o?null:[s,o]},t.prototype.setProp=function(e){this.prop=e},t.prototype.setCopyInitData=function(e){this.serDailydata[e]=new p.DailyCopySerVo(e)},t.prototype.setSelectCopyIndex=function(e){this.selectCopyIndex=e;var t=i.instance.getActivityStatus();h.GameEventDispatcher.instance.emit(u.EventDefiner.ChangeActivityStatus,t),this.setBoxReward()},t.prototype.setBoxReward=function(){this.selectCopyIndex==r.DailyCopyType.Money&&(this.boxReward=this.allboxReward[this.dailyCopyData[this.selectCopyIndex].difficulty[this.nowIndex].Box])},t.prototype.setSelectCopyDifficultyIndex=function(e){this.nowIndex=e,this.setBoxReward()},t.prototype.isUnlockSweepVip=function(){return s.MyRoleInfo.vipLevel>=this.sweepVip},t.prototype.setUnlockListData=function(e,t,i){var n=null;switch(i){case r.DailyCopyType.Money:n=new l.DailyCopyMoneyData(e);break;default:n=new c.DailyCopyData(e)}n.setDifficulty(t),this.dailyCopyData[i]=n},t.prototype.isUnclock=function(e){var t=this.dailyCopyData[this.selectCopyIndex].difficulty[e];return f.default.instance.checkIsPass(t.unlockChapter-1,t.unlockSection-1)},t.prototype.getUnclock=function(e){var t=this.dailyCopyData[this.selectCopyIndex].difficulty[e];return{unlockChapter:t.unlockChapter,unlockSection:t.unlockSection}},t.prototype.isCanChallenge=function(e){var t=!0;return 1!=e&&this.selectCopyIndex==r.DailyCopyType.Money&&(t=!!this.serDailydata[r.DailyCopyType.Money].pass[e-2]),t},t.prototype.getUnclockIndex=function(e,t){var i=this.dailyCopyData[t].difficulty[e];return{unlockChapter:i.unlockChapter,unlockSection:i.unlockSection}},t.prototype.openShowMsgUnclock=function(e){var t=i.instance.getUnclockIndex(1,e);y.default.instance.ShowMsg(m.default.getStr("4507",t.unlockChapter,t.unlockSection))},t.prototype.isClearance=function(e){return 1==e||this.serDailydata[this.selectCopyIndex].nowIndex>=e},t.prototype.getGuanQiaId=function(e){return this.dailyCopyData[this.selectCopyIndex].difficulty[e].gaunqiaid},t.prototype.getBattleNumId=function(e){return this.dailyCopyData[e].battleNum+v.CommonUtil.getTimes(this.vipId[e-1])},t.prototype.getEnergyNum=function(e){return this.dailyCopyData[e].energy},t.prototype.getActivityStatus=function(){return this.activityStatus[this.selectCopyIndex]},t.prototype.getDifficultyNum=function(){return this.dailyCopyData[r.DailyCopyType.Money].difficulty[this.nowIndex].rewardfactor},t.prototype.getDifficultyMoney=function(){return this.dailyCopyData[r.DailyCopyType.Money].difficulty[this.nowIndex].rewardNum},t.prototype.getOpen=function(e){return this.serDailydata[e].nowIndex>0},t.prototype.listNotification=function(){this.addProto("moneycopy",this.setCopyData,this),this.addProto("moneycopytimeschange",this.setCopyData,this),this.addProto("moneycopylevelchange",this.setCopyData,this),this.addProto("refinecopy",this.setCopyData,this),this.addProto("refinecopytimeschange",this.setCopyData,this),this.addProto("refinecopylevelchange",this.setCopyData,this),this.addProto("gemcopy",this.setCopyData,this),this.addProto("gemcopytimeschange",this.setCopyData,this),this.addProto("gemcopylevelchange",this.setCopyData,this),this.addProto("artifactcopy",this.setCopyData,this),this.addProto("artifactcopytimeschange",this.setCopyData,this),this.addProto("artifactcopylevelchange",this.setCopyData,this),this.addProto("artifactcopylevelchange",this.setCopyData,this)},t.prototype.setCoin=function(e){var t=this.getAddMoneyNum(e);return this.per=e,t!=this.coin&&(this.coin=t),t},t.prototype.resetRer=function(){this.coin=0,this.per=0},t.prototype.clearTime=function(){this.time&&(_.default.instance.clearTimeout(this.time),this.time=null)},t.prototype.startTime=function(){var e=this;this.time||(this.time=_.default.instance.setTimeout(function(){e.sendMeney()},this,1e3))},t.prototype.getPer=function(){return this.clearTime(),parseInt(this.per.toFixed(0))},t.prototype.sendMeney=function(){var e={cmd:"moneycopymoneycount",money:parseInt(this.per.toFixed(0))};o.default.instance.sendProto(e)},t.prototype.setCopyData=function(e){var t=r.DailyCopyType.Money;switch(e.cmd){case"refinecopy":case"refinecopytimeschange":case"refinecopylevelchange":t=r.DailyCopyType.Refine;break;case"gemcopy":case"gemcopytimeschange":case"gemcopylevelchange":t=r.DailyCopyType.Gem;break;case"artifactcopy":case"artifactcopytimeschange":case"artifactcopylevelchange":t=r.DailyCopyType.Artifact}this.serDailydata[t].updateData(e),h.GameEventDispatcher.instance.emit(u.EventDefiner.DailyCopy),h.GameEventDispatcher.instance.emit(u.EventDefiner.ActivityCopyUpdateRed,g.WindowType.DailyCopy)},t.prototype.sweepAway=function(e){var t={cmd:this.activityStr[this.selectCopyIndex],lv:e};o.default.instance.sendProto(t)},t.prototype.getReddot=function(){for(var e=1;e<=4;e++)if(this.getRedType(e))return!0;return!1},t.prototype.getRedType=function(e){var t;switch(e){case r.DailyCopyType.Gem:t=g.WindowType.DailyCopy;break;case r.DailyCopyType.Money:t=g.WindowType.DailyCopyMoney;break;case r.DailyCopyType.Refine:t=g.WindowType.DailyCopyRefine;break;case r.DailyCopyType.Artifact:t=g.WindowType.DailyCopyArtifact}return this.getReddot1(e,t)},t.prototype.getReddot1=function(e,t){return!(!f.default.instance.checkIsOpenbyWindowtype(t)||!i.instance.getOpen(e))&&(this.serDailydata[e].num>0&&this.getEnergyNum(e)<=s.MyRoleInfo.energy)},t.instance=null,t=i=__decorate([S],t)}(n.default));i.default=I,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/TimeController":"TimeController","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../NetConnect/NetConnet":"NetConnet","../../Util/CommonUtil":"CommonUtil","../Functionicon/FunctionIconController":"FunctionIconController","../Role/RoleInfo":"RoleInfo","../Scene/Manager/SceneManager":"SceneManager","../Status/StatusType":"StatusType","../Tips/OpTipsController":"OpTipsController","./DailyCopyConst":"DailyCopyConst","./DailyCopyData":"DailyCopyData","./DailyCopyMoneyData":"DailyCopyMoneyData","./DailyCopySerVo":"DailyCopySerVo"}],DailyCopyData:[function(e,t,i){"use strict";cc._RF.push(t,"2db2d+xzglMRZNeAA/zYpKg","DailyCopyData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./DailyCopyVo"),o=function(){function e(e){for(var t in this.sandtablestep=null,this.sandtabletimes=null,this.sandtablegrid=null,this.battleNum=null,this.energy=null,this.difficulty=null,this.double=null,e)this[t]=e[t]}return e.prototype.setDifficulty=function(e){for(var t in this.difficulty={},e)this.difficulty[t]=new n.DailyCopyVo(e[t])},e}();i.DailyCopyData=o,cc._RF.pop()},{"./DailyCopyVo":"DailyCopyVo"}],DailyCopyMoneyData:[function(e,t,i){"use strict";cc._RF.push(t,"b4328GwgCRKPI5GI7q5AB1k","DailyCopyMoneyData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./DailyCopyMoneyvo"),o=function(){function e(e){for(var t in this.sandtablestep=null,this.sandtabletimes=null,this.sandtablegrid=null,this.battleNum=null,this.energy=null,this.difficulty=null,this.double=null,e)this[t]=e[t]}return e.prototype.setDifficulty=function(e){for(var t in this.difficulty={},e)this.difficulty[t]=new n.DailyCopyMoneyVo(e[t])},e}();i.DailyCopyMoneyData=o,cc._RF.pop()},{"./DailyCopyMoneyvo":"DailyCopyMoneyVo"}],DailyCopyMoneyVo:[function(e,t,i){"use strict";cc._RF.push(t,"b1cbeWbvH5Nz6hG54LC+KKQ","DailyCopyMoneyVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Util/CommonUtil"),o=function(){return function(e){for(var t in this.levelid=null,this.levelname=null,this.unlockChapter=null,this.unlockSection=null,this.rewardfactor=null,this.gaunqiaid=null,this.boosMaxDamage=null,this.skillName=null,this.Box=null,e)this[t]=e[t];n.CommonUtil.getMonster(this.gaunqiaid,1)}}();i.DailyCopyMoneyVo=o,cc._RF.pop()},{"../../Util/CommonUtil":"CommonUtil"}],DailyCopySerVo:[function(e,t,i){"use strict";cc._RF.push(t,"c5710g0kYRGY5TmCojZ356l","DailyCopySerVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./DailyCopyCtrl"),o=e("./DailyCopyConst"),a=function(){function e(e){this.id=null,this.nowIndex=null,this.pass=[],this.id=e,this.nowIndex=0,this.times=0}return e.prototype.updateData=function(e){if(this.times=null!=e.times?e.times:this.times,this.pass=null!=e.pass?e.pass:this.pass,this.highestUnlockLv=null!=e.highestUnlockLv?e.highestUnlockLv:this.highestUnlockLv,this.id==o.DailyCopyType.Money){this.nowIndex=0;for(var t=0;t<this.highestUnlockLv;t++){if(!this.pass[t]){this.nowIndex++;break}this.nowIndex++}}else null!=e.highestUnlockLv&&(this.nowIndex=null!=e.highestUnlockLv?e.highestUnlockLv:this.nowIndex)},Object.defineProperty(e.prototype,"num",{get:function(){return n.default.instance.getBattleNumId(this.id)-this.times},enumerable:!0,configurable:!0}),e}();i.DailyCopySerVo=a,cc._RF.pop()},{"./DailyCopyConst":"DailyCopyConst","./DailyCopyCtrl":"DailyCopyCtrl"}],DailyCopyVo:[function(e,t,i){"use strict";cc._RF.push(t,"ce01eQ0fkJCurzYI2JBjzXa","DailyCopyVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){return function(e){for(var t in this.levelid=null,this.levelname=null,this.unlockChapter=null,this.unlockSection=null,this.rewardfactor=null,this.gaunqiaid=null,this.skillName=null,this.Box=null,e)this[t]=e[t]}}();i.DailyCopyVo=n,cc._RF.pop()},{}],DailyCopyWin:[function(e,t,i){"use strict";cc._RF.push(t,"c9729P9VCpN/7r3yziDt0U5","DailyCopyWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("./DailyCopyConst"),a=e("../../Core/Language"),r=e("./DailyCopyCtrl"),s=e("../Tips/OpTipsController"),l=e("../../Core/GameEventDispatcher"),c=e("../../Core/Event"),d=e("../../Global/GlobalValue"),p=e("../../Core/WindowType"),h=e("../Scene/Manager/SceneManager"),u=e("../Commons/RewardUtils"),f=e("../Functionicon/FunctionIconController"),g=e("../../GlobalContext"),y=e("../../Core/TimeController"),m=e("../Commons/Image"),C=e("../Role/RoleController"),v=e("../Item/ItemData"),_=e("../../Util/RechargeUtils"),b=e("../../Util/RechargeConst"),T=e("../../Util/Utils"),S=e("../../Util/CommonUtil"),I=cc._decorator,w=I.ccclass,D=I.property,R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Challenge=null,t.str=null,t.ToggleContainer=null,t.ScrollViews=[],t.img=null,t.oldIndex=o.DailyCopyType.Artifact,t.oldXNum=null,t.posX=null,t.wid=[856,802,832,856],t.sysId=[p.WindowType.DailyCopyArtifact,p.WindowType.DailyCopyMoney,p.WindowType.DailyCopy,p.WindowType.DailyCopyRefine],t.vipId=[d.VipPrivilegeType.DailyCopyEquipNum,d.VipPrivilegeType.DailyCopyMoneyNum,d.VipPrivilegeType.DailyCopyGemNum,d.VipPrivilegeType.DailyCopyArtifactNum],t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){i.instance=this,this.onInit(p.WindowType.DailyCopy,!0),e.prototype.onLoad.call(this),this.node.getChildByName("Node").width=g.GlobalContext.StageWidth,this.node.getChildByName("Node").height=g.GlobalContext.StageHeight;var t=cc.find("btn/ChallengeBtn",this.Challenge),n=cc.find("btn/MopUpBtn",this.Challenge);for(var o in t.getChildByName("label").getComponent(cc.Label).string=a.default.getStr("4501"),n.getChildByName("label").getComponent(cc.Label).string=a.default.getStr("4506"),this.wid)this.wid[o]+=.5*(g.GlobalContext.StageWidth-1624);var r=C.default.instance.GetMyWealth(d.WealthType.Energy),s=v.default.creatItem(u.RewardType.Energy,r),l=g.GlobalContext.ResRoot+"resources/itemicon/"+s.ItemIcon+".png";T.default.setImage(this.img.node,l)},t.prototype.show=function(){for(var t in e.prototype.show.call(this),l.GameEventDispatcher.instance.on(c.EventDefiner.DailyCopy,this.updateDailyCopy,this),l.GameEventDispatcher.instance.on(c.EventDefiner.PowerChange,this.updateDailyCopy,this),this.ScrollViews){this.ScrollViews[t].on(cc.Node.EventType.TOUCH_MOVE,this.scrollViewMove,this);var i=cc.find("view/content",this.ScrollViews[t]).children;for(var n in i)i[n].on(cc.Node.EventType.TOUCH_END,this.onClick,this)}this.onChangeIndex(),this.initSelectionState()},t.prototype.scrollViewMove=function(e){var t=this;if(!this.isDong){var i=e.getLocation().x,n=this.ScrollViews[this.oldIndex-1],l=cc.find("view/content",n);if(null==this.posX){var c=this.wid[this.oldIndex-1],d=cc.find("btn/ChallengeBtn",this.Challenge);return this.oldXNum=c-l.getChildByName("1").width*d.id,void(this.posX=i)}var p=Math.abs(i-this.posX);if(!(Math.abs(this.posX-i)<10)){l.x=this.oldXNum+(p<10?p:0),n.off(cc.Node.EventType.TOUCH_MOVE,this.scrollViewMove,this),this.isDong=!0;for(var h=null,u=l.getChildByName("1").width,f=1;f<=l.childrenCount;f++){var g=l.getChildByName(f+""),y=void 0;switch(this.oldIndex){case o.DailyCopyType.Money:case o.DailyCopyType.Refine:case o.DailyCopyType.Gem:y=g.getChildByName("Scale").getChildByName("SelectionBg");break;case o.DailyCopyType.Artifact:y=g.getChildByName("BgDi")}if(y.active){h=f;break}}var m=null;if(this.posX>i){if(m=this.oldXNum,h<l.childrenCount){var C=r.default.instance.isUnclock(h+1);r.default.instance.isCanChallenge(h+1)?C&&(m=this.oldXNum-u,h+=1,this.gemSelection(null,h)):s.default.instance.ShowMsg(a.default.getStr("4512",a.default.getStr("452"+h)))}}else 1==h?m=this.oldXNum:(m=this.oldXNum+u,h-=1,this.gemSelection(null,h));var v=new cc.Vec2(m,l.y);l.runAction(cc.sequence(cc.moveTo(.5,v),cc.callFunc(function(){t.updateaChallgeState(h),t.isDong=null,t.posX=null,n.on(cc.Node.EventType.TOUCH_MOVE,t.scrollViewMove,t)})))}}},t.prototype.updateDailyCopy=function(){this.updateaChallgeState(r.default.instance.nowIndex)},t.prototype.updateaChallgeState=function(e){var t=r.default.instance.serDailydata[this.oldIndex],i=r.default.instance.dailyCopyData[this.oldIndex],n=this.Challenge.getChildByName("SurplusNum");r.default.instance.setSelectCopyDifficultyIndex(e),r.default.instance.setSelectCopyIndex(this.oldIndex);var o=cc.find("btn/ChallengeBtn",this.Challenge),s=cc.find("btn/MopUpBtn",this.Challenge);o.attr({id:e}),s.attr({id:e});o.getChildByName("label").getComponent(cc.Label);var l=o.getComponent(cc.Button),c=s.getComponent(cc.Button);l.interactable=c.interactable=t.num>0,c.node.active=!!t.pass[e-1];var d=a.default.getStr("4500",r.default.instance.getEnergyNum(this.oldIndex));if(n.getComponent(cc.RichText).string=d,cc.find("img/add",this.Challenge).active=!t.num,t.num)n.getChildByName("num").getComponent(cc.RichText).string=a.default.getStr("4511",t.num);else{var p=S.CommonUtil.getNextAddTimes(this.vipId[this.oldIndex-1]);if(null!=p){var h=S.CommonUtil.getBadTimes(this.vipId[this.oldIndex-1]);n.getChildByName("num").getComponent(cc.RichText).string=a.default.getStr("4510",p[0],h)}}this.str.string=T.default.isDoubleTime(i.double),this.updateRedState()},t.prototype.onClickChallenge=function(e,t){var i=r.default.instance.getEnergyNum(this.oldIndex);if(i>C.default.instance.GetMyWealth(d.WealthType.Energy))_.default.PurchaseItemOrRechage(b.RechargeTypeConst.Prop,i,null,this,u.RewardType.Energy);else if(parseInt(t)){var n=cc.find("btn/MopUpBtn",this.Challenge);r.default.instance.isUnlockSweepVip()?r.default.instance.sweepAway(n.id):s.default.instance.ShowMsg(a.default.getStr("4505",r.default.instance.sweepVip))}else{var o=cc.find("btn/ChallengeBtn",this.Challenge),p=r.default.instance.getGuanQiaId(o.id);r.default.instance.getActivityStatus();h.default.instance.attackenemyhp=0,r.default.instance.resetRer(),l.GameEventDispatcher.instance.emit(c.EventDefiner.ChangeGameScene,{status:d.GameScene.Fight,guanqiaId:p}),r.default.instance.prop=null}},t.prototype.hide=function(){for(var t in e.prototype.hide.call(this),l.GameEventDispatcher.instance.off(c.EventDefiner.DailyCopy,this.updateDailyCopy,this),l.GameEventDispatcher.instance.off(c.EventDefiner.PowerChange,this.updateDailyCopy,this),this.ScrollViews){for(var i in this.ScrollViews[t].off(cc.Node.EventType.TOUCH_MOVE,this.scrollViewMove,this),this.ScrollViews[t].children)this.ScrollViews[t].children[i].off(cc.Node.EventType.TOUCH_END,this.onClick,this);this.ScrollViews[t].active=!1}this.posX=this.oldXNum=null,this.isDong=null},t.prototype.onClick=function(e){var t=this;if(!this.isDong){var i=this.ScrollViews[this.oldIndex-1],n=cc.find("view/content",i),l=e.getLocation().x;if(null==this.posX){var c=this.wid[this.oldIndex-1],d=cc.find("btn/ChallengeBtn",this.Challenge);this.oldXNum=c-n.getChildByName("1").width*d.id,this.posX=l}var p=parseInt(e.target.name),h=r.default.instance.isUnclock(p),u=r.default.instance.getUnclock(p);if(h)if(r.default.instance.isCanChallenge(p)){for(var f,g=void 0,y=n.getChildByName("1").width,m=1;m<=n.childrenCount;m++){var C=n.getChildByName(m+""),v=void 0;switch(this.oldIndex){case o.DailyCopyType.Money:case o.DailyCopyType.Refine:case o.DailyCopyType.Gem:v=C.getChildByName("Scale").getChildByName("SelectionBg");break;case o.DailyCopyType.Artifact:v=C.getChildByName("BgDi")}if(v.active){g=m;break}}if(p==g)return;this.gemSelection(null,p),f=this.oldXNum+(g-p)*y;var _=new cc.Vec2(f,n.y);n.runAction(cc.sequence(cc.moveTo(.5,_),cc.callFunc(function(){t.updateaChallgeState(p),t.isDong=null,t.posX=null})))}else s.default.instance.ShowMsg(a.default.getStr("4512",a.default.getStr("452"+(p-1))));else{var b=a.default.getStr("4503",u.unlockChapter,u.unlockSection);s.default.instance.ShowMsg(b)}}},t.prototype.updateRedState=function(){for(var e=this.ToggleContainer.node.children,t=0;t<e.length;t++)cc.find("Background/flag",e[t]).active=r.default.instance.getRedType(t+1)},t.prototype.gemSelection=function(e,t){for(var i=this.ScrollViews[this.oldIndex-1],n=cc.find("view/content",i),a=1;a<=n.childrenCount;a++){var r=n.getChildByName(a+""),s=void 0;switch(this.oldIndex){case o.DailyCopyType.Money:case o.DailyCopyType.Refine:case o.DailyCopyType.Gem:var l=r.getChildByName("Scale");s=l.getChildByName("SelectionBg"),l.scaleX=l.scaleY=a==t?1:.85,s.active=a==t;break;case o.DailyCopyType.Artifact:var c=(s=r.getChildByName("SelectionBg")).getComponent(cc.Layout),d=r.getChildByName("BgDi"),p=cc.rotateBy(2,360),h=cc.repeatForever(p);d.active=a==t,a==t?(s.children[1].y=0,c.spacingX=120,d.runAction(h)):(s.children[1].y=-12,c.spacingX=-28)}}this.updateaChallgeState(t)},t.prototype.updateCopyData=function(){var e=r.default.instance.serDailydata[this.oldIndex],t=r.default.instance.dailyCopyData[this.oldIndex];this.gemSelection(null,e.nowIndex);var i=this.wid[this.oldIndex-1],n=this.ScrollViews[this.oldIndex-1],s=cc.find("view/content",n),l=s.getChildByName("1");switch(s.x=i-l.width*e.nowIndex,this.oldIndex){case o.DailyCopyType.Money:case o.DailyCopyType.Refine:case o.DailyCopyType.Gem:for(var c=1;c<=s.childrenCount;c++){var d=s.getChildByName(c+""),p=d.getChildByName("Scale").getChildByName("Unlock"),h=d.getChildByName("UnlockLv");d.getChildByName("Adopt").active=!1;var u=r.default.instance.isUnclock(c);p.active=!u;var f=r.default.instance.getUnclock(c);if(h.active=!u,!u){var g=a.default.getStr("4503",f.unlockChapter,f.unlockSection);h.getComponent(cc.RichText).string=g}if(this.oldIndex==o.DailyCopyType.Money){var y=cc.find("Scale/skill",d),m=t.difficulty[c].skillName;y.active=!1,r.default.instance.isCanChallenge(c)&&u?m&&(y.active=!0,y.getChildByName("skillName").getComponent(cc.Label).string=a.default.getStr("4526",m)):u&&(h.active=!0,h.getComponent(cc.RichText).string=a.default.getStr("4512",a.default.getStr("452"+(c-1))))}}break;case o.DailyCopyType.Artifact:for(c=1;c<=s.childrenCount;c++){var C=s.getChildByName(c+"");p=C.getChildByName("Unlock"),h=C.getChildByName("UnlockLv");C.getChildByName("Adopt").active=!1,p.active=c>e.nowIndex;u=r.default.instance.isUnclock(c),f=r.default.instance.getUnclock(c);if(h.active=!u,!u){g=a.default.getStr("4503",f.unlockChapter,f.unlockSection);h.getComponent(cc.RichText).string=g}}}},t.prototype.onChangeIndex=function(){var e,t=f.default.instance.getOpenConfig;if(t&&t.config){switch(t.config.windowType){case p.WindowType.DailyCopy:e=o.DailyCopyType.Gem;break;case p.WindowType.DailyCopyArtifact:e=o.DailyCopyType.Artifact;break;case p.WindowType.DailyCopyMoney:e=o.DailyCopyType.Money;break;case p.WindowType.DailyCopyRefine:e=o.DailyCopyType.Refine}e&&(r.default.instance.setSelectCopyIndex(e),this.initSelectionState())}f.default.instance.setOpenConfig=null},t.prototype.initSelectionState=function(){var e=this;this.oldIndex=r.default.instance.selectCopyIndex,this.ScrollViews[this.oldIndex-1].active=!0;var t=y.default.instance.setTimeout(function(){e.ToggleContainer.node.children[e.oldIndex-1].getComponent(cc.Toggle).isChecked=!0,e.updateCopyData(),y.default.instance.clearTimeout(t)},this,200)},t.prototype.onClickToggle=function(e){var t=this,i=parseInt(e.target.name);if(i&&i!=this.oldIndex){var n=this.sysId[i-1],o=f.default.instance.checkIsOpenbyWindowtype(n,!0);if(o&&r.default.instance.getOpen(i)){this.ScrollViews[this.oldIndex-1].active=!1,this.ScrollViews[i-1].active=!0,this.oldIndex=i;var a=y.default.instance.setTimeout(function(){t.updateCopyData(),y.default.instance.clearTimeout(a)},this,50)}else{o&&r.default.instance.openShowMsgUnclock(i);var s=y.default.instance.setTimeout(function(){t.ToggleContainer.node.children[t.oldIndex-1].getComponent(cc.Toggle).isChecked=!0,y.default.instance.clearTimeout(s)},this,200)}}},t.instance=null,__decorate([D(cc.Node)],t.prototype,"Challenge",void 0),__decorate([D(cc.RichText)],t.prototype,"str",void 0),__decorate([D(cc.ToggleContainer)],t.prototype,"ToggleContainer",void 0),__decorate([D([cc.Node])],t.prototype,"ScrollViews",void 0),__decorate([D(m.default)],t.prototype,"img",void 0),t=i=__decorate([w],t)}(n.default);i.default=R,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/TimeController":"TimeController","../../Core/Window":"Window","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/CommonUtil":"CommonUtil","../../Util/RechargeConst":"RechargeConst","../../Util/RechargeUtils":"RechargeUtils","../../Util/Utils":"Utils","../Commons/Image":"Image","../Commons/RewardUtils":"RewardUtils","../Functionicon/FunctionIconController":"FunctionIconController","../Item/ItemData":"ItemData","../Role/RoleController":"RoleController","../Scene/Manager/SceneManager":"SceneManager","../Tips/OpTipsController":"OpTipsController","./DailyCopyConst":"DailyCopyConst","./DailyCopyCtrl":"DailyCopyCtrl"}],DailyData:[function(e,t,i){"use strict";cc._RF.push(t,"d78f5MOHqFKWJmDg3HTW0eW","DailyData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/ConfigsManager"),o=cc._decorator,a=o.ccclass,r=(o.property,function(){function e(){this.id=0,this._config=null,this.configB=null,this._configfetter=null,this._configVitality=null,this.configreward_=null,this.configFetter=null,this.configItem=null}return Object.defineProperty(e.prototype,"config",{get:function(){return this._config=n.ConfigsManager.instance.getConfigs("Dailymission"),this._config.Daily},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"config_",{get:function(){return this.configB=n.ConfigsManager.instance.getConfigs("Dailymission"),this.configB.Dailymission},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"configVitality",{get:function(){return this._configVitality=n.ConfigsManager.instance.getConfigs("Dailymission").Vitality,this._configVitality},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"configItem_",{get:function(){return this.configItem=n.ConfigsManager.instance.getConfigs("Itemconf").ItemConf,this.configItem},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"configfetter",{get:function(){return this._configfetter=n.ConfigsManager.instance.getConfigs("Dailymission"),this._configfetter.FetterNumber},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"configReward",{get:function(){return this.configreward_=n.ConfigsManager.instance.getConfigs("Dailymission"),this.configreward_.Award},enumerable:!0,configurable:!0}),e.prototype.initid=function(e){this.id=e},Object.defineProperty(e.prototype,"taskDetails",{get:function(){return this.config[this.id].taskdetails},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"taskName",{get:function(){return this.config[this.id].title},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){return this.config[this.id].icon},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this.config[this.id].type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vitality",{get:function(){return this.config[this.id].liveness},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"windowstype",{get:function(){return this.config[this.id].windowstype},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"chapter",{get:function(){return this.config[this.id].chapter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"checkpoint",{get:function(){return this.config[this.id].checkpoint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vitalityBox",{get:function(){return this._configVitality[this.id].number},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"boxReward",{get:function(){return this._configVitality[this.id].item},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"boxRewardNum",{get:function(){return this._configVitality[this.id].count},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"time",{get:function(){return this.config[this.id].time},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vitality_",{get:function(){return this.config_[1].max},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reward",{get:function(){return this.config[this.id].reward},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"number_",{get:function(){return this.configReward[this.id].itemNumber},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemNumber",{get:function(){return this.configReward[this.id].Number},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemIcon",{get:function(){return this.configReward[this.id].icon},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fetterBox",{get:function(){return this.configfetter[this.id].fetter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"configfetter_",{get:function(){return this.configFetter=n.ConfigsManager.instance.getConfigs("Dailymission"),this.configFetter.Fetter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fetterMax",{get:function(){return this.configfetter_[1].fettermax},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fetterReward",{get:function(){return this.configfetter[this.id].reward},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fetterNum",{get:function(){return this.configfetter[this.id].count},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemDes",{get:function(){return this.configItem_[this.id].ItemDesc},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemName",{get:function(){return this.configItem_[this.id].ItemName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rewardID",{get:function(){return this._configVitality[this.id].reward},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"goals",{get:function(){return this.config[this.id].goals},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"clientType",{get:function(){return this.config[this.id].clientType},enumerable:!0,configurable:!0}),e=__decorate([a],e)}());i.default=r,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager"}],DailyItem:[function(e,t,i){"use strict";cc._RF.push(t,"ba062SkKCJDApfCLSNZgLrH","DailyItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("./DailyData"),a=e("./Daily"),r=e("../../NetConnect/NetConnet"),s=e("../../Core/GameEventDispatcher"),l=e("./Dailycontroller"),c=e("../OpenWin/OpenWinController"),d=e("../Sports/SportsWindow"),p=e("../../Core/Event"),h=e("../../Core/WindowType"),u=e("../WarTeam/WarTeamMonsterInfo"),f=e("../WarTeam/MonsterController"),g=e("../Functionicon/FunctionIconController"),y=e("../Commons/WindowOpenUtils"),m=e("../Scene/Controller/SceneController"),C=e("../../Global/GlobalValue"),v=e("../Equip/equip/EquipCtrl"),_=cc._decorator,b=_.ccclass,T=_.property,S=function(e){function t(){var t=e.call(this)||this;return t.dailyIcon=null,t.itemTitle=null,t.btnLabe=null,t.content=null,t.progressBar=null,t.taskProgress=null,t.isOk=null,t.btn=null,t.getBtn=null,t.readImage=null,t.isFinish=!1,t.isGet=!1,t.vitality=null,t.type=null,t.rewardIcon=null,t.rewardNumber=null,t.num=0,t.time=null,t.timeArray=[],t.flag=!1,t.ind=null,t.ID=null,t.index=0,i.instance=t,t.dailyData=new o.default,t.sportsWindow=new d.default,t}var i;return __extends(t,e),i=t,t.prototype.show=function(){e.prototype.show.call(this),this.timeArray.length>1&&null!=this.ind&&(this.time=this.timeArray[this.ind],this.taskProgress.string=this.num+"/"+this.time),this.BtnStateChange(),this.setprogressValue()},t.prototype.hide=function(){e.prototype.hide.call(this)},t.prototype.clickBtnEvent=function(){if(this.dailyData.initid(this.ID),m.default.instance.scenestatus!=C.GameScene.Main&&1!=this.dailyData.windowstype&&s.GameEventDispatcher.instance.emit(p.EventDefiner.ChangeGameScene,{status:C.GameScene.Main}),null!=this.dailyData.windowstype){if(!g.default.instance.checkIsOpenbyWindowtype(this.dailyData.windowstype,!0))return;s.GameEventDispatcher.instance.emit("CLOSEWINDOW",this),this.dailyData.windowstype==h.WindowType.CardInfo?c.default.instance.openWindow(h.WindowType.WarTeam,function(){f.default.instance.openMonsterInfoPrefab(f.MonsterType.MonsterWarTeam[f.MonsterType.MonsterBattle][0],u.CardTag.upgrade,null,null,!1)}):this.dailyData.windowstype==h.WindowType.Ornament?c.default.instance.openWindow(h.WindowType.WarTeam,function(){f.default.instance.openMonsterInfoPrefab(f.MonsterType.MonsterWarTeam[f.MonsterType.MonsterBattle][0],u.CardTag.equip,null,null,!1)}):18==this.dailyData.type?this.openEqiupStrengthen():y.default.instance.openWindowType(this.dailyData.windowstype)}},t.prototype.getBtnClickEvent=function(){var e=this.timeArray.length-1;if(this.num>=this.timeArray[e]&&0==this.flag)this.isOk.active=!0,this.getBtn.node.active=!1;else{this.getBtn.node.active=!1,this.btn.node.active=!0;for(var t=0;t<this.timeArray.length;t++)if(0==this.flag&&this.time<=this.timeArray[t]){void 0==this.timeArray[t+1]&&(this.time=this.timeArray[this.timeArray.length-1]),this.time=this.timeArray[t+1];break}this.taskProgress.string=this.num+"/"+this.time,this.setprogressValue()}a.default.instance.progressBar.progress+=this.vitality/100,a.default.instance.vitalityLabe.string=""+(l.default.instance.vitalityNum+this.vitality),this.getTaskReward()},t.prototype.BtnStateChange=function(){for(var e=0;e<this.timeArray.length;e++){if(this.num>=this.timeArray[this.timeArray.length-1]&&1==this.flag){this.isOk.active=!0,this.getBtn.node.active=!1,this.btn.node.active=!1;break}if(this.num>=this.time&&0==this.flag){this.btn.node.active=!1,this.getBtn.node.active=!0;break}this.btn.node.active=!0,this.getBtn.node.active=!1;break}},t.prototype.getTaskReward=function(){for(var e=0;e<this.timeArray.length;e++)if(this.num<=this.timeArray[e]){this.index=e;break}var t={cmd:"taskreward",id:this.ID-1,index:this.index};r.default.instance.sendProto(t)},t.prototype.getFetterList=function(){r.default.instance.sendProto({cmd:"dtmemberlist"})},t.prototype.getNum=function(){return this.num},t.prototype.getIsFinish=function(){return this.isFinish},t.prototype.setGetInfo=function(e){this.isGet=e,this.isGet&&(this.isOk.active=!0,this.btn.node.active=!1,this.getBtn.node.active=!1)},t.prototype.getGetInfo=function(){return this.isGet},t.prototype.setprogressValue=function(){this.progressBar.progress=this.num/this.time},t.prototype.setVitality=function(e){this.vitality=e},t.prototype.setID=function(e){this.ID=e},t.prototype.setNum=function(e){this.num=e},t.prototype.setTime=function(e){this.time=e},t.prototype.setTimeArray=function(e){this.timeArray=e},t.prototype.setFlag=function(e){this.flag=e},t.prototype.openEqiupStrengthen=function(){var e=0,t=0,i=f.MonsterType.MonsterWarTeam[f.MonsterType.MonsterBattle];for(var n in i){var o=!1,a=v.default.instance.data.getEquipList(parseInt(i[n]));for(var r in a)if(v.default.instance.data.getEquipUPlevFlag(parseInt(i[n]),parseInt(r))){o=!0,e=parseInt(n),t=parseInt(r);break}if(o)break}c.default.instance.openWindow(h.WindowType.WarTeam,function(){f.default.instance.openMonsterInfoPrefab(f.MonsterType.MonsterWarTeam[f.MonsterType.MonsterBattle][e],u.CardTag.equip,null,null,!1,!0,h.WindowType.Strengthen,t)})},t.instance=null,__decorate([T(cc.Sprite)],t.prototype,"dailyIcon",void 0),__decorate([T(cc.Label)],t.prototype,"itemTitle",void 0),__decorate([T(cc.Label)],t.prototype,"btnLabe",void 0),__decorate([T(cc.Node)],t.prototype,"content",void 0),__decorate([T(cc.ProgressBar)],t.prototype,"progressBar",void 0),__decorate([T(cc.Label)],t.prototype,"taskProgress",void 0),__decorate([T(cc.Node)],t.prototype,"isOk",void 0),__decorate([T(cc.Button)],t.prototype,"btn",void 0),__decorate([T(cc.Button)],t.prototype,"getBtn",void 0),__decorate([T(cc.Sprite)],t.prototype,"readImage",void 0),t=i=__decorate([b],t)}(n.default);i.default=S,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../NetConnect/NetConnet":"NetConnet","../Commons/WindowOpenUtils":"WindowOpenUtils","../Equip/equip/EquipCtrl":"EquipCtrl","../Functionicon/FunctionIconController":"FunctionIconController","../OpenWin/OpenWinController":"OpenWinController","../Scene/Controller/SceneController":"SceneController","../Sports/SportsWindow":"SportsWindow","../WarTeam/MonsterController":"MonsterController","../WarTeam/WarTeamMonsterInfo":"WarTeamMonsterInfo","./Daily":"Daily","./DailyData":"DailyData","./Dailycontroller":"Dailycontroller"}],DailyMealConst:[function(e,t,i){"use strict";cc._RF.push(t,"dad76HOaapB55Rs/TUgU/XU","DailyMealConst"),Object.defineProperty(i,"__esModule",{value:!0}),function(e){e[e.Not=0]="Not",e[e.Period=1]="Period",e[e.Overdue=2]="Overdue",e[e.Received=3]="Received"}(i.DailyMealConst||(i.DailyMealConst={})),cc._RF.pop()},{}],DailyMealCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"966afwvtIxDXpZ6RzzcTeoV","DailyMealCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Controller"),o=e("../../../Core/ConfigsManager"),a=e("../../../NetConnect/NetConnet"),r=e("../../../Core/GameEventDispatcher"),s=e("../../../Core/Event"),l=e("./DailyMealVo"),c=e("../../Tips/OpTipsController"),d=e("../../../Core/Language"),p=e("./DailyMealConst"),h=e("../welfarelobby"),u=e("../../../Global/GlobalValue"),f=e("../welfarelobbyUtils"),g=e("../../Role/RoleInfo"),y=cc._decorator,m=y.ccclass,C=(y.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.config={},t.serData=[],t.onSurplusTime=0,t.historyTime=0,t.redState=!1,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this;var t=o.ConfigsManager.instance.getConfigs("DailyMealConf");t=t.reward[1];for(var n=0;n<t.length;n++)this.config[n]=new l.DailyMealVo(t[n]),this.config[n].index=n;for(var a in t=o.ConfigsManager.instance.getConfigs("welfarelobbyconf").welfarelobby[1])if(t[a].prefabname==u.WelfareType.welfareOnlineReward){this.windowId=t[a].windowid;break}},t.prototype.updateRed=function(){var e=this.getReddot();f.welfarelobbyUtils.isOpenWindow()&&this.redState!=e&&h.default.instance.IsRead(u.WelfareType.DailyMeal,e),this.redState!=e&&(this.redState=e,f.welfarelobbyUtils.setRed())},t.prototype.listNotification=function(){this.addProto("dailymeal",this.dailymeal,this)},t.prototype.dailymeal=function(e){e.nextTimestamp&&(this.onSurplusTime=e.nextTimestamp,this.historyTime=Date.now());var t=e.receiveRecord;if(this.isInit){for(var n in t)if(t[n]&&!this.serData[n]){var o=i.instance.config[n];c.default.instance.ShowMsg(d.default.getStr("6510",o.physicalValues));break}}else this.isInit=!0;this.serData=e.receiveRecord?e.receiveRecord:this.serData,this.updateRed(),r.GameEventDispatcher.instance.emit(s.EventDefiner.welfareDailyMealUpdate)},t.prototype.dailyMealReq=function(e,t){var n={cmd:"dailymeal",type:e,index:t};i.instance.config[e].physicalValues+g.MyRoleInfo.energy>g.MyRoleInfo.maxEnergy?c.default.instance.ShowMsg(d.default.getStr("6525")):a.default.instance.sendProto(n)},t.prototype.getOverTime=function(){var e=this.onSurplusTime-(Date.now()-this.historyTime);return e=e>0?e:0},t.prototype.getReddot=function(){var e=!1;for(var t in this.config)if(this.config[t].getReceiveState()==p.DailyMealConst.Period||this.config[t].getReceiveState()==p.DailyMealConst.Overdue){e=!0;break}return e},t.instance=null,t=i=__decorate([m],t)}(n.default));i.default=C,cc._RF.pop()},{"../../../Core/ConfigsManager":"ConfigsManager","../../../Core/Controller":"Controller","../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Global/GlobalValue":"GlobalValue","../../../NetConnect/NetConnet":"NetConnet","../../Role/RoleInfo":"RoleInfo","../../Tips/OpTipsController":"OpTipsController","../welfarelobby":"welfarelobby","../welfarelobbyUtils":"welfarelobbyUtils","./DailyMealConst":"DailyMealConst","./DailyMealVo":"DailyMealVo"}],DailyMealVo:[function(e,t,i){"use strict";cc._RF.push(t,"490d1+PYx5LQYeUc1Jys3a1","DailyMealVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/TimeController"),o=e("./DailyMealCtrl"),a=e("./DailyMealConst"),r=e("../../../Util/DateUtil"),s=function(){function e(e){for(var t in e)this[t]=e[t];this.startTimeStamp=r.DateUtil.timeToSec(this.startTime),this.endTimeStamp=r.DateUtil.timeToSec(this.endTime)}return e.prototype.getReceiveState=function(){a.DailyMealConst.Not;var e=n.default.instance.ServerTimeMins;return e=r.DateUtil.timeToSec(r.DateUtil.getYMDHMS(e)),o.default.instance.serData[this.index]?a.DailyMealConst.Received:this.startTimeStamp>e?a.DailyMealConst.Not:this.endTimeStamp>=e?a.DailyMealConst.Period:a.DailyMealConst.Overdue},e}();i.DailyMealVo=s,cc._RF.pop()},{"../../../Core/TimeController":"TimeController","../../../Util/DateUtil":"DateUtil","./DailyMealConst":"DailyMealConst","./DailyMealCtrl":"DailyMealCtrl"}],DailyMeal:[function(e,t,i){"use strict";cc._RF.push(t,"ee6e5+s7NVId4KIgwRKevoM","DailyMeal"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Language"),o=e("../../../Core/Widget"),a=e("../../Tips/OpTipsController"),r=e("./DailyMealCtrl"),s=e("./DailyMealConst"),l=e("../../../Util/DateUtil"),c=e("../../../Core/GameEventDispatcher"),d=e("../../../Core/Event"),p=e("../../../Core/TimeController"),h=e("../../../Util/RechargeUtils"),u=e("../../../Util/RechargeConst"),f=e("../../Tips/TipsWinController"),g=cc._decorator,y=g.ccclass,m=g.property,C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.atlas=null,t.richtext=null,t.eatImg=["bg_mrdc4","bg_mrdc5","bg_mrdc6"],t.nodes=[],t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this);var t=r.default.instance.config;for(var i in t)this.nodes[i].getChildByName("timeLabel").getComponent(cc.Label).string=n.default.getStr("6507",t[i].startTime,t[i].endTime)},t.prototype.show=function(){e.prototype.show.call(this),i.instance=this,this.updateData(),c.GameEventDispatcher.instance.on(d.EventDefiner.welfareDailyMealUpdate,this.updateData,this),this.setAnimation(),this.setStr(),this.time=p.default.instance.setInterval(this.setStr,this,1e3)},t.prototype.setAnimation=function(){for(var e,t=0;t<this.nodes.length;t++){(e=this.nodes[t].getChildByName("receiveState")).stopAllActions();var i=cc.repeatForever(cc.sequence(cc.moveBy(.5,cc.v2(0,10)),cc.moveBy(.5,cc.v2(0,-10))));e.runAction(i)}},t.prototype.clearAnimation=function(){for(var e=0;e<this.nodes.length;e++)this.nodes[e].getChildByName("receiveState").stopAllActions()},t.prototype.hide=function(){e.prototype.hide.call(this),this.clearAnimation(),p.default.instance.clearInterval(this.time),this.time=null,c.GameEventDispatcher.instance.on(d.EventDefiner.welfareDailyMealUpdate,this.updateData,this)},t.prototype.updateData=function(){r.default.instance.serData;for(var e,t,i,n,o,a=0;a<this.nodes.length;a++)switch(e=this.nodes[a],t=r.default.instance.config[a].getReceiveState(),i=e.getChildByName("img").getComponent(cc.Sprite),n=e.getChildByName("receiveState"),o=e.getChildByName("wartImg"),i.node.active=!1,o.active=!1,n.active=!1,t){case s.DailyMealConst.Not:o.active=!0;break;case s.DailyMealConst.Period:i.node.active=!0,n.active=!0,i.spriteFrame=this.atlas.getSpriteFrame(this.eatImg[a]),n.getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame("bg_mrdc8");break;case s.DailyMealConst.Overdue:i.node.active=!0,n.active=!0,i.spriteFrame=this.atlas.getSpriteFrame(this.eatImg[a]),n.getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame("bg_mrdc7");break;case s.DailyMealConst.Received:i.node.active=!0,i.spriteFrame=this.atlas.getSpriteFrame("bg_mrdc3")}},t.prototype.onClickSend=function(e,t){var i=this,o=parseInt(t),l=r.default.instance.config[o];switch(l.getReceiveState()){case s.DailyMealConst.Not:a.default.instance.ShowMsg(n.default.getStr("6500"));break;case s.DailyMealConst.Period:r.default.instance.dailyMealReq(1,l.index);break;case s.DailyMealConst.Overdue:f.default.instance.ShowTips(n.default.getStr("6501",l.diamond,l.physicalValues),function(){h.default.PurchaseItemOrRechage(u.RechargeTypeConst.Diamonds,l.diamond,function(){r.default.instance.dailyMealReq(2,l.index)},i)},this);break;case s.DailyMealConst.Received:a.default.instance.ShowMsg(n.default.getStr("6508"))}},t.prototype.setStr=function(){var e=r.default.instance.getOverTime();this.richtext.string=n.default.getStr("6509",l.DateUtil.timeSecondsToChineseHour(e))},t.instance=null,__decorate([m(cc.SpriteAtlas)],t.prototype,"atlas",void 0),__decorate([m(cc.RichText)],t.prototype,"richtext",void 0),__decorate([m([cc.Node])],t.prototype,"nodes",void 0),t=i=__decorate([y],t)}(o.default);i.default=C,cc._RF.pop()},{"../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Core/TimeController":"TimeController","../../../Core/Widget":"Widget","../../../Util/DateUtil":"DateUtil","../../../Util/RechargeConst":"RechargeConst","../../../Util/RechargeUtils":"RechargeUtils","../../Tips/OpTipsController":"OpTipsController","../../Tips/TipsWinController":"TipsWinController","./DailyMealConst":"DailyMealConst","./DailyMealCtrl":"DailyMealCtrl"}],DailySignInController:[function(e,t,i){"use strict";cc._RF.push(t,"3bc29tY8CtHKYYLSyaa2PVW","DailySignInController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../Core/GameEventDispatcher"),a=e("../../Core/TimeController"),r=e("../welfarelobby/welfarelobbyUtils"),s=e("../../Global/GlobalValue"),l=e("../../Core/ConfigsManager"),c=e("../Daily/Dailycontroller"),d=cc._decorator,p=d.ccclass,h=(d.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lastSignInTimes=0,t.allSignInTimes=0,t.curDayRetroactiveCnt=0,t.signInTimes=0,t.signInDays=0,t.signInArray=[],t.boxArray=[],t}var i;return __extends(t,e),i=t,t.prototype.listNotification=function(){this.addProto("dailysign",this.SigninInfo,this),this.addProto("accumulativesign",this.BoxInfo,this),i.instance=this},t.prototype.BoxInfo=function(e){this.boxArray=e.data,o.GameEventDispatcher.instance.emit("BOXINFO",this)},t.prototype.SigninInfo=function(e){this.curDayRetroactiveCnt=e.curDayRetroactiveCnt,this.lastSignInTimes=e.remainRetroactiveCnt,this.allSignInTimes=e.totalRetroactiveCnt,this.signInTimes=e.totalSignCnt,this.signInDays=e.sum?e.sum:0,this.signInArray=e.signRecord,r.welfarelobbyUtils.setRed(),o.GameEventDispatcher.instance.emit("SIGNININFO",this)},t.prototype.CheckIsRed=function(){if(this.isValid){for(var e=new Date(a.default.instance.ServerTimeMins).getDate(),t=0;t<this.signInArray.length;t++)if(1==this.signInArray[t]&&t+1==e)return!0;var i=this.getVitality();return this.curDayRetroactiveCnt<1&&this.lastSignInTimes>0&&c.default.instance.vitalityNum>=i||void 0}},t.prototype.getVipExp=function(e){void 0===e&&(e=!1);var t=e?this.signInDays+1:this.signInDays,i=s.VIPBaseParam+10*(t-1)<s.VIPMaxExp?s.VIPBaseParam+10*(t-1):s.VIPMaxExp;return i<s.VIPMinExp&&(i=s.VIPMinExp),i},t.prototype.getVitality=function(){return l.ConfigsManager.instance.getConfigs("dailysignconf").DailySignConf[1].vitality},t.instance=null,t=i=__decorate([p],t)}(n.default));i.default=h,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Controller":"Controller","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/TimeController":"TimeController","../../Global/GlobalValue":"GlobalValue","../Daily/Dailycontroller":"Dailycontroller","../welfarelobby/welfarelobbyUtils":"welfarelobbyUtils"}],DailySignIn:[function(e,t,i){"use strict";cc._RF.push(t,"760c3XrP1FDF6TLT81wBTOo","DailySignIn"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/TimeController"),a=e("../Item/ItemData"),r=e("../Item/ItemIcon"),s=e("../../Core/ConfigsManager"),l=e("../../NetConnect/NetConnet"),c=e("../../Core/GameEventDispatcher"),d=e("./DailySignInController"),p=e("../../Core/Language"),h=e("../../Core/WindowType"),u=e("../OpenWin/OpenWinController"),f=e("../../Util/Utils"),g=e("../Tips/OpTipsController"),y=e("../welfarelobby/welfarelobby"),m=e("../../Global/GlobalValue"),C=e("../../Core/LoadManager"),v=e("../../GlobalContext"),_=e("../Commons/RulePage"),b=e("../Role/RoleInfo"),T=e("../Vip/VipCtrl"),S=e("../../Core/Event"),I=cc._decorator,w=I.ccclass,D=I.property,R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=null,t.boxPrefab=null,t.boxContent=null,t.lastTimes=null,t.allTimes=null,t.commAtlas=null,t.sigInAtlas=null,t.startLabe=null,t.endLabe=null,t.tipsWin=null,t.sctollView=null,t.vipLev=null,t.vipProgressBar=null,t.vipEXP=null,t.vipText=null,t.config=null,t.currMonth=null,t.siginDay=null,t.signRecord=[],t.dayPostion=0,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this),c.GameEventDispatcher.instance.on("SIGNININFO",this.upData,this),c.GameEventDispatcher.instance.on("MovePos",this.MoveTargetPos,this),c.GameEventDispatcher.instance.on(S.EventDefiner.rewardTips_close,this.openVipUPTips,this),this.config=s.ConfigsManager.instance.getConfigs("dailysignconf"),this.currMonth=new Date(o.default.instance.ServerTimeMins).getMonth()+1,this.tipsWin.active=!1,this.upData()},t.prototype.hide=function(){e.prototype.hide.call(this),c.GameEventDispatcher.instance.off(S.EventDefiner.rewardTips_close,this.openVipUPTips,this),c.GameEventDispatcher.instance.off("SIGNININFO",this.upData,this),c.GameEventDispatcher.instance.off("MovePos",this.MoveTargetPos,this)},t.prototype.MoveTargetPos=function(){this.sctollView.scrollToOffset(cc.v2(0,Math.abs(this.dayPostion)))},t.prototype.upData=function(){this.Info(),this.setVIPData()},t.prototype.Info=function(){var e=this;this.lastTimes.string=d.default.instance.lastSignInTimes+"",this.allTimes.string=d.default.instance.allSignInTimes+"",this.signRecord=d.default.instance.signInArray;var t=new Date(o.default.instance.ServerTimeMins),i=t.getDate(),n=t.getFullYear();this.siginDay=new Date(n,this.currMonth,0).getDate(),this.startLabe.string=new Date(o.default.instance.ServerTimeMins).getFullYear()+"."+this.currMonth+".1",this.endLabe.string=new Date(o.default.instance.ServerTimeMins).getFullYear()+"."+this.currMonth+"."+this.siginDay,C.default.instance.loadResByType(v.GlobalContext.Root+"prefab/DailySigIn/SiginItem",cc.Prefab,function(t){for(var n=function(n){if(!e.content.children[n]){var o=f.default.getNodeByUrl(t,v.GlobalContext.Root+"prefab/DailySigIn/SiginItem"),s=a.default.creatItem(e.config.month[1][n].itemId,e.config.month[1][n].itemCnt);o.children[1].getComponent(r.default).ItemData(s,!0,null,!0),o.children[2].getComponent(cc.Label).string=p.default.getStr("SinginTips2",e.config.month[1][n].day),e.config.month[1][n].VipLevel?(o.children[4].active=!0,o.children[4].children[0].getComponent(cc.Sprite).spriteFrame=e.sigInAtlas.getSpriteFrame("i18n_v"+e.config.month[1][n].VipLevel)):o.children[4].active=!1,e.content.addChild(o)}var l=e.content.children[n];if(0==e.signRecord[n])l.children[0].getComponent(cc.Sprite).spriteFrame=e.commAtlas.getSpriteFrame("bg_fldt4"),l.children[2].active=!0,l.children[3].active=!1;else if(1==e.signRecord[n]){var d=e.config.month[1][n].day==i;l.children[0].getComponent(cc.Sprite).spriteFrame=d?e.commAtlas.getSpriteFrame("bg_fldt3"):e.commAtlas.getSpriteFrame("bg_fldt5"),l.children[2].active=!1,l.children[3].getComponent(cc.Sprite).spriteFrame=d?e.commAtlas.getSpriteFrame("i18n_klq"):e.sigInAtlas.getSpriteFrame("icon_bq"),l.children[3].setScale(1,1),l.children[3].active=!0,l.on(cc.Node.EventType.TOUCH_END,function(){e.SigInClick(d?1:2,e.config.month[1][n].day,e.signRecord[n])})}else l.children[0].getComponent(cc.Sprite).spriteFrame=e.commAtlas.getSpriteFrame("bg_fldt5"),l.children[2].active=!1,l.children[3].getComponent(cc.Sprite).spriteFrame=e.commAtlas.getSpriteFrame("icon_yilingqu"),l.children[3].setScale(.8,.8),l.children[3].active=!0;e.config.month[1][n].day==i&&e.scheduleOnce(function(){e.dayPostion=e.content.children[n].position.y+e.content.children[n].width/2,c.GameEventDispatcher.instance.emit("MovePos",e)})},o=0;o<e.siginDay;o++)n(o)},this),y.default.instance.IsRead(m.WelfareType.DailySignIn,d.default.instance.CheckIsRed())},t.prototype.SigInClick=function(e,t,i){if(1==i){var n={cmd:"dailysign",type:e,retroactiveDay:t};l.default.instance.sendProto(n)}else g.default.instance.ShowMsg(p.default.getStr("SinginTips3"))},t.prototype.closeTips=function(){this.tipsWin.active=!1},t.prototype.OpenRule=function(){u.default.instance.openWindow(h.WindowType.RulePage,function(){_.default.instance.setDataByWindowType(h.WindowType.WelfareLobby_QD)})},t.prototype.setVIPData=function(){this.vipLev.string=b.MyRoleInfo.vipLevel.toString();var e=T.default.instance.data.getVipCfg(b.MyRoleInfo.vipLevel),t=0;t=e.needExp?e.needExp:b.MyRoleInfo.vipExp,this.vipProgressBar.node.getChildByName("Label").getComponent(cc.Label).string=p.default.getStr("{0}/{1}",b.MyRoleInfo.vipExp,t),this.vipProgressBar.progress=b.MyRoleInfo.vipExp/t>=1?1:b.MyRoleInfo.vipExp/t,this.signRecord=d.default.instance.signInArray;var i=new Date(o.default.instance.ServerTimeMins).getDate(),n=2==this.signRecord[i-1];this.vipText.string=n?p.default.getStr("SinginTips6"):p.default.getStr("SinginTips5"),this.vipEXP.string=d.default.instance.getVipExp(n).toString()},t.prototype.openVipUPTips=function(){T.default.instance.openVipUPtips()},__decorate([D(cc.Node)],t.prototype,"content",void 0),__decorate([D(cc.Node)],t.prototype,"boxContent",void 0),__decorate([D(cc.Label)],t.prototype,"lastTimes",void 0),__decorate([D(cc.Label)],t.prototype,"allTimes",void 0),__decorate([D(cc.SpriteAtlas)],t.prototype,"commAtlas",void 0),__decorate([D(cc.SpriteAtlas)],t.prototype,"sigInAtlas",void 0),__decorate([D(cc.Label)],t.prototype,"startLabe",void 0),__decorate([D(cc.Label)],t.prototype,"endLabe",void 0),__decorate([D(cc.Node)],t.prototype,"tipsWin",void 0),__decorate([D(cc.ScrollView)],t.prototype,"sctollView",void 0),__decorate([D(cc.Label)],t.prototype,"vipLev",void 0),__decorate([D(cc.ProgressBar)],t.prototype,"vipProgressBar",void 0),__decorate([D(cc.Label)],t.prototype,"vipEXP",void 0),__decorate([D(cc.Label)],t.prototype,"vipText",void 0),t=__decorate([w],t)}(n.default);i.default=R,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../NetConnect/NetConnet":"NetConnet","../../Util/Utils":"Utils","../Commons/RulePage":"RulePage","../Item/ItemData":"ItemData","../Item/ItemIcon":"ItemIcon","../OpenWin/OpenWinController":"OpenWinController","../Role/RoleInfo":"RoleInfo","../Tips/OpTipsController":"OpTipsController","../Vip/VipCtrl":"VipCtrl","../welfarelobby/welfarelobby":"welfarelobby","./DailySignInController":"DailySignInController"}],Dailycontroller:[function(e,t,i){"use strict";cc._RF.push(t,"2197bO6kQZFzoexW7GA7zAJ","Dailycontroller"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../Core/GameEventDispatcher"),a=e("../Functionicon/FunctionIconController"),r=e("./DailyData"),s=e("../../Core/WindowType"),l=e("../Scene/UIAnim/VariousAnim"),c=e("../Chapter/ChapterController"),d=cc._decorator,p=d.ccclass,h=(d.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dailyArry=[],t.boxArry=[],t.fetterBoxArray=[],t.vitalityNum=null,t.vitalityBox=null,t.dailyList=null,t.skipBool=!1,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.dailyData=new r.default},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.listNotification=function(){this.addProto("daily",this.daliyList,this),i.instance=this},t.prototype.daliyList=function(e){this.dailyArry=e.data.tasks,this.boxArry=e.data.rewardflag,this.vitalityNum=e.data.vitality,this.fetterBoxArray=e.data.teamrewardflag,o.GameEventDispatcher.instance.emit("PROGRESSBAR",{isProto:!0}),a.default.instance.checkIsOpenbyWindowtype(s.WindowType.DailyQusest)&&(l.default.instance.flag=!0),a.default.instance.FuncIconRedDeal(s.WindowType.DailyQusest,!1);for(var t=0;t<this.dailyArry.length;t++){var i=this.dailyArry[t];this.dailyData.initid(t+1);var n=c.default.instance.currentChapterId+1>this.dailyData.chapter||a.default.instance.checkIsPass(this.dailyData.chapter-1,this.dailyData.checkpoint-1);if(i&&!i[0].flag&&i[0].count>=this.dailyData.time&&n)return void a.default.instance.FuncIconRedDeal(s.WindowType.DailyQusest,!0);a.default.instance.FuncIconRedDeal(s.WindowType.DailyQusest,!1)}this.dailyVitalityBox()},t.prototype.getArr=function(){return this.dailyArry},t.prototype.dailyVitalityBox=function(){for(var e in this.vitalityBox=this.dailyData.configVitality,this.vitalityBox){var t=Number(e);this.dailyData.initid(t);var i=this.vitalityBox[e];if(this.vitalityNum>=i.number&&!this.boxArry[Number(e)-1])return void a.default.instance.FuncIconRedDeal(s.WindowType.DailyQusest,!0)}},t.prototype.taskList=function(){for(var e in this.dailyList){var t=Number(e);if(this.dailyData.initid(t),c.default.instance.currentChapterId+1>this.dailyData.chapter||c.default.instance.currentChapterId+1==this.dailyData.chapter&&c.default.instance.currentGuanqiaId>=this.dailyData.checkpoint)return!0;if(c.default.instance.currentChapterId+1<this.dailyData.chapter||c.default.instance.currentChapterId+1!=this.dailyData.chapter&&c.default.instance.currentGuanqiaId<=this.dailyData.checkpoint)return!1}},t.instance=null,t=i=__decorate([p],t)}(n.default));i.default=h,cc._RF.pop()},{"../../Core/Controller":"Controller","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/WindowType":"WindowType","../Chapter/ChapterController":"ChapterController","../Functionicon/FunctionIconController":"FunctionIconController","../Scene/UIAnim/VariousAnim":"VariousAnim","./DailyData":"DailyData"}],Daily:[function(e,t,i){"use strict";cc._RF.push(t,"dfcbar/96VBO4BsHV3HLMQK","Daily"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("./DailyItem"),a=e("./DailyData"),r=e("./Dailycontroller"),s=e("../../Core/GameEventDispatcher"),l=e("../../Core/WindowManager"),c=e("../Chapter/ChapterController"),d=e("../Commons/RewardUtils"),p=e("../Item/ItemData"),h=e("../Item/ItemIcon"),u=e("../../Core/CommonsResManager"),f=e("../../Util/GrayEffect"),g=e("../../Core/LoadManager"),y=e("../../Util/Utils"),m=e("../../GlobalContext"),C=e("../Functionicon/FunctionIconController"),v=e("../OpenWin/OpenWinController"),_=e("../../Core/WindowType"),b=e("../Tips/RewardTips"),T=e("../../Core/TimeController"),S=cc._decorator,I=S.ccclass,w=S.property,D=function(e){function t(){var t=e.call(this)||this;return t.dutyItem=null,t.content=null,t.progressBar=null,t.atlas=null,t.box=null,t.node_=null,t.reward=null,t.awardSpriteAtlas=null,t.vitalityLabe=null,t.maskBG=null,t.list=null,t.vitality=null,t.taskProgress=null,t.itemArray=null,t.dailyArray=null,t.boxArray=null,t.daily=null,t.boxList=null,t.dailyArr=[],i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.show=function(){var t=this;e.prototype.show.call(this),this.dailyData=new a.default,this.dailyArray=this.dailyData.config,this.itemArray=[],this.boxArray=[],this.daily=r.default.instance.dailyArry,this.boxList=r.default.instance.boxArry,g.default.instance.loadResByType("prefab/Daily/DailyItem",cc.Prefab,function(e){t.dutyItem=e;var i=function(e){var i=Number(e);if(t.dailyData.initid(i),c.default.instance.currentChapterId+1>t.dailyData.chapter||C.default.instance.checkIsPass(t.dailyData.chapter-1,t.dailyData.checkpoint-1)){var n=y.default.getNodeByUrl(t.dutyItem,"prefab/Daily/DailyItem");t.setIcon(t.dailyData.icon),n.getChildByName("type").getComponent(cc.Sprite).spriteFrame=u.default.instance.getSpriteFrameByName("taskicon_"+t.dailyData.clientType),n.getComponent("DailyItem").setID(i),n.getComponent("DailyItem").setVitality(t.dailyData.vitality),n.getComponent("DailyItem").setTime(t.dailyData.time),n.getComponent("DailyItem").setTimeArray(t.dailyData.goals),t.itemArray.push(n),t.dailyArr.push(n);var a=t.daily[parseInt(e)-1];if(null!=a)for(var r=0;r<a.length;r++){if(n.getComponent("DailyItem").setNum(a[r].count),a[r].count<=t.dailyData.goals[r]&&0==a[r].flag){n.getComponent("DailyItem").setGetInfo(a[r].flag),n.getComponent("DailyItem").setFlag(a[r].flag),n.getComponent("DailyItem").ind=r;break}a[a.length-1].count>=t.dailyData.goals[r]&&1==a[a.length-1].flag&&(n.getComponent("DailyItem").setGetInfo(a[r].flag),n.getComponent("DailyItem").setFlag(a[r].flag),n.getComponent("DailyItem").ind=r)}else n.getComponent("DailyItem").setNum(0);t.setDailtInfo(n,t.dailyData.taskDetails,t.dailyData.vitality,t.dailyData.type,n.getComponent("DailyItem").num+" / "+t.dailyData.time),n.getComponent("DailyItem").num>=n.getComponent("DailyItem").time&&(n.getComponent(o.default).isFinish=!0);var s=t.dailyData.reward;g.default.instance.loadResByType("prefab/Bag/ItemIcon",cc.Prefab,function(e){t.reward=e;for(var i=d.default.instance.getItemList(s),a=0;a<i.length;a++){var r=y.default.getNodeByUrl(t.reward,"prefab/Bag/ItemIcon");r.setScale(.7),n.getComponent(o.default).content.addChild(r);var l=p.default.creatItem(i[a].id,i[a].count);r.getComponent(h.default).ItemData(l,!0,null,!0)}},t)}};for(var n in t.dailyArray)i(n);var a=[];for(n=0;n<t.dailyArr.length;n++)t.dailyArr[n]&&t.dailyArr[n].getComponent("DailyItem").getIsFinish()&&!t.dailyArr[n].getComponent("DailyItem").getGetInfo()&&(a.push(t.dailyArr[n]),t.dailyArr.splice(n,1),n--);for(n=0;n<t.dailyArr.length;n++)!t.dailyArr[n]||t.dailyArr[n].getComponent("DailyItem").getIsFinish()||t.dailyArr[n].getComponent("DailyItem").getGetInfo()||(a.push(t.dailyArr[n]),t.dailyArr.splice(n,1),n--);for(n=0;n<t.dailyArr.length;n++)a.push(t.dailyArr[n]);for(var n in t.dailyArr=[],a)t.content.addChild(a[n])},this),g.default.instance.loadResByType(m.GlobalContext.Root+"prefab/Daily/Box",cc.Prefab,function(e){for(var i in t.box=e,t.dailyData.configVitality){var n=Number(i);t.dailyData.initid(n);var o=t.dailyData.vitalityBox,a=y.default.getNodeByUrl(t.box,m.GlobalContext.Root+"prefab/Daily/Box");for(var r in a.getComponent("VitalityBox").setID(n),a.getComponent("VitalityBox").setBoxVitality(o),a.getComponent("VitalityBox").setReward(t.dailyData.boxReward),a.getComponent("VitalityBox").setRewardNum(t.dailyData.boxRewardNum),a.getChildByName("box").getComponent(cc.Sprite).spriteFrame=t.awardSpriteAtlas.getSpriteFrame("icon_baoxiang"+Number(i)),a.setScale(.15,1),t.boxList){var s=t.boxList[r];Number(r)+1==a.getComponent("VitalityBox").boxID&&(a.getComponent("VitalityBox").isGet=s)}1==a.getComponent("VitalityBox").getIsType()&&a.addComponent(f.default).setGray(!0,!0),t.node_.addChild(a),a.x=o/t.dailyData.vitality_*100,t.boxArray.push(a)}t.setProgressBar()},this),this.vitalityLabe.string=""+r.default.instance.vitalityNum,this.progressBar.progress=r.default.instance.vitalityNum/this.dailyData.vitality_,s.GameEventDispatcher.instance.on("CLOSEWINDOW",this.closeWindow,this),s.GameEventDispatcher.instance.on("PROGRESSBAR",this.setProgressBar,this),s.GameEventDispatcher.instance.on("ACTIVEMASK",this.setBG,this),s.GameEventDispatcher.instance.on("REWARD",this.getReward,this),this.list.scrollToTop(.2)},t.prototype.hide=function(){e.prototype.hide.call(this),this.itemArray=[],this.boxList=[],y.default.setNodeChildDestoryByUrl(this.content,m.GlobalContext.Root+"prefab/Daily/DailyItem"),y.default.setNodeChildDestoryByUrl(this.node_,m.GlobalContext.Root+"prefab/Daily/Box"),s.GameEventDispatcher.instance.off("CLOSEWINDOW",this.closeWindow,this),s.GameEventDispatcher.instance.off("PROGRESSBAR",this.setProgressBar,this),s.GameEventDispatcher.instance.off("ACTIVEMASK",this.setBG,this),s.GameEventDispatcher.instance.off("REWARD",this.getReward,this)},t.prototype.setProgressBar=function(){var e=r.default.instance.vitalityNum/this.dailyData.vitality_;for(var t in this.boxArray)Number(e)>=this.boxArray[t].getComponent("VitalityBox").boxVitality/this.dailyData.vitality_&&!this.boxArray[t].getComponent("VitalityBox").isGet&&(this.boxArray[t].getComponent("VitalityBox").setHighLight(!0),this.boxArray[t].getComponent("VitalityBox").isNum=1)},t.prototype.setDailtInfo=function(e,t,i,n,o){var a=e.getComponent("DailyItem");a.itemTitle.string=t,a.vitality=i,a.type=n,a.taskProgress.string=o},t.prototype.setBG=function(){this.maskBG.active=!0},t.prototype.clickMaksBG=function(){s.GameEventDispatcher.instance.emit("DESTROY",this),this.maskBG.active=!1},t.prototype.setIcon=function(e){o.default.instance.dailyIcon.spriteFrame=this.atlas.getSpriteFrame("icon_"+e)},t.prototype.closeWindow=function(){l.default.instance.closeWindow(this.node)},t.prototype.getReward=function(e){var t=this,i=e.getUserData().data;v.default.instance.openWindow(_.WindowType.RewardTips,function(){b.default.instance.setData(d.default.instance.getItemListByServerData(i))},this);var n=T.default.instance.setTimeout(function(){t.hide(),t.show(),T.default.instance.clearTimeout(n)},this,100)},t.instance=null,__decorate([w(cc.Node)],t.prototype,"content",void 0),__decorate([w(cc.ProgressBar)],t.prototype,"progressBar",void 0),__decorate([w(cc.SpriteAtlas)],t.prototype,"atlas",void 0),__decorate([w(cc.Node)],t.prototype,"node_",void 0),__decorate([w(cc.SpriteAtlas)],t.prototype,"awardSpriteAtlas",void 0),__decorate([w(cc.Label)],t.prototype,"vitalityLabe",void 0),__decorate([w(cc.Node)],t.prototype,"maskBG",void 0),__decorate([w(cc.ScrollView)],t.prototype,"list",void 0),t=i=__decorate([I],t)}(n.default);i.default=D,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/Window":"Window","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/GrayEffect":"GrayEffect","../../Util/Utils":"Utils","../Chapter/ChapterController":"ChapterController","../Commons/RewardUtils":"RewardUtils","../Functionicon/FunctionIconController":"FunctionIconController","../Item/ItemData":"ItemData","../Item/ItemIcon":"ItemIcon","../OpenWin/OpenWinController":"OpenWinController","../Tips/RewardTips":"RewardTips","./DailyData":"DailyData","./DailyItem":"DailyItem","./Dailycontroller":"Dailycontroller"}],DamageInfo:[function(e,t,i){"use strict";cc._RF.push(t,"241e4OhWRFAgoUOA+KpMkFE","DamageInfo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){return function(){this.attack=0,this.injuried=0,this.rescure=0,this.grade=0,this.type=-1,this.actorname=null}}();i.DamageInfo=n,function(e){e[e.Attack=0]="Attack",e[e.Injuried=1]="Injuried",e[e.Rescure=2]="Rescure"}(i.DamageInfoType||(i.DamageInfoType={})),cc._RF.pop()},{}],DateUtil:[function(e,t,i){"use strict";cc._RF.push(t,"373d1SU+5FAiLwinuCHCwQ5","DateUtil"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(){}return e.secondsToChinese=function(e){if(e>3600){var t=e%60,i=parseInt(e/60+"")%60;return parseInt(e/3600+"")+"\u5c0f\u65f6"+(i>0?i+"\u5206":"")+(t>0?t+"\u79d2":"")}if(e>60){t=e%60;return(i=parseInt(e/60+"")%60)+"\u5206"+(t>0?t+"\u79d2":"")}return e+"\u79d2"},e.secondsToChineseDate=function(e){if(e>3600){var t=e%60,i=parseInt(e/60+"")%60;return parseInt(e/3600+"")+":"+(i<10?"0"+i:i)+":"+(t<10?"0"+t:t)}if(e>60){t=e%60;return+(i=parseInt(e/60+"")%60)+":"+(t<10?"0"+t:t)}return e+"\u79d2"},e.secondsToDate=function(e){if(e>=3600){var t=e%60,i=parseInt(e/60+"")%60,n=parseInt(e/3600+"");return(n<10?"0"+n:n)+":"+(i<10?"0"+i:i)+":"+(t<10?"0"+t:t)}if(e>0){t=e%60;return((i=parseInt(e/60+"")%60)<10?"0"+i:i)+":"+(t<10?"0"+t:t)}},e.timeSecondsToChineseHour=function(e){var t=Math.floor(e/36e5),i=e%36e5,n=Math.floor(i/6e4),o=i%6e4,a=Math.floor(o/1e3);return(t<10?"0":"")+t+":"+((n<10?"0":"")+n)+":"+((a<10?"0":"")+a)},e.timeSecondsToChineseDate=function(e){var t=new Date(e);return t.getFullYear()+"/"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"/"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours()+":":t.getHours()+":")+(t.getMinutes()<10?"0"+t.getMinutes()+":":t.getMinutes()+":")+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds()+"")},e.timeSecondsToChineseDate1=function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()},e.timeSecondsToChineseDate2=function(e){var t=new Date(e),i=t.getFullYear()+"/"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"/"+(t.getDate()<10?"0"+t.getDate():t.getDate());t.getHours(),t.getHours(),t.getMinutes(),t.getMinutes(),t.getSeconds(),t.getSeconds();return i},e.secondsToMonthDay=function(e,t){void 0===t&&(t=0);var i,n=new Date(e);switch(t){case 0:i=n.getMonth()+1+"\u6708"+n.getDate()+"\u65e5";break;case 1:i=n.getFullYear()+"\u5e74"+(n.getMonth()+1)+"\u6708"+n.getDate()+"\u65e5"}return i},e.setTimeToChinese=function(e,t){var i;switch(t){case 1:if(e>3600){var n=parseInt(e/60+"")%60;i=parseInt(e/3600+"")+"\u65f6"+(n>0?n+"\u5206":"")}else if(e>60){i=(n=parseInt(e/60+"")%60)+"\u5206"}}return i},e.setTimeToChineseHM=function(e,t){var i;switch(t){case 1:if(e>86400){var n=parseInt(e/60+"")%60;i=parseInt(e/86400+"")+"\u5929"+((o=parseInt(e/3600+"")%24)>0?o+"\u65f6":n>0?n+"\u5206":"")}else if(e>3600){var o;n=parseInt(e/60+"")%60;i=(o=parseInt(e/3600+""))+"\u65f6"+(n>0?n+"\u5206":"")}else if(e>60){n=parseInt(e/60+"")%60;var a=e%60;i=a>0?n+"\u5206"+a+"\u79d2":n+"\u5206"}else e>0&&(i=e+"\u79d2")}return i},e.timeToSec=function(e){var t=parseInt(e.split(":")[0]),i=parseInt(e.split(":")[1]),n=parseInt(e.split(":")[2]),o=n||0;return 1e3*(Number(3600*t)+Number(60*i)+o)},e.getYMDHMS=function(e){var t=new Date(e),i=t.getHours()+"",n=t.getMinutes()+"",o=t.getSeconds()+"";return parseInt(i)<10&&(i="0"+i),parseInt(n)<10&&(n="0"+n),parseInt(o)<10&&(o="0"+o),i+":"+n+":"+o},e.getYMDHM=function(e){var t=new Date(e),i=t.getHours()+"",n=t.getMinutes()+"";t.getSeconds();return parseInt(i)<10&&(i="0"+i),parseInt(n)<10&&(n="0"+n),i+":"+n},e.setTimeToChineseHMStr=function(e,t){var i;switch(t){case 1:if(e>=3600){var n=parseInt(e/60+"")%60;i=parseInt(e/3600+"")+"\u5c0f\u65f6"+(n>0?n+"\u5206\u949f":"")}else if(e>=60){n=parseInt(e/60+"")%60;var o=e%60;i=o>0?n+"\u5206\u949f"+o+"\u79d2":n+"\u5206\u949f"}else e>0&&(i=e+"\u79d2")}return i},e.setTimeToChineseHMStrTwo=function(e){var t="",i=parseInt(""+e/1e3/60/60/24),n=parseInt(""+e/1e3/60/60%24),o=parseInt(""+e/1e3/60%60),a=parseInt(""+e/1e3%60);return t+=i&&i>0?i+"\u5929":"",t+=n&&n>0?n+"\u65f6":"",t+=o&&o>0?o+"\u5206":"",t+=a&&a>0?a+"\u79d2":"0\u79d2"},e.setTimeToChineseStr=function(e,t){var i="";switch(t){case 1:if(e>864e5){var n=parseInt(""+e/1e3/60/60/24),o=parseInt(""+e/1e3/60/60%24);i+=n&&n>0?n+"\u5929":"",i+=o&&o>0?o+"\u65f6":""}else i=this.timeSecondsToChineseHour(e)}return i},e}();i.DateUtil=n,cc._RF.pop()},{}],DecomposeAndSyntheticView:[function(e,t,i){"use strict";cc._RF.push(t,"489cfkbVQlJy6IYMf/+9P4T","DecomposeAndSyntheticView"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../../Core/WindowType"),a=e("../../GlobalContext"),r=e("./IconBtn"),s=e("../Functionicon/FunctionIconController"),l=e("../../Util/Utils"),c=e("../Role/RoleController"),d=e("../../Global/GlobalValue"),p=e("../../Core/GameEventDispatcher"),h=e("../../Core/Event"),u=e("../../Util/NumberUtil"),f=e("../../Core/LoadManager"),g=cc._decorator,y=g.ccclass,m=g.property,C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tagScrollView=null,t.tagBtnNode=null,t._viewType=[o.WindowType.Decompose,o.WindowType.Synthesis],t._tagIndex=null,t._prefabName=["Decompose","Synthetic"],t._viewNodeMap={},t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),this.node.getChildByName("node").width=a.GlobalContext.StageWidth,this.node.getChildByName("node").height=a.GlobalContext.StageHeight,this.tagList(),this.setMonetary(),p.GameEventDispatcher.instance.on(h.EventDefiner.PlayerMoneyChange,this.setMonetary,this),p.GameEventDispatcher.instance.on("BagPackInfoChange",this.setMonetary,this)},t.prototype.hide=function(){e.prototype.hide.call(this),this._tagIndex=null,p.GameEventDispatcher.instance.off(h.EventDefiner.PlayerMoneyChange,this.setMonetary,this),p.GameEventDispatcher.instance.off("BagPackInfoChange",this.setMonetary,this)},t.prototype.tagList=function(){var e=this.tagScrollView.content;for(var t in e.children)e.children[t].active=!1;for(var t in this._viewType){if(!e.children[t]){var i=cc.instantiate(this.tagBtnNode),n=s.default.instance.checkIsOpenbyWindowtype(this._viewType[t]);i.getComponent(r.default).setData(parseInt(t),n,this.onClickTag,this),i.name="IconBtn"+t,e.addChild(i)}e.children[t].active=!0}this.setTagIndex(0)},t.prototype.onClickTag=function(e){this._tagIndex=e,this.viewList()},t.prototype.viewList=function(){var e=this;if(this._viewNodeMap[this._tagIndex])this.setViewNodeShow();else{var t=a.GlobalContext.Root+"prefab/Decompose/"+this._prefabName[this._tagIndex];f.default.instance.loadResByType(t,cc.Prefab,function(i){if(!e._viewNodeMap[e._tagIndex]){var n=l.default.getNodeByUrl(i,t);e.node.getChildByName("node").getChildByName("centerNode").addChild(n),e._viewNodeMap[e._tagIndex]=n,e.setViewNodeShow()}},this)}},t.prototype.setViewNodeShow=function(){for(var e in this._viewNodeMap)this._viewNodeMap[e].active=parseInt(e)==this._tagIndex},t.prototype.setMonetary=function(){var e=this.node.getChildByName("node").getChildByName("monetaryNode");e.children[0].getChildByName("value").getComponent(cc.Label).string=u.NumberUtil.getNumber(c.default.instance.GetMyWealth(d.WealthType.Money)),e.children[1].getChildByName("value").getComponent(cc.Label).string=c.default.instance.GetMyWealth(d.WealthType.SoulCard).toString()},t.prototype.setTagIndex=function(e){var t=this.tagScrollView.content;for(var i in t.children)t.children[i].getComponent(r.default).setSelectedFlag(parseInt(i)==e);this.onClickTag(e)},__decorate([m(cc.ScrollView)],t.prototype,"tagScrollView",void 0),__decorate([m(cc.Node)],t.prototype,"tagBtnNode",void 0),t=__decorate([y],t)}(n.default);i.default=C,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/LoadManager":"LoadManager","../../Core/Window":"Window","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/NumberUtil":"NumberUtil","../../Util/Utils":"Utils","../Functionicon/FunctionIconController":"FunctionIconController","../Role/RoleController":"RoleController","./IconBtn":"IconBtn"}],DecomposeCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"6ab8c6xxtNLCJHSTwVxBRXb","DecomposeCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Controller"),o=e("./DecomposeData"),a=e("../../../NetConnect/NetConnet"),r=e("../../../Core/Event"),s=e("../../../Core/GameEventDispatcher"),l=e("../../Tips/RewardTips"),c=e("../../OpenWin/OpenWinController"),d=e("../../../Core/WindowType"),p=e("../../Commons/RewardUtils"),h=cc._decorator,u=h.ccclass,f=(h.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._data=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.listNotification=function(){this.addProto(r.EventDefiner.Decompose_ItemDecompose,this.resItemDecompose,this)},Object.defineProperty(t.prototype,"data",{get:function(){return this._data||(this._data=new o.default),this._data},enumerable:!0,configurable:!0}),t.prototype.reqItemDecompose=function(e,t){var i={cmd:"itemdecompose",type:e,material:t};a.default.instance.sendProto(i)},t.prototype.resItemDecompose=function(e){s.GameEventDispatcher.instance.emit(r.EventDefiner.Decompose_UP_SHow,{data:e.ret});var t=p.default.instance.getItemListByServerData(e.ret);c.default.instance.openWindow(d.WindowType.RewardTips,function(){l.default.instance.setData(t)},this)},t.instance=null,t=i=__decorate([u],t)}(n.default));i.default=f,cc._RF.pop()},{"../../../Core/Controller":"Controller","../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/WindowType":"WindowType","../../../NetConnect/NetConnet":"NetConnet","../../Commons/RewardUtils":"RewardUtils","../../OpenWin/OpenWinController":"OpenWinController","../../Tips/RewardTips":"RewardTips","./DecomposeData":"DecomposeData"}],DecomposeData:[function(e,t,i){"use strict";cc._RF.push(t,"770c27L4mVGr7nI4iG4oiTG","DecomposeData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Item/ItemData"),o=e("../../../Global/GlobalValue"),a=e("../../Item/ItemModel"),r=e("../../Item/ItemType"),s=e("../../Ornament/OrnamentCtrl"),l=e("../../Commons/RewardUtils"),c=e("../../Equip/equip/EquipCtrl"),d=e("../../Functionicon/FunctionIconController"),p=e("../../../Core/WindowType"),h=e("../../WarTeam/MonsterController"),u=e("../../../Core/ConfigsManager"),f=function(){function e(){this._materialList=[],this._itemList=[],this._cfg=null,this._tagIndex=null}return Object.defineProperty(e.prototype,"cfg",{get:function(){return this._cfg||(this._cfg=u.ConfigsManager.instance.getConfigs("decompose")),this._cfg},enumerable:!0,configurable:!0}),e.prototype.setMaterialList=function(e,t){switch(void 0===t&&(t=0),this._tagIndex=e,e){case o.DecomposeTag.CardChip:this._itemList=this.getCardChipList(t);break;case o.DecomposeTag.Equip:this._itemList=this.getEquipList(t);break;case o.DecomposeTag.Ornament:this._itemList=this.getOrnamentList(t)}this._itemList=this.itemListsrot(this._itemList)},Object.defineProperty(e.prototype,"itemList",{get:function(){return this._itemList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"materialList",{get:function(){return this._materialList},enumerable:!0,configurable:!0}),e.prototype.resetData=function(){this._materialList=[],this._itemList=[],this._tagIndex=null},e.prototype.getRewardList=function(e){var t=[],i=this.conversio(e);switch(e){case o.DecomposeTag.CardChip:t=this.getCardChipReward(i);break;case o.DecomposeTag.Equip:t=this.getEquipReward(i);break;case o.DecomposeTag.Ornament:t=this.getOrnamentReward(i)}return t},e.prototype.autoAddMaterial=function(){if(!(this._materialList.length>=6||this._itemList.length<=0)){var e=this._materialList.length>0?6-this._materialList.length:6,t=[];switch(this._tagIndex){case o.DecomposeTag.CardChip:t=this.getCardChipMaterialData(e);break;case o.DecomposeTag.Equip:t=this.getEquipMaterialData(e);break;default:t=this.getMaterialData(e)}this.addMaterial(t),this.reduceItem(t)}},e.prototype.getMaterialData=function(e){for(var t=[],i=0;i<e;++i)this._itemList[i]&&t.push({itemId:this._itemList[i].id,guid:this._itemList[i].guid,num:this._itemList[i].count,level:this._itemList[i].level});return t},e.prototype.getCardChipMaterialData=function(e){var t=[],i={};for(var n in this._itemList){var o=h.default.instance.data.getCardIdByItemId(this._itemList[n].id),a=h.default.instance.getIsMonsterCard(o.id),r=h.default.instance.getIsLineup(o.id);if(a&&!r){var s=this._itemList[n].colorIndex;i[s]||(i[s]=new Array),i[s].push(this._itemList[n])}}for(var l=[],c=0;c<e;++c){a=!1;for(var n in i)for(;i[n].length>0;){if(l.length==e){a=!0;break}l.push(i[n].shift())}if(a)break}for(var n in l=this.itemListsrot(l))t.push({itemId:l[n].id,guid:l[n].guid,num:l[n].count,level:l[n].level});return t},e.prototype.getEquipMaterialData=function(e){var t=[],i=[];for(var n in this._itemList){var o=!1,a=c.default.instance.data.getEquipInfoById(this._itemList[n].id);for(var r in h.MonsterType.MonsterWarTeam[h.MonsterType.MonsterBattle]){var s=h.MonsterType.MonsterWarTeam[h.MonsterType.MonsterBattle][r],l=h.default.instance.getCardConfCardType(s),d=h.default.instance.GetMonsterData(s);if(a&&a.range[0]==l){var p=c.default.instance.data.getItemByGuid(d.equip[a.buwei]);if(!d.equip[a.buwei]||p&&p.colorIndex<=this._itemList[n].colorIndex){o=!0;break}}}o||i.push(this._itemList[n])}i=this.itemListsrot(i);for(var u=0;u<e;++u)i[u]&&t.push({itemId:i[u].id,guid:i[u].guid,num:i[u].count,level:i[u].level});return t},e.prototype.addItem=function(e){for(var t in e){var i=!1;for(var o in this._itemList)if(this._itemList[o]&&this._itemList[o].guid==e[t].guid){this._itemList[o].count+=e[t].num,i=!0;break}if(!i){var a=n.default.creatItem(e[t].itemId,e[t].num);a.level=e[t].level,a.guid=e[t].guid,this._itemList.push(a)}}this._itemList=this.itemListsrot(this._itemList)},e.prototype.reduceItem=function(e){for(var t in e)for(var i in this._itemList)if(this._itemList[i]&&this._itemList[i].guid==e[t].guid){this._itemList[i].count-=e[t].num,this._itemList[i].count<=0&&this._itemList.splice(parseInt(i),1);break}this._itemList=this.itemListsrot(this._itemList)},e.prototype.addMaterial=function(e){for(var t in e)e[t]&&this._materialList.push(e[t])},e.prototype.reduceMaterial=function(e){for(var t in e)for(var i in this._materialList)if(this._materialList[i]&&this._materialList[i].guid==e[t].guid&&this._materialList[i].num==e[t].num){this._materialList.splice(parseInt(i),1);break}},e.prototype.getEquipList=function(e){var t=[],i=a.default.instance.getBagTypeListbyType(r.ItemType.equipment);for(var n in i)if(i[n]&&!(i[n].ower>0)){if(e)if(c.default.instance.data.getEquipInfoById(i[n].id).range[0]!=e)continue;t.push(i[n])}return t},e.prototype.getOrnamentList=function(e){var t=[],i=s.default.instance.data.getAllOrnamentItem();for(var n in i){if(e){var o=e-1;if(s.default.instance.data.getOrnamentType(i[n].id)!=o)continue}t.push(i[n])}return t},e.prototype.getCardChipList=function(e){var t=[],i=a.default.instance.getBagTypeListbyType(r.ItemType.card);for(var n in i){if(e)if(h.default.instance.data.getCardIdByItemId(i[n].id).cardType!=e)continue;t.push(i[n])}return t},e.prototype.getLabelCfg=function(e){return this.cfg.label[1][e]},e.prototype.getRefineIndex=function(e){return this.cfg.item[e].refine},e.prototype.getRefineCfg=function(e,t){return this.cfg.refine[e][t]},e.prototype.getbackItemCfg=function(e){return this.cfg.backItem[e]},e.prototype.getRetItemCfg=function(e){return this.cfg.retItem[e]},e.prototype.getDebrisCfg=function(e,t){var i=this.cfg.debris[e];for(var n in i)if(i[n]&&i[n].color==t)return i[n]},e.prototype.getCardChipReward=function(e){var t=[],i=this.getLabelCfg(e);if(i&&i.debris){var o={},a=i.percent?i.percent:100;for(var r in this._materialList){var s=n.default.creatItem(this._materialList[r].itemId,this._materialList[r].num),l=this.getDebrisCfg(i.debris,s.colorIndex);this.getItemdChip(o,l.backItem,s.count)}for(var r in o)t.push(n.default.creatItem(parseInt(r),Math.floor(o[r]*a/100)))}return t},e.prototype.getEquipReward=function(e){var t=[],i=this.getLabelCfg(e);if(i&&i.debris&&i.retItem){var o={},a=i.percent?i.percent:100;for(var r in this._materialList){var s=c.default.instance.data.getItemByGuid(this._materialList[r].guid);if(d.default.instance.checkIsOpenbyWindowtype(p.WindowType.Refine)&&s.refineLevel>0){var l=this.getRefineIndex(s.id),h=this.getRefineCfg(l,s.refineLevel<0?0:s.refineLevel-1);this.getItemdChip(o,h.backItem,1)}if(d.default.instance.checkIsOpenbyWindowtype(p.WindowType.Strengthen)&&s.level>0){var u=s.exp;u+=this.getUPlevelExp(s.id,s.level+1);var f=this.getRetItemCfg(i.retItem);for(var g in f)if(this.setItemMap(o,f[g].itemId,Math.floor(u/f[g].exp)),(u%=f[g].exp)<f[g].exp&&u>0&&(this.setItemMap(o,f[g].itemId,1),u=0),u<=0)break}if(d.default.instance.checkIsOpenbyWindowtype(p.WindowType.UpgradeStage)&&s.stage>0)for(var y=c.default.instance.data.getEquipInfoById(s.id),m=c.default.instance.data.getEquipCfg(),C=0;C<s.stage;++C){var v=m.stage[y.stage][C],_=m.needItem[v.needItem];for(var b in _)if(this.setItemMap(o,_[b].itemId,_[b].count),_[b].equipFlag&&_[b].num>0){var T=n.default.creatItem(this._materialList[b].itemId,this._materialList[b].num),S=this.getDebrisCfg(i.debris,T.colorIndex);this.getItemdChip(o,S.backItem,_[b].num)}}var I=this.getDebrisCfg(i.debris,s.colorIndex);this.getItemdChip(o,I.backItem,1)}for(var r in o)t.push(n.default.creatItem(parseInt(r),Math.max(1,Math.floor(o[r]*a/100))))}return t},e.prototype.getOrnamentReward=function(e){var t=[],i=this.getLabelCfg(e);if(i&&i.debris){var o={},a=i.percent?i.percent:100,r=0;for(var l in this._materialList){var c=s.default.instance.data.getOrnamentGuid(this._materialList[l].guid);if(c.level>1){var d=c.intensifyexp;r+=d+=this.getUPlevelExp(c.id,c.level);var p=this.getRetItemCfg(i.retItem);for(var h in p)if(this.setItemMap(o,p[h].itemId,Math.floor(d/p[h].exp)),(d%=p[h].exp)<p[h].exp&&d>0&&(this.setItemMap(o,p[h].itemId,1),d=0),d<=0)break}if(r>0){var u=Math.floor(r/2);u>0&&this.setItemMap(o,1,u),r=0}if(c.stage>0)for(var f=0;f<c.stage;++f){var g=s.default.instance.data.getOrnamentType(c.id),y=s.default.instance.data.getAccessories(c.colorIndex),m=null;if(y.upStage){var C=s.default.instance.data.getUpStage(y.upStage,g);m=s.default.instance.data.getupStageConsume(C.upStageConsume,f)}if(m&&(this.setItemMap(o,m.stepStoneid,m.stepStoneCount),m.sameNameCount>0)){var v=n.default.creatItem(this._materialList[l].itemId,this._materialList[l].num),_=this.getDebrisCfg(i.debris,v.colorIndex);this.getItemdChip(o,_.backItem,m.sameNameCount)}}var b=this.getDebrisCfg(i.debris,c.colorIndex);this.getItemdChip(o,b.backItem,1)}for(var l in o)t.push(n.default.creatItem(parseInt(l),Math.floor(o[l]*a/100)));return t}},e.prototype.setItemMap=function(e,t,i){e[t]?e[t]+=i:e[t]=i},e.prototype.getItemdChip=function(e,t,i){var n=this.getbackItemCfg(t);if(n){var o=Math.floor(n.count*i),a=l.default.instance.getItemId(n.type,n.id,o);this.setItemMap(e,a[0],a[1])}},e.prototype.conversio=function(e){var t=0;switch(e){case 0:t=0;break;case 1:t=2;break;case 2:t=1}return t},e.prototype.itemListsrot=function(e){if(this._tagIndex==o.DecomposeTag.CardChip)e.sort(function(e,t){return e.colorIndex-t.colorIndex});else{var t=[],i=[];for(var n in e)(this._tagIndex==o.DecomposeTag.Equip?this.itemList[n].level>0:this.itemList[n].level>1)||e[n].stage>0||e[n].refineLevel>0?i.push(e[n]):t.push(e[n]);t.sort(function(e,t){return e.colorIndex-t.colorIndex}),e=t.concat(i)}return e},e.prototype.getUPlevelExp=function(e,t){var i=0,n=0;if(s.default.instance.data.ornamentFlag(e)){var o=a.default.instance.getBaseAttributebyId(e);i=(r=s.default.instance.data.getAccessories(o.ItemColor).param)[0],n=r[1]}else{var r;o=a.default.instance.getBaseAttributebyId(e);i=(r=c.default.instance.data.getEquipCfg().levelExp[o.ItemColor]).param1,n=r.param2}return Math.max(t-1,0)*i+n/2*Math.max(t-1,0)*Math.max(t-2,0)},e}();i.default=f,cc._RF.pop()},{"../../../Core/ConfigsManager":"ConfigsManager","../../../Core/WindowType":"WindowType","../../../Global/GlobalValue":"GlobalValue","../../Commons/RewardUtils":"RewardUtils","../../Equip/equip/EquipCtrl":"EquipCtrl","../../Functionicon/FunctionIconController":"FunctionIconController","../../Item/ItemData":"ItemData","../../Item/ItemModel":"ItemModel","../../Item/ItemType":"ItemType","../../Ornament/OrnamentCtrl":"OrnamentCtrl","../../WarTeam/MonsterController":"MonsterController"}],DecomposeView:[function(e,t,i){"use strict";cc._RF.push(t,"9a77a4ZJB9BFpyRjDeTCawD","DecomposeView"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Item/ItemData"),o=e("../../Commons/ListViewCtrl"),a=e("../../Item/ItemIcon"),r=e("./DecomposeCtrl"),s=e("../../../Core/WindowType"),l=e("../../../Global/GlobalValue"),c=e("../../Tips/OpTipsController"),d=e("../../OpenWin/OpenWinController"),p=e("../../Tips/BatchUsageTips"),h=e("../../../Core/GameEventDispatcher"),u=e("../../../Core/Event"),f=e("../../../Core/Language"),g=e("../../Item/ItemController"),y=e("../../Item/ItemType"),m=e("../../WarTeam/MonsterController"),C=e("../../Tips/TipsWinController"),v=e("../TagBtn"),_=e("../../../Core/Widget"),b=cc._decorator,T=b.ccclass,S=b.property,I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.TagScrollView=null,t.tagBtn=null,t.TagScrollViewTwo=null,t.tagBtnTwo=null,t._tagIndex=null,t._tagIndex2=null,t._tagName=["\u5168\u90e8","\u524d\u6392","\u4e2d\u6392","\u540e\u6392"],t._tagName2=["\u5168\u90e8","\u751f\u547d","\u653b\u51fb"],t._tagName3=["\u5361\u724c","\u88c5\u5907","\u914d\u9970"],t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.show=function(){this._tagIndex=0,this._tagIndex2=0,e.prototype.show.call(this),this.setTagList(),h.GameEventDispatcher.instance.on(u.EventDefiner.Decompose_UP_SHow,this.upSHowData,this)},t.prototype.hide=function(){e.prototype.hide.call(this),this._tagIndex=null,h.GameEventDispatcher.instance.off(u.EventDefiner.Decompose_UP_SHow,this.upSHowData,this)},t.prototype.upSHowData=function(){r.default.instance.data.resetData(),r.default.instance.data.setMaterialList(this._tagIndex,this._tagIndex2),this.upShow()},t.prototype.upShow=function(){this.setLeftSHow(),this.setRightShow()},t.prototype.setLeftSHow=function(){this.setMaterialShow(),this.setRewardShow()},t.prototype.setMaterialShow=function(){var e=this.node.getChildByName("left").getChildByName("itemList");e.destroyAllChildren();for(var t=this.node.getChildByName("left").getChildByName("item"),i=0;i<6;++i){var o=cc.instantiate(t);o.scale=.7,o.active=!0;var s=r.default.instance.data.materialList;if(s[i]){var l=n.default.creatItem(s[i].itemId,s[i].num);l.guid=s[i].guid,l.level=s[i].level,o.getChildByName("ItemIcon").getComponent(a.default).ItemData(l),o.getChildByName("ItemIcon").active=!0,o.on(cc.Node.EventType.TOUCH_END,this.onClickItem,this)}else o.getChildByName("ItemIcon").active=!1;e.addChild(o)}},t.prototype.setRewardShow=function(){var e=this.node.getChildByName("left").getChildByName("materialList");e.destroyAllChildren();for(var t=r.default.instance.data.getRewardList(this._tagIndex),i=this.node.getChildByName("left").getChildByName("item"),n=this._tagIndex==l.DecomposeTag.Equip?4:3,o=0;o<n;++o){var s;if(t[o])(s=cc.instantiate(i)).scale=.8,s.active=!0,s.getChildByName("ItemIcon").getComponent(a.default).ItemData(t[o],!0,t[o].count+"",!0),s.getChildByName("ItemIcon").active=!0,e.addChild(s);else(s=cc.instantiate(i)).scale=.8,s.active=!0,s.getChildByName("ItemIcon").active=!1,s.getChildByName("img2").active=!1,e.addChild(s)}},t.prototype.setRightShow=function(){this.setItemList(r.default.instance.data.itemList.slice())},t.prototype.setItemList=function(e){if(e.length<25)for(var t=e.length;t<25;++t)e.push(null);var i=this.node.getChildByName("right").getChildByName("ListViewCtrl");i.getComponent(o.default).refreshItem=this.updateitem,i.getComponent(o.default).refreshItemThis=this,i.getComponent(o.default).initialize(e),i.getComponent(o.default).scrollToTop()},t.prototype.updateitem=function(e,t){var i=this.node.getChildByName("right").getChildByName("ListViewCtrl").getComponent(o.default).dataLsit,n=!!i[t];e.getChildByName("img").active=!n,e.getChildByName("ItemIcon").active=n,n&&(i[t].level>0?e.getChildByName("ItemIcon").getComponent(a.default).ItemData(i[t],!0,f.default.getStr("7747",i[t].level)):e.getChildByName("ItemIcon").getComponent(a.default).ItemData(i[t]))},t.prototype.chooseGrid=function(e){var t=this,i=this.node.getChildByName("right").getChildByName("ListViewCtrl"),n=i.getComponent(o.default).dataLsit,a=e?i.getComponent(o.default).getItemIndex(e.currentTarget.x,e.currentTarget.y):0,c=r.default.instance.data.materialList;if(!(Object.keys(c).length>=6)&&n[a])if(this._tagIndex==l.DecomposeTag.CardChip){var h=m.default.instance.data.getCardIdByItemId(n[a].id),u=m.default.instance.getIsMonsterCard(h.id),g=m.default.instance.getIsLineup(h.id);if(!u||g){var y=g?f.default.getStr("decomposeText04"):f.default.getStr("decomposeText03");C.default.instance.ShowTips(y,function(){d.default.instance.openWindow(s.WindowType.BatchUsageTips,function(){p.default.instance.ShowTips1("\u6279\u91cf\u4f7f\u7528",t.UseItemBtn,t,[n[a].guid],n[a],1)})},this,null,1,null,null,null,null,null,!1,!1,!0)}else d.default.instance.openWindow(s.WindowType.BatchUsageTips,function(){p.default.instance.ShowTips1("\u6279\u91cf\u4f7f\u7528",t.UseItemBtn,t,[n[a].guid],n[a],1)})}else if(n[a]){var v=[];v.push({itemId:n[a].id,guid:n[a].guid,num:n[a].count,level:n[a].level}),r.default.instance.data.addMaterial(v),r.default.instance.data.reduceItem(v),this.upShow()}},t.prototype.onClickItem=function(e){if(e&&e.target&&e.target.getComponent(a.default)){var t=e.target.getComponent(a.default).getItemData();r.default.instance.data.reduceMaterial([{guid:t.guid,itemId:t.id,num:t.count,level:t.level}]),r.default.instance.data.addItem([{guid:t.guid,itemId:t.id,num:t.count,level:t.level}]),this.upShow()}},t.prototype.UseItemBtn=function(e,t){void 0===t&&(t=1);var i=r.default.instance.data.itemList,n=[];for(var o in i)i[o]&&i[o].guid==e&&n.push({itemId:i[o].id,guid:i[o].guid,num:t,level:i[o].level});r.default.instance.data.addMaterial(n),r.default.instance.data.reduceItem(n),this.upShow()},t.prototype.autoADD=function(){r.default.instance.data.autoAddMaterial(),r.default.instance.data.materialList.length<=0&&r.default.instance.data.itemList.length>0&&this.setTIPS(this._tagIndex),this.upShow()},t.prototype.onClickDecompose=function(){var e=r.default.instance.data.materialList;if(e.length<=0)c.default.instance.ShowMsg(f.default.getStr("decomposeText02"));else{var t={},i=0,o={};for(var a in e){var s=g.default.instance.getItemByGuid(e[a].guid),l=n.default.creatItem(s.id,1);l.type==y.ItemType.equipment&&(s.level>0||s.stage>0||s.refineLevel>0)&&(i=2,s.level>0&&(o[0]=1),s.stage>0&&(o[1]=1),s.refineLevel>0&&(o[2]=1)),l.type==y.ItemType.card&&l.colorIndex>=3&&(i=1),t[e[a].guid]?t[e[a].guid]+=e[a].num:t[e[a].guid]=e[a].num}var d=r.default.instance.data.conversio(this._tagIndex);switch(i){case 1:this.setBoxShow("decomposeText01",null,d,t);break;case 2:var p="";for(var a in o)p=this.getStr(parseInt(a),p);this.setBoxShow("decomposeText",p,d,t);break;default:r.default.instance.reqItemDecompose(d,t)}}},t.prototype.setBoxShow=function(e,t,i,n){var o=t?f.default.getStr(e,t):f.default.getStr(e);C.default.instance.ShowTips(o,function(){r.default.instance.reqItemDecompose(i,n)},this,null,1,null,null,null,null,null,!1)},t.prototype.getStr=function(e,t){switch(e){case 0:t+=""==t?f.default.getStr("Intensify"):"\u3001"+f.default.getStr("Intensify");break;case 1:t+=""==t?f.default.getStr("\u5347\u9636"):"\u3001"+f.default.getStr("\u5347\u9636");break;case 2:t+=""==t?f.default.getStr("\u7cbe\u70bc"):"\u3001"+f.default.getStr("\u7cbe\u70bc")}return t},t.prototype.setTagList=function(){var e=this.TagScrollView.content;for(var t in e.children)e.children[t].active=!1;for(var t in this._tagName3){if(!e.children[t]){var i=cc.instantiate(this.tagBtn);e.addChild(i)}e.children[t].active=!0,e.children[t].getComponent(v.default).setData(this._tagName3[t],this.onClickTag,this,!0)}for(var t in e.children)e.children[t].getComponent(v.default).setSelectedFlag(0==parseInt(t));this.onClickTag(this._tagIndex)},t.prototype.setTagListTwo=function(){var e=this._tagIndex<2?this._tagName:this._tagName2,t=this.TagScrollViewTwo.content;for(var i in t.children)t.children[i].active=!1;for(var i in e){if(!t.children[i]){var n=cc.instantiate(this.tagBtnTwo);t.addChild(n)}t.children[i].active=!0,t.children[i].getComponent(v.default).setData(e[i],this.onClickTagTwo,this)}for(var i in t.children)t.children[i].getComponent(v.default).setSelectedFlag(0==parseInt(i));this.onClickTagTwo(0)},t.prototype.onClickTag=function(e){this._tagIndex=e,this.setTagListTwo(),this.upSHowData()},t.prototype.onClickTagTwo=function(e){this._tagIndex2=e,this.upSHowData()},t.prototype.setTIPS=function(e){var t="";switch(e){case 0:t="decomposeText05";break;case 1:t="decomposeText06";break;case 2:t="decomposeText07"}""!=t&&c.default.instance.ShowMsg(f.default.getStr(t))},__decorate([S(cc.ScrollView)],t.prototype,"TagScrollView",void 0),__decorate([S(cc.Node)],t.prototype,"tagBtn",void 0),__decorate([S(cc.ScrollView)],t.prototype,"TagScrollViewTwo",void 0),__decorate([S(cc.Node)],t.prototype,"tagBtnTwo",void 0),t=__decorate([T],t)}(_.default);i.default=I,cc._RF.pop()},{"../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Core/Widget":"Widget","../../../Core/WindowType":"WindowType","../../../Global/GlobalValue":"GlobalValue","../../Commons/ListViewCtrl":"ListViewCtrl","../../Item/ItemController":"ItemController","../../Item/ItemData":"ItemData","../../Item/ItemIcon":"ItemIcon","../../Item/ItemType":"ItemType","../../OpenWin/OpenWinController":"OpenWinController","../../Tips/BatchUsageTips":"BatchUsageTips","../../Tips/OpTipsController":"OpTipsController","../../Tips/TipsWinController":"TipsWinController","../../WarTeam/MonsterController":"MonsterController","../TagBtn":"TagBtn","./DecomposeCtrl":"DecomposeCtrl"}],DevilNewsWin:[function(e,t,i){"use strict";cc._RF.push(t,"69112KXfQVCpLhmoF88pe5J","DevilNewsWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Commons/CommonPageBG"),o=e("../Gamelayer/RoleHead"),a=e("../../Core/LoadManager"),r=e("../../GlobalContext"),s=e("../../Util/Utils"),l=e("../../Core/WindowType"),c=cc._decorator,d=c.ccclass,p=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.roleHead=null,t.levelLabel=null,t.fightNumLabel=null,t.teamLayout=null,t}var i;return __extends(t,e),i=t,t.prototype.show=function(){e.prototype.show.call(this),i.instance=this,this.onInit(0,0,null,!0,0,0)},t.prototype.setInfo=function(e,t,i,n){var o=this;this.roleHead.SetHead(e),this.levelLabel.string=t+"",this.fightNumLabel.string=i+"",a.default.instance.loadResByType(r.GlobalContext.Root+"prefab/WarTeam/CardNews",cc.Prefab,function(e){var t;for(var i in s.default.setNodeChildDestoryByUrl(o.teamLayout,r.GlobalContext.Root+"prefab/WarTeam/CardNews"),n)t=s.default.getNodeByPool(l.PoolType.CardNews,e,r.GlobalContext.Root+"prefab/WarTeam/CardNews"),o.teamLayout.addChild(t),t.getComponent("CardNews").setData(n[i])},this)},t.instance=null,__decorate([p(o.default)],t.prototype,"roleHead",void 0),__decorate([p(cc.Label)],t.prototype,"levelLabel",void 0),__decorate([p(cc.Label)],t.prototype,"fightNumLabel",void 0),__decorate([p(cc.Node)],t.prototype,"teamLayout",void 0),t=i=__decorate([d],t)}(n.default);i.default=h,cc._RF.pop()},{"../../Core/LoadManager":"LoadManager","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/CommonPageBG":"CommonPageBG","../Gamelayer/RoleHead":"RoleHead"}],DevilRankItem:[function(e,t,i){"use strict";cc._RF.push(t,"03e8bq2WBhHuZ/jBoQgmMCI","DevilRankItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../OpenWin/OpenWinController"),a=e("../../Core/WindowType"),r=e("./DevilNewsWin"),s=cc._decorator,l=s.ccclass,c=(s.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.role=null,t.level=0,t.fightNum=-0,t.teamData=null,t}return __extends(t,e),t.prototype.setInfo=function(e){this.role=e.icon,this.level=e.level,this.fightNum=e.fight,this.teamData=e.highestBattle},t.prototype.cheackBtn=function(){var e=this;o.default.instance.openWindow(a.WindowType.devilNewsWin,function(){r.default.instance.setInfo(e.role,e.level,e.fightNum,e.teamData)})},t=__decorate([l],t)}(n.default));i.default=c,cc._RF.pop()},{"../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../OpenWin/OpenWinController":"OpenWinController","./DevilNewsWin":"DevilNewsWin"}],DevilResult:[function(e,t,i){"use strict";cc._RF.push(t,"3269f9K+xtJCpFN4CCEZzAD","DevilResult"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Commons/CommonPageBG"),o=e("../../Core/Language"),a=e("../../Core/GameEventDispatcher"),r=e("./LoardCrusadeCtrl"),s=e("../../Core/CommonsResManager"),l=e("../../Util/Utils"),c=e("../../Core/LoadManager"),d=e("../../GlobalContext"),p=e("../Role/RoleInfo"),h=e("../Scene/Manager/SceneManager"),u=e("../Commons/RewardUtils"),f=e("../../Core/WindowType"),g=e("../Item/ItemIcon"),y=e("../../Util/NumberUtil"),m=e("../Status/StatusController"),C=e("../RankingList/RankingConst"),v=cc._decorator,_=v.ccclass,b=v.property,T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.oneContent=null,t.towContent=null,t.rewardLayout=null,t.rankLayout=null,t.myRank=null,t.worldAtlas=null,t.isRank=!1,t.reward=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.show=function(){e.prototype.show.call(this),a.GameEventDispatcher.instance.on("LoardRank",this.rankInfo,this),a.GameEventDispatcher.instance.on("MyDevilRank",this.myRankInfo,this)},t.prototype.hide=function(){e.prototype.hide.call(this),a.GameEventDispatcher.instance.off("LoardRank",this.rankInfo,this),a.GameEventDispatcher.instance.off("MyDevilRank",this.myRankInfo,this)},t.prototype.inIt=function(e,t){void 0===t&&(t=null),this.isRank=e,this.reward=t;var i=e?o.default.getStr("\u6392\u540d\u5956\u52b1"):o.default.getStr("\u6218\u6597\u7ed3\u7b97");this.onInit(524,668,i),e?(this.oneContent.active=!0,this.towContent.active=!1):(this.oneContent.active=!1,this.towContent.active=!0),r.default.instance.sendDevilRank(C.RankingType.Devil)},t.prototype.rankInfo=function(){var e=this;this.isRank&&(l.default.setNodeChildDestoryByUrl(this.rankLayout,"prefab/worldbosss/info"),c.default.instance.loadResByType(d.GlobalContext.Root+"prefab/worldbosss/info",cc.Prefab,function(t){for(var i=0;i<5;i++){var n=r.default.instance.loardRank[i];if(n){var o=l.default.getNodeByUrl(t,"prefab/worldbosss/info");e.rankLayout.addChild(o);var a=o.getChildByName("icon"),c=o.getChildByName("ranking");o.getChildByName("value").getComponent(cc.Label).string,o.getChildByName("name").getComponent(cc.Label).string;o.getChildByName("base").getComponent(cc.Sprite).spriteFrame=i%2==0?e.worldAtlas.getSpriteFrame("base1"):e.worldAtlas.getSpriteFrame("base2"),i<3?(a.getComponent(cc.Sprite).spriteFrame=s.default.instance.getSpriteFrameByName("crown"+(i+1)),a.active=!0,c.active=!1):(c.active=!0,a.active=!1,c.getComponent(cc.Label).string=i+1+""),n.point,n.info.name}}},this))},t.prototype.oneCeInfo=function(){this.towContent.children[0].getChildByName("damage").getComponent(cc.Label).string=y.NumberUtil.getNumber(h.default.instance.attackenemyhp)+"",this.towContent.children[1].getChildByName("damage").getComponent(cc.Label).string=y.NumberUtil.getNumber(r.default.instance.myDevilRankData.point),this.towContent.children[2].getChildByName("ranking").getComponent(cc.Label).string=r.default.instance.myDevilRankData.rank<100?r.default.instance.myDevilRankData.rank+"":"100";var e=0;for(var t in this.reward)1==this.reward[t].baseid&&(e+=this.reward[t].count);this.towContent.children[3].getChildByName("NumberLabe").getComponent(cc.Label).string=y.NumberUtil.getNumber(e)},t.prototype.myRankInfo=function(){var e=r.default.instance.myDevilRankData;this.myRank.getChildByName("ranking").getComponent(cc.Label).string=e.rank,this.myRank.getChildByName("value").getComponent(cc.Label).string=e.point,this.myRank.getChildByName("name").getComponent(cc.Label).string=p.MyRoleInfo.name,this.oneCeInfo(),this.rewardInfo()},t.prototype.rewardInfo=function(){var e=this,t=r.default.instance.devilConf.rank[1],i=r.default.instance.myDevilRankData;if(this.isRank)for(var n in t)i.rank>=t[n].min&&i.rank>=t[n].max&&(this.reward=u.default.instance.getItemList(t[n].rewardId));c.default.instance.loadResByType(d.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(t){l.default.setNodeChildDestoryByUrl(e.rewardLayout,d.GlobalContext.Root+"prefab/Bag/ItemIcon");for(var i=0;i<e.reward.length;i++)if(1!=e.reward[i].baseid){var n=null;(n=l.default.getNodeByPool(f.PoolType.ItemIcon,t)).getComponent(g.default).ItemData(e.reward[i],!0,null,!0),e.rewardLayout.addChild(n),n.active=!0,n.setScale(.8)}},this)},t.prototype.onClose=function(){e.prototype.onClose.call(this),m.default.instance.activityStatusHandle(!0)},t.instance=null,__decorate([b(cc.Node)],t.prototype,"oneContent",void 0),__decorate([b(cc.Node)],t.prototype,"towContent",void 0),__decorate([b(cc.Node)],t.prototype,"rewardLayout",void 0),__decorate([b(cc.Node)],t.prototype,"rankLayout",void 0),__decorate([b(cc.Node)],t.prototype,"myRank",void 0),__decorate([b(cc.SpriteAtlas)],t.prototype,"worldAtlas",void 0),t=i=__decorate([_],t)}(n.default);i.default=T,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/NumberUtil":"NumberUtil","../../Util/Utils":"Utils","../Commons/CommonPageBG":"CommonPageBG","../Commons/RewardUtils":"RewardUtils","../Item/ItemIcon":"ItemIcon","../RankingList/RankingConst":"RankingConst","../Role/RoleInfo":"RoleInfo","../Scene/Manager/SceneManager":"SceneManager","../Status/StatusController":"StatusController","./LoardCrusadeCtrl":"LoardCrusadeCtrl"}],DiamondInfo:[function(e,t,i){"use strict";cc._RF.push(t,"eaf20LbVsFIYbur3fjKVnU1","DiamondInfo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../../Core/ConfigsManager"),a=e("../../Util/SDKUtils"),r=e("../Tips/OpTipsController"),s=e("../../Core/Language"),l=e("../../Core/GameEventDispatcher"),c=e("../../Core/Event"),d=e("./ShopController"),p=e("../../GlobalContext"),h=cc._decorator,u=h.ccclass,f=h.property,g=function(e){function t(){var t=e.call(this)||this;return t.ShopTitle=null,t.Description=null,t.TopUpBtn=null,t.Number=null,t.Present=null,t.Price=null,t.Icon=null,t.Icons=null,t.IconTwo=null,t.PurchasesBtn=null,t.Hot=null,t.PresentNode=null,t.Warning=null,t.conf=null,t.data=null,t.index=null,t.id=null,t.userId=null,i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this),this.conf=o.ConfigsManager.instance.getConfigs("diamondshopconf").Type,console.log(this.conf)},t.prototype.show=function(){e.prototype.show.call(this),l.GameEventDispatcher.instance.on(c.EventDefiner.TopUpFlag,this.checkHot,this)},t.prototype.hide=function(){e.prototype.hide.call(this),l.GameEventDispatcher.instance.off(c.EventDefiner.TopUpFlag,this.checkHot,this)},t.prototype.checkHot=function(){d.default.instance.diamondData&&this.id&&(d.default.instance.diamondData[this.id]?(this.conf.times=1,this.Hot.active=!1,this.PresentNode.active=!1):(this.conf.times=0,this.Hot.active=!0,this.PresentNode.active=!0))},t.prototype.initDiamondInfo=function(e,t,i,n,a){if(void 0===n&&(n=null),void 0===a&&(a=null),this.conf=o.ConfigsManager.instance.getConfigs("diamondshopconf").Type,null!=n&&(this.userId=n,console.log(1,this.userId)),this.id=i,this.data=e,this.index=t,this.PurchasesBtn.interactable="4"!=t,"3"==t||"4"==t){var r=this.conf[t].description+a+this.conf[t].description2;console.log(r),this.Description.string=r,this.Warning.active=!0,this.Warning.getComponent(cc.Label).string=this.conf[t].description3}else this.Description.string=this.conf[t].description,this.Warning.active=!1;this.ShopTitle.string=this.conf[t].title,this.TopUpBtn.string=this.conf[t].btnlabel,this.Number.string=e.diamond+"",this.Icon.spriteFrame=this.IconTwo.getSpriteFrame(e.icon),this.Present.string=e.present,this.Price.string=e.btnlabel,0!=e.times||"3"==t||"4"==t?(this.Hot.active=!1,this.PresentNode.active=!1):(this.Hot.active=!0,this.PresentNode.active=!0)},t.prototype.close=function(){e.prototype.close.call(this),p.PlayerData.TopPanel.active=!1},t.prototype.purchaseBtn=function(){var e=this;if(1==a.default.instance.isInitWX)if("1"==this.index){var t="help="+this.id+"&"+("topupinfo="+JSON.stringify(this.data))+"&"+("name="+p.PlayerData.userInfo.nickname);a.default.instance.shareAppMessage(function(){console.log("\u5206\u4eab\u6210\u529f"),e.close()},this,t,null,null,s.default.getStr("FriendsrechargeLink"))}else"2"==this.index?a.default.instance.rechargeByIndex(this.data.index,function(t){t&&r.default.instance.ShowMsg(s.default.getStr("\u5145\u503c\u6210\u529f")),e.close()},this):"3"==this.index&&a.default.instance.rechargeByIndex(this.data.index,function(t){t&&r.default.instance.ShowMsg(s.default.getStr("\u5145\u503c\u6210\u529f")),e.close()},this);else a.default.instance.rechargeByIndex(this.data.index,function(){r.default.instance.ShowMsg(s.default.getStr("\u5145\u503c\u6210\u529f")),e.close()},this)},t.instance=null,__decorate([f(cc.Label)],t.prototype,"ShopTitle",void 0),__decorate([f(cc.Label)],t.prototype,"Description",void 0),__decorate([f(cc.Label)],t.prototype,"TopUpBtn",void 0),__decorate([f(cc.Label)],t.prototype,"Number",void 0),__decorate([f(cc.Label)],t.prototype,"Present",void 0),__decorate([f(cc.Label)],t.prototype,"Price",void 0),__decorate([f(cc.Sprite)],t.prototype,"Icon",void 0),__decorate([f(cc.SpriteAtlas)],t.prototype,"Icons",void 0),__decorate([f(cc.SpriteAtlas)],t.prototype,"IconTwo",void 0),__decorate([f(cc.Button)],t.prototype,"PurchasesBtn",void 0),__decorate([f(cc.Node)],t.prototype,"Hot",void 0),__decorate([f(cc.Node)],t.prototype,"PresentNode",void 0),__decorate([f(cc.Node)],t.prototype,"Warning",void 0),t=i=__decorate([u],t)}(n.default);i.default=g,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/Window":"Window","../../GlobalContext":"GlobalContext","../../Util/SDKUtils":"SDKUtils","../Tips/OpTipsController":"OpTipsController","./ShopController":"ShopController"}],DiamondShop:[function(e,t,i){"use strict";cc._RF.push(t,"442975EK55FW5kJde8+Cl4W","DiamondShop"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/ConfigsManager"),o=e("../../Core/Widget"),a=e("../Commons/ListViewCtrl"),r=e("./ShopController"),s=cc._decorator,l=s.ccclass,c=s.property,d=function(e){function t(){var t=e.call(this)||this;return t.diamondList=null,t.conf=null,i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.hide=function(){e.prototype.hide.call(this)},t.prototype.init=function(){this.conf=n.ConfigsManager.instance.getConfigs("diamondshopconf");var e=[];for(var t in this.conf.DiamondShopConf){var i=this.conf.DiamondShopConf[t];r.default.instance.diamondData&&r.default.instance.diamondData[Number(t)]?i.times=1:i.times=0,e.push(i)}this.setData(e)},t.prototype.setData=function(e){this.diamondList.refreshItem=this.updateitem,this.diamondList.refreshItemThis=this,this.diamondList.initialize(e)},t.prototype.updateitem=function(e,t){var i=this.diamondList.dataLsit[t];e.getComponent("TopUpInfo").initDiamond(i,t)},t.instance=null,__decorate([c(a.default)],t.prototype,"diamondList",void 0),t=i=__decorate([l],t)}(o.default);i.default=d,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Widget":"Widget","../Commons/ListViewCtrl":"ListViewCtrl","./ShopController":"ShopController"}],DrawCardConst:[function(e,t,i){"use strict";cc._RF.push(t,"9dc8bhehXxFKK1+1f4lkn6J","DrawCardConst"),Object.defineProperty(i,"__esModule",{value:!0}),function(e){e[e.LeftDraw=0]="LeftDraw",e[e.LeftDrawTen=1]="LeftDrawTen",e[e.MiddleLeft=2]="MiddleLeft",e[e.MiddleTen=3]="MiddleTen",e[e.RightDraw=4]="RightDraw"}(i.DrawCardType||(i.DrawCardType={})),function(e){e[e.one=1]="one",e[e.ten=2]="ten"}(i.DrawCardClickType||(i.DrawCardClickType={})),function(e){e.Url="resources/DrawCard/"}(i.DrawCardResUrl||(i.DrawCardResUrl={})),cc._RF.pop()},{}],DrawCardData:[function(e,t,i){"use strict";cc._RF.push(t,"99f69r6CwFMmoDH/CEaEBjl","DrawCardData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/ConfigsManager"),o=cc._decorator,a=o.ccclass,r=(o.property,function(){function e(){this.lotteryConf=null,this.jackpotData={},this.lotteryConf=n.ConfigsManager.instance.getConfigs("lotteryconf").lottery[1];var e,t=n.ConfigsManager.instance.getConfigs("lotteryconf").needItem;for(var i in this.lotteryConf)(e=this.lotteryConf[i]).previewPool&&(this.jackpotData[this.lotteryConf[i].index]=this.setItemData(e.previewPool)),2==e.index&&e.free?(this.itemId=t[e.needItem].id,this.count=t[e.needItem].count):1==e.index&&e.free?(this.itemId1=t[e.needItem].id,this.count1=t[e.needItem].count):1!=e.index||e.free||(this.itemId2=t[e.needItem].id,this.count2=t[e.needItem].count),1==e.index&&e.free&&(this.freeDrawOneCount=e.time.length)}return e.prototype.getOpenChapter=function(e,t){void 0===t&&(t=0);var i=0;for(var n in this.lotteryConf)if(this.lotteryConf[n].index==e&&0==t){i=this.lotteryConf[n].chapter?this.lotteryConf[n].chapter:0;break}return i},e.prototype.getDiamond=function(e,t){void 0===t&&(t=0);var i=0;for(var n in this.lotteryConf)if(this.lotteryConf[n].index==e){if(i==t){t=this.lotteryConf[n].needDiamond?this.lotteryConf[n].needDiamond:0;break}i++}return t},e.prototype.getPoolItem=function(e){return this.jackpotData[e]},e.prototype.setItemData=function(e){for(var t={},i=n.ConfigsManager.instance.getConfigs("Itemconf").ItemConf,o=0;o<e.length;++o){var a=i[e[o]].ItemColor;t[a]||(t[a]=new Array),t[a].push(e[o])}return t},e=__decorate([a],e)}());i.default=r,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager"}],DrawCardItem:[function(e,t,i){"use strict";cc._RF.push(t,"7988cfRwJhOvY+lPHgoU0Wr","DrawCardItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Item/ItemData"),o=e("../../Util/Utils"),a=e("../Item/ItemIcon"),r=e("../../Core/Widget"),s=e("../../GlobalContext"),l=e("../../Core/LoadManager"),c=cc._decorator,d=c.ccclass,p=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.img=null,t.imgs=null,t.itemListNode=null,t.position_x=-325,t.position_y=0,t.spacing_X=10,t.spacing_Y=10,t.maxCellNum=6,t.cellHeight=120,t.cellWidth=120,t}return __extends(t,e),t.prototype.setData=function(e,t){var i=this;this.img.spriteFrame=this.imgs.getSpriteFrame("rarity_"+e);var r=Math.ceil(t.length/this.maxCellNum);r>1&&(this.node.height+=(this.spacing_Y+this.cellHeight)*(r-1)),o.default.setNodeChildDestoryByUrl(this.itemListNode,s.GlobalContext.Root+"prefab/Bag/ItemIcon"),l.default.instance.loadResByType(s.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(e){for(var r=0;r<t.length;++r){var l=o.default.getNodeByUrl(e,s.GlobalContext.Root+"prefab/Bag/ItemIcon"),c=n.default.creatItem(t[r],1);l.getComponent(a.default).ItemData(c,!1,null,!0),i.itemListNode.addChild(l);var d=i.position_y-(i.spacing_Y+i.cellHeight)*Math.floor(r/i.maxCellNum),p=i.position_x+(i.spacing_X+i.cellWidth)*(r%i.maxCellNum);l.x=p,l.y=d}},this)},__decorate([p(cc.Sprite)],t.prototype,"img",void 0),__decorate([p(cc.SpriteAtlas)],t.prototype,"imgs",void 0),__decorate([p(cc.Node)],t.prototype,"itemListNode",void 0),t=__decorate([d],t)}(r.default);i.default=h,cc._RF.pop()},{"../../Core/LoadManager":"LoadManager","../../Core/Widget":"Widget","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Item/ItemData":"ItemData","../Item/ItemIcon":"ItemIcon"}],DrawCard:[function(e,t,i){"use strict";cc._RF.push(t,"d014dsotV9FeIRxVhfYgwVl","DrawCard"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../../Core/Language"),a=e("../Role/RoleInfo"),r=e("../../Core/GameEventDispatcher"),s=e("../Commons/RewardUtils"),l=e("./DrawController"),c=e("../../Core/TimeController"),d=e("../../GlobalContext"),p=e("./RewardedCard"),h=e("../../Global/GlobalValue"),u=e("./DrawCardItem"),f=e("../Item/ItemController"),g=e("../WarTeam/MonsterController"),y=e("../Item/ItemData"),m=e("../Commons/Image"),C=e("../../Core/LoadManager"),v=e("../../Util/Utils"),_=e("../../Util/RechargeUtils"),b=e("../../Util/RechargeConst"),T=e("../../Util/NumberUtil"),S=e("../../Core/Event"),I=e("./DrawCardConst"),w=e("../../Util/DateUtil"),D=e("../Tips/OpTipsController"),R=cc._decorator,A=R.ccclass,N=R.property,L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ShowTip=null,t.node1=null,t.content=null,t.normalArray=null,t.toggle=null,t.rewardPanel=null,t.light=null,t.timeOut=null,t.time3=null,t.isPlay=null,t.ToggleContainer=null,t.imgBg=null,t.sendLeft=null,t.sendRight=null,t}var i;return __extends(t,e),i=t,Object.defineProperty(t.prototype,"drawCardData",{get:function(){return l.default.instance.data},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){i.instance=this,this.node.getChildByName("BigBG").width=d.GlobalContext.StageWidth,this.node.getChildByName("BigBG").height=d.GlobalContext.StageHeight,this.node.getChildByName("effectNode").width=d.GlobalContext.StageWidth,this.node.getChildByName("NormalArrayBG").width=d.GlobalContext.StageWidth,this.node.getChildByName("NormalArrayBG").height=d.GlobalContext.StageWidth,C.default.instance.loadResByType(d.GlobalContext.Root+"prefab/DrawCard/drawCardItem",cc.Prefab,function(e){},this),this.setToggleData(),this.sendLeft.getChildByName("btn_02").getComponentInChildren(cc.Label).string=o.default.getStr("7241"),this.sendRight.getChildByName("btn_02").getComponentInChildren(cc.Label).string=o.default.getStr("7242"),this.sendRight.getChildByName("LabelNode").getComponentInChildren(cc.Label).string=o.default.getStr("7233",this.drawCardData.getOpenChapter(3))},t.prototype.setToggleData=function(){for(var e,t=1;t<=3;t++)e=this.ToggleContainer.node.getChildByName(t+""),cc.find("Background/iconImg",e).getComponent(m.default).updateBg(I.DrawCardResUrl.Url+"bg_juese"+t+".png"),cc.find("Background/patternImg",e).getComponent(m.default).updateBg(I.DrawCardResUrl.Url+"i18n_zhaohuan"+t+".png");this.setText(cc.find("2/Background/di/layerLabel",this.ToggleContainer.node),o.default.getStr(l.default.instance.ShowRedPoint2()?"7238":"7236"))},t.prototype.show=function(){e.prototype.show.call(this),this.toggle.isChecked=l.default.instance.isChecked,this.ShowTip.active=!1,this.node1.active=!1,this.updateData(),this.upMoney(),this.RewardPanel(),this.isPlay=!0,this.ToggleContainer.node.getChildByName(""+l.default.instance.selectIndex).getComponent(cc.Toggle).isChecked=!0;for(var t=1;t<=3;t++)cc.find(t+"/Background/img",this.ToggleContainer.node).active=l.default.instance.selectIndex==t;r.GameEventDispatcher.instance.on("AGAIN",this.outReward,this),r.GameEventDispatcher.instance.on("DRAWREWARD",this.creatReward,this),r.GameEventDispatcher.instance.on(S.EventDefiner.PlayerMoneyChange,this.upMoney,this),r.GameEventDispatcher.instance.on("DRAWLIGHTOVER",this.drawLightOver,this),r.GameEventDispatcher.instance.on("DRAWUPDATEDATA",this.updateData,this),r.GameEventDispatcher.instance.on("DRAWSHOWBIGBG",this.showBigLvBg,this),r.GameEventDispatcher.instance.on("BagPackInfoChange",this.setOneDrawText,this),r.GameEventDispatcher.instance.on("BagPackInfoChange",this.setOneDrawText1,this)},t.prototype.hide=function(){e.prototype.hide.call(this),r.GameEventDispatcher.instance.off("AGAIN",this.outReward,this),r.GameEventDispatcher.instance.off("DRAWREWARD",this.creatReward,this),r.GameEventDispatcher.instance.off(S.EventDefiner.PlayerMoneyChange,this.upMoney,this),r.GameEventDispatcher.instance.off("DRAWLIGHTOVER",this.drawLightOver,this),r.GameEventDispatcher.instance.off("DRAWUPDATEDATA",this.updateData,this),r.GameEventDispatcher.instance.off("DRAWSHOWBIGBG",this.showBigLvBg,this),r.GameEventDispatcher.instance.off("BagPackInfoChange",this.setOneDrawText,this),r.GameEventDispatcher.instance.off("BagPackInfoChange",this.setOneDrawText1,this),l.default.instance.isChecked=this.toggle.isChecked,this.clearTimeOut(),this.closeTime3(),this.isPlay=null},t.prototype.setOneDrawText=function(){if(2==l.default.instance.selectIndex){var e=this.drawCardData.count,t=this.drawCardData.itemId,i=f.default.instance.getItemNum(t),n=cc.find("diamond_02/icon",this.sendLeft),o=this.sendLeft.getChildByName("diamond_02").getComponentInChildren(cc.Label);e>i?(o.string=""+this.drawCardData.getDiamond(2),this.setItemIcon(n,y.default.creatItem(s.RewardType.Diamond))):(this.setItemIcon(n,y.default.creatItem(t)),o.string=i+"/"+e)}},t.prototype.setOneDrawText1=function(){if(1==l.default.instance.selectIndex){var e=this.drawCardData.count1,t=this.drawCardData.itemId1,i=f.default.instance.getItemNum(t),n=cc.find("diamond_02/icon",this.sendLeft),o=l.default.instance.ShowRedPoint();if(this.sendLeft.children[1].active=!o&&e<=i,!o&&e<=i){var a=this.sendLeft.getChildByName("diamond_02").getComponentInChildren(cc.Label);this.setItemIcon(n,y.default.creatItem(t)),a.string=i+"/"+e}}},t.prototype.creatReward=function(){var e=s.default.instance.getItemListByServerData(l.default.instance.reward);this.rewardPanel.getComponent(p.default).setData(e),this.rewardPanel.active=!0},t.prototype.clearTimeOut=function(){if(this.timeOut&&(c.default.instance.clearInterval(this.timeOut),this.timeOut=null),this.node.active){var e=cc.find("1/Background/di/layerLabel",this.ToggleContainer.node);this.setText(e,o.default.getStr("7238"))}},t.prototype.setTime=function(){var e=this,t=(c.default.instance.ServerTimeMins,l.default.instance.getTime1());if(t&&this.ToggleContainer){var i=cc.find("1/Background/di/layerLabel",this.ToggleContainer.node);this.setText(i,o.default.getStr("7235",w.DateUtil.timeSecondsToChineseHour(t))),this.timeOut||(this.timeOut=c.default.instance.setInterval(function(){var t=l.default.instance.getTime1();if(t)e.setText(i,o.default.getStr("7235",w.DateUtil.timeSecondsToChineseHour(t)));else{e.drawCardData.freeDrawOneCount;e.updateData(),e.clearTimeOut()}},this,1e3))}else this.clearTimeOut()},t.prototype.setText=function(e,t){e.getComponent(cc.RichText).string=t},t.prototype.drawLightOver=function(){this.isPlay&&(this.isPlay=null,this.playLight(3))},t.prototype.updateData=function(){this.updateRed(),this.setRightState(),this.setTime()},t.prototype.playLight=function(e,t,i,n){var o=this;void 0===t&&(t=null),void 0===i&&(i=null),void 0===n&&(n=null),this.light.stop(),this.light.node.active=!0,this.light.play("ani"+e),this.light.off("finished"),this.light.node.stopAllActions(),2!=e&&this.light.on("finished",function(){1==e&&(o.light.play("ani2"),t&&t.call(i,n)),3==e&&(o.light.stop(),o.light.node.active=!1,o.light.off("finished"))},this)},t.prototype.drawEvent=function(e,t){var i,n,r=this;switch(l.default.instance.selectIndex){case 1:if("1"==t){if(l.default.instance.clickType=I.DrawCardClickType.one,l.default.instance.type=I.DrawCardType.LeftDraw,l.default.instance.ShowRedPoint()&&(i=!0),!i){var s=this.drawCardData.count1,c=this.drawCardData.itemId1;f.default.instance.getItemNum(c)>=s&&(i=!0)}i?(this.skipAnimation(),this.toggle.isChecked||this.showNormalArray()):D.default.instance.ShowMsg(o.default.getStr("7239",w.DateUtil.timeSecondsToChineseHour(l.default.instance.getTime1())))}else{l.default.instance.clickType=I.DrawCardClickType.ten,l.default.instance.type=I.DrawCardType.LeftDrawTen;f.default.instance.getItemNum(this.drawCardData.itemId2);_.default.PurchaseItemOrRechage(b.RechargeTypeConst.Prop,this.drawCardData.count2,function(){r.skipAnimation(),r.toggle.isChecked||r.showNormalArray()},this,this.drawCardData.itemId2)}break;case 2:if("1"==t){if(l.default.instance.type=I.DrawCardType.MiddleLeft,l.default.instance.clickType=I.DrawCardClickType.one,l.default.instance.ShowRedPoint2()&&(i=!0),!i){s=this.drawCardData.count,c=this.drawCardData.itemId;f.default.instance.getItemNum(c)>=s&&(i=!0)}n=this.drawCardData.getDiamond(2),i||a.MyRoleInfo.diamond>=n?(this.skipAnimation(),this.toggle.isChecked||this.showNormalArray()):_.default.PurchaseItemOrRechage(b.RechargeTypeConst.Diamonds,n,null,this)}else l.default.instance.type=I.DrawCardType.MiddleTen,n=this.drawCardData.getDiamond(2,1),l.default.instance.clickType=I.DrawCardClickType.ten,_.default.PurchaseItemOrRechage(b.RechargeTypeConst.Diamonds,n,function(){r.skipAnimation(),r.toggle.isChecked||r.showNormalArray()},this);break;case 3:if(!l.default.instance.ShowRedPoint3())return void D.default.instance.ShowMsg(o.default.getStr("7240",w.DateUtil.setTimeToChineseStr(l.default.instance.getTime3(),1)));l.default.instance.type=I.DrawCardType.RightDraw,n=this.drawCardData.getDiamond(3),l.default.instance.clickType=I.DrawCardClickType.ten,_.default.PurchaseItemOrRechage(b.RechargeTypeConst.Diamonds,n,function(){r.skipAnimation(),r.toggle.isChecked||r.showNormalArray()},this)}},t.prototype.rewardOnePreview=function(e){var t=this;C.default.instance.loadResByType(d.GlobalContext.Root+"prefab/DrawCard/drawCardItem",cc.Prefab,function(e){t.ShowTip.active=!0,t.content.parent.getComponent(cc.ScrollView).scrollToTop();var i=t.drawCardData.getPoolItem(l.default.instance.selectIndex);if(!t.content.childrenCount)for(var n=h.MaxQuality;n>=0;--n)if(i[n]){var o=v.default.getNodeByUrl(e,d.GlobalContext.Root+"prefab/DrawCard/drawCardItem");t.content.addChild(o),o.getComponent(u.default).setData(n+1,i[n])}},this)},t.prototype.closeTip=function(){this.ShowTip.active=!1,v.default.setNodeChildDestoryByUrl(this.content,d.GlobalContext.Root+"prefab/DrawCard/drawCardItem")},t.prototype.showBigLvBg=function(){this.node1.active=!0},t.prototype.showNormalArray=function(){var e=this;f.default.instance.OpenAddItemEffeict(!1),g.default.instance.setCardSynthesisFlag(!1),l.default.instance.drawReaw(),this.playLight(1,function(){e.normalArray.active=!0,e.outReward()},this)},t.prototype.outReward=function(){this.creatReward()},t.prototype.skipAnimation=function(){if(this.node.getChildByName("BigBG").getChildByName("bgBtnNode").active=!1,this.node.getChildByName("effectNode").active=!1,this.node.getChildByName("node").active=!1,1==this.toggle.isChecked)return f.default.instance.OpenAddItemEffeict(!1),g.default.instance.setCardSynthesisFlag(!1),l.default.instance.drawReaw(),void(this.normalArray.active=!0)},t.prototype.RewardPanel=function(){f.default.instance.OpenAddItemEffeict(!0),g.default.instance.setCardSynthesisFlag(!0),this.normalArray.active=!1,this.rewardPanel.active=!1,this.node.active=!0,this.node1.active=!1,this.isPlay=!0,this.node.getChildByName("BigBG").getChildByName("bgBtnNode").active=!0,this.node.getChildByName("effectNode").active=!0,this.node.getChildByName("node").active=!0},t.prototype.setItemIcon=function(e,t){var i=d.GlobalContext.ResRoot+"resources/itemicon/"+t.ItemIcon+".png";v.default.setImage(e,i)},t.prototype.closeTime3=function(){this.time3&&(c.default.instance.clearInterval(this.time3),this.time3=null),this.node.active&&this.setText(cc.find("3/Background/di/layerLabel",this.ToggleContainer.node),o.default.getStr("7237"))},t.prototype.upMoney=function(){cc.find("BigBG/gold/num",this.node).getComponent(cc.Label).string=T.NumberUtil.getDiamondNum(a.MyRoleInfo.diamond)},t.prototype.updateRed=function(){this.ToggleContainer?(cc.find("1/Background/red",this.ToggleContainer.node).active=l.default.instance.ShowRedPoint()||l.default.instance.itemRed1(),cc.find("2/Background/red",this.ToggleContainer.node).active=l.default.instance.ShowRedPoint2()||l.default.instance.itemRed2()):console.warn("DrawCard===\u8282\u70b9\u95ee\u9898")},t.prototype.setRightState=function(){var e=this,t=l.default.instance.selectIndex;this.imgBg.updateBg(I.DrawCardResUrl.Url+"bg_tu"+t+".png"),this.sendRight.children[1].active=!1,this.sendLeft.children[1].active=this.sendLeft.children[2].active=!0;var i=this.sendLeft.getChildByName("LabelNode"),n=this.sendRight.getChildByName("btn_02").getComponent(cc.Button),a=cc.find("btn_02/red",this.sendRight),r=this.sendLeft.getChildByName("btn_02").getComponentInChildren(cc.Sprite).node,d=this.sendRight.getChildByName("LabelNode");switch(n.interactable=!0,this.sendRight.active=!1,this.sendLeft.active=!1,i.active=!1,d.active=!1,a.active=!1,t){case 1:r.active=l.default.instance.ShowRedPoint()||l.default.instance.itemRed1(),i.active=l.default.instance.ShowRedPoint(),this.sendRight.active=this.sendLeft.active=!0,this.setOneDrawText1();var p=f.default.instance.getItemNum(this.drawCardData.itemId2);a.active=p>=this.drawCardData.count2,this.sendRight.getChildByName("diamond_02").active=!0,this.sendRight.getChildByName("diamond_02").getComponentInChildren(cc.Label).string=p+"/"+this.drawCardData.count2,this.setItemIcon(cc.find("diamond_02/icon",this.sendRight),y.default.creatItem(this.drawCardData.itemId2));break;case 2:this.sendRight.active=this.sendLeft.active=!0,this.sendRight.getChildByName("diamond_02").active=!0;var h=l.default.instance.ShowRedPoint2();r.active=l.default.instance.ShowRedPoint2()||l.default.instance.itemRed2(),i.active=l.default.instance.ShowRedPoint2(),this.sendLeft.getChildByName("diamond_02").active=!h,this.sendRight.getChildByName("diamond_02").getComponentInChildren(cc.Label).string=this.drawCardData.getDiamond(2,1)+"",this.setItemIcon(cc.find("diamond_02/icon",this.sendRight),y.default.creatItem(s.RewardType.Diamond)),this.setText(cc.find("2/Background/di/layerLabel",this.ToggleContainer.node),o.default.getStr(h?"7238":"7236")),this.setOneDrawText();break;case 3:this.sendRight.active=!0,d.active=!l.default.instance.isOpen3(),this.sendRight.getChildByName("diamond_02").active=l.default.instance.isOpen3(),this.sendRight.getChildByName("diamond_02").getComponentInChildren(cc.Label).string=this.drawCardData.getDiamond(3)+"",this.setItemIcon(cc.find("diamond_02/icon",this.sendRight),y.default.creatItem(s.RewardType.Diamond)),n.interactable=l.default.instance.isOpen3()}if(!this.time3){var u=l.default.instance.getTime3();if(u){var g=cc.find("3/Background/di/layerLabel",this.ToggleContainer.node);this.setText(g,o.default.getStr("7235",w.DateUtil.setTimeToChineseStr(u,1))),this.time3=c.default.instance.setInterval(function(){var t=l.default.instance.getTime3();t?e.setText(g,o.default.getStr("7235",w.DateUtil.setTimeToChineseStr(t,1))):(e.updateData(),e.closeTime3())},this,1e3)}else this.closeTime3()}},t.prototype.onClickToggle=function(e){var t=parseInt(e.target.name);null!=t&&t==l.default.instance.selectIndex||(cc.find(l.default.instance.selectIndex+"/Background/img",this.ToggleContainer.node).active=!1,l.default.instance.selectIndex=t,cc.find(t+"/Background/img",this.ToggleContainer.node).active=!0,this.setRightState())},t.instance=null,__decorate([N(cc.Node)],t.prototype,"ShowTip",void 0),__decorate([N(cc.Node)],t.prototype,"node1",void 0),__decorate([N(cc.Node)],t.prototype,"content",void 0),__decorate([N(cc.Node)],t.prototype,"normalArray",void 0),__decorate([N(cc.Toggle)],t.prototype,"toggle",void 0),__decorate([N(cc.Node)],t.prototype,"rewardPanel",void 0),__decorate([N(cc.Animation)],t.prototype,"light",void 0),__decorate([N(cc.ToggleContainer)],t.prototype,"ToggleContainer",void 0),__decorate([N(m.default)],t.prototype,"imgBg",void 0),__decorate([N(cc.Node)],t.prototype,"sendLeft",void 0),__decorate([N(cc.Node)],t.prototype,"sendRight",void 0),t=i=__decorate([A],t)}(n.default);i.default=L,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/Window":"Window","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/DateUtil":"DateUtil","../../Util/NumberUtil":"NumberUtil","../../Util/RechargeConst":"RechargeConst","../../Util/RechargeUtils":"RechargeUtils","../../Util/Utils":"Utils","../Commons/Image":"Image","../Commons/RewardUtils":"RewardUtils","../Item/ItemController":"ItemController","../Item/ItemData":"ItemData","../Role/RoleInfo":"RoleInfo","../Tips/OpTipsController":"OpTipsController","../WarTeam/MonsterController":"MonsterController","./DrawCardConst":"DrawCardConst","./DrawCardItem":"DrawCardItem","./DrawController":"DrawController","./RewardedCard":"RewardedCard"}],DrawController:[function(e,t,i){"use strict";cc._RF.push(t,"a9c3cHjrkZDzJYYZHIsZKwu","DrawController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../Core/GameEventDispatcher"),a=e("./DrawCardData"),r=e("../../NetConnect/NetConnet"),s=e("../Functionicon/FunctionIconController"),l=e("../../Core/TimeController"),c=e("../../Core/WindowType"),d=e("../Gamelayer/Interface/EventInterface"),p=e("../Chapter/ChapterController"),h=e("../WarTeam/MonsterController"),u=e("../Item/ItemController"),f=e("./DrawCardConst"),g=cc._decorator,y=g.ccclass,m=(g.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.data=null,t.time_1=null,t.time_2=null,t.freeDrawCnt_1=null,t.time_3=null,t.clickType=null,t.selectIndex=1,t.type=0,t.ids=[c.WindowType.DrawCard,c.WindowType.DrawCardHight,c.WindowType.DrawCardUltima],t.isChecked=!1,t}var i;return __extends(t,e),i=t,t.prototype.listNotification=function(){this.data=new a.default,this.addProto("lottery",this.drawInfo,this),this.addProto("lotteryresult",this.rewardPanel,this),o.GameEventDispatcher.instance.on("BagPackInfoChange",this.RewardPool,this),i.instance=this,this.endTime()},t.prototype.endTime=function(){var e=new Date(l.default.instance.ServerTimeMins);this.serTime=e.setHours(23,59,59,999)},t.prototype.setChooseIndex=function(e){this.selectIndex=this.ids.indexOf(e)+1},t.prototype.drawInfo=function(e){var t=this,i=e.data.lottery;for(var n in i)switch(parseInt(n)){case f.DrawCardType.LeftDraw:this.time_1=i[n].time>0?i[n].time:0,this.freeDrawCnt_1=i[n].lotterycnt;break;case f.DrawCardType.MiddleLeft:this.time_2=i[n].time>0?i[n].time:0,!this.timer2&&this.getTime2()&&(this.timer2=l.default.instance.setTimeout(function(){t.RewardPool(),l.default.instance.clearTimeout(t.timer2),t.timer2=null},this,this.getTime2()));break;case f.DrawCardType.RightDraw:this.time_3=i[n].time>0?i[n].time:0,!this.timer3&&this.getTime3()&&(this.timer3=l.default.instance.setTimeout(function(){t.RewardPool(),l.default.instance.clearTimeout(t.timer3),t.timer3=null},this,this.getTime3()))}this.isHaveNum||this.endTime(),this.RewardPool()},t.prototype.drawReaw=function(){var e={cmd:"lottery",index:this.type};r.default.instance.sendProto(e)},t.prototype.share=function(e){var t={cmd:"lotteryshare",index:e};r.default.instance.sendProto(t)},t.prototype.rewardPanel=function(e){for(var t in this.reward=e.reward,this.reward)if(6==h.default.instance.data.getCardIdByItemId(this.reward[t].id).rarity){o.GameEventDispatcher.instance.emit("DRAWSHOWBIGBG");break}o.GameEventDispatcher.instance.emit("DRAWREWARD")},t.prototype.RewardPool=function(){var e=this;if(s.default.instance.checkIsOpenbyWindowtype(c.WindowType.DrawCard)){var t=this.data.freeDrawOneCount,i=this.ShowRedPoint();if(this.freeDrawCnt_1<t){var n=l.default.instance.ServerTimeMins;n<this.time_1&&(l.default.instance.clearTimeout(this.timer1),this.timer1=l.default.instance.setTimeout(function(){e.RewardPool()},this,this.time_1-n))}i||(i=this.ShowRedPoint2()),i||(i=this.itemRed1()),i||(i=this.itemRed2()),s.default.instance.FuncIconRedDeal(c.WindowType.DrawCard,i),o.GameEventDispatcher.instance.emit(d.EventInterface.AltarRed,i),o.GameEventDispatcher.instance.emit("DRAWUPDATEDATA")}},t.prototype.isHaveNum=function(){return this.freeDrawCnt_1<this.data.freeDrawOneCount},t.prototype.ShowRedPoint=function(){var e=this.data.freeDrawOneCount;return!(this.freeDrawCnt_1>=e)&&l.default.instance.ServerTimeMins>=this.time_1},t.prototype.itemRed1=function(){var e=this.data.count1,t=this.data.itemId1;return u.default.instance.getItemNum(t)>=e},t.prototype.itemRed2=function(){var e=this.data.count,t=this.data.itemId;return u.default.instance.getItemNum(t)>=e},t.prototype.ShowRedPoint2=function(){return l.default.instance.ServerTimeMins>=this.time_2},t.prototype.ShowRedPoint3=function(){return!!this.isOpen3()&&l.default.instance.ServerTimeMins>=this.time_3},t.prototype.isOpen3=function(){var e=p.default.instance.currentChapterId+1;return this.data.getOpenChapter(3)<=e},t.prototype.getTime3=function(){var e=l.default.instance.ServerTimeMins;return e<this.time_3?this.time_3-e:0},t.prototype.getTime2=function(){var e=l.default.instance.ServerTimeMins;return e<this.time_2?this.time_2-e:0},t.prototype.getTime1=function(){var e=l.default.instance.ServerTimeMins,t=this.isHaveNum()?this.time_1:this.serTime;return e<t?t-e:0},t.instance=null,t=i=__decorate([y],t)}(n.default));i.default=m,cc._RF.pop()},{"../../Core/Controller":"Controller","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/TimeController":"TimeController","../../Core/WindowType":"WindowType","../../NetConnect/NetConnet":"NetConnet","../Chapter/ChapterController":"ChapterController","../Functionicon/FunctionIconController":"FunctionIconController","../Gamelayer/Interface/EventInterface":"EventInterface","../Item/ItemController":"ItemController","../WarTeam/MonsterController":"MonsterController","./DrawCardConst":"DrawCardConst","./DrawCardData":"DrawCardData"}],EditBoxUtils:[function(e,t,i){"use strict";cc._RF.push(t,"063244NiFBApoKQ+yCouEM9","EditBoxUtils"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=cc._decorator,a=o.ccclass,r=o.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.overflowValue=3,t.horizontalAlignValue=1,t.verticalAlignValue=1,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this);var t=this.node.getComponent(cc.EditBox);if(t){var i=t._sgNode._renderCmd;i._edTxt.style["text-align"]="center";var n=i._textLabel;n.setOverflow(this.overflowValue),n.setHorizontalAlign(this.horizontalAlignValue),n.setVerticalAlign(this.verticalAlignValue)}},__decorate([r(cc.Integer)],t.prototype,"overflowValue",void 0),__decorate([r(cc.Integer)],t.prototype,"horizontalAlignValue",void 0),__decorate([r(cc.Integer)],t.prototype,"verticalAlignValue",void 0),t=__decorate([a],t)}(n.default);i.default=s,cc._RF.pop()},{"../../Core/Widget":"Widget"}],EffectBase:[function(e,t,i){"use strict";cc._RF.push(t,"c7e95h2vy1HFbC/2KhyXBMP","EffectBase"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./LoadManager"),o=e("./CacheManager"),a=e("./TimeController"),r=e("../Module/Scene/LayerableCompent"),s=cc._decorator,l=s.ccclass,c=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.url=[],t.pause=!0,t.startframe=1,t.endframe=-1,t.curframe=1,t.maxframe=0,t.curactionkey="",t.splist=[],t.sprite=null,t.keyDic={},t.loop=!1,t.completeCallback=null,t.completeCallbackThisObj=null,t.completeCallbackParam=null,t.frametime=30,t._playRate=1,t.setintervalnum=0,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this),this.initData()},t.prototype.initData=function(){this.sprite||(this.sprite=this.node.addComponent(cc.Sprite))},t.prototype.show=function(){e.prototype.show.call(this),0==this.pause&&this.setinterval()},t.prototype.hide=function(){e.prototype.hide.call(this),0==this.pause&&a.default.instance.clearInterval(this.setintervalnum)},t.prototype.playByUrlAndKey=function(e,t){this.endframe=-1,this.splist=[],this.keyDic={},this.curframe=1,this.curactionkey=t,this.url!=e?(this.url=e,n.default.instance.loadResArray(e.concat(),cc.SpriteAtlas,this.loadComplete,this,[e]),this.setUseRecord()):this.play(t)},t.prototype.loadComplete=function(e,t){var i=this;this.url==t&&(e.forEach(function(e){e.getSpriteFrames().forEach(function(e){i.splist.push(e),i.keyDic[e.name]=e})}),this.maxframe=this.endframe>0?this.endframe:this.getSpriteFrameLenghtByKey(this.curactionkey),this.url.toString()==t.sort().toString()&&this.setinterval())},t.prototype.setPlayRate=function(e){this._playRate=e,0==this.pause&&this.setinterval()},Object.defineProperty(t.prototype,"playRate",{get:function(){return this._playRate},enumerable:!0,configurable:!0}),t.prototype.setinterval=function(){var e=this;a.default.instance.clearInterval(this.setintervalnum),this.pause=!1,this.setintervalnum=a.default.instance.setInterval(function(){e.setSpriteFrame()},this,Math.floor(1e3/(this.frametime*this.playRate)))},t.prototype.play=function(e){"[object String]"==Object.prototype.toString.call(e)&&this.changeAction(e),this.curframe=1,this.setinterval()},t.prototype.resume=function(){this.setinterval()},t.prototype.stop=function(){a.default.instance.clearInterval(this.setintervalnum),this.pause=!0},t.prototype.gotoAndStop=function(e,t){var i=this;this.changeAction(t),this.setCurFrame(e),this.stop();var n=a.default.instance.setTimeout(function(){i.keyDic&&i.keyDic[i.curactionkey+i.curframe]&&(i.sprite.spriteFrame=i.keyDic[i.curactionkey+i.curframe]),a.default.instance.clearTimeout(n)},this,100)},t.prototype.gotoAndPlay=function(e,t){this.changeAction(t),this.setCurFrame(e),this.setinterval()},Object.defineProperty(t.prototype,"Startframe",{set:function(e){this.curframe=e,this.startframe=e},enumerable:!0,configurable:!0}),t.prototype.changeAction=function(e){e&&(this.curactionkey=e,this.maxframe=this.getSpriteFrameLenghtByKey(this.curactionkey))},t.prototype.setSpriteFrame=function(){this.url.length>0&&!this.pause&&(this.sprite.spriteFrame=this.keyDic[this.curactionkey+this.curframe],this.curframe++,!this.loop&&this.curframe>this.maxframe?(this.completeCallback&&this.completeCallback.apply(this.completeCallbackThisObj,this.completeCallbackParam),this.sprite.spriteFrame=null,this.stop()):this.curframe=this.curframe>this.maxframe?this.startframe:this.curframe)},t.prototype.clear=function(){if(this.clearUseRecord(),this.sprite&&this.sprite.isValid&&(this.sprite.spriteFrame=null),this.stop(),this.url&&(this.url.length=0,this.url=null),this.splist&&(this.splist.length=0,this.splist=null),this.keyDic){for(var e in this.keyDic)this.keyDic[e]=null,delete this.keyDic[e];this.keyDic=null}this.completeCallback=null,this.completeCallbackThisObj=null,this.completeCallbackParam=null},t.prototype.dispose=function(){this.clear(),e.prototype.dispose.call(this)},t.prototype.onDestroy=function(){this.clear(),e.prototype.onDestroy.call(this)},t.prototype.getSpriteFrameLenghtByKey=function(e){var t=0;return this.splist.forEach(function(i){-1!=i.name.search(new RegExp("^"+e+"(\\d)+$"))&&t++}),t},t.prototype.setCurFrame=function(e){e<1&&(e=1),e>this.maxframe&&(e=this.maxframe),this.curframe=e},t.prototype.clearUseRecord=function(){if(this.url&&this.url.length>0)for(var e=this.url.length-1;e>=0;e--)o.default.instance.clearUseRecord(this.url[e])},t.prototype.setUseRecord=function(){if(this.url&&this.url.length>0)for(var e=this.url.length-1;e>=0;e--)o.default.instance.setUseRecord(this.url[e])},__decorate([c(cc.Sprite)],t.prototype,"sprite",void 0),t=__decorate([l],t)}(r.default);i.default=d,cc._RF.pop()},{"../Module/Scene/LayerableCompent":"LayerableCompent","./CacheManager":"CacheManager","./LoadManager":"LoadManager","./TimeController":"TimeController"}],EliteBossControl:[function(e,t,i){"use strict";cc._RF.push(t,"4c2a2ocmEtLhJNzRGFH+k/P","EliteBossControl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../Core/ConfigsManager"),a=e("../Role/RoleInfo"),r=cc._decorator,s=r.ccclass,l=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._Config=null,t.cardConf=null,t.eliteBossConf=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){this.cardConf=o.ConfigsManager.instance.getConfigs("cardConf"),this.eliteBossConf=o.ConfigsManager.instance.getConfigs("elitebossconf"),i.instance=this},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.listNotification=function(){},t.prototype.getElitecostTime=function(){var e=this.getRoomId();return o.ConfigsManager.instance.getConfigs("elitebossconf").EliteBossConf[e].costTimes},t.prototype.getRoleCount=function(){var e=this.getRoomId();return o.ConfigsManager.instance.getConfigs("elitebossconf").EliteBossConf[e].RoleCount},t.prototype.getEliteBossbyLevel=function(e){var t=this.getRoomId();return o.ConfigsManager.instance.getConfigs("elitebossconf").RoomCount[t]},t.prototype.getEliteBossByList=function(e){return o.ConfigsManager.instance.getConfigs("elitebossconf").Length},t.prototype.getRoomId=function(){var e=a.MyRoleInfo.level,t=o.ConfigsManager.instance.getConfigs("elitebossconf");for(var i in t.EliteBossConf){var n=t.EliteBossConf[i];if(n.minLevel<=e&&n.maxLevel>=e)return n.RoomCount}return[]},t.prototype.getRoomList=function(){var e=a.MyRoleInfo.level,t=o.ConfigsManager.instance.getConfigs("elitebossconf"),i=[];for(var n in t.EliteBossConf)t.EliteBossConf[n].minLevel<=e&&i.push(t.EliteBossConf[n]);return i},t.instance=null,t=i=__decorate([s],t)}(n.default));i.default=l,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Controller":"Controller","../Role/RoleInfo":"RoleInfo"}],EliteBossOpenTips:[function(e,t,i){"use strict";cc._RF.push(t,"72c136eCphLT7JiWJ/qZI/e","EliteBossOpenTips"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../GlobalContext"),o=e("../../Util/Utils"),a=e("../../Core/LoadManager"),r=e("../Commons/RewardUtils"),s=e("../Item/ItemIcon"),l=e("../OpenWin/OpenWinController"),c=e("../../Core/WindowType"),d=e("../Activity/ActivityController"),p=e("../Tips/TipsWinController"),h=e("../../Core/Language"),u=e("../../Core/Window"),f=cc._decorator,g=f.ccclass,y=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layout=null,t._activityItemData=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),this.rewardInfo()},t.prototype.hide=function(){e.prototype.hide.call(this)},t.prototype.rewardInfo=function(){var e=this;o.default.setNodeChildDestoryByUrl(this.layout,n.GlobalContext.Root+"prefab/Bag/ItemIcon"),a.default.instance.loadResByType(n.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(t){for(var i=r.default.instance.getItemList(d.default.instance.activityConfigs.ActivityConf[3].rewardId),a=0;a<i.length;a++){var l=o.default.getNodeByUrl(t,n.GlobalContext.Root+"prefab/Bag/ItemIcon");l.scale=.9,l.getComponent(s.default).ItemData(i[a],!0,null,!0),e.layout.addChild(l)}},this)},t.prototype.goBtn=function(){this.close(),2==d.default.instance.actstatusArr[2].status?l.default.instance.openWindow(c.WindowType.EliteBoss):p.default.instance.ShowTips(h.default.getStr("\u6d3b\u52a8\u5df2\u7ed3\u675f"))},__decorate([y(cc.Node)],t.prototype,"layout",void 0),t=__decorate([g],t)}(u.default);i.default=m,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/Window":"Window","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Activity/ActivityController":"ActivityController","../Commons/RewardUtils":"RewardUtils","../Item/ItemIcon":"ItemIcon","../OpenWin/OpenWinController":"OpenWinController","../Tips/TipsWinController":"TipsWinController"}],EliteBoss:[function(e,t,i){"use strict";cc._RF.push(t,"c8f5bake8dJFblHoh/siwH6","EliteBoss"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../Activity/ActivityController"),a=e("../../Core/CommonsResManager"),r=e("../../Core/GameEventDispatcher"),s=e("../Role/RoleInfo"),l=e("../../Core/ConfigsManager"),c=e("../../GlobalContext"),d=e("./EliteitemPrefab"),p=e("../../Util/GrayEffect"),h=e("../../NetConnect/NetConnet"),u=e("../Commons/MonsterPreview"),f=e("../../Util/Utils"),g=e("../../Core/WindowType"),y=e("../WarTeam/MonsterController"),m=e("../../Core/TimeController"),C=e("../../Core/Event"),v=e("../../Global/GlobalValue"),_=e("../OpenWin/OpenWinController"),b=e("../Tips/OpTipsController"),T=e("../../Core/Language"),S=e("../../Core/LoadManager"),I=cc._decorator,w=I.ccclass,D=I.property,R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.eliteRankContent=null,t.rankInfo=null,t.EliteBossAlat=null,t.eliteContent=null,t.eliteRighttWin=null,t.commAlat=null,t.timeLabel=null,t.eliteRankData=null,t.updaterank=null,t.isFrist=!1,t.countDown=null,t._Config=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.show=function(){e.prototype.show.call(this),this._Config=l.ConfigsManager.instance.getConfigs("elitebossconf"),this.NodeSetPosition(),this.toggleInfo(),r.GameEventDispatcher.instance.on("EliteRank",this.ElitesBossRank,this),r.GameEventDispatcher.instance.on("GETINDEX",this.actchange,this)},t.prototype.hide=function(){e.prototype.hide.call(this),this.countDown&&m.default.instance.clearInterval(this.countDown),this.closeUpdateRank(),this.isFrist=!1,this.UnfoldRightWin(),this.RetractRightWin(),r.GameEventDispatcher.instance.off("EliteRank",this.ElitesBossRank,this),r.GameEventDispatcher.instance.off("GETINDEX",this.actchange,this)},t.prototype.sendInfo=function(){h.default.instance.sendProto({cmd:"ebinfo",actId:2})},t.prototype.NodeSetPosition=function(){var e=cc.find("infoLayer/ElitesLayer/RankingLayer",this.node),t=cc.find("infoLayer/ElitesLayer/Info",this.node),i=cc.find("BossInfo/HpDi",this.node);i.y=c.GlobalContext.UIHeight/2-i.height-10,e.y=c.GlobalContext.UIHeight/2-e.height/2+2,e.x=c.GlobalContext.UIWidth/2-e.width/2,t.x=-c.GlobalContext.UIWidth/2+t.width/2+2,cc.find("btnClose",this.node).y=c.GlobalContext.UIHeight/2-cc.find("btnClose",this.node).height/2+2,cc.find("btnClose",this.node).x=-c.GlobalContext.UIWidth/2+cc.find("btnClose",this.node).width/2+2,cc.find("Title",this.node).y=c.GlobalContext.UIHeight/2-cc.find("Title",this.node).height/2+2,cc.find("Title",this.node).x=-c.GlobalContext.UIWidth/2+cc.find("Title",this.node).width/2+2},t.prototype.initEliteBossInfo=function(){cc.find("BossInfo/HpDi/NewSprite",this.node).getComponent(cc.Sprite).spriteFrame=this.EliteBossAlat.getSpriteFrame("Icon");var e=cc.find("infoLayer/ElitesLayer/Info",this.node);e.parent.active=!0,e.y=-c.GlobalContext.UIHeight/2+e.height/2+20;var t=this.eliteRighttWin.getChildByName("di");o.default.instance.ChallengeBool?(this.eliteRighttWin.x=c.GlobalContext.UIWidth/2-this.eliteRighttWin.width/2,t.getChildByName("LeftButton").active=!1,t.getChildByName("RightButton").active=!0,r.GameEventDispatcher.instance.on("EliteRank",this.eliteRankInfo,this),this.sendrankdata()):(this.eliteRighttWin.x=c.GlobalContext.UIWidth/2-this.eliteRighttWin.width/2+(this.eliteRighttWin.width-50),t.getChildByName("LeftButton").active=!0,t.getChildByName("RightButton").active=!1,r.GameEventDispatcher.instance.off("EliteRank",this.eliteRankInfo,this))},t.prototype.actchange=function(){this.getFightingNum(),o.default.instance.fightNum?(cc.find("GrayNode",this.node).active=!1,cc.find("btnNewLineup",this.node).getComponent(cc.Button).interactable=!0):(cc.find("GrayNode",this.node).active=!0,cc.find("btnNewLineup",this.node).getComponent(cc.Button).interactable=!1);var e=o.default.instance.actstatusArr[2];if(e)switch(e.status){case 1:cc.find("BossLayer/sp",this.node).active=!1,this.BtnInfo(!0,!0),cc.find("BossInfo/HpDi/base",this.node).active=!1,cc.find("infoLayer/ElitesLayer/coin",this.node).active=!1,cc.find("infoLayer/ElitesLayer/info",this.node).active=!1;break;case 2:cc.find("BossLayer/sp",this.node).active=!1,cc.find("BossInfo/BossEtime",this.node).active=!1,cc.find("BossInfo/HpDi/base",this.node).active=!1;break;case 3:cc.find("BossLayer/sp",this.node).active=!0,this.BtnInfo(!1,!1)}else cc.find("BossLayer/sp",this.node).active=!0,this.BtnInfo(!1,!1);this.bossInfo(),this.monsterInfo(),this.timeOutInfo()},t.prototype.bossInfo=function(){var e=this,t=this._Config.boss[1],i=o.default.instance.currElitIndex,n=o.default.instance.challgeEliteIndx;if(!o.default.instance.elitePitch)if(n<0)for(var a=0;a<t.length;a++){if(s.MyRoleInfo.level>=t[a].needLevel&&s.MyRoleInfo.level<t[a+1].needLevel&&a+1<=t.length){o.default.instance.monster=t[a],i=a;break}o.default.instance.monster=t[t.length-1],i=t.length-1}else{i=n,o.default.instance.monster=t[i],this.eliteContent.children[i].getChildByName("Challenge").active=!0;for(a=0;a<this.eliteContent.childrenCount;a++)a==i?(this.eliteContent.children[a].getChildByName("Challenge").active=!0,this.eliteContent.children[a].getComponent(p.default).setGray(!1)):(this.eliteContent.children[a].getComponent(p.default).setGray(!0),this.eliteContent.children[a].getChildByName("Challenge").active=!1)}this.eliteContent.children[i].getComponent(cc.Toggle).isChecked=!0;var r=m.default.instance.setTimeout(function(){e.eliteContent.parent.parent.getComponent(cc.ScrollView).scrollToOffset(cc.v2(0,Math.abs(e.eliteContent.children[i].y+e.eliteContent.children[i].height/2))),m.default.instance.clearTimeout(r)},this,100)},t.prototype.updataHpInfo=function(e,t){0==e?(cc.find("BossInfo/HpDi",this.node).active=!1,cc.find("BossLayer/sp",this.node).active=!0,cc.find("BossLayer/playLayer",this.node).active=!1,this.BtnInfo(!1,!1)):(this.BtnInfo(!0,!0),cc.find("BossLayer/sp",this.node).active=!1,cc.find("BossInfo/HpDi",this.node).active=!0,cc.find("BossInfo/HpDi",this.node).getComponent(cc.ProgressBar).progress=e/t,cc.find("BossInfo/HpDi/HpNum",this.node).getComponent(cc.Label).string=Math.floor(1e4*e/t)/100+"%")},t.prototype.ElitesBossRank=function(){var e=o.default.instance.eliteRank;for(var t in this.eliteRankData=e.data,this.eliteRankData){var i=this.eliteContent.children[t],n=i.getComponent(d.default);n.num.string="\u6311\u6218\u4eba\u6570\uff1a"+this.eliteRankData[t].count,n.icon.spriteFrame=this.EliteBossAlat.getSpriteFrame("littleBoss"),n.progressBar.progress=this.eliteRankData[t].hp/this.eliteRankData[t].maxhp,i.getChildByName("ProgressBar").getChildByName("bar").getComponent(cc.Sprite).spriteFrame=this.EliteBossAlat.getSpriteFrame("HP"),n.HPLabe.string=Math.floor(1e4*this.eliteRankData[t].hp/this.eliteRankData[t].maxhp)/100+"%",n.HPLabe.node.active=!0,n.dieNode.active=!1,0!=this.eliteRankData[t].hp?o.default.instance.challgeEliteIndx>=0&&this.eliteContent.children[o.default.instance.challgeEliteIndx].getComponent(p.default).setGray(!1):0==this.eliteRankData[t].hp&&(i.getComponent(p.default).setGray(!0),i.getChildByName("Challenge").active=!1,n.dieNode.active=!0)}this.isFrist||(this.initEliteBossInfo(),this.isFrist=!0)},t.prototype.BtnInfo=function(e,t){cc.find("btnNewLineup",this.node).active=e,cc.find("btnSetLineup",this.node).active=t},t.prototype.sendrankdata=function(){var e;e={cmd:"ebrank",actId:2},h.default.instance.sendProto(e)},t.prototype.openUpdateRank=function(){var e=this;this.sendrankdata(),this.closeUpdateRank(),this.updaterank=m.default.instance.setInterval(function(){e.sendrankdata()},this,1e4)},t.prototype.closeUpdateRank=function(){m.default.instance.clearInterval(this.updaterank)},t.prototype.RetractRightWin=function(){r.GameEventDispatcher.instance.off("EliteRank",this.eliteRankInfo,this),this.eliteRighttWin.x=c.GlobalContext.UIWidth/2-this.eliteRighttWin.width/2,this.eliteRighttWin.runAction(cc.moveBy(.4,this.eliteRighttWin.width-50,0)),this.eliteRighttWin.getChildByName("di").getChildByName("LeftButton").active=!0,this.eliteRighttWin.getChildByName("di").getChildByName("RightButton").active=!1},t.prototype.UnfoldRightWin=function(){r.GameEventDispatcher.instance.on("EliteRank",this.eliteRankInfo,this),this.sendrankdata(),this.eliteRighttWin.runAction(cc.moveBy(.4,50-this.eliteRighttWin.width,0)),this.eliteRighttWin.getChildByName("di").getChildByName("LeftButton").active=!1,this.eliteRighttWin.getChildByName("di").getChildByName("RightButton").active=!0},t.prototype.eliteRankInfo=function(){var e=cc.find("infoLayer/ElitesLayer/RankingLayer/di/konDi",this.node),t=this.eliteRankData[o.default.instance.currElitIndex].rank,i=this.eliteRankData[o.default.instance.currElitIndex];t&&t.length?e.active=!1:e.active=!0,this.eliteRankContent.removeAllChildren();for(var n=0;n<t.length;n++){var r=n+1,l=cc.instantiate(this.rankInfo);l.active=!0,this.eliteRankContent.addChild(l),n<3?(l.getChildByName("icon").active=!0,l.getChildByName("icon").scale=.5,l.getChildByName("ranking").active=!1,l.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=a.default.instance.getSpriteFrameByName("crown"+r)):(l.getChildByName("ranking").getComponent(cc.Label).string=r+"",l.getChildByName("icon").active=!1,l.getChildByName("ranking").active=!0),l.getChildByName("name").getComponent(cc.Label).string=o.default.instance.nameSubstring(t[n].info.name,7),l.getChildByName("value").getComponent(cc.Label).string=t[n].point+"",l.active=!0,l.x=150.9}var c=cc.find("infoLayer/ElitesLayer/RankingLayer/di/info",this.node);i&&i.myPoint?(c.getChildByName("ranking").active=!0,c.getChildByName("value").active=!0,c.getChildByName("ranking").getComponent(cc.Label).string=i.myRank+"",c.getChildByName("name").getComponent(cc.Label).string=o.default.instance.nameSubstring(String(s.MyRoleInfo.name),7),c.getChildByName("value").getComponent(cc.Label).string=i.myPoint+""):(c.getChildByName("ranking").active=!1,c.getChildByName("value").active=!1,c.getChildByName("name").getComponent(cc.Label).string=s.MyRoleInfo.name+": \u6682\u672a\u4e0a\u699c")},t.prototype.SetLinup=function(){o.default.instance.isSetSandTab=!0,o.default.instance.elitePitch=!0,o.default.instance.EliteBossSetSand(),r.GameEventDispatcher.instance.emit(C.EventDefiner.ChangeGameScene,{status:v.GameScene.Fight,guanqiaId:v.GQIdType.EliteBoss}),_.default.instance.openWindow(g.WindowType.HighLadderFighting),_.default.instance.openWindow(g.WindowType.SandTable)},t.prototype.btn_NewLineup=function(){var e=o.default.instance;e.fightNum?this._Config.boss[1][o.default.instance.currElitIndex].needLevel>s.MyRoleInfo.level?b.default.instance.ShowMsg(T.default.getStr("\u7b49\u7ea7\u672a\u8fbe\u5230")):(e.isSetSandTab=!1,e.elitePitch=!1,e.sendElitebossenter(),e.isChange=!0,o.default.instance.ChallengeBool=!0):b.default.instance.ShowMsg(T.default.getStr("\u8bf7\u5148\u8bbe\u7f6e\u9635\u5bb9"))},t.prototype.getFightingNum=function(){cc.find("FightBase",this.node).active=!0;var e=o.default.instance;e.fightNum=0;var t=y.default.instance.getServerListChangeBattleList(e.image);for(var i in t)e.fightNum+=y.default.instance.getCarFight(t[i].cardid,t[i].level,t[i].grade)*t[i].count;0==o.default.instance.fightNum?cc.find("FightBase/FighitNum",this.node).getComponent(cc.Label).string="\u6682\u672a\u8bbe\u7f6e\u9635\u5bb9":cc.find("FightBase/FighitNum",this.node).getComponent(cc.Label).string="\u9635\u5bb9\u6218\u529b\uff1a"+o.default.instance.getFight()},t.prototype.monsterInfo=function(){var e=cc.find("BossLayer/playLayer",this.node),t=o.default.instance.monster;e.active=!0;for(var i=e.childrenCount-1;i>=0;i--){e.children[i].getComponent(u.default).clear(),f.default.setNodeToPool(g.PoolType.MonsterPreview,e.children[i])}y.default.instance.infoPreview(e,cc.v2(0,50),t.id,t.grade,1,-1),0==this.eliteRankData[o.default.instance.currElitIndex].hp?cc.find("btnNewLineup",this.node).getComponent(cc.Button).interactable=!1:cc.find("btnNewLineup",this.node).getComponent(cc.Button).interactable=!0,this.updataHpInfo(this.eliteRankData[o.default.instance.currElitIndex].hp,this.eliteRankData[o.default.instance.currElitIndex].maxhp)},t.prototype.rulePage=function(){r.GameEventDispatcher.instance.emit(C.EventDefiner.OpenRulePage,g.WindowType.EliteBoss)},t.prototype.openReward=function(){_.default.instance.openWindow(g.WindowType.WorldBossRewardInfo)},t.prototype.toggleInfo=function(){var e=this;S.default.instance.loadResByType(c.GlobalContext.Root+"prefab/EliteBoss/toggle1",cc.Prefab,function(t){f.default.setNodeChildDestoryByUrl(e.eliteContent,c.GlobalContext.Root+"prefab/EliteBoss/toggle1");for(var i=0;i<e._Config.boss[1].length;i++){var n=e._Config.boss[1][i],o=f.default.getNodeByUrl(t,c.GlobalContext.Root+"prefab/EliteBoss/toggle1");o.active=!0,o.x=0,o.getChildByName("Challenge").active=!1,o.getComponent(d.default).monster=n,o.getChildByName("name").getComponent(cc.Label).string=n.name+"  Lv:"+n.needLevel,o.getComponent(d.default).index=i,e.eliteContent.addChild(o)}e.openUpdateRank(),e.sendInfo()},this)},t.prototype.timeOutInfo=function(){var e=this,t=m.default.instance.ServerTimeMins,i=o.default.instance.actstatusArr[2];t<i.etime&&(this.countDown&&m.default.instance.clearInterval(this.countDown),this.countDown=m.default.instance.setInterval(function(){t+=1e3;var n=i.etime-t;if(t<i.etime){var o=parseInt(""+n/1e3/60/60%24),a=parseInt(""+n/1e3/60%60),r=parseInt(""+n/1e3%60);e.timeLabeShow(o,a,r)}},this,1e3))},t.prototype.timeLabeShow=function(e,t,i){Number(t)<10?Number(i)<10?this.timeLabel.string=e+":0"+t+":0"+i:this.timeLabel.string=e+":0"+t+":"+i:Number(i)<10?Number(t)<10?this.timeLabel.string=e+":0"+t+":0"+i:this.timeLabel.string=e+":"+t+":0"+i:this.timeLabel.string=e+":"+t+":"+i},t.prototype.closeWin=function(){o.default.instance.elitePitch=!1,this.close()},t.instance=null,__decorate([D(cc.Node)],t.prototype,"eliteRankContent",void 0),__decorate([D(cc.Node)],t.prototype,"rankInfo",void 0),__decorate([D(cc.SpriteAtlas)],t.prototype,"EliteBossAlat",void 0),__decorate([D(cc.Node)],t.prototype,"eliteContent",void 0),__decorate([D(cc.Node)],t.prototype,"eliteRighttWin",void 0),__decorate([D(cc.SpriteAtlas)],t.prototype,"commAlat",void 0),__decorate([D(cc.Label)],t.prototype,"timeLabel",void 0),t=i=__decorate([w],t)}(n.default);i.default=R,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/ConfigsManager":"ConfigsManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/Window":"Window","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../NetConnect/NetConnet":"NetConnet","../../Util/GrayEffect":"GrayEffect","../../Util/Utils":"Utils","../Activity/ActivityController":"ActivityController","../Commons/MonsterPreview":"MonsterPreview","../OpenWin/OpenWinController":"OpenWinController","../Role/RoleInfo":"RoleInfo","../Tips/OpTipsController":"OpTipsController","../WarTeam/MonsterController":"MonsterController","./EliteitemPrefab":"EliteitemPrefab"}],EliteitemPrefab:[function(e,t,i){"use strict";cc._RF.push(t,"53381eAYQFOy7xSvg6KPqq9","EliteitemPrefab"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/TimeController"),a=e("../Activity/ActivityController"),r=e("./EliteBoss"),s=cc._decorator,l=s.ccclass,c=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.itemName=null,t.icon=null,t.progressBar=null,t.num=null,t.status=null,t.dieNode=null,t.HPLabe=null,t.monster=null,t.index=null,t.etime=0,t.killTime=0,t.isChange=!1,t.changeNum=0,t.hp=0,t.countDown=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.hide=function(){e.prototype.hide.call(this),this.countDown&&(clearInterval(this.countDown),this.countDown=null)},t.prototype.ClickBtn=function(){var e=a.default.instance;e.monster=this.monster,e.currElitIndex=this.index,e.sendrankdata(),r.default.instance.monsterInfo()},t.prototype.timeOut=function(){var e=this,t=o.default.instance.ServerTimeMins;t<this.etime&&(this.countDown&&(o.default.instance.clearInterval(this.countDown),this.countDown=null),this.countDown=o.default.instance.setInterval(function(){t+=1e3;var i=e.etime-t;if(t<e.etime){var n=parseInt(""+i/1e3/60/60%24),a=parseInt(""+i/1e3/60%60),s=parseInt(""+i/1e3%60),l=n+":"+a+":"+s;if(l=Number(a)<10?Number(s)<10?n+":0"+a+":0"+s:n+":0"+a+":"+s:Number(s)<10?Number(a)<10?n+":0"+a+":0"+s:n+":"+a+":0"+s:n+":"+a+":"+s,e.node&&e.num&&l){e.num.string="\u590d\u6d3b\u65f6\u95f4:"+l;var c=e.etime-e.killTime;e.progressBar.progress=1-i/c}}else e.node&&(e.progressBar.node.getChildByName("bar").getComponent(cc.Sprite).spriteFrame=r.default.instance.EliteBossAlat.getSpriteFrame("HP"),r.default.instance.monsterInfo(),o.default.instance.clearInterval(e.countDown))},this,1e3))},__decorate([c(cc.Label)],t.prototype,"itemName",void 0),__decorate([c(cc.Sprite)],t.prototype,"icon",void 0),__decorate([c(cc.ProgressBar)],t.prototype,"progressBar",void 0),__decorate([c(cc.Label)],t.prototype,"num",void 0),__decorate([c(cc.Node)],t.prototype,"status",void 0),__decorate([c(cc.Node)],t.prototype,"dieNode",void 0),__decorate([c(cc.Label)],t.prototype,"HPLabe",void 0),t=__decorate([l],t)}(n.default);i.default=d,cc._RF.pop()},{"../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../Activity/ActivityController":"ActivityController","./EliteBoss":"EliteBoss"}],EnterBtn:[function(e,t,i){"use strict";cc._RF.push(t,"681c4ZQ5cpNDbNuAQ8HL1ey","EnterBtn"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/WindowType"),a=e("./Shop"),r=e("../OpenWin/OpenWinController"),s=e("./ShopController"),l=e("./ShopConst"),c=e("../Item/ItemController"),d=e("../Item/ItemData"),p=e("../Tips/BatchUsageTips"),h=e("../Item/ItemModel"),u=e("../Role/RoleInfo"),f=cc._decorator,g=f.ccclass,y=(f.property,function(e){function t(){var t=e.call(this)||this;return i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.hide=function(){e.prototype.hide.call(this)},t.prototype.openDiamondShop=function(){r.default.instance.openWindow(o.WindowType.Shop,function(){var e=s.default.instance.nowSortIndex[l.ShopConst.Recharge];a.default.instance.TabBtnList2.selectItem(e)},this)},t.prototype.openJumpVip=function(){r.default.instance.openWindow(o.WindowType.VIP)},t.prototype.OpenEneggy=function(){var e=this;if(c.default.instance.getItemNum(20023)>0&&u.MyRoleInfo.energy<u.MyRoleInfo.maxEnergy){var t=d.default.creatItem(20023,c.default.instance.getItemNum(20023)),i=c.default.instance.getItemByid(20023);r.default.instance.openWindow(o.WindowType.BatchUsageTips,function(){p.default.instance.ShowTips1("\u6279\u91cf\u4f7f\u7528",h.default.UseItembyId,e,[i.guid],t,1)})}else r.default.instance.openWindow(o.WindowType.Shop,function(){var e=s.default.instance.nowSortIndex[l.ShopConst.Diamonds];a.default.instance.TabBtnList2.selectItem(e)},this)},t.instance=null,t=i=__decorate([g],t)}(n.default));i.default=y,cc._RF.pop()},{"../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../Item/ItemController":"ItemController","../Item/ItemData":"ItemData","../Item/ItemModel":"ItemModel","../OpenWin/OpenWinController":"OpenWinController","../Role/RoleInfo":"RoleInfo","../Tips/BatchUsageTips":"BatchUsageTips","./Shop":"Shop","./ShopConst":"ShopConst","./ShopController":"ShopController"}],Enter:[function(e,t,i){"use strict";cc._RF.push(t,"9fdc8gVrslLQ7hkKnJBrtZJ","Enter"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./GlobalContext"),o=e("./Module/Login/LoginController"),a=e("./NetConnect/NetConnet"),r=e("./Core/GameEventDispatcher"),s=e("./Util/SDKUtils"),l=e("./Core/Widget"),c=e("./Module/Role/RoleInfo"),d=e("./Core/TimeController"),p=e("./Core/Event"),h=e("./Module/Login/Loading"),u=cc._decorator,f=u.ccclass,g=u.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Loading=null,t.rigster=null,t.inputNode=null,t.selectServerPanel=null,t.uid=null,t}return __extends(t,e),t.prototype.start=function(){if(this.initUI(),cc.game.on(p.EventDefiner.CanEnterGame,this.onstart,this),!n.PlayerData.userInfo||!n.PlayerData.userInfo.nickname&&s.default.instance.isInitWX)try{tdgamesdk.initUserInfo=this.initUserInfo.bind(this)}catch(e){}r.GameEventDispatcher.instance.on(p.EventDefiner.SDKLogin,this.startBtn,this)},t.prototype.initUserInfo=function(){n.PlayerData.userInfo=tdgamesdk.userInfo},t.prototype.initUI=function(){this.inputNode.active=s.default.instance.isTest,this.rigster.active=!1,this.selectServerPanel.active=!1,this.Loading.node.active=!1,s.default.instance.isTest?this.checkAccount():s.default.instance.platformSdk.openId&&this.checkAccount()},t.prototype.checkAccount=function(){console.log("\u68c0\u6d4b\u7528\u6237\u4fe1\u606f",s.default.instance.platformSdk.openId),this.inputNode.active=s.default.instance.isTest,void 0!==s.default.instance.platformSdk.openId&&""!=s.default.instance.platformSdk.openId?(this.rigster.active=!1,0==c.MyRoleInfo.result?(this.selectServerPanel.active=!1,this.onstart()):this.selectServerPanel.active=!s.default.instance.platformSdk.isCreateRole):(this.rigster.active=!0,this.Loading.node.active=!1,this.selectServerPanel.active=!1)},t.prototype.startBtn=function(){console.log("\u70b9\u51fb\u5f00\u59cb\u6e38\u620f",s.default.instance.platformSdk,s.default.instance.platformSdk.openId,s.default.instance.isWeb),s.default.instance.isWeb?(""==s.default.instance.platformSdk.openId&&(s.default.instance.platformSdk.openId=this.uid.string),this.checkAccount()):""==s.default.instance.platformSdk.openId?s.default.instance.platformSdk.login():(this.rigster.active=!1,this.selectServerPanel.active=!s.default.instance.platformSdk.isCreateRole)},t.prototype.onstart=function(){this.selectServerPanel.active=!1;try{tdgamesdk.userInfo?(console.log("Enter.start, tdgamesdk.userInfo:",tdgamesdk.userInfo),this.init()):(console.log("Enter.start, tdgamesdk.userInfo = null"),this.init(),console.log("\u52a0\u8f7dMain  Enter1"),cc.director.preloadScene("Main",function(e){if(e)return console.log(e.name),console.log(e.message),void console.log(e.stack)}))}catch(e){console.log("Enter.start, error:",e),this.init()}},t.prototype.init=function(){this.Loading.node.active=!0,console.log("Enter.init"),this.gotoStart()},t.prototype.gotoStart=function(){o.default._instance||this.connect(),o.default.instance.listNotification(),o.default.instance.gameStart=this.Loading.gameStart.bind(this.Loading),o.default.instance.checkLoadToScene()},t.prototype.connect=function(){var e=this;s.default.instance.sendToConnect(function(t){if(t)if(console.log("\u4e2d\u592e\u670d\u8fd4\u56de, res:",t),"none"==t.msg){var i="",o="",r="";1==s.default.instance.isInitWX&&tdgamesdk&&tdgamesdk.loginInfo&&(i=tdgamesdk.loginInfo.unionid,o=tdgamesdk.loginInfo.session_key,r=tdgamesdk.loginInfo.loginsign),s.default.instance.wsUrl=t.url+"&unionid="+i+"&session_key="+o+"&loginsign="+r+"&post_data="+encodeURI(JSON.stringify(n.PlayerData.userInfo)),a.default.instance.connect()}else if("retry"==t.msg)var l=d.default.instance.setTimeout(function(){e.connect(),d.default.instance.clearTimeout(l)},e,2e3)},this)},t.prototype.hide=function(){cc.game.off(p.EventDefiner.CanEnterGame,this.onstart)},__decorate([g(h.default)],t.prototype,"Loading",void 0),__decorate([g(cc.Node)],t.prototype,"rigster",void 0),__decorate([g(cc.Node)],t.prototype,"inputNode",void 0),__decorate([g(cc.Node)],t.prototype,"selectServerPanel",void 0),__decorate([g(cc.Label)],t.prototype,"uid",void 0),t=__decorate([f],t)}(l.default);i.default=y,cc._RF.pop()},{"./Core/Event":"Event","./Core/GameEventDispatcher":"GameEventDispatcher","./Core/TimeController":"TimeController","./Core/Widget":"Widget","./GlobalContext":"GlobalContext","./Module/Login/Loading":"Loading","./Module/Login/LoginController":"LoginController","./Module/Role/RoleInfo":"RoleInfo","./NetConnect/NetConnet":"NetConnet","./Util/SDKUtils":"SDKUtils"}],EntityProperty:[function(e,t,i){"use strict";cc._RF.push(t,"00283RfncFMUrvfdRLRwVtY","EntityProperty"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/GameEventDispatcher"),o=e("../../../Core/Const/SAttributeConst"),a=e("../../../Core/Const/EntityType"),r=e("../../../Util/ColorUtil"),s=e("../../../Events/SAttributeEvent"),l=e("../../../Global/GlobalValue"),c=e("../../WarTeam/MonsterController"),d=e("../../Fight/staticattr"),p=e("../Controller/MonsterInitPointController"),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propertys={},t._propertysWithNumber={},t.targetX=0,t.targetY=0,t.nameColor=r.ColorUtil.WHITE,t.selfMonster=!0,t.specialMonster=!1,t.type=0,t.originalName="",t.camp=0,t.anim=0,t.isLive=!0,t.shield=0,t.hp=0,t.maxHP=0,t.cardid=0,t.grade=0,t.cultivateLv=0,t.spineId=0,t.spineName="skin",t.scale=1,t.x=0,t.y=0,t.dir=0,t.moveSpeed=0,t.skillCdDic={},t.status=0,t.skillList=[],t.move=!0,t.anger=0,t.autobigskill=!1,t.otherAttr=0,t._cardType=-1,t.addtype=-1,t.addlevel=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"canSave",{get:function(){return this.addtype==l.ADD_ACTOR_TYPE.RESCURE||-1==this.addtype||this.addtype==l.ADD_ACTOR_TYPE.CAPTIVE},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"copyEntity",{get:function(){return this.addtype==l.ADD_ACTOR_TYPE.NONE},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"deadman",{get:function(){return this.addtype==l.ADD_ACTOR_TYPE.DEADMAN},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBoss",{get:function(){return this.cardid>9e4},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fight",{get:function(){return this.attr.GetFight()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentFight",{get:function(){return this.attr.GetCurrentFight(this.hp)},enumerable:!0,configurable:!0}),t.prototype.getAttackEffectUrl=function(){var e=this.spineId,t="role";this.type==a.EntityType.enMonster&&(e=c.default.instance.getCardGradeByGradeConf(this.cardid,this.grade).modelId,t="monster");return l.SPINE_RES_DIR+t+"/"+e+"/effect"},t.prototype.init=function(e,t){if(this.type=e,e==a.EntityType.enActor)this.handle=t.handle,this.nameColor=t.rgb,this.originalName=t.show_name,this.status=0;else if(e==a.EntityType.enMonster){var i=t;this.cardid=i.cardid,this.grade=i.grade,this.cultivateLv=i.level,this.selfMonster=i.self,this.spineId=c.default.instance.getCardGradeBySpine(this.cardid,this.grade),this.spineName=c.default.instance.getCardGradeBySpineName(this.cardid,this.grade),this.monsterConf=c.default.instance.getMonsterConf(this.cardid,this.grade,this.cultivateLv),this.moveSpeed=this.monsterConf.moveSpeed,this.scale=this.monsterConf.scenescale,this.originalName=c.default.instance.GetMonsterInfo(this.cardid).cardName;var n=c.default.instance.GetMonsterInfo(this.cardid);n&&n.otherAttr&&(this.otherAttr=c.default.instance.GetMonsterInfo(this.cardid).otherAttr),this.attr=new d.StaticAttr,i.attr?this.attr.PushAttr(i.attr):c.default.instance.getCardAttr(this.cardid,this.cultivateLv,this.grade,this.selfMonster,this.skillList,this.attr),this.otherAttr!=l.OtherAttr.Hpchangeadd&&this.otherAttr!=l.OtherAttr.MaxHpchange||this.attr.ChangeAtt(0,Math.floor(.9*this.attr.GetMaxHp())),this.setHP(),this.status=0,this.y=p.default.instance.getMonsterY(this.grade,this.selfMonster)}},Object.defineProperty(t.prototype,"CardType",{get:function(){return-1==this._cardType&&this.type==a.EntityType.enMonster&&(this._cardType=c.default.instance.GetMonsterInfo(this.cardid).cardType),this._cardType},enumerable:!0,configurable:!0}),t.prototype.setHP=function(){this.hp=this.attr.hp,this.maxHP=this.attr.GetMaxHp(),this.otherAttr==l.OtherAttr.MaxHpchange&&(this.hp*=.9)},Object.defineProperty(t.prototype,"numProperties",{get:function(){var e=0;for(var t in this.propertys)e++;return e},enumerable:!0,configurable:!0}),t.prototype.setProperty=function(e,t){var i;i=t;var a=this.getProperty(e);if(this.propertys[e]=t,a!=i){var r=s.SAttributeEvent.UPDATE_DATA_+e;n.GameEventDispatcher.instance.dispatchEvent(new s.SAttributeEvent(r,a,i)),e!=o.SAttributeConst.PROP_COIN&&e!=o.SAttributeConst.PROP_COIN&&e!=o.SAttributeConst.PROP_COIN||n.GameEventDispatcher.instance.dispatchEvent(new s.SAttributeEvent(s.SAttributeEvent.UPDATE_MONEY,a,i))}},t.prototype.getProperty=function(e){return this._propertysWithNumber[e]},t.prototype.addGameEventListener=function(e,t,i){n.GameEventDispatcher.instance.on(e,function(e){t.call(i,e)},i)},t.prototype.gameOnce=function(e,t,i){n.GameEventDispatcher.instance.once(e,function(e){t.call(i,e)},i)},t.prototype.removeGameEventListener=function(e,t,i){n.GameEventDispatcher.instance.off(e,t,i)},t.prototype.hasGameEventListener=function(e){return!1},t.prototype.dispatchGameEvent=function(e){n.GameEventDispatcher.instance.dispatchEvent(e)},t}(n.GameEventDispatcher);i.EntityProperty=h,cc._RF.pop()},{"../../../Core/Const/EntityType":"EntityType","../../../Core/Const/SAttributeConst":"SAttributeConst","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Events/SAttributeEvent":"SAttributeEvent","../../../Global/GlobalValue":"GlobalValue","../../../Util/ColorUtil":"ColorUtil","../../Fight/staticattr":"staticattr","../../WarTeam/MonsterController":"MonsterController","../Controller/MonsterInitPointController":"MonsterInitPointController"}],EntityQiPaoController:[function(e,t,i){"use strict";cc._RF.push(t,"724731G+SVO6ZOcMV4u2Qjr","EntityQiPaoController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../SceneEntity"),o=e("../View/ActorsLayer"),a=e("../../../Core/TimeController"),r=cc._decorator,s=r.ccclass,l=(r.property,function(){function e(){this._handlerDic={}}var t;return t=e,Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),e.prototype.showQiPao=function(e,t,i){var n=this;if(void 0===i&&(i=3e3),o.default.instance.changeByLayer(e,e.node.parent.childrenCount+1),e.showQiPao(t),i>0)var r=a.default.instance.setTimeout(function(){n.hideQiPao(e),a.default.instance.clearTimeout(r)},this,i)},e.prototype.hideQiPao=function(e){e.isLive&&e.node.parent&&e.hideQiPao()},e.prototype.showQiPaoFace=function(e,t,i){var r=this;void 0===i&&(i=3e3);var s=e.getComponent(n.default);if(o.default.instance.changeByLayer(s,e.parent.childrenCount+1),s.showQiPaoFace("face"+t),i>0)var l=a.default.instance.setTimeout(function(){r.hideQiPaoFace(s),a.default.instance.clearTimeout(l)},this,i)},e.prototype.hideQiPaoFace=function(e){e.hideQiPaoFace()},e._instance=null,e=t=__decorate([s],e)}());i.default=l,cc._RF.pop()},{"../../../Core/TimeController":"TimeController","../SceneEntity":"SceneEntity","../View/ActorsLayer":"ActorsLayer"}],EntityType:[function(e,t,i){"use strict";cc._RF.push(t,"f8ef6UcmZVIaKs5d9lqq8jW","EntityType"),Object.defineProperty(i,"__esModule",{value:!0}),function(e){e[e.enActor=1]="enActor",e[e.enMonster=0]="enMonster"}(i.EntityType||(i.EntityType={})),cc._RF.pop()},{}],EquipAttrTileNode:[function(e,t,i){"use strict";cc._RF.push(t,"05787iLWGJIXpt8YlwHaHde","EquipAttrTileNode"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("./EquipTypeNodeTwo"),a=e("../../../Core/Language"),r=e("../../../Core/LoadManager"),s=e("../../../GlobalContext"),l=e("../../../Util/Utils"),c=cc._decorator,d=c.ccclass,p=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.hide=function(){for(var t in e.prototype.hide.call(this),this.node.children)this.node.children[t].active=!1},t.prototype.setData=function(e,t,i,n,c,d){var p=this;for(var h in this.node.children)this.node.children[h].active=!1;var u="type"+e,f=this.node.getChildByName(u);f||console.log("type-------:"+e);var g=1;2==e&&i&&((y=f.getChildByName("title").getChildByName("level")).getComponent(cc.Label).string="+"+i);if(3==e&&i&&n){var y=f.getChildByName("title").getChildByName("level"),m=l.default.getQualityName(n);m+=a.default.getStr("{0}\u661f",i),y.getComponent(cc.Label).string=m}5==e&&i&&((y=f.getChildByName("title").getChildByName("level")).getComponent(cc.Label).string="+"+i);6==e&&i&&((y=f.getChildByName("title").getChildByName("level")).getComponent(cc.Label).string=a.default.getStr("{0}\u7ea7",i),g=5);c&&(g=4),r.default.instance.loadResByType(s.GlobalContext.Root+"prefab/Equip/attr/TypeNodeTwo",cc.Prefab,function(e){var i=f.getChildByName("attrNode");for(var n in t){var a=l.default.getNodeByUrl(e,s.GlobalContext.Root+"prefab/Equip/attr/TypeNodeTwo");t[n]&&(c?a.getComponent(o.default).initEventNode(g,d,t[n]):a.getComponent(o.default).initEventNode(g,parseInt(n),t[n]),i.addChild(a),i.height+=a.height+4)}f.height=f.getChildByName("title").height,f.height+=i.height,p.node.height=f.height,p.node.width=f.width,f.active=!0},this)},t=__decorate([d],t)}(n.default));i.default=p,cc._RF.pop()},{"../../../Core/Language":"Language","../../../Core/LoadManager":"LoadManager","../../../Core/Widget":"Widget","../../../GlobalContext":"GlobalContext","../../../Util/Utils":"Utils","./EquipTypeNodeTwo":"EquipTypeNodeTwo"}],EquipCopyAttrAddItem1:[function(e,t,i){"use strict";cc._RF.push(t,"c20eeV9orlAPbtI6BGvdSLN","EquipCopyAttrAddItem1"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Core/Language"),a=e("../../../Util/AttrUtil"),r=cc._decorator,s=r.ccclass,l=r.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.labelName=null,t.labelDesc=null,t}return __extends(t,e),t.prototype.onInitData=function(e){this.labelName.string=a.default.getAttrName(e.attrType);var t="";t=e.attrPercent>0?o.default.getStr("equipcopy_attr_add_percent",e.attrPercent/100):o.default.getStr("equipcopy_attr_add_value",e.attrValue),this.labelDesc.string=t},__decorate([l(cc.Label)],t.prototype,"labelName",void 0),__decorate([l(cc.Label)],t.prototype,"labelDesc",void 0),t=__decorate([s],t)}(n.default);i.default=c,cc._RF.pop()},{"../../../Core/Language":"Language","../../../Core/Widget":"Widget","../../../Util/AttrUtil":"AttrUtil"}],EquipCopyAttrAddItem2:[function(e,t,i){"use strict";cc._RF.push(t,"35a8atb991LC5y58+rgcQp6","EquipCopyAttrAddItem2"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Core/Language"),a=e("../../../Util/AttrUtil"),r=cc._decorator,s=r.ccclass,l=r.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.labelName=null,t.labelDesc=null,t}return __extends(t,e),t.prototype.onInitData=function(e){this.labelName.string=a.default.getAttrName(e.attrType);var t="";t=e.attrPercent>0?o.default.getStr("equipcopy_attr_add_percent",e.attrPercent/100):o.default.getStr("equipcopy_attr_add_value",e.attrValue),this.labelDesc.string=t},__decorate([l(cc.Label)],t.prototype,"labelName",void 0),__decorate([l(cc.Label)],t.prototype,"labelDesc",void 0),t=__decorate([s],t)}(n.default);i.default=c,cc._RF.pop()},{"../../../Core/Language":"Language","../../../Core/Widget":"Widget","../../../Util/AttrUtil":"AttrUtil"}],EquipCopyAttrAddItem:[function(e,t,i){"use strict";cc._RF.push(t,"1fd9fVzqp9Fqq88ATR4GcGW","EquipCopyAttrAddItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Core/Language"),a=e("../EquipCopyController"),r=e("../../../Core/GameEventDispatcher"),s=e("../EquipCopyEvent"),l=e("../../../Util/GrayEffect"),c=e("../../Commons/Image"),d=e("../../../GlobalContext"),p=e("../../../Util/AttrUtil"),h=cc._decorator,u=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.labelTitle=null,t.labelCost=null,t.spriteIcon=null,t.layerContent=null,t.layerSelect=null,t._isSelect=!1,t._iconQZ=1e3,t._level=0,t._attrShopItem=null,t._remainStar=0,t}return __extends(t,e),t.prototype.onInitData=function(e,t,i){this._level=e,this._index=t,this._attrShopItem=i,this._isSelect=!1,this._remainStar=a.default.instance.getUserStarCount,this.onShowPage(),this.setGray()},t.prototype.show=function(){e.prototype.show.call(this),this._isSelect=!1,r.GameEventDispatcher.instance.on(s.EquipCopyEvent.EquipCopyRemainStar,this.onSetRemainStar,this)},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),r.GameEventDispatcher.instance.off(s.EquipCopyEvent.EquipCopyRemainStar,this.onSetRemainStar,this)},t.prototype.onSetRemainStar=function(e){this._remainStar=Number(e.detail)},t.prototype.onShowPage=function(){var e=p.default.getAttrName(this._attrShopItem.attrType);this._attrShopItem.attrPercent>0?e+=o.default.getStr("equipcopy_attr_add_percent",a.default.instance.getEquipCopyConfig.attrValue[this._index]/100):this._attrShopItem.attrValue>0&&(e+=o.default.getStr("equipcopy_attr_add_value",this._attrShopItem.attrValue)),this.labelTitle.string=e+"",this.labelCost.string=a.default.instance.getEquipCopyConfig.buyAttrNeedStar[this._index]+"",this._attrShopItem.attrIcon&&this._attrShopItem.attrIcon.length>0?this.spriteIcon.getComponent(c.default).loadSpriteAtlas(d.GlobalContext.Root+"ui/equipcopy/iconattr/IconAttr",this._attrShopItem.attrIcon):this.spriteIcon.getComponent(c.default).loadSpriteAtlas(d.GlobalContext.Root+"ui/equipcopy/iconattr/IconAttr","EquipCopy_Attr_"+(this._iconQZ+Number(this._attrShopItem.attrType))),this.onShowSelect()},t.prototype.onShowSelect=function(){this.layerSelect.active=this._isSelect},t.prototype.onClick=function(){(this._isSelect||a.default.instance.onCheckCanSelecAttr(this._remainStar,a.default.instance.getEquipCopyConfig.buyAttrNeedStar[this._index],!0))&&(this._isSelect=!this._isSelect,this.onShowSelect(),a.default.instance.equipData.onPushWipeSelectShop(this._level,this._index),r.GameEventDispatcher.instance.emit(s.EquipCopyEvent.EquipCopyWipeAttrSelect,this._index),this.setGray())},t.prototype.setGray=function(){if(this.labelTitle.node.color=this._isSelect?new cc.Color(100,100,100):new cc.Color(1,110,130),this.layerContent.getComponent(l.default))this.layerContent.getComponent(l.default).setGray(this._isSelect);else if(this._isSelect){this.layerContent.addComponent(l.default).setGray(this._isSelect)}},__decorate([f(cc.Label)],t.prototype,"labelTitle",void 0),__decorate([f(cc.Label)],t.prototype,"labelCost",void 0),__decorate([f(cc.Node)],t.prototype,"spriteIcon",void 0),__decorate([f(cc.Node)],t.prototype,"layerContent",void 0),__decorate([f(cc.Node)],t.prototype,"layerSelect",void 0),t=__decorate([u],t)}(n.default);i.default=g,cc._RF.pop()},{"../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Core/Widget":"Widget","../../../GlobalContext":"GlobalContext","../../../Util/AttrUtil":"AttrUtil","../../../Util/GrayEffect":"GrayEffect","../../Commons/Image":"Image","../EquipCopyController":"EquipCopyController","../EquipCopyEvent":"EquipCopyEvent"}],EquipCopyAttrAddPage:[function(e,t,i){"use strict";cc._RF.push(t,"912f3ClsMVH7rPGgopaPORi","EquipCopyAttrAddPage"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Commons/CommonPageBG"),o=e("../../../Core/Language"),a=e("../../../Core/GameEventDispatcher"),r=e("../EquipCopyEvent"),s=e("../../../Core/WindowManager"),l=e("../../../Core/WindowType"),c=e("../EquipCopyController"),d=e("../../../Util/Utils"),p=e("./EquipCopyAttrLayer"),h=e("./EquipCopyAttrAddItem1"),u=e("./EquipCopyAttrAddItem2"),f=e("../../../GlobalContext"),g=e("../../../Core/LoadManager"),y=e("../../Tips/TipsWinController"),m=cc._decorator,C=m.ccclass,v=m.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layerAttrContent=null,t.attrScrollView=null,t.layerLVContent=null,t.scrollView=null,t.labelStarCount=null,t.labelTips=null,t._remainStar=0,t._attrListLevel=[],t._selectList=[],t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this,this.onInit(1117,604,o.default.getStr("equipcopy_attr_add_title"),!0)},t.prototype.show=function(){e.prototype.show.call(this),a.GameEventDispatcher.instance.on(r.EquipCopyEvent.EquipCopyWipeAttrSelect,this.onAttrSelect,this)},t.prototype.hide=function(){e.prototype.hide.call(this),c.default.instance.equipData.onInitWipeAttrSelect(),a.GameEventDispatcher.instance.off(r.EquipCopyEvent.EquipCopyWipeAttrSelect,this.onAttrSelect,this)},t.prototype.onClose=function(){this.onShowTips(o.default.getStr("equipcopy_wipe_shop_error"))},t.prototype.onInitData=function(){var e=this;this._attrListLevel=c.default.instance.equipData.equipCopyMainData.canSweepShopLevelList,d.default.setNodeChildDestoryByUrl(this.layerLVContent,f.GlobalContext.Root+"prefab/EquipCopy/EquipCopyAttrAdd/EquipCopyAttrLayer"),d.default.setNodeChildDestoryByUrl(this.layerAttrContent,f.GlobalContext.Root+"prefab/EquipCopy/EquipCopyAttrAdd/EquipCopyAttrAddItem1",f.GlobalContext.Root+"prefab/EquipCopy/EquipCopyAttrAdd/EquipCopyAttrAddItem2"),g.default.instance.loadResByType(f.GlobalContext.Root+"prefab/EquipCopy/EquipCopyAttrAdd/EquipCopyAttrLayer",cc.Prefab,function(t){for(var i=0;i<e._attrListLevel.length;i++){var n=d.default.getNodeByUrl(t,f.GlobalContext.Root+"prefab/EquipCopy/EquipCopyAttrAdd/EquipCopyAttrLayer");e.layerLVContent.addChild(n),n.getComponent(p.default).onInitData(e._attrListLevel[i])}e.scrollView.scrollToTop(),e.attrScrollView.scrollToTop(),e.labelTips.string=o.default.getStr("equipcopy_next_tips",c.default.instance.getLevelCondition.condition),e.labelStarCount.string=c.default.instance.getUserStarCount+"",e._remainStar=c.default.instance.getUserStarCount},this)},t.prototype.onAttrSelect=function(){var e=this,t=c.default.instance.equipData.selectWipeAttrList;d.default.setNodeChildDestoryByUrl(this.layerAttrContent,f.GlobalContext.Root+"prefab/EquipCopy/EquipCopyAttrAdd/EquipCopyAttrAddItem1",f.GlobalContext.Root+"prefab/EquipCopy/EquipCopyAttrAdd/EquipCopyAttrAddItem2"),g.default.instance.loadResByType(f.GlobalContext.Root+"prefab/EquipCopy/EquipCopyAttrAdd/EquipCopyAttrAddItem1",cc.Prefab,function(i){g.default.instance.loadResByType(f.GlobalContext.Root+"prefab/EquipCopy/EquipCopyAttrAdd/EquipCopyAttrAddItem2",cc.Prefab,function(n){for(var o=0;o<t.length;o++){var s=void 0;o%2==0?(s=d.default.getNodeByUrl(i,f.GlobalContext.Root+"prefab/EquipCopy/EquipCopyAttrAdd/EquipCopyAttrAddItem1")).getComponent(h.default).onInitData(t[o]):(s=d.default.getNodeByUrl(n,f.GlobalContext.Root+"prefab/EquipCopy/EquipCopyAttrAdd/EquipCopyAttrAddItem2")).getComponent(u.default).onInitData(t[o]),e.layerAttrContent.addChild(s)}e._remainStar=c.default.instance.getUserStarCount-c.default.instance.equipData.selectAttrNeedStart,e._remainStar=e._remainStar>=0?e._remainStar:0,e.labelStarCount.string=e._remainStar+"",a.GameEventDispatcher.instance.emit(r.EquipCopyEvent.EquipCopyRemainStar,e._remainStar)},e)},this)},t.prototype.onClickNext=function(){this._selectList=c.default.instance.equipData.selectWipeIndexList;var e=0;for(var t in this._selectList)this._selectList[t]&&this._selectList[t].attrIndexList&&(e+=this._selectList[t].attrIndexList.length);e<1?this.onShowTips(o.default.getStr("equipcopy_wipe_shop_error")):(this.onSendCmd(),this.onCloseWindow())},t.prototype.onSendCmd=function(){for(var e=[],t=0;t<this._attrListLevel.length;t++){var i=[];this._selectList[this._attrListLevel[t]]&&(i=(i=this._selectList[this._attrListLevel[t]].attrIndexList.concat()).sort()),e.push(i)}c.default.instance.sendCmdWipeShop(e)},t.prototype.onShowTips=function(e){var t=this;y.default.instance.ShowTips(e,function(){t.onSendCmd(),t.onCloseWindow()},this,null,1)},t.prototype.onCloseWindow=function(){s.default.instance.close(l.WindowType.EquipCopyWipeAttr),c.default.instance.onClickNextToBoxList()},t.instance=null,__decorate([v(cc.Node)],t.prototype,"layerAttrContent",void 0),__decorate([v(cc.ScrollView)],t.prototype,"attrScrollView",void 0),__decorate([v(cc.Node)],t.prototype,"layerLVContent",void 0),__decorate([v(cc.ScrollView)],t.prototype,"scrollView",void 0),__decorate([v(cc.Label)],t.prototype,"labelStarCount",void 0),__decorate([v(cc.RichText)],t.prototype,"labelTips",void 0),t=i=__decorate([C],t)}(n.default);i.default=_,cc._RF.pop()},{"../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Core/LoadManager":"LoadManager","../../../Core/WindowManager":"WindowManager","../../../Core/WindowType":"WindowType","../../../GlobalContext":"GlobalContext","../../../Util/Utils":"Utils","../../Commons/CommonPageBG":"CommonPageBG","../../Tips/TipsWinController":"TipsWinController","../EquipCopyController":"EquipCopyController","../EquipCopyEvent":"EquipCopyEvent","./EquipCopyAttrAddItem1":"EquipCopyAttrAddItem1","./EquipCopyAttrAddItem2":"EquipCopyAttrAddItem2","./EquipCopyAttrLayer":"EquipCopyAttrLayer"}],EquipCopyAttrData:[function(e,t,i){"use strict";cc._RF.push(t,"3206eNHv+hLt6cyw2lBkmpJ","EquipCopyAttrData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../EquipCopyController"),o=e("./EquipCopyAttrItem"),a=cc._decorator,r=a.ccclass,s=(a.property,function(){function e(){this._attrValueList=[],this._attrList=[]}return e.prototype.onInitData=function(e){for(var t in this._attrList=e,this._attrList)if(this._attrList[t]>0){var i=n.default.instance.getAttrDataByConfig(Number(t)),a=!0;for(var r in this._attrValueList)if(this._attrValueList[r].attrType==i.type){this._attrValueList[r].addPercent((i.attrPercent?i.attrPercent:0)*this._attrList[t]),this._attrValueList[r].addValue((i.attrValue?i.attrValue:0)*this._attrList[t]),a=!1;break}if(a){var s=new o.default;s.attrType=i.type,s.attrPercent=this._attrList[t],s.attrValue=this._attrList[t],this._attrValueList.push(s)}}},Object.defineProperty(e.prototype,"attrValueList",{get:function(){return this._attrValueList},enumerable:!0,configurable:!0}),e=__decorate([r],e)}());i.default=s,cc._RF.pop()},{"../EquipCopyController":"EquipCopyController","./EquipCopyAttrItem":"EquipCopyAttrItem"}],EquipCopyAttrItem:[function(e,t,i){"use strict";cc._RF.push(t,"83657DxFLpA5ZaGrtks79jC","EquipCopyAttrItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=cc._decorator,o=n.ccclass,a=(n.property,function(){function e(){this._attrType=0,this._percent=0,this._value=0}return Object.defineProperty(e.prototype,"attrType",{get:function(){return this._attrType},set:function(e){this._attrType=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"attrPercent",{get:function(){return this._percent},set:function(e){this._percent=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"attrValue",{get:function(){return this._value},set:function(e){this._value=e},enumerable:!0,configurable:!0}),e.prototype.addPercent=function(e){this._percent=e},e.prototype.addValue=function(e){this._value=e},e=__decorate([o],e)}());i.default=a,cc._RF.pop()},{}],EquipCopyAttrLayer:[function(e,t,i){"use strict";cc._RF.push(t,"552e1ecTE9PYrtpA2YEhHmA","EquipCopyAttrLayer"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../EquipCopyController"),a=e("./EquipCopyAttrAddItem"),r=e("../../../Util/Utils"),s=e("../../../GlobalContext"),l=e("../../../Core/LoadManager"),c=cc._decorator,d=c.ccclass,p=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.labelTitle=null,t.layerContent=null,t._level=0,t._attrList=[],t}return __extends(t,e),t.prototype.onInitData=function(e){this._level=e,this.onShowPage()},t.prototype.onShowPage=function(){var e=this,t=o.default.instance.getLevelConfig(this._level);t&&(this.labelTitle.string=t.levelName);var i=o.default.instance.equipData.getLevelShopList(this._level);i&&(this._attrList=i.shopItemList,l.default.instance.loadResByType(s.GlobalContext.Root+"prefab/EquipCopy/EquipCopyAttrAdd/EquipCopyAttrAddItem",cc.Prefab,function(t){for(var i=0;i<e._attrList.length;i++){var n=r.default.getNodeByUrl(t,s.GlobalContext.Root+"prefab/EquipCopy/EquipCopyAttrAdd/EquipCopyAttrAddItem");e.layerContent.addChild(n),n.getComponent(a.default).onInitData(e._level,i,e._attrList[i])}},this))},__decorate([p(cc.Label)],t.prototype,"labelTitle",void 0),__decorate([p(cc.Node)],t.prototype,"layerContent",void 0),t=__decorate([d],t)}(n.default);i.default=h,cc._RF.pop()},{"../../../Core/LoadManager":"LoadManager","../../../Core/Widget":"Widget","../../../GlobalContext":"GlobalContext","../../../Util/Utils":"Utils","../EquipCopyController":"EquipCopyController","./EquipCopyAttrAddItem":"EquipCopyAttrAddItem"}],EquipCopyAttrPage:[function(e,t,i){"use strict";cc._RF.push(t,"9a702ImqpRI1b74kxGJGRQh","EquipCopyAttrPage"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Core/WindowType"),a=e("../../../Core/Language"),r=e("../EquipCopyController"),s=e("./EquipCopyAttrSelect"),l=e("../../../Core/GameEventDispatcher"),c=e("../EquipCopyEvent"),d=e("../../../Core/WindowManager"),p=e("../../Tips/OpTipsController"),h=e("../../../Util/Utils"),u=e("../../../GlobalContext"),f=e("../../../Core/LoadManager"),g=e("../../Tips/TipsWinController"),y=cc._decorator,m=y.ccclass,C=y.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layerContent=null,t.labelUseCount=null,t.labelNextTips=null,t._selectList=[],t._config=null,t._remainStar=0,t._shopItemList=[],t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.show=function(){e.prototype.show.call(this),l.GameEventDispatcher.instance.on(c.EquipCopyEvent.EquipCopyAttrSelect,this.onSelectAttr,this)},t.prototype.hide=function(){e.prototype.hide.call(this),l.GameEventDispatcher.instance.off(c.EquipCopyEvent.EquipCopyAttrSelect,this.onSelectAttr,this)},t.prototype.onInitData=function(e){this._config=e,this._shopItemList=r.default.instance.getAttrShopItemList(),this.onShowPage()},t.prototype.onShowPage=function(){var e=this;this._selectList=[],h.default.setNodeChildDestoryByUrl(this.layerContent,u.GlobalContext.Root+"prefab/EquipCopy/EquipCopyAttr/EquipCopyAttrSelect"),f.default.instance.loadResByType(u.GlobalContext.Root+"prefab/EquipCopy/EquipCopyAttr/EquipCopyAttrSelect",cc.Prefab,function(t){for(var i=0;i<e._shopItemList.length;i++){var n=h.default.getNodeByUrl(t,u.GlobalContext.Root+"prefab/EquipCopy/EquipCopyAttr/EquipCopyAttrSelect");e.layerContent.addChild(n),n.getComponent(s.default).onInitData(e._shopItemList[i],i,r.default.instance.getUserStarCount)}e.labelNextTips.string=a.default.getStr("equipcopy_next_tips",r.default.instance.getLevelCondition.condition),e.labelUseCount.string=r.default.instance.getUserStarCount+"",e._remainStar=r.default.instance.getUserStarCount},this)},t.prototype.onSelectAttr=function(e){for(var t=e.detail,i=!0,n=0;n<this._selectList.length;n++)if(this._selectList[n]==t.index){t.isPush||this._selectList.splice(n,1),i=!1;break}t.isPush&&i&&this._selectList.push(t.index),t.isPush?this._remainStar-=r.default.instance.getEquipCopyConfig.buyAttrNeedStar[t.index]:this._remainStar+=r.default.instance.getEquipCopyConfig.buyAttrNeedStar[t.index],l.GameEventDispatcher.instance.emit(c.EquipCopyEvent.EquipCopyRemainStar,this._remainStar),this.labelUseCount.string=this._remainStar+""},t.prototype.onSendCmdBuy=function(){this._selectList=this._selectList.sort(),this._selectList.length>0&&!r.default.instance.checkStarCanBuy(this._selectList)?p.default.instance.ShowMsg(a.default.getStr("equipcopy_buy_attr_error")):(d.default.instance.close(o.WindowType.EquipCopyAttrShop),r.default.instance.sendCmdBuyAttr(this._selectList))},t.prototype.onClickBG=function(){var e=this;this._selectList.length<1?g.default.instance.ShowTips(a.default.getStr("equipcopy_attr_buy_tips",r.default.instance.getUserStarCount),function(){e.onSendCmdBuy()},this,null,1):this.onSendCmdBuy()},t.instance=null,__decorate([C(cc.Node)],t.prototype,"layerContent",void 0),__decorate([C(cc.Label)],t.prototype,"labelUseCount",void 0),__decorate([C(cc.Label)],t.prototype,"labelNextTips",void 0),t=i=__decorate([m],t)}(n.default);i.default=v,cc._RF.pop()},{"../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Core/LoadManager":"LoadManager","../../../Core/Widget":"Widget","../../../Core/WindowManager":"WindowManager","../../../Core/WindowType":"WindowType","../../../GlobalContext":"GlobalContext","../../../Util/Utils":"Utils","../../Tips/OpTipsController":"OpTipsController","../../Tips/TipsWinController":"TipsWinController","../EquipCopyController":"EquipCopyController","../EquipCopyEvent":"EquipCopyEvent","./EquipCopyAttrSelect":"EquipCopyAttrSelect"}],EquipCopyAttrRightItem:[function(e,t,i){"use strict";cc._RF.push(t,"6d681BfoZpEp7KGSxKq8kEB","EquipCopyAttrRightItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Core/Language"),a=e("../../../Util/AttrUtil"),r=cc._decorator,s=r.ccclass,l=r.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.labelName=null,t.labelDesc=null,t}return __extends(t,e),t.prototype.onInitData=function(e,t,i){void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=0),this.labelName.string=a.default.getAttrName(e),t>0?this.labelDesc.string=o.default.getStr("equipcopy_attr_add_percent",t/100):i>0&&(this.labelDesc.string=o.default.getStr("equipcopy_attr_add_value",i))},__decorate([l(cc.Label)],t.prototype,"labelName",void 0),__decorate([l(cc.Label)],t.prototype,"labelDesc",void 0),t=__decorate([s],t)}(n.default);i.default=c,cc._RF.pop()},{"../../../Core/Language":"Language","../../../Core/Widget":"Widget","../../../Util/AttrUtil":"AttrUtil"}],EquipCopyAttrSelect:[function(e,t,i){"use strict";cc._RF.push(t,"608d5rYOFpOm7TlhePAFdkk","EquipCopyAttrSelect"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../Commons/Image"),a=e("../../../Core/Language"),r=e("../../../Util/GrayEffect"),s=e("../../../Core/GameEventDispatcher"),l=e("../EquipCopyEvent"),c=e("../EquipCopyController"),d=e("../../../GlobalContext"),p=e("../../../Util/AttrUtil"),h=cc._decorator,u=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layerContent=null,t.layerSelect=null,t.spriteBG=null,t.spriteIcon=null,t.labelEffectDesc=null,t.labelCostCount=null,t._isSelect=!1,t._index=1,t._iconQZ=1e3,t._remainStar=0,t._shopItemData=null,t}return __extends(t,e),t.prototype.onInitData=function(e,t,i){this._shopItemData=e,this._index=t,this._remainStar=i,this.onShowPage()},t.prototype.show=function(){e.prototype.show.call(this),s.GameEventDispatcher.instance.on(l.EquipCopyEvent.EquipCopyRemainStar,this.onSetRemainStar,this)},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),s.GameEventDispatcher.instance.off(l.EquipCopyEvent.EquipCopyRemainStar,this.onSetRemainStar,this)},t.prototype.onSetRemainStar=function(e){this._remainStar=Number(e.detail)},t.prototype.onShowPage=function(){var e="";switch(this._shopItemData.attrBGType){case 1:e=d.GlobalContext.ResRoot+"resources/equipcopy/attribute/bg_shuxindi.png";break;case 2:e=d.GlobalContext.ResRoot+"resources/equipcopy/attribute/bg_shuxindi2.png";break;case 3:e=d.GlobalContext.ResRoot+"resources/equipcopy/attribute/bg_shuxindi3.png";break;default:e=d.GlobalContext.ResRoot+"resources/equipcopy/attribute/bg_shuxindi.png"}this.spriteBG.loadImageByHttps(e);var t=p.default.getAttrName(this._shopItemData.attrType)+":";this._shopItemData.attrPercent>0?t+=a.default.getStr("equipcopy_attr_add_percent",c.default.instance.getEquipCopyConfig.attrValue[this._index]/100):t+=a.default.getStr("equipcopy_attr_add_value",this._shopItemData.attrValue),this.labelEffectDesc.string=t,this.labelCostCount.string=c.default.instance.getEquipCopyConfig.buyAttrNeedStar[this._index]+"",this._shopItemData.attrIcon&&this._shopItemData.attrIcon.length>0?this.spriteIcon.getComponent(o.default).loadSpriteAtlas(d.GlobalContext.Root+"ui/equipcopy/iconattr/IconAttr",this._shopItemData.attrIcon):this.spriteIcon.getComponent(o.default).loadSpriteAtlas(d.GlobalContext.Root+"ui/equipcopy/iconattr/IconAttr","EquipCopy_Attr_"+(this._iconQZ+Number(this._shopItemData.attrType)))},t.prototype.onClick=function(){if(this._isSelect||c.default.instance.onCheckCanSelecAttr(this._remainStar,c.default.instance.getEquipCopyConfig.buyAttrNeedStar[this._index],!0)){if(this._isSelect=!this._isSelect,this.layerSelect.active=this._isSelect,this.layerContent.getComponent(r.default))this.layerContent.getComponent(r.default).setGray(this._isSelect);else if(this._isSelect){this.layerContent.addComponent(r.default).setGray(this._isSelect)}s.GameEventDispatcher.instance.emit(l.EquipCopyEvent.EquipCopyAttrSelect,{index:this._index,isPush:this._isSelect,needStar:this._shopItemData.attrNeedStar})}},__decorate([f(cc.Node)],t.prototype,"layerContent",void 0),__decorate([f(cc.Node)],t.prototype,"layerSelect",void 0),__decorate([f(o.default)],t.prototype,"spriteBG",void 0),__decorate([f(cc.Node)],t.prototype,"spriteIcon",void 0),__decorate([f(cc.Label)],t.prototype,"labelEffectDesc",void 0),__decorate([f(cc.Label)],t.prototype,"labelCostCount",void 0),t=__decorate([u],t)}(n.default);i.default=g,cc._RF.pop()},{"../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Core/Widget":"Widget","../../../GlobalContext":"GlobalContext","../../../Util/AttrUtil":"AttrUtil","../../../Util/GrayEffect":"GrayEffect","../../Commons/Image":"Image","../EquipCopyController":"EquipCopyController","../EquipCopyEvent":"EquipCopyEvent"}],EquipCopyBoxItem:[function(e,t,i){"use strict";cc._RF.push(t,"ddae9YH48VMpqE4LAm3wUjB","EquipCopyBoxItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../EquipCopyController"),a=e("../../../Core/Language"),r=cc._decorator,s=r.ccclass,l=r.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.labelTitle=null,t.labelDesc=null,t}return __extends(t,e),t.prototype.onInitData=function(e,t,i){var n=o.default.instance.getLevelConfig(e);n&&(this.labelTitle.string=n.levelName+""),this.labelDesc.string=a.default.getStr("equipcopy_wipe_box_open_value",t,i)},__decorate([l(cc.Label)],t.prototype,"labelTitle",void 0),__decorate([l(cc.Label)],t.prototype,"labelDesc",void 0),t=__decorate([s],t)}(n.default);i.default=c,cc._RF.pop()},{"../../../Core/Language":"Language","../../../Core/Widget":"Widget","../EquipCopyController":"EquipCopyController"}],EquipCopyBoxListPage:[function(e,t,i){"use strict";cc._RF.push(t,"00bffyEts1N/Jh7i/BCuMk2","EquipCopyBoxListPage"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Commons/CommonPageBG"),o=e("../../../Core/Language"),a=e("../../../Core/GameEventDispatcher"),r=e("../EquipCopyEvent"),s=e("../EquipCopyController"),l=e("../../../Core/WindowManager"),c=e("../../../Core/WindowType"),d=e("./EquipCopyBoxItem"),p=e("../../../Util/RechargeUtils"),h=e("../../../Util/Utils"),u=e("../../../GlobalContext"),f=e("../../../Core/LoadManager"),g=e("../../../Util/RechargeConst"),y=e("../../Tips/TipsWinController"),m=cc._decorator,C=m.ccclass,v=m.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layerContent=null,t.labelCost=[],t._openValue=0,t._openBoxCount=0,t._boxList=[],t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this,this._openValue=s.default.instance.getEquipCopyConfig.freeOpenBoxCount,this._openBoxCount=s.default.instance.maxOpenBoxCount,this.onInit(891,553,o.default.getStr("equipcopy_box_title"),!0)},t.prototype.show=function(){e.prototype.show.call(this),s.default.instance.onOpenWipeBoxReward(!0),a.GameEventDispatcher.instance.on(r.EquipCopyEvent.EquipCopyInfo,this.onMainInfo,this)},t.prototype.onClose=function(){s.default.instance.sendCmdOpenWipeBox(0),l.default.instance.close(c.WindowType.EquipCopyWipeBox),a.GameEventDispatcher.instance.off(r.EquipCopyEvent.EquipCopyInfo,this.onMainInfo,this)},t.prototype.onInitData=function(){this._boxList=s.default.instance.equipData.equipCopyMainData.canSweepBoxList,this._boxList.length>0?this.onShowPage():this.onClose(),this.labelCost[0].string=s.default.instance.getOpenBoxCost(this._boxList,this._openBoxCount-this._openValue-1,!0)+"",this.labelCost[1].string=s.default.instance.getOpenBoxCost(this._boxList,this._openBoxCount-this._openValue,!0)+""},t.prototype.onMainInfo=function(){s.default.instance.onOpenWipeBoxReward(!0),this.onInitData()},t.prototype.onShowPage=function(){var e=this;h.default.setNodeChildDestoryByUrl(this.layerContent,u.GlobalContext.Root+"prefab/EquipCopy/EquipCopyBox/EquipCopyBoxItem"),f.default.instance.loadResByType(u.GlobalContext.Root+"prefab/EquipCopy/EquipCopyBox/EquipCopyBoxItem",cc.Prefab,function(t){for(var i=0;i<e._boxList.length;i++){var n=h.default.getNodeByUrl(t,u.GlobalContext.Root+"prefab/EquipCopy/EquipCopyBox/EquipCopyBoxItem");n.getComponent(d.default).onInitData(e._boxList[i],e._openValue,e._openBoxCount),e.layerContent.addChild(n)}},this)},t.prototype.onOpenTips=function(e){var t=this;y.default.instance.ShowTips(o.default.getStr("equipcopy_box_open_tips_2",s.default.instance.getOpenBoxCost(this._boxList,e,!0),e),function(){t.onOpenBox(e)},this,null,1)},t.prototype.onOpenBox=function(e){var t=s.default.instance.getOpenBoxCost(this._boxList,e,!0);p.default.PurchaseItemOrRechage(g.RechargeTypeConst.Diamonds,t,function(){s.default.instance.sendCmdOpenWipeBox(e)},this)},t.prototype.onClickOpenOne=function(){var e=this._openBoxCount-this._openValue-1;this.onOpenTips(e)},t.prototype.onClickOpenTwo=function(){var e=this._openBoxCount-this._openValue;this.onOpenTips(e)},t.instance=null,__decorate([v(cc.Node)],t.prototype,"layerContent",void 0),__decorate([v(cc.Label)],t.prototype,"labelCost",void 0),t=i=__decorate([C],t)}(n.default);i.default=_,cc._RF.pop()},{"../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Core/LoadManager":"LoadManager","../../../Core/WindowManager":"WindowManager","../../../Core/WindowType":"WindowType","../../../GlobalContext":"GlobalContext","../../../Util/RechargeConst":"RechargeConst","../../../Util/RechargeUtils":"RechargeUtils","../../../Util/Utils":"Utils","../../Commons/CommonPageBG":"CommonPageBG","../../Tips/TipsWinController":"TipsWinController","../EquipCopyController":"EquipCopyController","../EquipCopyEvent":"EquipCopyEvent","./EquipCopyBoxItem":"EquipCopyBoxItem"}],EquipCopyBoxPage:[function(e,t,i){"use strict";cc._RF.push(t,"ad8a2rDr9hMSaBwWrw08Cmx","EquipCopyBoxPage"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Commons/CommonPageBG"),o=e("../../../Core/Language"),a=e("../../../Core/WindowManager"),r=e("../../../Core/WindowType"),s=e("../EquipCopyController"),l=e("../../Commons/RewardUtils"),c=e("../../../Util/Utils"),d=e("../../Item/ItemIcon"),p=e("../../../Core/GameEventDispatcher"),h=e("../EquipCopyEvent"),u=e("../../../Util/RechargeUtils"),f=e("../../../Core/LoadManager"),g=e("../../../GlobalContext"),y=e("../../../Util/RechargeConst"),m=e("../../Tips/TipsWinController"),C=cc._decorator,v=C.ccclass,_=C.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layerContent=null,t.labelRemainCount=null,t.labelCostCount=null,t.layerCost=[],t._nodeData=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this,this.onInit(758,413,o.default.getStr("equipcopy_box_title"),!0)},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),this.onClearItem(),p.GameEventDispatcher.instance.off(h.EquipCopyEvent.EquipCopyInfo,this.onShowPage,this)},t.prototype.onClose=function(){s.default.instance.sendCmdOpenBox(!1),a.default.instance.close(r.WindowType.EquipCopyBox)},t.prototype.onInitData=function(e){this._nodeData=e,p.GameEventDispatcher.instance.on(h.EquipCopyEvent.EquipCopyInfo,this.onShowPage,this),this.onShowPage(),this.onShowItem()},t.prototype.onShowItem=function(){var e=this;this.onClearItem(),this._nodeData.boxReward>0&&f.default.instance.loadResByType(g.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(t){var i=l.default.instance.getItemList(e._nodeData.boxReward);for(var n in i){var o=c.default.getNodeByPool(r.PoolType.ItemIcon,t,g.GlobalContext.Root+"prefab/Bag/ItemIcon");e.layerContent.addChild(o),o.getComponent(d.default).ItemData(i[n],!0),o.setScale(.8)}},this)},t.prototype.onShowPage=function(){this.labelRemainCount.string=o.default.getStr("equipcopy_box_remain_open_count",s.default.instance.getBoxRemainOPenCount),this.labelCostCount.string=s.default.instance.getOpenBoxCost([1])+"",s.default.instance.onCheckCanFreeOpenBox?(s.default.instance.sendCmdOpenBox(!0),c.default.setNodeActive([this.layerCost[0]],[this.layerCost[1]])):c.default.setNodeActive([this.layerCost[1]],[this.layerCost[0]])},t.prototype.onClickOpen=function(){var e=this;m.default.instance.ShowTips(o.default.getStr("equipcopy_box_open_tips",s.default.instance.getOpenBoxCost([1])),function(){e.onOpenBox()},this,null,1)},t.prototype.onOpenBox=function(){var e=this;u.default.PurchaseItemOrRechage(y.RechargeTypeConst.Diamonds,s.default.instance.getOpenBoxCost([1]),function(){e.onSendOpenBox()},this)},t.prototype.onSendOpenBox=function(){s.default.instance.sendCmdOpenBox(!0),s.default.instance.getBoxRemainOPenCount<=1&&a.default.instance.close(r.WindowType.EquipCopyBox)},t.prototype.onClearItem=function(){for(var e=this.layerContent.childrenCount-1;e>=0;e--)c.default.setNodeToPool(r.PoolType.ItemIcon,this.layerContent.children[e]);this.layerContent.removeAllChildren()},t.instance=null,__decorate([_(cc.Node)],t.prototype,"layerContent",void 0),__decorate([_(cc.Label)],t.prototype,"labelRemainCount",void 0),__decorate([_(cc.Label)],t.prototype,"labelCostCount",void 0),__decorate([_(cc.Node)],t.prototype,"layerCost",void 0),t=i=__decorate([v],t)}(n.default);i.default=b,cc._RF.pop()},{"../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Core/LoadManager":"LoadManager","../../../Core/WindowManager":"WindowManager","../../../Core/WindowType":"WindowType","../../../GlobalContext":"GlobalContext","../../../Util/RechargeConst":"RechargeConst","../../../Util/RechargeUtils":"RechargeUtils","../../../Util/Utils":"Utils","../../Commons/CommonPageBG":"CommonPageBG","../../Commons/RewardUtils":"RewardUtils","../../Item/ItemIcon":"ItemIcon","../../Tips/TipsWinController":"TipsWinController","../EquipCopyController":"EquipCopyController","../EquipCopyEvent":"EquipCopyEvent"}],EquipCopyController:[function(e,t,i){"use strict";cc._RF.push(t,"3e9c7vdfAlFcJ7Iv7T2qfxR","EquipCopyController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../Core/ConfigsManager"),a=e("../../NetConnect/NetConnet"),r=e("./EquipCopyData/EquipCopyData"),s=e("../../Core/GameEventDispatcher"),l=e("./EquipCopyEvent"),c=e("../OpenWin/OpenWinController"),d=e("../../Core/WindowType"),p=e("../Tips/RewardTips"),h=e("./EquipCopyWipe/EquipCopyWipeResult"),u=e("./EquipCopyAttrAdd/EquipCopyAttrAddPage"),f=e("./EquipCopyBox/EquipCopyBoxListPage"),g=e("../Tips/OpTipsController"),y=e("../../Core/Language"),m=e("../../Core/Event"),C=e("../Status/StatusType"),v=e("../../Global/GlobalValue"),_=e("../Scene/Controller/FightTimeController"),b=e("../Functionicon/FunctionIconController"),T=cc._decorator,S=T.ccclass,I=(T.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._config=null,t._equipCopyData=new r.default,t._enterFightTime=0,t._wipeBoxReward=[],t._wipeFightResultReward=[],t._isWipe=!1,t._isOpenBox=!1,t._star=1,t._type=0,t._fightTime=0,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this,this._config=o.ConfigsManager.instance.getConfigs("equipfbconf")},t.prototype.listNotification=function(){this.addProto("equipfbinfo",this.onEquipCopyMainData,this)},t.prototype.sendCmdEquipCopyMain=function(){a.default.instance.sendProto({cmd:"equipfbinfo"})},t.prototype.sendCmdOpenBox=function(e){void 0===e&&(e=!0);var t={cmd:"equipfbopenbox",buy:e};a.default.instance.sendProto(t)},t.prototype.sendCmdBuyAttr=function(e){void 0===e&&(e=[]);var t={cmd:"equipfbshop",selection:e};a.default.instance.sendProto(t)},t.prototype.sendCmdWipe=function(e){this._isWipe=!0;var t={cmd:"equipfbsweep",type:e};a.default.instance.sendProto(t)},t.prototype.sendCmdOpenWipeBox=function(e){e>0&&(this._isOpenBox=!0);var t={cmd:"equipfbsweepbox",times:e};a.default.instance.sendProto(t)},t.prototype.sendCmdWipeShop=function(e){void 0===e&&(e=[]);var t={cmd:"equipfbsweepshop",selection:e};a.default.instance.sendProto(t)},t.prototype.sendCmdBuyChallenge=function(){a.default.instance.sendProto({cmd:"equipfbbuychallenge"})},t.prototype.sendCmdReset=function(){a.default.instance.sendProto({cmd:"equipfbreset"})},t.prototype.sendCmdInToFight=function(e,t){this.setStar=e,s.GameEventDispatcher.instance.emit(m.EventDefiner.ChangeActivityStatus,C.ActivityStatus.EquipCopy),s.GameEventDispatcher.instance.emit(m.EventDefiner.ChangeGameScene,{status:v.GameScene.Fight,guanqiaId:t})},t.prototype.onEquipCopyMainData=function(e){var t=this;this._isWipe&&this._equipCopyData.equipCopyMainData.currentLevel!=e.current&&(this._isWipe=!1,c.default.instance.openWindow(d.WindowType.EquipCopyWipeResult,function(){h.default.instance.onInitData(t._type)},this)),this._equipCopyData.onInitMainData(e),s.GameEventDispatcher.instance.emit(l.EquipCopyEvent.EquipCopyInfo),s.GameEventDispatcher.instance.emit(m.EventDefiner.ActivityCopyUpdateRed)},Object.defineProperty(t.prototype,"equipData",{get:function(){return this._equipCopyData},enumerable:!0,configurable:!0}),t.prototype.getLevelConfig=function(e){return this._config&&this._config.mission&&this._config.mission[e]?this._config.mission[e]:null},t.prototype.checkIsFirst=function(){return!(this._equipCopyData&&this._equipCopyData.equipCopyMainData&&this._equipCopyData.equipCopyMainData.maxLevel>=this._equipCopyData.equipCopyMainData.currentLevel)},Object.defineProperty(t.prototype,"getLevelCondition",{get:function(){var e=this.equipData.equipCopyMainData.currentLevel;return this._config&&this._config.condition&&this._config.condition[e]?this._config.condition[e]:null},enumerable:!0,configurable:!0}),t.prototype.getAttrShopItem=function(e){return this.getAttrDataByConfig(e)},t.prototype.getAttrShopItemList=function(){return this._equipCopyData.equipCopyAttrShopData},t.prototype.checkStarCanBuy=function(e){return void 0===e&&(e=[]),!(this.getSelectAttrNeedStar(e)>this.getUserStarCount)},t.prototype.getSelectAttrNeedStar=function(e){void 0===e&&(e=[]);for(var t=0,i=0;i<e.length;i++)this.getAttrShopItemList()[e[i]]&&(t+=this.getAttrShopItemList()[e[i]].attrNeedStar);return t},t.prototype.onCheckCanSelecAttr=function(e,t,i){return void 0===i&&(i=!0),!(t>e)||(i&&g.default.instance.ShowMsg(y.default.getStr("equipcopy_buy_attr_error_1")),!1)},t.prototype.havefreeResetCount=function(){var e=b.default.instance.checkIsOpenbyWindowtype(d.WindowType.EquipCopyMain);return!!(i.instance.equipData.equipCopyMainData.freeResetCount>0&&e)},Object.defineProperty(t.prototype,"getUserStarCount",{get:function(){return this._equipCopyData.equipCopyMainData.starCount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxOpenBoxCount",{get:function(){return i.instance.getEquipCopyConfig.openBoxConsume.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"getBoxRemainOPenCount",{get:function(){var e=this.maxOpenBoxCount-this._equipCopyData.equipCopyMainData.openBoxCount;return e>=0?e:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"getEquipCopyConfig",{get:function(){return this._config.EquipFbConf[1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"getResetConfition",{get:function(){var e=[0,0];if(this.canReset&&this.equipData.equipCopyMainData.freeResetCount<1){var t=Number(this.equipData.equipCopyMainData.buyResetCount)+Number(this.getEquipCopyConfig.dailyFreeReset);this.getEquipCopyConfig.resetDiamond[t]>0&&(e[0]=this.getEquipCopyConfig.resetDiamond[t]),this.getEquipCopyConfig.resetCondition[t]>0&&(e[1]=this.getEquipCopyConfig.resetCondition[t])}return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canReset",{get:function(){return this.equipData.equipCopyMainData.buyResetCount<this.getEquipCopyConfig.resetCondition.length-1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"getRemainResetCount",{get:function(){if(this.getEquipCopyConfig.resetCondition){var e=this.getEquipCopyConfig.resetCondition.length;return this.equipData.equipCopyMainData.freeResetCount<1&&(e-=1),(e-=this.equipData.equipCopyMainData.buyResetCount)>=0?e:0}return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canWipe",{get:function(){return this.equipData.equipCopyMainData.currentLevel<=this.equipData.equipCopyMainData.sweepLevel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"getAddFightCost",{get:function(){return this.getEquipCopyConfig.dailyPaidChallenge.length>this.equipData.equipCopyMainData.buyChallengeCount?this.getEquipCopyConfig.dailyPaidChallenge[this.equipData.equipCopyMainData.buyChallengeCount]:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canAddFightCount",{get:function(){return this.getEquipCopyConfig.dailyPaidChallenge.length>this.equipData.equipCopyMainData.buyChallengeCount},enumerable:!0,configurable:!0}),t.prototype.getAttrDataByConfig=function(e){return this._config&&this._config.attrShop&&this._config.attrShop[e]?this._config.attrShop[e]:null},Object.defineProperty(t.prototype,"onCheckCanFreeOpenBox",{get:function(){return this.equipData.equipCopyMainData.openBoxCount<this.getEquipCopyConfig.freeOpenBoxCount},enumerable:!0,configurable:!0}),t.prototype.getOpenBoxCost=function(e,t,n){void 0===e&&(e=[]),void 0===t&&(t=1),void 0===n&&(n=!1);var o,a=this.getOpenBoxMaxCount();return n?(o=i.instance.getEquipCopyConfig.openBoxConsume[a-this.getEquipCopyConfig.freeOpenBoxCount-1],2==t&&(o+=i.instance.getEquipCopyConfig.openBoxConsume[a-this.getEquipCopyConfig.freeOpenBoxCount])):o=i.instance.getEquipCopyConfig.openBoxConsume[this.equipData.equipCopyMainData.openBoxCount],o*e.length},t.prototype.getOpenBoxMaxCount=function(){return i.instance.getEquipCopyConfig.openBoxConsume.length},t.prototype.setEnterFightTime=function(){var e=this;this._fightTime=0,_.default.instance.setInterval("setEnterFightTime",function(t){e._fightTime+=300},this,300)},t.prototype.onCheckFightResult=function(e){return _.default.instance.clearInterval("setEnterFightTime"),this._fightTime<1e3*e},Object.defineProperty(t.prototype,"wipeBoxReward",{set:function(e){this._wipeBoxReward=e},enumerable:!0,configurable:!0}),t.prototype.onOpenWipeBoxReward=function(e){if(void 0===e&&(e=!1),this._isOpenBox||e){this._isOpenBox=!1;var t=this._wipeBoxReward.concat();t.length>0&&(c.default.instance.openWindow(d.WindowType.RewardTips,function(){p.default.instance.setData(t)},this),this._wipeBoxReward=[])}},Object.defineProperty(t.prototype,"wipeFightResultReward",{get:function(){return this._wipeFightResultReward},set:function(e){this._wipeFightResultReward=e,s.GameEventDispatcher.instance.emit(l.EquipCopyEvent.EquipCopyWipeReward)},enumerable:!0,configurable:!0}),t.prototype.onClickNextToBoxList=function(){return!(this.equipData.equipCopyMainData.canSweepBoxList&&this.equipData.equipCopyMainData.canSweepBoxList.length>0)||(c.default.instance.openWindow(d.WindowType.EquipCopyWipeBox,function(){f.default.instance.onInitData()},this),!1)},t.prototype.onClickNextToAttr=function(){return!(this.equipData.equipCopyMainData.canSweepShopLevelList&&this.equipData.equipCopyMainData.canSweepShopLevelList.length>0)||(c.default.instance.openWindow(d.WindowType.EquipCopyWipeAttr,function(){u.default.instance.onInitData()},this),!1)},Object.defineProperty(t.prototype,"remainChallengeCount",{get:function(){return this._equipCopyData.equipCopyMainData.challengeCount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"setStar",{set:function(e){this._star=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"getStar",{get:function(){return this._star},enumerable:!0,configurable:!0}),t.instance=null,t=i=__decorate([S],t)}(n.default));i.default=I,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../NetConnect/NetConnet":"NetConnet","../Functionicon/FunctionIconController":"FunctionIconController","../OpenWin/OpenWinController":"OpenWinController","../Scene/Controller/FightTimeController":"FightTimeController","../Status/StatusType":"StatusType","../Tips/OpTipsController":"OpTipsController","../Tips/RewardTips":"RewardTips","./EquipCopyAttrAdd/EquipCopyAttrAddPage":"EquipCopyAttrAddPage","./EquipCopyBox/EquipCopyBoxListPage":"EquipCopyBoxListPage","./EquipCopyData/EquipCopyData":"EquipCopyData","./EquipCopyEvent":"EquipCopyEvent","./EquipCopyWipe/EquipCopyWipeResult":"EquipCopyWipeResult"}],EquipCopyData:[function(e,t,i){"use strict";cc._RF.push(t,"7d03aG3qihMW4lU4jzA/hps","EquipCopyData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./EquipCopyMainData"),o=e("./EquipCopyShopItemData"),a=e("./EquipCopyWipeBuyAttr"),r=e("./EquipCopyWipeShopLevel"),s=e("./EquipCopyAttrItem"),l=e("../EquipCopyController"),c=e("./EquipCopyAttrData"),d=cc._decorator,p=d.ccclass,h=(d.property,function(){function e(){this._equipMainData=new n.default,this._equipAttrShopItemList=[],this._equipWipeAttrShopItemList=[],this._selectWipeShop=[],this._selectAttrNeedStar=0}return e.prototype.onInitMainData=function(e){this._equipMainData.onInitData(e),this.onInitShopItemList(this._equipMainData.attrShopList),this.onInitWipeShopItemList(this._equipMainData.sweepAttrShopIndex,this._equipMainData.canSweepShopLevelList),this.onInitRightAttr(this._equipMainData.attrList)},Object.defineProperty(e.prototype,"equipCopyMainData",{get:function(){return this._equipMainData},enumerable:!0,configurable:!0}),e.prototype.onInitRightAttr=function(e){this._ownAttr=new c.default,this._ownAttr.onInitData(e)},Object.defineProperty(e.prototype,"equipCopyOwnAttr",{get:function(){return this._ownAttr},enumerable:!0,configurable:!0}),e.prototype.onInitShopItemList=function(e){void 0===e&&(e=[]),this._equipAttrShopItemList=[];for(var t=0;t<e.length;t++){var i=new o.default;i.onInitData(e[t]),this._equipAttrShopItemList.push(i)}},Object.defineProperty(e.prototype,"equipCopyAttrShopData",{get:function(){return this._equipAttrShopItemList},enumerable:!0,configurable:!0}),e.prototype.onInitWipeShopItemList=function(e,t){if(void 0===e&&(e=[]),void 0===t&&(t=[]),e.length==t.length){this._equipWipeAttrShopItemList=[];for(var i=0;i<e.length;i++){var n=e[i],a=new r.default;a.onInitData(t[i]);for(var s=0;s<n.length;s++){var l=new o.default;l.onInitData(n[s]),a.onPushData(l)}this._equipWipeAttrShopItemList.push(a)}}},Object.defineProperty(e.prototype,"equipCopyWipeShopData",{get:function(){return this._equipWipeAttrShopItemList},enumerable:!0,configurable:!0}),e.prototype.getLevelShopList=function(e){if(this.equipCopyWipeShopData)for(var t in this.equipCopyWipeShopData)if(this.equipCopyWipeShopData[t].shopLevel==e)return this.equipCopyWipeShopData[t];return null},Object.defineProperty(e.prototype,"selectWipeIndexList",{get:function(){return this._selectWipeShop},set:function(e){this._selectWipeShop=e},enumerable:!0,configurable:!0}),e.prototype.onPushWipeSelectShop=function(e,t){var i=!0;for(var n in this._selectWipeShop)if(e==this._selectWipeShop[n].shopLevel){this._selectWipeShop[n].onPush(t),i=!1;break}if(i){var o=new a.default;o.onInitData(e),o.onPush(t),this._selectWipeShop[e]=o}},Object.defineProperty(e.prototype,"wipeSelectShopDataList",{get:function(){var e=[];for(var t in this._selectWipeShop)if(this._selectWipeShop[t].attrIndexList.length>0){for(var i=this._selectWipeShop[t].attrIndexList,n=[],a=0;a<this._equipMainData.canSweepShopLevelList.length;a++)if(this._selectWipeShop[t].shopLevel==this._equipMainData.canSweepShopLevelList[a]){n=this._equipMainData.sweepAttrShopIndex[a];break}for(a=0;a<i.length;a++)if(n.length>i[a]){var r=new o.default;r.onInitData(n[i[a]]),r.index=i[a],e.push(r)}}return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectAttrNeedStart",{get:function(){return this._selectAttrNeedStar},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectWipeAttrList",{get:function(){this._selectAttrNeedStar=0;var e=[];if(this.wipeSelectShopDataList)for(var t=this.wipeSelectShopDataList.concat(),i=0;i<t.length;i++){var n=!0;this._selectAttrNeedStar+=l.default.instance.getEquipCopyConfig.buyAttrNeedStar[t[i].index];for(var o=0;o<e.length;o++)if(e[o].attrType==t[i].attrType){t[i].attrPercent>0&&e[o].addPercent(t[i].attrPercent),t[i].attrValue>0&&e[o].addPercent(t[i].attrValue),n=!1;break}if(n){var a=new s.default;a.attrType=t[i].attrType,a.attrPercent=l.default.instance.getEquipCopyConfig.attrValue[t[i].index]?l.default.instance.getEquipCopyConfig.attrValue[t[i].index]:0,a.attrValue=t[i].attrValue?t[i].attrValue:0,e.push(a)}}return e},enumerable:!0,configurable:!0}),e.prototype.onInitWipeAttrSelect=function(){this._selectAttrNeedStar=0,this._selectWipeShop=[]},e=__decorate([p],e)}());i.default=h,cc._RF.pop()},{"../EquipCopyController":"EquipCopyController","./EquipCopyAttrData":"EquipCopyAttrData","./EquipCopyAttrItem":"EquipCopyAttrItem","./EquipCopyMainData":"EquipCopyMainData","./EquipCopyShopItemData":"EquipCopyShopItemData","./EquipCopyWipeBuyAttr":"EquipCopyWipeBuyAttr","./EquipCopyWipeShopLevel":"EquipCopyWipeShopLevel"}],EquipCopyDifficultyItem:[function(e,t,i){"use strict";cc._RF.push(t,"23e516vkxlIeqoKaQ0n+4Lr","EquipCopyDifficultyItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../Commons/Image"),a=e("../../../Util/Utils"),r=e("../../../Core/WindowType"),s=e("../../Item/ItemIcon"),l=e("../EquipCopyController"),c=e("../../../Core/WindowManager"),d=e("../../Tips/OpTipsController"),p=e("../../../Core/Language"),h=e("../../../GlobalContext"),u=e("../../../Core/LoadManager"),f=cc._decorator,g=f.ccclass,y=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.spriteBG=null,t.spriteItemIcon=null,t.spriteDebrisItemIcon=null,t.jiandan=null,t.putong=null,t.kunnan=null,t._reward=[],t._index=0,t._debrisId=11901,t}return __extends(t,e),t.prototype.onInitData=function(e,t,i,n){void 0===n&&(n=[]),this._index=e,this._guanqia=i,this._level=t,this._reward=n,this.onShowPage()},t.prototype.onShowPage=function(){var e=this;this.jiandan.active=!1,this.putong.active=!1,this.kunnan.active=!1;var t="";switch(this._index){case 0:this.jiandan.active=!0,t="bg_jiandan";break;case 1:this.putong.active=!0,t="bg_putong";break;case 2:this.kunnan.active=!0,t="bg_kunnan"}this.spriteBG.getComponent(o.default).loadSpriteAtlas(h.GlobalContext.Root+"ui/equipcopy/difficultypic/difficulty",t),u.default.instance.loadResByType(h.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(t){for(var i in e._reward)if(e._reward[i].id==e._debrisId){e.onClearDebrisItem();var n=a.default.getNodeByPool(r.PoolType.ItemIcon,t,h.GlobalContext.Root+"prefab/Bag/ItemIcon");e.spriteDebrisItemIcon.addChild(n),n.getComponent(s.default).ItemData(e._reward[i],!0),n.setScale(.9)}else{e.onClearItem();n=a.default.getNodeByPool(r.PoolType.ItemIcon,t,h.GlobalContext.Root+"prefab/Bag/ItemIcon");e.spriteItemIcon.addChild(n),n.getComponent(s.default).ItemData(e._reward[i],!0),n.setScale(.9)}},this)},t.prototype.onClearItem=function(){this.spriteItemIcon.childrenCount>0&&a.default.setNodeToPool(r.PoolType.ItemIcon,this.spriteItemIcon.children[0]),this.spriteItemIcon.removeAllChildren()},t.prototype.onClearDebrisItem=function(){this.spriteDebrisItemIcon.childrenCount>0&&a.default.setNodeToPool(r.PoolType.ItemIcon,this.spriteDebrisItemIcon.children[0]),this.spriteDebrisItemIcon.removeAllChildren()},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),this.onClearItem()},t.prototype.onClick=function(){l.default.instance.equipData.equipCopyMainData.challengeCount>0?(l.default.instance.sendCmdInToFight(this._index+1,this._guanqia),c.default.instance.close(r.WindowType.EquipCopyDifficulty)):d.default.instance.ShowMsg(p.default.getStr("equipcopy_enter_error_1"))},__decorate([y(cc.Node)],t.prototype,"spriteBG",void 0),__decorate([y(cc.Node)],t.prototype,"spriteItemIcon",void 0),__decorate([y(cc.Node)],t.prototype,"spriteDebrisItemIcon",void 0),__decorate([y(cc.Node)],t.prototype,"jiandan",void 0),__decorate([y(cc.Node)],t.prototype,"putong",void 0),__decorate([y(cc.Node)],t.prototype,"kunnan",void 0),t=__decorate([g],t)}(n.default);i.default=m,cc._RF.pop()},{"../../../Core/Language":"Language","../../../Core/LoadManager":"LoadManager","../../../Core/Widget":"Widget","../../../Core/WindowManager":"WindowManager","../../../Core/WindowType":"WindowType","../../../GlobalContext":"GlobalContext","../../../Util/Utils":"Utils","../../Commons/Image":"Image","../../Item/ItemIcon":"ItemIcon","../../Tips/OpTipsController":"OpTipsController","../EquipCopyController":"EquipCopyController"}],EquipCopyDifficultyPage:[function(e,t,i){"use strict";cc._RF.push(t,"40c81OFnytAXK/dsdL4j0Nr","EquipCopyDifficultyPage"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../Commons/RewardUtils"),a=e("../EquipCopyController"),r=e("../../../Core/WindowManager"),s=e("../../../Core/WindowType"),l=e("../../../Util/Utils"),c=e("./EquipCopyDifficultyItem"),d=e("../../../Core/Language"),p=e("../../../GlobalContext"),h=e("../../../Core/LoadManager"),u=cc._decorator,f=u.ccclass,g=u.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layerContent=null,t.labelDesc=null,t._config=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.onInitData=function(e,t){this._config=e,this._level=t,this._config&&this._config.guanqia&&this.onShowDifficulty()},t.prototype.onShowDifficulty=function(){var e=this,t=a.default.instance.getLevelCondition;this.labelDesc.string=d.default.getStr("equipcopy_level_condition",d.default.getStr("equipcopy_condition_"+t.conditionType,t.conditionParam));var i=a.default.instance.checkIsFirst()?this._config.firstReward:this._config.passReward;l.default.setNodeChildDestoryByUrl(this.layerContent,p.GlobalContext.Root+"prefab/EquipCopy/EquipCopyDifficulty/EquipCopyDifficultyItem"),h.default.instance.loadResByType(p.GlobalContext.Root+"prefab/EquipCopy/EquipCopyDifficulty/EquipCopyDifficultyItem",cc.Prefab,function(t){for(var n=0;n<e._config.guanqia.length;n++){var a=o.default.instance.getItemList(i[n]);if(e._config.guanqia[n]>0){var r=l.default.getNodeByUrl(t,p.GlobalContext.Root+"prefab/EquipCopy/EquipCopyDifficulty/EquipCopyDifficultyItem");e.layerContent.addChild(r),r.getComponent(c.default).onInitData(n,e._level,e._config.guanqia[n],a)}}},this)},t.prototype.onClickBG=function(){r.default.instance.close(s.WindowType.EquipCopyDifficulty)},t.instance=null,__decorate([g(cc.Node)],t.prototype,"layerContent",void 0),__decorate([g(cc.RichText)],t.prototype,"labelDesc",void 0),t=i=__decorate([f],t)}(n.default);i.default=y,cc._RF.pop()},{"../../../Core/Language":"Language","../../../Core/LoadManager":"LoadManager","../../../Core/Widget":"Widget","../../../Core/WindowManager":"WindowManager","../../../Core/WindowType":"WindowType","../../../GlobalContext":"GlobalContext","../../../Util/Utils":"Utils","../../Commons/RewardUtils":"RewardUtils","../EquipCopyController":"EquipCopyController","./EquipCopyDifficultyItem":"EquipCopyDifficultyItem"}],EquipCopyEvent:[function(e,t,i){"use strict";cc._RF.push(t,"b8cffR30O1DFLeaVnPgPR4G","EquipCopyEvent"),Object.defineProperty(i,"__esModule",{value:!0}),function(e){e.EquipCopyInfo="EquipCopyInfo",e.EquipCopyAttrSelect="EquipCopyAttrSelect",e.EquipCopyWipeReward="EquipCopyWipeReward",e.EquipCopyRemainStar="EquipCopyRemainStar",e.EquipCopyWipeAttrSelect="EquipCopyWipeAttrSelect",e.EquipCopyShopItemComplete="EquipCopyShopItemComplete"}(i.EquipCopyEvent||(i.EquipCopyEvent={})),function(e){e[e.Kill_All=1]="Kill_All",e[e.Remain_Monster=2]="Remain_Monster",e[e.Remain_Time=3]="Remain_Time"}(i.EquipCopyType||(i.EquipCopyType={})),cc._RF.pop()},{}],EquipCopyMainData:[function(e,t,i){"use strict";cc._RF.push(t,"bb6f3BLg6FNl4/gTm4Siebu","EquipCopyMainData"),Object.defineProperty(i,"__esModule",{value:!0});var n=cc._decorator,o=n.ccclass,a=(n.property,function(){function e(){this._data=null}return e.prototype.onInitData=function(e){this._data=e},Object.defineProperty(e.prototype,"challengeCount",{get:function(){return this._data.challengeCnt},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buyChallengeCount",{get:function(){return this._data.buyChallengeCnt},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentLevel",{get:function(){return this._data.current},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sweepLevel",{get:function(){return this._data.sweepMax},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"freeResetCount",{get:function(){if(this._data)return this._data.resetCnt},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buyResetCount",{get:function(){return this._data.buyResetCnt},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxLevel",{get:function(){return this._data.max},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"starCount",{get:function(){return this._data.star},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canSweepShopLevelList",{get:function(){return this._data.canSweepShop},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sweepAttrShopIndex",{get:function(){return this._data.sweepAttrShop},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canSweepBoxList",{get:function(){return this._data.canSweepBox},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"openBoxCount",{get:function(){return this._data.openBoxCnt},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"attrShopList",{get:function(){return this._data.attrShop},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"attrList",{get:function(){return this._data.attr},enumerable:!0,configurable:!0}),e=__decorate([o],e)}());i.default=a,cc._RF.pop()},{}],EquipCopyNodeItem:[function(e,t,i){"use strict";cc._RF.push(t,"9ebc5cr1yxB077aLza2VJDh","EquipCopyNodeItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../Commons/Image"),a=e("../EquipCopyController"),r=e("../../../Util/Utils"),s=e("../../Chapter/GuanqiaController"),l=e("../../WarTeam/MonsterController"),c=e("../../OpenWin/OpenWinController"),d=e("../../../Core/WindowType"),p=e("../EquipCopyDifficulty/EquipCopyDifficultyPage"),h=e("../EquipCopyAttr/EquipCopyAttrPage"),u=e("../EquipCopyBox/EquipCopyBoxPage"),f=e("../../Tips/OpTipsController"),g=e("../../../Core/Language"),y=e("../../../Core/LoadManager"),m=e("../../../GlobalContext"),C=cc._decorator,v=C.ccclass,_=C.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.imageBG=null,t.imageShade=null,t.animationNode=null,t.layerContent=[],t.layerNodeItem=null,t.btnNode=null,t.labelLevel=null,t._maxBGType=4,t._contentPos=[],t._nodeItemPos=[[180,-100],[0,-45],[-80,-55],[270,-55],[150,-45]],t._shadeWH=[[1911,542],[1911,545],[1911,558],[1911,564]],t._nodeItemFirstPosScale=[[-241,-432,.95,.95,0],[175,-181,.6,.6,77],[-149,-82,.4,.4,153],[78,-150,.35,.35,179],[-78,-150,.3,.3,153]],t._nodeItemSecondPosScale=[[-200,-1250,1.3,1.3,0],[125,-432,.95,.95,0],[-175,-181,.6,.6,77],[149,-82,.4,.4,153],[-78,-150,.35,.35,153]],t._nodeItemThirthPosScale=[[0,-1500,1.5,1.5,0],[0,-1250,1.3,1.3,0],[-187,-432,.95,.95,0],[78,-181,.6,.6,77],[-149,-82,.4,.4,153]],t._shadeStartEnd=[],t._level=0,t._index=0,t._nodeDate=null,t}return __extends(t,e),t.prototype.onInitData=function(e,t){this._level=e,this._index=t,this._nodeDate=a.default.instance.getLevelConfig(this._level),this.onShowNode()},t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),this.onClearMonster()},t.prototype.onShowNode=function(){var e=this;if(this.onInitImageBG(),this._nodeDate){switch(this.layerNodeItem.active=!0,this.labelLevel.string=this._nodeDate.levelName,this._nodeDate.type){case 1:this.onShowMonster(this.layerContent[0]);break;case 2:this.onShowOtherNode(this.layerContent[1],2);break;case 3:this.onShowOtherNode(this.layerContent[2],3)}r.default.setNodeActive(this.layerContent,[this.layerContent[this._nodeDate.type-1]]),this.animationNode.active=!1,this._level==a.default.instance.equipData.equipCopyMainData.currentLevel&&(this.animationNode.active=!0,a.default.instance.equipData.equipCopyMainData.openBoxCount<1&&3==this._nodeDate.type&&a.default.instance.equipData.equipCopyMainData.canSweepBoxList&&a.default.instance.equipData.equipCopyMainData.canSweepBoxList.length<1&&a.default.instance.equipData.equipCopyMainData.canSweepShopLevelList&&a.default.instance.equipData.equipCopyMainData.canSweepShopLevelList.length<1&&(this._nodeDate?c.default.instance.openWindow(d.WindowType.EquipCopyBox,function(){u.default.instance.onInitData(e._nodeDate),console.log("\u6253\u5f00\u88c5\u5907\u526f\u672c\u5b9d\u7bb1\u754c\u9762\u6570\u636e\uff1a",e._nodeDate)},this):console.log("\u88c5\u5907\u526f\u672c\u5b9d\u7bb1\u6570\u636e\u597d\u50cf\u4e0d\u5bf9\u5594\uff1a",this._nodeDate)))}else this.layerNodeItem.active=!1},t.prototype.onCheckOpenWindow=function(){return!!a.default.instance.onClickNextToAttr()&&!!a.default.instance.onClickNextToBoxList()},t.prototype.onShowMonster=function(e){if(this.onClearMonster(),this._nodeDate.guanqia&&this._nodeDate.guanqia.length>0){var t=e.getChildByName("layerMonsterContent"),i=s.default.instance.getGuanqiaMonsters(this._nodeDate.guanqia[this._nodeDate.guanqia.length-1],1);if(i&&i.length>0){var n=i[i.length-1],o=l.default.instance.getCardGradeByGradeConf(n.cardId,n.grade);l.default.instance.infoPreview(t,cc.v2(o.monsteroffset[0]/100,o.monsteroffset[1]/100-10),n.cardId,n.grade,.8,-1,!0,null,null)}}},t.prototype.onInitImageBG=function(){var e="ui/equipcopy/main/bg_"+(this._index%this._maxBGType+2);if(this._nodeItemFirstPosScale.length>this._index){this.layerNodeItem.setPosition(this._nodeItemPos[this._index][0],this._nodeItemPos[this._index][1]),this.node.setPosition(this._nodeItemFirstPosScale[this._index][0],this._nodeItemFirstPosScale[this._index][1]),this.node.setScale(this._nodeItemFirstPosScale[this._index][2],this._nodeItemFirstPosScale[this._index][3]);this.imageShade.setContentSize(this._shadeWH[this._index%this._maxBGType][0],this._shadeWH[this._index%this._maxBGType][1]),y.default.instance.loadResByType(e,cc.SpriteFrame,this.loadSpriteFrameComplete,this),this.layerNodeItem.opacity=255-this._nodeItemFirstPosScale[this._index][4]+20}},t.prototype.loadSpriteFrameComplete=function(e){this.imageBG.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(e.getTexture()),this.imageShade.opacity=this._nodeItemFirstPosScale[this._index][4],this.imageShade.getComponent(cc.Mask).spriteFrame=new cc.SpriteFrame(e.getTexture())},t.prototype.onChangeNode=function(e,t){void 0===e&&(e=!1);var i=e?this._nodeItemSecondPosScale[this._index]:this._nodeItemFirstPosScale[this._index],n=e?this._nodeItemThirthPosScale[this._index]:this._nodeItemSecondPosScale[this._index];this.node.setPosition(i[0]+(n[0]-i[0])*t,i[1]+(n[1]-i[1])*t),this.node.setScale(i[2]+(n[2]-i[2])*t,i[3]+(n[3]-i[3])*t),this.imageShade.getComponent(cc.Mask).spriteFrame&&(this.imageShade.opacity=i[4]+(n[4]-i[4])*t)},t.prototype.onChangeNodeOpacity=function(e){var t=null;t=0==e?this._nodeItemFirstPosScale[this._index]:1==e?this._nodeItemSecondPosScale[this._index]:this._nodeItemThirthPosScale[this._index],this.layerNodeItem.stopAllActions(),this.layerNodeItem.runAction(cc.fadeTo(1,255-t[4]+20))},t.prototype.onShowOtherNode=function(e,t){var i=e.getChildByName("imageEffect"),n=e.getChildByName("imageFlag"),a="",s="";switch(t){case 2:a=m.GlobalContext.ResRoot+"resources/equipcopy/main/bg_shuxing.png",s=m.GlobalContext.ResRoot+"resources/equipcopy/main/icon_shuxinjiacheng.png",n.y=30;break;case 3:a=m.GlobalContext.ResRoot+"resources/equipcopy/main/bg_baoxiang.png",n.y=0}i.getComponent(o.default).loadImageByHttps(a),n.getComponent(o.default)&&n.getComponent(o.default).loadImageByHttps(s);var l=r.default.RandomBy(1,5)/10+.5,c=r.default.RandomBy(1,5)/10+1;n.stopAllActions(),n.runAction(cc.repeatForever(cc.sequence(cc.moveBy(l,0,-25).easing(cc.easeInOut(3)),cc.moveBy(c,0,25).easing(cc.easeInOut(3)))))},t.prototype.onClickNode=function(){var e=this;if(this._level==a.default.instance.equipData.equipCopyMainData.currentLevel){if(this._level==a.default.instance.equipData.equipCopyMainData.currentLevel)if(!this.onCheckOpenWindow())return;switch(this._nodeDate.type){case 1:c.default.instance.openWindow(d.WindowType.EquipCopyDifficulty,function(){p.default.instance.onInitData(e._nodeDate,e._level)},this);break;case 2:c.default.instance.openWindow(d.WindowType.EquipCopyAttrShop,function(){h.default.instance.onInitData(e._nodeDate)},this);break;case 3:a.default.instance.equipData.equipCopyMainData.openBoxCount>0&&a.default.instance.equipData.equipCopyMainData.currentLevel==a.default.instance.equipData.equipCopyMainData.maxLevel?f.default.instance.ShowMsg(g.default.getStr("equipcopy_max_level")):this._nodeDate?c.default.instance.openWindow(d.WindowType.EquipCopyBox,function(){u.default.instance.onInitData(e._nodeDate),console.log("\u6253\u5f00\u88c5\u5907\u526f\u672c\u5b9d\u7bb1\u754c\u9762\u6570\u636e\uff1a",e._nodeDate)},this):console.log("\u88c5\u5907\u526f\u672c\u5b9d\u7bb1\u6570\u636e\u597d\u50cf\u4e0d\u5bf9\u5594\uff1a",this._nodeDate)}}else{var t=a.default.instance.getLevelConfig(a.default.instance.equipData.equipCopyMainData.currentLevel);t&&f.default.instance.ShowMsg(g.default.getStr("equipcopy_enter_error",t.levelName))}},t.prototype.onClearMonster=function(){if(this.layerContent[0].childrenCount>0){var e=this.layerContent[0].getChildByName("layerMonsterContent");e&&(e.childrenCount>0&&r.default.setNodeToPool(d.PoolType.MonsterPreview,e.children[0]),e.removeAllChildren())}},__decorate([_(cc.Node)],t.prototype,"imageBG",void 0),__decorate([_(cc.Node)],t.prototype,"imageShade",void 0),__decorate([_(cc.Node)],t.prototype,"animationNode",void 0),__decorate([_(cc.Node)],t.prototype,"layerContent",void 0),__decorate([_(cc.Node)],t.prototype,"layerNodeItem",void 0),__decorate([_(cc.Node)],t.prototype,"btnNode",void 0),__decorate([_(cc.Label)],t.prototype,"labelLevel",void 0),t=__decorate([v],t)}(n.default);i.default=b,cc._RF.pop()},{"../../../Core/Language":"Language","../../../Core/LoadManager":"LoadManager","../../../Core/Widget":"Widget","../../../Core/WindowType":"WindowType","../../../GlobalContext":"GlobalContext","../../../Util/Utils":"Utils","../../Chapter/GuanqiaController":"GuanqiaController","../../Commons/Image":"Image","../../OpenWin/OpenWinController":"OpenWinController","../../Tips/OpTipsController":"OpTipsController","../../WarTeam/MonsterController":"MonsterController","../EquipCopyAttr/EquipCopyAttrPage":"EquipCopyAttrPage","../EquipCopyBox/EquipCopyBoxPage":"EquipCopyBoxPage","../EquipCopyController":"EquipCopyController","../EquipCopyDifficulty/EquipCopyDifficultyPage":"EquipCopyDifficultyPage"}],EquipCopyShopItemData:[function(e,t,i){"use strict";cc._RF.push(t,"ee869gqKJRIbYaBciJtV7p8","EquipCopyShopItemData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../EquipCopyController"),o=cc._decorator,a=o.ccclass,r=(o.property,function(){function e(){this._data=null}return e.prototype.onInitData=function(e){this._attrIndex=e,this._data=n.default.instance.getAttrShopItem(e)},Object.defineProperty(e.prototype,"attrIndex",{get:function(){return this._attrIndex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"attrType",{get:function(){return this._data.type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"attrNeedStar",{get:function(){return this._data.needStar},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"attrPercent",{get:function(){return this._data.attrPercent||0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"attrValue",{get:function(){return this._data.attrValue||0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"attrIcon",{get:function(){return this._data.attrIcon},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"attrBGType",{get:function(){return this._data.bgType>3?this._data.bgType%3:this._data.bgType},enumerable:!0,configurable:!0}),e=__decorate([a],e)}());i.default=r,cc._RF.pop()},{"../EquipCopyController":"EquipCopyController"}],EquipCopyUtils:[function(e,t,i){"use strict";cc._RF.push(t,"a0cafWi6ANBgIyh2waL0PNe","EquipCopyUtils"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./EquipCopyController"),o=e("../../Global/GlobalValue"),a=e("../Status/StatusType"),r=cc._decorator,s=r.ccclass,l=(r.property,function(){function e(){this._arrValueType=[o.AttrType.ThunderAttack,o.AttrType.ThunderDef,o.AttrType.EarthAttack,o.AttrType.EarthDef,o.AttrType.WaterAttack,o.AttrType.WaterDef,o.AttrType.FireAttack,o.AttrType.FireDef,o.AttrType.WindAttack,o.AttrType.WindDef],this._arrPercentType=[o.AttrType.ThunderAttackRate,o.AttrType.ThunderDefRate,o.AttrType.EarthAttackRate,o.AttrType.EarthDefRate,o.AttrType.WaterAttackRate,o.AttrType.WaterDefRate,o.AttrType.FireAttackRate,o.AttrType.FireDefRate,o.AttrType.WindAttackRate,o.AttrType.WindDefRate]}var t;return t=e,Object.defineProperty(e,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),e.prototype.getPercentType=function(e){for(var t=this._arrValueType.length,i=0;i<t;i++)if(this._arrValueType[i]==e)return this._arrPercentType[i];return e},e.prototype.setEquipCopyAddProp=function(e){if(n.default.instance&&n.default.instance.equipData&&a.ActivityStatus.value==a.ActivityStatus.EquipCopy){var t=n.default.instance.equipData.equipCopyOwnAttr;if(t.attrValueList.length&&e.selfMonster)for(var i=0;i<t.attrValueList.length;i++){var r=t.attrValueList[i];o.AttrType.WindDef>=r.attrType&&r.attrType>=o.AttrType.MaxHp&&(r.attrPercent>0?e.attr.Push(r.attrType,Math.ceil(e.attr.GetAttrVale(r.attrType)*(r.attrPercent/1e4))):e.attr.Push(r.attrType,r.attrValue))}}},e=t=__decorate([s],e)}());i.default=l,cc._RF.pop()},{"../../Global/GlobalValue":"GlobalValue","../Status/StatusType":"StatusType","./EquipCopyController":"EquipCopyController"}],EquipCopyWin:[function(e,t,i){"use strict";cc._RF.push(t,"02db7nWum1M5oOSHQxXafvb","EquipCopyWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../OpenWin/OpenWinController"),a=e("../../Core/WindowType"),r=e("../../Core/Language"),s=e("../../GlobalContext"),l=e("./EquipCopyController"),c=e("../../Core/GameEventDispatcher"),d=e("./EquipCopyEvent"),p=e("../Item/ItemController"),h=e("../../Util/Utils"),u=e("./EquipCopyItem/EquipCopyNodeItem"),f=e("../Tips/OpTipsController"),g=e("../../Util/GrayEffect"),y=e("../Shop/Shop"),m=e("./EquipCopyItem/EquipCopyAttrRightItem"),C=e("../Shop/ShopController"),v=e("../Shop/ShopConst"),_=e("../Role/RoleInfo"),b=e("../../Util/RechargeUtils"),T=e("../../Core/LoadManager"),S=e("../../Util/RechargeConst"),I=e("../Tips/TipsWinController"),w=cc._decorator,D=w.ccclass,R=w.property,A=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layerParentContent=null,t.itemNodePrefab=null,t.attrScrollView=null,t.spriteAttrBG=null,t.layerAttrContent=null,t.layerContent=null,t.layerRightAttr=null,t.labelDebrisCount=null,t.labelStarCount=null,t.labelFightCount=null,t.layerReset=[],t.labelResetCost=null,t.spriteBtnBG=[],t.buttonList=[],t.toggleAutoSelectWipe=null,t.layerLevelContent=null,t.scrollView=null,t.layerScrollContent=null,t.resetRed=null,t._itemList=[],t._nextLVLen=0,t._contentScrollHeight=250,t._contentInterval=[-250,0,250],t._maxLength=5,t._spriteAttrBGH=80,t._attrHeight=38,t._oldPosition=0,t._isUpScroll=!1,t._debrisId=11901,t}return __extends(t,e),t.prototype.onLoad=function(){var t=this;this.onInit(a.WindowType.EquipCopyMain,!0),this.loadWindowCom=function(){t.layerParentContent.setSiblingIndex(1)},this.loadWindowComThis=this,e.prototype.onLoad.call(this),this.layerContent.setContentSize(s.GlobalContext.UIWidth,s.GlobalContext.UIHeight)},t.prototype.show=function(){e.prototype.show.call(this),this.layerRightAttr.active=!1,this.scrollView.node.on(cc.Node.EventType.TOUCH_END,this.onCheck,this),c.GameEventDispatcher.instance.on(d.EquipCopyEvent.EquipCopyInfo,this.onMainInfo,this),l.default.instance.sendCmdEquipCopyMain()},t.prototype.onMainInfo=function(){if(l.default.instance.equipData&&l.default.instance.equipData.equipCopyMainData){var e=l.default.instance.equipData.equipCopyMainData;if(this.labelFightCount.string=r.default.getStr("equipcopy_challenge_count",e.challengeCount),this.labelDebrisCount.string=p.default.instance.getItemNum(this._debrisId)+"",this.labelStarCount.string=e.starCount+"",this.onInitNodeItem(e),this.resetRed.active=l.default.instance.havefreeResetCount(),l.default.instance.canReset){var t=l.default.instance.getResetConfition;t[0]<1?h.default.setNodeActive([this.layerReset[0],this.layerReset[2]],[this.layerReset[1]]):(h.default.setNodeActive([this.layerReset[1],this.layerReset[2]],[this.layerReset[0]]),this.labelResetCost.string=t[0]+"")}else h.default.setNodeActive([this.layerReset[0],this.layerReset[1]],[this.layerReset[2]]);this.setNodeGray(this.spriteBtnBG[1],!l.default.instance.canReset,this.buttonList[1]),this.setNodeGray(this.spriteBtnBG[2],!l.default.instance.canWipe,this.buttonList[2]),this.setNodeGray(this.spriteBtnBG[0],!l.default.instance.canAddFightCount,this.buttonList[0]),this.onShowRightAttr()}},t.prototype.setNodeGray=function(e,t,i){if(void 0===t&&(t=!1),void 0===i&&(i=null),i&&(i.interactable=!t),e.node.getComponent(g.default))e.node.getComponent(g.default).setGray(t);else if(t){e.node.addComponent(g.default).setGray(!0)}},t.prototype.onShowRightAttr=function(){var e=this;h.default.setNodeChildDestoryByUrl(this.layerAttrContent,s.GlobalContext.Root+"prefab/EquipCopy/EquipCopyItem/EquipCopyAttrItem");var t=l.default.instance.equipData.equipCopyOwnAttr;t&&t.attrValueList.length>0?(this.layerRightAttr.active=!0,T.default.instance.loadResByType(s.GlobalContext.Root+"prefab/EquipCopy/EquipCopyItem/EquipCopyAttrItem",cc.Prefab,function(i){for(var n in t.attrValueList){var o=t.attrValueList[n],a=h.default.getNodeByUrl(i,s.GlobalContext.Root+"prefab/EquipCopy/EquipCopyItem/EquipCopyAttrItem");e.layerAttrContent.addChild(a),a.getComponent(m.default).onInitData(o.attrType,o.attrPercent,o.attrValue)}e._spriteAttrBGH+e._attrHeight*t.attrValueList.length>333?e.spriteAttrBG.height=333:e.spriteAttrBG.height=e._spriteAttrBGH+e._attrHeight*t.attrValueList.length},this)):this.layerRightAttr.active=!1,this.attrScrollView.scrollToTop()},t.prototype.onInitNodeItem=function(e){var t=this;this._itemList=[],this._nextLVLen=0,h.default.setNodeChildDestoryByUrl(this.layerLevelContent,s.GlobalContext.Root+"prefab/EquipCopy/EquipCopyItem/EquipCopyNodeItem"),T.default.instance.loadResByType(s.GlobalContext.Root+"prefab/EquipCopy/EquipCopyItem/EquipCopyNodeItem",cc.Prefab,function(i){for(var n=0;n<t._maxLength;n++){l.default.instance.getLevelConfig(e.currentLevel+n)&&t._nextLVLen++;var o=h.default.getNodeByUrl(i,s.GlobalContext.Root+"prefab/EquipCopy/EquipCopyItem/EquipCopyNodeItem");o.name="EquipCopyNodeItem"+n,t.layerLevelContent.addChild(o),o.setSiblingIndex(0),o.getComponent(u.default).onInitData(e.currentLevel+n,n),t._itemList.push(o)}t.scrollView.scrollToBottom()},this)},t.prototype.changeItemScale=function(){1!=this._nextLVLen&&(2==this._nextLVLen&&this.layerScrollContent.y<0||(this._oldPosition!=this.layerScrollContent.y&&(this._isUpScroll=this._oldPosition<this.layerScrollContent.y),this._oldPosition=this.layerScrollContent.y,this.onShowNodeScroll()))},t.prototype.onCheck=function(){var e;if(1!=this._nextLVLen)for(var t in 0==(e=this._isUpScroll?this._oldPosition>=this._contentInterval[1]+50?0:this._oldPosition>=this._contentInterval[1]-150?1:2:this._oldPosition<=this._contentInterval[1]-20?2:this._oldPosition<=this._contentInterval[1]+230?1:0)?this.scrollView.scrollToPercentVertical(0,1):1==e?this.scrollView.scrollToPercentVertical(.5,1):this.scrollView.scrollToPercentVertical(1,1),this._itemList)this._itemList[t]&&this._itemList[t].getComponent(u.default).onChangeNodeOpacity(e)},t.prototype.onShowNodeScroll=function(){var e=this.layerScrollContent.y<0,t=0;for(var i in t=e?-this.layerScrollContent.y/this._contentScrollHeight:(this._contentScrollHeight-this.layerScrollContent.y)/this._contentScrollHeight,this._itemList)this._itemList[i]&&this._itemList[i].getComponent(u.default).onChangeNode(e,t)},t.prototype.onClickAddFightCount=function(){var e=this;l.default.instance.canAddFightCount?I.default.instance.ShowTips(r.default.getStr("equipcopy_addfightcount_desc",l.default.instance.getAddFightCost),function(){e.onToAddFightCount()},this,null,1):f.default.instance.ShowMsg(r.default.getStr("equipcopy_addfightcount_error"))},t.prototype.onToAddFightCount=function(){b.default.PurchaseItemOrRechage(S.RechargeTypeConst.Diamonds,l.default.instance.getAddFightCost,function(){l.default.instance.sendCmdBuyChallenge()},this)},t.prototype.onClickEquipShop=function(){o.default.instance.openWindow(a.WindowType.Shop,function(){var e=C.default.instance.nowSortIndex[v.ShopConst.Equip];y.default.instance.TabBtnList2.selectItem(e)},this)},t.prototype.onClickReset=function(){var e=this;if(l.default.instance.canReset){var t=l.default.instance.getResetConfition;if(t.length>1){var i="";t[0]<1&&t[1]<1?i=r.default.getStr("equipcopy_reset_1"):t[0]>0&&t[1]<1?i=r.default.getStr("equipcopy_reset_2",t[0]):t[0]<1&&t[1]>0?i=r.default.getStr("equipcopy_reset_3",t[1]):t[0]>0&&t[1]>0&&(i=r.default.getStr("equipcopy_reset_4",t[1],t[0])),I.default.instance.ShowTips(i,function(){e.onToReset(t)},this,null,1)}}else f.default.instance.ShowMsg(r.default.getStr("equipcopy_reset_error"))},t.prototype.onToReset=function(e){var t=this;void 0===e&&(e=[]),b.default.PurchaseItemOrRechage(S.RechargeTypeConst.Diamonds,e[0],function(){t.onSendReset(e)},this)},t.prototype.onSendReset=function(e){void 0===e&&(e=[]),e&&e.length>1&&e[1]>_.MyRoleInfo.vipLevel?f.default.instance.ShowMsg(r.default.getStr("equipcopy_reset_error_1",e[1])):l.default.instance.sendCmdReset()},t.prototype.onClickWipe=function(){l.default.instance.canWipe?o.default.instance.openWindow(a.WindowType.EquipCopyWipeWin):f.default.instance.ShowMsg(r.default.getStr("equipcopy_wipe_error"))},t.prototype.onClickWipeToggle=function(){},__decorate([R(cc.Node)],t.prototype,"layerParentContent",void 0),__decorate([R(cc.Prefab)],t.prototype,"itemNodePrefab",void 0),__decorate([R(cc.ScrollView)],t.prototype,"attrScrollView",void 0),__decorate([R(cc.Node)],t.prototype,"spriteAttrBG",void 0),__decorate([R(cc.Node)],t.prototype,"layerAttrContent",void 0),__decorate([R(cc.Node)],t.prototype,"layerContent",void 0),__decorate([R(cc.Node)],t.prototype,"layerRightAttr",void 0),__decorate([R(cc.Label)],t.prototype,"labelDebrisCount",void 0),__decorate([R(cc.Label)],t.prototype,"labelStarCount",void 0),__decorate([R(cc.Label)],t.prototype,"labelFightCount",void 0),__decorate([R(cc.Node)],t.prototype,"layerReset",void 0),__decorate([R(cc.Label)],t.prototype,"labelResetCost",void 0),__decorate([R(cc.Sprite)],t.prototype,"spriteBtnBG",void 0),__decorate([R(cc.Button)],t.prototype,"buttonList",void 0),__decorate([R(cc.Toggle)],t.prototype,"toggleAutoSelectWipe",void 0),__decorate([R(cc.Node)],t.prototype,"layerLevelContent",void 0),__decorate([R(cc.ScrollView)],t.prototype,"scrollView",void 0),__decorate([R(cc.Node)],t.prototype,"layerScrollContent",void 0),__decorate([R(cc.Node)],t.prototype,"resetRed",void 0),t=__decorate([D],t)}(n.default);i.default=A,cc._RF.pop()},{"../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/Window":"Window","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/GrayEffect":"GrayEffect","../../Util/RechargeConst":"RechargeConst","../../Util/RechargeUtils":"RechargeUtils","../../Util/Utils":"Utils","../Item/ItemController":"ItemController","../OpenWin/OpenWinController":"OpenWinController","../Role/RoleInfo":"RoleInfo","../Shop/Shop":"Shop","../Shop/ShopConst":"ShopConst","../Shop/ShopController":"ShopController","../Tips/OpTipsController":"OpTipsController","../Tips/TipsWinController":"TipsWinController","./EquipCopyController":"EquipCopyController","./EquipCopyEvent":"EquipCopyEvent","./EquipCopyItem/EquipCopyAttrRightItem":"EquipCopyAttrRightItem","./EquipCopyItem/EquipCopyNodeItem":"EquipCopyNodeItem"}],EquipCopyWipeBuyAttr:[function(e,t,i){"use strict";cc._RF.push(t,"1c658wV61pE0Jo7t7EpMBGh","EquipCopyWipeBuyAttr"),Object.defineProperty(i,"__esModule",{value:!0});var n=cc._decorator,o=n.ccclass,a=(n.property,function(){function e(){this._indexList=[]}return e.prototype.onInitData=function(e){this._level=e},Object.defineProperty(e.prototype,"shopLevel",{get:function(){return this._level},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"attrIndexList",{get:function(){return this._indexList},enumerable:!0,configurable:!0}),e.prototype.onPush=function(e){for(var t=!1,i=0;i<this._indexList.length;i++)if(this._indexList[i]==e){t=!0,this._indexList.splice(i,1);break}t||this._indexList.push(e)},e=__decorate([o],e)}());i.default=a,cc._RF.pop()},{}],EquipCopyWipeResult:[function(e,t,i){"use strict";cc._RF.push(t,"a6e1c2HzOtKbaFV43TkuGXn","EquipCopyWipeResult"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Commons/CommonPageBG"),o=e("../../../Core/Language"),a=e("../../../Core/GameEventDispatcher"),r=e("../EquipCopyEvent"),s=e("../EquipCopyController"),l=e("../../../Core/WindowManager"),c=e("../../../Core/WindowType"),d=e("../../../Util/Utils"),p=e("../../Item/ItemIcon"),h=e("../../../Core/LoadManager"),u=e("../../../GlobalContext"),f=cc._decorator,g=f.ccclass,y=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layerContent=null,t.scrollView=null,t.labelRewardNone=null,t.labelTitle=null,t._reward=[],t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this,this.onInit(700,475,o.default.getStr("equipcopy_wipe_title"),!0)},t.prototype.show=function(){e.prototype.show.call(this),a.GameEventDispatcher.instance.on(r.EquipCopyEvent.EquipCopyWipeReward,this.onGetReward,this)},t.prototype.onClose=function(){this.onClear(),s.default.instance.wipeFightResultReward=[],a.GameEventDispatcher.instance.off(r.EquipCopyEvent.EquipCopyWipeReward,this.onGetReward,this),l.default.instance.close(c.WindowType.EquipCopyWipeResult),s.default.instance.onClickNextToAttr()&&s.default.instance.onClickNextToBoxList()},t.prototype.onGetReward=function(){this.onShowReward()},t.prototype.onInitData=function(e){if(this.onShowReward(),0==e){var t=s.default.instance.equipData.equipCopyMainData.maxLevel+1+"";switch(Number(t.substring(t.length-1))){case 0:case 5:this.labelTitle.string=o.default.getStr("equipcopy_wipe_title_desc",Number(t)-2);break;case 4:case 9:this.labelTitle.string=o.default.getStr("equipcopy_wipe_title_desc",Number(t)-1);break;default:this.labelTitle.string=o.default.getStr("equipcopy_wipe_title_desc",Number(t))}}else this.labelTitle.string=o.default.getStr("equipcopy_wipe_title_desc",s.default.instance.equipData.equipCopyMainData.sweepLevel+1)},t.prototype.onShowReward=function(){var e=this;h.default.instance.loadResByType(u.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(t){if(e._reward=s.default.instance.wipeFightResultReward.concat(),e.onClear(),e._reward.length>0)for(var i=0;i<e._reward.length;i++){var n=d.default.getNodeByPool(c.PoolType.ItemIcon,t,u.GlobalContext.Root+"prefab/Bag/ItemIcon");e.layerContent.addChild(n),n.getComponent(p.default).ItemData(e._reward[i],!0),n.setScale(.8)}e.scrollView.scrollToLeft(),e.labelRewardNone.node.active=e._reward.length<1},this)},t.prototype.onClickNext=function(){this.onClose()},t.prototype.onClear=function(){for(var e=this.layerContent.childrenCount-1;e>=0;e--)d.default.setNodeToPool(c.PoolType.ItemIcon,this.layerContent.children[e]);this.layerContent.removeAllChildren()},t.instance=null,__decorate([y(cc.Node)],t.prototype,"layerContent",void 0),__decorate([y(cc.ScrollView)],t.prototype,"scrollView",void 0),__decorate([y(cc.Label)],t.prototype,"labelRewardNone",void 0),__decorate([y(cc.Label)],t.prototype,"labelTitle",void 0),t=i=__decorate([g],t)}(n.default);i.default=m,cc._RF.pop()},{"../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Core/LoadManager":"LoadManager","../../../Core/WindowManager":"WindowManager","../../../Core/WindowType":"WindowType","../../../GlobalContext":"GlobalContext","../../../Util/Utils":"Utils","../../Commons/CommonPageBG":"CommonPageBG","../../Item/ItemIcon":"ItemIcon","../EquipCopyController":"EquipCopyController","../EquipCopyEvent":"EquipCopyEvent"}],EquipCopyWipeShopLevel:[function(e,t,i){"use strict";cc._RF.push(t,"79ecemhnnFHU4kE2r70Ii++","EquipCopyWipeShopLevel"),Object.defineProperty(i,"__esModule",{value:!0});var n=cc._decorator,o=n.ccclass,a=(n.property,function(){function e(){this._level=0,this._arrList=[]}return e.prototype.onInitData=function(e){this._level=e},e.prototype.onPushData=function(e){this._arrList.push(e)},Object.defineProperty(e.prototype,"shopLevel",{get:function(){return this._level},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shopItemList",{get:function(){return this._arrList},enumerable:!0,configurable:!0}),e=__decorate([o],e)}());i.default=a,cc._RF.pop()},{}],EquipCopyWipeWin:[function(e,t,i){"use strict";cc._RF.push(t,"95fb062SKdOC4r6CRMO7l3X","EquipCopyWipeWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Commons/CommonPageBG"),o=e("../../../Core/Language"),a=e("../EquipCopyController"),r=cc._decorator,s=r.ccclass,l=r.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.SystemItem=null,t.passLabel=null,t.passLabel_3xing=null,t._info=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this,this.onInit(720,438,o.default.getStr("ChapterTips10"),!0)},t.prototype.show=function(){e.prototype.show.call(this),this.Info()},t.prototype.onDisable=function(){e.prototype.onDisable.call(this)},t.prototype.hide=function(){e.prototype.hide.call(this)},t.prototype.Info=function(){var e=a.default.instance.equipData.equipCopyMainData,t=e.maxLevel+1+"";switch(Number(t.substring(t.length-1))){case 0:case 5:this.passLabel.string=Number(t)-2+"";break;case 4:case 9:this.passLabel.string=Number(t)-1+"";break;default:this.passLabel.string=t}this.passLabel_3xing.string=e.sweepLevel+1+""},t.prototype.onClickWipe=function(){a.default.instance._type=0,a.default.instance.sendCmdWipe(0),this.onClose()},t.prototype.onClickWipe_3xing=function(){a.default.instance._type=1,a.default.instance.sendCmdWipe(1),this.onClose()},t.instance=null,__decorate([l(cc.Label)],t.prototype,"passLabel",void 0),__decorate([l(cc.Label)],t.prototype,"passLabel_3xing",void 0),t=i=__decorate([s],t)}(n.default);i.default=c,cc._RF.pop()},{"../../../Core/Language":"Language","../../Commons/CommonPageBG":"CommonPageBG","../EquipCopyController":"EquipCopyController"}],EquipCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"f2e94qEGbhDuLLmUhhNnmxd","EquipCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Controller"),o=e("./EquipData"),a=e("../../../Core/Event"),r=e("../../../NetConnect/NetConnet"),s=e("../../../Core/GameEventDispatcher"),l=e("../../Item/ItemType"),c=e("../../OpenWin/OpenWinController"),d=e("../../../Core/WindowType"),p=e("../ReplaceWin"),h=cc._decorator,u=h.ccclass,f=(h.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._data=null,t}var i;return __extends(t,e),i=t,t.prototype.listNotification=function(){this._data=new o.default,i.instance=this,this.addProto(a.EventDefiner.EQUIP_upgrade_ret,this.resItemupgraderet,this),this.addProto(a.EventDefiner.EQUIP_upgrade_stage_ret,this.resItemupgradestageret,this),this.addProto(a.EventDefiner.EQUIP_refine,this.resRefine,this),this.addProto(a.EventDefiner.EQUIP_GemInfo,this.resGemInfo,this),this.addProto(a.EventDefiner.cardinfo,this.resCardinfo,this),this.addProto(a.EventDefiner.synthetic,this.resSyntheticInfo,this)},Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),t.prototype.resItemupgraderet=function(e){s.GameEventDispatcher.instance.emit(a.EventDefiner.EQUIP_upgrade_ret,{result:e.result,type:l.ItemType.forging})},t.prototype.resItemupgradestageret=function(e){s.GameEventDispatcher.instance.emit(a.EventDefiner.EQUIP_upgrade_stage_ret,{result:e.result,type:l.ItemType.order})},t.prototype.resCardinfo=function(e){s.GameEventDispatcher.instance.emit(a.EventDefiner.EQUIP_UP_WEAR)},t.prototype.resRefine=function(e){s.GameEventDispatcher.instance.emit(a.EventDefiner.EQUIP_UP_Refine,{flag:e.ret})},t.prototype.resGemInfo=function(e){s.GameEventDispatcher.instance.emit(a.EventDefiner.EQUIP_up_GemInfo,{flag:e.isSuc})},t.prototype.resSyntheticInfo=function(e){s.GameEventDispatcher.instance.emit(a.EventDefiner.synthetic_Up)},t.prototype.reqEquipuplevel=function(e,t,i){var n={cmd:"equipuplevel",equipGuid:e,material:t,isAutoBuy:i};r.default.instance.sendProto(n)},t.prototype.reqEquipupStage=function(e,t,i){void 0===t&&(t=[]);var n={cmd:"equipupstage",equipGuid:e,material:t,isAutoBuy:i};r.default.instance.sendProto(n)},t.prototype.reqEquipDecompose=function(e,t){var i={cmd:"equipdecompose",equipGuid:e};r.default.instance.sendProto(i)},t.prototype.reqTakeonEquip=function(e,t){var i={cmd:"takeonequip",id:e,equipGuid:t};r.default.instance.sendProto(i)},t.prototype.reqTakeOffEquip=function(e,t){var i={cmd:"takeoffequip",id:e,buwei:t};r.default.instance.sendProto(i)},t.prototype.reqInlayGemstone=function(e,t,i){var n={cmd:"geminlay",index:e,equipGuid:t,gemGuid:i};r.default.instance.sendProto(n)},t.prototype.reqUnloadGemstone=function(e,t){var i={cmd:"gemremove",index:e,equipGuid:t};r.default.instance.sendProto(i)},t.prototype.reqReplacementGemstone=function(e,t,i){var n={cmd:"gemreplace",index:e,equipGuid:t,gemGuid:i};r.default.instance.sendProto(n)},t.prototype.reqGemGemupgrade=function(e,t,i){var n={cmd:"gemupgrade",index:e,equipGuid:t,itemid:i};r.default.instance.sendProto(n)},t.prototype.reqRefineEquip=function(e,t){var i={cmd:"refine",guid:e,isAutoBuy:t};r.default.instance.sendProto(i)},t.prototype.reqSynthesis=function(e,t){var i={cmd:"itemsynthetic",itemid:e,count:t};r.default.instance.sendProto(i)},t.prototype.onpenWearEquip=function(e,t,i){void 0===i&&(i=!1),c.default.instance.openWindow(d.WindowType.EquipRelpace,function(n){n.getComponent(p.default).setData(e,t,i)})},t.instance=null,t=i=__decorate([u],t)}(n.default));i.default=f,cc._RF.pop()},{"../../../Core/Controller":"Controller","../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/WindowType":"WindowType","../../../NetConnect/NetConnet":"NetConnet","../../Item/ItemType":"ItemType","../../OpenWin/OpenWinController":"OpenWinController","../ReplaceWin":"ReplaceWin","./EquipData":"EquipData"}],EquipData:[function(e,t,i){"use strict";cc._RF.push(t,"1cdcedGGwlOupxe4qqEsKUF","EquipData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../WarTeam/MonsterController"),o=e("../../../Core/ConfigsManager"),a=e("../../Item/ItemModel"),r=e("../../Item/ItemType"),s=e("../../Item/ItemData"),l=e("../../Role/RoleController"),c=e("../../../Global/GlobalValue"),d=e("../../../Util/UtilsFight"),p=e("../../Functionicon/FunctionIconController"),h=e("../../../Core/WindowType"),u=e("../../Ornament/OrnamentCtrl"),f=e("../../Item/ItemController"),g=e("../../Role/RoleInfo"),y=e("../../../Util/Utils"),m=function(){function e(){this._cardCfg=null,this._equipCfg=null,this._equipCfgbyQuality={},this._gemstoneCfg=null,this._decomposeCfg=null,this._equipEffectCfg=null,this._equipCfg=o.ConfigsManager.instance.getConfigs("equipconf"),this._gemstoneCfg=o.ConfigsManager.instance.getConfigs("gemconf"),this._decomposeCfg=o.ConfigsManager.instance.getConfigs("decompose"),this._equipEffectCfg=o.ConfigsManager.instance.getConfigs("equipeffect"),this.init()}return e.prototype.init=function(){var e=this._equipCfg.equip;for(var t in e){var i=e[t].range[0];this._equipCfgbyQuality[i]||(this._equipCfgbyQuality[i]=new Array),this._equipCfgbyQuality[i].push(e[t])}},e.prototype.getCardCfg=function(){return this._cardCfg||(this._cardCfg=n.default.instance.data.getCardCfg()),this._cardCfg},e.prototype.getEquipCfg=function(){return this._equipCfg},e.prototype.getWearRedPointFlag=function(e,t){var i=this.getCardCfg().Card[t].cardType,n=this.getEquipList(t),o=this.getIconList(i,e);if(!n[e])return o.length>0;for(var a in o)if(o[a].colorIndex>n[e].colorIndex)return!0;return!1},e.prototype.getEquipList=function(e,t){void 0===t&&(t=!1);for(var i=n.default.instance.GetMonsterData(e),o=[void 0,void 0,void 0,void 0],a=0;a<4;a++)if(i){var r=t?u.default.instance.data.getOrnamentGuid(i.peishi[a]):this.getItemByGuid(i.equip[a]);o[a]=r}return o},e.prototype.getIconList=function(e,t){var i=[],n=a.default.instance.getBagTypeListbyType(r.ItemType.equipment);for(var o in n){u.default.instance.data.ornamentFlag(n[o].id);if(!1,n[o].ower<=0){var s=this.getEquipInfoById(n[o].id);if(s.buwei==t)for(var l in s.range)if(s.range[l]==e){i.push(n[o]);break}}}return i},e.prototype.getItemByGuid=function(e,t){return void 0===t&&(t=r.ItemType.equipment),a.default.instance.getItembyGuidAndType(t,e)},e.prototype.getIconNumById=function(e){var t=a.default.instance.getBagTypeListbyType(r.ItemType.material,r.ItemType.order),i=0;for(var n in t)t[n].id==e&&(i+=t[n].count);return i},e.prototype.getOrderItem=function(e,t){void 0===t&&(t=0);var i=this.getAllOrderData(e),n=[];for(var o in i)i[o]&&i[o].ower<0&&i[o].id==e.id&&n.push(i[o]);for(var a=0;a<n.length;a++){for(var r=a+1;r<n.length;r++){var s=!1;if(n[a].stage>n[r].stage?s=!0:n[a].stage==n[r].stage&&(n[a].level>n[r].level?s=!0:n[a].level==n[r].level&&n[a].refineLevel>n[r].refineLevel&&(s=!0)),s){var l=n[a];n[a]=n[r],n[r]=l}}return n.length>0?t<1?n[0]:n:void 0}},e.prototype.getAllOrderData=function(e){if(e){var t=this.getEquipInfoById(e.id),i=this._equipCfg.stage[t.stage][e.stage],n=[],o=a.default.instance.getBagTypeListbyType(r.ItemType.material,r.ItemType.order),s=a.default.instance.getBagTypeListbyType(r.ItemType.equipment);for(var l in s)s[l].id==e.id&&s[l].guid!=e.guid&&n.push(s[l]);for(var l in o)o[l].id==i.substitute&&n.push(o[l]);return n}},e.prototype.getAllForgingData=function(e){var t=[],i=a.default.instance.getBagTypeListbyType(r.ItemType.material,r.ItemType.forging);for(var n in i)t.push(i[n]);return t},e.prototype.getItemTyep=function(e){if(!e)return r.ItemType.forging;var t=this.getEquipInfoById(e.id),i=this._equipCfg,n=i.stage[t.stage][e.stage];return!i.stage[t.stage][e.stage+1]||e.level+1<n.maxlevel?r.ItemType.forging:r.ItemType.order},e.prototype.getWarTeamCardId=function(){var e={cardId:0,buwei:0,equipFlag:!1};for(var t in n.MonsterType.MonsterWarTeam[n.MonsterType.MonsterBattle]){var i=n.MonsterType.MonsterWarTeam[n.MonsterType.MonsterBattle][t];if(!(i<=0)){var o=n.MonsterType.MonsterCardArr[i].equip;for(var a in o)o[a]&&(e.cardId=i,e.equipFlag=!0)}}return e.cardId<=0&&(e.cardId=n.MonsterType.MonsterWarTeam[n.MonsterType.MonsterBattle][0],e.equipFlag=!1),e},e.prototype.getStageLimit=function(e){var t=1,i=this._equipCfg.stageLimit[4];for(var n in i)i[n].level<=e&&(t=i[n].stage);return t},e.prototype.getMaxStageLevel=function(e){var t=this.getEquipInfoById(e.id);return this._equipCfg.stage[t.stage].length-1},e.prototype.getEquipInfoById=function(e){return this._equipCfg.equip[e]},e.prototype.getMaxFightEquip=function(e,t){var i=null,n=this.getCardCfg().Card[e].cardType,o=this.getIconList(n,t);if(o.length<=0)return null;i=o[0];for(var a=1;a<o.length;++a){var r=this.getEquipInfoById(i.id);d.default.cptFight(r.range[0],this.getEquipAttr(i))<d.default.cptFight(r.range[0],this.getEquipAttr(o[a]))&&(i=o[a])}return i},e.prototype.getEqupFight=function(e){var t=this.getEquipAttr(e),i=this.getEquipInfoById(e.id);return d.default.cptFight(i.range[0],t)},e.prototype.getEequipWearAttr=function(e){var t={};for(var i in e)if(e[i]){var n=this.getEquipAttr(e[i]);for(var o in n)this.setAttrMap(t,parseInt(o),n[o])}return t},e.prototype.getEquipAttr=function(e){var t={},i=this.getEquipCfg(),n=this.getEquipInfoById(e.id);if(this.setAttr(t,this.getEquipBaseAttr(e.id)),p.default.instance.checkIsOpenbyWindowtype(h.WindowType.Strengthen)&&e.level>0){var o=this.getCalculateEquipStrengthenAttr(e.id,e.level);this.getEquipStrengthenAttr(t,o)}if(p.default.instance.checkIsOpenbyWindowtype(h.WindowType.Strengthen)&&e.stage>0){var a=i.stage[n.stage][e.stage].randomAttr,r=i.randomAttr[a];this.getEquipStageAttr(t,r)}return e.gem.length>0&&(e.gem[0]||e.gem[1]||e.gem[2])&&(this.setEquipGemAttr(t,e.gem),this.getGemRatio(t)),t},e.prototype.getGemRatio=function(e){for(var t in e){var i=parseInt(t);i>=c.AttrType.HpRate&&i<=c.AttrType.DefCriRate&&e[i-c.AttrType.HpRate]&&(e[i-c.AttrType.HpRate]=Math.ceil(e[i-c.AttrType.HpRate]*(1e4+e[i])/1e4),e[i]=null,delete e[i])}},e.prototype.getEquipStageAttr=function(e,t){for(var i in t)this.setAttrMap(e,t[i].type,t[i].value)},e.prototype.getEquipBaseAttr=function(e){return this.getCalculateEquipStrengthenAttr(e,0,!0)},e.prototype.getEquipBaseAttrMap=function(e,t){this.setAttr(t,this.getEquipBaseAttr(e))},e.prototype.getCalculateEquipStrengthenAttr=function(e,t,i){void 0===i&&(i=!1);var n=this.getEquipInfoById(e),o=[],a=s.default.creatItem(e,1).colorIndex;if(this._equipCfg.base[a][t])for(var r=this._equipCfg.base[a][t].param,l=this._equipCfg.base[a][0].param,c=0;c<n.prop.length;c++)o[c]=Math.ceil(n.prop[c]*(i?r:r-l)/1e4);return o},e.prototype.getEquipStrengthenAttr=function(e,t){this.setAttr(e,t)},e.prototype.setEquipRefineAttr=function(e,t){this.setAttr(e,t)},e.prototype.setEquipGemAttr=function(e,t){for(var i in t)if(t[i]){var n=t[i],o=this.getGemstoneCfg(n),a=this.getGemstoneAttr(o.attr);this.setAttrMap(e,a.type,a.value)}},e.prototype.setAttr=function(e,t){for(var i in t)t[i]&&this.setAttrMap(e,parseInt(i),t[i])},e.prototype.setAttrMap=function(e,t,i){e[t]?e[t]+=i:e[t]=i},e.prototype.getMaxUPLevelData=function(e){var t=this.getEquipInfoById(e.id),i=null;return t&&(i=this._equipCfg.stage[t.stage][e.stage].maxlevel),i},e.prototype.getEquipLevel=function(e){var t=this.getEquipInfoById(e.id),i=this._equipCfg.stage[t.stage].length-1;return this._equipCfg.stage[t.stage][i].maxlevel},e.prototype.getEquipNeedExp=function(e,t){var i=a.default.instance.getBaseAttributebyId(e),n=this._equipCfg.levelExp[i.ItemColor];return Math.ceil(15*Math.pow(t,2+t/100)+20*t+n.param1)*n.param2},e.prototype.getMaterialInfoById=function(e){var t=this._equipCfg.material[1];for(var i in t)if(e==t[i].itemId)return t[i]},e.prototype.getUpLevelMaterialDataList=function(){return this._equipCfg.material[1]},e.prototype.getEquipUPLevelExpend=function(e){var t=0,i=0,n={},o=this.getEquipNeedExp(e.id,e.level),a=this.getUpLevelMaterialDataList();for(var r in o-=e.exp,a){var s=f.default.instance.getItemNum(a[r].itemId),l=a[r].exp*s;if(n[a[r].itemId]=0,o>0){if(o>=l)o-=l,i+=s*a[r].needMoney,n[a[r].itemId]+=s;else{var c=Math.ceil(o/a[r].exp);o-=a[r].exp*c,i+=c*a[r].needMoney,n[a[r].itemId]+=c}t+=l}}return{expFlag:o<=0,exp:t,gold:i,itemMap:n}},e.prototype.getEqipUpLevelExp=function(e){var t=0,i=0,n={},o=this.getEquipNeedExp(e.id,e.level),a=this.getUpLevelMaterialDataList();for(var r in o-=e.exp,a){var s=f.default.instance.getItemNum(a[r].itemId),l=a[r].exp*s;if(n[a[r].itemId]=0,o>0){if(o>=l)o-=l,i+=s*a[r].needMoney,n[a[r].itemId]+=s;else{var c=Math.ceil(o/a[r].exp);o-=a[r].exp*c,i+=c*a[r].needMoney,n[a[r].itemId]+=c}t+=l}}return{expFlag:o<=0,exp:t,gold:i,itemMap:n}},e.prototype.getUpLevelMaterialGuids=function(e){var t=[];for(var i in e)if(e[i]>0)for(var n=0,o=0;o<e[i];++o){var a=f.default.instance.getItemListByid(Number(i));t.push(a[n].guid),t.length>a[n].length&&(n+=1)}return t},e.prototype.getEquipUpExp=function(e){var t={},i=this.getEquipNeedExp(e.id,e.level),n=this.getUpLevelMaterialDataList();for(var o in i-=e.exp,n){var a=f.default.instance.getItemNum(n[o].itemId),r=n[o].exp*a;a>0&&(t[n[o].itemId]=a),i>0&&r>0&&(i-=r)}for(var o in n){if(!(i>0))break;var s=Math.ceil(i/n[o].exp);i-=n[o].exp*s,t[n[o].itemId]?t[n[o].itemId]+=s:t[n[o].itemId]=s}return t},e.prototype.getGemstoneCfg=function(e){return this._gemstoneCfg.gemConf[e]},e.prototype.getGemstoneAttr=function(e){return this._gemstoneCfg.attr[e][0]},e.prototype.getGemstoneCfgByType=function(e){var t=[],i=this._gemstoneCfg.gemConf;for(var n in i)i[n].gemType==e&&t.push(parseInt(n));return t},e.prototype.getGemUpgradeCnt=function(e){return this._gemstoneCfg.gemConf[e].upgradeCnt},e.prototype.getGemGuidByGemType=function(e,t){var i=this.getGemstoneCfgByType(t),n=null;for(var o in i)for(var a in e)e[a]&&e[a].id==i[o]&&(n=e[a].guid);return n},e.prototype.isGemUPRedPoint=function(e,t){if(!e)return!1;if(e.gem.length<=0)return!1;if(!e.gem[t])return!1;var i=this.getGemType(e,t),n=this.getGemstoneCfgByType(i);if(!n||n.length<=0)return!1;var o=0;if(n[n.length-1]==e.gem[t])return!1;for(var a=0;a<n.length-1;++a){if(!(e.gem[t]>=n[a]))return!1;o=f.default.instance.getItemNum(n[a])+o;var r=this.getGemUpgradeCnt(n[a]);if(n[a]!=e.gem[t])o=o>=r?Math.floor(o/r):0;else if(o+1>=r)return!0}return!1},e.prototype.getGemstone=function(){return a.default.instance.getBagTypeListbyType(r.ItemType.material,r.ItemType.gemstone)},e.prototype.getGemClickIndex=function(e){if(!e)return null;for(var t=this.getItemByGuid(e),i=[],n=t.gem,o=this.getGemstone(),a=0;a<3;++a){var r=this.getGemType(t,a);if(n[a]){var s=n[a],l=this.getGemstoneCfg(s);if(p=this.getGemGuidByGemType(o,r)){var c=f.default.instance.getItemByGuid(p),d=0;if(c.id!=s&&c.id>s){d=1,i.push({index:a,type:d,level:l.level});continue}this.isGemUPRedPoint(t,a)&&(d=2,i.push({index:a,type:d,level:l.level}))}}else{var p;if(o.length>0)if(p=this.getGemGuidByGemType(o,r))return a}}return i.length>0?(i.sort(function(e,t){return e.type==t.type?e.level==t.level?e.index-t.index:e.level-t.level:e.type-t.type}),i[0].index):null},e.prototype.getGemType=function(e,t){var i=null;if(!e)return i;if(t<2){var n=this.getEquipBaseAttr(e.id),o=[];for(var a in n)n[a]&&o.push(parseInt(a));i=o[t]}else{switch(this.getEquipInfoById(e.id).buwei){case c.WearType.TYPE1:i=c.AttrType.Critical;break;case c.WearType.TYPE2:i=c.AttrType.Hit;break;case c.WearType.TYPE3:i=c.AttrType.Dodge;break;case c.WearType.TYPE4:i=c.AttrType.DefCri}}return i},e.prototype.getGameActionType=function(e,t){if(!e)return c.GemActionType.NULL;var i=this.getGemstone(),n=this.getGemType(e,t);if(i.length>0&&null!=n){var o=this.getGemGuidByGemType(i,n);if(o){var a=f.default.instance.getItemByGuid(o),r=e.gem[t]?e.gem[t]:0;if(!e.gem[t])return c.GemActionType.MOSAIC;if(a.id!=r&&a.id>r)return c.GemActionType.REPLACE}if(this.isGemUPRedPoint(e,t))return c.GemActionType.UPGRADE}return c.GemActionType.NULL},e.prototype.getRefineCfgData=function(e,t){var i=this.getEquipCfg(),n=this.getEquipInfoById(e)?this.getEquipInfoById(e).refine:1;return i.refine[n][t]},e.prototype.getMaxRefineLevel=function(e){var t=this.getEquipCfg(),i=this.getEquipInfoById(e)?this.getEquipInfoById(e).refine:1;return t.refine[i].length},e.prototype.getDecomposeCfg=function(e,t){var i=this._decomposeCfg.equip[e];for(var n in i)if(i[n].id==t)return i[n];return null},e.prototype.setItemMap=function(e,t,i){e[t]?e[t]+=i:e[t]=i},e.prototype.getEquipFlag=function(e,t){return void 0===t&&(t=null),!!this.getEquipUPlevFlag(e,t)||(!!this.getEquipUPStageFlag(e,t)||!!this.getGmeFlag(e,t))},e.prototype.getEquipWearFlag=function(e){if(!p.default.instance.checkIsOpenbyWindowtype(h.WindowType.CardEquip))return!1;for(var t=0;t<c.MaxEquipNum;++t){var i=this.getWearRedPointFlag(t,e);if(i)return i}return!1},e.prototype.getEquipUPlevFlag=function(e,t){if(void 0===t&&(t=null),!p.default.instance.checkIsOpenbyWindowtype(h.WindowType.Strengthen))return!1;var i=!1,n=this.getEquipList(e);if(null==t){for(var o in n)if(this.getUPLevelFalg(n[o])){i=!0;break}}else i=this.getUPLevelFalg(n[t]);return i},e.prototype.getUPLevelFalg=function(e){if(!e)return!1;if(e.level>=g.MyRoleInfo.level)return!1;var t=this.getMaxUPLevelData(e);if(e.level>=t)return!1;var i=this.getEquipUPLevelExpend(e);return!!(i.expFlag&&g.MyRoleInfo.money>=i.gold)},e.prototype.getEquipUPStageFlag=function(e,t){if(void 0===t&&(t=null),!p.default.instance.checkIsOpenbyWindowtype(h.WindowType.UpgradeStage))return!1;var i=!1,n=this.getEquipList(e);if(null==t){for(var o in n)if(this.UPStageFlag(n[o])){i=!0;break}}else i=this.UPStageFlag(n[t]);return i},e.prototype.UPStageFlag=function(e){if(!e)return!1;var t=this.getEquipInfoById(e.id),i=this._equipCfg.stage[t.stage][e.stage];if(!i)return!1;var n=this.getStageLimit(g.MyRoleInfo.level);if(e.stage+1>=n)return!1;var o=this.getMaxUPLevelData(e);if(e.level<o)return!1;var a=this._equipCfg.needItem[i.needItem];return!(a[0].count>f.default.instance.getItemNum(a[0].itemId))&&!(a[0].num>f.default.instance.getItemNum(e.id))},e.prototype.getEquipRefinefFlag=function(e,t){if(void 0===t&&(t=null),!p.default.instance.checkIsOpenbyWindowtype(h.WindowType.Refine))return!1;var i=!1,n=this.getEquipList(e);if(null==t){for(var o in n)if(this.refinefFlag(n[o])){i=!0;break}}else i=this.refinefFlag(n[t]);return i},e.prototype.refinefFlag=function(e){if(!e)return!1;var t=e.refineLevel>=0?e.refineLevel:0,i=this.getRefineCfgData(e.id,t);if(!i)return!1;var n=this.getMaxRefineLevel(e.id);if(e.refineLevel>=n-1)return!1;var o=i.consume[2]<=l.default.instance.GetMyWealth(c.WealthType.Money),a=f.default.instance.getItemNum(i.consume[0])>=i.consume[1];return!(!o||!a)},e.prototype.getGmeFlag=function(e,t){if(void 0===t&&(t=null),p.default.instance.checkIsOpenbyWindowtype(h.WindowType.Gemstone)){if(this.getEquipGemFlag(e,t))return!0;if(this.getEquipGemUPFlag(e,t))return!0}return!1},e.prototype.getEquipGemFlag=function(e,t){void 0===t&&(t=null);var i=!1,n=this.getEquipList(e);if(null==t){for(var o in n)if(this.gemFlag(n[o])){i=!0;break}}else i=this.gemFlag(n[t]);return i},e.prototype.gemFlag=function(e){if(!e)return!1;var t=this.getGemstone();if(t.length<=0)return!1;for(var i=e.gem,n=0;n<3;++n){var o=this.getGemType(e,n),a=this.getGemGuidByGemType(t,o);if(a){var r=f.default.instance.getItemByGuid(a),s=i[n]?i[n]:0;if(r.id!=s&&r.id>s)return!0}}return!1},e.prototype.getEquipGemUPFlag=function(e,t){void 0===t&&(t=null);var i=this.getEquipList(e),n=!1;if(null==t){for(var o in i)if(this.gemUPFlag(i[o])){n=!0;break}}else n=this.gemUPFlag(i[t]);return n},e.prototype.gemUPFlag=function(e){if(!e)return!1;for(var t=0;t<3;++t)if(e.gem[t]&&this.isGemUPRedPoint(e,t))return!0},e.prototype.getJumpCard=function(e){var t=this.getEquipInfoById(e.id);for(var i in n.MonsterType.MonsterWarTeam[n.MonsterType.MonsterBattle]){var o=n.MonsterType.MonsterWarTeam[n.MonsterType.MonsterBattle][i];if(!(o<=0)){var a=n.default.instance.getCardConfCardType(o);if(t.range[0]==a)return{cardID:o,equipType:t.buwei}}}var r=n.default.instance.GetMyCardRarity();return r[t.range[0]-1]?{cardID:r[t.range[0]-1].id,equipType:t.buwei}:null},e.prototype.getEquipTestAttr=function(e,t,i,n,o,a,r,s,l){void 0===n&&(n=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===r&&(r=0),void 0===s&&(s=0),void 0===l&&(l=0);var c=this.getCardCfg().Card[e].cardType;n>0&&(n-=1),o>0&&(o-=1),a>0&&(a-=1);var d=this.getEquipID(c,t,i);if(!d)return null;d.level=n,d.stage=o,d.refineLevel=a;var p=[],h=this.getTestGmeId(0,r);return p.push(h||null),h=this.getTestGmeId(1,s),p.push(h||null),h=this.getTestGmeId(2,l),p.push(h||null),d.gem=p,this.getEquipAttr(d)},e.prototype.getEquipID=function(e,t,i){var n=this._equipCfgbyQuality[e];for(var o in n){var a=s.default.creatItem(n[o].equipId,1);if(n[o].buwei==t&&a.colorIndex==i)return a}return null},e.prototype.getTestGmeId=function(e,t){var i=0,n=this._gemstoneCfg.gemConf;for(var o in n)if(n[o].gemType==e&&n[o].level==t){i=parseInt(o);break}return i},e.prototype.getEquipEffeictAddFlag=function(e){return!!(e&&e.effect&&e.effect.length>0)},e.prototype.getEquipEffectAddAttr=function(e){var t=n.default.instance.GetMonsterData(e);if(!t)return{};var i={};for(var o in t){var a=this.getItemByGuid(t.equip[o]);if(a&&!(a.effect&&a.effect.length>0)&&this.getEquipEffeictAddFlag(a))for(var r in a.effect){var s=this.getEquipEffectAttrCfg(a.effect[r],a.stage);y.default.setAttrMap(i,s.type,s.value)}}return i},e.prototype.getEquipEffectAttrCfg=function(e,t){var i=this._equipEffectCfg.equipEffect[1][e].level,n=this._equipEffectCfg.level[i].length;t<n?n=t:n-=1;var o=this._equipEffectCfg.level[i][n].attr;return this._equipEffectCfg.attr[o]},e}();i.default=m,cc._RF.pop()},{"../../../Core/ConfigsManager":"ConfigsManager","../../../Core/WindowType":"WindowType","../../../Global/GlobalValue":"GlobalValue","../../../Util/Utils":"Utils","../../../Util/UtilsFight":"UtilsFight","../../Functionicon/FunctionIconController":"FunctionIconController","../../Item/ItemController":"ItemController","../../Item/ItemData":"ItemData","../../Item/ItemModel":"ItemModel","../../Item/ItemType":"ItemType","../../Ornament/OrnamentCtrl":"OrnamentCtrl","../../Role/RoleController":"RoleController","../../Role/RoleInfo":"RoleInfo","../../WarTeam/MonsterController":"MonsterController"}],EquipEffect:[function(e,t,i){"use strict";cc._RF.push(t,"7ed8ao+Zo5Ie5GQbxDippVz","EquipEffect"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Core/TimeController"),a=e("../../../Core/LoadManager"),r=e("../../../GlobalContext"),s=e("../../../Util/Utils"),l=e("../../../Util/AttrUtil"),c=e("../../../Core/WindowManager"),d=e("../../WarTeam/MonsterController"),p=e("../../../Core/GameEventDispatcher"),h=e("../../../Core/Event"),u=e("../../../Core/Language"),f=cc._decorator,g=f.ccclass,y=f.property,m=function(e){function t(){var t=e.call(this)||this;return t.effectNode=[],t.attrImgs=null,i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.setActive=function(){this.isClick&&this.close()},t.prototype.close=function(){for(var e in this.effectNode)this.effectNode[e].active=!1;this.node.active=!1,c.default.instance.closeWindow(this.node)},t.prototype.setUPLevelEffect=function(){},t.prototype.setEquipUpStageEffect=function(e){this.setUpStageAttr(e,this.effectNode[1]),this.playEffect(this.effectNode[1])},t.prototype.playEffect=function(e){var t=this;this.isClick=!1,e.active=!0,this.node.active=!0;var i=e.getChildByName("tishen2").getComponent(cc.Animation);i&&i.on("finished",function(){o.default.instance.setTimeout(function(){t.isClick=!0},t,1e3)},this),i.pause("tishen2_ani1"),i.play("tishen2_ani1")},t.prototype.setEquipRefine=function(e){this.setRefineAttr(e,this.effectNode[2]),this.playEffect(this.effectNode[2])},t.prototype.setUpStageAttr=function(e,t){var i=t.getChildByName("attr").getChildByName("initInfo");t.getChildByName("attr").getChildByName("img").getChildByName("Label").getComponent(cc.Label).string=e.stageName,t.getChildByName("attr").getChildByName("img2").getChildByName("Label").getComponent(cc.Label).string=e.nextStageNmae;for(var n={},o=0;o<3;++o)0==o?(i.children[o].getChildByName("Label2").getComponent(cc.Label).string=e.maxlevel,i.children[o].getChildByName("Label3").getComponent(cc.Label).string=e.Nextmaxlevel,i.children[o].active=!0):1==o?(n[e.attr.type]=e.attr.val,n=d.default.instance.getAttrPrecentByGradeAndType(d.default.instance.data.MorphologicalTag,n),i.children[o].getChildByName("Label").getComponent(cc.Label).string=l.default.getAttrName(e.attr.type),i.children[o].getChildByName("Label2").getComponent(cc.Label).string=n[e.attr.type]+"",n[e.attr.type]=e.attr.nextVal,n=d.default.instance.getAttrPrecentByGradeAndType(d.default.instance.data.MorphologicalTag,n),i.children[o].getChildByName("Label3").getComponent(cc.Label).string=n[e.attr.type]+"",i.children[o].active=!0):2==o&&(n[e.attrTwo.type]=e.attrTwo.val,i.children[o].getChildByName("Label").getComponent(cc.Label).string=l.default.getAttrName(e.attrTwo.type),n=d.default.instance.getAttrPrecentByGradeAndType(d.default.instance.data.MorphologicalTag,n),i.children[o].getChildByName("Label2").getComponent(cc.Label).string=n[e.attrTwo.type]+"",n[e.attrTwo.type]=e.attrTwo.nextVal,n=d.default.instance.getAttrPrecentByGradeAndType(d.default.instance.data.MorphologicalTag,n),i.children[o].getChildByName("Label3").getComponent(cc.Label).string=n[e.attrTwo.type]+"",i.children[o].active=!0);for(var a=3;a<7;++a)e.equipEffectAttr[a-3]?(i.children[a].active=!0,i.children[a].getChildByName("Label").getComponent(cc.Label).string=l.default.getAttrName(e.equipEffectAttr[a-3].type),i.children[a].getChildByName("Label2").getComponent(cc.Label).string=u.default.getStr("{0}\u7ea7",e.equipEffectAttr[a-3].value),i.children[a].getChildByName("Label3").getComponent(cc.Label).string=u.default.getStr("{0}\u7ea7",e.equipEffectAttr[a-3].value2)):i.children[a].active=!1},t.prototype.setRefineAttr=function(e,t){var i=this;t.getChildByName("attr").getChildByName("New Label").active=!1,a.default.instance.loadResByType(r.GlobalContext.Root+"prefab/Equip/attr/AttrNodeTwo",cc.Prefab,function(n){var o=t.getChildByName("attr").getChildByName("initInfo");for(var a in s.default.setNodeChildDestoryByUrl(o,r.GlobalContext.Root+"prefab/Equip/attr/AttrNodeTwo"),e.attr=d.default.instance.getAttrPrecentByGradeAndType(d.default.instance.data.MorphologicalTag,e.attr),e.attr)if(e.attr[a]>0){var c=s.default.getNodeByUrl(n,r.GlobalContext.Root+"prefab/Equip/attr/AttrNodeTwo");c.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=i.attrImgs.getSpriteFrame("attrIcon_"+parseInt(a)),c.getChildByName("name").getComponent(cc.Label).string=l.default.getAttrName(parseInt(a)),c.getChildByName("attrValue").getComponent(cc.Label).string=e.attr[a]+"",o.addChild(c)}},this)},t.prototype.JumpTag=function(e,t){this.close(),p.GameEventDispatcher.instance.emit(h.EventDefiner.EQUIP_JumpTag,{index:parseInt(t)})},t.instance=null,__decorate([y([cc.Node])],t.prototype,"effectNode",void 0),__decorate([y(cc.SpriteAtlas)],t.prototype,"attrImgs",void 0),t=i=__decorate([g],t)}(n.default);i.default=m,cc._RF.pop()},{"../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Core/LoadManager":"LoadManager","../../../Core/TimeController":"TimeController","../../../Core/Widget":"Widget","../../../Core/WindowManager":"WindowManager","../../../GlobalContext":"GlobalContext","../../../Util/AttrUtil":"AttrUtil","../../../Util/Utils":"Utils","../../WarTeam/MonsterController":"MonsterController"}],EquipInfo:[function(e,t,i){"use strict";cc._RF.push(t,"2d9678T5tFOcJ/apTv8kFyV","EquipInfo"),Object.defineProperty(i,"__esModule",{value:!0});var n,o=e("../../Core/Widget"),a=e("../../NetConnect/NetConnet"),r=e("../Item/ItemIcon"),s=e("../WarTeam/MonsterController"),l=e("../../Core/Language"),c=e("../../Util/Utils"),d=e("../../Core/WindowType"),p=e("./EquipTypeNode"),h=e("./equip/EquipCtrl"),u=e("../../Util/NumberUtil"),f=cc._decorator,g=f.ccclass,y=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.titleImg=null,t.imgs=null,t.wearFlagNode=null,t.equipName=null,t.figthNode=null,t.text1=null,t.text2=null,t.text3=null,t.text4Node=null,t.attr1=null,t.attr2=null,t.attrPre=null,t.cardId=null,t.itemData=null,t.cardcfg=null,t.equipcfg=null,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.onLoad=function(){this.cardcfg=s.default.instance.data.getCardCfg(),this.equipcfg=h.default.instance.data.getEquipCfg()},t.prototype.show=function(){e.prototype.show.call(this),this.node.active=!0;var t=this.node.getChildByName("MaskBg");t.on(cc.Node.EventType.TOUCH_MOVE,this.hide,this),t.on(cc.Node.EventType.TOUCH_START,this.hide,this),t.on(cc.Node.EventType.TOUCH_END,this.hide,this),t.on(cc.Node.EventType.TOUCH_CANCEL,this.hide,this)},t.prototype.hide=function(){e.prototype.hide.call(this),this.hideNode(),this.cardId=null,this.itemData=null,this.node.active=!1,this.cardcfg=null,this.equipcfg=null;var t=this.node.getChildByName("MaskBg");t.off(cc.Node.EventType.TOUCH_MOVE,this.hideNode,this),t.off(cc.Node.EventType.TOUCH_START,this.hideNode,this),t.off(cc.Node.EventType.TOUCH_END,this.hideNode,this),t.off(cc.Node.EventType.TOUCH_CANCEL,this.hideNode,this)},t.prototype.hideNode=function(){for(var e=this.attr1.getChildByName("attrNode"),t=e.childrenCount-1;t>=0;t--)c.default.setNodeToPool(d.PoolType.equipTypeNode,e.children[t]);var i=this.attr2.getChildByName("attrNode");for(t=i.childrenCount-1;t>=0;t--)c.default.setNodeToPool(d.PoolType.equipTypeNode,i.children[t])},t.prototype.setData=function(e,t){if(this.hideNode(),e){this.cardcfg=s.default.instance.data.getCardCfg(),this.equipcfg=h.default.instance.data.getEquipCfg(),this.itemData=e,this.cardId=t,this.node.getChildByName("ItemIcon").getComponent(r.default).ItemData(this.itemData,!1),this.titleImg.spriteFrame=this.imgs.getSpriteFrame("base"+this.itemData.colorIndex);var i=u.NumberUtil.unitsDigitToText(this.itemData.stage+1)+l.default.getStr("rank");this.equipName.string=l.default.getStr(i)+this.itemData.name,this.equipName.node.color=this.itemData.color;var n=l.default.getStr("\u4f4d\u7f6e"),o=h.default.instance.data.getEquipInfoById(this.itemData.id);for(var a in o.range)n+=this.getRangeText(o.range[a]);this.text1.string=n,this.text2.string=l.default.getStr("\u5f3a\u5316\u7b49\u7ea7"),this.text3.string=this.itemData.level+"",this.text3.node.color=cc.color(0,202,71);var f,g=this.equipcfg,y=g.level[o.level][this.itemData.level],m=g.stage[o.stage][this.itemData.stage],C=g.randomAttr[m.randomAttr];for(var a in o.range)f=o.range[a];var v=null,_=null,b=null;switch(f){case 1:v=1.857143,_=.84,b=.77;break;case 2:v=1.3,_=1.2,b=1.1;break;case 3:v=1,_=1.56,b=1.43}for(var T=null,S=null,I=null,w=0;w<y.prop.length;w++){if(0!=y.prop[w]){var D=c.default.getNodeByPool(d.PoolType.equipTypeNode,this.attrPre);D.getComponent(p.default).initEventNode(1,w,y.prop[w]),this.attr1.getChildByName("attrNode").addChild(D)}switch(w){case 0:S=y.prop[w]*b;break;case 1:S=y.prop[w]*v;break;case 2:S=y.prop[w]*_;break;case 3:case 4:case 5:case 6:S=3*y.prop[w]}I+=S}var R=null;for(w=0;w<this.itemData.randomIndex.length;w++){var A=c.default.getNodeByPool(d.PoolType.equipTypeNode,this.attrPre);switch(A.getComponent(p.default).initEventNode(1,this.itemData.randomIndex[w],C[this.itemData.randomIndex[w]].value),this.attr2.getChildByName("attrNode").addChild(A),C[this.itemData.randomIndex[w]].type){case 0:R=C[this.itemData.randomIndex[w]].value*b;break;case 1:R=C[this.itemData.randomIndex[w]].value*v;break;case 2:R=C[this.itemData.randomIndex[w]].value*_;break;case 3:case 4:case 5:case 6:R=3*C[this.itemData.randomIndex[w]].value}T+=R}this.figthNode.getChildByName("label").getComponent(cc.Label).string=Math.ceil(I+=T)+"",this.setWearInfo()}},t.prototype.setWearInfo=function(){this.itemData.ower>=0?(this.wearFlagNode.active=!0,this.text4Node.active=!0,this.text4Node.getComponent(cc.Label).string=l.default.getStr("\u6b64\u88c5\u5907{0}\u88c5\u5907\u4e2d",this.cardcfg.Card[this.cardId].cardName),this.node.getChildByName("btnReplace").active=!1):(this.wearFlagNode.active=!1,this.text4Node.active=!1,this.node.getChildByName("btnReplace").active=!0)},t.prototype.onClickWearEquip=function(){var e={cmd:"takeonequip",id:this.cardId,equipGuid:this.itemData.guid};a.default.instance.sendProto(e),this.hide()},t.prototype.getRangeText=function(e){var t=" ";switch(e){case n.Front:case n.Front:case n.Front:t+=l.default.getStr("\u524d\u6392")}return t},__decorate([y(cc.Sprite)],t.prototype,"titleImg",void 0),__decorate([y(cc.SpriteAtlas)],t.prototype,"imgs",void 0),__decorate([y(cc.Node)],t.prototype,"wearFlagNode",void 0),__decorate([y(cc.Label)],t.prototype,"equipName",void 0),__decorate([y(cc.Node)],t.prototype,"figthNode",void 0),__decorate([y(cc.Label)],t.prototype,"text1",void 0),__decorate([y(cc.Label)],t.prototype,"text2",void 0),__decorate([y(cc.Label)],t.prototype,"text3",void 0),__decorate([y(cc.Node)],t.prototype,"text4Node",void 0),__decorate([y(cc.Node)],t.prototype,"attr1",void 0),__decorate([y(cc.Node)],t.prototype,"attr2",void 0),__decorate([y(cc.Prefab)],t.prototype,"attrPre",void 0),t=__decorate([g],t)}(o.default);i.default=m,function(e){e[e.Front=1]="Front",e[e.centre=2]="centre",e[e.back=3]="back"}(n=i.EquipRange||(i.EquipRange={})),cc._RF.pop()},{"../../Core/Language":"Language","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../NetConnect/NetConnet":"NetConnet","../../Util/NumberUtil":"NumberUtil","../../Util/Utils":"Utils","../Item/ItemIcon":"ItemIcon","../WarTeam/MonsterController":"MonsterController","./EquipTypeNode":"EquipTypeNode","./equip/EquipCtrl":"EquipCtrl"}],EquipTipAttrStr:[function(e,t,i){"use strict";cc._RF.push(t,"b9b68mKBwBOy5Q4TMujyMJ4","EquipTipAttrStr"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Item/ItemData"),o=e("../../Core/Language"),a=e("../../Global/GlobalValue"),r=e("../../Util/AttrUtil"),s=e("../Equip/equip/EquipCtrl"),l=e("../WarTeam/MonsterController"),c=e("../../Util/Utils"),d=e("../../Core/WindowType"),p=e("../Functionicon/FunctionIconController"),h=e("../../Util/ColorUtil"),u=e("../Ornament/OrnamentCtrl"),f=function(){function e(){}return e.prototype.setStr=function(e,t,i,n,o){void 0===o&&(o=null),c.default.setNodeChildDestroy(e);var a=0;if(i)for(var r=0;r<=5;++r){if(""!=(s=this.getText(r,n,o,i)))(l=cc.instantiate(t)).getChildByName("text").getComponent(cc.RichText)||l.getChildByName("text").addComponent(cc.RichText),(d=l.getChildByName("text").getComponent(cc.RichText)).string="",d.maxWidth=342,d.lineHeight=26,d.string+=s,l.active=!0,l.y-=a,a+=l.getChildByName("text").height+10,e.addChild(l)}else for(r=2;r<=3;++r){var s,l,d;if(""!=(s=this.getText(r,n,o,i)))(l=cc.instantiate(t)).getChildByName("text").getComponent(cc.RichText)||l.getChildByName("text").addComponent(cc.RichText),(d=l.getChildByName("text").getComponent(cc.RichText)).string="",d.maxWidth=342,d.lineHeight=26,d.string+=s,l.active=!0,l.y=a,a+=l.getChildByName("text").height+10,e.addChild(l)}e.height=a},e.prototype.getText=function(e,t,i,n){void 0===n&&(n=!0);var o="";switch(e){case a.EqupiTipsAttrType.BASE_ATTR:o=this.setBaseAttr(t);break;case a.EqupiTipsAttrType.UP_LEVEL_ATTR:o=n?this.setupLevelStr(t,i):this.setOrnamentUpAttr(t);break;case a.EqupiTipsAttrType.UP_STAGE_ATTR:o=n?this.setStageAttr(t):this.setOrnamentStage(t);break;case a.EqupiTipsAttrType.REFINE_ATTR:o=this.setRefineAttr(t);break;case a.EqupiTipsAttrType.GEMSTONE_ATTR:o=this.setGemAttr(t);break;case a.EqupiTipsAttrType.EQUIP_EFFECT_ATTR:o=this.setEquipEffectAttr(t)}return o},e.prototype.setBaseAttr=function(e){var t=this.setTitle(a.EqupiTipsAttrType.BASE_ATTR),i={};s.default.instance.data.getEquipBaseAttrMap(e.id,i),i=l.default.instance.getAttrPrecentByGradeAndType(1,i);var n=this.setAttrList(i);for(var o in n)t+="    "+this.steAttr(n[o].type,n[o].value,0,20,n.length-1!=parseInt(o));return t},e.prototype.setupLevelStr=function(e,t){void 0===t&&(t=null);var i="";if(p.default.instance.checkIsOpenbyWindowtype(d.WindowType.Strengthen)&&e.level>0){i+=this.setTitle(a.EqupiTipsAttrType.UP_LEVEL_ATTR,e.level.toString());var n=["img_up","img_decline"],o={},r=s.default.instance.data.getCalculateEquipStrengthenAttr(e.id,e.level);o=l.default.instance.getAttrPrecentByGradeAndType(1,r);var c=this.setAttrList(o),h=null;if(t){var u=s.default.instance.data.getCalculateEquipStrengthenAttr(t.id,t.level);o=l.default.instance.getAttrPrecentByGradeAndType(1,u),h=this.setAttrList(o)}for(var f in c){var g=!1;if(t||c.length-1==parseInt(f)||(g=!0),i+="    "+this.steAttr(c[f].type,c[f].value,3,20,g),t){var y=h&&h[f]&&h[f].value?h[f].value:0,m=c[f].value>y?0:1;i+=" "+this.setImg(n[m],11,14),c.length-1!=parseInt(f)&&(i+="<br/>")}}}return i},e.prototype.setStageAttr=function(e){var t="";if(p.default.instance.checkIsOpenbyWindowtype(d.WindowType.UpgradeStage)){var i=e.stage?e.stage+1:1;t+=this.setTitle(a.EqupiTipsAttrType.UP_STAGE_ATTR,i.toString());var n=s.default.instance.data.getEquipCfg(),o=s.default.instance.data.getEquipInfoById(e.id),r=n.stage[o.stage][e.stage].randomAttr,c=n.randomAttr[r],h={};s.default.instance.data.getEquipStageAttr(h,c),h=l.default.instance.getAttrPrecentByGradeAndType(1,h);var u=this.setAttrList(h);for(var f in u)t+="    "+this.steAttr(u[f].type,u[f].value,1,20,u.length-1!=parseInt(f))}return t},e.prototype.setRefineAttr=function(e){var t="";if(p.default.instance.checkIsOpenbyWindowtype(d.WindowType.Refine)){var i=e.refineLevel>=0?e.refineLevel:0,n=o.default.getStr("{0}{1}\u661f",c.default.getQualityName(Math.ceil((i+1)/10)),Math.floor(i%10+1));t+=this.setTitle(a.EqupiTipsAttrType.UP_STAGE_ATTR,n);var r,h=s.default.instance.data.getEquipCfg(),u=s.default.instance.data.getEquipInfoById(e.id),f=h.refine[u.refine][i].attr;r=l.default.instance.getAttrPrecentByGradeAndType(1,f);var g=this.setAttrList(r);for(var y in g)t+="    "+this.steAttr(g[y].type,g[y].value,1,20,g.length-1!=parseInt(y))}return t},e.prototype.setGemAttr=function(e){var t="";if(e.gem.length>0&&(e.gem[0]||e.gem[1]||e.gem[2])){t+=this.setTitle(a.EqupiTipsAttrType.GEMSTONE_ATTR);for(var i=0;i<3;++i)if(e.gem[i]){var d=s.default.instance.data.getGemstoneCfg(e.gem[i]),p=s.default.instance.data.getGemstoneAttr(d.attr),h=n.default.creatItem(e.gem[i],1);h&&(t+="    "+this.setImg(h.ItemIcon,23,23));var u={};u[p.type]=p.value,u=l.default.instance.getAttrPrecentByGradeAndType(1,u);var f=r.default.getAttrName(p.type);t+=this.setColorAndSize(0,20,o.default.getStr("{0}\u7ea7{1}\u5b9d\u77f3",d.level,f)),t+="  "+this.steAttr(p.type,c.default.getGemVal(p.type,u[p.type],!0),1,20,3!=i)}}return t},e.prototype.setEquipEffectAttr=function(e){var t="";if(e.effect&&e.effect.length>0)for(var i in t+=this.setTitle(a.EqupiTipsAttrType.EQUIP_EFFECT_ATTR),e.effect)if(e.effect[i]>=0){var n=s.default.instance.data.getEquipEffectAttrCfg(e.effect[i],e.stage),l=r.default.getAttrName(n.type),d="attrIcon_"+r.default.getAttrIconID(n.type),p="  "+this.setImg(d,24,24)+this.setColorAndSizeTwo("#fe8612",20,o.default.getStr("{0}\u7ea7",e.stage+1)+l)+"<br/>      "+this.setColorAndSize(1,20,r.default.getEquipEffectAttrDesc(n.type,c.default.getAttrValStr(n.type,n.value)));e.effect.length-1!=parseInt(i)&&(p+="<br/>"),t+=p}return t},e.prototype.setOrnamentUpAttr=function(e){var t=this.setTitle(a.EqupiTipsAttrType.UP_LEVEL_ATTR,e.level.toString()),i={};u.default.instance.data.getLevelAttr(i,e),i=l.default.instance.getAttrPrecentByGradeAndType(1,i);var n=0;for(var o in i)i[o]&&(t+="    "+this.steAttr(parseInt(o),i[o],1,20,Object.keys(o).length-1!=n)),n+=1;return t},e.prototype.setOrnamentStage=function(e){var t="";if(e.stage>0){t+=this.setTitle(a.EqupiTipsAttrType.UP_STAGE_ATTR,e.stage.toString());var i={};u.default.instance.data.getStageAttr(i,e),i=l.default.instance.getAttrPrecentByGradeAndType(1,i);var n=0;for(var o in i)i[o]&&(t+="    "+this.steAttr(parseInt(o),i[o],1,20,Object.keys(o).length-1!=n)),n+=1}return t},e.prototype.setImg=function(e,t,i){void 0===e&&(e="line"),void 0===t&&(t=342),void 0===i&&(i=2);return o.default.getStr1("<img src='{0}' width={1} height={2} align=top />",[e,t,i])},e.prototype.setTitle=function(e,t){void 0===t&&(t="");var i=null;switch(e){case a.EqupiTipsAttrType.BASE_ATTR:i=o.default.getStr("equipTips_0");break;case a.EqupiTipsAttrType.UP_LEVEL_ATTR:i=o.default.getStr("equipTips_1",t);break;case a.EqupiTipsAttrType.UP_STAGE_ATTR:i=o.default.getStr("equipTips_2",t);break;case a.EqupiTipsAttrType.REFINE_ATTR:i=o.default.getStr("equipTips_3",t);break;case a.EqupiTipsAttrType.GEMSTONE_ATTR:i=o.default.getStr("equipTips_4");break;case a.EqupiTipsAttrType.EQUIP_EFFECT_ATTR:i=o.default.getStr("equipTips_5")}return"  "+(i=this.setColorAndSize(4,22,i))+"<br/>"},e.prototype.steAttr=function(e,t,i,n,o){void 0===i&&(i=0),void 0===n&&(n=20),void 0===o&&(o=!0);var a=this.setColorAndSize(i,n,r.default.getAttrName(e)+"\uff1a"+t);return o&&(a+="<br/>"),a},e.prototype.setAttrList=function(e){var t=[];for(var i in e){var n={type:parseInt(i),value:e[i]};t.push(n)}return t},e.prototype.setSize=function(e,t){return o.default.getStr1("<size={0}>{1}</size>",[e,t])},e.prototype.setColor=function(e,t){return o.default.getStr1("<color={0}>{1}</color>",[h.ColorUtil.colorStr(e),t])},e.prototype.setColorAndSize=function(e,t,i){return this.setColor(e,this.setSize(t,i))},e.prototype.setColorAndSizeTwo=function(e,t,i){return o.default.getStr1("<color={0}>{1}</color>",[e,this.setSize(t,i)])},e.instance=new e,e}();i.default=f,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../Util/AttrUtil":"AttrUtil","../../Util/ColorUtil":"ColorUtil","../../Util/Utils":"Utils","../Equip/equip/EquipCtrl":"EquipCtrl","../Functionicon/FunctionIconController":"FunctionIconController","../Item/ItemData":"ItemData","../Ornament/OrnamentCtrl":"OrnamentCtrl","../WarTeam/MonsterController":"MonsterController"}],EquipTips:[function(e,t,i){"use strict";cc._RF.push(t,"36d4aF665BONK6z6CHvRc5x","EquipTips"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Ornament/OrnamentCtrl"),o=e("../Item/ItemIcon"),a=e("../Equip/equip/EquipCtrl"),r=e("../../Util/UtilsFight"),s=e("../../Core/Language"),l=e("../../Global/GlobalValue"),c=e("../WarTeam/MonsterController"),d=e("../../Util/AttrUtil"),p=e("../../Core/Window"),h=e("../../Util/Utils"),u=e("../../Util/NumberUtil"),f=e("../../GlobalContext"),g=e("../../Core/CommonsResManager"),y=e("../Commons/Image"),m=e("./EquipTipAttrStr"),C=e("../Functionicon/FunctionIconController"),v=e("../../Core/WindowType"),_=cc._decorator,b=_.ccclass,T=_.property,S=function(e){function t(){var t=e.call(this)||this;return t.qualityAtlas=null,t.attrItem=null,t._callbackFunction=null,t._callbackObj=null,t._btnStr=null,t._callbackFunctionTwo=null,t._callbackObjTwo=null,t._btnStrTwo=null,i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.node.getChildByName("MaskBg").getComponent("StopClickEventComponent").MaskClic0kIsClose=!0},t.prototype.show=function(){this.node.getChildByName("MaskBg").on(cc.Node.EventType.TOUCH_START,this.clearTips,this)},t.prototype.hide=function(){this.node.getChildByName("MaskBg").off(cc.Node.EventType.TOUCH_START,this.clearTips,this)},t.prototype.setData=function(e,t,i,o,a,r,s,l,c){void 0===t&&(t=null),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),void 0===r&&(r=null),void 0===s&&(s=null),void 0===l&&(l=null),void 0===c&&(c=null),this._callbackFunction=o,this._callbackObj=a,this._btnStr=r,this._callbackFunctionTwo=s,this._callbackObjTwo=l,this._btnStrTwo=c,this.setBaseInfo(e,t,i),this.setWearInfo(e);var d=n.default.instance.data.ornamentFlag(e.id);this.setAttrs(e,t,d),this.setBtnShow()},t.prototype.setAttrs=function(e,t,i){var n=this.node.getChildByName("equipTips").getChildByName("attrs").getComponent(cc.ScrollView);m.default.instance.setStr(n.content,this.attrItem,!i,e,t),n.content.height>304?(n.node.height=304,n.node.children[0].height=304,n.content.parent.children[1].active=!0,n.content.parent.children[1].y=-281.5,n.content.height+=22.5,n.content.parent.children[1].children[0].active=!0,n.content.parent.children[1].children[1].active=!1):(n.node.height=n.content.height,n.node.children[0].height=n.content.height,n.content.parent.children[1].active=!1),n.scrollToTop()},t.prototype.scrollEventImg=function(){var e=this.node.getChildByName("equipTips").getChildByName("attrs").getComponent(cc.ScrollView);if(e.content.height>304){var t=e.content.height-304,i=e.getScrollOffset();i.y<=0?(e.content.parent.children[1].children[0].active=!0,e.content.parent.children[1].children[1].active=!1):i.y>=t&&(e.content.parent.children[1].children[0].active=!1,e.content.parent.children[1].children[1].active=!0)}},t.prototype.setBaseInfo=function(e,t,i){var a=this.node.getChildByName("equipTips").getChildByName("node"),r=n.default.instance.data.ornamentFlag(e.id);a.getChildByName("bg").getComponent(cc.Sprite).spriteFrame=this.qualityAtlas.getSpriteFrame("base"+e.colorIndex);var s=a.getChildByName("left");s.getChildByName("ItemIcon").getComponent(o.default).ItemData(e),s.getChildByName("wearFlag").active=e.ower>0||e.belongcardid>0,s.getChildByName("upFlag").active=!!t&&this.getUpFlag(e,t,i);var l=a.getChildByName("right");l.getChildByName("equipName").getComponent(cc.Label).string=r?this.getOrnamentName(e):this.getEquipName(e),l.getChildByName("fight").getChildByName("label").getComponent(cc.Label).string=r?this.cptOrnamentFight(e,i)+"":this.cptEquipFight(e)+""},t.prototype.setWearInfo=function(e){var t=n.default.instance.data.ornamentFlag(e.id),i=this.node.getChildByName("equipTips").getChildByName("node1"),o="",r="";if(t)r=s.default.getStr("\u4f4d\u7f6e{0}",s.default.getStr("equipTipsStr_01",s.default.getStr("\u914d\u9970"))),e.belongcardid>0&&(o=c.default.instance.GetMonsterInfo(e.belongcardid).cardName);else{var l=a.default.instance.data.getEquipInfoById(e.id),d=s.default.getStr("equipTipsStr_01",this.getRangeNameTwo(l.range))+s.default.getStr("equipTipsStr_01",this.getWearName(l.buwei));r=s.default.getStr("\u4f4d\u7f6e{0}",d),e.ower>0&&(o=c.default.instance.GetMonsterInfo(e.ower).cardName)}i.getChildByName("RichText").getComponent(cc.RichText).string=r;var p=this.node.getChildByName("equipTips").getChildByName("node2");p.active=e.ower>0||e.belongcardid>0,p.children[3].getComponent(cc.RichText).string=s.default.getStr("\u6b64\u88c5\u5907{0}\u88c5\u5907\u4e2d",o),p.children[2].children[0].getComponent(cc.Sprite).spriteFrame=g.default.instance.getSpriteFrameByName("bag"+e.colorIndex);var h=f.GlobalContext.ResRoot+"resources/itemicon/"+e.ItemIcon+".png";p.children[2].children[1].getComponent(y.default).loadImageByHttps(h),p.children[2].children[1].active=!0},t.prototype.setItemIcon=function(e,t){if(t){var i=f.GlobalContext.ResRoot+"resources/itemicon/"+t.ItemIcon+".png";h.default.setImage(e,i)}},t.prototype.setBtnShow=function(){var e=this.node.getChildByName("equipTips").getChildByName("btnNode");e.getChildByName("btn_01").active=!!this._callbackFunction,this._btnStr&&(e.getChildByName("btn_01").getChildByName("Label").getComponent(cc.Label).string=this._btnStr),e.getChildByName("btn_02").active=!!this._callbackFunctionTwo,this._btnStrTwo&&(e.getChildByName("btn_02").getChildByName("Label").getComponent(cc.Label).string=this._btnStrTwo)},t.prototype.getUpFlag=function(e,t,i){var o=0,a=0;return n.default.instance.data.ornamentFlag(e.id)?(o=this.cptOrnamentFight(e,i),a=this.cptOrnamentFight(t,i)):(o=this.cptEquipFight(e),a=this.cptEquipFight(t)),o>a},t.prototype.cptEquipFight=function(e){var t=a.default.instance.data.getEquipInfoById(e.id);return r.default.cptFight(t.range[0],a.default.instance.data.getEquipAttr(e))},t.prototype.cptOrnamentFight=function(e,t){return t||(t=e.belongcardid>0?c.default.instance.data.getCardCfg().Card[e.belongcardid].cardType:2),r.default.cptFight(t,n.default.instance.data.getOrnamentAttr(e,t))},t.prototype.getOrnamentName=function(e){var t=e.name;return e.stage>0&&(t=u.NumberUtil.unitsDigitToText(e.stage)+s.default.getStr("rank")+t),t},t.prototype.getEquipName=function(e){var t=e.name;if(e.refineLevel>0){var i=Math.ceil((e.refineLevel+1)/10);t=h.default.getQualityName(i)+t}var n=C.default.instance.checkIsOpenbyWindowtype(v.WindowType.UpgradeStage);return e.ower>0&&n&&(t=u.NumberUtil.unitsDigitToText(e.stage+1)+s.default.getStr("rank")+t),t},t.prototype.getRangeNameTwo=function(e){var t=null;for(var i in e)t=this.getRangeName(e[i]);return t},t.prototype.getRangeName=function(e){var t=null;switch(e){case l.RangeType.TYPE1:t=s.default.getStr("\u524d\u6392");break;case l.RangeType.TYPE2:t=s.default.getStr("\u4e2d\u6392");break;case l.RangeType.TYPE3:t=s.default.getStr("\u540e\u6392")}return t},t.prototype.getWearName=function(e){var t=null;switch(e){case l.WearType.TYPE1:t=s.default.getStr("\u6b66\u5668");break;case l.WearType.TYPE2:t=s.default.getStr("\u5934\u90e8");break;case l.WearType.TYPE3:t=s.default.getStr("\u8863\u670d");break;case l.WearType.TYPE4:t=s.default.getStr("\u978b\u5b50")}return t},t.prototype.setAttrStr=function(e,t){for(var i in e.children)t[i]?(e.children[i].active=!0,e.children[i].getChildByName("name").getComponent(cc.Label).string=d.default.getAttrName(t[i].type)+"\uff1a",e.children[i].getChildByName("val").getComponent(cc.Label).string=this.getAttrStr(t[i].val,t[i].type)):e.children[i].active=!1},t.prototype.setAttrList=function(e,t){for(var i in e)if(e[i]){var n={type:parseInt(i),val:e[i]};t.push(n)}},t.prototype.onClickBtn=function(e){1==Number(e)?this._callbackFunctionTwo&&this._callbackFunctionTwo.call(this._callbackObjTwo):this._callbackFunction&&this._callbackFunction.call(this._callbackObj),this.clearTips()},t.prototype.getAttrStr=function(e,t){var i="";return i+=e,t>=l.AttrType.MaxHp_P&&(i=Math.floor(100*e)+"%"),i},t.prototype.clearTips=function(){this.hide(),e.prototype.close.call(this)},t.instance=null,__decorate([T(cc.SpriteAtlas)],t.prototype,"qualityAtlas",void 0),__decorate([T(cc.Node)],t.prototype,"attrItem",void 0),t=i=__decorate([b],t)}(p.default);i.default=S,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Language":"Language","../../Core/Window":"Window","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/AttrUtil":"AttrUtil","../../Util/NumberUtil":"NumberUtil","../../Util/Utils":"Utils","../../Util/UtilsFight":"UtilsFight","../Commons/Image":"Image","../Equip/equip/EquipCtrl":"EquipCtrl","../Functionicon/FunctionIconController":"FunctionIconController","../Item/ItemIcon":"ItemIcon","../Ornament/OrnamentCtrl":"OrnamentCtrl","../WarTeam/MonsterController":"MonsterController","./EquipTipAttrStr":"EquipTipAttrStr"}],EquipTypeNodeTwo:[function(e,t,i){"use strict";cc._RF.push(t,"cad28YqfCBC/YiSK2L01fIJ","EquipTypeNodeTwo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Util/AttrUtil"),a=e("../../Item/ItemData"),r=e("../equip/EquipCtrl"),s=e("../../../Global/GlobalValue"),l=e("../../../Util/Utils"),c=e("../../../GlobalContext"),d=cc._decorator,p=d.ccclass,h=d.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.imgs=null,t.isUpList=[],t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.hide=function(){for(var t in e.prototype.hide.call(this),this.node.children)this.node.children[t].active=!1},t.prototype.initEventNode=function(e,t,i,n,s){for(var c in this.node.children)this.node.children[c].active=!1;var d="typeNode"+e,p=this.node.getChildByName(d);if(4!=e&&(p.getChildByName("sprType").getComponent(cc.Sprite).spriteFrame=this.imgs.getSpriteFrame("attrIcon_"+o.default.getAttrIconID(t)),p.getChildByName("name").getComponent(cc.Label).string=o.default.getAttrName(t),p.getChildByName("typeNum").getComponent(cc.Label).string="+"+l.default.getAttrValStr(t,i)),2==e&&(p.getChildByName("sprUpOrDown").active=0!=n,0!=n&&(p.getChildByName("sprUpOrDown").getComponent(cc.Sprite).spriteFrame=this.isUpList[n-1])),3==e&&(p.getChildByName("typeNumUp").getComponent(cc.Label).string=this.getAttrStr(s,t)+""),4==e){var h=a.default.creatItem(i,1),u=r.default.instance.data.getGemstoneCfg(h.id);this.setItemIcon(p.getChildByName("sprType"),h),p.getChildByName("name").getComponent(cc.Label).string=u.name;var f=r.default.instance.data.getGemstoneAttr(u.attr),g={};g[f.type]=f.value;var y=o.default.getAttrName(f.type)+l.default.getGemVal(f.type,g[f.type],!0);p.getChildByName("typeNum").getComponent(cc.Label).string=y}this.node.width=p.width,this.node.height=p.height,p.active=!0},t.prototype.setItemIcon=function(e,t){if(t){var i=c.GlobalContext.ResRoot+"resources/itemicon/"+t.ItemIcon+".png";l.default.setImage(e,i),e.scale=.4}},t.prototype.getAttrStr=function(e,t){var i="";return i+=e,t>=s.AttrType.MaxHp_P&&(i=Math.floor(100*e)+"%"),i},__decorate([h(cc.SpriteAtlas)],t.prototype,"imgs",void 0),__decorate([h([cc.SpriteFrame])],t.prototype,"isUpList",void 0),t=__decorate([p],t)}(n.default);i.default=u,cc._RF.pop()},{"../../../Core/Widget":"Widget","../../../Global/GlobalValue":"GlobalValue","../../../GlobalContext":"GlobalContext","../../../Util/AttrUtil":"AttrUtil","../../../Util/Utils":"Utils","../../Item/ItemData":"ItemData","../equip/EquipCtrl":"EquipCtrl"}],EquipTypeNode:[function(e,t,i){"use strict";cc._RF.push(t,"985608wPG1C5K5LjiBOBvJO","EquipTypeNode"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/Language"),a=cc._decorator,r=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.typeList=[],t.isUpList=[],t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.hide=function(){for(var t in e.prototype.hide.call(this),this.node.children)this.node.children[t].active=!1},t.prototype.initEventNode=function(e,t,i,n,a){for(var r in this.node.children)this.node.children[r].active=!1;var s="typeNode"+e,l=this.node.getChildByName(s);l.getChildByName("sprType").getComponent(cc.Sprite).spriteFrame=this.typeList[t];var c="attr_type_"+t;l.getChildByName("name").getComponent(cc.Label).string=o.default.getStr(c),l.getChildByName("typeNum").getComponent(cc.Label).string="+"+i,2==e&&(l.getChildByName("sprUpOrDown").active=0!=n,0!=n&&(l.getChildByName("sprUpOrDown").getComponent(cc.Sprite).spriteFrame=this.isUpList[n-1])),3==e&&(l.getChildByName("typeNumUp").getComponent(cc.Label).string=a+""),l.active=!0},__decorate([s([cc.SpriteFrame])],t.prototype,"typeList",void 0),__decorate([s([cc.SpriteFrame])],t.prototype,"isUpList",void 0),t=__decorate([r],t)}(n.default);i.default=l,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/Widget":"Widget"}],EquipWin:[function(e,t,i){"use strict";cc._RF.push(t,"73593Uw5fpBhpgb+ErfaCNx","EquipWin"),Object.defineProperty(i,"__esModule",{value:!0});var n,o=e("../../Core/WindowType"),a=e("../Functionicon/FunctionIconController"),r=e("../../Util/GrayEffect"),s=e("../../Core/Widget"),l=e("../../GlobalContext"),c=e("../../Core/LoadManager"),d=e("../../Util/Utils"),p=e("./equip/Strengthen"),h=e("./equip/Gemstone"),u=e("./equip/Refine"),f=e("./equip/UpgradeStage"),g=e("./equip/EquipCtrl"),y=e("../WarTeam/WarTeamMonsterInfo"),m=e("../Item/ItemType"),C=e("../../Core/GameEventDispatcher"),v=e("../../Core/Event"),_=e("../Tips/OpTipsController"),b=e("../../Core/Language"),T=e("../../Core/WindowManager"),S=e("./equip/EquipEffect"),I=e("../Role/RoleStrengthen/RoleStrengthenController"),w=e("../../Util/NumberUtil");(function(e){e[e.Strengthen=0]="Strengthen",e[e.UpgradeStage=1]="UpgradeStage",e[e.Gemstone=2]="Gemstone",e[e.Refine=3]="Refine"})(n=i.euqipTag||(i.euqipTag={}));var D=cc._decorator,R=D.ccclass,A=D.property,N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tagNode=[],t.attrImgs=null,t._itemGuid=null,t._tagIndex=0,t._viewIndex=null,t.BtnWindowType=[o.WindowType.Strengthen,o.WindowType.UpgradeStage,o.WindowType.Gemstone],t._viewNodeMap={},t.prefabName=["Strengthen","UpgradeStage","Gemstone"],t.strengThen=!1,t.upgradStage=!1,t.refine=!1,t.CardFlag=!1,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this),this.node.getChildByName("effectNode")&&(this.node.getChildByName("effectNode").active=!1),this.InitBtnShow(),this.addEvent()},t.prototype.hide=function(){e.prototype.hide.call(this),this.node.getChildByName("effectNode")&&(this.node.getChildByName("effectNode").active=!1),this._tagIndex=0,this._itemGuid=null,this._viewIndex=null,this.node.getChildByName("infoNode").destroyAllChildren(),this._viewNodeMap={},this.removeEvent(),this.strengThen=!1,this.upgradStage=!1,this.refine=!1},t.prototype.addEvent=function(){C.GameEventDispatcher.instance.on(v.EventDefiner.EQUIP_upgrade_ret,this.upEffect,this),C.GameEventDispatcher.instance.on(v.EventDefiner.EQUIP_upgrade_stage_ret,this.upEffect,this),C.GameEventDispatcher.instance.on(v.EventDefiner.EQUIP_UP_Refine,this.upRefine,this),C.GameEventDispatcher.instance.on(v.EventDefiner.EQUIP_up_GemInfo,this.upRedPoint,this),C.GameEventDispatcher.instance.on(v.EventDefiner.itemAddUP,this.upRedPoint,this),C.GameEventDispatcher.instance.on(v.EventDefiner.itemchangeUP,this.upRedPoint,this),C.GameEventDispatcher.instance.on(v.EventDefiner.EQUIP_JumpTag,this.JumpTag,this)},t.prototype.upRedPoint=function(){if(this._itemGuid){var e=g.default.instance.data.getItemByGuid(this._itemGuid);if(e){var t=g.default.instance.data.getEquipInfoById(e.id).buwei;this.tagNode[0].getChildByName("red").active=this.CardFlag&&g.default.instance.data.getEquipUPlevFlag(e.ower,t),this.tagNode[1].getChildByName("red").active=this.CardFlag&&g.default.instance.data.getEquipUPStageFlag(e.ower,t),this.tagNode[2].getChildByName("red").active=this.CardFlag&&g.default.instance.data.getGmeFlag(e.ower,t),this.tagNode[3].getChildByName("red").active=this.CardFlag&&g.default.instance.data.getEquipRefinefFlag(e.ower,t)}}else for(var i in this.tagNode)this.tagNode[i].getChildByName("red").active=!1},t.prototype.removeEvent=function(){C.GameEventDispatcher.instance.off(v.EventDefiner.EQUIP_upgrade_ret,this.upEffect,this),C.GameEventDispatcher.instance.off(v.EventDefiner.EQUIP_upgrade_stage_ret,this.upEffect,this),C.GameEventDispatcher.instance.off(v.EventDefiner.EQUIP_UP_Refine,this.upRefine,this),C.GameEventDispatcher.instance.off(v.EventDefiner.EQUIP_up_GemInfo,this.upRedPoint,this),C.GameEventDispatcher.instance.off(v.EventDefiner.itemAddUP,this.upRedPoint,this),C.GameEventDispatcher.instance.off(v.EventDefiner.itemchangeUP,this.upRedPoint,this),C.GameEventDispatcher.instance.on(v.EventDefiner.EQUIP_JumpTag,this.JumpTag,this)},t.prototype.InitBtnShow=function(){for(var e in this.tagNode){var t=this.getOpenFlag(this.BtnWindowType[parseInt(e)]);this.setGrayEffect(this.tagNode[e],t)}},t.prototype.setGrayEffect=function(e,t){(e.getComponent(r.default)?e.getComponent(r.default):e.addComponent(r.default)).setGray(!t)},t.prototype.getOpenFlag=function(e,t){return void 0===t&&(t=!1),a.default.instance.checkIsOpenbyWindowtype(e,t)},t.prototype.setData=function(e,t,i){if(void 0===i&&(i=null),null==e||e!=this._itemGuid){if(this._itemGuid=e,this.CardFlag=t,null!=i){for(var o=0;o<this.BtnWindowType.length;o++)if(this.BtnWindowType[o]==i){this._tagIndex=o;break}}else{var a=g.default.instance.data.getItemByGuid(this._itemGuid);if(a&&!this._tagIndex){var r=-1,s=g.default.instance.data.getEquipInfoById(a.id).buwei;g.default.instance.data.getEquipUPlevFlag(a.ower,s)?r=n.Strengthen:g.default.instance.data.getEquipUPStageFlag(a.ower,s)?r=n.UpgradeStage:g.default.instance.data.getGmeFlag(a.ower,s)&&(r=n.Gemstone),this._tagIndex=-1==r?this._tagIndex?this._tagIndex:0:r}}this.resetTagShow(),this.upSHow()}},t.prototype.upSHow=function(){this.onClickTag(null,this._tagIndex),this.upRedPoint()},t.prototype.resetTagShow=function(){for(var e in this.tagNode)this.tagNode[e].getChildByName("bg2").active=!1;for(var e in this._viewNodeMap)this._viewNodeMap[e]&&(this._viewNodeMap[e].active=!1)},t.prototype.onClickTag=function(e,t){this.tagNode[this._tagIndex]&&(this.tagNode[this._tagIndex].getChildByName("bg2").active=!1),this._tagIndex=Number(t),this.tagNode[this._tagIndex]&&(this.tagNode[this._tagIndex].getChildByName("bg2").active=!0),this.upTagChange(Number(t)),y.default.instance.setEquipItemShow()},t.prototype.upTagChange=function(e){var t=this;if(this._viewNodeMap[this._viewIndex]&&(this._viewNodeMap[this._viewIndex].active=!1),this._viewNodeMap[e])this._viewNodeMap[e].active=!0,this.upShowData();else{var i=l.GlobalContext.Root+"prefab/Equip/equipPrefab/"+this.prefabName[e];c.default.instance.loadResByType(i,cc.Prefab,function(n){if(!t._viewNodeMap[e]){var o=d.default.getNodeByUrl(n,i);t.node.getChildByName("infoNode").addChild(o),t._viewNodeMap[e]=o,t._viewIndex||(t._viewIndex=e);var a=t._viewIndex==e;t._viewNodeMap[e].active=a,t.upShowData()}},this)}this._viewIndex=e,this._viewNodeMap[this._viewIndex]&&(this._viewNodeMap[this._viewIndex].active=!0)},t.prototype.upShowData=function(){if(this._viewNodeMap[this._viewIndex])switch(this._tagIndex){case n.Strengthen:this._viewNodeMap[n.Strengthen].getComponent(p.default).setData(this._itemGuid);break;case n.UpgradeStage:this._viewNodeMap[n.UpgradeStage].getComponent(f.default).setData(this._itemGuid);break;case n.Gemstone:this._viewNodeMap[n.Gemstone].getComponent(h.default).setData(this._itemGuid)}},t.prototype.upRefine=function(e){var t=e.getUserData().flag;this.upRedPoint(),t?this._viewNodeMap[n.Refine].getComponent(u.default).playEffect():(I.default.instence.resetImgState(),_.default.instance.ShowMsg(b.default.getStr("\u7cbe\u70bc\u5931\u8d25")))},t.prototype.upEffect=function(e){this.upRedPoint();var t=e.getUserData();t.result&&this.showEffect(t.type)},t.prototype.showEffect=function(e){this._itemGuid&&(e==m.ItemType.forging||this.setEffect(e))},t.prototype.setEffect=function(e){var t=g.default.instance.data.getItemByGuid(this._itemGuid);if(e==m.ItemType.order){var i=w.NumberUtil.unitsDigitToText(t.stage)+b.default.getStr("rank"),n=w.NumberUtil.unitsDigitToText(t.stage+1)+b.default.getStr("rank"),a=g.default.instance.data.getEquipCfg(),r=g.default.instance.data.getEquipInfoById(t.id),s=a.stage[r.stage][t.stage-1],l=a.randomAttr[s.randomAttr],c=a.stage[r.stage][t.stage],d=c?a.randomAttr[c.randomAttr]:l,p={stageName:i,nextStageNmae:n,maxlevel:s.maxlevel,Nextmaxlevel:c.maxlevel,attr:{type:l[1].type,val:l[1].value,nextVal:d[1].value},attrTwo:{type:l[0].type,val:l[0].value,nextVal:d[0].value},equipEffectAttr:[]};for(var h in t.effect)if(t.effect[h]>=0){var u=g.default.instance.data.getEquipEffectAttrCfg(t.effect[h],t.stage-1);p.equipEffectAttr.push({type:u.type,value:t.stage,value2:t.stage+1})}T.default.instance.open(o.WindowType.EquipEffect,function(){S.default.instance.setEquipUpStageEffect(p)},this)}else{var f=t.refineLevel>=0?t.refineLevel:0,y=g.default.instance.data.getRefineCfgData(t.id,f)?g.default.instance.data.getRefineCfgData(t.id,f):null,C=y?y.attr:[];T.default.instance.open(o.WindowType.EquipEffect,function(){S.default.instance.setEquipRefine({attr:C})},this)}},Object.defineProperty(t.prototype,"equipTabIndex",{get:function(){return this._tagIndex},enumerable:!0,configurable:!0}),t.prototype.JumpTag=function(e){var t=e.getUserData();t&&t.index>=0&&this.onClickTag(null,t.index)},t.instance=null,__decorate([A([cc.Node])],t.prototype,"tagNode",void 0),__decorate([A(cc.SpriteAtlas)],t.prototype,"attrImgs",void 0),t=i=__decorate([R],t)}(s.default);i.default=N,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/Widget":"Widget","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/GrayEffect":"GrayEffect","../../Util/NumberUtil":"NumberUtil","../../Util/Utils":"Utils","../Functionicon/FunctionIconController":"FunctionIconController","../Item/ItemType":"ItemType","../Role/RoleStrengthen/RoleStrengthenController":"RoleStrengthenController","../Tips/OpTipsController":"OpTipsController","../WarTeam/WarTeamMonsterInfo":"WarTeamMonsterInfo","./equip/EquipCtrl":"EquipCtrl","./equip/EquipEffect":"EquipEffect","./equip/Gemstone":"Gemstone","./equip/Refine":"Refine","./equip/Strengthen":"Strengthen","./equip/UpgradeStage":"UpgradeStage"}],EventChapter:[function(e,t,i){"use strict";cc._RF.push(t,"e0911Y6SDJKN75jhLOOU5h4","EventChapter"),Object.defineProperty(i,"__esModule",{value:!0}),function(e){e.ChapterTipsHide="ChapterTipsHide",e.ChapterTipsShow="ChapterTipsShow",e.ChapterTipsResetData="ChapterTipsResetData"}(i.EventChapter||(i.EventChapter={})),cc._RF.pop()},{}],EventInterface:[function(e,t,i){"use strict";cc._RF.push(t,"e0d33KQogFFVKHZsPTsi2xk","EventInterface"),Object.defineProperty(i,"__esModule",{value:!0}),function(e){e.ActivityRed="ActivityRed",e.ArenaRed="ArenaRed",e.MineRed="MineRed",e.ThreadRed="ThreadRed",e.ArtifactRed="ArtifactRed",e.CombatteamRed="CombatteamRed",e.AltarRed="AltarRed",e.TotemsRed="TotemsRed",e.ShowActivityEffect="ShowActivityEffect",e.ShowArtifactEffect="ShowArtifactEffect",e.StopActivityEffect="StopActivityEffect",e.StopArtifactEffect="StopArtifactEffect"}(i.EventInterface||(i.EventInterface={})),cc._RF.pop()},{}],Event:[function(e,t,i){"use strict";cc._RF.push(t,"651b3DhpFhMYoNb4zScbR9v","Event"),Object.defineProperty(i,"__esModule",{value:!0}),function(e){e.SoundPlayingChange="SoundPlayingChange",e.FlagDataChange="FlagDataChange",e.MorphologicalTags_onClick="MorphologicalTags_onClick",e.SocketConnectSuccess="SocketConnectSuccess",e.SocketConnectFail="SocketConnectFail",e.GameForegroundChange="GameForegroundChange",e.GameBackgroundChange="GameBackgroundChange",e.ChangeGameScene="ChangeGameScene",e.CanEnterGame="CanEnterGame",e.CardPushWarm="CardPushWarm",e.ChangeActivityStatus="ChangeActivityStatus",e.WindowClose="WindowClose",e.ShareTicket="ShareTicket",e.OpenRulePage="OpenRulePage",e.ChapterReset="ChapterReset",e.ChapterLoadComplete="ChapterLoadComplete",e.PermitEnter="PermitEnter",e.BorldListOpen="BorldListOpen",e.BorldListClose="BorldListClose",e.OpenwindowFunc="OpenwindowFunc",e.SystemOpen="SystemOpen",e.ShowFunRed="ShowFunRed",e.ShowFunHide="ShowFunHide",e.ShowFunEntrance="ShowFunEntrance",e.ShowBtnPic="ShowBtnPic",e.ChatInfo="ChatInfo",e.Chatdelfrid="Chatdelfrid",e.ChatAddfrid="ChatAddfrid",e.Chatsysinfo="Chatsysinfo",e.Chatresult="Chatresult",e.ChatConfirm="ChatConfirm",e.ChatNotice="ChatNotice",e.Vip_info="vipinfo",e.vip_level="viplevel",e.vip_level_up="viplevel_up",e.Vip_info_up="vip_info_up",e.vipGiftbag_openTips="vipGiftbag_openTips",e.vipbenefitsflag="vipbenefitsflag",e.vipbenefitsUp="vipbenefitsUp",e.FriDel="FriDel",e.FriOnline="FriOnline",e.FRIENDS_ADDONE="FRIENDS_ADDONE",e.FRIENDS_CHAT="FRIENDS_CHAT",e.FRIENDS_APPLICATION="FRIENDS_APPLICATION",e.FRIENDS_ONCLICK="FRIENDS_ONCLICK",e.FRIENDS_APPLY="FRIENDS_COME",e.FRIENDS_COME="FRIENDS_APPLY",e.FRIENDS_OUTBLACK="FRIENDS_OUTBLACK",e.FRIENDS_SEARCHFRI="FRIENDS_SEARCHFRI",e.FRIENDS_ADD="FRIENDS_ADD",e.RECOMMEND_ONCLICK="RECOMMEND_ONCLICK",e.RECOMMEND_Add="RECOMMEND_Add",e.RECOMMEND_UP="RECOMMEND_UP",e.RECOMMEND_BTNUP="RECOMMEND_BTNUP",e.RECOMMEND_NEWSUP="RECOMMEND_NEWSUP",e.FridBossInfo="FridBossInfo",e.FriendBossFriend="FriendBossFriend",e.HelpFriendFight="HelpFriendFight",e.ChangePersonInfo="ChangePersionInfo",e.GuardChange="GuardChange",e.BuildLevelChange="BuildLevelChange",e.CountryChange="CountryChange",e.ShootingChange="ShootingChange",e.EggAmountChange="EggAmountChange",e.TimerChange="TimerChange",e.Time="Time",e.EggChange="EggChange",e.TeamInfo="TeamInfo",e.FriendChange="FriendChange",e.StealBallChange="StealBallChange",e.Kickresult="Kickresult",e.Kickinfo="Kickinfo",e.KickLook="KickLook",e.kickinfoinit="kickinfoinit",e.LookRoleInfo="LookRoleInfo",e.RoleJumpPage="RoleJumpPage",e.RoleClearUpdate="RoleClearUpdate",e.RoleAddProductEffect="RoleAddProductEffect",e.RoleSetUpDate="RoleSetUpDate",e.RoleSetUpChoose="RoleSetUpChoose",e.DailyTask="DailyTask",e.Activity_Yunying="yunying",e.Activity_YunyingUP="yunying_up",e.Activity_yunyingopen="yunyingopen",e.Activity_yunyingend="yunyingend",e.Activity_sevendaylogin="sevendaylogin",e.Activity_sevendayloginUp="sevendaylogin_Up",e.Activity_sevendaygoal="sevendaygoal",e.Activity_sevendaygoalUP="sevendaygoal_UP",e.Activity_sdrankinfo="sdrankinfo",e.Activity_sdrankinfoUp="sdrankinfo_up",e.Activity_countdown="Activity_countdown",e.Activity_resetTimeout="Activity_resetTimeout",e.Activity_SevenDayTargetUpdate="Activity_SevenDayTargetUpdate",e.Activity_SevenDayTargetDayUp="Activity_SevenDayTargetDayUp",e.Activity_SevenDayTargetTaskUp="Activity_SevenDayTargetTaskUp",e.Activity_SevenDayTargetRankUp="Activity_SevenDayTargetRankUp",e.rewardpanel="rewardpanel",e.rewardTips_close="rewardTips_close",e.rewardpanel_showEffect="rewardpanel_showEffect",e.openserverday="openserverday",e.openserverday_up="openserverday_up",e.Activity_upTabRed="Activity_upTabRed",e.RankList_up_show="RankList_up_show",e.RankList_up_model="RankList_up_model",e.InitPlayerInfo="InitPlayerInfo",e.CreateResult="CreateResult",e.ChangePlayerInfo="ChangePlayerInfo",e.PlayerMoneyChange="PlayerCoinChange",e.PowerChange="PowerChange",e.ExpChange="ExpChange",e.Integral="Integral",e.LevelChange="LevelChange",e.AttributeChange="AttributeChange",e.SkillChange="SkillChange",e.SkinInfo="SkinInfo",e.PlayerFightChange="PlayerFightChange",e.C_Scene_EnterScene="C_Scene_EnterScene",e.C_Scene_Add_Actor="C_Scene_Add_Actor",e.C_Scene_Remove_Actor="C_Scene_Remove_Actor",e.C_Scene_Actor_Prop_Change="C_Scene_Actor_Prop_Change",e.C_Scene_Actor_Injured_Effect="C_Scene_Actor_Injured_Effect",e.C_Fight_Data_Save="C_Fight_Data_Save",e.OPEN_UPDATE_TIME="OPEN_UPDATE_TIME",e.C_Fight_Clear="C_Fight_Clear",e.C_Fight_Start="C_Fight_Start",e.C_Fight_End="C_Fight_End",e.C_SetBigSkill="C_SetBigSkill",e.C_Fight_StartTask="C_Fight_StartTask",e.C_Fight_StopTask="C_Fight_StopTask",e.Fight_Power_Change="Fight_Power_Change",e.Fight_Speed_Change="Fight_Speed_Change",e.Fight_Actor_Dead="Fight_Actor_Dead",e.ActivityStatus_GuanQia_Data="ActivityStatus_GuanQia_Data",e.ActivityStatus_Is_Show="ActivityStatus_Is_Show",e.Set_Monster_Data="Set_Monster_Data",e.Fight_BigSkill_Update="Fight_BigSkill_Update",e.CloseReelList="CloseReelList",e.Updata_StepNum="Updata_StepNum",e.Updata_ComResultReward="Updata_ComResultReward",e.Updata_Step_Time="Updata_Step_Time",e.FightUpdateArenaWait="FightUpdateArenaWait",e.FightShowBuffIcon="FightShowBuffIcon",e.GetBackpackListinfo="GetBackpackListinfo",e.AddBackpackItem="AddBackpackItem",e.DelBackpackItem="DelBackpackItem",e.BackpackItemChange="BackpackItemChange",e.itemchange="itemchange",e.itemchangeUP="itemchangeUP",e.itemAddUP="itemAddUP",e.AddMail="mailadd",e.DellMail="maildel",e.MailChange="mailchange",e.Mail_ALL="mails",e.Mail_UP_DATA="Mail_UP_DATA",e.OpenMaill="OpenMaill",e.Card_MonsterTouch="Card_MonsterTouch",e.Card_updataCardInfo="updataCardInfo",e.Card_xingtai_up="Card_xingtai_up",e.cardinfo="cardinfo",e.WarTeamMonsterInfoHide="WarTeamMonsterInfoHide",e.onekeyreplace="onekeyreplace",e.onekeyreplace_Status="onekeyreplace_Status",e.cardinherit="cardinherit",e.CardInherit_onClickCard="CardInherit_onClickCard",e.CardInherit_effect="CardInherit_effect",e.caard_autoReplace="caard_autoReplace",e.RenewPrice="RenewPrice",e.UpdateCardEquipInfo="UpdateCardEquipInfo",e.EQUIP_DECOMPOSE="equipdecompose",e.EQUIP_Take_One="takeonequip",e.EQUIP_Take_Off="takeoffequip",e.EQUIP_upgrade_ret="itemupgraderet",e.EQUIP_upgrade_stage_ret="itemupgradestageret",e.EQUIP_UP_WEAR="equip_up_wear",e.EQUIP_refine="refine",e.EQUIP_UP_Refine="UP_Refine",e.EQUIP_up_GemInfo="up_GemInfo",e.EQUIP_GemInfo="geminfo",e.EQUIP_JumpTag="EQUIP_JumpTag",e.treaMapEvent="treaMapEvent",e.ArenaClean="ArenaClean",e.ArenaMatchRival="ArenaMatchRival",e.ArenaMatchRace="ArenaMatchRace",e.ArenaMatchReset="ArenaMatchReset",e.ArenaMatchFightResult="ArenaMatchFightResult",e.TalentEvent="TalentEvent",e.SinginEvent1="SinginEvent1",e.SinginEvent2="SinginEvent2",e.SelfLadderInfo="SelfLadderInfo",e.RivalLadderInfo="RivalLadderInfo",e.RankingChange="RankingChange",e.RankingRewardInfo="RankingRewardInfo",e.ChangeRecord="ChangeRecord",e.ARTIFACT_INFO="atfinfo",e.ARTIFACT_UPGRADE_RESULT="atfstageup",e.ARTIFACT_FOSTER_RESULT="atffoster",e.ARTIFACT_UPDATE_ALL_SHOW="update_all_show",e.ARTIFACT_UPDATE_ONE_SHOW="update_one_show",e.ARTIFACT_UPDATE_ELEMENT_SHOW="update_element_show",e.ARTIFACT_UPGRADE_STATUS="artifact_upgrade_status",e.ARTIFACT_ATFCURSKILL_ID="atfcurskill",e.ARTIFACT_SKILL="atfsetskill",e.ArtifactCollection="artifactcollection",e.ArtifactCollection_info="artifactcollectioninfo",e.ArtifactCollection_up_info="ArtifactCollection_up_info",e.Decompose_ItemDecompose="itemdecompose",e.Decompose_UP_SHow="up_show",e.synthetic="synthetic",e.synthetic_Up="synthetic_Up",e.Synthetic_Reward="Synthetic_Reward",e.ReelInfo="ReelInfo",e.CurScrollInfo="CurScrollInfo",e.ReelCountInfo="ReelCountInfo",e.ScrollBegan="ScrollBegan",e.ScrollEnded="ScrollEnded",e.BoxInfo="BoxInfo",e.BoxgetItem="BoxgetItem",e.WindowOpenlink="WindowOpenlink",e.WindowCloselink="WindowCloselink",e.GetFlag="GetFlag",e.SetProgress="SetProgress",e.Preferential="Preferential",e.CardGift="CardGift",e.CardGiftInfo="CardGiftInfo",e.DiamondShop="DiamondShop",e.TopUpFlag="TopUpFlag",e.GuideActive="Active",e.GuideCheckSkipNode="GuideCheckSkipNode",e.CurGuideComplete="CurGuideComplete",e.CurGuideStart="CurGuideStart",e.SetSceneBackState="SetSceneBackState",e.buystep="buystep",e.PrivilegeCard="PrivilegeCard",e.CheckCombatPage="CheckCombatPage",e.CloseCommonPage4="CloseCommonPage4",e.DailyCopy="DailyCopy",e.FunOpenEvent="FunOpenEvent",e.CardActive="CardActive",e.ToeamsUpdateData="ToeamsUpdateData",e.ToeamsPlayUpgradeAnimation="ToeamsPlayUpgradeAnimation",e.ToeamsJumpPage="ToeamsJumpPage",e.ToeamsUpdateClear="ToeamsUpdateClear",e.ToeamsCopyUpdataData="ToeamsCopyUpdataData",e.ToeamsCopyTableData="ToeamsCopyTableData",e.TerritoryWarUpdate="TerritoryWarUpdate",e.TerritoryWarPageUpdate="TerritoryWarPageUpdate",e.TerritoryWarRecordUpdate="TerritoryWarRecordUpdate",e.TreasureSlinkFight="TreasureSlinkFight",e.TreasureDialog="TreasureDialog",e.TreasureTroopSwitch="TreasureTroopSwitch",e.SandTableSybomlMove="SandTableSybomlMove",e.SandTableMainClose="SandTableMainClose",e.SandTableCardSynthesisEffect="SandTableCardSynthesisEffect",e.welfareOnlineRewardUpdate="welfareOnlineRewardUpdate",e.welfareDailyMealUpdate="welfareDailyMealUpdate",e.welfarePrivilegeCardUpdate="welfarePrivilegeCardUpdate",e.newlogin="newlogin",e.BaiBeiFanLiUpdate="BaiBeiFanLiUpdate",e.HalfPriceUpdate="HalfPriceUpdate",e.PlayerWealthBG="PlayerWealthBG",e.FightResultTipClick="FightResultTipClick",e.FightResultIconClick="FightResultIconClick",e.EquipStopNext="EquipStopNext",e.ActivityCopyUpdateRed="ActivityCopyUpdateRed",e.CheckDailyGuide="CheckDailyGuide",e.ExpCopyUpdateState="ExpCopyUpdateState",e.ExpCopyUpdateData="ExpCopyUpdateData",e.showUpdate="showUpdate",e.ChannelItem_onClick="ChannelItem_onClick",e.DrawCard_CardEffect="DrawCard_CardEffect",e.SingleRechargeRebate_Info="rechargerebateinfo",e.SingleRechargeRebate_InfoUp="SingleRechargeRebate_InfoUp",e.SingleRechargeRebate_rechargerebate="rechargerebate",e.MineUpdate="MineUpdate",e.MineFriendsUpdate="MineFriendsUpdate",e.MineShowCardBg="MineShowCardBg",e.MineMapEntryUpdate="MineMapEntryUpdate",e.MineClose="MineClose",e.MineSpeedAni="MineSpeedAni",e.SDKLogin="SDKLogin"}(i.EventDefiner||(i.EventDefiner={})),cc._RF.pop()},{}],ExpCopyConst:[function(e,t,i){"use strict";cc._RF.push(t,"2d5e7bYrdhIEatvNhjGUYi/","ExpCopyConst"),Object.defineProperty(i,"__esModule",{value:!0}),function(e){e[e.Buy=0]="Buy",e[e.Challenge=1]="Challenge"}(i.ExpCopyConstBtnConst||(i.ExpCopyConstBtnConst={})),function(e){e.Url="resources/expcopy/"}(i.ExpCopyResUrl||(i.ExpCopyResUrl={})),cc._RF.pop()},{}],ExpCopyCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"97367N/TR1L27swCALnqvTf","ExpCopyCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../Core/ConfigsManager"),a=e("../../Core/Language"),r=e("../../Core/Event"),s=e("../../Core/GameEventDispatcher"),l=e("../../NetConnect/NetConnet"),c=e("../OpenWin/OpenWinController"),d=e("../../Core/WindowType"),p=e("./vo/ExpCopyDifficuteVo"),h=e("../WarTeam/MonsterController"),u=e("./vo/ExpCopySerDataVo"),f=e("../Totems/TotemsCtrl"),g=e("./ExpCopyUtils"),y=e("../Tips/OpTipsController"),m=cc._decorator,C=m.ccclass,v=(m.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.selectIndex=0,t.passIndex=0,t.difficuteConfig={},t.ids=[d.WindowType.ExpCopy,d.WindowType.ExpCopyPlain,d.WindowType.ExpCopyBump,d.WindowType.ExpCopyNightmare,d.WindowType.ExpCopyInfernal],t}var i;return __extends(t,e),i=t,t.prototype.listNotification=function(){this.addProto("expfuben",this.setServerData,this),i.instance=this;var e=o.ConfigsManager.instance.getConfigs("ExpCopyConf");this.dayCnt=e.ExpFuBen[1].challengeCnt;for(var t=e.difficute[1],n=e.guanqia,a=0;a<t.length;a++)this.difficuteConfig[a+1]=new p.ExpCopyDifficuteVo(t[a]),this.difficuteConfig[a+1].setQuanqiaData(n[t[a].guanqia]);this.day=e.ExpFuBen[1].double},t.prototype.setChooseIndex=function(e,t){var n=this.ids.indexOf(e);if(i.instance.serData[n].isOpen)this.selectIndex=n,this.passIndex=t,c.default.instance.openWindow(d.WindowType.ExpCopy);else{var o=i.instance.difficuteConfig[n+1];y.default.instance.ShowMsg(a.default.getStr("7209",o.unlockChapter,o.unlockSection))}},t.prototype.setServerData=function(e){var t=e.record;if(t)if(this.serData)for(var i in t)this.serData[i].updateData(t[i]);else{for(var i in this.serData=[],t)this.serData.push(new u.ExpCopySerDataVo(t[i]));g.ExpCopyUtils.getHightPassIndex()}null!=e.resetTimes&&(this.buyNum=e.resetTimes,this.challengeCnt=this.dayCnt+e.resetTimes-e.challengeCnt,s.GameEventDispatcher.instance.emit(r.EventDefiner.ExpCopyUpdateState)),s.GameEventDispatcher.instance.emit(r.EventDefiner.ExpCopyUpdateData)},t.prototype.expfbBuyReq=function(){l.default.instance.sendProto({cmd:"expfbbuycnt"})},t.prototype.addMonsterByGQidAndGames=function(e){void 0===e&&(e=!0);var t=h.default.instance.GetWarTeamConfig();for(var i in t){var n={cardid:t[i].id,grade:5,level:t[i].level+f.default.instance.getTotemsAddLevel(t[i].id),num:1,self:!0,autoUseSkill:!1,playeffect:!0,ismoveenter:e};s.GameEventDispatcher.instance.emit(r.EventDefiner.C_Scene_Add_Actor,n)}},t.instance=null,t=i=__decorate([C],t)}(n.default));i.default=v,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/WindowType":"WindowType","../../NetConnect/NetConnet":"NetConnet","../OpenWin/OpenWinController":"OpenWinController","../Tips/OpTipsController":"OpTipsController","../Totems/TotemsCtrl":"TotemsCtrl","../WarTeam/MonsterController":"MonsterController","./ExpCopyUtils":"ExpCopyUtils","./vo/ExpCopyDifficuteVo":"ExpCopyDifficuteVo","./vo/ExpCopySerDataVo":"ExpCopySerDataVo"}],ExpCopyDifficuteVo:[function(e,t,i){"use strict";cc._RF.push(t,"c0f75CWei1FFb2fZVT2uOID","ExpCopyDifficuteVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e){for(var t in this.levelid=null,this.levelname=null,this.unlockChapter=null,this.unlockSection=null,this.guanqia=null,e)"guanqia"!=t&&(this[t]=e[t])}return e.prototype.setQuanqiaData=function(e){this.guanqia=e},e}();i.ExpCopyDifficuteVo=n,cc._RF.pop()},{}],ExpCopyPassItem:[function(e,t,i){"use strict";cc._RF.push(t,"4f07esODh5EU66eByEpoGrb","ExpCopyPassItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../Commons/Image"),a=e("./ExpCopyConst"),r=e("../../Core/Language"),s=e("./ExpCopyCtrl"),l=e("../../Core/GameEventDispatcher"),c=e("../../Core/Event"),d=e("../../Util/Utils"),p=e("../../Core/WindowType"),h=e("../Item/ItemIcon"),u=e("../../GlobalContext"),f=e("../../Core/LoadManager"),g=e("../Commons/RewardUtils"),y=e("../Role/RoleController"),m=e("../../Global/GlobalValue"),C=e("../Item/ItemData"),v=e("../Tips/OpTipsController"),_=cc._decorator,b=_.ccclass,T=_.property,S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.selectionBg=null,t.bg=null,t.recommendLabel=null,t.passLabel=null,t.power=null,t.itemContent=null,t.costLabel=null,t.img=null,t.costNum=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.recommendLabel.getComponent(cc.Label).string=r.default.getStr("7205"),this.costLabel.getComponent(cc.Label).string=r.default.getStr("7206");var t=y.default.instance.GetMyWealth(m.WealthType.Energy),i=C.default.creatItem(g.RewardType.Energy,t),n=u.GlobalContext.ResRoot+"resources/itemicon/"+i.ItemIcon+".png";d.default.setImage(this.img,n)},t.prototype.show=function(){e.prototype.show.call(this),l.GameEventDispatcher.instance.on(c.EventDefiner.ExpCopyUpdateState,this.updateState,this)},t.prototype.hide=function(){e.prototype.hide.call(this),l.GameEventDispatcher.instance.off(c.EventDefiner.ExpCopyUpdateState,this.updateState,this),this.index=null;for(var t=this.itemContent.childrenCount-1;t>=0;t--)d.default.setNodeToPool(p.PoolType.ItemIcon,this.itemContent.children[t]);this.data=null},t.prototype.onClick=function(){var e=s.default.instance.serData[s.default.instance.selectIndex].guanqia;!this.index||e[this.index-1]?(s.default.instance.passIndex=this.index,l.GameEventDispatcher.instance.emit(c.EventDefiner.ExpCopyUpdateState)):v.default.instance.ShowMsg(r.default.getStr("7210"))},t.prototype.updateState=function(){this.selectionBg.active=s.default.instance.passIndex==this.index,null!=this.oldSelectIndex&&this.oldSelectIndex==s.default.instance.selectIndex||this.setAwardData()},t.prototype.initData=function(e){this.node.name=e-1+"",this.index=e-1,this.updateState(),this.passLabel.getComponent(cc.Label).string=r.default.getStr("7207",e),this.bg.updateBg(a.ExpCopyResUrl.Url+"bg_kuang"+e+".png"),this.selectionBg.getComponent(o.default).updateBg(a.ExpCopyResUrl.Url+"bg_xuanzhong.png")},t.prototype.setAwardData=function(){var e=this;this.data=s.default.instance.difficuteConfig[s.default.instance.selectIndex+1].guanqia[this.index],this.power.getComponent(cc.Label).string=this.data.fight+"",this.costNum.getComponent(cc.Label).string=r.default.getStr("7208",this.data.energy),d.default.setNodeChildDestoryByUrl(this.itemContent,u.GlobalContext.Root+"prefab/Bag/ItemIcon"),f.default.instance.loadResByType(u.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(t){var i=g.default.instance.getItemList(e.data.previewId);for(var n in i){var o=d.default.getNodeByPool(p.PoolType.ItemIcon,t,u.GlobalContext.Root+"prefab/Bag/ItemIcon");o.scale=1,e.itemContent.addChild(o),o.getComponent(h.default).ItemData(i[n],!0,i[n].count+"",!0)}},this)},__decorate([T(cc.Node)],t.prototype,"selectionBg",void 0),__decorate([T(o.default)],t.prototype,"bg",void 0),__decorate([T(cc.Label)],t.prototype,"recommendLabel",void 0),__decorate([T(cc.Label)],t.prototype,"passLabel",void 0),__decorate([T(cc.Label)],t.prototype,"power",void 0),__decorate([T(cc.Node)],t.prototype,"itemContent",void 0),__decorate([T(cc.Label)],t.prototype,"costLabel",void 0),__decorate([T(cc.Node)],t.prototype,"img",void 0),__decorate([T(cc.Label)],t.prototype,"costNum",void 0),t=__decorate([b],t)}(n.default);i.default=S,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/Image":"Image","../Commons/RewardUtils":"RewardUtils","../Item/ItemData":"ItemData","../Item/ItemIcon":"ItemIcon","../Role/RoleController":"RoleController","../Tips/OpTipsController":"OpTipsController","./ExpCopyConst":"ExpCopyConst","./ExpCopyCtrl":"ExpCopyCtrl"}],ExpCopyPassVo:[function(e,t,i){"use strict";cc._RF.push(t,"be342glziNLgYAE4ldWlyAL","ExpCopyPassVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){return function(e){for(var t in this.index=null,this.guanqiaid=null,this.rewardid=null,this.previewId=null,this.fight=null,this.energy=null,e)this[t]=e[t]}}();i.ExpCopyPassVo=n,cc._RF.pop()},{}],ExpCopySerDataVo:[function(e,t,i){"use strict";cc._RF.push(t,"e7d21K3tRJNsplNXmelQBh6","ExpCopySerDataVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e){this.isOpen=null,this.guanqia=null,this.updateData(e)}return e.prototype.updateData=function(e){for(var t in e)this[t]=e[t]},e}();i.ExpCopySerDataVo=n,cc._RF.pop()},{}],ExpCopyToggleItem:[function(e,t,i){"use strict";cc._RF.push(t,"0d59bQ7/l9LK5uxRY8WeilG","ExpCopyToggleItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../Commons/Image"),a=e("./ExpCopyConst"),r=e("../../Util/NumberUtil"),s=e("../../Core/Language"),l=e("./ExpCopyCtrl"),c=e("../../Core/GameEventDispatcher"),d=e("../../Core/Event"),p=e("../../Util/Utils"),h=cc._decorator,u=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.checkmark=null,t.iconImg=null,t.patternImg=null,t.layerLabel=null,t.img=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),c.GameEventDispatcher.instance.on(d.EventDefiner.ExpCopyUpdateState,this.updateState,this)},t.prototype.hide=function(){e.prototype.hide.call(this),c.GameEventDispatcher.instance.off(d.EventDefiner.ExpCopyUpdateState,this.updateState,this),this.index=null},t.prototype.updateState=function(){this.checkmark.node.active=this.img.active=l.default.instance.selectIndex==this.index},t.prototype.initData=function(e){this.node.name=parseInt(e)-1+"",this.index=parseInt(e)-1,this.updateState(),this.iconImg.updateBg(a.ExpCopyResUrl.Url+"bg_tu"+e+".png"),this.patternImg.updateBg(a.ExpCopyResUrl.Url+"i18n_pattern"+e+".png");var t=l.default.instance.serData[this.index],i=l.default.instance.difficuteConfig[this.index+1];this.layerLabel.string=t.isOpen?s.default.getStr("7201",r.NumberUtil.unitsDigitToText(parseInt(e))):s.default.getStr("7209",i.unlockChapter,i.unlockSection),p.default.setGrayEffect(this.iconImg.node,t.isOpen),p.default.setGrayEffect(this.patternImg.node,t.isOpen),p.default.setGrayEffect(this.node.getChildByName("Background"),t.isOpen)},__decorate([f(o.default)],t.prototype,"checkmark",void 0),__decorate([f(o.default)],t.prototype,"iconImg",void 0),__decorate([f(o.default)],t.prototype,"patternImg",void 0),__decorate([f(cc.Label)],t.prototype,"layerLabel",void 0),__decorate([f(cc.Node)],t.prototype,"img",void 0),t=__decorate([u],t)}(n.default);i.default=g,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/Widget":"Widget","../../Util/NumberUtil":"NumberUtil","../../Util/Utils":"Utils","../Commons/Image":"Image","./ExpCopyConst":"ExpCopyConst","./ExpCopyCtrl":"ExpCopyCtrl"}],ExpCopyUtils:[function(e,t,i){"use strict";cc._RF.push(t,"50fc3yfa3dOL7nY9VhhNmtM","ExpCopyUtils"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/WindowType"),o=e("./ExpCopyCtrl"),a=e("../Functionicon/FunctionIconController"),r=e("../../Core/GameEventDispatcher"),s=e("../../Core/Event"),l=e("../../Global/GlobalValue"),c=e("../../Util/RechargeUtils"),d=e("../../Util/RechargeConst"),p=e("../Commons/RewardUtils"),h=e("../Status/StatusType"),u=e("../Vip/VipCtrl"),f=e("../Role/RoleInfo"),g=e("../../Core/Language"),y=e("../Tips/OpTipsController"),m=function(){function e(){}return Object.defineProperty(e,"ctrl",{get:function(){return o.default.instance},enumerable:!0,configurable:!0}),e.getRed=function(){var e=this.ctrl;return!!a.default.instance.checkIsOpenbyWindowtype(n.WindowType.ExpCopy)&&!!e.challengeCnt},e.getInfoFight=function(){var e=this.ctrl,t=e.selectIndex,i=e.passIndex,n=e.difficuteConfig[t+1].guanqia[i].guanqiaid;r.GameEventDispatcher.instance.emit(s.EventDefiner.ChangeActivityStatus,h.ActivityStatus.ExpCopy),r.GameEventDispatcher.instance.emit(s.EventDefiner.ChangeGameScene,{status:l.GameScene.Fight,guanqiaId:n})},e.joinFight=function(){var e=this.ctrl,t=e.selectIndex,i=e.passIndex,n=e.difficuteConfig[t+1].guanqia[i].energy;return e.challengeCnt?c.default.PurchaseItemOrRechage(d.RechargeTypeConst.Prop,n,this.getInfoFight,this,p.RewardType.Energy):(y.default.instance.ShowMsg(g.default.getStr("7198")),!1)},e.isPass=function(){var e=this.ctrl;return e.serData[e.selectIndex].guanqia[e.passIndex]},e.isMaxLayer=function(){var e=this.ctrl;return e.serData[e.selectIndex].guanqia.length-1==e.passIndex},e.isCanFight=function(){return this.ctrl.passIndex++,this.joinFight()},e.getHightPassIndex=function(){var e=this.ctrl,t=e.selectIndex,i=e.serData[t].guanqia;e.passIndex=i.length-1;for(var n=0;n<i.length;n++)if(!i[n]){e.passIndex=n;break}},e.isUnlock=function(){return!!u.default.instance.data.getprivilegeData(f.MyRoleInfo.vipLevel,l.VipPrivilegeType.ExpCopyBuyNum)},e.isBuyOver=function(){var e=this.ctrl;return u.default.instance.data.getprivilegeData(f.MyRoleInfo.vipLevel,l.VipPrivilegeType.ExpCopyBuyNum).param.length==e.buyNum},e.getNum=function(){var e=u.default.instance.data.getprivilegeData(f.MyRoleInfo.vipLevel,l.VipPrivilegeType.ExpCopyBuyNum);return e?e.param.length:0},e.isChallengefull=function(){var e=this.ctrl;return e.challengeCnt==e.dayCnt},e.isNoChallenge=function(){return!this.ctrl.challengeCnt},e.getUnlock=function(){for(var e,t=u.default.instance.data,i=1;i<20;i++)if(t.getprivilegeData(i,l.VipPrivilegeType.ExpCopyBuyNum)){e=i;break}return e},e.getBuyGoldNum=function(){var e=this.ctrl,t=u.default.instance.data.getprivilegeData(f.MyRoleInfo.vipLevel,l.VipPrivilegeType.ExpCopyBuyNum);return t.param[e.buyNum]?t.param[e.buyNum]:t.param[t.param].length-1},e}();i.ExpCopyUtils=m,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../Util/RechargeConst":"RechargeConst","../../Util/RechargeUtils":"RechargeUtils","../Commons/RewardUtils":"RewardUtils","../Functionicon/FunctionIconController":"FunctionIconController","../Role/RoleInfo":"RoleInfo","../Status/StatusType":"StatusType","../Tips/OpTipsController":"OpTipsController","../Vip/VipCtrl":"VipCtrl","./ExpCopyCtrl":"ExpCopyCtrl"}],ExpCopyWin:[function(e,t,i){"use strict";cc._RF.push(t,"429cbC8hMlI36KLBU04/xp0","ExpCopyWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../../Core/WindowType"),a=e("../../GlobalContext"),r=e("../../Core/GameEventDispatcher"),s=e("../../Core/Event"),l=e("./ExpCopyCtrl"),c=e("./ExpCopyConst"),d=e("../../Core/Language"),p=e("../../Util/Utils"),h=e("./ExpCopyToggleItem"),u=e("./ExpCopyPassItem"),f=e("../../Core/LoadManager"),g=e("../Tips/OpTipsController"),y=e("../../Core/TimeController"),m=e("./ExpCopyUtils"),C=e("../../Global/GlobalValue"),v=e("../Tips/TipsWinController"),_=e("../../Util/CommonUtil"),b=cc._decorator,T=b.ccclass,S=b.property,I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ToggleContainer=null,t.challengeBtn=null,t.content=null,t.scr=null,t.str=null,t.challengeStr=null,t.wid=325,t.posX=null,t.temporaryIndex=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.onInit(o.WindowType.ExpCopy,!0),e.prototype.onLoad.call(this),this.node.getChildByName("main").width=a.GlobalContext.StageWidth,this.node.getChildByName("main").height=a.GlobalContext.StageHeight,this.challengeBtn.getComponentInChildren(cc.Label).string=d.default.getStr("7203"),this.scr.x=.5*(1624-a.GlobalContext.StageWidth)-460,this.conWid=1200-(1624-a.GlobalContext.StageWidth);var t=l.default.instance.difficuteConfig[1].guanqia.length-1;this.maxWid=5*-this.wid-40*t+(this.conWid-this.wid)/2,this.scr.width=this.scr.getChildByName("view").width=this.conWid},t.prototype.show=function(){e.prototype.show.call(this),r.GameEventDispatcher.instance.on(s.EventDefiner.ExpCopyUpdateData,this.allUpdateData,this),r.GameEventDispatcher.instance.on(s.EventDefiner.ExpCopyUpdateState,this.updateData,this),this.scr.on(cc.Node.EventType.TOUCH_MOVE,this.scrollViewMove,this),this.scr.on(cc.Node.EventType.TOUCH_END,this.scrollViewMove,this),this.initUI()},t.prototype.allUpdateData=function(){this.temporaryIndex=null,this.updateData(!0)},t.prototype.initUI=function(){var e=this,t=l.default.instance.difficuteConfig;this.ToggleContainer.node.childrenCount||f.default.instance.loadResByType(a.GlobalContext.Root+"prefab/ExpCopy/ExpCopyToggleItem",cc.Prefab,function(i){var n;for(var r in t)n=p.default.getNodeByPool(o.PoolType.ExpCopyToggleItem,i,a.GlobalContext.Root+"prefab/ExpCopy/ExpCopyToggleItem"),e.ToggleContainer.node.addChild(n),n.getComponent(h.default).initData(r);e.ToggleContainer.node.children[l.default.instance.selectIndex].getComponent(cc.Toggle).isChecked=!0},this),this.content.childrenCount||f.default.instance.loadResByType(a.GlobalContext.Root+"prefab/ExpCopy/ExpCopyPassItem",cc.Prefab,function(i){for(var n,r=t[1],s=1;s<=r.guanqia.length;s++)n=p.default.getNodeByPool(o.PoolType.ExpCopyPassItem,i,a.GlobalContext.Root+"prefab/ExpCopy/ExpCopyPassItem"),e.content.addChild(n),n.getComponent(u.default).initData(s);var l=y.default.instance.setTimeout(function(){e.setDataPageContent(!0),y.default.instance.clearTimeout(l)},e,200)},this),this.updateData(!0),this.nowShow=!0},t.prototype.updateData=function(e){var t=l.default.instance;this.challengeBtn.interactable=!!t.challengeCnt,this.str.string=p.default.isDoubleTime(l.default.instance.day),this.challengeStr.string=d.default.getStr("7204",t.challengeCnt,t.dayCnt),this.setDataPageContent(e)},t.prototype.hide=function(){e.prototype.hide.call(this),this.nowShow=this.posX=this.temporaryIndex=this.isDong=null,r.GameEventDispatcher.instance.off(s.EventDefiner.ExpCopyUpdateData,this.allUpdateData,this),r.GameEventDispatcher.instance.off(s.EventDefiner.ExpCopyUpdateState,this.updateData,this),this.scr.off(cc.Node.EventType.TOUCH_MOVE,this.scrollViewMove,this),this.scr.off(cc.Node.EventType.TOUCH_END,this.scrollViewMove,this);for(var t=this.ToggleContainer.node.childrenCount-1;t>=0;t--)p.default.setNodeToPool(o.PoolType.ExpCopyToggleItem,this.ToggleContainer.node.children[t]);for(t=this.content.childrenCount-1;t>=0;t--)p.default.setNodeToPool(o.PoolType.ExpCopyPassItem,this.content.children[t])},t.prototype.scrollViewMove=function(e){var t=this,i=e.getLocation().x;if(!this.isDong)if(null==this.temporaryIndex&&(this.temporaryIndex=l.default.instance.passIndex),null!=this.posX){if(!(Math.abs(this.posX-i)<10)){if(this.posX<i){if(0==this.temporaryIndex)return;this.temporaryIndex--}else{if(this.temporaryIndex==this.content.childrenCount-1)return;this.temporaryIndex++}this.isDong=!0,this.scr.off(cc.Node.EventType.TOUCH_MOVE,this.scrollViewMove,this);var n=-(this.wid+40)*this.temporaryIndex+(this.conWid-this.wid)/2,o=new cc.Vec2(n,this.content.y);this.content.runAction(cc.sequence(cc.moveTo(.5,o),cc.callFunc(function(){t.posX=null,t.isDong=null,t.content.on(cc.Node.EventType.TOUCH_MOVE,t.scrollViewMove,t)})))}}else this.posX=i},t.prototype.onClickSendBtn=function(e,t){var i;switch(parseInt(t)){case c.ExpCopyConstBtnConst.Buy:m.ExpCopyUtils.isChallengefull()?i=d.default.getStr("7200"):m.ExpCopyUtils.isUnlock()?m.ExpCopyUtils.isBuyOver()?_.CommonUtil.showAddVip(C.VipPrivilegeType.ExpCopyBuyNum):v.default.instance.ShowTips(d.default.getStr("7202",m.ExpCopyUtils.getBuyGoldNum()),function(){l.default.instance.expfbBuyReq()},this):_.CommonUtil.showAddVip(C.VipPrivilegeType.ExpCopyBuyNum);break;case c.ExpCopyConstBtnConst.Challenge:m.ExpCopyUtils.isNoChallenge()?i=d.default.getStr("7199"):m.ExpCopyUtils.joinFight()}i&&g.default.instance.ShowMsg(i)},t.prototype.onClickToggle=function(e){var t=this;if(this.nowShow){var i=parseInt(e.target.name);if(l.default.instance.serData[i].isOpen)null!=i&&i==l.default.instance.selectIndex||(this.temporaryIndex=null,l.default.instance.selectIndex=i,m.ExpCopyUtils.getHightPassIndex(),this.setDataPageContent(!0),r.GameEventDispatcher.instance.emit(s.EventDefiner.ExpCopyUpdateState));else{var n=l.default.instance.difficuteConfig[i+1];g.default.instance.ShowMsg(d.default.getStr("7209",n.unlockChapter,n.unlockSection));var o=y.default.instance.setTimeout(function(){t.ToggleContainer.node.children[l.default.instance.selectIndex].getComponent(cc.Toggle).isChecked=!0,y.default.instance.clearTimeout(o)},this,200)}}},t.prototype.setDataPageContent=function(e){var t=this;this.content.off(cc.Node.EventType.TOUCH_MOVE,this.scrollViewMove,this);var i=-(this.wid+40)*l.default.instance.passIndex+(this.conWid-this.wid)/2;if(i=i<this.maxWid?this.maxWid:i,e)this.content.x=i;else{this.isDong=!0;var n=new cc.Vec2(i,this.content.y);this.content.runAction(cc.sequence(cc.moveTo(.5,n),cc.callFunc(function(){t.posX=null,t.isDong=null,t.content.on(cc.Node.EventType.TOUCH_MOVE,t.scrollViewMove,t)})))}},__decorate([S(cc.ToggleContainer)],t.prototype,"ToggleContainer",void 0),__decorate([S(cc.Button)],t.prototype,"challengeBtn",void 0),__decorate([S(cc.Node)],t.prototype,"content",void 0),__decorate([S(cc.Node)],t.prototype,"scr",void 0),__decorate([S(cc.RichText)],t.prototype,"str",void 0),__decorate([S(cc.RichText)],t.prototype,"challengeStr",void 0),t=__decorate([T],t)}(n.default);i.default=I,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/Window":"Window","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/CommonUtil":"CommonUtil","../../Util/Utils":"Utils","../Tips/OpTipsController":"OpTipsController","../Tips/TipsWinController":"TipsWinController","./ExpCopyConst":"ExpCopyConst","./ExpCopyCtrl":"ExpCopyCtrl","./ExpCopyPassItem":"ExpCopyPassItem","./ExpCopyToggleItem":"ExpCopyToggleItem","./ExpCopyUtils":"ExpCopyUtils"}],ExpeditionConfig:[function(e,t,i){"use strict";cc._RF.push(t,"7411fZf2PFL36bMdniuk9v0","ExpeditionConfig"),Object.defineProperty(i,"__esModule",{value:!0}),i.ExpeditionConfig={ExpeditionLevel:1,current:0},function(e){e.Gamecustoms="Gamecustoms",e.GameNext="GameNext",e.SeeRecord="SeeRecord",e.yzinfor="yzinfor",e.Monsterinfo="Monsterinfo",e.ResetChallenge="ResetChallenge"}(i.ExpeditionEvent||(i.ExpeditionEvent={})),cc._RF.pop()},{}],ExpeditionController:[function(e,t,i){"use strict";cc._RF.push(t,"a4f60JPjqRATbOgm4bQWTeI","ExpeditionController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../Core/ConfigsManager"),a=e("./ExpeditionConfig"),r=e("../../Core/GameEventDispatcher"),s=e("../../Global/GlobalValue"),l=e("../../NetConnect/NetConnet"),c=e("../Role/RoleInfo"),d=e("../Vip/VipCtrl"),p=e("../../Util/CommonUtil"),h=cc._decorator,u=h.ccclass,f=(h.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ExpeditionGuard=null,t._configs=null,t._configsReward=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this,this._configs=o.ConfigsManager.instance.getConfigs("ExpeditionConf")},t.prototype.start=function(){e.prototype.start.call(this),this.addProto("yzinfo",this.yzinfo,this)},t.prototype.sendyzInfo=function(){l.default.instance.sendProto({cmd:"yzinfo"})},t.prototype.yzinfo=function(e){a.ExpeditionConfig.ExpeditionInfor=e,a.ExpeditionConfig.ExpeditionInfor.current>149&&(a.ExpeditionConfig.ExpeditionInfor.current=149),a.ExpeditionConfig.ExpeditionInfor.max>149&&(a.ExpeditionConfig.ExpeditionInfor.max=149),r.GameEventDispatcher.instance.emit(a.ExpeditionEvent.yzinfor,e)},t.prototype.getExpeditionId=function(e){return this._configs.Expedition[e]},t.prototype.getExpedition=function(e){void 0===e&&(e=1);var t=this.getExpeditionId(e);return t?t.id:[]},t.prototype.getExpeditionShow=function(e){var t=this.getExpeditionId(e);return t?t.passshow:[]},t.prototype.getFirstExpeditionShow=function(e){var t=this.getExpeditionId(e);return t?t.firstshow:[]},t.prototype.getSaveMonsterNum=function(){return this.getExpeditionId(a.ExpeditionConfig.ExpeditionInfor.current+1).save},t.prototype.getReward=function(e){for(var t=0;t<e.length&&t!=e.length-1;t++)e[t].type==e[t+1].type&&(e.splice(t+1,1),t--);return e},t.prototype.getNextVipReset=function(){return p.CommonUtil.getNextTimes(s.VipPrivilegeType.Expedition)},t.prototype.getVipReset=function(){var e=d.default.instance.data.getprivilegeData(c.MyRoleInfo.vipLevel,s.VipPrivilegeType.Expedition);return e?e.param[0]:0},t.prototype.setResetRed=function(){return!1},t.prototype.onSendReset=function(){l.default.instance.sendProto({cmd:"yzreset"})},t.prototype.onSendSweep=function(){l.default.instance.sendProto({cmd:"yzsweep"})},t.prototype.onSelectLayer=function(e){var t={cmd:"yzselect",layer:e};l.default.instance.sendProto(t)},t.instance=null,t=i=__decorate([u],t)}(n.default));i.default=f,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Controller":"Controller","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Global/GlobalValue":"GlobalValue","../../NetConnect/NetConnet":"NetConnet","../../Util/CommonUtil":"CommonUtil","../Role/RoleInfo":"RoleInfo","../Vip/VipCtrl":"VipCtrl","./ExpeditionConfig":"ExpeditionConfig"}],ExpeditionGuardInfo:[function(e,t,i){"use strict";cc._RF.push(t,"65008BSF2hAI4KoZyryTheV","ExpeditionGuardInfo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../WarTeam/MonsterController"),a=e("../../Util/Utils"),r=e("../../Core/WindowType"),s=e("../Commons/MonsterPreview"),l=e("../../Global/GlobalValue"),c=e("../Commons/CombatValue"),d=e("../../Core/TimeController"),p=e("../Status/StatusType"),h=e("../../GlobalContext"),u=e("../../Core/LoadManager"),f=cc._decorator,g=f.ccclass,y=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.MonsterCount=null,t.LayerCount=null,t.MonsterIcon=null,t.combatVal=0,t}return __extends(t,e),t.prototype.initData=function(e,t,i,n,r){var s=this;void 0===n&&(n=1),void 0===r&&(r=null);var l=0;n>0&&(l=p.ActivityStatus.value==p.ActivityStatus.TreasureMap?r.currentFight>0?r.currentFight:r.fight:o.default.instance.getCarFight(e,t,i)*n),this.combatVal+=l,a.default.setNodeChildDestoryByUrl(this.node.getChildByName("spriteCombat"),h.GlobalContext.Root+"prefab/CombatVal"),u.default.instance.loadResByType(h.GlobalContext.Root+"prefab/CombatVal",cc.Prefab,function(e){var t=a.default.getNodeByUrl(e,h.GlobalContext.Root+"prefab/CombatVal");s.node.getChildByName("spriteCombat").childrenCount>0?s.node.getChildByName("spriteCombat").getComponentInChildren(c.default).onInit(s.combatVal,22):(s.node.getChildByName("spriteCombat").addChild(t),s.node.getChildByName("spriteCombat").getComponentInChildren(c.default).onInit(s.combatVal,22))},this)},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),this.onClear()},t.prototype.resetCombat=function(){this.combatVal=0},t.prototype.getCombatCount=function(){return this.combatVal},t.prototype.initCreateMonster=function(e,t,i){this.creatMonster(e,t,i),this.LayerCount.active=i>0,this.MonsterCount.string=i+"",i<1&&this.initData(t,0,e,0)},t.prototype.creatMonster=function(e,t,i){var n=a.default.getNodeByPool(r.PoolType.MonsterPreview,o.default.instance.MonsterPreview);n.setScale(.3),this.MonsterIcon.addChild(n);var c=n.getComponent(s.default);c.init("monster",t,e,l.DEFAULTS_SKIN+e+"",l.PRIORITY.MONSTER,!1,l.ACTION.STAND,l.DIR.LEFT),d.default.instance.setTimeout(function(){c.node.children[0]&&(c.node.children[0].color=i<1?new cc.Color(100,100,100):new cc.Color(255,255,255))},this,1)},t.prototype.onClear=function(){this.MonsterIcon.children.length>0&&(this.MonsterIcon.children[0].getComponent(s.default)&&this.MonsterIcon.children[0].getComponent(s.default).node.children.length>0&&(this.MonsterIcon.children[0].color=new cc.Color(255,255,255),this.MonsterIcon.children[0].getComponent(s.default).node.color=new cc.Color(255,255,255),this.MonsterIcon.children[0].getComponent(s.default).node.children[0].color=new cc.Color(255,255,255)),a.default.setNodeToPool(r.PoolType.MonsterPreview,this.MonsterIcon.children[0])),a.default.setNodeChildDestoryByUrl(this.node.getChildByName("spriteCombat"),h.GlobalContext.Root+"prefab/CombatVal")},__decorate([y(cc.Label)],t.prototype,"MonsterCount",void 0),__decorate([y(cc.Node)],t.prototype,"LayerCount",void 0),__decorate([y(cc.Node)],t.prototype,"MonsterIcon",void 0),t=__decorate([g],t)}(n.default);i.default=m,cc._RF.pop()},{"../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/CombatValue":"CombatValue","../Commons/MonsterPreview":"MonsterPreview","../Status/StatusType":"StatusType","../WarTeam/MonsterController":"MonsterController"}],ExpeditionMirrorChioce:[function(e,t,i){"use strict";cc._RF.push(t,"8ed67t8n3JJPKInMaJDrCxi","ExpeditionMirrorChioce"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Scene/Controller/SceneController"),o=e("../Status/StatusType"),a=e("../../Core/GameEventDispatcher"),r=e("./ExpeditionConfig"),s=e("./ExpeditionController"),l=e("../Chapter/GuanqiaController"),c=e("../../Util/Utils"),d=e("../../Core/WindowType"),p=e("../Commons/MonsterPreview"),h=e("../../Global/GlobalValue"),u=e("../WarTeam/MonsterController"),f=e("../../Core/WindowManager"),g=e("../../Core/Widget"),y=e("../OpenWin/OpenWinController"),m=e("./ExpeditionRecord"),C=e("../../Core/Event"),v=cc._decorator,_=v.ccclass,b=v.property,T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Light=null,t.CheckBtn=null,t.numLabel=null,t.cratormonstNode=null,t.bg=null,t.guanNum=0,t.GuanQiaId=0,t.mirrorLevel=0,t.MonsertLiset=null,t.monsters=null,t.TouchThisNode=!1,t._isOpen=!1,t}var i;return __extends(t,e),i=t,t.prototype.show=function(){e.prototype.show.call(this),this.numLabel.string="\u7b2c"+this.guanNum+"\u6ce2",this.cratorNode(this.guanNum),this.Lisition(),this._isOpen=!1,a.GameEventDispatcher.instance.on(C.EventDefiner.ActivityStatus_GuanQia_Data,this.getRecord,this)},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),a.GameEventDispatcher.instance.off(C.EventDefiner.ActivityStatus_GuanQia_Data,this.getRecord,this),this.onClear()},t.prototype.onClear=function(){this.cratormonstNode.childrenCount>0&&this.cratormonstNode.children[0].getComponent(p.default)&&c.default.setNodeToPool(d.PoolType.MonsterPreview,this.cratormonstNode.children[0])},t.prototype.Lisition=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.TouchStart,this)},t.prototype.TouchStart=function(){this.TouchThisNode=!0;for(var e=this.node.parent,t=e.children.length-1;t>=0;t--){var n=e.children[t].getComponent(i);n&&(this.mirrorLevel=n.guanNum,n.Light.active=!1,n.CheckBtn.active=!1)}1==this.TouchThisNode&&(this.Light.active=!0,this.CheckBtn.active=!0)},t.prototype.cratorNode=function(e){var t=[],i=s.default.instance.getExpedition(e)[r.ExpeditionConfig.ExpeditionInfor.monIndex];if(this.monsters=l.default.instance.getGuanqiaMonsters(i,1),this.monsters&&this.monsters.length>0)for(var n=0;n<this.monsters.length;n++){var o=this.monsters[n].level;t.push(o)}var a=t[0];for(n=0;n<t.length;n++)a<t[n]&&(a=t[n]);var f;f=this.monsters.sort(function(e,t){return t.grade-e.grade});for(n=0;n<f.length;n++){if(f[n].level==a){var g=c.default.getNodeByPool(d.PoolType.MonsterPreview,u.default.instance.MonsterPreview);this.cratormonstNode.addChild(g),g.getComponent(p.default).init("monster",f[n].cardId,f[n].grade,h.DEFAULTS_SKIN+f[n].grade+"",h.PRIORITY.MONSTER),g.setPosition(0,0),g.setScale(.6);break}}},t.prototype.random=function(e,t){return Math.ceil(e+Math.random()*(t-e))},t.prototype.CheckRecordBtn=function(){n.default.instance.requestFightData(o.ActivityStatus.Expedition,this.guanNum+1),this._isOpen=!0},t.prototype.getRecord=function(e){if(this._isOpen){var t=e.getUserData();t&&(f.default.instance.close(d.WindowType.ExpeditionMirror),y.default.instance.openWindow(d.WindowType.ExpeditionRecord,function(){m.default.instance.onInitData(t.data)},this))}},__decorate([b(cc.Node)],t.prototype,"Light",void 0),__decorate([b(cc.Node)],t.prototype,"CheckBtn",void 0),__decorate([b(cc.Label)],t.prototype,"numLabel",void 0),__decorate([b(cc.Node)],t.prototype,"cratormonstNode",void 0),__decorate([b(cc.Node)],t.prototype,"bg",void 0),t=i=__decorate([_],t)}(g.default);i.default=T,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Widget":"Widget","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../Util/Utils":"Utils","../Chapter/GuanqiaController":"GuanqiaController","../Commons/MonsterPreview":"MonsterPreview","../OpenWin/OpenWinController":"OpenWinController","../Scene/Controller/SceneController":"SceneController","../Status/StatusType":"StatusType","../WarTeam/MonsterController":"MonsterController","./ExpeditionConfig":"ExpeditionConfig","./ExpeditionController":"ExpeditionController","./ExpeditionRecord":"ExpeditionRecord"}],ExpeditionMirrorPage:[function(e,t,i){"use strict";cc._RF.push(t,"a82afp7ZQ9OboEqwVJ79UbB","ExpeditionMirrorPage"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Commons/CommonPageBG"),o=e("../../Core/Language"),a=e("../../Util/Utils"),r=e("../Tips/OpTipsController"),s=e("./ExpeditionMirrorChioce"),l=e("./ExpeditionConfig"),c=e("./ExpeditionController"),d=e("../../Core/GameEventDispatcher"),p=e("../../GlobalContext"),h=e("../../Core/LoadManager"),u=cc._decorator,f=u.ccclass,g=u.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layerContent=null,t.scrollView=null,t.labelMirrorTips=null,t.btnLeftPage=null,t.btnRightPage=null,t._scrollIndex=0,t._scrollMax=0,t._maxMirrorLen=4,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.onInit(1115,618,o.default.getStr("expedition_mirror_title"),!0)},t.prototype.show=function(){e.prototype.show.call(this),this.onShowPage()},t.prototype.onDisable=function(){e.prototype.onDisable.call(this)},t.prototype.onClose=function(){e.prototype.onClose.call(this)},t.prototype.onClickLeftPage=function(){this._scrollIndex>0&&(this._scrollIndex--,this.scrollView.scrollToPercentHorizontal(this._scrollIndex/(this._scrollMax-4),.5))},t.prototype.onClickRinghtPage=function(){this._scrollIndex<this._scrollMax-4&&(this._scrollIndex++,this.scrollView.scrollToPercentHorizontal(this._scrollIndex/(this._scrollMax-4),.5))},t.prototype.onShowPage=function(){var e=this;a.default.setNodeChildDestoryByUrl(this.layerContent,p.GlobalContext.Root+"prefab/Expedition/ExpeditionNoMirrorChioce",p.GlobalContext.Root+"prefab/Expedition/ExpeditionMirrorChioce");var t=Math.floor(l.ExpeditionConfig.ExpeditionInfor.mirror/10),i=this._maxMirrorLen;t>this._maxMirrorLen?(i=Math.ceil(t/this._maxMirrorLen)*this._maxMirrorLen,a.default.setNodeActive(null,[this.btnLeftPage,this.btnRightPage])):a.default.setNodeActive([this.btnLeftPage,this.btnRightPage],null),h.default.instance.loadResByType(p.GlobalContext.Root+"prefab/Expedition/ExpeditionNoMirrorChioce",cc.Prefab,function(n){h.default.instance.loadResByType(p.GlobalContext.Root+"prefab/Expedition/ExpeditionMirrorChioce",cc.Prefab,function(r){for(var c=1;c<=i;c++)if(c>t){var d=a.default.getNodeByUrl(n,p.GlobalContext.Root+"prefab/Expedition/ExpeditionNoMirrorChioce");e.layerContent.addChild(d)}else{var h=10*c;(d=a.default.getNodeByUrl(r,p.GlobalContext.Root+"prefab/Expedition/ExpeditionMirrorChioce")).getComponent(s.default).guanNum=h,e.layerContent.addChild(d)}e._scrollMax=i,e._scrollIndex=i-4,e.labelMirrorTips.string=o.default.getStr(2==l.ExpeditionConfig.ExpeditionInfor.state?"expedition_page_mirror_tips_1":"expedition_page_mirror_tips_2"),e.scrollView.scrollToRight()},e)},this)},t.prototype.onClickChallenge=function(){for(var e=this.layerContent.childrenCount,t=null,i=0;i<e;i++){if(t=this.layerContent.children[i].getComponent(s.default))if(0!=t.TouchThisNode&&1==t.Light.active){l.ExpeditionConfig.ExpeditionLevel=t.guanNum,c.default.instance.onSelectLayer(t.guanNum);var n=c.default.instance.getExpedition(t.guanNum+1);n[this.onRandom(0,n.length-1)];return l.ExpeditionConfig.current=t.guanNum+1,void this.onClose()}}r.default.instance.ShowMsg(o.default.getStr("expedition_page_error_1"))},t.prototype.onClickReset=function(){d.GameEventDispatcher.instance.emit(l.ExpeditionEvent.ResetChallenge)},t.prototype.onRandom=function(e,t){return Math.ceil(e+Math.random()*(t-e))},__decorate([g(cc.Node)],t.prototype,"layerContent",void 0),__decorate([g(cc.ScrollView)],t.prototype,"scrollView",void 0),__decorate([g(cc.Label)],t.prototype,"labelMirrorTips",void 0),__decorate([g(cc.Node)],t.prototype,"btnLeftPage",void 0),__decorate([g(cc.Node)],t.prototype,"btnRightPage",void 0),t=__decorate([f],t)}(n.default);i.default=y,cc._RF.pop()},{"../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/CommonPageBG":"CommonPageBG","../Tips/OpTipsController":"OpTipsController","./ExpeditionConfig":"ExpeditionConfig","./ExpeditionController":"ExpeditionController","./ExpeditionMirrorChioce":"ExpeditionMirrorChioce"}],ExpeditionMonsterinfo:[function(e,t,i){"use strict";cc._RF.push(t,"f4908jRCKZF049rhDzFAhvY","ExpeditionMonsterinfo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/ConfigsManager"),a=e("../WarTeam/MonsterController"),r=e("../../Util/Utils"),s=e("./ExpeditionGuardInfo"),l=e("../Status/StatusType"),c=e("../../Core/LoadManager"),d=e("../../GlobalContext"),p=e("../../Core/CommonsResManager"),h=cc._decorator,u=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Level=null,t.MonsterName=null,t.MonsterLayer=null,t.rarity=null,t.Posi=null,t.monsterLen=5,t}return __extends(t,e),t.prototype.onDisable=function(){e.prototype.onDisable.call(this),r.default.setNodeChildDestoryByUrl(this.MonsterLayer,d.GlobalContext.Root+"prefab/Expedition/ExpeditionGuard")},t.prototype.initData=function(e,t,i,n,h){var u=this,f=a.default.instance.getCardConfCardType(e);this.Posi.spriteFrame=p.default.instance.getSpriteFrameByName("stance_"+f),this.Level.string="Lv\uff1a"+t,this.MonsterName.string=n,this.rarity.spriteFrame=p.default.instance.getSpriteFrameByName("rarity_"+o.ConfigsManager.instance.getConfigs("cardConf").Card[e].rarity);var g=h.length,y=0;if(r.default.setNodeChildDestoryByUrl(this.MonsterLayer,d.GlobalContext.Root+"prefab/Expedition/ExpeditionGuard"),c.default.instance.loadResByType(d.GlobalContext.Root+"prefab/Expedition/ExpeditionGuard",cc.Prefab,function(t){for(var i=0;i<u.monsterLen;i++){var n=r.default.getNodeByUrl(t,d.GlobalContext.Root+"prefab/Expedition/ExpeditionGuard"),o=n.getComponent(s.default);o.resetCombat();for(var a=0,l=0;l<g;l++)i+1==h[l].grade&&(h[l].count>1?a+=h[l].count:a++,o.initData(e,h[l].level,h[l].grade,h[l].count?h[l].count:1,h[l]));y+=o.getCombatCount(),o.initCreateMonster(i+1,e,a),u.MonsterLayer.addChild(n)}},this),y<=0)for(var m=0;m<this.monsterLen;m++)for(var C=0;C<g;C++)m+1==h[C].grade&&(h[C].count>1?h[C].count:0,h[C]&&h[C].currentFight>0&&l.ActivityStatus.value==l.ActivityStatus.TreasureMap?y+=h[C].currentFight:y+=a.default.instance.getCarFight(e,h[C].level,h[C].grade)*(h[C].count?h[C].count:1));return y},__decorate([f(cc.Label)],t.prototype,"Level",void 0),__decorate([f(cc.Label)],t.prototype,"MonsterName",void 0),__decorate([f(cc.Node)],t.prototype,"MonsterLayer",void 0),__decorate([f(cc.Sprite)],t.prototype,"rarity",void 0),__decorate([f(cc.Sprite)],t.prototype,"Posi",void 0),t=__decorate([u],t)}(n.default);i.default=g,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/ConfigsManager":"ConfigsManager","../../Core/LoadManager":"LoadManager","../../Core/Widget":"Widget","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Status/StatusType":"StatusType","../WarTeam/MonsterController":"MonsterController","./ExpeditionGuardInfo":"ExpeditionGuardInfo"}],ExpeditionRecord:[function(e,t,i){"use strict";cc._RF.push(t,"44251I/WVZC6JroLE67o/K2","ExpeditionRecord"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Commons/CommonPageBG"),o=e("../../Core/Language"),a=e("../SandTable/SandTableShow"),r=e("../../Core/ConfigsManager"),s=e("../WarTeam/MonsterController"),l=e("./ExpeditionMonsterinfo"),c=e("../Commons/CombatValue"),d=e("../../Util/Utils"),p=e("../../GlobalContext"),h=e("../../Core/LoadManager"),u=e("../Role/RoleInfo"),f=cc._decorator,g=f.ccclass,y=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layerShaPan=null,t.layerSPContent=null,t.layerRecord=null,t.layerMonsterinfoContent=null,t.scrollView=null,t.layerCombat=null,t._cardConfigs=null,t._recordData=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this,this.onInit(1034,613,o.default.getStr("expedition_title"),!0)},t.prototype.onInitData=function(e){void 0===e&&(e=null),this._recordData=e,this.onShowPage()},t.prototype.onShowPage=function(){this.onShowShaPan(),this.onShowShaPanLayer(!0)},t.prototype.onShowShaPan=function(){var e=this;this._recordData.table&&(d.default.setNodeChildDestoryByUrl(this.layerSPContent,p.GlobalContext.Root+"prefab/sandTable/SandTableShow"),h.default.instance.loadResByType(p.GlobalContext.Root+"prefab/sandTable/SandTableShow",cc.Prefab,function(t){var i=d.default.getNodeByUrl(t,p.GlobalContext.Root+"prefab/sandTable/SandTableShow");i.getComponent(a.default).setSize(500,e._recordData.table),e.layerSPContent.insertChild(i,1)},this))},t.prototype.onShowMonster=function(){var e=this;d.default.setNodeChildDestoryByUrl(this.layerMonsterinfoContent,p.GlobalContext.Root+"prefab/Expedition/ExpeditionMonsterinfo"),h.default.instance.loadResByType(p.GlobalContext.Root+"prefab/Expedition/ExpeditionMonsterinfo",cc.Prefab,function(t){if(e._recordData.reserve){e._cardConfigs||(e._cardConfigs=r.ConfigsManager.instance.getConfigs("cardConf"));var i=[];if(null!=e._recordData.reserve){var n=s.default.instance.GetWarTeamConfig(),o=0;for(var a in e._recordData.reserve){var f=e._recordData.reserve[a];i[f.id]||(i[f.id]={},i[f.id].id=e._recordData.reserve[a].id,i[f.id].list=[]),i[f.id].list.push(f)}for(var a in n){var g=-1,y=n[a];for(var m in i)if(a==i[m].id){g=Number(m);break}var C=d.default.getNodeByUrl(t,p.GlobalContext.Root+"prefab/Expedition/ExpeditionMonsterinfo");e.layerMonsterinfoContent.addChild(C),o+=C.getComponent(l.default).initData(y.id,y.level,y.grade,e._cardConfigs.Card[y.id].cardName,g>=0?i[g].list:[])}o+=u.MyRoleInfo.Fight,e.scrollView.scrollToTop(),d.default.setNodeChildDestoryByUrl(e.layerCombat,p.GlobalContext.Root+"prefab/CombatVal"),h.default.instance.loadResByType(p.GlobalContext.Root+"prefab/CombatVal",cc.Prefab,function(t){var i=d.default.getNodeByUrl(t,p.GlobalContext.Root+"prefab/CombatVal");i.getComponent(c.default).onInit(o,34,1.5,!0),e.layerCombat.addChild(i)},e)}}},this)},t.prototype.onShowShaPanLayer=function(e){this.layerShaPan.active=e,this.layerRecord.active=!e},t.prototype.onClickShaPan=function(){this.onShowShaPanLayer(!0)},t.prototype.onClickMonster=function(){this.onShowShaPanLayer(!1),this.onShowMonster()},t.instance=null,__decorate([y(cc.Node)],t.prototype,"layerShaPan",void 0),__decorate([y(cc.Node)],t.prototype,"layerSPContent",void 0),__decorate([y(cc.Node)],t.prototype,"layerRecord",void 0),__decorate([y(cc.Node)],t.prototype,"layerMonsterinfoContent",void 0),__decorate([y(cc.ScrollView)],t.prototype,"scrollView",void 0),__decorate([y(cc.Node)],t.prototype,"layerCombat",void 0),t=i=__decorate([g],t)}(n.default);i.default=m,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/CombatValue":"CombatValue","../Commons/CommonPageBG":"CommonPageBG","../Role/RoleInfo":"RoleInfo","../SandTable/SandTableShow":"SandTableShow","../WarTeam/MonsterController":"MonsterController","./ExpeditionMonsterinfo":"ExpeditionMonsterinfo"}],ExpeditionReset:[function(e,t,i){"use strict";cc._RF.push(t,"a549a/daq9P46H4Gu8BZpYJ","ExpeditionReset"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../GlobalContext"),o=e("./ExpeditionConfig"),a=e("../../Util/Utils"),r=e("../Item/ItemIcon"),s=e("../Item/ItemData"),l=e("../../Core/WindowType"),c=e("./ExpeditionController"),d=e("../../Core/Language"),p=e("../Commons/CommonPageBG"),h=e("../../Core/WindowManager"),u=e("../../Core/LoadManager"),f=cc._decorator,g=f.ccclass,y=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.labelMaxLevel=null,t.labelGetLevel=null,t.itemContent=null,t.YzInfor=null,t.rewardList=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.onInit(645,496,d.default.getStr("expedition_reset_title"),!0)},t.prototype.show=function(){e.prototype.show.call(this),this.onShowPage()},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),this.onClear()},t.prototype.onShowPage=function(){this.YzInfor=o.ExpeditionConfig.ExpeditionInfor,this.rewardList=[];for(var e=this.YzInfor.max,t=10*Math.floor(e/10),i=1;i<=t;i++){var n=c.default.instance.getExpeditionShow(i),a=!1;for(var r in n){for(var s=0;s<this.rewardList.length;s++)if(this.rewardList[s].id==n[r]){this.rewardList[s].count+=1,a=!0;break}a||this.rewardList.push({id:n[r],count:1})}}this.labelMaxLevel.string=d.default.getStr("expedition_page_max_bo_val",e),this.labelGetLevel.string=d.default.getStr("expedition_page_bo_val",1,t),this.onShowReward(this.rewardList)},t.prototype.onShowReward=function(e){var t=this;this.onClear(),u.default.instance.loadResByType(n.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(i){for(var o in e){var c=a.default.getNodeByPool(l.PoolType.ItemIcon,i,n.GlobalContext.Root+"prefab/Bag/ItemIcon");if(5008==e[o])return;var d=s.default.creatItem(e[o].id,e[o].count);c.getComponent(r.default).ItemData(d,!0),c.setScale(.8),t.itemContent.addChild(c)}e.length<5?t.itemContent.parent.parent.setPosition((518-100*e.length)/2,-65):t.itemContent.parent.parent.setPosition(18,-25)},this)},t.prototype.onClear=function(){for(var e=this.itemContent.childrenCount-1;e>=0;e--)a.default.setNodeToPool(l.PoolType.ItemIcon,this.itemContent.children[e]);this.itemContent.removeAllChildren()},t.prototype.onClickConfire=function(){this.onClickClose()},t.prototype.onClickClose=function(){h.default.instance.close(l.WindowType.ExpeditionReset),this.YzInfor.max>=30&&c.default.instance.onSelectLayer(10*(Math.floor(this.YzInfor.max/10)-2))},t.prototype.onClose=function(){this.onClickClose()},__decorate([y(cc.Label)],t.prototype,"labelMaxLevel",void 0),__decorate([y(cc.Label)],t.prototype,"labelGetLevel",void 0),__decorate([y(cc.Node)],t.prototype,"itemContent",void 0),t=__decorate([g],t)}(p.default);i.default=m,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/CommonPageBG":"CommonPageBG","../Item/ItemData":"ItemData","../Item/ItemIcon":"ItemIcon","./ExpeditionConfig":"ExpeditionConfig","./ExpeditionController":"ExpeditionController"}],ExpeditionReward:[function(e,t,i){"use strict";cc._RF.push(t,"9f452AIGExKyJmExNuj4wvD","ExpeditionReward"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../GlobalContext"),a=e("./ExpeditionConfig"),r=e("./ExpeditionController"),s=e("../../Util/Utils"),l=e("../../Core/WindowType"),c=e("../Item/ItemIcon"),d=e("../Commons/RewardUtils"),p=e("../../Core/Language"),h=e("../../Core/LoadManager"),u=cc._decorator,f=u.ccclass,g=u.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.nowlevelLabel=null,t.targetlevelLabel=null,t.nowLevelShowNode=null,t.targetLevelShowNode=null,t.targetLevelNode=null,t.duihao=null,t.YzInfor=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.show=function(){e.prototype.show.call(this),this.node.width=o.GlobalContext.UIWidth,this.node.parent.width=o.GlobalContext.UIWidth,this.node.y=o.GlobalContext.UIHeight/2-this.node.height/2,this.node.getComponent(cc.Widget).left=o.PlayerData.SceneBorld,this.initUIdata()},t.prototype.hide=function(){e.prototype.hide.call(this),this.onRemoveNode(this.nowLevelShowNode),this.onRemoveNode(this.targetLevelShowNode)},t.prototype.initUIdata=function(){if(this.YzInfor=a.ExpeditionConfig.ExpeditionInfor,this.YzInfor){var e=this.YzInfor.current+1;this.nowlevelLabel.string=p.default.getStr("expedition_reward_bo_val",e);var t=this.firstPassReward(e);this.creatorNowLevelNode(t);var i=Math.floor(e/10);i<=0?i=10:(i=10*(i+1))>150&&(i=150),this.targetLevelNode.active=e!=i||e>=150;var n=this.firstPassReward(i);this.creatortargetLevelNode(n,i),this.targetlevelLabel.string=p.default.getStr("expedition_reward_bo_val",i),this.node.opacity=255}else this.node.opacity=0},t.prototype.firstPassReward=function(e){return this.YzInfor.max<=e?r.default.instance.getFirstExpeditionShow(e):r.default.instance.getExpeditionShow(e)},t.prototype.onChangeNodeChildColor=function(e,t){if(void 0===t&&(t=!1),e.childrenCount>0)for(var i=e.children[0].childrenCount,n=0;n<i;n++)e.children[0].children[n].color=t?new cc.Color(150,150,150):new cc.Color(255,255,255)},t.prototype.onChangeGet=function(e,t){if(void 0===t&&(t=!0),!e.getChildByName("isGet")&&t){var i=new cc.Node;i.addComponent(cc.Sprite).spriteFrame=this.duihao,i.name="isGet",e.insertChild(i,999)}e.getChildByName("isGet")&&!t&&e.removeChild(e.getChildByName("isGet"))},t.prototype.creatorNowLevelNode=function(e){this.onRemoveNode(this.nowLevelShowNode),this.onCreate(this.nowLevelShowNode,e,this.YzInfor.todaypass,this.YzInfor.current-1)},t.prototype.creatortargetLevelNode=function(e,t){this.onRemoveNode(this.targetLevelShowNode),this.onCreate(this.targetLevelShowNode,e,this.YzInfor.todaypass,t-1)},t.prototype.onCreate=function(e,t,i,n){var a=this,r=d.default.instance.getItemList(t);h.default.instance.loadResByType(o.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(t){for(var d in r){var p=s.default.getNodeByPool(l.PoolType.ItemIcon,t,o.GlobalContext.Root+"prefab/Bag/ItemIcon");e.addChild(p),p.getComponent(c.default).ItemData(r[d],!0,null,!0),p.setScale(.8),a.YzInfor.max>=150&&a.YzInfor.current>=150?(a.onChangeNodeChildColor(p,!0),a.onChangeGet(p,!0)):i[n+1]?(a.onChangeNodeChildColor(p,!0),a.onChangeGet(p,!0)):(a.onChangeNodeChildColor(p,!1),a.onChangeGet(p,!1))}},this)},t.prototype.onRemoveNode=function(e){for(var t=e.childrenCount-1;t>=0;t--){e.children[t].getComponent(c.default);this.onChangeNodeChildColor(e.children[t],!1),this.onChangeGet(e.children[t],!1),s.default.setNodeToPool(l.PoolType.ItemIcon,e.children[t])}},t.instance=null,__decorate([g(cc.Label)],t.prototype,"nowlevelLabel",void 0),__decorate([g(cc.Label)],t.prototype,"targetlevelLabel",void 0),__decorate([g(cc.Node)],t.prototype,"nowLevelShowNode",void 0),__decorate([g(cc.Node)],t.prototype,"targetLevelShowNode",void 0),__decorate([g(cc.Node)],t.prototype,"targetLevelNode",void 0),__decorate([g(cc.SpriteFrame)],t.prototype,"duihao",void 0),t=i=__decorate([f],t)}(n.default);i.default=y,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/RewardUtils":"RewardUtils","../Item/ItemIcon":"ItemIcon","./ExpeditionConfig":"ExpeditionConfig","./ExpeditionController":"ExpeditionController"}],Expedition:[function(e,t,i){"use strict";cc._RF.push(t,"31a01I5J5RKoa8om0LKH/GK","Expedition"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../Chapter/GuanqiaController"),a=e("../../Core/GameEventDispatcher"),r=e("../../Core/Event"),s=e("../../Util/Utils"),l=e("../../Core/WindowType"),c=e("../Commons/MonsterPreview"),d=e("../../Global/GlobalValue"),p=e("./ExpeditionController"),h=e("./ExpeditionConfig"),u=e("../Scene/View/Chapter/ListControl"),f=e("../../GlobalContext"),g=e("../Scene/Controller/FightController"),y=e("../Commons/CombatValue"),m=e("../Tips/OpTipsController"),C=e("../../Core/Language"),v=e("../Status/StatusType"),_=e("../OpenWin/OpenWinController"),b=e("../Shop/ShopController"),T=e("../Shop/ShopConst"),S=e("../Shop/Shop"),I=e("../WarTeam/MonsterController"),w=e("../Scene/Manager/SceneManager"),D=e("../../Core/LoadManager"),R=e("../Scene/Controller/SceneController"),A=e("./ExpeditionReward"),N=e("../Guide/GuideNewController"),L=e("../Role/RoleInfo"),E=cc._decorator,B=E.ccclass,M=E.property,x=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layerMonsterContent=null,t.SweepButton=null,t.ChallengeButton=null,t.ResetButton=null,t.BoLabel=null,t.layerCombat=null,t.layerBottom=null,t.ResetRed=null,t.ResetNum=null,t.Vip=null,t.IsGameAgarn=!1,t.isClickMirror=!1,t._resetNum=null,t._vipLevel=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.show=function(){e.prototype.show.call(this),h.ExpeditionConfig.ExpeditionInfor&&this.onShowMonster(),this.node.setContentSize(f.GlobalContext.UIWidth,f.GlobalContext.UIHeight),a.GameEventDispatcher.instance.on(h.ExpeditionEvent.Gamecustoms,this.getCombatResults,this),a.GameEventDispatcher.instance.on(h.ExpeditionEvent.GameNext,this.onGameNext,this),a.GameEventDispatcher.instance.on(h.ExpeditionEvent.yzinfor,this.GameAgarnStart,this),a.GameEventDispatcher.instance.on(h.ExpeditionEvent.ResetChallenge,this.onGameAgain,this),u.default.instance.OpenList(8,this.node)},t.prototype.hide=function(){e.prototype.hide.call(this),this.clearMonsterPreview(),a.GameEventDispatcher.instance.off(h.ExpeditionEvent.GameNext,this.onGameNext,this),a.GameEventDispatcher.instance.off(h.ExpeditionEvent.Gamecustoms,this.getCombatResults,this),a.GameEventDispatcher.instance.off(h.ExpeditionEvent.yzinfor,this.GameAgarnStart,this),a.GameEventDispatcher.instance.off(h.ExpeditionEvent.ResetChallenge,this.onGameAgain,this)},t.prototype.backBtn=function(){this.close()},t.prototype.onShowMonster=function(){var e=h.ExpeditionConfig.ExpeditionInfor.current+1;this.LevelMonsterInfor(e),this.BoLabel.string=e+"",h.ExpeditionConfig.current=e,this.SelectMode()},t.prototype.SelectMode=function(){var e=h.ExpeditionConfig.ExpeditionInfor.sweep,t=h.ExpeditionConfig.ExpeditionInfor,i=t.max,n=t.current;e?s.default.setNodeActive([this.ResetButton],[this.SweepButton]):s.default.setNodeActive([this.SweepButton],[this.ResetButton]),this.ChallengeButton.getComponent(cc.Button).interactable=!(n>=150&&i>=150);var o=p.default.instance.getVipReset();if(h.ExpeditionConfig.ExpeditionInfor.times<o)this.Vip.string="",this.ResetNum.string=C.default.getStr("expedition_reset_num",o-h.ExpeditionConfig.ExpeditionInfor.times);else{var a=p.default.instance.getNextVipReset();null!=a&&(this.Vip.string=C.default.getStr("expedition_vip",a[0]),this.ResetNum.string=C.default.getStr("expedition_reset_num",a[1]),a[0]<=L.MyRoleInfo.vipLevel&&a[1]<=h.ExpeditionConfig.ExpeditionInfor.times?this.ResetButton.getComponent(cc.Button).interactable=!1:this.ResetButton.getComponent(cc.Button).interactable=!0)}},t.prototype.LevelMonsterInfor=function(e){var t=p.default.instance.getExpedition(e)[h.ExpeditionConfig.ExpeditionInfor.monIndex];h.ExpeditionConfig.ExpeditionLevel=t;var i=o.default.instance.getGuanqiaMonsters(t,1);this.onCalculation(t,i);var n=[];n.push(i[i.length-1]),this.CreateMonster(n)},t.prototype.onCalculation=function(e,t){var i=this,n=0;for(var o in t){var a=g.default.instance.getGQMonsterAttr(e,t[o].skilllevel,t[o]);n+=a.GetFight()*t[o].num}s.default.setNodeChildDestoryByUrl(this.layerCombat,f.GlobalContext.Root+"prefab/CombatVal"),D.default.instance.loadResByType(f.GlobalContext.Root+"prefab/CombatVal",cc.Prefab,function(e){var t=s.default.getNodeByUrl(e,f.GlobalContext.Root+"prefab/CombatVal");i.layerCombat.addChild(t),t.getComponent(y.default).onInit(n,22)},this)},t.prototype.CreateMonster=function(e){this.clearMonsterPreview();var t=[];if(e.length>=4){t=e.sort(function(e,t){return t.grade-e.grade});for(var i=0,n=0;n<t.length;n++){var o=s.default.getNodeByPool(l.PoolType.MonsterPreview,I.default.instance.MonsterPreview);this.layerMonsterContent.addChild(o);o.getComponent(c.default);var a=I.default.instance.getCardGradeByGradeConf(t[n].cardId,t[n].grade);0==n?I.default.instance.infoPreview(this.layerMonsterContent,cc.v2(a.monsteroffset[0]/100,10+a.monsteroffset[1]/100),t[n].cardId,t[n].grade,1.3,-1,!0,null,null):(I.default.instance.infoPreview(this.layerMonsterContent,cc.v2(160*i-160+a.monsteroffset[0]/100,a.monsteroffset[1]/100-10),t[n].cardId,t[n].grade,.8,-1,!0,null,null),i++)}}else for(n=0;n<e.length;n++){a=I.default.instance.getCardGradeByGradeConf(e[n].cardId,e[n].grade);I.default.instance.infoPreview(this.layerMonsterContent,cc.v2(a.monsteroffset[0]/100,a.monsteroffset[1]/100-10),e[n].cardId,e[n].grade,.8,-1,!0,null,null)}},t.prototype.random=function(e,t){return Math.ceil(e+Math.random()*(t-e))},t.prototype.ChallengeStart=function(){a.GameEventDispatcher.instance.emit(r.EventDefiner.ChangeActivityStatus,v.ActivityStatus.Expedition),a.GameEventDispatcher.instance.emit(r.EventDefiner.ChangeGameScene,{status:d.GameScene.Fight,guanqiaId:h.ExpeditionConfig.ExpeditionLevel}),this.close()},t.prototype.clearMonsterPreview=function(){for(var e=this.layerMonsterContent.childrenCount-1;e>=0;e--){this.layerMonsterContent.children[e].getComponent(c.default).clear(),s.default.setNodeToPool(l.PoolType.MonsterPreview,this.layerMonsterContent.children[e])}},t.prototype.getCombatResults=function(){if(w.default.instance.fightresult){var e=h.ExpeditionConfig.ExpeditionInfor.current+1;e>150&&m.default.instance.ShowMsg("\u5df2\u901a\u5173"),this.LevelMonsterInfor(e)}else h.ExpeditionConfig.ExpeditionInfor.max>=10&&N.default.instance.checkCondition(25)},t.prototype.onGameNext=function(){this.ChallengeStart()},t.prototype.onGameAgain=function(){this.IsGameAgarn=!0,p.default.instance.onSendReset()},t.prototype.GameAgarnStart=function(e){var t=e.getUserData();if(0==t.current&&1==this.IsGameAgarn){var i=p.default.instance.getExpedition()[h.ExpeditionConfig.ExpeditionInfor.monIndex];h.ExpeditionConfig.current=t.current+1,a.GameEventDispatcher.instance.emit(r.EventDefiner.ChangeGameScene,{status:d.GameScene.Fight,guanqiaId:i}),this.IsGameAgarn=!1}h.ExpeditionConfig.ExpeditionInfor&&this.onShowMonster(),A.default.instance.initUIdata()},t.prototype.onClickReset=function(){if(0!=h.ExpeditionConfig.ExpeditionInfor.max){var e=p.default.instance.getVipReset();h.ExpeditionConfig.ExpeditionInfor.times>=e?m.default.instance.ShowMsg(this.Vip.string+this.ResetNum.string):p.default.instance.onSendReset()}else m.default.instance.ShowMsg(C.default.getStr("expedition_reset_none2"))},t.prototype.onClickShop=function(){_.default.instance.openWindow(l.WindowType.Shop,function(){var e=b.default.instance.nowSortIndex[T.ShopConst.integral];S.default.instance.TabBtnList2.selectItem(e)},this)},t.prototype.onClickSweep=function(){p.default.instance.onSendSweep(),R.default.instance.requestFightData(v.ActivityStatus.Expedition,h.ExpeditionConfig.ExpeditionInfor.max+1)},t.prototype.onClickMirror=function(){h.ExpeditionConfig.ExpeditionInfor.mirror<10?m.default.instance.ShowMsg(C.default.getStr("expedition_page_error_2")):_.default.instance.openWindow(l.WindowType.ExpeditionMirror,function(){},this)},t.instence=null,__decorate([M(cc.Node)],t.prototype,"layerMonsterContent",void 0),__decorate([M(cc.Node)],t.prototype,"SweepButton",void 0),__decorate([M(cc.Node)],t.prototype,"ChallengeButton",void 0),__decorate([M(cc.Node)],t.prototype,"ResetButton",void 0),__decorate([M(cc.Label)],t.prototype,"BoLabel",void 0),__decorate([M(cc.Node)],t.prototype,"layerCombat",void 0),__decorate([M(cc.Node)],t.prototype,"layerBottom",void 0),__decorate([M(cc.Node)],t.prototype,"ResetRed",void 0),__decorate([M(cc.Label)],t.prototype,"ResetNum",void 0),__decorate([M(cc.Label)],t.prototype,"Vip",void 0),t=__decorate([B],t)}(n.default);i.default=x,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/Window":"Window","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Chapter/GuanqiaController":"GuanqiaController","../Commons/CombatValue":"CombatValue","../Commons/MonsterPreview":"MonsterPreview","../Guide/GuideNewController":"GuideNewController","../OpenWin/OpenWinController":"OpenWinController","../Role/RoleInfo":"RoleInfo","../Scene/Controller/FightController":"FightController","../Scene/Controller/SceneController":"SceneController","../Scene/Manager/SceneManager":"SceneManager","../Scene/View/Chapter/ListControl":"ListControl","../Shop/Shop":"Shop","../Shop/ShopConst":"ShopConst","../Shop/ShopController":"ShopController","../Status/StatusType":"StatusType","../Tips/OpTipsController":"OpTipsController","../WarTeam/MonsterController":"MonsterController","./ExpeditionConfig":"ExpeditionConfig","./ExpeditionController":"ExpeditionController","./ExpeditionReward":"ExpeditionReward"}],FeedBackWin:[function(e,t,i){"use strict";cc._RF.push(t,"28663w/hTxJgJqxGWZbYWC9","FeedBackWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Commons/CommonPageBG"),o=e("../../Core/Language"),a=e("../../Util/BackStageUtils"),r=e("../Tips/OpTipsController"),s=e("../../Util/SDKUtils"),l=cc._decorator,c=l.ccclass,d=l.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.toggleContainer=null,t.str1=null,t.str2=null,t.str3=null,t.str4=null,t.inputContent=null,t.titles=null,t.index=null,t.strs=null,t}return __extends(t,e),t.prototype.onLoad=function(){var t;for(var i in e.prototype.onLoad.call(this),this.onInit(893,593,o.default.getStr("7214"),!0),this.index=null,this.strs=[],this.titles=[o.default.getStr("7217"),o.default.getStr("7218"),o.default.getStr("7219"),o.default.getStr("7220")],this.inputContent.placeholder=o.default.getStr("7222"),t=[o.default.getStr("7224"),o.default.getStr("7225"),o.default.getStr("7226"),o.default.getStr("7227",s.default.instance.platformSdk.qq)],this.str1.string=t[0],this.str2.string=t[1],this.str3.string=t[2],this.str4.string=t[3],this.toggleContainer.children)this.toggleContainer.children[i].getComponentInChildren(cc.Label).string=this.titles[i]},t.prototype.show=function(){e.prototype.show.call(this),this.index=0,this.inputContent.string="",this.toggleContainer.children[this.index].getComponent(cc.Toggle).isChecked=!0},t.prototype.hide=function(){this.index=null},t.prototype.onClickToggle=function(e){var t=parseInt(e.target.name);t!=this.index&&(this.index=t)},t.prototype.setStrs=function(){10==this.strs.length&&this.strs.shift(),this.strs.push(this.inputContent.string)},t.prototype.onSendBtn=function(){if(this.inputContent.string.length)if(this.strs.indexOf(this.inputContent.string)>-1)r.default.instance.ShowMsg(o.default.getStr("7223"));else{var e=this.inputContent.string.replace(/\|/g,"#");a.BackStageUtils.instance.sendOpinionHttps(this.index+1,this.titles[this.index],e),this.setStrs(),this.inputContent.string=""}else r.default.instance.ShowMsg(o.default.getStr("7221"))},__decorate([d(cc.Node)],t.prototype,"toggleContainer",void 0),__decorate([d(cc.RichText)],t.prototype,"str1",void 0),__decorate([d(cc.Label)],t.prototype,"str2",void 0),__decorate([d(cc.Label)],t.prototype,"str3",void 0),__decorate([d(cc.RichText)],t.prototype,"str4",void 0),__decorate([d(cc.EditBox)],t.prototype,"inputContent",void 0),t=__decorate([c],t)}(n.default);i.default=p,cc._RF.pop()},{"../../Core/Language":"Language","../../Util/BackStageUtils":"BackStageUtils","../../Util/SDKUtils":"SDKUtils","../Commons/CommonPageBG":"CommonPageBG","../Tips/OpTipsController":"OpTipsController"}],FightActiveSkill:[function(e,t,i){"use strict";cc._RF.push(t,"d4e6ebm5ltGNZsZEAcNbu7Q","FightActiveSkill"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Language"),o=e("../Role/RoleController"),a=e("../../Core/Widget"),r=e("../Commons/Image"),s=e("../../Core/GameEventDispatcher"),l=e("../../Core/Event"),c=e("../Tips/OpTipsController"),d=e("../Artifact/ArtifactCtrl"),p=e("../Scene/Manager/SceneManager"),h=e("../../Global/GlobalValue"),u=e("../../Util/Utils"),f=cc._decorator,g=f.ccclass,y=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.icon=null,t.iconBg=null,t}return __extends(t,e),t.prototype.show=function(){s.GameEventDispatcher.instance.on(l.EventDefiner.Fight_BigSkill_Update,this.interUpdate,this);var e="resources/fight/bg_icon"+d.default.instance.getData().getSkillIndex()+".png";this.icon.getComponent(r.default).updateBg(e),u.default.setGrayEffect(this.iconBg,!1),this.iconBg.getComponent(r.default).updateBg(e),this.interUpdate()},t.prototype.hide=function(){e.prototype.hide.call(this),s.GameEventDispatcher.instance.off(l.EventDefiner.Fight_BigSkill_Update,this.interUpdate,this)},t.prototype.interUpdate=function(){var e=o.default.instance;this.icon.getComponent(cc.Sprite).fillRange=e.canUseSkill?1:e.canUseSkillNum/e.canUseSkillCd},t.prototype.onClickBigSkill=function(){var e=o.default.instance;e.canUseSkill?p.default.instance.fightstatus==p.FIGHTSTATUS.FIGHT?p.default.instance.specialskillstatus==h.SPECIAL_SKILL_STATUS.NONE&&d.default.instance.sendCurUseSkill():c.default.instance.ShowMsg(n.default.getStr("2017")):c.default.instance.ShowMsg(n.default.getStr("2016",e.overSkillNum))},__decorate([y(cc.Node)],t.prototype,"icon",void 0),__decorate([y(cc.Node)],t.prototype,"iconBg",void 0),t=__decorate([g],t)}(a.default);i.default=m,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/Widget":"Widget","../../Global/GlobalValue":"GlobalValue","../../Util/Utils":"Utils","../Artifact/ArtifactCtrl":"ArtifactCtrl","../Commons/Image":"Image","../Role/RoleController":"RoleController","../Scene/Manager/SceneManager":"SceneManager","../Tips/OpTipsController":"OpTipsController"}],FightBuffItem:[function(e,t,i){"use strict";cc._RF.push(t,"2d6299wdmBFy69OSngbHBaw","FightBuffItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../Scene/Controller/SkillController"),a=e("../WarTeam/MonsterController"),r=cc._decorator,s=r.ccclass,l=r.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.spriteIcon=null,t.labelName=null,t.labelDesc=null,t}return __extends(t,e),t.prototype.initData=function(e){var t=o.default.instance.getSkillBySkillId(e);this.labelName.string=t.name,a.default.instance.setSkillPic(e,this.spriteIcon),this.labelDesc.string=o.default.instance.getSkillDescBySkillIdAndLv(e,1)},__decorate([l(cc.Sprite)],t.prototype,"spriteIcon",void 0),__decorate([l(cc.Label)],t.prototype,"labelName",void 0),__decorate([l(cc.RichText)],t.prototype,"labelDesc",void 0),t=__decorate([s],t)}(n.default);i.default=c,cc._RF.pop()},{"../../Core/Widget":"Widget","../Scene/Controller/SkillController":"SkillController","../WarTeam/MonsterController":"MonsterController"}],FightBuffTips:[function(e,t,i){"use strict";cc._RF.push(t,"112ffCLXjdGTIZLnUgfHJdM","FightBuffTips"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../../GlobalContext"),a=e("../../Core/Language"),r=e("../Role/RoleController"),s=e("../../Core/LoadManager"),l=e("../../Util/Utils"),c=e("../../Core/WindowType"),d=e("./FightBuffItem"),p=cc._decorator,h=p.ccclass,u=p.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.title=null,t.main=null,t.content=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.title.string=a.default.getStr("2015")},t.prototype.show=function(){var t=this;e.prototype.show.call(this),this.node.height=o.GlobalContext.StageHeight,this.main.position=r.default.instance.isClickMyBuff?new cc.Vec2(-280,230):new cc.Vec2(280,230),s.default.instance.loadResByType(o.GlobalContext.Root+"prefab/fightinfopanel/FightBuffItem",cc.Prefab,function(e){var i,n=r.default.instance.getSkillIdData();for(var a in t.main.height=70+103*(n.length<4?n.length:4),n)i=l.default.getNodeByPool(c.PoolType.FightBuffItem,e,o.GlobalContext.Root+"prefab/fightinfopanel/FightBuffItem"),t.content.addChild(i),i.getComponent(d.default).initData(n[a])},this)},t.prototype.hide=function(){e.prototype.hide.call(this);for(var t=this.content.childrenCount-1;t>=0;t--)l.default.setNodeToPool(c.PoolType.FightBuffItem,this.content.children[t])},__decorate([u(cc.Label)],t.prototype,"title",void 0),__decorate([u(cc.Node)],t.prototype,"main",void 0),__decorate([u(cc.Node)],t.prototype,"content",void 0),t=__decorate([h],t)}(n.default);i.default=f,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/Window":"Window","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Role/RoleController":"RoleController","./FightBuffItem":"FightBuffItem"}],FightConst:[function(e,t,i){"use strict";cc._RF.push(t,"3011byy4HFPqYJCk8pgNjwN","FightConst"),Object.defineProperty(i,"__esModule",{value:!0}),function(e){e[e.Attack=0]="Attack",e[e.Rescure=1]="Rescure",e[e.Relive=2]="Relive",e[e.AddBuff=3]="AddBuff",e[e.Duplicate=4]="Duplicate",e[e.DispelDelBuff=5]="DispelDelBuff",e[e.Drag=6]="Drag",e[e.Impact=7]="Impact",e[e.Sing=8]="Sing",e[e.AttackRange=9]="AttackRange",e[e.AddShield=10]="AddShield",e[e.Summon=11]="Summon"}(i.SKILL_WAY_TYPE||(i.SKILL_WAY_TYPE={})),function(e){e.HP="hp",e.SHIELD="shield",e.ADDSHIELD="addshield",e.ADDBUFF="addbuff",e.DELBUFF="delbuff",e.SINGCOM="singCom",e.REMOVEHANDLE="removeHandle"}(i.SKILL_RESULT_IDE||(i.SKILL_RESULT_IDE={})),cc._RF.pop()},{}],FightController:[function(e,t,i){"use strict";cc._RF.push(t,"ea652U7D4hOQYR9aHm4aYC8","FightController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Controller"),o=e("../../Status/StatusType"),a=e("../../../NetConnect/NetConnet"),r=e("../View/FightView"),s=e("../../Tips/OpTipsController"),l=e("../../../Core/Language"),c=e("../../../Core/GameEventDispatcher"),d=e("../../../Core/Event"),p=e("./SkillController"),h=e("../SceneEntity"),u=e("../Pool/SpinePools"),f=e("../Manager/SceneManager"),g=e("../../../Core/SpineBase"),y=e("../../../Global/GlobalValue"),m=e("../../Fight/fightlogic"),C=e("./SceneController"),v=e("../../../Core/TimeController"),_=e("../Effect/FntSwingUtils"),b=e("../../Role/RoleInfo"),T=e("../../Chapter/GuanqiaController"),S=e("../Monster"),I=e("../Prop/EntityProperty"),w=e("../../../Core/WindowType"),D=e("../../SandTable/SandTableController"),R=e("../../Expedition/ExpeditionConfig"),A=e("../Pool/ActorPools"),N=e("../Animal"),L=e("../View/ActorsLayer"),E=e("../../Status/StatusController"),B=e("../../Chapter/ChapterController"),M=e("../../Commons/RewardUtils"),x=e("../../Item/ItemData"),k=e("../../../Global/GlobalValue"),P=e("../../WarTeam/MonsterController"),G=e("./ServerFightController"),F=e("../../../Core/Const/EntityType"),W=e("../../Fight/staticattr"),U=e("../../../Util/Scene/MoveUtil"),O=e("../../Role/RoleController"),V=e("../Effect/BuffTypeEffectUtils"),q=e("../../OpenWin/OpenWinController"),H=e("../View/ActorsMaskLayer"),j=e("./FightTimeController"),K=e("./SpecialSkillEffectController"),Y=e("../Effect/MonsterIndividualityUtils"),z=e("../../Buff/BuffController"),X=e("../../../Core/LoadManager"),J=e("../../../GlobalContext"),Q=e("../../Sound/SoundController"),Z=e("../Unit/FightLog"),$=e("../../PlotWin/PlotController"),ee=e("../Unit/FightConst"),te=e("../../Functionicon/FunctionIconController"),ie=e("../../FridBoss/FridBossController"),ne=e("../BigSkill/SpecialEffectController"),oe=e("./ReinforcementsController"),ae=e("../../TreasureMap/TreasureMapController"),re=e("../../Arena/ArenaController"),se=e("../../HighLadder/HighLadderData"),le=e("../../Activity/ActivityController"),ce=e("../../FightResultWin/FightResultExpedition"),de=e("../../Tips/RewardTips"),pe=e("../../DailyCopy/DailyCopyCtrl"),he=e("../../../Core/ConfigsManager"),ue=e("../../Reel/ReelMode"),fe=e("../../EquipCopy/EquipCopyController"),ge=e("../../FightResultWin/FightResultEquipCopy"),ye=e("../../Totems/TotemsCtrl"),me=e("../../TotemsCopy/TotemsCopyCtrl"),Ce=e("../../EquipCopy/EquipCopyEvent"),ve=e("../../FightResultWin/FightResultWin"),_e=e("../../Guide/GuideNewController"),be=e("../../Item/ItemController"),Te=e("../../../Util/Utils"),Se=e("../../Chapter/BossComming"),Ie=e("../../TotemsCopy/TotemsCopyUtils"),we=e("../../../Util/NumberUtil"),De=e("../../Tips/FightWaveTip"),Re=e("../Manager/MonsterDeadTipManager"),Ae=e("../../ExpCopy/ExpCopyCtrl"),Ne=e("./EntityQiPaoController"),Le=e("../../FightTalk/fightTalk"),Ee=e("../../Mine/MineCtrl"),Be=e("../Vo/DamageInfo"),Me=e("../../setting/SettingData"),xe=e("../../LoardCrusadeWin/DevilResult"),ke=e("../../LoardCrusadeWin/LoardCrusadeCtrl"),Pe=cc._decorator,Ge=Pe.ccclass,Fe=Pe.property,We=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ActorsMaskLayer=null,t.enterfightnode=null,t.enterfightanimation=null,t.bossCommingNode=null,t.waveNode=null,t.waveNodeEffect=null,t.arenaInfo=void 0,t.Is_Use=!1,t.guanqiaID=null,t.isKill=!1,t.bossID=null,t.fightVal=0,t.leftLiveList=null,t.scorllConfig=null,t.bossComming=null,t.UserScrollNumber=0,t.SynthesisSLMNumber=0,t.waitSkillResultList=[],t.myFaShionAttr=[],t.foeFaShionAttr=[],t.canNoFightTalk=!1,t.warDamageDic={},t.roleDamageDic={},t._talkInterval=null,t._talkInterval1=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this,this.scorllConfig=he.ConfigsManager.instance.getConfigs("scrollconf"),c.GameEventDispatcher.instance.on(d.EventDefiner.OPEN_UPDATE_TIME,this.playWaveEffect,this),c.GameEventDispatcher.instance.on(d.EventDefiner.C_Fight_Clear,this.FightClear,this),c.GameEventDispatcher.instance.on(d.EventDefiner.C_Fight_StartTask,this.talkingAbould,this),c.GameEventDispatcher.instance.on(d.EventDefiner.C_Fight_StopTask,this.talkEnd,this)},t.prototype.FightClear=function(e){f.default.instance.clearRole(),C.default.instance.clear(!0),f.default.instance.clearLeftlives()},t.prototype.onfinished=function(){this.enterfightanimation.getComponent(cc.Animation).stop(),this.enterfightanimation.active=!1},t.prototype.playWaveEffect=function(){var e=this;le.default.instance.isSetSandTab||(null==this.waveNodeEffect?X.default.instance.loadResByType(J.GlobalContext.Root+"prefab/fightinfopanel/FightWaveTip",cc.Prefab,function(t){var i=Te.default.getNodeByUrl(t,J.GlobalContext.Root+"prefab/fightinfopanel/FightWaveTip");e.waveNodeEffect=i,e.waveNode.addChild(e.waveNodeEffect),e.setWaveNum()},this):this.setWaveNum())},t.prototype.playenterfighteffect=function(){var e=this;null==this.enterfightanimation?X.default.instance.loadResByType(J.GlobalContext.Root+"prefab/fightinfopanel/EnterFightAnimation",cc.Prefab,function(t){var i=Te.default.getNodeByUrl(t,J.GlobalContext.Root+"prefab/fightinfopanel/EnterFightAnimation");e.enterfightanimation=i,e.enterfightanimation.getComponent(cc.Animation).on("finished",e.onfinished,e),e.enterfightnode.addChild(e.enterfightanimation),e.enterfightanimation.getComponent(cc.Animation).play("enterfightanimation"),e.enterfightanimation.active=!0,Q.default.instance.PlayEffect(Q.SoundType.fightstart)},this):(Q.default.instance.PlayEffect(Q.SoundType.fightstart),this.enterfightanimation.active=!0,this.enterfightanimation.getComponent(cc.Animation).play("enterfightanimation"))},t.prototype.setWaveNum=function(){switch(o.ActivityStatus.value){case o.ActivityStatus.TotemsCopy:this.setWaveNumEnd(me.default.instance.fightWheels,3);break;case o.ActivityStatus.Chapter:this.waveNodeEffect.active=!1;break;default:var e=f.default.instance,t=T.default.instance.getGuanqiaPlayGames(e.quanqiaId).length;this.setWaveNumEnd(e.games,t)}},t.prototype.isEndGames=function(){var e=f.default.instance,t=T.default.instance.getGuanqiaPlayGames(e.quanqiaId).length;return e.games==t},t.prototype.setWaveNumEnd=function(e,t){var i=we.NumberUtil.unitsDigitToText(e),n=this.waveNodeEffect.getComponent(De.default);if(1!=t){this.waveNodeEffect.active=!0;var o=void 0;o=e==t?l.default.getStr("endwave"):l.default.getStr("wave",i),n.showTips(o)}else this.waveNodeEffect.active=!1},t.prototype.listNotification=function(){this.addProto("enterfight",this.enterFight,this),c.GameEventDispatcher.instance.on(d.EventDefiner.C_Scene_Actor_Injured_Effect,this.actorInjuredEffect,this),c.GameEventDispatcher.instance.on(d.EventDefiner.C_Fight_Start,this.fightStart,this),c.GameEventDispatcher.instance.on(d.EventDefiner.C_Fight_Data_Save,this.fightDataSave,this),c.GameEventDispatcher.instance.on(d.EventDefiner.TreasureSlinkFight,this.fightSlink,this),this.addProto("serverfight",this.serverfight,this),this.addProto("rewardpanel",this.rewardpanel,this)},t.prototype.rewardpanel=function(e){var t=[];switch(t=M.default.instance.getItemListByServerData(e.reward),e.paneltype){case o.ActivityStatus.Expedition:f.default.instance.resultShowItemList=t;break;case o.ActivityStatus.Arena:re.default.instance.resultShowItemList=t;break;case o.ActivityStatus.Chapter:f.default.instance.resultShowItemList=t;break;case 9:f.default.instance.resultShowItemList=t,this.isKill=!1;break;case 10:f.default.instance.resultShowItemList=t,this.isKill=!0;break;case 11:case 12:break;case 20:c.GameEventDispatcher.instance.emit("SWEEPING",{reward:e.reward});break;case 98:break;case 23:case 26:case 27:case 28:case 99:q.default.instance.openWindow(w.WindowType.RewardTips,function(){de.default.instance.setData(t)},this);break;case 13:f.default.instance.resultShowItemList=e.reward;break;case 14:f.default.instance.resultShowItemList=t,ae.default.instance.addReward(e.reward);break;case 19:f.default.instance.resultShowItemList=t;break;case o.ActivityStatus.MoneyDailyCopy:case o.ActivityStatus.RefineDailyCopy:case o.ActivityStatus.GemDailyCopy:case o.ActivityStatus.ArtifactDailyCopy:f.default.instance.resultShowItemList=t;break;case 21:case 38:f.default.instance.resultShowItemList=t;break;case 22:case 25:case 28:case 29:case 30:case 31:case 32:case 34:case 35:case 36:q.default.instance.openWindow(w.WindowType.RewardTips,function(){de.default.instance.setData(t)},this);break;case 103:t.push(x.default.creatItem("38",fe.default.instance.getStar)),f.default.instance.resultShowItemList=t;break;case 104:q.default.instance.openWindow(w.WindowType.RewardTips,function(){de.default.instance.setData(t)},this);break;case 105:fe.default.instance.wipeFightResultReward=t;break;case 106:fe.default.instance.wipeBoxReward=t,fe.default.instance.onOpenWipeBoxReward();break;case 107:q.default.instance.openWindow(w.WindowType.RewardTips,function(){var t=M.default.instance.getItemListByServerData(e.reward);de.default.instance.setData(t)});break;case 20:break;case 102:f.default.instance.resultShowItemList=t;break;case 110:q.default.instance.openWindow(w.WindowType.RewardTips,function(){de.default.instance.setData(t)},this);break;case 112:c.GameEventDispatcher.instance.emit("REWARD",{data:e.reward});break;case 113:Ee.default.instance.getMineFriendReq(),q.default.instance.openWindow(w.WindowType.RewardTips,function(){de.default.instance.setData(t)},this);break;case 114:q.default.instance.openWindow(w.WindowType.DevilResult,function(){xe.default.instance.inIt(!1,t)},this),this.isKill=!1;break;default:q.default.instance.openWindow(w.WindowType.RewardTips,function(){de.default.instance.setData(t)},this)}},t.prototype.serverfight=function(e){f.default.instance.mycamp=e.camp,o.ActivityStatus.value==o.ActivityStatus.HighLadder&&c.GameEventDispatcher.instance.emit(d.EventDefiner.ChangeGameScene,{status:k.GameScene.Fight,guanqiaId:y.GQIdType.TianTi2}),o.ActivityStatus.value==o.ActivityStatus.WorldBoss&&c.GameEventDispatcher.instance.emit(d.EventDefiner.ChangeGameScene,{status:k.GameScene.Fight,guanqiaId:y.GQIdType.WorldBoss}),o.ActivityStatus.value==o.ActivityStatus.EliteBoss&&c.GameEventDispatcher.instance.emit(d.EventDefiner.ChangeGameScene,{status:k.GameScene.Fight,guanqiaId:y.GQIdType.EliteBoss}),o.ActivityStatus.value==o.ActivityStatus.LoardCrusade&&c.GameEventDispatcher.instance.emit(d.EventDefiner.ChangeGameScene,{status:k.GameScene.Fight,guanqiaId:y.GQIdType.LoardCrusad})},t.prototype.enterFight=function(e){if(e.permit){Z.default.log("\u8bf7\u6c42\u8fdb\u5165\u6218\u6597\u573a\u666f\u8fd4\u56de\uff1atype "+e.type,"param ",e.param);var t=e.type;t!=o.ActivityStatus.MoneyDailyCopy&&t!=o.ActivityStatus.RefineDailyCopy&&t!=o.ActivityStatus.GemDailyCopy&&t!=o.ActivityStatus.ArtifactDailyCopy&&t!=o.ActivityStatus.EquipCopy||(r.default.instance.getFightDataCom=!0),r.default.instance.enterSceneFight(e.param.guanqia)}else Z.default.log("\u8fdb\u5165\u5931\u8d25type "+e.type,"param ",e.param),s.default.instance.ShowMsg(l.default.getStr("\u8fdb\u5165\u5931\u8d25")),E.default.instance.activityStatusHandle()},t.prototype.exitFight=function(e){var t={cmd:"exitfight",type:o.ActivityStatus.value,ret:e};o.ActivityStatus.value==o.ActivityStatus.MoneyDailyCopy&&(t.ret=pe.default.instance.getPer()),Z.default.log("exitfight",e),(o.ActivityStatus.value!=o.ActivityStatus.TotemsCopy||Ie.TotemsCopyUtils.isEnd())&&this.sendProto(t)},t.prototype.requestEnterFight=function(e){Z.default.log("\u8bf7\u6c42\u8fdb\u5165\u6218\u6597\u573a\u666f\uff1aActivityStatus.value "+o.ActivityStatus.value,"guanqia "+e.guanqia);var t={cmd:"enterfight",type:o.ActivityStatus.value,param:{chapter:e.chapter,section:e.section,guanqia:e.guanqia}};switch(o.ActivityStatus.value){case o.ActivityStatus.MoneyDailyCopy:case o.ActivityStatus.GemDailyCopy:case o.ActivityStatus.ArtifactDailyCopy:case o.ActivityStatus.RefineDailyCopy:t.param.lv=pe.default.instance.nowIndex;break;case o.ActivityStatus.EquipCopy:t.param.star=fe.default.instance.getStar;break;case o.ActivityStatus.ExpCopy:t.param.difficute=Ae.default.instance.selectIndex,t.param.guanqiaIndex=Ae.default.instance.passIndex}this.sendProto(t)},t.prototype.fightDataSave=function(e){this.endSave();var t=e.detail;C.default.instance.clearAll(),f.default.instance.clearRole(),t&&this.exitFight(1)},t.prototype.fightStart=function(e){var t=this;this.warDamageDic={},this.roleDamageDic={},this.canNoFightTalk=!!e&&!!e.getUserData(),f.default.instance.fightlogic&&f.default.instance.fightlogic.resCallback||(this.playenterfighteffect(),this.Is_Use=!1,o.ActivityStatus.value!=o.ActivityStatus.Expedition&&o.ActivityStatus.value!=o.ActivityStatus.Chapter||(this.Is_Use=!0),o.ActivityStatus.value==o.ActivityStatus.TreasureMap&&ae.default.instance.getFightTips&&(this.enterfightanimation&&(this.enterfightanimation.active=!1),ae.default.instance.onShowEnterTips()),o.ActivityStatus.value==o.ActivityStatus.EquipCopy&&fe.default.instance.setEnterFightTime(),te.default.instance.checkIsOpenbyWindowtype(w.WindowType.ReelWin)&&c.GameEventDispatcher.instance.emit(d.EventDefiner.ActivityStatus_Is_Show,this.Is_Use),f.default.instance.treasureMapleftlives=[],o.ActivityStatus.value!=o.ActivityStatus.MoneyDailyCopy&&(f.default.instance.attackenemyhp=0),o.ActivityStatus.value==o.ActivityStatus.TreasureMap&&Z.default.log(JSON.parse(JSON.stringify(f.default.instance.leftlives)),"baocun"),f.default.instance.fightlogic.SetCallBack(function(e){if(console.log("----------",t.warDamageDic),console.log("----------",t.roleDamageDic),t.talkEnd(),f.default.instance.fightstatus!=f.FIGHTSTATUS.FIGHTEND&&($.default.instance.iscomplete||$.default.instance.completePlot(),!(o.ActivityStatus.value==o.ActivityStatus.WorldBoss&&le.default.instance.worldBossHp.hp>0&&e))){if(o.ActivityStatus.value==o.ActivityStatus.EliteBoss&&le.default.instance.eliteRank.data[le.default.instance.currElitIndex].hp>0&&e&&(console.log("\u7cbe\u82f1boss\u81ea\u52a8\u7ed3\u675f\u6218\u6597,\u8840\u91cf\u5927\u4e8e0",le.default.instance.eliteRank.data[le.default.instance.currElitIndex].hp),G.default.instance.timingDamage()),console.log("\u6218\u6597\u7ed3\u679c:"+e),e){var i=[];f.default.instance.leftlives.forEach(function(e){e.copyEntity||i.push(e)}),f.default.instance.leftlives=i}for(var n in f.default.instance.fightstatus=f.FIGHTSTATUS.FIGHTEND,f.default.instance.fightresult=e,f.default.instance.fightresultType=o.ActivityStatus.value,E.default.instance.isSingle?t.setFightEnd():(o.ActivityStatus.value==o.ActivityStatus.LoardCrusade&&ke.default.instance.sendDevilDamage(f.default.instance.attackenemyhp),t.sendclientresult(e?0:1),o.ActivityStatus.value==o.ActivityStatus.Arena&&(t.setFightEnd(),re.default.instance.saveArenaMonsters())),L.default.instance.entities){L.default.instance.entities[n].getComponent(h.default).playAnimation(y.ACTION.STAND)}}}),f.default.instance.fightlogic.SetFightSkillCallBack(function(e){t.actorAttackResult(e)}),f.default.instance.fightstatus=f.FIGHTSTATUS.UPGRADE,f.default.instance.fightlogic.StartFight(),r.default.instance.SetFightViewPlayRate(Math.max(f.default.instance.fightViewPlayRate,1)),o.ActivityStatus.value==o.ActivityStatus.Chapter&&_e.default.instance.checkCondition(7),X.default.instance.loadResByType(J.GlobalContext.Root+"prefab/FightResult/FightResultBGEffect",cc.Prefab,null,null),X.default.instance.loadResByType(J.GlobalContext.Root+"ui/fightResult/FightResultWin",cc.SpriteAtlas,null,null),this.canNoFightTalk||this.talkingAbould())},t.prototype.sendclientresult=function(e){var t={cmd:"clientresult",result:e};this.sendProto(t)},t.prototype.setFightEnd=function(){var e=this;E.default.instance.isSingle?f.default.instance.oldfightViewPlayRate=f.default.instance.fightViewPlayRate:f.default.instance.oldfightViewPlayRate=1;var t=1e3;0!=f.default.instance.specialskillstatus&&(t=2e3);var i=v.default.instance.setTimeout(function(){e.fightEnd(),v.default.instance.clearTimeout(i)},this,t)},t.prototype.fightSlink=function(){ae.default.instance.sendCmdSlink(),f.default.instance.fightlogic.OnFightResult(!0)},t.prototype.fightingAddActor=function(e,t,n,a,s,l,h){var u=this;void 0===t&&(t=0),void 0===s&&(s=!0),void 0===l&&(l=y.ACTION.STAND),void 0===h&&(h=!1);var g,m=new I.EntityProperty;m.addtype=t,m.init(F.EntityType.enMonster,e),e.handle?m.handle=e.handle:o.ActivityStatus.Arena==o.ActivityStatus.value?m.handle=Math.floor(G.default.instance.Random())+r.default.instance.loopIntervalCount:m.handle=C.default.instance.allocHandle(),e.x&&(m.x=e.x),e.y&&(m.y=e.y),m.selfMonster=e.self,e.self?(m.dir=-1,f.default.instance.leftFight+=m.fight):(m.dir=1,f.default.instance.rightFight+=m.fight),e.skills||(e.skills=p.default.instance.getSkills(m,null,h)),m.skillList=e.skills,m.autobigskill=!!e.autoUseSkill&&e.autoUseSkill,m.originalName=m.originalName,(g=A.ActorPools.returnMonster(m).getComponent(S.default)).avatar.body.playRate=f.default.instance.fightViewPlayRate,C.default.instance.addEntitys(g),f.default.instance.specialskillstatus!=y.SPECIAL_SKILL_STATUS.NONE?(K.default.instance.specialskillhitentitys.push(g),i.instance.ActorsMaskLayer.addActorObj_toScene(g)):L.default.instance.addActorObj_toScene(g),C.default.instance.addBigSkillIcon(g,e.autoUseSkill),c.GameEventDispatcher.instance.emit(d.EventDefiner.Fight_Power_Change);var _={handle:m.handle,camp:m.selfMonster?0:1,prop:m,hp:n,attr:e.attr},b=f.default.instance.fightlogic.PushEntity(_);if(i.instance.updateFight(b),s)if(y.ADD_ACTOR_TYPE.RESCURE==t)V.default.instance.addOneEffect(g,y.BuffEffectName.FUHUO);else if(y.ADD_ACTOR_TYPE.REEL==t?V.default.instance.addOneEffect(g,y.BuffEffectName.ZHAOHUAN1):(V.default.instance.addOneEffect(g,y.BuffEffectName.ZHAOHUAN2),V.default.instance.addOneEffect(g,y.BuffEffectName.ZHAOHUAN3)),o.ActivityStatus.Arena!=o.ActivityStatus.value){g.avatar.node.opacity=0,g.avatar.node.runAction(cc.sequence(cc.delayTime(.4),cc.fadeIn(.2)));var T=v.default.instance.setTimeout(function(){g.avatar.node.opacity=255,v.default.instance.clearTimeout(T)},this,500)}if(g.moveTowardTarget(J.GlobalContext.UIWidth/2*m.dir*-1,m.y),a&&j.default.instance.setTimeout("fightingAddActor"+g.prop.handle,function(){Z.default.log("\u79fb\u9664fightingAddActor"+g.prop.handle),g.isLive&&(u.removeEntity(g),g.hpOverDead(),f.default.instance.fightstatus!=f.FIGHTSTATUS.FIGHTEND&&i.instance.updateFight(f.default.instance.fightlogic.RemoveEntity(g.prop.handle)))},this,a),t==y.ADD_ACTOR_TYPE.REINFORCEMENTS){g.prop.move=!1;var w=g.prop.selfMonster?-200:200;g.node.opacity=0,g.x+=w,g.playAnimation(y.ACTION.WALK),g.node.runAction(cc.sequence(cc.spawn(cc.moveBy(1,new cc.Vec2(-w,0)),cc.fadeIn(.5)),cc.callFunc(function(){g.prop.x=g.x,f.default.instance.fightstatus!=f.FIGHTSTATUS.FIGHT&&g.playAnimation(y.ACTION.STAND),g.prop.move=!0},this)))}console.log("\u6218\u6597\u4e2d\u6dfb\u52a0\u5b9e\u4f53",g.handle)},t.prototype.sortHandle=function(e,t){return e.handle-t.handle},t.prototype.sortPropHandle=function(e,t){return e.handle-t.handle},t.prototype.addPrewarSkill=function(e,t,i){var n={skillid:t,skilllv:i};e.prop.skillList.push(n),f.default.instance.leftPlayPrewarSkillEntity.push(e)},t.prototype.checkPrewarSkill=function(){var e=f.default.instance.leftPlayPrewarSkillEntity.concat().concat(f.default.instance.rightPlayPrewarSkillEntity.concat());e.sort(this.sortHandle),e.forEach(function(e){e.playPrewarSkill()}),f.default.instance.fightstatus=f.FIGHTSTATUS.PLAYSKILL},t.prototype.checkPrewarSkillComplete=function(){var e,t=!0;if(f.default.instance.leftPlayPrewarSkillEntity.forEach(function(e){e.isLive?e.playPrewarSkillNums&&e.playPrewarSkillNums.length>0&&(t=!1):e.playPrewarSkillNums=[]}),f.default.instance.rightPlayPrewarSkillEntity.forEach(function(e){e.isLive?e.playPrewarSkillNums&&e.playPrewarSkillNums.length>0&&(t=!1):e.playPrewarSkillNums=[]}),t){f.default.instance.fightstatus=f.FIGHTSTATUS.PLAYSKILLCOM,f.default.instance.myRole&&f.default.instance.myRole.getComponent(N.default).moveTowardTarget(812,f.default.instance.myRole.y),Z.default.log("\u6218\u524d\u6280\u80fd\u4f7f\u7528\u7ed3\u675f");for(var i=0;i<f.default.instance.leftentitys.length;i++)(e=f.default.instance.leftentitys[i]).moveTowardTarget(812,e.prop.y);for(i=0;i<f.default.instance.rightentitys.length;i++)(e=f.default.instance.rightentitys[i]).moveTowardTarget(-812,e.prop.y);f.default.instance.fightstatus=f.FIGHTSTATUS.FIGHT,oe.default.instance.checkReinforcements()}},t.prototype.fightEnd=function(e){var t=this;if(void 0===e&&(e=!1),Z.default.log("fightEnd",e),o.ActivityStatus.value==o.ActivityStatus.EquipCopy){var i=fe.default.instance.getLevelCondition;switch(i.conditionType){case Ce.EquipCopyType.Kill_All:break;case Ce.EquipCopyType.Remain_Monster:f.default.instance.fightresult=f.default.instance.leftlives.length>=i.conditionParam;break;case Ce.EquipCopyType.Remain_Time:f.default.instance.fightresult=f.default.instance.fightresult&&fe.default.instance.onCheckFightResult(i.conditionParam)}}var n=f.default.instance.fightresult;if(c.GameEventDispatcher.instance.emit(d.EventDefiner.C_Fight_End),o.ActivityStatus.value!=o.ActivityStatus.TotemsCopy)if(n){var a=f.default.instance;if(T.default.instance.getConfig(a.quanqiaId))if(a.games+=1,a.games>T.default.instance.getGuanqiaPlayGames(a.quanqiaId).length)this.gameEnd(n,e);else{if(o.ActivityStatus.value==o.ActivityStatus.MoneyDailyCopy&&!f.default.instance.rightFight)return void this.gameEnd(n,e);var r=v.default.instance.setTimeout(function(){C.default.instance.clear(),t.enterNextGame(),v.default.instance.clearTimeout(r)},this,1e3)}}else this.gameEnd(n,e);else this.gameEnd(n,e,!n||!D.default.instance.autoPlay)},t.prototype.gameEnd=function(e,t,i){var n=this;void 0===t&&(t=!1),void 0===i&&(i=!0),D.default.instance.autoPlay=!i,this.foeFaShionAttr=null,this.foeSkillFaShion=null,Z.default.log("gameEnd",e,t);var r=e?1:2;if(G.default.instance.timeOut&&(v.default.instance.clearInterval(G.default.instance.timeOut),G.default.instance.timeOut=null),le.default.instance.isChange=!1,this.SynthesisSLMNumber=0,o.ActivityStatus.value!=o.ActivityStatus.Arena)if(e)this.endSave(),this.exitFight(r);else if(f.default.instance.resultShowMonster=[],this.exitFight(r),o.ActivityStatus.value==o.ActivityStatus.Chapter&&1==f.default.instance.rightlives.length){var s={cmd:"fightachieve",param:2,number:f.default.instance.rightlives.length};a.default.instance.sendProto(s)}switch(f.default.instance.games=1,o.ActivityStatus.value==o.ActivityStatus.EquipCopy?this.leftLiveList=f.default.instance.leftlives.concat():this.leftLiveList=f.default.instance.resultShowMonster.concat(),this.fightVal=f.default.instance.leftFight,o.ActivityStatus.value){case o.ActivityStatus.TotemsCopy:e&&!Ie.TotemsCopyUtils.isEnd()||f.default.instance.clearLeftlives();break;case o.ActivityStatus.FightSimulator:return;default:f.default.instance.clearLeftlives()}var l=v.default.instance.setTimeout(function(){n.openResultWin(t),C.default.instance.clear(),f.default.instance.clearRole(),n.battleScroll(),v.default.instance.clearTimeout(l)},this,1e3)},t.prototype.BossResult=function(){var e=v.default.instance.setTimeout(function(){q.default.instance.openWindow(w.WindowType.WorldBossResult,function(){le.default.instance.sendrankdata(),O.default.instance.RoleUpgrading()}),v.default.instance.clearTimeout(e)},this,1e3)},t.prototype.openResultWin=function(e){var t=this;void 0===e&&(e=!1),Z.default.log("openResultWin",e);P.default.instance.GetWarTeamConfig();switch(f.default.instance.fightresultType){case o.ActivityStatus.Arena:return void(e&&q.default.instance.openWindow(w.WindowType.ArenaResultWin));case o.ActivityStatus.WorldBoss:f.default.instance.fightresult||this.BossResult();break;case o.ActivityStatus.EliteBoss:f.default.instance.fightresult?this.isKill=!0:this.isKill=!1,this.BossResult(),console.log("SceneManager.instance.fightresult\u8f93\u8d62",f.default.instance.fightresult);break;case o.ActivityStatus.LoardCrusade:break;case o.ActivityStatus.Chapter:var i=function(){q.default.instance.openWindow(w.WindowType.FightResultWin,function(){ve.default.instance.onInitData(t.fightVal,t.leftLiveList)},t)};f.default.instance.fightresult?$.default.instance.checkPlot($.PlotType.FightEnd,function(){i()}):i();break;case o.ActivityStatus.HighLadder:q.default.instance.openWindow(w.WindowType.FightResultWin,function(){O.default.instance.RoleUpgrading(),ve.default.instance.onInitData(se.SelfHighLadderData.ranking,t.leftLiveList)});break;case o.ActivityStatus.TreasureMap:q.default.instance.openWindow(w.WindowType.FightResultWin,function(){O.default.instance.RoleUpgrading(),ae.default.instance.sendLoadData()});break;case o.ActivityStatus.Expedition:q.default.instance.openWindow(w.WindowType.FightResultExpedition,function(){O.default.instance.RoleUpgrading(),ce.default.instance.onInitData(t.fightVal,t.leftLiveList)});break;case o.ActivityStatus.FridBoss:q.default.instance.openWindow(w.WindowType.FightResultWin,function(){O.default.instance.RoleUpgrading(),t.scheduleOnce(function(){ie.default.instance.sendFridBossfight(ie.default.instance.OtherUserId)},0),ve.default.instance.onInitData(t.fightVal,t.leftLiveList)});break;case o.ActivityStatus.MoneyDailyCopy:case o.ActivityStatus.RefineDailyCopy:case o.ActivityStatus.GemDailyCopy:case o.ActivityStatus.ArtifactDailyCopy:q.default.instance.openWindow(w.WindowType.FightResultDailyCopy,function(){O.default.instance.RoleUpgrading()},this);break;case o.ActivityStatus.EquipCopy:q.default.instance.openWindow(w.WindowType.FightResultEquipCopy,function(){O.default.instance.RoleUpgrading(),ge.default.instance.onInitData(t.fightVal,t.leftLiveList)});break;case o.ActivityStatus.TotemsCopy:f.default.instance.fightresult&&Ie.TotemsCopyUtils.isEnd()&&me.default.instance.resetSelectionState(),!f.default.instance.fightresult||Ie.TotemsCopyUtils.isEnd()?q.default.instance.openWindow(w.WindowType.FightResultExpedition,function(){ce.default.instance.onInitData(f.default.instance.leftFight,f.default.instance.resultShowMonster)}):(Ie.TotemsCopyUtils.addWheel(),this.enterNextGame());break;case o.ActivityStatus.ExpCopy:q.default.instance.openWindow(w.WindowType.FightResultExpedition,function(){ce.default.instance.onInitData(0,[],O.default.instance.RoleUpgrading())});break;default:q.default.instance.openWindow(w.WindowType.FightResultDailyCopy)}},t.prototype.endSave=function(){var e=!1,t=o.ActivityStatus.value+"";switch(o.ActivityStatus.value){case o.ActivityStatus.Chapter:e=!0;break;case o.ActivityStatus.Expedition:t=o.ActivityStatus.value+"_"+R.ExpeditionConfig.current,e=!0;break;case o.ActivityStatus.TreasureMap:e=!0}if(e){var i=this.saveEntitys(),n=f.default.instance.myRole?f.default.instance.myRole.getComponent(h.default):null,a={cmd:"savefightdata",key:t,data:{reserve:i[0],specialMonsters:i[1],table:D.default.instance.getOldArr(),fightNum:f.default.instance.leftFight-=b.MyRoleInfo.Fight,hp:n?n.prop.hp:0}};Z.default.log("\u4fdd\u5b58\u6570\u636e",a),this.sendProto(a)}},t.prototype.getSpecialMonsters=function(e){for(var t=[],i=0,n=t;i<n.length;i++){var o=n[i];o.specialMonster&&t.push({id:o.cardid,grade:o.grade,level:o.cultivateLv,skilllist:o.skillList,skillCdDic:o.skillCdDic,attr:o.attr})}return Z.default.log("\u4fdd\u5b58\u7279\u6b8a\u602a\u7269\u4fe1\u606f:",t),t},t.prototype.enterNextGame=function(){var e=this;f.default.instance.fightstatus=f.FIGHTSTATUS.NONE,Z.default.log("\u8fdb\u5165\u4e0b\u4e00\u6ce2");var t=v.default.instance.setTimeout(function(){C.default.instance.addMyRole(),c.GameEventDispatcher.instance.emit(d.EventDefiner.CloseReelList,e);var i=f.default.instance;i.fightstatus=-1;var n,a=B.default.instance.getGuanqiaConfigList(B.default.instance.currentChapterId+1,B.default.instance.currentAreaId);if(o.ActivityStatus.value==o.ActivityStatus.Chapter&&a[B.default.instance.currentGuanqiaId].guanqiaId==a[a.length-1].guanqiaId&&(Te.default.setNodeChildDestoryByUrl(e.bossCommingNode,J.GlobalContext.Root+"prefab/Chapter/BossComming"),2==T.default.instance.getGuanqiaPlayGames(f.default.instance.quanqiaId).length&&f.default.instance.games==T.default.instance.getGuanqiaPlayGames(f.default.instance.quanqiaId).length&&(D.default.instance.automatic=!1,D.default.instance.autoPlay=!1,X.default.instance.loadResByType(J.GlobalContext.Root+"prefab/Chapter/BossComming",cc.Prefab,function(t){var i=Te.default.getNodeByUrl(t,J.GlobalContext.Root+"prefab/Chapter/BossComming");e.bossCommingNode.addChild(i),i.getComponent(Se.default).Info(B.default.instance.GuanQiaBoss)},e))),o.ActivityStatus.value==o.ActivityStatus.TreasureMap);else{var s,l=e.getSaveEntitys();s=JSON.parse(JSON.stringify(l)),f.default.instance.clearLeftlives();for(var p=0;p<s.length;p++){var h=s[p];Z.default.log("\u4fdd\u5b58\u7684\u602a + "+h.handle);var u={cardid:h.cardid,grade:h.grade,level:h.cultivateLv,num:1,self:!0,skillcdDic:h.skillCdDic,playeffect:!1,autoUseSkill:!1,ismoveenter:!0};c.GameEventDispatcher.instance.emit(d.EventDefiner.C_Scene_Add_Actor,u)}}switch(o.ActivityStatus.value){case o.ActivityStatus.TotemsCopy:me.default.instance.addMonsterByGQidAndGames(),n=me.default.instance.getStepNum();break;default:e.addMonsterByGQidAndGames(i.quanqiaId,i.games),n=T.default.instance.getGuanqiaStepNum(i.quanqiaId,i.games)}o.ActivityStatus.value==o.ActivityStatus.MoneyDailyCopy&&D.default.instance.setOldArr([]),n>0?(q.default.instance.openWindow(w.WindowType.SandTable),D.default.instance.setTotaleMove(n)):c.GameEventDispatcher.instance.emit(d.EventDefiner.C_Fight_Start),v.default.instance.clearTimeout(t),r.default.instance.SetFightViewPlayRate(f.default.instance.oldfightViewPlayRate),C.default.instance.playMonsterEnter()},this,1e3)},t.prototype.addMonsterByGQidAndGames=function(e,t){var i=T.default.instance.getGuanqiaMonsters(e,t);if(i&&i.length>0)for(var n=0;n<i.length;n++)for(var a=i[n].num,r=0;r<a;r++){var s=0;s=o.ActivityStatus.value==o.ActivityStatus.TreasureMap?P.default.instance.getHigherCardLV():i[n].level;var l=this.getGQMonsterAttr(e,s,i[n],t);l=this.specialMonster(l);var p={cardid:i[n].cardId,grade:i[n].grade,level:s,num:1,self:!1,attr:l,autoUseSkill:!!i[n].autousebigskill,skills:l.skills,playeffect:!1,ismoveenter:!0},h=pe.default.instance.prop;h&&o.ActivityStatus.value==o.ActivityStatus.MoneyDailyCopy&&(p.prop=h),c.GameEventDispatcher.instance.emit(d.EventDefiner.C_Scene_Add_Actor,p)}},t.prototype.addMonsterByGQid=function(e,t){var i=T.default.instance.getGuanqiaMonsters(e,t);if(i&&i.length>0)for(var n=0;n<i.length;n++)for(var o=i[n].num,a=0;a<o;a++){var r=i[n].level,s=this.getGQMonsterAttr(e,r,i[n],t);s=this.specialMonster(s);var l={cardid:i[n].cardId,grade:i[n].grade,level:r,num:1,self:!1,attr:s,autoUseSkill:!!i[n].autousebigskill,skills:s.skills,playeffect:!1,ismoveenter:!1};pe.default.instance.prop;c.GameEventDispatcher.instance.emit(d.EventDefiner.C_Scene_Add_Actor,l)}},t.prototype.specialMonster=function(e){switch(o.ActivityStatus.value){case o.ActivityStatus.FridBoss:for(var t in e.attr_)e.ChangeAtt(parseInt(t),e.attr_[t]*ie.default.instance.cardLevel)}return e},t.prototype.getGQMonsterAttr=function(e,t,i,n){void 0===n&&(n=1);for(var o=new W.StaticAttr,a=P.default.instance.getCardConfCardType(i.cardId),r=T.default.instance.getGuanqiaPlaygames(e,n),s=5,l=0,c=T.default.instance.getGuanqiaMonsters(e,n);l<c.length;l++){var d=c[l];d.grade<s&&(s=d.grade)}var h=Math.pow(1.25,i.grade-s);void 0===t&&(t=0);var u=new I.EntityProperty;u.cardid=i.cardId,u.grade=i.grade,u.type=F.EntityType.enMonster,u.selfMonster=!1;var f=p.default.instance.getSkills(u,i.skilllevel);return i.attribute?(h=1,o.PushCard(i.cardId,t,i.grade,1,f,i.attribute)):o.PushCard(i.cardId,t,i.grade,1,f,r["prop"+a]),o.ChangeAtt(y.AttrType.MaxHp,o.GetMaxHp()*h),o.ChangeAtt(y.AttrType.Attack,o.GetAttack()*h),o.ChangeAtt(y.AttrType.Defence,o.GetDefence()*h),o},t.prototype.addActorTreasureMap=function(){var e=f.default.instance.treasureMapleftlives;f.default.instance.clearLeftlives();for(var t=0;t<e.length;t++){var i=e[t];if(i.type==F.EntityType.enMonster){var n={cardid:i.cardid,grade:i.grade,level:i.cultivateLv,num:1,self:!0,prop:i,autoUseSkill:!1};Z.default.log("\u6dfb\u52a0\u85cf\u5b9d\u56fe\u602a\u7269\uff1a "+i.handle,e.length,n),c.GameEventDispatcher.instance.emit(d.EventDefiner.C_Scene_Add_Actor,n)}}},t.prototype.actorInjuredEffect=function(e){var t=e.getUserData(),i=t.skillid,n=t.skilllv,o=p.default.instance.getSkillBySkillId(i),a=p.default.instance.getSkillResultBySkillIdAndLv(i,n)[0],r=t.target,s=t.source;if(r&&s&&r.isLive&&s.isLive&&o.attackway!=y.ATTACK_TYPE.ATTACK_TYPE_5)if(o.isHitEffect&&6!=a.type){var l=0,c=0,d=void 0;if(o.rangeattackEffect)if(c=-300,l=r.prop.x,f.default.instance.specialskillstatus!=y.SPECIAL_SKILL_STATUS.NONE){if(K.default.instance.attacktarge[0].prop.handle!=r.prop.handle)return;d=u.SpinePools.addSpineNoder(H.default.instance.node,new cc.Vec2(l,c))}else d=u.SpinePools.addSpineNoder(L.default.instance.node,new cc.Vec2(l,c));else f.default.instance.specialskillstatus!=y.SPECIAL_SKILL_STATUS.NONE&&o.isAddToScene>0?(c=-300,l=r.prop.x,d=u.SpinePools.addSpineNoder(H.default.instance.node,new cc.Vec2(l,c))):(c=r.height/2,o.hitPoint&&(1==o.hitPoint?c=0:2==o.hitPoint&&(c=r.height)),d=u.SpinePools.addSpineNoder(r.node,new cc.Vec2(l,c)));d.scale=r.prop.monsterConf.scenescale,d.scaleX=(r.x>s.x?-1:1)*r.prop.monsterConf.scenescale,f.default.instance.injuredEffects.push(d);var h=d.getComponent(g.default),m="";o.attackway==y.ATTACK_TYPE.ATTACK_TYPE_4&&(m="2");var C=s.prop.type==F.EntityType.enActor?"skin1_fight"+o.isHitEffect+"_b"+m:"skin"+s.prop.grade+"_fight"+o.isHitEffect+"_b"+m;h.initSpineData(s.prop.getAttackEffectUrl(),null,C,!1),h.playRate=f.default.instance.fightViewPlayRate,h.completeCallbackThisObj=this,h.completeCallbackParam=[d,i,n],h.completeCallback=function(e,t,i){f.default.instance.injuredEffects.splice(f.default.instance.injuredEffects.indexOf(e),1),u.SpinePools.recoverSpineNoder(e),K.default.instance.checkComplete(s)}}else K.default.instance.checkComplete(s)},t.prototype.actorUseSkill=function(e,t,i,n,a){var r=this;if(f.default.instance.fightlogic){var s=L.default.instance.getSceneEntity(e),l=p.default.instance.getSkillBySkillId(i);if(!s||s.isLive||l.attackway==y.ATTACK_TYPE.ATTACK_TYPE_4)if(l.effectstime&&o.ActivityStatus.value!=o.ActivityStatus.Arena)j.default.instance.setTimeout("effectstime"+e+i,function(){j.default.instance.clearTimeout("effectstime"+e+i),r.effectsResult(e,t,i,n,a)},this,l.effectstime);else this.effectsResult(e,t,i,n,a)}},t.prototype.effectsResult=function(e,t,i,n,o){var a=p.default.instance.getSkillBySkillId(i);if(a.hitMusic&&Q.default.instance.PlayEffect("audio/BattleSound/"+a.hitMusic),a.attackway==y.ATTACK_TYPE.ATTACK_TYPE_5){var r=p.default.instance.getSkillResultBySkillIdAndLv(i,n)[0],s=p.default.instance.GetResultConfParam(r.param,n),l=void 0;l=L.default.instance.getSceneEntity(t[0]).prop.selfMonster?f.default.instance.leftlives:f.default.instance.rightlives;for(var c=[],d=0;d<l.length;d++)U.MoveUtil.getPixelDis(o.x,o.y,l[d].x,l[d].y)<=s[2]&&c.push(l[d].handle);if(c.length>0){var h=f.default.instance.fightlogic.Spell(e,c,i,n);Z.default.log("\u653b\u51fb\u7ed3\u679c-----1\uff1a",h,t),this.actorAttackResult(h)}}else{if(f.default.instance.specialskillstatus!=y.SPECIAL_SKILL_STATUS.NONE&&t.length>0&&(f.default.instance.specialskillcount-=t.length,console.log("\u5927\u62db\u68c0\u6d4b\u53d7\u51fb",t.length,f.default.instance.specialskillcount)),!K.default.instance.bigskillcanhit&&a.triggerway!=y.TRIGGER_WAY.INITIATIVE)return this.waitSkillResultList.push([e,t,i,n]),void console.warn("bigskillcanhit",e,t,i);h=f.default.instance.fightlogic.Spell(e,t,i,n);Z.default.log("\u653b\u51fb\u7ed3\u679c-----1\uff1a",h,t),this.actorAttackResult(h)}},t.prototype.checkPixelDis=function(e,t,i,n){return void 0===n&&(n=1),U.MoveUtil.getPixelDis(e.prop.x,e.prop.y,t.prop.x,t.prop.y)<=i*n},t.prototype.actorAttackResult=function(e){e.errno==m.ResultError.NoError?this.playAttckEffect(e):Z.default.log("\u653b\u51fb\u7ed3\u679c\u9519\u8bef\u7801\uff1a"+e.errno)},t.prototype.playAttckEffect=function(e){for(var t=this,i=p.default.instance.getSkillBySkillId(e.skillId),n=L.default.instance.getSceneEntity(e.srcHandle),o=function(o){var r=e.result[o],s=L.default.instance.getSceneEntity(r.handle),l=function(){c.GameEventDispatcher.instance.emit(d.EventDefiner.C_Scene_Actor_Injured_Effect,{skillid:e.skillId,skilllv:e.skilllv,source:n,target:s})};if(s){if(s.hitStatus==y.HIT_STATUS.DRAP)var h=v.default.instance.setTimeout(function(){l(),t.attackResultState(n,r),t.attackResultEffect(n,r,i,e),v.default.instance.clearTimeout(h)},a,300/f.default.instance.fightViewPlayRate);else if(i.playinjurytime&&i.playinjurytime>0){a.attackResultState(n,r);j.default.instance.setTimeout("playinjurytime"+e.srcHandle+e.skillId,function(){l(),t.attackResultEffect(n,r,i,e),j.default.instance.clearTimeout("playinjurytime"+e.srcHandle+e.skillId)},a,i.playinjurytime)}else{a.attackResultState(n,r);var u=p.default.instance.getSkillResultBySkillIdAndLv(e.skillId,e.skilllv)[0];12==u.type||15==u.type||8==u.type?e.srcHandle!=r.handle&&l():l(),a.attackResultEffect(n,r,i,e)}a.updateFight(e.fight)}},a=this,r=0;r<e.result.length;r++)o(r)},t.prototype.attackResultEffect=function(e,t,i,n){if(t){var a=L.default.instance.getSceneEntity(t.handle);if(!a)return;if(0!=(t.state&m.StateBit.Rescure)){if(!a.isLive)return;a.updateBloodBarHp();var r=Math.abs(t.data.hpChange);this.statisticsFightInfo(e,r,Be.DamageInfoType.Rescure),r>0&&_.default.instance.showAddHurtValue(a.x,a.y+a.height,1,r,a.node,!1),V.default.instance.addOneEffect(a,y.BuffEffectName.ZHILIAO)}if(0!=(t.state&m.StateBit.Relive)){V.default.instance.addOneEffect(a,y.BuffEffectName.FUHUO),a.rescure();r=Math.abs(t.data.hpChange);this.statisticsFightInfo(e,r,Be.DamageInfoType.Rescure),_.default.instance.showAddHurtValue(a.x,a.y+a.height,1,r,a.node,!1)}if(0!=(t.state&m.StateBit.Shield)){if(!a.isLive)return;a.updateBloodBarHp()}if(0!=(t.state&m.StateBit.Damage)){a.prop.hp=t.hp,a.prop.shield=t.shield,a.prop.maxHP=t.maxhp;var s=0!=(t.state&m.StateBit.Critical);a.updateBloodBarHp(),Y.default.instance.checkIndividualityType(y.INDIVIDUALITY.TYPE1,a);r=Math.abs(t.data.hpChange);if(t.type==ee.SKILL_RESULT_IDE.SHIELD&&(this.statisticsFightInfo(e,t.data.shieldChange,Be.DamageInfoType.Attack),_.default.instance.showLRealurtValue(a.x,a.y+a.height,4,t.data.shieldChange,a.node,s,0,a.prop.selfMonster)),t.type==ee.SKILL_RESULT_IDE.HP){if(this.statisticsFightInfo(e,r,Be.DamageInfoType.Attack),this.statisticsFightInfo(a,r,Be.DamageInfoType.Injuried),o.ActivityStatus.value==o.ActivityStatus.Guide&&(r*=Math.ceil(100*Math.random())),n){var l=p.default.instance.getSkillBySkillId(n.skillId);if(l&&l.iscombo){for(var h=0;h<n.result.length;h++){if(L.default.instance.getSceneEntity(n.result[h].handle).prop.otherAttr==y.OtherAttr.ExtraCombohurt){r*=2;break}}return void _.default.instance.showLZHurtValue(a.x,a.y+a.height,3,r,a.node,s,0,a.prop.selfMonster)}}1==a.prop.selfMonster?_.default.instance.showSelfHurtValue(a.x,a.y+a.height,2,r,a.node,s):(o.ActivityStatus.value,_.default.instance.showHurtValue(a.x,a.y+a.height,2,r,a.node,s))}}if(t.type==ee.SKILL_RESULT_IDE.ADDBUFF&&0!=t.data.buffId&&z.default.instance.addBuff(a,t.data.buffId),t.type==ee.SKILL_RESULT_IDE.DELBUFF&&0!=t.data.buffId&&z.default.instance.removeBuff(a,t.data.buffId),t.type==ee.SKILL_RESULT_IDE.SINGCOM&&(a.setSingBar(!1),ne.default.instance.clearByHandle(a.prop.handle),K.default.instance.checkComplete(a),Z.default.log("\u541f\u5531\u6280\u80fd\u6d88\u5931")),e&&e.isLive){a.attackEntity=e;var u=this.isCanFlyBack(a.prop.selfMonster);0!=(t.state&m.StateBit.Back)&&u&&a.back(e.prop.x),0!=(t.state&m.StateBit.Sing)&&(a.setSingBar(!0,t.data.skill.totaltime,t.data.skill.time),27==a.prop.cardid&&ne.default.instance.addSpecialEffect(a,!0),t.data.skill.use&&a.useInitiativeSkill(t.data.skill.skillid,t.data.skill.skilllv)),a.prop.isLive&&!a.prop.isBoss&&a.hitStatus==y.HIT_STATUS.NONE&&(0!=(t.state&m.StateBit.Drap)&&(a.movex(e.prop.x,1),Z.default.log("\u62c9\u626f\u5230:",e.prop.x)),0!=(t.state&m.StateBit.Impact)&&(Z.default.log("\u51b2\u649e\u5230:",a.prop.x),e.movex(a.prop.x,2)),0!=(t.state&m.StateBit.Fly)&&u&&a.strikeFly(),0!=(t.state&m.StateBit.FlyBack)&&u&&a.strikeFlyBack(e.prop.x)),0!=(t.state&m.StateBit.Dodge)&&V.default.instance.addBuffTip(null,a,"i18n_dodge")}0!=(t.state&m.StateBit.Die)&&(a.prop.hp=0,this.removeEntity(a),ne.default.instance.clearByHandle(a.prop.handle),L.default.instance.changeByLayer(a,1),a.prop.type==F.EntityType.enActor?(a.dead(),a.node.active=!1):(a.hpOverDead(),Z.default.log("\u602a\u7269\u6b7b\u4ea1",a.prop.handle,a.isLive)),c.GameEventDispatcher.instance.emit(d.EventDefiner.Fight_Actor_Dead),Re.default.instance.showMonsterDeadTip(a.prop))}},t.prototype.isCanFlyBack=function(e){var t=!0;switch(o.ActivityStatus.value){case o.ActivityStatus.MoneyDailyCopy:e||(t=!1)}return t},t.prototype.attackResultState=function(e,t){if(t){var n=L.default.instance.getSceneEntity(t.handle);if(!n)return;if(n.prop.status=t.state,0!=(t.state&m.StateBit.Rescure)){if(!n.isLive)return;n.prop.hp=t.hp,n.prop.maxHP=t.maxhp}if(0!=(t.state&m.StateBit.Shield)){if(!n.isLive)return;n.prop.shield=t.shield,t.type==ee.SKILL_RESULT_IDE.ADDSHIELD&&V.default.instance.addOneEffect(n,y.BuffEffectName.JIAFANG)}0!=(t.state&m.StateBit.Relive)&&(Z.default.log("\u590d\u6d3b\u4e86"+n.prop.handle),n.prop.hp=t.hp,n.rescure(),n.prop.selfMonster?(f.default.instance.leftdeadentitys.splice(f.default.instance.leftdeadentitys.indexOf(n),1),f.default.instance.leftlives.push(n.prop)):(f.default.instance.rightdeadentitys.splice(f.default.instance.rightdeadentitys.indexOf(n),1),f.default.instance.rightlives.push(n.prop))),t.type==ee.SKILL_RESULT_IDE.REMOVEHANDLE&&i.instance.removeEntityByHandle(t.data.handle)}},t.prototype.removeEntity=function(e){V.default.instance.recoveryhandle(e.prop.handle);var t=f.default.instance.rightlives;e.prop.selfMonster?(f.default.instance.leftdeadentitys.push(e),t=f.default.instance.leftlives):(f.default.instance.rightdeadentitys.push(e),1==t.length&&this.lastTalk(t[0])),-1!=t.indexOf(e.prop)&&t.splice(t.indexOf(e.prop),1)},t.prototype.removeEntityByHandle=function(e){var t=L.default.instance.getSceneEntity(e);L.default.instance.removeActorObj_fromScene(e+""),t&&this.removeEntity(t)},t.prototype.saveEntitys=function(){var e=[];e[0]=[],e[1]=[];var t=this.getSaveEntitys();o.ActivityStatus.value==o.ActivityStatus.TreasureMap&&ae.default.instance.FightNum==ae.default.instance.Event_Type_Elite&&(t=t.concat(ae.default.instance.getCaptureMonster)),f.default.instance.resultShowMonster=t.concat();for(var i=P.MonsterType.MonsterWarTeam[P.MonsterType.MonsterBattle],n=0,a=t;n<a.length;n++){var r=a[n],s={id:r.cardid,grade:r.grade,level:r.cultivateLv,skillCdDic:r.skillCdDic,specialMonster:r.specialMonster,currentHp:o.ActivityStatus.value==o.ActivityStatus.TreasureMap?r.hp:0,autoUseSkill:r.autobigskill,addlevel:r.addlevel||0,addtype:r.addtype||0};!r.specialMonster&&r.canSave&&-1!=i.indexOf(r.cardid)?(s.id=i.indexOf(r.cardid),e[0].push(s)):r.canSave&&(s.attr=r.attr,e[1].push(s))}return Z.default.log("\u4fdd\u5b58\u6218\u961f\u4fe1\u606f:",e),Z.default.log("\u5f53\u524d\u51fa\u6218\u6218\u961f\u4fe1\u606f:",i),e},t.prototype.getSaveEntitys=function(){var e=b.MyRoleInfo.ReserveNum();if(f.default.instance.leftlives.length>0){for(var t=[],i=0,n=f.default.instance.leftlives;i<n.length;i++){var a=n[i];a.copyEntity||a.type==F.EntityType.enActor||t.push(a)}return Z.default.log("\u4fdd\u5b58\u602a\u7269\u4e2a\u6570 : "+t.length,t),t.length>0?(t.sort(this.sortSaveEntity),o.ActivityStatus.value==o.ActivityStatus.TreasureMap?t.concat():t.concat().slice(0,e)):[]}return[]},t.prototype.sortSaveEntity=function(e,t){if(t.grade==e.grade){if(P.default.instance.getCardGradeByGradeConf(t.cardid,t.grade).bigSkill){var i=P.default.instance.getCardGradeByGradeConf(t.cardid,t.grade).bigSkill;return t.skillCdDic[i]&&e.skillCdDic[i]?t.skillCdDic[i].allcanusenum-t.skillCdDic[i].curusenum-(e.skillCdDic[i].allcanusenum-e.skillCdDic[i].curusenum):t.skillCdDic[i]?1:-1}return t.fight-e.fight}return t.grade-e.grade},t.prototype.updateData=function(e){if(f.default.instance.fightlogic&&f.default.instance.fightstatus!=f.FIGHTSTATUS.FIGHTEND)for(var t=f.default.instance.fightlogic.UpdateSing(e),i=0,n=t;i<n.length;i++){var o=n[i];console.log("\u541f\u5531\u6280\u80fd",t),this.actorAttackResult(o)}if(f.default.instance.specialskillstatus==y.SPECIAL_SKILL_STATUS.NONE){if(f.default.instance.fightlogic&&f.default.instance.fightstatus!=f.FIGHTSTATUS.FIGHTEND){var a=f.default.instance.fightlogic.Update(e/1e3);this.updateFight(a.fight);for(var r=0,s=a.result;r<s.length;r++){o=s[r];Z.default.log("buff \u7ed3\u679c",o);var l=L.default.instance.getSceneEntity(o.userhandle);this.attackResultState(l,o),this.attackResultEffect(l,o)}}f.default.instance.fightstatus==f.FIGHTSTATUS.UPGRADE&&this.checkUpgradeMonster(),f.default.instance.fightstatus==f.FIGHTSTATUS.UPGRADECOM&&this.checkPrewarSkill(),f.default.instance.fightstatus==f.FIGHTSTATUS.PLAYSKILL&&this.checkPrewarSkillComplete()}},t.prototype.checkUpgradeMonster=function(){if(o.ActivityStatus.Arena!=o.ActivityStatus.value){var e=f.default.instance.leftlives.sort(this.sortSaveEntity),t=void 0,i=void 0,n=void 0,a=void 0;if(ye.default.instance)for(var r=0;r<e.length;r++)if(t=ye.default.instance.setHaveUpgrade(),n=e[r].grade,t&&5!=e[r].grade&&n!=(i=ye.default.instance.setUpgrade(e[r])).grade){a=L.default.instance.getSceneEntity(i.handle),C.default.instance.clearEntity(a);var s={cardid:i.cardid,grade:i.grade,level:i.cultivateLv,num:1,self:!0,skillcdDic:i.skillCdDic,autoUseSkill:!1,x:i.x,y:i.y};c.GameEventDispatcher.instance.emit(d.EventDefiner.C_Scene_Add_Actor,s)}}j.default.instance.setTimeout("checkUpgradeMonster",function(){f.default.instance.fightstatus=f.FIGHTSTATUS.UPGRADECOM,j.default.instance.clearTimeout("checkUpgradeMonster")},this,600)},t.prototype.checkComboSkill=function(){if(f.default.instance.fightstatus==f.FIGHTSTATUS.FIGHT||o.ActivityStatus.value!=o.ActivityStatus.Guide||f.default.instance.specialskillstatus!=y.SPECIAL_SKILL_STATUS.COMBO){var e=[],t=[],i=[],n=0,a=0,r=0;for(var s in f.default.instance.fightCaridEntityDic)for(var l=f.default.instance.fightCaridEntityDic[s],c=0;c<l[0].prop.skillList.length;c++){var d=l[0].prop.skillList[c];if(p.default.instance.getSkillBySkillId(d.skillid).triggerway==y.TRIGGER_WAY.COMBO){for(var h=0,u=f.default.instance.fightCaridEntityDic[s];h<u.length;h++){var g=u[h];if(g.skillCanUse(d.skillid)&&(i=f.default.instance.seekTarget(g,d.skillid,d.skilllv)).length>0){n=d.skillid,a=d.skilllv,f.default.instance.specialskillstatus=y.SPECIAL_SKILL_STATUS.COMBO,t.push(i[0].attackEntity),e.push(g),r+=g.atkTarget.length;for(var m=function(e){null==t.find(function(t){return e.prop.handle==t.prop.handle})&&t.push(e)},C=0,v=g.atkTarget;C<v.length;C++){m(v[C])}}}if(f.default.instance.specialskillstatus==y.SPECIAL_SKILL_STATUS.COMBO){Z.default.log("\u8fde\u62db\u72b6\u6001\u4e2d");break}}}f.default.instance.specialskillstatus==y.SPECIAL_SKILL_STATUS.COMBO&&(Z.default.log("comboenemytarges"+t.length),K.default.instance.showSpecialEffect(e,n,a,t,r))}},t.prototype.myRoleUseSkill=function(e,t){var i=f.default.instance.myRole;i&&i.getComponent(N.default).checkAttackTarget(e,t,!0)},t.prototype.updateFight=function(e){f.default.instance.leftFight=e[0]||0,f.default.instance.rightFight=e[1]||0,c.GameEventDispatcher.instance.emit(d.EventDefiner.Fight_Power_Change)},t.prototype.enterGuide=function(){c.GameEventDispatcher.instance.emit(d.EventDefiner.ChangeActivityStatus,o.ActivityStatus.Guide),c.GameEventDispatcher.instance.emit(d.EventDefiner.ChangeGameScene,{status:k.GameScene.Fight,guanqiaId:y.GQIdType.GuideFight})},t.prototype.battleScroll=function(){var e=be.default.instance.scrollList,t=this.scorllConfig.scroll[1].slice(0),i=[];for(var n in ue.MyReelData.curreellist=[],e){for(var o in t)e[n].id==t[o].id&&5==t[o].param2&&(i.push(t[o].id),t.splice(o,1));for(var r in e)for(var o in t)e[r].id==t[o].id&&4==t[o].param2&&(i.push(t[o].id),t.splice(o,1));for(var s in e)for(var o in t)e[s].id==t[o].id&&3==t[o].param2&&(i.push(t[o].id),t.splice(o,1));for(var l in ue.MyReelData.curreellist=[],i)ue.MyReelData.curreellist.length<5&&ue.MyReelData.curreellist.push(i[l])}var c={cmd:"scrollequip",list:ue.MyReelData.curreellist};a.default.instance.sendProto(c);var d={cmd:"fightachieve",param:3,number:this.UserScrollNumber};a.default.instance.sendProto(d),this.UserScrollNumber=0},t.prototype.checkWaitSkillResultList=function(){var e=this;this.waitSkillResultList.length>0&&K.default.instance.bigskillcanhit&&(this.waitSkillResultList.forEach(function(t){var i=f.default.instance.fightlogic.Spell(t[0],t[1],t[2],t[3]);console.warn("\u4f7f\u7528\u5927\u62db\u65f6\u6682\u505c\u7684Interval\u65f6 \u8fd8\u4f1a\u89e6\u53d1 \u5148\u4fdd\u5b58\u7ed3\u679c\u7ee7\u7eedInterval\u65f6\u5148\u5904\u7406 \u653b\u51fb\u7ed3\u679c-----1\uff1a",t[2],i,t[1]),e.actorAttackResult(i)}),this.waitSkillResultList=[])},t.prototype.talkingAbould=function(){var e=this;f.default.instance.fightstatus<=0||this._talkInterval||Me.default.isFightTalk||(this.showTalkIng(),this._talkInterval=v.default.instance.setInterval(function(){e.showTalkIng()},this,5e3))},t.prototype.showTalkIng=function(){Le.FightTalk.Talking(f.default.instance.leftlives,!1),this.setTalkInterval()},t.prototype.setTalkInterval=function(){var e=this;this._talkInterval1=v.default.instance.setTimeout(function(){Le.FightTalk.Talking(f.default.instance.rightlives,!1),v.default.instance.clearTimeout(e._talkInterval1),e._talkInterval1=null},this,1e3)},t.prototype.talkEnd=function(){v.default.instance.clearInterval(this._talkInterval),this._talkInterval=null,v.default.instance.clearTimeout(this._talkInterval1),this._talkInterval1=null,this.clearTalkQiPao()},t.prototype.lastTalk=function(e){this.talkEnd(),this.canNoFightTalk||Me.default.isFightTalk||Le.FightTalk.Talking(e,!0)},t.prototype.clearTalkQiPao=function(){for(;Le.FightTalk.talkArr.length;){var e=Le.FightTalk.talkArr.shift();Ne.default.instance.hideQiPao(e)}Le.FightTalk.talkArr=[]},t.prototype.getDamageList=function(e){var t=e?0:1,i=[],n=[],o=[],a=this.roleDamageDic[t];for(var r in a&&i.push([a]),P.MonsterType.MonsterWarTeam[P.MonsterType.MonsterBattle]){var s=P.MonsterType.MonsterWarTeam[P.MonsterType.MonsterBattle][r];if(this.warDamageDic[t][s]){for(var l in n=[],this.warDamageDic[t][s])"all"!=l&&n.push(this.warDamageDic[t][s][l]);i.push([this.warDamageDic[t][s].all,n])}}for(var l in this.warDamageDic[t])if(-1==P.MonsterType.MonsterWarTeam[P.MonsterType.MonsterBattle].indexOf(parseInt(l))){for(var c in n=[],this.warDamageDic[t][l])"all"!=c&&n.push(this.warDamageDic[t][l][c]);o.push([this.warDamageDic[t][l].all,n])}return i.concat(o)},t.prototype.hasSmallList=function(e,t){var i=[];for(var n in this.warDamageDic[e][t])for(var o in this.warDamageDic[e][t])"all"!=o&&i.push(this.warDamageDic[e][t][o]);return i.length>0},t.prototype.statisticsFightInfo=function(e,t,i){var n=null;if(this.warDamageDic["max"+Be.DamageInfoType.Attack]||(this.warDamageDic["max"+Be.DamageInfoType.Attack]=0,this.warDamageDic["max"+Be.DamageInfoType.Injuried]=0,this.warDamageDic["max"+Be.DamageInfoType.Rescure]=0),e&&e.prop)if(e.prop.type==F.EntityType.enMonster){var o=e.prop.selfMonster?0:1,a=e.prop.cardid,r=e.prop.grade;switch(this.warDamageDic[o]||(this.warDamageDic[o]={}),this.warDamageDic[o][a]||(this.warDamageDic[o][a]={}),this.warDamageDic[o][a][r]||(n=new Be.DamageInfo,this.warDamageDic[o][a].all=n,n.camp=o,n.addtype=e.prop.addtype,n.grade=0,n.cardid=a,n.type=e.prop.type,n.actorname=P.default.instance.GetMonsterInfo(a).cardName,(n=new Be.DamageInfo).cardid=a,n.camp=o,n.actorname=P.default.instance.GetMonsterInfo(a).cardName,this.warDamageDic[o][a][r]=n),n=this.warDamageDic[o][a][r],i){case Be.DamageInfoType.Attack:n.attack+=t,this.warDamageDic[o][a].all.attack+=t,this.changeFightInfoMax(i,n.attack,a);break;case Be.DamageInfoType.Injuried:n.injuried+=t,this.warDamageDic[o][a].all.injuried+=t,this.changeFightInfoMax(i,n.injuried,a);break;case Be.DamageInfoType.Rescure:n.rescure+=t,this.warDamageDic[o][a].all.rescure+=t,this.changeFightInfoMax(i,n.rescure,a)}}else switch(this.roleDamageDic[e.prop.selfMonster?0:1]?n=this.roleDamageDic[e.prop.selfMonster?0:1]:(n=new Be.DamageInfo,this.roleDamageDic[e.prop.selfMonster?0:1]=n,e.prop.selfMonster&&(n.actorname=b.MyRoleInfo.name)),n.type=e.prop.type,i){case Be.DamageInfoType.Attack:n.attack+=t,this.changeFightInfoMax(i,n.attack);break;case Be.DamageInfoType.Injuried:n.injuried+=t,this.changeFightInfoMax(i,n.injuried);break;case Be.DamageInfoType.Rescure:n.rescure+=t,this.changeFightInfoMax(i,n.rescure)}},t.prototype.changeFightInfoMax=function(e,t,i){t>this.warDamageDic["max"+e]&&(this.warDamageDic["max"+e]=t),i&&t>this.warDamageDic["max"+i+e]&&(this.warDamageDic["max"+i+e]=t)},t.instance=null,__decorate([Fe(H.default)],t.prototype,"ActorsMaskLayer",void 0),__decorate([Fe(cc.Node)],t.prototype,"enterfightnode",void 0),__decorate([Fe(cc.Node)],t.prototype,"bossCommingNode",void 0),__decorate([Fe(cc.Node)],t.prototype,"waveNode",void 0),t=i=__decorate([Ge],t)}(n.default);i.default=We,cc._RF.pop()},{"../../../Core/ConfigsManager":"ConfigsManager","../../../Core/Const/EntityType":"EntityType","../../../Core/Controller":"Controller","../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Core/LoadManager":"LoadManager","../../../Core/SpineBase":"SpineBase","../../../Core/TimeController":"TimeController","../../../Core/WindowType":"WindowType","../../../Global/GlobalValue":"GlobalValue","../../../GlobalContext":"GlobalContext","../../../NetConnect/NetConnet":"NetConnet","../../../Util/NumberUtil":"NumberUtil","../../../Util/Scene/MoveUtil":"MoveUtil","../../../Util/Utils":"Utils","../../Activity/ActivityController":"ActivityController","../../Arena/ArenaController":"ArenaController","../../Buff/BuffController":"BuffController","../../Chapter/BossComming":"BossComming","../../Chapter/ChapterController":"ChapterController","../../Chapter/GuanqiaController":"GuanqiaController","../../Commons/RewardUtils":"RewardUtils","../../DailyCopy/DailyCopyCtrl":"DailyCopyCtrl","../../EquipCopy/EquipCopyController":"EquipCopyController","../../EquipCopy/EquipCopyEvent":"EquipCopyEvent","../../ExpCopy/ExpCopyCtrl":"ExpCopyCtrl","../../Expedition/ExpeditionConfig":"ExpeditionConfig","../../Fight/fightlogic":"fightlogic","../../Fight/staticattr":"staticattr","../../FightResultWin/FightResultEquipCopy":"FightResultEquipCopy","../../FightResultWin/FightResultExpedition":"FightResultExpedition","../../FightResultWin/FightResultWin":"FightResultWin","../../FightTalk/fightTalk":"fightTalk","../../FridBoss/FridBossController":"FridBossController","../../Functionicon/FunctionIconController":"FunctionIconController","../../Guide/GuideNewController":"GuideNewController","../../HighLadder/HighLadderData":"HighLadderData","../../Item/ItemController":"ItemController","../../Item/ItemData":"ItemData","../../LoardCrusadeWin/DevilResult":"DevilResult","../../LoardCrusadeWin/LoardCrusadeCtrl":"LoardCrusadeCtrl","../../Mine/MineCtrl":"MineCtrl","../../OpenWin/OpenWinController":"OpenWinController","../../PlotWin/PlotController":"PlotController","../../Reel/ReelMode":"ReelMode","../../Role/RoleController":"RoleController","../../Role/RoleInfo":"RoleInfo","../../SandTable/SandTableController":"SandTableController","../../Sound/SoundController":"SoundController","../../Status/StatusController":"StatusController","../../Status/StatusType":"StatusType","../../Tips/FightWaveTip":"FightWaveTip","../../Tips/OpTipsController":"OpTipsController","../../Tips/RewardTips":"RewardTips","../../Totems/TotemsCtrl":"TotemsCtrl","../../TotemsCopy/TotemsCopyCtrl":"TotemsCopyCtrl","../../TotemsCopy/TotemsCopyUtils":"TotemsCopyUtils","../../TreasureMap/TreasureMapController":"TreasureMapController","../../WarTeam/MonsterController":"MonsterController","../../setting/SettingData":"SettingData","../Animal":"Animal","../BigSkill/SpecialEffectController":"SpecialEffectController","../Effect/BuffTypeEffectUtils":"BuffTypeEffectUtils","../Effect/FntSwingUtils":"FntSwingUtils","../Effect/MonsterIndividualityUtils":"MonsterIndividualityUtils","../Manager/MonsterDeadTipManager":"MonsterDeadTipManager","../Manager/SceneManager":"SceneManager","../Monster":"Monster","../Pool/ActorPools":"ActorPools","../Pool/SpinePools":"SpinePools","../Prop/EntityProperty":"EntityProperty","../SceneEntity":"SceneEntity","../Unit/FightConst":"FightConst","../Unit/FightLog":"FightLog","../View/ActorsLayer":"ActorsLayer","../View/ActorsMaskLayer":"ActorsMaskLayer","../View/FightView":"FightView","../Vo/DamageInfo":"DamageInfo","./EntityQiPaoController":"EntityQiPaoController","./FightTimeController":"FightTimeController","./ReinforcementsController":"ReinforcementsController","./SceneController":"SceneController","./ServerFightController":"ServerFightController","./SkillController":"SkillController","./SpecialSkillEffectController":"SpecialSkillEffectController"}],FightDamageBigItem:[function(e,t,i){"use strict";cc._RF.push(t,"05e52q312BOipFFi83DkK1H","FightDamageBigItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Commons/CommonProgress"),o=e("../../Scene/Vo/DamageInfo"),a=e("../../Scene/Controller/FightController"),r=e("../../../Core/CommonTabItem"),s=e("../../../Core/Const/EntityType"),l=cc._decorator,c=l.ccclass,d=l.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.checkNode=null,t.sexNode=null,t.nameLabel=null,t.harmLabel=null,t.treatLabel=null,t.injuriedLabel=null,t.harmpg=null,t.treatpg=null,t.injuriedpg=null,t._data=null,t._info=null,t}return __extends(t,e),t.prototype.setData=function(e){this._data=e,this.checkNode.active=!1,this._info=e,this.sexNode.active=!0,this.sexNode.active=this._info.type==s.EntityType.enActor,this._info.type!=s.EntityType.enActor&&(this.checkNode.active=a.default.instance.hasSmallList(this._info.camp,this._info.cardid)),this.harmpg.value=this._info.attack/a.default.instance.warDamageDic["max"+o.DamageInfoType.Attack],this.treatpg.value=this._info.attack/a.default.instance.warDamageDic["max"+o.DamageInfoType.Rescure],this.injuriedpg.value=this._info.attack/a.default.instance.warDamageDic["max"+o.DamageInfoType.Injuried],console.log("-----------------",e),this.setLabelNum()},t.prototype.setLabelNum=function(){this.harmLabel.string=this._info.attack+"",this.treatLabel.string=this._info.rescure+"",this.injuriedLabel.string=this._info.injuried+"",this.nameLabel.string=this._info.actorname},__decorate([d(cc.Node)],t.prototype,"checkNode",void 0),__decorate([d(cc.Node)],t.prototype,"sexNode",void 0),__decorate([d(cc.Label)],t.prototype,"nameLabel",void 0),__decorate([d(cc.Label)],t.prototype,"harmLabel",void 0),__decorate([d(cc.Label)],t.prototype,"treatLabel",void 0),__decorate([d(cc.Label)],t.prototype,"injuriedLabel",void 0),__decorate([d(n.default)],t.prototype,"harmpg",void 0),__decorate([d(n.default)],t.prototype,"treatpg",void 0),__decorate([d(n.default)],t.prototype,"injuriedpg",void 0),t=__decorate([c],t)}(r.default);i.default=p,cc._RF.pop()},{"../../../Core/CommonTabItem":"CommonTabItem","../../../Core/Const/EntityType":"EntityType","../../Commons/CommonProgress":"CommonProgress","../../Scene/Controller/FightController":"FightController","../../Scene/Vo/DamageInfo":"DamageInfo"}],FightDamageSmallItem:[function(e,t,i){"use strict";cc._RF.push(t,"bd7285gfDRFTK5hBVsrjtXG","FightDamageSmallItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Commons/CommonProgress"),o=e("../../Scene/Vo/DamageInfo"),a=e("../../Scene/Controller/FightController"),r=e("../../../Core/CommonTabItem"),s=cc._decorator,l=s.ccclass,c=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.nameLabel=null,t.harmLabel=null,t.treatLabel=null,t.injuriedLabel=null,t.harmpg=null,t.treatpg=null,t.injuriedpg=null,t._data=null,t._list=[],t._info=null,t}return __extends(t,e),t.prototype.setData=function(e){this._data=e,this.harmpg.value=this._data.attack/a.default.instance.warDamageDic["max"+this._data.cardid+o.DamageInfoType.Attack],this.treatpg.value=this._data.attack/a.default.instance.warDamageDic["max"+this._data.cardid+o.DamageInfoType.Rescure],this.injuriedpg.value=this._data.attack/a.default.instance.warDamageDic["max"+this._data.cardid+o.DamageInfoType.Injuried],this.setLabelNum()},t.prototype.setLabelNum=function(){this.harmLabel.string=this._data.attack+"",this.treatLabel.string=this._data.rescure+"",this.injuriedLabel.string=this._data.injuried+"",this.nameLabel.string=this._data.actorname},__decorate([c(cc.Label)],t.prototype,"nameLabel",void 0),__decorate([c(cc.Label)],t.prototype,"harmLabel",void 0),__decorate([c(cc.Label)],t.prototype,"treatLabel",void 0),__decorate([c(cc.Label)],t.prototype,"injuriedLabel",void 0),__decorate([c(n.default)],t.prototype,"harmpg",void 0),__decorate([c(n.default)],t.prototype,"treatpg",void 0),__decorate([c(n.default)],t.prototype,"injuriedpg",void 0),t=__decorate([l],t)}(r.default);i.default=d,cc._RF.pop()},{"../../../Core/CommonTabItem":"CommonTabItem","../../Commons/CommonProgress":"CommonProgress","../../Scene/Controller/FightController":"FightController","../../Scene/Vo/DamageInfo":"DamageInfo"}],FightDamageWin:[function(e,t,i){"use strict";cc._RF.push(t,"cceaea9nmpNLo6Crzmex2hC","FightDamageWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Window"),o=e("../../../Util/Utils"),a=e("../../Scene/Controller/FightController"),r=e("../../../Core/CommonTabList"),s=cc._decorator,l=s.ccclass,c=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=null,t.commonTabList=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this);var t=a.default.instance.getDamageList(!0);this.commonTabList.initLlisData(t)},t.prototype.hide=function(){e.prototype.hide.call(this),o.default.setNodeChildDestoryByUrl(this.content)},__decorate([c(cc.Node)],t.prototype,"content",void 0),__decorate([c(r.default)],t.prototype,"commonTabList",void 0),t=__decorate([l],t)}(n.default);i.default=d,cc._RF.pop()},{"../../../Core/CommonTabList":"CommonTabList","../../../Core/Window":"Window","../../../Util/Utils":"Utils","../../Scene/Controller/FightController":"FightController"}],FightInfoPanel:[function(e,t,i){"use strict";cc._RF.push(t,"b4d18t9ts5JRK9V5YcOO+fR","FightInfoPanel"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/GameEventDispatcher"),a=e("../../Core/Event"),r=e("../Scene/Manager/SceneManager"),s=e("../Scene/View/FightView"),l=e("../Chapter/GuanqiaController"),c=e("../Role/RoleInfo"),d=e("../Status/StatusType"),p=e("../../GlobalContext"),h=e("../../Core/TimeController"),u=e("../Scene/Controller/EntityQiPaoController"),f=e("../Chapter/ChapterController"),g=e("../Gamelayer/RoleHead"),y=e("../Activity/ActivityController"),m=e("../Arena/ArenaController"),C=e("../../Util/Utils"),v=e("../../Core/WindowType"),_=e("../../Core/CommonsResManager"),b=e("../../Core/Language"),T=e("../Tips/OpTipsController"),S=e("../DailyCopy/DailyCopyCtrl"),I=e("../EquipCopy/EquipCopyController"),w=e("../EquipCopy/EquipCopyEvent"),D=e("../TreasureMap/TreasureMapController"),R=e("../../Util/SDKUtils"),A=e("../../Core/WindowManager"),N=e("../Scene/Controller/ServerFightController"),L=e("../../Core/LoadManager"),E=e("../Commons/WindowOpenUtils"),B=e("../Role/RoleController"),M=e("../Tips/TipsWinController"),x=e("../PlotWin/PlotController"),k=e("../LoardCrusadeWin/LoardCrusadeCtrl"),P=e("../../Util/NumberUtil"),G=e("../HighLadder/HighLadderController"),F=cc._decorator,W=F.ccclass,U=F.property,O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.myBuff=null,t.foeBuff=null,t.leftFightLabel=null,t.rightFightLabel=null,t.EnemyFightPower=null,t.monsterNum=null,t.reserveNum=null,t.SelfFightBar=null,t.EnemyFightBar=null,t.class=null,t.bossStatus=null,t.rolehead=null,t.curClass=null,t.allClass=null,t.reserveDescLb=null,t.reserve=null,t.money=null,t.ReelInfo=null,t.loardAtlas=null,t.enemyStep=null,t.curstep=null,t.allstep=null,t.faceBox=null,t.backBox=null,t.faceScrollViewBox=null,t.faceitem=null,t.ebox1=null,t.ebox2=null,t.ebox12=null,t.ebox22=null,t.eboxbtn=null,t.speedBtn=null,t.slinkBtn=null,t.spriteAtlas=null,t.arenaNode=null,t.DialyCopyBossHp=null,t.EquipCopyNode=null,t.hightSkipBtn=null,t.FightNumUp=null,t.ArenaWait=null,t.NodeFightBox=null,t.CanHighSkipFight=!1,t.timeNum=18e3,t.delayNumSelf=0,t.delayNumEmeny=0,t.curleftFight=0,t.endleftFight=0,t.currightFight=0,t.endrightFight=0,t.leftFight=0,t.rightFight=0,t.cansendface=!0,t.cansendfaceTimeCD=6e3,t.cansendfaceTime=0,t.equipCopyTime=null,t.equipCopyFightCD=0,t.speedActive=!1,t.isPlayFightAnimation=!1,t.updateTime=0,t.arenawaittime=0,t.arenawaitinterval=0,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this),this.cansendface=!0,i.instance=this,this.node.width=Math.min(p.GlobalContext.StageWidth,1624),this.node.height=Math.min(p.GlobalContext.StageHeight,1e3),this.NodeFightBox.childrenCount||L.default.instance.loadResByType(p.GlobalContext.Root+"prefab/fightinfopanel/FightSimulatorBox",cc.Prefab,function(e){var i=C.default.getNodeByUrl(e,p.GlobalContext.Root+"prefab/fightinfopanel/FightSimulatorBox");t.NodeFightBox.addChild(i)},this)},t.prototype.showbtn=function(){R.default.instance.vibration(3e3),d.ActivityStatus.value==d.ActivityStatus.FightSimulator?cc.find("NodeFightBox",this.node).active=!cc.find("NodeFightBox",this.node).active:cc.find("NodeBox",this.node).active=!cc.find("NodeBox",this.node).active},t.prototype.setFightBuff=function(e,t){B.default.instance.setIsClickBuff("0"==t),E.default.instance.openWindowType(v.WindowType.FightBuffTips)},t.prototype.closeFightSimulator=function(){o.GameEventDispatcher.instance.emit(a.EventDefiner.ChangeActivityStatus,d.ActivityStatus.Chapter)},t.prototype.show=function(){this.money.getChildByName("Num").getComponent(cc.Label).string="0",this.SelfFightBar.fillRange=0,this.EnemyFightBar.fillRange=0,this.curleftFight=0,this.leftFight=0,this.currightFight=0,this.rightFight=0,this.eboxbtn.active="99"==R.default.instance.plat_id,e.prototype.show.call(this),this.rightFightLabel.string="0",this.leftFightLabel.string="0",this.bossStatus.active=!1,this.reserveNum.string="0",this.monsterNum.string="0",this.setUI(),this.loardInfo(),this.updateInfo(),this.setspeedsp(),this.setRemainMonsterDesc(),o.GameEventDispatcher.instance.on(a.EventDefiner.Fight_Power_Change,this.updateInfo,this),o.GameEventDispatcher.instance.on(a.EventDefiner.Fight_Actor_Dead,this.updateInfo,this),o.GameEventDispatcher.instance.on(a.EventDefiner.C_Fight_Clear,this.gameClear,this),o.GameEventDispatcher.instance.on(a.EventDefiner.C_Fight_Start,this.fightStart,this),o.GameEventDispatcher.instance.on(a.EventDefiner.C_Scene_Add_Actor,this.setBar,this),o.GameEventDispatcher.instance.on(a.EventDefiner.C_Fight_End,this.gameEnd,this),o.GameEventDispatcher.instance.on(a.EventDefiner.OPEN_UPDATE_TIME,this.setBar,this),o.GameEventDispatcher.instance.on(a.EventDefiner.ActivityStatus_Is_Show,this.Is_Show,this),o.GameEventDispatcher.instance.on(a.EventDefiner.CloseReelList,this.CloseReelList,this),o.GameEventDispatcher.instance.on(a.EventDefiner.Fight_Speed_Change,this.setspeedsp,this),o.GameEventDispatcher.instance.on(a.EventDefiner.FightUpdateArenaWait,this.updateArenaWait,this),o.GameEventDispatcher.instance.on(a.EventDefiner.FightShowBuffIcon,this.showFoeBuff,this),o.GameEventDispatcher.instance.on(a.EventDefiner.WindowOpenlink,this.wndowOpenlink,this),o.GameEventDispatcher.instance.on(a.EventDefiner.WindowCloselink,this.windowCloselink,this),o.GameEventDispatcher.instance.on("RESETHP",this.BossBar,this),o.GameEventDispatcher.instance.on("LoardAllDemage",this.loardInfoChange,this),d.ActivityStatus.value==d.ActivityStatus.Arena&&(o.GameEventDispatcher.instance.on(a.EventDefiner.Updata_StepNum,this.updatestepnum,this),this.updatestepnum()),this.hightSkipBtn.active=!1,this.faceBox.x=-p.GlobalContext.UIWidth/2+100,this.backBox.x=this.faceBox.x+100,this.fightSetFight(),this.setspeedsp(),this.updateTime=h.default.instance.setInterval(this.updateFight,this,50),this.updateArenaWait(null),this.foeBuff.active=!1},t.prototype.showFoeBuff=function(){this.foeBuff.active=!0},t.prototype.hide=function(){o.GameEventDispatcher.instance.off(a.EventDefiner.FightUpdateArenaWait,this.updateArenaWait,this),o.GameEventDispatcher.instance.off(a.EventDefiner.C_Fight_End,this.gameEnd,this),o.GameEventDispatcher.instance.off(a.EventDefiner.C_Fight_Clear,this.gameClear,this),o.GameEventDispatcher.instance.off(a.EventDefiner.Fight_Power_Change,this.updateInfo,this),o.GameEventDispatcher.instance.off(a.EventDefiner.Fight_Actor_Dead,this.updateInfo,this),o.GameEventDispatcher.instance.off(a.EventDefiner.C_Fight_Start,this.fightStart,this),o.GameEventDispatcher.instance.off(a.EventDefiner.Updata_StepNum,this.updatestepnum,this),o.GameEventDispatcher.instance.off(a.EventDefiner.ActivityStatus_Is_Show,this.Is_Show,this),o.GameEventDispatcher.instance.off(a.EventDefiner.C_Scene_Add_Actor,this.setBar,this),o.GameEventDispatcher.instance.off(a.EventDefiner.OPEN_UPDATE_TIME,this.setBar,this),r.default.instance.enemystep=-1,o.GameEventDispatcher.instance.off(a.EventDefiner.ArenaMatchFightResult,this.updateArenaInfo,this),o.GameEventDispatcher.instance.off(a.EventDefiner.Fight_Speed_Change,this.setspeedsp,this),o.GameEventDispatcher.instance.off(a.EventDefiner.CloseReelList,this.CloseReelList,this),o.GameEventDispatcher.instance.off("RESETHP",this.BossBar,this),o.GameEventDispatcher.instance.off(a.EventDefiner.FightShowBuffIcon,this.showFoeBuff,this),o.GameEventDispatcher.instance.off(a.EventDefiner.WindowOpenlink,this.wndowOpenlink,this),o.GameEventDispatcher.instance.off(a.EventDefiner.WindowCloselink,this.windowCloselink,this),o.GameEventDispatcher.instance.off("LoardAllDemage",this.loardInfoChange,this),this.clearFaceBox(),this.onClearEquipTime(),this.leftFight=0,this.rightFight=0,this.endleftFight=0,this.endrightFight=0,this.clearUpdateTime(),this.claerQrenaWaitInterval(),cc.find("NodeFightBox",this.node).active=!1,this.clearFightAnimation()},t.prototype.clearUpdateTime=function(){h.default.instance.clearInterval(this.updateTime),this.updateTime=null},t.prototype.setBar=function(){this.SelfFightBar.fillRange=1,this.updateTime||(this.updateTime=h.default.instance.setInterval(this.updateFight,this,50))},t.prototype.gameClear=function(){this.gameEnd(),this.SelfFightBar.fillRange=0,this.EnemyFightBar.fillRange=0,this.rightFightLabel.string="0",this.leftFightLabel.string="0"},t.prototype.gameEnd=function(){if(this.clearUpdateTime(),this.leftFight=0,d.ActivityStatus.value!=d.ActivityStatus.MoneyDailyCopy&&(this.rightFight=0),r.default.instance.fightresult?(this.rightFightLabel.string="0",this.EnemyFightBar.fillRange=0):(this.leftFightLabel.string="0",this.SelfFightBar.fillRange=0),this.curleftFight=0,this.currightFight=0,this.onClearEquipTime(),d.ActivityStatus.value==d.ActivityStatus.EquipCopy){var e=I.default.instance.getLevelCondition;this.EquipCopyNode.getChildByName("labelDesc").getComponent(cc.RichText).string=b.default.getStr("equipcopy_condition_"+e.conditionType,e.conditionParam)}},t.prototype.onResetMonsterNum=function(){this.reserveNum&&this.monsterNum&&(this.reserveNum.string="0",this.monsterNum.string="0")},t.prototype.getClassActive=function(){var e=l.default.instance.getGuanqiaPlayGames(r.default.instance.quanqiaId);return!!e&&e.length>1},t.prototype.setUI=function(){this.rolehead.getComponent(g.default).SetHead(c.MyRoleInfo.icon),this.speedActive=!1,this.speedBtn.node.active=!1,this.slinkBtn.active=!1,this.reserve.active=!1,this.class.active=!1,this.enemyStep.active=!1,this.faceBox.active=!1,this.backBox.active=!1,this.ReelInfo.active=!1,this.arenaNode.active=!1,this.money.active=!1,this.DialyCopyBossHp.active=!1,this.EquipCopyNode.active=!1;var e=d.ActivityStatus.value!=d.ActivityStatus.Guide;switch(this.node.getChildByName("SelfBox").active=this.rightFightLabel.node.active=this.leftFightLabel.node.active=e,d.ActivityStatus.value){case d.ActivityStatus.Chapter:this.speedActive=f.default.instance.chekcSatisfyChapteridAndGqid(0,2),this.reserve.active=!0,this.class.active=this.getClassActive();break;case d.ActivityStatus.Expedition:this.reserve.active=!0,this.speedActive=!0,this.class.active=this.getClassActive();break;case d.ActivityStatus.TreasureMap:this.reserve.active=!0,this.speedActive=!0,D.default.instance.canSlink&&(this.slinkBtn.active=!0,D.default.instance.canSlink=!1),this.class.active=this.getClassActive();break;case d.ActivityStatus.Arena:this.arenaNode.active=!0,this.enemyStep.active=!0,this.faceBox.active=!0,this.backBox.active=!0,this.speedActive=!1,o.GameEventDispatcher.instance.on(a.EventDefiner.ArenaMatchFightResult,this.updateArenaInfo,this),this.updateArenaInfo(null);break;case d.ActivityStatus.MoneyDailyCopy:e=!1,this.DialyCopyBossHp.active=!0,this.money.active=!0,this.speedActive=!0;break;case d.ActivityStatus.RefineDailyCopy:case d.ActivityStatus.GemDailyCopy:case d.ActivityStatus.ArtifactDailyCopy:case d.ActivityStatus.ExpCopy:this.speedActive=!0;break;case d.ActivityStatus.EquipCopy:this.reserve.active=!0,this.EquipCopyNode.active=!0,this.speedActive=!0;var t=I.default.instance.getLevelCondition;this.EquipCopyNode.getChildByName("labelDesc").getComponent(cc.RichText).string=b.default.getStr("equipcopy_condition_"+t.conditionType,t.conditionParam),this.class.active=this.getClassActive();break;case d.ActivityStatus.TotemsCopy:this.reserve.active=!0,this.speedActive=!0;break;case d.ActivityStatus.FightSimulator:this.speedActive=!0;break;case d.ActivityStatus.LoardCrusade:y.default.instance.isSetSandTab||(this.speedActive=!0)}y.default.instance.isSetSandTab&&(e=!1,this.node.getChildByName("WorldBossHP").active=!1),this.node.getChildByName("EnemyBox").active=e},t.prototype.Is_Show=function(e){var t=e.getUserData();this.ReelInfo.active=1==t},t.prototype.CloseReelList=function(){this.ReelInfo.active=!1},t.prototype.updateInfo=function(){var e=r.default.instance;e.fightstatus==r.FIGHTSTATUS.FIGHTEND?r.default.instance.fightresult?(this.endleftFight=e.leftFight,this.endrightFight=0):(this.endrightFight=e.rightFight,this.endleftFight=0):(this.endleftFight=e.leftFight,this.endrightFight=e.rightFight);var t=e.leftlives.length>0?e.leftlives.length:0;this.monsterNum.string=t.toString(),this.delayNumSelf=(this.endleftFight-this.curleftFight)/10,this.delayNumEmeny=(this.endrightFight-this.currightFight)/10,this.class.active&&(this.allClass.string=l.default.instance.getGuanqiaPlayGames(e.quanqiaId).length+"",this.curClass.string=e.games+"",this.bossStatus.active=l.default.instance.getGuanqiaPlayGames(e.quanqiaId).length==e.games&&f.default.instance.isLastGuanqia),this.DialyCopyBossHp.active&&(cc.find("Class/Layer/CurClass",this.DialyCopyBossHp).getComponent(cc.Label).string=e.games+"",cc.find("Class/Layer/AllClass",this.DialyCopyBossHp).getComponent(cc.Label).string=l.default.instance.getGuanqiaPlayGames(e.quanqiaId).length+""),this.reserve.active&&(d.ActivityStatus.value==d.ActivityStatus.TreasureMap?this.reserveNum.string=this.monsterNum.string:this.reserveNum.string=c.MyRoleInfo.ReserveNum(!0)+""),this.updateTime||(this.updateTime=h.default.instance.setInterval(this.updateFight,this,50)),this.endleftFight<this.endrightFight&&f.default.instance.chekcSatisfyChapteridAndGqid(1,0)?this.isPlayFightAnimation||(this.isPlayFightAnimation=!0,this.rightFightLabel.node.parent.getChildByName("Fight").color=cc.color(225,41,41,255),this.leftFightLabel.node.parent.getChildByName("Fight").color=cc.color(225,41,41,255),this.rightFightLabel.node.parent.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.8,1.1),cc.scaleTo(.8,.8)))),this.leftFightLabel.node.parent.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.8,1.1),cc.scaleTo(.8,.8))))):this.isPlayFightAnimation&&(this.isPlayFightAnimation=!1,this.clearFightAnimation())},t.prototype.clearFightAnimation=function(){this.leftFightLabel.node.parent.getChildByName("Fight").color=cc.color(255,255,255,255),this.rightFightLabel.node.parent.getChildByName("Fight").color=cc.color(255,255,255,255),this.rightFightLabel.node.parent.stopAllActions(),this.leftFightLabel.node.parent.stopAllActions(),this.rightFightLabel.node.parent.scale=1,this.leftFightLabel.node.parent.scale=1},t.prototype.fightSetFight=function(){this.leftFight=r.default.instance.leftFight,d.ActivityStatus.value!=d.ActivityStatus.MoneyDailyCopy&&(this.rightFight=r.default.instance.rightFight),d.ActivityStatus.value!=d.ActivityStatus.MoneyDailyCopy||this.rightFight||(this.rightFight=r.default.instance.rightFight)},t.prototype.fightStart=function(){this.claerQrenaWaitInterval(),this.enemyStep.active=!1,this.fightSetFight(),d.ActivityStatus.value==d.ActivityStatus.EquipCopy&&this.onEquipCopyCondition(),this.hightSkipBtn.active=d.ActivityStatus.value==d.ActivityStatus.HighLadder&&c.MyRoleInfo.vipLevel>=G.default.instance._config.LadderRaceConf[10].skipVipLevel&&!y.default.instance.isSetSandTab,this.CanHighSkipFight=this.hightSkipBtn.active,this.hightSkipBtn.x=p.GlobalContext.UIWidth/2-this.hightSkipBtn.width},t.prototype.getMoneyNum=function(){var e=this.money.getChildByName("Num").getComponent(cc.Label);return parseInt(e.string)},t.prototype.updateFight=function(){if(this.updateTime){var e=this.money.getChildByName("Num").getComponent(cc.Label);r.default.instance.attackenemyhp;if(d.ActivityStatus.value==d.ActivityStatus.MoneyDailyCopy){S.default.instance;var t=100,i=this.rightFight,n=r.default.instance.rightFight;r.default.instance.fightstatus==r.FIGHTSTATUS.FIGHTEND?i&&(t=n/i*100):i&&n&&(t=n/i*100),t=100-t;var o=S.default.instance.setCoin(t);if(parseInt(e.string)<=o||!n&&r.default.instance.fightstatus==r.FIGHTSTATUS.FIGHTEND){e.string=o+"";var a=S.default.instance.getBoxNum();this.DialyCopyBossHp.getChildByName("num").getComponent(cc.Label).string="x"+a;var s=S.default.instance.getNowHp(n||this.rightFight,this.rightFight?this.rightFight:n);s&&(this.DialyCopyBossHp.getChildByName("Label").getComponent(cc.Label).string=s[0]+"/"+s[1],this.DialyCopyBossHp.getChildByName("bar").width=s[0]/s[1]*370)}}if(0!=this.delayNumSelf&&(this.endrightFight<=0||Math.abs(this.endleftFight-this.curleftFight)<=Math.abs(this.delayNumSelf)*r.default.instance.fightViewPlayRate||this.delayNumSelf<10?(this.curleftFight=this.endleftFight,this.delayNumSelf=0):this.curleftFight+=this.delayNumSelf*Math.max(r.default.instance.fightViewPlayRate),this.leftFightLabel.string=Math.floor(this.curleftFight)+"",r.default.instance.fightresult||0!=this.curleftFight?this.SelfFightBar.fillRange=this.curleftFight/this.leftFight:this.SelfFightBar.fillRange=0),0!=this.delayNumEmeny){this.EnemyFightPower.active=!0,this.endrightFight<=0||Math.abs(this.endrightFight-this.currightFight)<=Math.abs(this.delayNumEmeny)*r.default.instance.fightViewPlayRate||this.delayNumEmeny<10?(this.currightFight=this.endrightFight,this.delayNumEmeny=0):(this.currightFight+=this.delayNumEmeny*Math.max(r.default.instance.fightViewPlayRate),this.currightFight<0&&(this.currightFight=0));var l=this.node.getChildByName("EnemyBox"),c=this.node.getChildByName("WorldBossHP");if(d.ActivityStatus.value==d.ActivityStatus.WorldBoss||d.ActivityStatus.value==d.ActivityStatus.EliteBoss){this.EnemyFightPower.active=!1,l.getChildByName("monsterhead").active=!1,l.getChildByName("EmenyFightProgress").active=!1,l.getChildByName("EmenyFightBar").active=!1,l.getChildByName("box").getChildByName("Fight").active=!1,l.getChildByName("box").getChildByName("EmenyFightLabel").active=!1,c.active=!y.default.instance.isSetSandTab,c.getChildByName("Label").active=!0;var p=y.default.instance;switch(d.ActivityStatus.value){case d.ActivityStatus.WorldBoss:c.getChildByName("Label").getComponent(cc.Label).string=Math.floor(1e4*p.worldBossHp.hp/p.worldBossHp.maxhp)/100+"%",c.getChildByName("bar").getComponent(cc.Sprite).fillRange=p.worldBossHp.hp/p.worldBossHp.maxhp,c.getChildByName("Icon").getComponent(cc.Sprite).spriteFrame=this.spriteAtlas.getSpriteFrame("WorldBossIcon");break;case d.ActivityStatus.EliteBoss:c.getChildByName("Label").getComponent(cc.Label).string=Math.floor(1e4*p.eliteRank.data[p.currElitIndex].hp/p.eliteRank.data[p.currElitIndex].maxhp)/100+"%",c.getChildByName("bar").getComponent(cc.Sprite).fillRange=p.eliteRank.data[p.currElitIndex].hp/p.eliteRank.data[p.currElitIndex].maxhp,c.getChildByName("Icon").getComponent(cc.Sprite).spriteFrame=this.spriteAtlas.getSpriteFrame("Icon")}}else l.getChildByName("box").getChildByName("Fight").active=!0,l.getChildByName("monsterhead").active=!0,l.getChildByName("EmenyFightProgress").active=!0,l.getChildByName("EmenyFightBar").active=!0,this.rightFightLabel.string=Math.floor(this.currightFight)+"",c.active=!1,c.getChildByName("Label").active=!1,this.EnemyFightBar.fillRange=this.currightFight/this.rightFight}this.speedActive&&(this.speedBtn.node.active=x.default.instance.iscomplete)}},t.prototype.onclickemeny=function(e,t){this.getProp(!1)},t.prototype.onclickself=function(e,t){this.getProp(!0)},t.prototype.getProp=function(e){var t,i;if(t=e?this.ebox1.string:this.ebox2.string,(i=e?this.ebox12.string:this.ebox22.string)||(i=5),""==t){var n={cardid:Math.ceil(5*Math.random()),grade:Math.ceil(5*Math.random()),level:1,num:1,self:e,autoUseSkill:!e};o.GameEventDispatcher.instance.emit(a.EventDefiner.C_Scene_Add_Actor,n)}else{n={cardid:parseInt(t),grade:parseInt(i),level:1,num:1,self:e,autoUseSkill:!e};o.GameEventDispatcher.instance.emit(a.EventDefiner.C_Scene_Add_Actor,n)}},t.prototype.move=function(e,t){o.GameEventDispatcher.instance.emit(a.EventDefiner.C_Fight_Start)},t.prototype.changeScene=function(e,t){o.GameEventDispatcher.instance.emit(a.EventDefiner.ChangeGameScene,{status:Number(t)})},t.prototype.stoprate=function(){s.default.instance.SetFightViewPlayRate(0)},t.prototype.changerate=function(){0==r.default.instance.fightViewPlayRate?s.default.instance.SetFightViewPlayRate(1):1==r.default.instance.fightViewPlayRate?s.default.instance.SetFightViewPlayRate(2):s.default.instance.SetFightViewPlayRate(1),r.default.instance.oldfightViewPlayRate=r.default.instance.fightViewPlayRate,this.setspeedsp()},t.prototype.setspeedsp=function(){this.speedBtn.spriteFrame=this.spriteAtlas.getSpriteFrame("speedup"+Math.max(1,r.default.instance.fightViewPlayRate))},t.prototype.onClickSlink=function(){o.GameEventDispatcher.instance.emit(a.EventDefiner.TreasureSlinkFight)},t.prototype.updatestepnum=function(){this.curstep.string=-1==r.default.instance.enemystep?"0":r.default.instance.enemyallstep-r.default.instance.enemystep+"",this.allstep.string=r.default.instance.enemyallstep+"",this.enemyStep.active=r.default.instance.enemystep!=r.default.instance.enemyallstep},t.prototype.updateArenaInfo=function(e){var t=m.default.instance.matchresult,i=r.default.instance.mycamp?0:1;this.setArenaInfo(this.arenaNode.getChildByName("myLayer").getChildByName("jiangbei"),t[r.default.instance.mycamp]),this.setArenaInfo(this.arenaNode.getChildByName("otherLayer").getChildByName("jiangbei"),t[i]),this.arenaNode.getChildByName("myLayer").getChildByName("Num2").getComponent(cc.Label).string=t[r.default.instance.mycamp]+"",this.arenaNode.getChildByName("otherLayer").getChildByName("Num2").getComponent(cc.Label).string=t[i]+""},t.prototype.setArenaInfo=function(e,t){for(var i=0;i<e.childrenCount;i++)e.children[i].getComponent(cc.Sprite).spriteFrame=t-1>=i?this.spriteAtlas.getSpriteFrame("icon_jiangbei2"):this.spriteAtlas.getSpriteFrame("icon_jiangbei3")},t.prototype.selectFace=function(e){var t=this;r.default.instance.myRole&&this.cansendface?(this.cansendface=!1,this.cansendfaceTime=h.default.instance.setTimeout(function(){t.cansendface=!0,t.clearcansendfaceTime()},this,this.cansendfaceTimeCD),m.default.instance.sendface(parseInt(e.target.name)),u.default.instance.showQiPaoFace(r.default.instance.myRole,e.target.name,2e3),this.changeFaceScrollViewBox()):T.default.instance.ShowMsg(b.default.getStr("arenafacecdtime"))},t.prototype.clearcansendfaceTime=function(){this.cansendfaceTime||h.default.instance.clearTimeout(this.cansendfaceTime)},t.prototype.clearFaceBox=function(){this.clearcansendfaceTime();for(var e=this.faceScrollViewBox.getChildByName("view").getChildByName("content"),t=e.childrenCount-1;t>=0;t--)C.default.setNodeToPool(v.PoolType.ArenaFace,e.children[t]);this.faceScrollViewBox.active=!1},t.prototype.changeFaceScrollViewBox=function(){this.faceScrollViewBox.active=!this.faceScrollViewBox.active;var e=this.faceScrollViewBox.getChildByName("view").getChildByName("content");if(this.faceScrollViewBox.active&&!e.childrenCount)for(var t=0;t<6;t++){var i=C.default.getNodeByPool(v.PoolType.ArenaFace,this.faceitem);i.getChildByName("face").getComponent(cc.Sprite).spriteFrame=_.default.instance.getSpriteFrameByName("face"+(t+1)),i.name=t+1+"",e.addChild(i)}},t.prototype.setRemainMonsterDesc=function(){d.ActivityStatus.value==d.ActivityStatus.TreasureMap||d.ActivityStatus.value==d.ActivityStatus.EquipCopy?this.reserveDescLb.string=b.default.getStr("fightinfomomsterdesc1"):this.reserveDescLb.string=b.default.getStr("fightinfomomsterdesc2")},t.prototype.onBack=function(){this.curleftFight=0,this.currightFight=0,d.ActivityStatus.Arena==d.ActivityStatus.value&&M.default.instance.ShowTips(b.default.getStr("arenaback"),function(){m.default.instance.sendBack()},this)},t.prototype.onEquipCopyCondition=function(){var e=this,t=I.default.instance.getLevelCondition;t.conditionType==w.EquipCopyType.Remain_Time&&(this.equipCopyFightCD=t.conditionParam,this.equipCopyTime=h.default.instance.setInterval(function(){if(e.equipCopyFightCD<=1)return e.onClearEquipTime(),void(e.EquipCopyNode.getChildByName("labelDesc").getComponent(cc.RichText).string=b.default.getStr("equipcopy_condition_error"));e.equipCopyFightCD=t.conditionParam-Math.round(I.default.instance._fightTime/1e3),e.EquipCopyNode.getChildByName("labelDesc").getComponent(cc.RichText).string=b.default.getStr("equipcopy_condition_"+t.conditionType,e.equipCopyFightCD)},this,500))},t.prototype.onClearEquipTime=function(){this.equipCopyTime&&h.default.instance.clearInterval(this.equipCopyTime)},t.prototype.highSkipFight=function(){if(this.CanHighSkipFight){var e=r.default.instance.leftFight>r.default.instance.rightFight;r.default.instance.fightlogic.OnFightResult(e),this.CanHighSkipFight=!1}},t.prototype.BossBar=function(){var e=this.node.getChildByName("WorldBossHP");e.getChildByName("Label").getComponent(cc.Label).string="0%",e.getChildByName("bar").getComponent(cc.Sprite).fillRange=0},t.prototype.updateArenaWait=function(e){var t=this;if(d.ActivityStatus.value!=d.ActivityStatus.Arena||N.default.instance.isstartfight)this.ArenaWait.active=!1;else{var i=null;switch(i=null!=e?e.detail:{type:m.default.instance.readylist.length<2?1:-1},this.arenawaittime=0,this.ArenaWait.active=!0,i.type){case 1:this.ArenaWait.getChildByName("arenawait").getComponent(cc.Sprite).spriteFrame=this.spriteAtlas.getSpriteFrame("i18n_dddfjr"),this.arenawaittime=r.default.instance.steptime;break;case 2:this.ArenaWait.getChildByName("arenawait").getComponent(cc.Sprite).spriteFrame=this.spriteAtlas.getSpriteFrame("i18n_dddfpzzrz"),this.arenawaittime=r.default.instance.steptime;break;default:this.ArenaWait.active=!1,this.claerQrenaWaitInterval()}this.arenawaittime>0&&(this.arenawaitinterval=h.default.instance.setInterval(function(){r.default.instance.steptime-h.default.instance.ServerTimeMins>0?t.ArenaWait.getChildByName("timeNode").getChildByName("timeLabel").getComponent(cc.Label).string=Math.ceil((r.default.instance.steptime-h.default.instance.ServerTimeMins)/1e3)+"":(t.ArenaWait.active=!1,t.claerQrenaWaitInterval())},this,1e3))}},t.prototype.claerQrenaWaitInterval=function(){this.arenawaitinterval&&(h.default.instance.clearInterval(this.arenawaitinterval),this.arenawaitinterval=0)},t.prototype.wndowOpenlink=function(e){e.detail==v.WindowType.PlotWin&&(this.speedBtn.node.active=!1)},t.prototype.windowCloselink=function(e){e.detail==v.WindowType.PlotWin&&(this.speedBtn.node.active=this.speedActive&&!A.default.instance.isOpenWindow(v.WindowType.SandTable))},t.prototype.loardInfo=function(){var e=this,t=this.node.getChildByName("EnemyBox"),i=this.node.getChildByName("devilContent");C.default.setNodeChildDestoryByUrl(i,p.GlobalContext.Root+"prefab/fightinfopanel/BossBigSkillProgBar",p.GlobalContext.Root+"prefab/fightinfopanel/bg_shsdb"),d.ActivityStatus.value!=d.ActivityStatus.LoardCrusade||y.default.instance.isSetSandTab||(t.active=!1,L.default.instance.loadResByType(p.GlobalContext.Root+"prefab/fightinfopanel/BossBigSkillProgBar",cc.Prefab,function(t){var n=C.default.getNodeByUrl(t,p.GlobalContext.Root+"prefab/fightinfopanel/BossBigSkillProgBar");i.addChild(n),i.getChildByName("BossBigSkillProgBar").getChildByName("bg_1").getChildByName("bg_touxiang1").getComponent(cc.Sprite).spriteFrame=e.loardAtlas.getSpriteFrame(k.default.instance.bossID+"")},this),L.default.instance.loadResByType(p.GlobalContext.Root+"prefab/fightinfopanel/bg_shsdb",cc.Prefab,function(e){var t=C.default.getNodeByUrl(e,p.GlobalContext.Root+"prefab/fightinfopanel/bg_shsdb");i.addChild(t),i.getChildByName("bg_shsdb").getComponentInChildren(cc.Label).string="0"},this))},t.prototype.loardInfoChange=function(){var e=this.node.getChildByName("devilContent"),t=r.default.instance.attackenemyhp,i=e.getChildByName("bg_shsdb").getComponentInChildren(cc.Label),n=e.getChildByName("bg_shsdb").children[0].getChildByName("Number_wang"),o=e.getChildByName("bg_shsdb").children[0].getChildByName("Number_yi");n.active=!1,o.active=!1,t>=1e8?(i.string=P.NumberUtil.toFixed(t/1e8,0)+"",n.active=!1,o.active=!0):t>=1e4?(i.string=P.NumberUtil.toFixed(t/1e4,0)+"",o.active=!1,n.active=!0):i.string=t+""},t.instance=null,__decorate([U(cc.Node)],t.prototype,"myBuff",void 0),__decorate([U(cc.Node)],t.prototype,"foeBuff",void 0),__decorate([U(cc.Label)],t.prototype,"leftFightLabel",void 0),__decorate([U(cc.Label)],t.prototype,"rightFightLabel",void 0),__decorate([U(cc.Node)],t.prototype,"EnemyFightPower",void 0),__decorate([U(cc.Label)],t.prototype,"monsterNum",void 0),__decorate([U(cc.Label)],t.prototype,"reserveNum",void 0),__decorate([U(cc.Sprite)],t.prototype,"SelfFightBar",void 0),__decorate([U(cc.Sprite)],t.prototype,"EnemyFightBar",void 0),__decorate([U(cc.Node)],t.prototype,"class",void 0),__decorate([U(cc.Node)],t.prototype,"bossStatus",void 0),__decorate([U(cc.Node)],t.prototype,"rolehead",void 0),__decorate([U(cc.Label)],t.prototype,"curClass",void 0),__decorate([U(cc.Label)],t.prototype,"allClass",void 0),__decorate([U(cc.Label)],t.prototype,"reserveDescLb",void 0),__decorate([U(cc.Node)],t.prototype,"reserve",void 0),__decorate([U(cc.Node)],t.prototype,"money",void 0),__decorate([U(cc.Node)],t.prototype,"ReelInfo",void 0),__decorate([U(cc.SpriteAtlas)],t.prototype,"loardAtlas",void 0),__decorate([U(cc.Node)],t.prototype,"enemyStep",void 0),__decorate([U(cc.Label)],t.prototype,"curstep",void 0),__decorate([U(cc.Label)],t.prototype,"allstep",void 0),__decorate([U(cc.Node)],t.prototype,"faceBox",void 0),__decorate([U(cc.Node)],t.prototype,"backBox",void 0),__decorate([U(cc.Node)],t.prototype,"faceScrollViewBox",void 0),__decorate([U(cc.Node)],t.prototype,"faceitem",void 0),__decorate([U(cc.EditBox)],t.prototype,"ebox1",void 0),__decorate([U(cc.EditBox)],t.prototype,"ebox2",void 0),__decorate([U(cc.EditBox)],t.prototype,"ebox12",void 0),__decorate([U(cc.EditBox)],t.prototype,"ebox22",void 0),__decorate([U(cc.Node)],t.prototype,"eboxbtn",void 0),__decorate([U(cc.Sprite)],t.prototype,"speedBtn",void 0),__decorate([U(cc.Node)],t.prototype,"slinkBtn",void 0),__decorate([U(cc.SpriteAtlas)],t.prototype,"spriteAtlas",void 0),__decorate([U(cc.Node)],t.prototype,"arenaNode",void 0),__decorate([U(cc.Node)],t.prototype,"DialyCopyBossHp",void 0),__decorate([U(cc.Node)],t.prototype,"EquipCopyNode",void 0),__decorate([U(cc.Node)],t.prototype,"hightSkipBtn",void 0),__decorate([U(cc.Node)],t.prototype,"FightNumUp",void 0),__decorate([U(cc.Node)],t.prototype,"ArenaWait",void 0),__decorate([U(cc.Node)],t.prototype,"NodeFightBox",void 0),t=i=__decorate([W],t)}(n.default);i.default=O,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/NumberUtil":"NumberUtil","../../Util/SDKUtils":"SDKUtils","../../Util/Utils":"Utils","../Activity/ActivityController":"ActivityController","../Arena/ArenaController":"ArenaController","../Chapter/ChapterController":"ChapterController","../Chapter/GuanqiaController":"GuanqiaController","../Commons/WindowOpenUtils":"WindowOpenUtils","../DailyCopy/DailyCopyCtrl":"DailyCopyCtrl","../EquipCopy/EquipCopyController":"EquipCopyController","../EquipCopy/EquipCopyEvent":"EquipCopyEvent","../Gamelayer/RoleHead":"RoleHead","../HighLadder/HighLadderController":"HighLadderController","../LoardCrusadeWin/LoardCrusadeCtrl":"LoardCrusadeCtrl","../PlotWin/PlotController":"PlotController","../Role/RoleController":"RoleController","../Role/RoleInfo":"RoleInfo","../Scene/Controller/EntityQiPaoController":"EntityQiPaoController","../Scene/Controller/ServerFightController":"ServerFightController","../Scene/Manager/SceneManager":"SceneManager","../Scene/View/FightView":"FightView","../Status/StatusType":"StatusType","../Tips/OpTipsController":"OpTipsController","../Tips/TipsWinController":"TipsWinController","../TreasureMap/TreasureMapController":"TreasureMapController"}],FightInfo:[function(e,t,i){"use strict";cc._RF.push(t,"29b395kXB9Kvoma1s+EuTvx","FightInfo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../../Core/Window"),o=e("../../Controller/SceneController"),a=e("../../../../Core/GameEventDispatcher"),r=e("../../../Chapter/ChapterController"),s=e("../../../../Core/ConfigsManager"),l=e("../../../../Core/Event"),c=e("../../../WarTeam/MonsterController"),d=e("../../../SandTable/SandTableShow"),p=e("./ListControl"),h=e("./MonsterInfofight_cell"),u=e("../../../../GlobalContext"),f=e("../../../Reel/ReelController"),g=e("../../../Commons/MonsterPreview"),y=e("../../Controller/FightController"),m=e("../../../Commons/RewardUtils"),C=e("../../../../Util/Utils"),v=e("../../../../Core/WindowType"),_=e("../../../Item/ItemIcon"),b=e("../../../../Core/CommonsResManager"),T=e("../../../../Global/GlobalValue"),S=e("../../../Chapter/GuanqiaController"),I=e("./PlayerWealthControl"),w=e("../../../Tips/OpTipsController"),D=e("../../../../Core/Language"),R=e("../../../Status/StatusType"),A=e("../../../OpenWin/OpenWinController"),N=e("../../../Role/RoleInfo"),L=e("../../../Functionicon/FunctionIconController"),E=e("../../../FightResultWin/FightResultTroop"),B=e("../../../../Core/TimeController"),M=e("../../../../Core/LoadManager"),x=e("../../../../Util/SDKUtils"),k=e("../../../Guide/GuideNewController"),P=e("../../../Item/ItemData"),G=e("../../../WarTeam/CardUtils"),F=e("../../../TreasureMap/TreasureMapController"),W=e("../../../Item/ItemWidget"),U=e("../../../Equip/equip/EquipCtrl"),O=cc._decorator,V=O.ccclass,q=O.property,H=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.flower=null,t.com=null,t.toggleContainer=null,t.Myinfo=null,t.recommend=null,t.item=null,t.getIntoFight=null,t.Otherinfo=null,t.Shapanbg=null,t.ToggleBtn=null,t.Step=null,t.CombatCountAll=null,t.Power=null,t.ReelList=null,t.RewardLayout=null,t.myFightNumLabe=null,t.otherContent=null,t.fristBtn=null,t.secondBtn=null,t.TipsImage=null,t.enemyNode=null,t.fightSimulator=null,t.myMonsterInfo=null,t.myFightNum=0,t.tabe=null,t._configs=null,t.isReelWin=!1,t.fightNum=0,t.twoFightNum=0,t.monsters=null,t.arry=[],t.arry1=[],t.grade=[],t.grade1=[],t.twocemonsters=null,t.playerGame=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){this.loadWindowCom=this.hidetitle,this.loadWindowComThis=this,this._configs=s.ConfigsManager.instance.getConfigs("cardConf"),e.prototype.onLoad.call(this),i.instance=this,this.getIntoFight.active="99"==x.default.instance.plat_id},t.prototype.goIntoFightSimulator=function(){a.GameEventDispatcher.instance.emit(l.EventDefiner.ChangeActivityStatus,R.ActivityStatus.FightSimulator),a.GameEventDispatcher.instance.emit(l.EventDefiner.ChangeGameScene,{status:T.GameScene.Fight,guanqiaId:T.GQIdType.TianTi})},t.prototype.hidetitle=function(){var e=cc.find("WindowBg1/Title1",this.node);e&&(e.active=!1)},t.prototype.show=function(){var t=this;switch(e.prototype.show.call(this),u.PlayerData.TopPanel.active=!1,this.Step.node.active=!1,this.index=0,this.node.getChildByName("fightDown").getChildByName("Step").active=!1,this.toggleContainer.children[this.index].getComponent(cc.Toggle).isChecked=!0,this.item.active=this.flower.active=this.enemyNode.active=this.fristBtn.active=this.recommend.active=this.toggleContainer.children[1].active=this.toggleContainer.children[0].getChildByName("Background").active=this.toggleContainer.children[0].getChildByName("checkmark").active=!1,this.getFightInfo({detail:null}),R.ActivityStatus.value){case R.ActivityStatus.Chapter:this.toggleContainer.children[0].getChildByName("icon").getComponent(cc.Sprite).spriteFrame=this.com.getSpriteFrame("i18n_diaoluo"),this.fightSimulator.active="99"==x.default.instance.plat_id,this.item.active=this.flower.active=this.recommend.active=this.fristBtn.active=!0,a.GameEventDispatcher.instance.on(l.EventDefiner.ActivityStatus_GuanQia_Data,this.getFightInfo,this),o.default.instance.requestFightData(2),cc.find("TitleBase/Label",this.node).getComponent(cc.Label).string=r.default.instance.currentChaptername,cc.find("TitleBase/Label01",this.node).getComponent(cc.Label).string=r.default.instance.currentGuanqianame;var i=r.default.instance;this.enemyNode.active=!(i.resetSec&&i.resetSec>i.currentGuanqiaId),1==r.default.instance.currentChapterId&&1==r.default.instance.currentGuanqiaId&&k.default.instance.checkCondition(29);var n=0==r.default.instance.currentChapterId&&0==r.default.instance.currentGuanqiaId;this.Step.node.active=!n,this.node.getChildByName("fightDown").getChildByName("Step").active=!n,k.default.instance.checkCondition(30),M.default.instance.loadResByType(u.GlobalContext.Root+"prefab/Bag/Item",cc.Prefab,function(e){M.default.instance.loadResByType(u.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(e){var i,n=c.default.instance.getRecommendCards();for(var o in n){var a=C.default.getNodeByPool(v.PoolType.ItemIcon,e,u.GlobalContext.Root+"prefab/Bag/ItemIcon");a.name=o,t.item.addChild(a);var r=P.default.creatItem(c.default.instance.baseNews[n[o].cardId].itemID);a.getComponent(_.default).ItemData(r),cc.find("ItemIcon/debris",a).active=!1,i=c.default.instance.GetMonsterInfo(n[o].cardId).cardType,cc.find("icon/icon"+(parseInt(o)+1),t.recommend).getComponent(cc.Sprite).spriteFrame=b.default.instance.getSpriteFrameByName("stance_"+i)}},t)},this);break;case R.ActivityStatus.TreasureMap:this.toggleContainer.children[0].getChildByName("icon").getComponent(cc.Sprite).spriteFrame=this.com.getSpriteFrame("i18n_gailv"),this.fightSimulator.active=!1;var s=F.default.instance.isElite();this.toggleContainer.children[1].active=s,this.toggleContainer.children[0].getChildByName("checkmark").active=this.toggleContainer.children[0].getChildByName("Background").active=!0,this.setOninfo(F.default.instance.getParamId()),F.default.instance.setSaveMonster(),cc.find("TitleBase/Label",this.node).getComponent(cc.Label).string=D.default.getStr("treasure_title_"+F.default.instance.clickNodeData.getNodeType),cc.find("TitleBase/Point",this.node).getComponent(cc.Label).string="",cc.find("TitleBase/Label01",this.node).getComponent(cc.Label).string=""}this.setRewardData(),this.Otherinfo.active=!0,this.otherContent.active=!1,p.default.instance.OpenList(8,this.node);var d=B.default.instance.setTimeout(function(){I.default.instance.setActive(!0),B.default.instance.clearTimeout(d)},this,1e3)},t.prototype.onClickCardNews=function(e){var t=e.target.name,i=c.default.instance.getRecommendCards();i[t]&&G.default.instance.jumpCardInfo(i[t].cardId)},t.prototype.onClickToggle=function(e){var t=parseInt(e.target.name);null!=t&&t==this.index||(this.index=t,this.setRewardData())},t.prototype.setRewardData=function(){var e=this;switch(R.ActivityStatus.value){case R.ActivityStatus.Chapter:var t=r.default.instance.readyPath,i=r.default.instance.checkGuanqiainfobyid(t);i||(t-=1,i=r.default.instance.checkGuanqiainfobyid(t)),this.setRewardShow(i.guanqia.reward);break;case R.ActivityStatus.TreasureMap:var n=F.default.instance;0==this.index?this.setRewardShow(n.clickNodeData.nodeReward):(C.default.setNodeChildDestoryByUrl(this.RewardLayout,"prefab/Bag/ItemIcon"),M.default.instance.loadResByType("prefab/Bag/ItemIcon",cc.Prefab,function(t){for(var i,o=n.treasureData.getCaptureMonsterList,a=0;a<o.length;a++){i=c.default.instance.GetMonsterInfo(o[a].cardid||o[a].id).pieceId;var r=C.default.getNodeByUrl(t,"prefab/Bag/ItemIcon");e.RewardLayout.addChild(r),r.getComponent(_.default).ItemData(P.default.creatItem(i),!0,null,!0),r.getChildByName("ItemIcon").getComponent(W.default).setModel({cardId:o[a].cardid||o[a].id,grade:o[a].grade}),r.attr({index_td:i}),r.scale=.8}},this))}},t.prototype.hide=function(){e.prototype.hide.call(this),u.PlayerData.TopPanel.active=!0,this.node.active=!1,a.GameEventDispatcher.instance.off(l.EventDefiner.ActivityStatus_GuanQia_Data,this.getFightInfo,this),this.isReelWin=!1,this.index=null,C.default.setNodeChildDestoryByUrl(this.RewardLayout,"prefab/Bag/ItemIcon"),C.default.setNodeChildDestoryByUrl(this.item,u.GlobalContext.Root+"prefab/Bag/ItemIcon")},t.prototype.getFightInfo=function(e){var t=this;M.default.instance.loadResByType(u.GlobalContext.Root+"prefab/ChapterMapView/Monsterinfo",cc.Prefab,function(i){var n=c.default.instance.GetWarTeamConfig();for(var a in t.myMonsterInfo=[],t.myFightNum=0,C.default.setNodeChildDestoryByUrl(t.Myinfo,u.GlobalContext.Root+"prefab/ChapterMapView/Monsterinfo"),n){var r=void 0;(r=C.default.getNodeByUrl(i,u.GlobalContext.Root+"prefab/ChapterMapView/Monsterinfo")).y=-10,r.getChildByName("MonsterIcon").scale=.4,t.Myinfo.addChild(r);var s=n[a].id,l=c.default.instance.cardStageData.getCardMaxLevel(n[a].id),d=n[a].level;if(d>0){var p=U.default.instance.data.getEquipEffectAddAttr(n[a].id);d=l<(d+=p[T.AttrType.CardLevel]?p[T.AttrType.CardLevel]:0)?l:d}r.getComponent(h.default).initData(s,d,5)}switch(R.ActivityStatus.value){case R.ActivityStatus.Chapter:e.detail&&2==e.detail.key&&e.detail.data&&e.detail.data.table&&(t.tabe=e.detail.data.table,t.myMonsterInfo=e.detail.data.reserve,t.myFightNum+=o.default.instance.sunFightDataFight(e.detail.data.reserve,e.detail.data.specialMonsters)),e.detail&&e.detail.data&&e.detail.data.table&&2==e.detail.key&&(t.ToggleBtn.active=!0,t.setShapan(e.detail.data.table)),t.setChapterData();break;case R.ActivityStatus.TreasureMap:var f=F.default.instance;t.myFightNum=f.remainFight,t.tabe=f.table,t.setShapan(f.table),t.myFightNumLabe.string=f.remainFight+""}},this)},t.prototype.setOninfo=function(e){var t=S.default.instance.config,i=t.playgames[t.guanqiaconf[e].playgames];for(var n in this.twocemonsters=null,this.arry=[],this.arry1=[],this.grade=[],this.grade1=[],C.default.setNodeChildDestoryByUrl(this.Otherinfo,u.GlobalContext.Root+"prefab/ChapterMapView/Monsterinfo"),C.default.setNodeChildDestoryByUrl(this.otherContent,u.GlobalContext.Root+"prefab/ChapterMapView/Monsterinfo"),i){for(var o in this.monsters=t.monsters[i[0].monsters],i.length>1&&(this.twocemonsters=t.monsters[i[1].monsters]),this.monsters)-1==this.arry.indexOf(this.monsters[o].cardId)&&(this.arry.push(this.monsters[o].cardId),this.grade.push(this.monsters[o].grade));for(var o in this.arry)for(var a in this.monsters)this.arry[o]==this.monsters[a].cardId&&this.grade[o]<this.monsters[a].grade&&(this.grade[o]=this.monsters[a].grade);for(var o in this.twocemonsters)-1==this.arry1.indexOf(this.twocemonsters[o].cardId)&&(this.arry1.push(this.twocemonsters[o].cardId),this.grade1.push(this.twocemonsters[o].grade));for(var o in this.arry1)for(var a in this.twocemonsters)this.arry1[o]==this.twocemonsters[a].cardId&&this.grade1[o]<this.twocemonsters[a].grade&&(this.grade1[o]=this.twocemonsters[a].grade)}this.playerGame=this.arry,this.fightNum=0,this.twoFightNum=0,i.length<=1?(this.fristBtn.active=!1,this.secondBtn.active=!1):(this.fristBtn.active=!0,this.secondBtn.active=!1),this.SetMonsterInfo(this.arry,this.monsters,this.grade,this.Otherinfo);for(n=0;n<this.monsters.length;n++){(l=this.monsters[n].num)||(l=1);var s=y.default.instance.getGQMonsterAttr(e,this.monsters[n].skilllevel,this.monsters[n],1);this.fightNum+=s.GetFight()*l}if(this.twocemonsters){r.default.instance.GuanQiaBoss=this.twocemonsters[this.twocemonsters.length-1];for(n=0;n<this.twocemonsters.length;n++){var l;(l=this.twocemonsters[n].num)||(l=1);s=y.default.instance.getGQMonsterAttr(e,this.twocemonsters[n].skilllevel,this.twocemonsters[n],2);this.twoFightNum+=s.GetFight()*l}this.SetMonsterInfo(this.arry1,this.twocemonsters,this.grade1,this.otherContent)}this.CombatCountAll.string=this.fightNum+""},t.prototype.setChapterData=function(){var e=r.default.instance.checkGuanqiainfobyid(r.default.instance.readyPath).guanqia.id;this.setOninfo(e);var t=S.default.instance.config,i=t.playgames[t.guanqiaconf[e].playgames][0].stepnum;this.Step.string=i,this.myFightNumLabe.string=this.myFightNum+N.MyRoleInfo.Fight+"",this.Power.string=r.default.instance.checkGuanqiainfobyid(r.default.instance.readyPath).guanqia.costEnergy+"",this.setReelinfo()},t.prototype.BtnStart=function(e){switch(this.node.active=!1,this.close(),R.ActivityStatus.value){case R.ActivityStatus.Chapter:a.GameEventDispatcher.instance.emit(l.EventDefiner.PermitEnter);break;case R.ActivityStatus.TreasureMap:F.default.instance.sendReq()}},t.prototype.toggleBtn=function(e,t){(0!=r.default.instance.currentGuanqiaId||R.ActivityStatus.value!=R.ActivityStatus.Chapter)&&this.tabe?(this.Shapanbg.active=!0,this.Shapanbg.parent.active=!0):w.default.instance.ShowMsg(D.default.getStr("\u6682\u65e0\u6c99\u76d8\u6570\u636e"))},t.prototype.setShapan=function(e){var t=this;e?this.Shapanbg&&!this.Shapanbg.getChildByName("SandTableShow")?M.default.instance.loadResByType(u.GlobalContext.Root+"prefab/sandTable/SandTableShow",cc.Prefab,function(i){var n=C.default.getNodeByUrl(i,u.GlobalContext.Root+"prefab/sandTable/SandTableShow");t.Shapanbg.addChild(n),t.Shapanbg.getChildByName("SandTableShow").getComponent(d.default).setSize(.7*t.Shapanbg.width,e)},this):this.Shapanbg.getChildByName("SandTableShow").getComponent(d.default).setSize(.7*this.Shapanbg.width,e):w.default.instance.ShowMsg(D.default.getStr("\u6682\u65e0\u6c99\u76d8\u6570\u636e"))},t.prototype.BtnClose=function(){this.close(),a.GameEventDispatcher.instance.emit(l.EventDefiner.ChapterLoadComplete)},t.prototype.setReelinfo=function(){if(this.node&&this.node.parent&&this.node.active){if(!L.default.instance.checkIsOpenbyWindowtype(v.WindowType.ReelWin))return this.ReelList.active=!1,void(this.TipsImage.active=!0);f.default.instance.ScrollReelInfo();var e=f.default.instance.scrolldata;if(this.ReelList.active=!0,this.TipsImage.active=!1,e&&0!=Object.keys(e).length){this.ReelList.parent.active=!0;for(n=0;n<this.ReelList.childrenCount;n++){var t=this.ReelList.children[n];if(e[n]){t.active=!0;var i=f.default.instance.onGetCardInfoParam1(e[n].scrollid);t.children[0].active=!0,t.children[0].getComponentInChildren(g.default)?t.children[0].getComponentInChildren(g.default).init("monster",i,e[n].grade,"skin"+e[n].grade):c.default.instance.infoPreview(t.children[0],cc.v2(0,-30),i,e[n].grade,.3),t.getChildByName("icon").active=!0,t.getChildByName("di2").getComponentInChildren(cc.Label).string=""+e[n].count,t.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=b.default.instance.getSpriteFrameByName("form_"+e[n].grade),t.getComponent(cc.Sprite).spriteFrame=b.default.instance.getSpriteFrameByName("bg_juanzhou"+this._configs.Card[i].rarity)}else t.active=!1}}else for(var n=0;n<this.ReelList.childrenCount;n++)this.ReelList.children[n].active=!1}},t.prototype.setRewardShow=function(e){var t=this;C.default.setNodeChildDestoryByUrl(this.RewardLayout,"prefab/Bag/ItemIcon"),M.default.instance.loadResByType("prefab/Bag/ItemIcon",cc.Prefab,function(i){t.RewardLayout.parent.parent.getComponent(cc.ScrollView).scrollToLeft();for(var n=m.default.instance.getItemList(e),o=0;o<n.length;o++){var a=C.default.getNodeByUrl(i,"prefab/Bag/ItemIcon");t.RewardLayout.addChild(a),a.getComponent(_.default).ItemData(n[o],!0,null,!0),a.attr({index_td:n[o].id}),a.scale=.8}},this)},t.prototype.onSetContentW=function(e){this.RewardLayout.anchorX=e>5?0:.5,console.log(e,this.RewardLayout.anchorX,this.RewardLayout.x,"==============")},t.prototype.lastFightNum=function(){var e=this;0!=this.myFightNum?A.default.instance.openWindow(v.WindowType.FightResultTroop,function(){E.default.instance.initData(e.myMonsterInfo,e.myFightNum)},this):w.default.instance.ShowMsg(D.default.getStr("\u5361\u724c\u5269\u4f59\u6218\u529b\u4e3a0"))},t.prototype.onClickRecommend=function(){c.default.instance.chapterfirstpassReq()},t.prototype.changeOtherMonster=function(e,t){1==Number(t)?(this.fristBtn.active=!1,this.secondBtn.active=!0,this.CombatCountAll.string=this.twoFightNum+"",this.Otherinfo.active=!1,this.otherContent.active=!0,this.SetMonsterInfo(this.arry,this.monsters,this.grade,this.Otherinfo)):2==Number(t)&&(this.fristBtn.active=!0,this.secondBtn.active=!1,this.Otherinfo.active=!0,this.otherContent.active=!1,this.CombatCountAll.string=this.fightNum+"",this.SetMonsterInfo(this.arry1,this.twocemonsters,this.grade1,this.otherContent))},t.prototype.closeSanTab=function(){this.Shapanbg.active=!1,this.Shapanbg.parent.active=!1},t.prototype.SetMonsterInfo=function(e,t,i,n){var o=r.default.instance.checkGuanqiainfobyid(r.default.instance.readyPath).guanqia.id;M.default.instance.loadResByType(u.GlobalContext.Root+"prefab/ChapterMapView/Monsterinfo",cc.Prefab,function(a){C.default.setNodeChildDestoryByUrl(n,u.GlobalContext.Root+"prefab/ChapterMapView/Monsterinfo");for(var r=0;r<e.length;r++){var s=C.default.getNodeByUrl(a,u.GlobalContext.Root+"prefab/ChapterMapView/Monsterinfo");s.y=-10,n.addChild(s),s.getChildByName("MonsterIcon").scale=.4;var l=t[r].num;l||(l=1);var c=y.default.instance.getGQMonsterAttr(o,t[r].skilllevel,t[r]);s.getComponent(h.default).initData(e[r],t[r].level,i[r],l,!1,c)}},this)},t.instance=null,__decorate([q(cc.Node)],t.prototype,"flower",void 0),__decorate([q(cc.SpriteAtlas)],t.prototype,"com",void 0),__decorate([q(cc.Node)],t.prototype,"toggleContainer",void 0),__decorate([q(cc.Node)],t.prototype,"Myinfo",void 0),__decorate([q(cc.Node)],t.prototype,"recommend",void 0),__decorate([q(cc.Node)],t.prototype,"item",void 0),__decorate([q(cc.Node)],t.prototype,"getIntoFight",void 0),__decorate([q(cc.Node)],t.prototype,"Otherinfo",void 0),__decorate([q(cc.Node)],t.prototype,"Shapanbg",void 0),__decorate([q(cc.Node)],t.prototype,"ToggleBtn",void 0),__decorate([q(cc.Label)],t.prototype,"Step",void 0),__decorate([q(cc.Label)],t.prototype,"CombatCountAll",void 0),__decorate([q(cc.Label)],t.prototype,"Power",void 0),__decorate([q(cc.Node)],t.prototype,"ReelList",void 0),__decorate([q(cc.Node)],t.prototype,"RewardLayout",void 0),__decorate([q(cc.Label)],t.prototype,"myFightNumLabe",void 0),__decorate([q(cc.Node)],t.prototype,"otherContent",void 0),__decorate([q(cc.Node)],t.prototype,"fristBtn",void 0),__decorate([q(cc.Node)],t.prototype,"secondBtn",void 0),__decorate([q(cc.Node)],t.prototype,"TipsImage",void 0),__decorate([q(cc.Node)],t.prototype,"enemyNode",void 0),__decorate([q(cc.Node)],t.prototype,"fightSimulator",void 0),t=i=__decorate([V],t)}(n.default);i.default=H,cc._RF.pop()},{"../../../../Core/CommonsResManager":"CommonsResManager","../../../../Core/ConfigsManager":"ConfigsManager","../../../../Core/Event":"Event","../../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../../Core/Language":"Language","../../../../Core/LoadManager":"LoadManager","../../../../Core/TimeController":"TimeController","../../../../Core/Window":"Window","../../../../Core/WindowType":"WindowType","../../../../Global/GlobalValue":"GlobalValue","../../../../GlobalContext":"GlobalContext","../../../../Util/SDKUtils":"SDKUtils","../../../../Util/Utils":"Utils","../../../Chapter/ChapterController":"ChapterController","../../../Chapter/GuanqiaController":"GuanqiaController","../../../Commons/MonsterPreview":"MonsterPreview","../../../Commons/RewardUtils":"RewardUtils","../../../Equip/equip/EquipCtrl":"EquipCtrl","../../../FightResultWin/FightResultTroop":"FightResultTroop","../../../Functionicon/FunctionIconController":"FunctionIconController","../../../Guide/GuideNewController":"GuideNewController","../../../Item/ItemData":"ItemData","../../../Item/ItemIcon":"ItemIcon","../../../Item/ItemWidget":"ItemWidget","../../../OpenWin/OpenWinController":"OpenWinController","../../../Reel/ReelController":"ReelController","../../../Role/RoleInfo":"RoleInfo","../../../SandTable/SandTableShow":"SandTableShow","../../../Status/StatusType":"StatusType","../../../Tips/OpTipsController":"OpTipsController","../../../TreasureMap/TreasureMapController":"TreasureMapController","../../../WarTeam/CardUtils":"CardUtils","../../../WarTeam/MonsterController":"MonsterController","../../Controller/FightController":"FightController","../../Controller/SceneController":"SceneController","./ListControl":"ListControl","./MonsterInfofight_cell":"MonsterInfofight_cell","./PlayerWealthControl":"PlayerWealthControl"}],FightLog:[function(e,t,i){"use strict";cc._RF.push(t,"c58d98ktIhC6Ig/T/Vp7dkj","FightLog"),Object.defineProperty(i,"__esModule",{value:!0});var n=cc._decorator,o=n.ccclass,a=(n.property,function(){function e(){}return e.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},e=__decorate([o],e)}());i.default=a,cc._RF.pop()},{}],FightReelWin:[function(e,t,i){"use strict";cc._RF.push(t,"7709adeR9lEHaMA8N8y/2ah","FightReelWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./ReelController"),o=e("../../Core/WindowType"),a=e("../../Util/Utils"),r=e("../../Global/GlobalValue"),s=e("../../Core/GameEventDispatcher"),l=e("../../Core/Event"),c=e("../../Core/ConfigsManager"),d=e("../WarTeam/MonsterController"),p=e("../../Core/Widget"),h=e("../../Core/CommonsResManager"),u=e("../Commons/MonsterPreview"),f=e("./ReelClick"),g=e("../../Core/LoadManager"),y=e("../../GlobalContext"),m=cc._decorator,C=m.ccclass,v=m.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ScrollList=null,t.BG=null,t._configs1=null,t._configs=null,t.Is_First=0,t.Scrollnlen=0,t.width=0,t.positionx=0,t.RightA=null,t.LeftA=null,t.oddNumber5=[[-286,-24],[-156,-14],[-26,-4],[104,-14],[241,-24]],t.oddNumber3=[[-156,-14],[-26,-4],[104,-14]],t.oddNumber1=[[-26,-4]],t.evenNumber2=[[-116,-14],[68,-14]],t.evenNumber4=[[-279,-24],[-116,-14],[47,-14],[210,-24]],t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.ScrollListView=this.ScrollList.getComponent(cc.ScrollView),this.Scroll=n.default.instance.data,this._configs=c.ConfigsManager.instance.getConfigs("cardConf"),this._configs1=c.ConfigsManager.instance.getConfigs("scrollconf"),this.BG.y=-y.GlobalContext.UIHeight/2+this.BG.height/2+2},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this),this.ScrollInfo(),s.GameEventDispatcher.instance.on(l.EventDefiner.ReelCountInfo,this.ScrollInfo,this)},t.prototype.hide=function(){e.prototype.hide.call(this),s.GameEventDispatcher.instance.off(l.EventDefiner.ReelCountInfo,this.ScrollInfo,this)},t.prototype.ScrollInfo=function(){var e=this,t=[];for(var i in n.default.instance.ScrollReelInfo(),n.default.instance.scrolldata)0==n.default.instance.scrolldata[i].count&&delete n.default.instance.scrolldata[i];switch(Object.keys(n.default.instance.scrolldata).length?this.node.active=!0:this.node.active=!1,Object.keys(n.default.instance.scrolldata).length){case 1:t=this.oddNumber1;break;case 2:t=this.evenNumber2;break;case 3:t=this.oddNumber3;break;case 4:t=this.evenNumber4;break;case 5:t=this.oddNumber5}a.default.setNodeChildDestoryByUrl(this.ScrollListView.content,y.GlobalContext.Root+"prefab/Reel/ScrollReel"),g.default.instance.loadResByType(y.GlobalContext.Root+"prefab/Reel/ScrollReel",cc.Prefab,function(i){var s=0;for(var l in n.default.instance.scrolldata)if(e.node.active=!0,n.default.instance.scrolldata[l]&&3==n.default.instance.scrolldata[l].type){var c=a.default.getNodeByUrl(i,y.GlobalContext.Root+"prefab/Reel/ScrollReel");cc.find("Image",c).getComponent(cc.Sprite).spriteFrame=h.default.instance.getSpriteFrameByName("bg_juanzhou"+e._configs.Card[e.onGetCardID(n.default.instance.scrolldata[l].scrollid)].rarity),cc.find("icon",c).getComponent(cc.Sprite).spriteFrame=h.default.instance.getSpriteFrameByName("form_"+n.default.instance.scrolldata[l].grade);var p=cc.find("di2/HaveNumber",c).getComponent(cc.Label);p.string=""+n.default.instance.scrolldata[l].count,console.log(p.string,"\u5377\u8f74\u6570\u91cf");var g=cc.find("Model",c),m=e.onGetCardID(n.default.instance.scrolldata[l].scrollid),C=a.default.getNodeByPool(o.PoolType.MonsterPreview,d.default.instance.MonsterPreview);C.setScale(.2),g.addChild(C),C.getComponent(u.default).init("monster",m,n.default.instance.scrolldata[l].grade,r.DEFAULTS_SKIN+n.default.instance.scrolldata[l].grade+"",r.PRIORITY.MONSTER),c.getComponent(f.default).data=n.default.instance.scrolldata[l],c.x=t[s][0],c.y=t[s][1],s++,e.ScrollListView.content.addChild(c)}},this)},t.prototype.onGetCardID=function(e){for(var t=0,i=0;i<this._configs1.scroll[1].length;i++)this._configs1.scroll[1][i].id==e&&(t=this._configs1.scroll[1][i].param1);return t},t.prototype.onGetCardId=function(e){for(var t=0,i=0;i<this._configs1.scroll[1].length;i++)this._configs1.scroll[1][i].param1==e&&(t=this._configs1.scroll[1][i].id);return t},__decorate([v(cc.Node)],t.prototype,"ScrollList",void 0),__decorate([v(cc.Node)],t.prototype,"BG",void 0),t=__decorate([C],t)}(p.default);i.default=_,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/ConfigsManager":"ConfigsManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/LoadManager":"LoadManager","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/MonsterPreview":"MonsterPreview","../WarTeam/MonsterController":"MonsterController","./ReelClick":"ReelClick","./ReelController":"ReelController"}],FightResultBGEffect:[function(e,t,i){"use strict";cc._RF.push(t,"1dd3fqluhxALLj16qFIjdEH","FightResultBGEffect"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("./../FightResultEffect/FightResultEffectLose"),a=e("../../Scene/Manager/SceneManager"),r=e("../../WarTeam/MonsterController"),s=e("./FightResultEffectVic"),l=cc._decorator,c=l.ccclass,d=l.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layerWinBG=null,t.winEffect=null,t.layerLoseBG=null,t.loseEffect=null,t}return __extends(t,e),t.prototype.onInitBGEffect=function(e,t,i,n){void 0===e&&(e=!0),void 0===t&&(t=null),void 0===i&&(i=null),void 0===n&&(n=null),this.layerWinBG.active=a.default.instance.fightresult,this.layerLoseBG.active=!a.default.instance.fightresult;var l=r.default.instance.GetWarTeamConfig();a.default.instance.fightresult?this.winEffect.getComponent(s.default).onInitData(l,e,t,i,n):this.loseEffect.getComponent(o.default).onInitData(l,e,t,i,n)},__decorate([d(cc.Node)],t.prototype,"layerWinBG",void 0),__decorate([d(cc.Node)],t.prototype,"winEffect",void 0),__decorate([d(cc.Node)],t.prototype,"layerLoseBG",void 0),__decorate([d(cc.Node)],t.prototype,"loseEffect",void 0),t=__decorate([c],t)}(n.default);i.default=p,cc._RF.pop()},{"../../../Core/Widget":"Widget","../../Scene/Manager/SceneManager":"SceneManager","../../WarTeam/MonsterController":"MonsterController","./../FightResultEffect/FightResultEffectLose":"FightResultEffectLose","./FightResultEffectVic":"FightResultEffectVic"}],FightResultCombat:[function(e,t,i){"use strict";cc._RF.push(t,"4a014AmSUlE/L44tij/SW4+","FightResultCombat"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/GameEventDispatcher"),a=e("../../Core/Event"),r=e("../Status/StatusType"),s=e("../HighLadder/HighLadderData"),l=e("../HighLadder/HighLadderWin"),c=e("../../Core/CommonsResManager"),d=e("./FightResultExpedition"),p=e("../Role/RoleInfo"),h=cc._decorator,u=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.checkBtn=null,t.combatValue=null,t.hightLadderNode=null,t}return __extends(t,e),t.prototype.initData=function(e){if(void 0===e&&(e=0),r.ActivityStatus.value==r.ActivityStatus.HighLadder){this.node.children[2].active=!1,this.node.children[3].active=!1,this.node.children[4].active=!1,this.hightLadderNode.children[0].active=!0,this.hightLadderNode.children[1].active=!0,this.hightLadderNode.active=!0;var t=l.default.instance.lastRank-s.SelfHighLadderData.ranking;0==l.default.instance.lastRank&&(t=s.SelfHighLadderData.ranking),this.hightLadderNode.children[3].getComponent(cc.Label).string=s.SelfHighLadderData.ranking+"",this.hightLadderNode.children[1].getComponent(cc.Label).string=t+"",t>0?(this.hightLadderNode.children[0].getComponent(cc.Sprite).spriteFrame=c.default.instance.getSpriteFrameByName("icon_shangcheng"),this.hightLadderNode.children[1].color=cc.color(122,255,62),this.hightLadderNode.children[1].getComponent(cc.LabelOutline).color=cc.color(27,99,14)):t<0?(this.hightLadderNode.children[0].getComponent(cc.Sprite).spriteFrame=c.default.instance.getSpriteFrameByName("icon_xiajian"),this.hightLadderNode.children[1].color=cc.color(255,0,0),this.hightLadderNode.children[1].getComponent(cc.LabelOutline).color=cc.color(83,0,0),this.hightLadderNode.children[1].getComponent(cc.Label).string=(t+"").substring(1)):0==t&&(this.hightLadderNode.children[0].active=!1,this.hightLadderNode.children[1].active=!1)}else this.node.children[2].active=!0,this.node.children[3].active=!0,this.node.children[4].active=!0,this.hightLadderNode.active=!1,r.ActivityStatus.value==r.ActivityStatus.TreasureMap?this.combatValue.string=""+e:this.combatValue.string=""+(e+p.MyRoleInfo.Fight)},t.prototype.onClickCheck=function(){r.ActivityStatus.value==r.ActivityStatus.Expedition&&d.default.instance.unschedule(d.default.instance.delayNextFunc),r.ActivityStatus.value==r.ActivityStatus.EquipCopy&&o.GameEventDispatcher.instance.emit(a.EventDefiner.EquipStopNext),o.GameEventDispatcher.instance.emit(a.EventDefiner.CheckCombatPage)},__decorate([f(cc.Node)],t.prototype,"checkBtn",void 0),__decorate([f(cc.Label)],t.prototype,"combatValue",void 0),__decorate([f(cc.Node)],t.prototype,"hightLadderNode",void 0),t=__decorate([u],t)}(n.default);i.default=g,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Widget":"Widget","../HighLadder/HighLadderData":"HighLadderData","../HighLadder/HighLadderWin":"HighLadderWin","../Role/RoleInfo":"RoleInfo","../Status/StatusType":"StatusType","./FightResultExpedition":"FightResultExpedition"}],FightResultCommon:[function(e,t,i){"use strict";cc._RF.push(t,"6175cDWCbBMq4MrULelyt7g","FightResultCommon"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Util/Utils"),a=e("./FightResultEffect/FightResultBGEffect"),r=e("../../Core/LoadManager"),s=e("../../GlobalContext"),l=e("../../Core/WindowManager"),c=e("./FightResultContent"),d=cc._decorator,p=d.ccclass,h=(d.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pageItem=null,t.contentItem=null,t.roleActive=!0,t._callBack=null,t._callBackThis=null,t._callParam=null,t.button=null,t._isContenLoadComplete=!1,t._combatValue=-1,t._remainMonsterList=null,t}return __extends(t,e),t.prototype.onInitResult=function(e,t,i,n,o){void 0===e&&(e=!0),void 0===t&&(t=null),void 0===i&&(i=null),void 0===n&&(n=null),void 0===o&&(o=!1),this.roleActive=e,this._callBack=t,this._callBackThis=i,this._callParam=n,this.node.opacity=1,this._combatValue=-1,this._remainMonsterList=null,this._isContenLoadComplete=!1,r.default.instance.loadResByType(s.GlobalContext.Root+"prefab/FightResult/FightResultBGEffect",cc.Prefab,this.loadComplete,this),o&&r.default.instance.loadResByType(s.GlobalContext.Root+"prefab/FightResult/FightResultContent",cc.Prefab,this.loadContentComplete,this)},t.prototype.loadComplete=function(e){this.node.opacity=255,1!=this.isDestroyed&&(this.pageItem||(this.pageItem=o.default.getNodeByUrl(e,s.GlobalContext.Root+"prefab/FightResult/FightResultBGEffect"),this.node.insertChild(this.pageItem,0),this.pageItem.setPosition(0,0)),this.pageItem.getComponent(a.default).onInitBGEffect(this.roleActive,this._callBack,this._callBackThis,this._callParam))},t.prototype.loadContentComplete=function(e){1!=this.isDestroyed&&(this.contentItem||(this.contentItem=o.default.getNodeByUrl(e,s.GlobalContext.Root+"prefab/FightResult/FightResultContent"),this.node.insertChild(this.contentItem,999),this.contentItem.setPosition(0,0)),this.contentItem.opacity=1,this._isContenLoadComplete=!0,this.onShowContent())},t.prototype.onInitContent=function(e,t){this._combatValue=e,this._remainMonsterList=t,this.onShowContent()},t.prototype.onShowContent=function(){(this._combatValue>=0||this._remainMonsterList)&&this._isContenLoadComplete&&this.contentItem&&(this.contentItem.opacity=255,this.contentItem.getComponent(c.default).onInitData(this._combatValue,this._remainMonsterList))},t.prototype.onClickBtn=function(){l.default.instance.closeWindow(this.node)},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),this._combatValue=0,this._remainMonsterList=null,this._isContenLoadComplete=!1},t.prototype.setContentItemPos=function(e){this.contentItem.setPosition(e)},t=__decorate([p],t)}(n.default));i.default=h,cc._RF.pop()},{"../../Core/LoadManager":"LoadManager","../../Core/Widget":"Widget","../../Core/WindowManager":"WindowManager","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","./FightResultContent":"FightResultContent","./FightResultEffect/FightResultBGEffect":"FightResultBGEffect"}],FightResultContent:[function(e,t,i){"use strict";cc._RF.push(t,"a3a97kN5UtHe7i0ag8bBhyU","FightResultContent"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Item/ItemIcon"),o=e("../../Core/Widget"),a=e("../../Core/GameEventDispatcher"),r=e("../../Core/Event"),s=e("../Scene/Manager/SceneManager"),l=e("../../Core/WindowType"),c=e("../../Util/Utils"),d=e("../WarTeam/MonsterController"),p=e("../Status/StatusType"),h=e("./FightResultCombat"),u=e("../Functionicon/FunctionIconController"),f=e("../Gamelayer/FunctionIconListCell"),g=e("../OpenWin/OpenWinController"),y=e("./FightResultTroop"),m=e("./FightResultEffect/FightResultMonsterEffect"),C=e("../TreasureMap/TreasureMapController"),v=e("../Buff/BuffIcon"),_=e("../../Core/LoadManager"),b=e("../../GlobalContext"),T=e("../Commons/Image"),S=e("../Role/RoleInfo"),I=e("../Role/RoleController"),w=e("../../Core/ConfigsManager"),D=e("../Scene/View/Chapter/ChapterMapView"),R=e("../Chapter/ChapterController"),A=e("../../Global/GlobalValue"),N=e("../TreasureMap/TreasureBuff"),L=e("../../Core/Language"),E=e("../Buff/BuffController"),B=e("../../Core/TimeController"),M=e("../Commons/WindowOpenUtils"),x=cc._decorator,k=x.ccclass,P=x.property,G=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layerTips=null,t.layerTipsContent=null,t.layerCombat=null,t.layerEffect=null,t.layerExp=null,t.progressBar=null,t.labelExp=null,t.commonAtlas=null,t.i18nAtlas=null,t.layerBuffTips=null,t.content=null,t.panel1=null,t.layerTipsContent1=null,t.combatValue=0,t.remainMonsterList=null,t.captureMonsterList=null,t.functionIconInfoType=9,t._onShowExp=null,t._onShowReward=null,t.timeOut=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),a.GameEventDispatcher.instance.on(r.EventDefiner.CheckCombatPage,this.onOpenCombatPage,this),this.layerTips.active=!1,this.layerCombat.active=!1,this.layerEffect.active=!1,this.layerExp.active=!1,this.layerBuffTips.active=!1},t.prototype.hide=function(){e.prototype.hide.call(this);for(var t=this.content.childrenCount-1;t>=0;t--)c.default.setNodeToPool(l.PoolType.CardNews,this.content.children[t])},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),this.onClear(),a.GameEventDispatcher.instance.off(r.EventDefiner.CheckCombatPage,this.onOpenCombatPage,this),s.default.instance.resultShowItemList=[]},t.prototype.onInitData=function(e,t){void 0===e&&(e=0),this.remainMonsterList=t||[],this.captureMonsterList=[],this.combatValue=e,this.onShowPage()},t.prototype.onShowPage=function(){if(this.remainMonsterList&&p.ActivityStatus.value!=p.ActivityStatus.TreasureMap)for(var e=this.remainMonsterList.length,t=0;t<e;t++)if(this.remainMonsterList[t].cardid>0){0==t&&(this.combatValue=0);var i=this.remainMonsterList[t].cardid;this.combatValue+=d.default.instance.getCarFight(i,this.remainMonsterList[t].level||this.remainMonsterList[t].cultivateLv,this.remainMonsterList[t].grade)}switch(p.ActivityStatus.value){case p.ActivityStatus.TreasureMap:C.default.instance.resetCaptureMonster(),this.captureMonsterList=C.default.instance.specialMonsters?C.default.instance.specialMonsters.concat():[];break;case p.ActivityStatus.Chapter:if(this.remainMonsterList)for(t=0;t<this.remainMonsterList.length;t++)this.remainMonsterList[t].type==A.ADD_ACTOR_TYPE.REINFORCEMENTS&&this.captureMonsterList.push(this.remainMonsterList[t])}this.onShowCombat(),this.onShowEffect();var n=null;this.layerTips.getChildByName("spriteLeft").active=this.layerTips.getChildByName("spriteRight").active=this.layerTips.getChildByName("title").active=this.content.active=!1;var o=!1;switch(p.ActivityStatus.value){case p.ActivityStatus.ExpCopy:n=["ui/fightResult/FightResultWin","line_1","i18n_zhanliping"],this.layerTips.getChildByName("spriteTitleLeft").setPosition(186,43),this.layerTips.getChildByName("spriteTitleRight").setPosition(474,43),this.onShowOrNo();break;default:s.default.instance.fightresult?(n=["ui/fightResult/FightResultWin","line_1","i18n_zhanliping"],this.layerTips.getChildByName("spriteTitleLeft").setPosition(186,43),this.layerTips.getChildByName("spriteTitleRight").setPosition(474,43),this.onShowOrNo()):(n=["ui/fightResult/FightResultLose","line_2","i18n_tishenzl","i18n_tuijian"],this.layerTips.getChildByName("spriteTitleLeft").setPosition(166,43),this.layerTips.getChildByName("spriteTitleRight").setPosition(494,43),p.ActivityStatus.value==p.ActivityStatus.MoneyDailyCopy?this.onShowOrNo():this.onShowTips()),this.layerTips.getChildByName("spriteLeft").active=this.layerTips.getChildByName("spriteRight").active=this.layerTips.getChildByName("title").active=this.content.active=o=!s.default.instance.fightresult&&p.ActivityStatus.value==p.ActivityStatus.Chapter}n&&(this.layerTips.getChildByName("spriteTitleLeft").getComponent(T.default).loadSpriteAtlas(b.GlobalContext.Root+n[0],n[1]),this.layerTips.getChildByName("spriteLeft").getComponent(T.default).loadSpriteAtlas(b.GlobalContext.Root+n[0],n[1]),this.layerTips.getChildByName("spriteTitleRight").getComponent(T.default).loadSpriteAtlas(b.GlobalContext.Root+n[0],n[1]),this.layerTips.getChildByName("spriteRight").getComponent(T.default).loadSpriteAtlas(b.GlobalContext.Root+n[0],n[1]),this.layerTips.getChildByName("spriteTitle").getComponent(cc.Sprite).spriteFrame=this.i18nAtlas.getSpriteFrame(n[2]),n[3]&&(this.layerTips.getChildByName("title").getComponent(cc.Sprite).spriteFrame=this.i18nAtlas.getSpriteFrame(n[3]))),this.showContent(o)},t.prototype.showContent=function(e){var t=this;if(e){var i=d.default.instance.getRecommendCards();_.default.instance.loadResByType(b.GlobalContext.Root+"prefab/WarTeam/CardNews",cc.Prefab,function(e){var n;for(var o in i)n=c.default.getNodeByPool(l.PoolType.CardNews,e,b.GlobalContext.Root+"prefab/WarTeam/CardNews"),t.content.addChild(n),n.getComponent("CardNews").setData({id:i[o].cardId,level:i[o].lv},!0)},this)}},t.prototype.onAddBuff=function(e){var t=this;if(p.ActivityStatus.value==p.ActivityStatus.TreasureMap){var i=e>4?this.layerTipsContent:this.layerTipsContent1,n=C.default.instance.getRewardBuffId();n>0&&_.default.instance.loadResByType(b.GlobalContext.Root+"prefab/bufftype/BuffIcon",cc.Prefab,function(e){var o=c.default.getNodeByUrl(e,b.GlobalContext.Root+"prefab/bufftype/BuffIcon");o.getComponent(v.default).onInitData(n),i.addChild(o);var a=E.default.instance.getBuffById(n);a&&o.on(cc.Node.EventType.TOUCH_END,function(){t.onClickBuffIcon(a,1)},t)},this)}},t.prototype.onClickBuffIcon=function(e,t){if(this.layerBuffTips.active)this.layerBuffTips.active=!1;else if(this.layerBuffTips.active=!0,this.layerBuffTips.getChildByName("spriteBuff")&&this.layerBuffTips.getChildByName("spriteBuff").getComponent(N.default)&&this.layerBuffTips.getChildByName("spriteBuff").getComponent(N.default).onInitData(e.buffIcon,t),this.layerBuffTips.getChildByName("labelBuffName")&&(this.layerBuffTips.getChildByName("labelBuffName").getComponent(cc.Label).string=e.buffName+""),this.layerBuffTips.getChildByName("labelDesc")){var i=Math.floor(Math.abs(e.param||e.param1)*t*1e4)/100,n=L.default.getStr1(e.buffDesc,[i]);this.layerBuffTips.getChildByName("labelDesc").getComponent(cc.RichText).string=n}},t.prototype.setRewards=function(){var e=this,t=0;_.default.instance.loadResByType(b.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(i){var o=s.default.instance.resultShowItemList,a=0;p.ActivityStatus.value==p.ActivityStatus.TreasureMap&&(C.default.instance.getRewardBuffId()>0&&a++);var r=o.length+a;e.panel1.active=!0,e.panel1.width=r>4?577:130*r;var d=o.length>4?e.layerTipsContent:e.layerTipsContent1;if(o){e.layerTips.active=o.length>0,e.onClear();e.timeOut=B.default.instance.setInterval(function(){if(t>=o.length)return e.onAddBuff(o.length),void B.default.instance.clearInterval(e.timeOut);var a=c.default.getNodeByPool(l.PoolType.ItemIcon,i,b.GlobalContext.Root+"prefab/Bag/ItemIcon");a.getComponent(n.default).ItemData(o[t],!0,null,!0),a.on("touchstart",e.clickIcon,e),d.addChild(a),t++},e,200),e.onshowTipsPosition()}},this)},t.prototype.onShowEffect=function(){var e,t=this;!s.default.instance.fightresult||this.captureMonsterList.length<1||p.ActivityStatus.value==p.ActivityStatus.TreasureMap?this.layerEffect.active=!1:(this.layerEffect.active=!0,this.layerEffect.childrenCount>0?(e=this.layerEffect.children[0]).getComponent(m.default)&&e.getComponent(m.default).initData(this.captureMonsterList):_.default.instance.loadResByType(b.GlobalContext.Root+"effects/prefabs/FightResult/FightResultMonsterEffect",cc.Prefab,function(i){e=c.default.getNodeByUrl(i,b.GlobalContext.Root+"effects/prefabs/FightResult/FightResultMonsterEffect"),t.layerEffect.addChild(e),e.getComponent(m.default).initData(t.captureMonsterList)},this))},t.prototype.onShowTips=function(){var e=this;this.layerTips.active=!0,this.onClear(),p.ActivityStatus.value==p.ActivityStatus.HighLadder?this.setRewards():(this.panel1.active=!1,_.default.instance.loadResByType(b.GlobalContext.Root+"prefab/FunList/FunList6",cc.Prefab,function(t){var i=u.default.instance.getFunctionIconInfoList(e.functionIconInfoType,!0),n=i.length>5?e.layerTipsContent:e.layerTipsContent1,o=-1,a=function(){if(++o>=i.length)e.unschedule(a);else if(p.ActivityStatus.value==p.ActivityStatus.Chapter||1!=i[o].config.windowType)if(1==i[o].config.windowType&&R.default.instance.currChapterID<=6)a();else{var r=new cc.Node;r.addComponent(cc.Sprite),r.getComponent(cc.Sprite)&&(r.getComponent(cc.Sprite).spriteFrame=e.commonAtlas.getSpriteFrame("bg_bantoudiban")),r.width=100,r.height=100;var s=c.default.getNodeByUrl(t,b.GlobalContext.Root+"prefab/FunList/FunList6");s.attr({index_td:i[o].config}),s.on("touchstart",e.linkidDeal,e),s.getComponent(f.default).initScene(i[o],!0,!1),r.addChild(s),n.addChild(r)}else a()};e.schedule(a,0,i.length,0)},this)),this.onshowTipsPosition()},t.prototype.onshowTipsPosition=function(){p.ActivityStatus.value!=p.ActivityStatus.EquipCopy||s.default.instance.fightresult?this.layerTips.y=0:this.layerTips.y=-175},t.prototype.onShowCombat=function(){var e=this;if(this.remainMonsterList&&!(this.remainMonsterList.length<1)||p.ActivityStatus.value==p.ActivityStatus.HighLadder){var t=null;this.layerCombat.children.length>0?(t=this.layerCombat.children[0]).getComponent(h.default).initData(this.combatValue):_.default.instance.loadResByType(b.GlobalContext.Root+"prefab/FightResult/FightResultCombat",cc.Prefab,function(i){t=c.default.getNodeByUrl(i,b.GlobalContext.Root+"prefab/FightResult/FightResultCombat"),e.layerCombat.addChild(t),t.getComponent(h.default).initData(e.combatValue)},this),p.ActivityStatus.value==p.ActivityStatus.HighLadder?this.layerCombat.active=!0:this.layerCombat.active=s.default.instance.fightresult}},t.prototype.onOpenCombatPage=function(){var e=this;g.default.instance.openWindow(l.WindowType.FightResultTroop,function(){y.default.instance.initData(e.remainMonsterList,e.combatValue,e.captureMonsterList)},this)},t.prototype.onShowExp=function(){if(!(s.default.instance.resultShowItemList.length<1)){var e=0,t=w.ConfigsManager.instance.getConfigs("levelconf");d.MonsterType.oldRoleInfo&&(S.MyRoleInfo.level!=d.MonsterType.oldRoleInfo.level||S.MyRoleInfo.exp<I.default.instance.expAgo&&S.MyRoleInfo.level>0)&&t.LevelConf[S.MyRoleInfo.level-1]&&(e=t.LevelConf[S.MyRoleInfo.level-1].exp),S.MyRoleInfo.exp+e-I.default.instance.expAgo>0&&(this.layerExp.active=!0),this.progressBar.getComponent(cc.ProgressBar).progress=S.MyRoleInfo.level>0?S.MyRoleInfo.exp/t.LevelConf[S.MyRoleInfo.level].exp:0,this.progressBar.getChildByName("Label").getComponent(cc.Label).string=S.MyRoleInfo.exp+"/"+t.LevelConf[S.MyRoleInfo.level].exp,this.labelExp.getComponent(cc.Label).string="+"+(S.MyRoleInfo.exp+e-I.default.instance.expAgo)+"Exp",I.default.instance.onSetOldExp()}},t.prototype.onShowOrNo=function(){switch(p.ActivityStatus.value){case p.ActivityStatus.Arena:break;case p.ActivityStatus.TreasureMap:case p.ActivityStatus.EquipCopy:case p.ActivityStatus.TotemsCopy:case p.ActivityStatus.HighLadder:case p.ActivityStatus.MoneyDailyCopy:case p.ActivityStatus.RefineDailyCopy:case p.ActivityStatus.GemDailyCopy:case p.ActivityStatus.ArtifactDailyCopy:this.setRewards();break;default:this.setRewards(),this.onShowExp()}},t.prototype.onClear=function(){for(var e=this.layerTipsContent1.childrenCount-1;e>=0;e--){this.layerTipsContent1.children[e].getComponent(n.default)&&c.default.setNodeToPool(l.PoolType.ItemIcon,this.layerTipsContent1.children[e])}c.default.setNodeChildDestoryByUrl(this.layerTipsContent1,b.GlobalContext.Root+"prefab/FunList/FunList6");for(e=this.layerTipsContent.childrenCount-1;e>=0;e--){this.layerTipsContent.children[e].getComponent(n.default)&&c.default.setNodeToPool(l.PoolType.ItemIcon,this.layerTipsContent.children[e])}c.default.setNodeChildDestoryByUrl(this.layerTipsContent,b.GlobalContext.Root+"prefab/FunList/FunList6")},t.prototype.linkidDeal=function(e){e.currentTarget.index_td.windowType&&(1==e.currentTarget.index_td.windowType?D.default.instance.onOpenResetChapter():g.default.instance.openWindow(e.currentTarget.index_td.windowType)),a.GameEventDispatcher.instance.emit(r.EventDefiner.FightResultTipClick)},t.prototype.clickIcon=function(){a.GameEventDispatcher.instance.emit(r.EventDefiner.FightResultIconClick),this.layerBuffTips.active&&(this.layerBuffTips.active=!1)},t.prototype.openDamageWin=function(){M.default.instance.openWindowType(l.WindowType.FightDamageWin)},__decorate([P(cc.Node)],t.prototype,"layerTips",void 0),__decorate([P(cc.Node)],t.prototype,"layerTipsContent",void 0),__decorate([P(cc.Node)],t.prototype,"layerCombat",void 0),__decorate([P(cc.Node)],t.prototype,"layerEffect",void 0),__decorate([P(cc.Node)],t.prototype,"layerExp",void 0),__decorate([P(cc.Node)],t.prototype,"progressBar",void 0),__decorate([P(cc.Node)],t.prototype,"labelExp",void 0),__decorate([P(cc.SpriteAtlas)],t.prototype,"commonAtlas",void 0),__decorate([P(cc.SpriteAtlas)],t.prototype,"i18nAtlas",void 0),__decorate([P(cc.Node)],t.prototype,"layerBuffTips",void 0),__decorate([P(cc.Node)],t.prototype,"content",void 0),__decorate([P(cc.Node)],t.prototype,"panel1",void 0),__decorate([P(cc.Node)],t.prototype,"layerTipsContent1",void 0),t=__decorate([k],t)}(o.default);i.default=G,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Buff/BuffController":"BuffController","../Buff/BuffIcon":"BuffIcon","../Chapter/ChapterController":"ChapterController","../Commons/Image":"Image","../Commons/WindowOpenUtils":"WindowOpenUtils","../Functionicon/FunctionIconController":"FunctionIconController","../Gamelayer/FunctionIconListCell":"FunctionIconListCell","../Item/ItemIcon":"ItemIcon","../OpenWin/OpenWinController":"OpenWinController","../Role/RoleController":"RoleController","../Role/RoleInfo":"RoleInfo","../Scene/Manager/SceneManager":"SceneManager","../Scene/View/Chapter/ChapterMapView":"ChapterMapView","../Status/StatusType":"StatusType","../TreasureMap/TreasureBuff":"TreasureBuff","../TreasureMap/TreasureMapController":"TreasureMapController","../WarTeam/MonsterController":"MonsterController","./FightResultCombat":"FightResultCombat","./FightResultEffect/FightResultMonsterEffect":"FightResultMonsterEffect","./FightResultTroop":"FightResultTroop"}],FightResultDailyCopy:[function(e,t,i){"use strict";cc._RF.push(t,"ff053dxTUJPxrvKqacMTZvX","FightResultDailyCopy"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/GameEventDispatcher"),o=e("../../Core/Event"),a=e("../Scene/Manager/SceneManager"),r=e("../Sound/SoundController"),s=e("../Status/StatusController"),l=e("../Status/StatusType"),c=e("./FightResultCommon"),d=e("../../Core/Language"),p=e("../Guide/GuideNewController"),h=cc._decorator,u=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layerClose=null,t.layerBtn=null,t.remainCD=5,t.delayCloseFunc=null,t.combatValue=0,t.remainMonsterList=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.show=function(){e.prototype.show.call(this),r.default.instance.PlayEffect(a.default.instance.fightresult?r.SoundType.fightWin:r.SoundType.fightLose),n.GameEventDispatcher.instance.on(o.EventDefiner.FightResultTipClick,this.onClickTips,this),this.layerClose.active=!1,this.layerBtn.active=!1,this.unschedule(this.delayCloseFunc),this.onInitResult(!0,this.onShowPage,this,null,!0)},t.prototype.hide=function(){e.prototype.hide.call(this),r.default.instance.StopEffectByType(a.default.instance.fightresult?r.SoundType.fightWin:r.SoundType.fightLose),this.unschedule(this.delayCloseFunc),n.GameEventDispatcher.instance.off(o.EventDefiner.FightResultTipClick,this.onClickTips,this)},t.prototype.onInitData=function(e,t){void 0===e&&(e=0),this.remainMonsterList=t,this.combatValue=e},t.prototype.onShowPage=function(){this.onInitContent(this.combatValue,this.remainMonsterList),this.layerClose.active=!0,this.layerBtn.active=a.default.instance.fightresult,a.default.instance.fightresult?this.onClickTips():this.onDelayClose()},t.prototype.onExitPage=function(){this.onClickBtn(),s.default.instance.activityStatusHandle(),l.ActivityStatus.value==l.ActivityStatus.ArtifactDailyCopy&&(p.default.instance.checkCondition(32),console.log("\u5f15\u5bfc32\u89e6\u53d1\u3002\u3002\u3002\u3002\u3002\u3002\u3002\u3002\u3002\u3002\u3002\u3002\u3002\u3002\u3002"))},t.prototype.onDelayClose=function(){var e=this,t=1;this.layerClose.active=!0;var i=this.layerClose.getChildByName("labelTips").getComponent(cc.Label);this.delayCloseFunc=function(){t>=e.remainCD?e.onExitPage():(i.string=d.default.getStr("fight_result_delay_close",e.remainCD-t),t++)},this.schedule(this.delayCloseFunc,1,this.remainCD)},t.prototype.onClickTips=function(){this.unschedule(this.delayCloseFunc),this.layerClose.getChildByName("labelTips").getComponent(cc.Label).string=d.default.getStr("fight_result_close")},t.instance=null,__decorate([f(cc.Node)],t.prototype,"layerClose",void 0),__decorate([f(cc.Node)],t.prototype,"layerBtn",void 0),t=i=__decorate([u],t)}(c.default);i.default=g,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../Guide/GuideNewController":"GuideNewController","../Scene/Manager/SceneManager":"SceneManager","../Sound/SoundController":"SoundController","../Status/StatusController":"StatusController","../Status/StatusType":"StatusType","./FightResultCommon":"FightResultCommon"}],FightResultEffectLose:[function(e,t,i){"use strict";cc._RF.push(t,"b6ca9V169lN+qLBBO6zT2zd","FightResultEffectLose"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Util/Utils"),a=e("../../../Core/WindowType"),r=e("../../Commons/MonsterPreview"),s=e("../../../Global/GlobalValue"),l=e("../../WarTeam/MonsterController"),c=e("../../../Core/TimeController"),d=e("../../Role/RoleInfo"),p=cc._decorator,h=p.ccclass,u=p.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.monsertList=[],t.animationList=[],t.roleSexPic=[],t._callBack=null,t._callBackThis=null,t._callParam=null,t.monsterList=null,t}return __extends(t,e),t.prototype.onInitData=function(e,t,i,n,o){void 0===t&&(t=!0),void 0===i&&(i=null),void 0===n&&(n=null),void 0===o&&(o=null),this.monsterList=e,this._callBack=i,this._callBackThis=n,this._callParam=o,this.monsterList=e,this.animationList[0].on("finished",this.onFirstFinish,this),this.animationList[1].on("finished",this.onSecondFinish,this),this.roleSexPic[0].active=0==d.MyRoleInfo.sex&&t,this.roleSexPic[1].active=0!=d.MyRoleInfo.sex&&t,this.onPlayerEffect()},t.prototype.onPlayerEffect=function(){var e=this;this.animationList[0].play("jiesuan-f"),this.animationList[0].node.opacity=1,c.default.instance.setTimeout(function(){e.animationList[0].node.opacity=255},this,1),this.animationList[1].stop(),this.animationList[1].node.active=!1},t.prototype.onFirstFinish=function(){var e=this;this.animationList[1].play("lost-ui"),this.animationList[1].node.active=!0,this.animationList[1].node.opacity=1,c.default.instance.setTimeout(function(){e.animationList[1].node.opacity=255},this,1)},t.prototype.onSecondFinish=function(){this.animationList[1].stop(),this.createMonster(),this._callBack&&this._callBack.apply(this._callBackThis,this._callParam)},t.prototype.createMonster=function(){for(var e in this.monsterList){if(Number(e)>=3)break;var t=this.monsterList[e],i=o.default.getNodeByPool(a.PoolType.MonsterPreview,l.default.instance.MonsterPreview);i.setScale(.85-.05*Number(e)),i.getComponent(r.default).init("monster",t.id,1,s.DEFAULTS_SKIN+1,s.PRIORITY.MONSTER,!1,s.ACTION.STAND,1,1),i.width=100,this.monsertList[e].addChild(i)}},t.prototype.onClear=function(){for(var e=this.monsertList.length-1;e>=0;e--)this.monsertList[e]&&this.monsertList[e].childrenCount>0&&o.default.setNodeToPool(a.PoolType.MonsterPreview,this.monsertList[e].children[0]);this.animationList[0].stop(),this.animationList[1].stop()},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),this.onClear()},__decorate([u([cc.Node])],t.prototype,"monsertList",void 0),__decorate([u([cc.Animation])],t.prototype,"animationList",void 0),__decorate([u([cc.Node])],t.prototype,"roleSexPic",void 0),t=__decorate([h],t)}(n.default);i.default=f,cc._RF.pop()},{"../../../Core/TimeController":"TimeController","../../../Core/Widget":"Widget","../../../Core/WindowType":"WindowType","../../../Global/GlobalValue":"GlobalValue","../../../Util/Utils":"Utils","../../Commons/MonsterPreview":"MonsterPreview","../../Role/RoleInfo":"RoleInfo","../../WarTeam/MonsterController":"MonsterController"}],FightResultEffectVic:[function(e,t,i){"use strict";cc._RF.push(t,"d3777HOqOxB27odX8QkC82l","FightResultEffectVic"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Role/RoleInfo"),o=e("../../../Core/TimeController"),a=e("../../../Core/Widget"),r=e("../../../Util/Utils"),s=e("../../../Core/WindowType"),l=e("../../Commons/MonsterPreview"),c=e("../../../Global/GlobalValue"),d=e("../../WarTeam/MonsterController"),p=e("../../../GlobalContext"),h=cc._decorator,u=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.monsertList=[],t.animationList=[],t.roleSexPic=[],t.nodeMagicBottom=null,t.mofazhen=null,t._callBack=null,t._callBackThis=null,t._callParam=null,t.monsterList=null,t}return __extends(t,e),t.prototype.onInitData=function(e,t,i,o,a){void 0===t&&(t=!0),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),this.monsterList=e,this._callBack=i,this._callBackThis=o,this._callParam=a,this.animationList[0].on("finished",this.onFirstFinish,this),this.animationList[1].on("finished",this.onSecondFinish,this),this.roleSexPic[0].active=0==n.MyRoleInfo.sex&&t,this.roleSexPic[1].active=0!=n.MyRoleInfo.sex&&t,this.nodeMagicBottom.active=t,this.onPlayerEffect()},t.prototype.show=function(){e.prototype.show.call(this),r.default.setImage(this.mofazhen.node,p.GlobalContext.ResRoot+"resources/FightResult/bg_jsfazhen.png")},t.prototype.onPlayerEffect=function(){var e=this;this.animationList[0].play("jiesuan-v"),this.animationList[0].node.opacity=1,o.default.instance.setTimeout(function(){e.animationList[0].node.opacity=255},this,1),this.animationList[1].stop(),this.animationList[1].node.active=!1},t.prototype.onFirstFinish=function(){var e=this;this.animationList[1].play("vicory-ui"),this.animationList[1].node.active=!0,this.animationList[1].node.opacity=1,o.default.instance.setTimeout(function(){e.animationList[1].node.opacity=255},this,1)},t.prototype.onSecondFinish=function(){this.animationList[1].stop(),this.createMonster(),this._callBack&&this._callBack.apply(this._callBackThis,this._callParam)},t.prototype.createMonster=function(){for(var e in this.monsterList){if(Number(e)>=3)break;var t=this.monsterList[e],i=r.default.getNodeByPool(s.PoolType.MonsterPreview,d.default.instance.MonsterPreview);i.setScale(.85-.05*Number(e)),i.getComponent(l.default).init("monster",t.id,1,c.DEFAULTS_SKIN+1,c.PRIORITY.MONSTER,!1,c.ACTION.STAND,1,1),i.width=100,this.monsertList[e].addChild(i)}},t.prototype.onClear=function(){for(var e=this.monsertList.length-1;e>=0;e--)this.monsertList[e]&&this.monsertList[e].childrenCount>0&&r.default.setNodeToPool(s.PoolType.MonsterPreview,this.monsertList[e].children[0]);this.animationList[0].stop(),this.animationList[1].stop()},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),this.onClear()},__decorate([f([cc.Node])],t.prototype,"monsertList",void 0),__decorate([f([cc.Animation])],t.prototype,"animationList",void 0),__decorate([f([cc.Node])],t.prototype,"roleSexPic",void 0),__decorate([f(cc.Node)],t.prototype,"nodeMagicBottom",void 0),__decorate([f(cc.Mask)],t.prototype,"mofazhen",void 0),t=__decorate([u],t)}(a.default);i.default=g,cc._RF.pop()},{"../../../Core/TimeController":"TimeController","../../../Core/Widget":"Widget","../../../Core/WindowType":"WindowType","../../../Global/GlobalValue":"GlobalValue","../../../GlobalContext":"GlobalContext","../../../Util/Utils":"Utils","../../Commons/MonsterPreview":"MonsterPreview","../../Role/RoleInfo":"RoleInfo","../../WarTeam/MonsterController":"MonsterController"}],FightResultEquipCopy:[function(e,t,i){"use strict";cc._RF.push(t,"642fd5tGhVL/J9P/JGtb3zW","FightResultEquipCopy"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Scene/Manager/SceneManager"),o=e("../Sound/SoundController"),a=e("../../Core/WindowManager"),r=e("../../Core/WindowType"),s=e("../Status/StatusController"),l=e("../../Core/Language"),c=e("./FightResultCommon"),d=e("../EquipCopy/EquipCopyController"),p=e("../Guide/GuideNewController"),h=e("../SandTable/SandTableController"),u=e("../Tips/OpTipsController"),f=e("../../Core/GameEventDispatcher"),g=e("../../Core/Event"),y=cc._decorator,m=y.ccclass,C=y.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.labelDesc=null,t.layerTips=null,t.layerEquip=null,t.combatValue=0,t.remainMonsterList=null,t.nextCD=5,t.delayNextFunc=null,t.levelNum=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.show=function(){e.prototype.show.call(this),this.layerEquip.active=!1,o.default.instance.PlayEffect(n.default.instance.fightresult?o.SoundType.fightWin:o.SoundType.fightLose),this.layerTips.active=!1,f.GameEventDispatcher.instance.on(g.EventDefiner.EquipStopNext,this.stopNext,this),f.GameEventDispatcher.instance.on(g.EventDefiner.FightResultIconClick,this.clickIcon,this),this.unschedule(this.delayNextFunc),this.onInitResult(!0,this.onShowPage,this,null,!0)},t.prototype.hide=function(){e.prototype.hide.call(this),o.default.instance.StopEffectByType(n.default.instance.fightresult?o.SoundType.fightWin:o.SoundType.fightLose),this.levelNum=null,f.GameEventDispatcher.instance.off(g.EventDefiner.EquipStopNext,this.stopNext,this),f.GameEventDispatcher.instance.off(g.EventDefiner.FightResultIconClick,this.clickIcon,this),this.unschedule(this.delayNextFunc)},t.prototype.onInitData=function(e,t){void 0===e&&(e=0),this.remainMonsterList=t,this.combatValue=e},t.prototype.onShowPage=function(){if(this.onInitContent(this.combatValue,this.remainMonsterList),n.default.instance.fightresult){var e=d.default.instance.equipData.equipCopyMainData.currentLevel+"";switch(this.levelNum=Number(e.substring(e.length-1)),this.levelNum){case 1:case 2:case 6:case 7:this.layerEquip.active=!0,this.onTimeNext()}}else{this.layerTips.active=!0;var t=d.default.instance.getLevelCondition;this.labelDesc.string=l.default.getStr("equipcopy_condition_"+t.conditionType,t.conditionParam)}},t.prototype.onBtnNext=function(){d.default.instance.equipData.equipCopyMainData.challengeCount>0?(a.default.instance.close(r.WindowType.FightResultEquipCopy),s.default.instance.activityStatusHandle(!0,!0)):u.default.instance.ShowMsg(l.default.getStr("equipcopy_enter_error_1"))},t.prototype.onTimeNext=function(){var e=this,t=1,i=this.layerEquip.getChildByName("nextLabel").getComponent(cc.Label);this.delayNextFunc=function(){if(t>=e.nextCD)return h.default.instance.autoPlay=!0,void e.onBtnNext();i.string=l.default.getStr("fight_next",e.nextCD-t),t++},this.schedule(this.delayNextFunc,1,5)},t.prototype.onClosePage=function(){a.default.instance.close(r.WindowType.FightResultEquipCopy),s.default.instance.activityStatusHandle(!0),p.default.instance.checkCondition(5)},t.prototype.stopNext=function(){this.unschedule(this.delayNextFunc)},t.prototype.clickIcon=function(){this.unschedule(this.delayNextFunc)},t.instance=null,__decorate([C(cc.RichText)],t.prototype,"labelDesc",void 0),__decorate([C(cc.Node)],t.prototype,"layerTips",void 0),__decorate([C(cc.Node)],t.prototype,"layerEquip",void 0),t=i=__decorate([m],t)}(c.default);i.default=v,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../EquipCopy/EquipCopyController":"EquipCopyController","../Guide/GuideNewController":"GuideNewController","../SandTable/SandTableController":"SandTableController","../Scene/Manager/SceneManager":"SceneManager","../Sound/SoundController":"SoundController","../Status/StatusController":"StatusController","../Tips/OpTipsController":"OpTipsController","./FightResultCommon":"FightResultCommon"}],FightResultExpedition:[function(e,t,i){"use strict";cc._RF.push(t,"80f78eWbMJNm6rG5xuxuOWc","FightResultExpedition"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Scene/Manager/SceneManager"),o=e("../Sound/SoundController"),a=e("./FightResultCommon"),r=e("../../Core/Language"),s=e("../Status/StatusController"),l=e("../../Core/GameEventDispatcher"),c=e("../../Core/Event"),d=e("../SandTable/SandTableController"),p=e("../Status/StatusType"),h=e("../TotemsCopy/TotemsCopyUtils"),u=e("../ExpCopy/ExpCopyUtils"),f=e("../Guide/GuideNewController"),g=e("../Expedition/ExpeditionConfig"),y=cc._decorator,m=y.ccclass,C=y.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layerClose=null,t.layerBtn=null,t.nextBtn=null,t.btnRepeat=null,t.remainCD=5,t.delayCloseFunc=null,t.nextCD=5,t.delayNextFunc=null,t.combatValue=0,t.remainMonsterList=null,t.canEnd=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.show=function(){e.prototype.show.call(this),o.default.instance.PlayEffect(n.default.instance.fightresult?o.SoundType.fightWin:o.SoundType.fightLose),l.GameEventDispatcher.instance.on(c.EventDefiner.FightResultIconClick,this.clickIcon,this),this.layerClose.active=!1,this.layerBtn.active=!1,this.unschedule(this.delayCloseFunc),this.unschedule(this.delayNextFunc),this.onInitResult(!0,this.onShowPage,this,null,!0)},t.prototype.hide=function(){e.prototype.hide.call(this),o.default.instance.StopEffectByType(n.default.instance.fightresult?o.SoundType.fightWin:o.SoundType.fightLose),this.canEnd=null,this.unschedule(this.delayCloseFunc),this.unschedule(this.delayNextFunc),l.GameEventDispatcher.instance.off(c.EventDefiner.FightResultIconClick,this.clickIcon,this)},t.prototype.onInitData=function(e,t,i){void 0===e&&(e=0),void 0===i&&(i=!1),this.remainMonsterList=t,this.combatValue=e,i&&(this.canEnd=!0)},t.prototype.onShowPage=function(){this.btnRepeat.active=!1,this.onInitContent(this.combatValue,this.remainMonsterList),this.layerBtn.active=n.default.instance.fightresult,n.default.instance.fightresult?this.onClickTips():this.onDelayClose(),p.ActivityStatus.value==p.ActivityStatus.TotemsCopy&&(this.nextBtn.active=!h.TotemsCopyUtils.isMaxLayer(),this.layerBtn.getChildByName("nextLabel").active=!h.TotemsCopyUtils.isMaxLayer()),p.ActivityStatus.value==p.ActivityStatus.ExpCopy&&(this.btnRepeat.active=!0,this.nextBtn.active=!u.ExpCopyUtils.isMaxLayer(),this.layerBtn.getChildByName("nextLabel").active=!1)},t.prototype.onExitPage=function(){s.default.instance.activityStatusHandle(!0),p.ActivityStatus.value==p.ActivityStatus.TotemsCopy&&f.default.instance.checkCondition(6)},t.prototype.onRepeat=function(){s.default.instance.activityStatusHandle(!0,!1,!0)},t.prototype.onBtnNext=function(){p.ActivityStatus.value==p.ActivityStatus.ExpCopy&&u.ExpCopyUtils.isMaxLayer()||s.default.instance.activityStatusHandle(!0,!0)},t.prototype.onDelayClose=function(){this.layerClose.active=!0,this.layerClose.getChildByName("labelTips").getComponent(cc.Label).string=r.default.getStr("fight_result_close")},t.prototype.onClickTips=function(){var e=this;if(this.layerClose.getChildByName("labelTips").getComponent(cc.Label).string=r.default.getStr("fight_result_close"),console.log("---------------------------------\u5df2\u901a\u5173--------------------------------------------"),p.ActivityStatus.value==p.ActivityStatus.Expedition&&150==g.ExpeditionConfig.ExpeditionInfor.current)return this.nextBtn.active=!1,void(this.layerBtn.getChildByName("nextLabel").active=!1);if(p.ActivityStatus.value!=p.ActivityStatus.ExpCopy){var t=1,i=this.layerBtn.getChildByName("nextLabel").getComponent(cc.Label);i.string=r.default.getStr("fight_next",this.nextCD),this.delayNextFunc=function(){return e.canEnd?(i.string="",e.canEnd=!1,void e.unschedule(e.delayNextFunc)):t>=e.nextCD?(d.default.instance.autoPlay=!0,void e.onBtnNext()):(i.string=r.default.getStr("fight_next",e.nextCD-t),void t++)},this.schedule(this.delayNextFunc,1,5)}},t.prototype.clickIcon=function(){this.unschedule(this.delayCloseFunc),this.unschedule(this.delayNextFunc)},t.instance=null,__decorate([C(cc.Node)],t.prototype,"layerClose",void 0),__decorate([C(cc.Node)],t.prototype,"layerBtn",void 0),__decorate([C(cc.Node)],t.prototype,"nextBtn",void 0),__decorate([C(cc.Node)],t.prototype,"btnRepeat",void 0),t=i=__decorate([m],t)}(a.default);i.default=v,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../ExpCopy/ExpCopyUtils":"ExpCopyUtils","../Expedition/ExpeditionConfig":"ExpeditionConfig","../Guide/GuideNewController":"GuideNewController","../SandTable/SandTableController":"SandTableController","../Scene/Manager/SceneManager":"SceneManager","../Sound/SoundController":"SoundController","../Status/StatusController":"StatusController","../Status/StatusType":"StatusType","../TotemsCopy/TotemsCopyUtils":"TotemsCopyUtils","./FightResultCommon":"FightResultCommon"}],FightResultMonsterEffect:[function(e,t,i){"use strict";cc._RF.push(t,"628d8PO2iJOB7GHcspVOxxM","FightResultMonsterEffect"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Util/Utils"),a=e("../../../Core/WindowType"),r=e("../../Commons/MonsterPreview"),s=e("../../../Global/GlobalValue"),l=e("../../WarTeam/MonsterController"),c=e("../../../Core/TimeController"),d=cc._decorator,p=d.ccclass,h=d.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.monsterOne=null,t.monsterSecond=null,t.animationOne=null,t.animationSecond=null,t.animationThirth=null,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this),this.animationOne.on("finished",this.onOneFinish,this),this.animationSecond.on("finished",this.onSecondFinish,this)},t.prototype.show=function(){e.prototype.show.call(this),this.onOnePlay()},t.prototype.onOnePlay=function(){var e=this;this.animationOne.node.active=!0,this.animationOne.playAdditive("jiesuan"),this.animationSecond.stop(),this.animationSecond.node.active=!1,c.default.instance.setTimeout(function(){e.onSecondPlay()},this,600)},t.prototype.onSecondPlay=function(){var e=this;this.animationSecond.node.active=!0,this.animationSecond.playAdditive("glow_02"),c.default.instance.setTimeout(function(){e.onThirthPlay()},this,100)},t.prototype.onOneFinish=function(){this.animationOne.stop(),this.animationOne.node.active=!1},t.prototype.onSecondFinish=function(){this.animationSecond.stop(),this.animationSecond.node.active=!1},t.prototype.onThirthPlay=function(){this.animationThirth.active=!0,this.animationThirth.setPosition(0,284);var e=[cc.v2(0,0),cc.v2(280,-250),cc.v2(280,-500)],t=cc.bezierBy(1,e),i=cc.callFunc(function(){this.animationThirth.active=!1},this),n=cc.sequence(t,i);this.animationThirth.runAction(n)},t.prototype.initData=function(e){var t=e.concat();t.length>2&&(t=t.slice(0,2)),this.monsterOne.removeAllChildren(),this.monsterSecond.removeAllChildren();for(var i=0;i<t.length;i++)if(t[i].id||t[i].cardid){var n=o.default.getNodeByPool(a.PoolType.MonsterPreview,l.default.instance.MonsterPreview);n.setScale(.8),0==i?this.monsterOne.addChild(n):this.monsterSecond.addChild(n),n.getComponent(r.default).init("monster",t[i].id||t[i].cardid,t[i].grade,s.DEFAULTS_SKIN+t[i].grade+"",s.PRIORITY.MONSTER)}},t.prototype.onClear=function(){this.monsterOne&&this.monsterOne.childrenCount>0&&o.default.setNodeToPool(a.PoolType.MonsterPreview,this.monsterOne.children[0]),this.monsterSecond&&this.monsterSecond.childrenCount>0&&o.default.setNodeToPool(a.PoolType.MonsterPreview,this.monsterSecond.children[0])},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),this.onClear()},__decorate([h(cc.Node)],t.prototype,"monsterOne",void 0),__decorate([h(cc.Node)],t.prototype,"monsterSecond",void 0),__decorate([h(cc.Animation)],t.prototype,"animationOne",void 0),__decorate([h(cc.Animation)],t.prototype,"animationSecond",void 0),__decorate([h(cc.Node)],t.prototype,"animationThirth",void 0),t=__decorate([p],t)}(n.default);i.default=u,cc._RF.pop()},{"../../../Core/TimeController":"TimeController","../../../Core/Widget":"Widget","../../../Core/WindowType":"WindowType","../../../Global/GlobalValue":"GlobalValue","../../../Util/Utils":"Utils","../../Commons/MonsterPreview":"MonsterPreview","../../WarTeam/MonsterController":"MonsterController"}],FightResultTroop:[function(e,t,i){"use strict";cc._RF.push(t,"21639az62ZHL6M7hTDZEfhp","FightResultTroop"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Language"),o=e("../WarTeam/MonsterController"),a=e("../../Core/ConfigsManager"),r=e("../Expedition/ExpeditionMonsterinfo"),s=e("../Commons/CombatValue"),l=e("../Commons/CommonPageBG"),c=e("../Status/StatusType"),d=e("../../Util/MonsterGroupUtils"),p=e("../../Core/WindowManager"),h=e("../../Core/WindowType"),u=e("../../Util/Utils"),f=e("../../GlobalContext"),g=e("../../Core/LoadManager"),y=e("../Role/RoleInfo"),m=e("../TreasureMap/TreasureMapController"),C=e("../Commons/MonsterPreview"),v=e("../Fight/FightUtils"),_=e("../Scene/Controller/SceneController"),b=cc._decorator,T=b.ccclass,S=b.property,I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.listContent=null,t.spriteCombat=null,t.monsterPreview=null,t.roleCombat=null,t.roleLabe=null,t._cardConfigs=null,t.monsterList=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.leftInfo(),this.onInit(1035,576,n.default.getStr("fightresult_troop_title"),!0),i.instance=this},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),u.default.setNodeChildDestoryByUrl(this.listContent,f.GlobalContext.Root+"prefab/Expedition/ExpeditionMonsterinfo"),u.default.setNodeChildDestoryByUrl(this.spriteCombat,f.GlobalContext.Root+"prefab/CombatVal")},t.prototype.initData=function(e,t,i){var n=this;if(void 0===e&&(e=[]),void 0===t&&(t=0),void 0===i&&(i=[]),this._cardConfigs||(this._cardConfigs=a.ConfigsManager.instance.getConfigs("cardConf")),e){c.ActivityStatus.value==c.ActivityStatus.TreasureMap&&(e=_.default.instance.gerReserveData(m.default.instance.reserve)),this.monsterList=e.concat();var l=o.default.instance.GetWarTeamConfig(),p=d.default.getMonsterGroup(this.monsterList,l);u.default.setNodeChildDestoryByUrl(this.listContent,f.GlobalContext.Root+"prefab/Expedition/ExpeditionMonsterinfo"),g.default.instance.loadResByType(f.GlobalContext.Root+"prefab/Expedition/ExpeditionMonsterinfo",cc.Prefab,function(e){for(var o in l){var a=l[o],h=d.default.getMonsterIndex(p,a,Number(o)),m=u.default.getNodeByUrl(e,f.GlobalContext.Root+"prefab/Expedition/ExpeditionMonsterinfo");n.listContent.addChild(m),m.getComponent(r.default).initData(a.id,a.level,a.grade,n._cardConfigs.Card[a.id].cardName,h?p[h].list:[])}if(i.length>0&&c.ActivityStatus.value==c.ActivityStatus.Chapter){for(var C=[],v=0;v<i.length;v++){var _=!0;for(var o in l)if(l[o].id==i[v].cardid){_=!1;break}_&&C.push(i[v])}i=C.concat()}if(i.length){var b=d.default.getMonsterGroupByList(i),T=d.default.getMonsterGroup(i,b,!0);for(var o in b){var S=b[o];h=d.default.getMonsterIndex(T,S),m=u.default.getNodeByUrl(e,f.GlobalContext.Root+"prefab/Expedition/ExpeditionMonsterinfo");n.listContent.addChild(m),m.getComponent(r.default).initData(S.id,S.level,S.grade,n._cardConfigs.Card[S.id].cardName,h?T[h].list:[])}}n.node.getComponentInChildren(cc.ScrollView).scrollToTop(),c.ActivityStatus.value!=c.ActivityStatus.TreasureMap&&(t+=y.MyRoleInfo.Fight),u.default.setNodeChildDestoryByUrl(n.spriteCombat,f.GlobalContext.Root+"prefab/CombatVal"),g.default.instance.loadResByType(f.GlobalContext.Root+"prefab/CombatVal",cc.Prefab,function(e){var i=u.default.getNodeByUrl(e,f.GlobalContext.Root+"prefab/CombatVal");n.spriteCombat.addChild(i),n.spriteCombat.getComponentInChildren(s.default).onInit(t,34,1.5,!0)},n)},this)}},t.prototype.leftInfo=function(){var e=this;u.default.setNodeChildDestoryByUrl(this.roleCombat,f.GlobalContext.Root+"prefab/CombatVal"),g.default.instance.loadResByType(f.GlobalContext.Root+"prefab/CombatVal",cc.Prefab,function(t){var i=u.default.getNodeByUrl(t,f.GlobalContext.Root+"prefab/CombatVal");e.roleCombat.addChild(i);var n=c.ActivityStatus.value==c.ActivityStatus.TreasureMap?y.MyRoleInfo.GetCurrentFight(v.FightUtils.getRoleHp()):y.MyRoleInfo.Fight;e.roleCombat.getComponentInChildren(s.default).onInit(n,34,1.5,!1)},this),this.monsterPreview.getComponent(C.default).init("role",y.MyRoleInfo.currentsurface,1,"default"),this.roleLabe.string=y.MyRoleInfo.name},t.prototype.onClose=function(){p.default.instance.close(h.WindowType.FightResultTroop)},t.instance=null,__decorate([S(cc.Node)],t.prototype,"listContent",void 0),__decorate([S(cc.Node)],t.prototype,"spriteCombat",void 0),__decorate([S(cc.Node)],t.prototype,"monsterPreview",void 0),__decorate([S(cc.Node)],t.prototype,"roleCombat",void 0),__decorate([S(cc.Label)],t.prototype,"roleLabe",void 0),t=i=__decorate([T],t)}(l.default);i.default=I,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/MonsterGroupUtils":"MonsterGroupUtils","../../Util/Utils":"Utils","../Commons/CombatValue":"CombatValue","../Commons/CommonPageBG":"CommonPageBG","../Commons/MonsterPreview":"MonsterPreview","../Expedition/ExpeditionMonsterinfo":"ExpeditionMonsterinfo","../Fight/FightUtils":"FightUtils","../Role/RoleInfo":"RoleInfo","../Scene/Controller/SceneController":"SceneController","../Status/StatusType":"StatusType","../TreasureMap/TreasureMapController":"TreasureMapController","../WarTeam/MonsterController":"MonsterController"}],FightResultWin:[function(e,t,i){"use strict";cc._RF.push(t,"380eaICeSZCaLIqvBm4kSfN","FightResultWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Scene/Manager/SceneManager"),o=e("../Sound/SoundController"),a=e("../../Core/WindowManager"),r=e("../../Core/WindowType"),s=e("../Status/StatusController"),l=e("./FightResultCommon"),c=e("../Status/StatusType"),d=e("../Chapter/ChapterController"),p=e("../../Core/GameEventDispatcher"),h=e("../../Core/Event"),u=e("../Scene/Controller/SceneController"),f=e("../TreasureMap/TreasureMapController"),g=cc._decorator,y=g.ccclass,m=(g.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.combatValue=0,t.remainMonsterList=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.show=function(){e.prototype.show.call(this),o.default.instance.StopBGM(),o.default.instance.PlayEffect(n.default.instance.fightresult?o.SoundType.fightWin:o.SoundType.fightLose),p.GameEventDispatcher.instance.on(h.EventDefiner.Set_Monster_Data,this.setData,this),c.ActivityStatus.value!=c.ActivityStatus.TreasureMap&&this.onInitResult(!0,this.onShowPage,this,null,!0)},t.prototype.setData=function(){switch(c.ActivityStatus.value){case c.ActivityStatus.TreasureMap:this.onInitData(f.default.instance.remainFight,u.default.instance.gerReserveData(f.default.instance.reserve)),this.onInitResult(!0,this.onShowPage,this,null,!0)}},t.prototype.hide=function(){e.prototype.hide.call(this),this.resetID(),this.remainMonsterList=null,p.GameEventDispatcher.instance.off(h.EventDefiner.Set_Monster_Data,this.setData,this),o.default.instance.StopEffectByType(n.default.instance.fightresult?o.SoundType.fightWin:o.SoundType.fightLose)},t.prototype.onInitData=function(e,t){void 0===e&&(e=0),this.remainMonsterList=t,this.combatValue=e},t.prototype.resetID=function(){d.default.instance.setCurrentGuanqiaId(),d.default.instance.setReadyPath()},t.prototype.onShowPage=function(){this.onInitContent(this.combatValue,this.remainMonsterList)},t.prototype.onClosePage=function(){a.default.instance.close(r.WindowType.FightResultWin),s.default.instance.activityStatusHandle(!0)},t.instance=null,t=i=__decorate([y],t)}(l.default));i.default=m,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../Chapter/ChapterController":"ChapterController","../Scene/Controller/SceneController":"SceneController","../Scene/Manager/SceneManager":"SceneManager","../Sound/SoundController":"SoundController","../Status/StatusController":"StatusController","../Status/StatusType":"StatusType","../TreasureMap/TreasureMapController":"TreasureMapController","./FightResultCommon":"FightResultCommon"}],FightSimulatorBox:[function(e,t,i){"use strict";cc._RF.push(t,"cd405d+dgpAIbwPYFiz6bUM","FightSimulatorBox"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Global/GlobalValue"),a=e("../../Core/GameEventDispatcher"),r=e("../../Core/Event"),s=e("../Status/StatusType"),l=e("../Scene/View/FightView"),c=e("../Scene/Controller/SceneController"),d=e("../Scene/Manager/SceneManager"),p=e("../Tips/OpTipsController"),h=e("../Fight/staticattr"),u=e("../../Core/Const/EntityType"),f=e("../Scene/Controller/SkillController"),g=e("../Scene/Controller/FightController"),y=e("../Equip/equip/EquipCtrl"),m=e("../../Core/Language"),C=e("../Chapter/GuanqiaController"),v=e("../Tips/TipsWinController"),_=cc._decorator,b=_.ccclass,T=_.property,S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.selfEquipAttr=null,t.selfEquipSelect=null,t.selfIdEditBox=null,t.selfGladeEditBox=null,t.selfLvEditBox=null,t.selfCardAttr=null,t.foeEquipAttr=null,t.foeCardAttr=null,t.foeEquipSelect=null,t.foeIdEditBox=null,t.foeGladeEditBox=null,t.foeLvEditBox=null,t.chapterEditBox=null,t.wareEditBox=null,t}return __extends(t,e),t.prototype.hide=function(){e.prototype.hide.call(this),this.rate=null,this.isCreateRole=null,a.GameEventDispatcher.instance.off(r.EventDefiner.C_Fight_End,this.setFightCallback,this)},t.prototype.show=function(){e.prototype.show.call(this),this.rate=!0,a.GameEventDispatcher.instance.on(r.EventDefiner.C_Fight_End,this.setFightCallback,this)},t.prototype.setFightCallback=function(){this.isCreateRole=!1},t.prototype.FightSend=function(e,t){switch(parseInt(t)){case o.SimulatorType.CLEAN:a.GameEventDispatcher.instance.emit(r.EventDefiner.C_Fight_Clear),d.default.instance.fightstatus=d.FIGHTSTATUS.NONE,this.isCreateRole=!1;break;case o.SimulatorType.FIGHT:d.default.instance.leftFight&&d.default.instance.rightFight?a.GameEventDispatcher.instance.emit(r.EventDefiner.C_Fight_Start):p.default.instance.ShowMsg("\u53cc\u65b9\u81f3\u5c11\u6709\u602a\u65b9\u53ef\u8fdb\u884c\u6218\u6597");break;case o.SimulatorType.STOP:var i=this.rate?0:1;this.rate=!!i,l.default.instance.SetFightViewPlayRate(i);break;case o.SimulatorType.CLOSE:v.default.instance.ShowTips(m.default.getStr("\u662f\u5426\u786e\u8ba4\u9000\u51fa\u6218\u6597\u6a21\u62df\u5668"),function(){a.GameEventDispatcher.instance.emit(r.EventDefiner.C_Fight_Data_Save,!1),a.GameEventDispatcher.instance.emit(r.EventDefiner.ChangeActivityStatus,s.ActivityStatus.Chapter)});break;case o.SimulatorType.EquipATTRSELF:this.selfCardAttr.active=!1,this.selfEquipAttr.active=!this.selfEquipAttr.active;break;case o.SimulatorType.CARDATTRSELF:this.selfCardAttr.active=!this.selfCardAttr.active,this.selfEquipAttr.active=!1;break;case o.SimulatorType.CREATESELF:this.getProp(!0,!1);break;case o.SimulatorType.EquipATTRFOE:this.foeCardAttr.active=!1,this.foeEquipAttr.active=!this.foeEquipAttr.active;break;case o.SimulatorType.CARDATTRSFOE:this.foeCardAttr.active=!this.foeCardAttr.active,this.foeEquipAttr.active=!1;break;case o.SimulatorType.CREATEFOE:this.getProp(!1,!1);break;case o.SimulatorType.SELFNEWADD:this.getProp(!0,!0);break;case o.SimulatorType.FOENEWADD:this.getProp(!1,!0);break;case o.SimulatorType.ADDROLE:if(this.isCreateRole)p.default.instance.ShowMsg("\u4e3b\u89d2\u5df2\u5b58\u5728\u9700clear\u518daddRole\u5426\u5219\u4f1a\u5f71\u54cd\u6218\u6597");else{for(var n=new h.StaticAttr,f=void 0,g=void 0,y=0;y<=o.AttrType.WindDef;y++)(f=this.getAttrStr(this.selfCardAttr,y)).length&&(n.Push(y,parseInt(f)),g=!0);g?(console.log("FightSimaddTestMyRole",n),this.isCreateRole=!0,c.default.instance.addTestMyRole(n)):p.default.instance.ShowMsg("\u8bf7\u8bbe\u7f6e\u5c5e\u6027\u503c")}break;case o.SimulatorType.SELFBACKOFF:if(d.default.instance.leftentitys.length){var C=d.default.instance.leftentitys[d.default.instance.leftentitys.length-1];C.prop.type==u.EntityType.enActor&&(this.isCreateRole=!1),c.default.instance.clearEntity(C)}else p.default.instance.ShowMsg("\u65e0\u53ef\u540e\u9000");break;case o.SimulatorType.FOEBACKOFF:d.default.instance.rightentitys.length?c.default.instance.clearEntity(d.default.instance.rightentitys[d.default.instance.rightentitys.length-1]):p.default.instance.ShowMsg("\u65e0\u53ef\u540e\u9000");break;case o.SimulatorType.CLEANATTR:this.cleanDisplayAttr(this.selfCardAttr),this.cleanDisplayAttr(this.foeCardAttr),this.selfEquipAttr.active&&this.chooseActiveClean(this.selfEquipSelect),this.foeEquipAttr.active&&this.chooseActiveClean(this.foeEquipSelect)}},t.prototype.chooseActiveClean=function(e){for(var t in e.children)if(e.children[t].active){this.cleanDisplayAttr(e.children[t]);break}},t.prototype.cleanDisplayAttr=function(e){var t;if(e.active)for(var i in e.children)(t=e.children[i].getComponent(cc.EditBox))&&(t.string="")},t.prototype.updateSelfEquipSelect=function(e,t){for(var i in e.children)e.children[i].active=e.children[i].name==t},t.prototype.onClickSelfToggle=function(e){var t=e.target.name;this.selfEquipSelect.getChildByName(t).active||this.updateSelfEquipSelect(this.selfEquipSelect,t)},t.prototype.onClickFoeToggle=function(e){var t=e.target.name;this.foeEquipSelect.getChildByName(t).active||this.updateSelfEquipSelect(this.foeEquipSelect,t)},t.prototype.limitEditBox=function(e,t){var i=e.replace(/\b(0+)/gi,"");t.string=i.replace(/[^0-9]/gi,""),e!=t.string&&p.default.instance.ShowMsg("\u8bf7\u8f93\u5165\u6b63\u786e\u6570\u5b57")},t.prototype.setData=function(e,t,i,n,a,r,s){var l,c,d=5,p=1,h=[];if(s)for(var u=0;u<=o.AttrType.WindDef;u++)c=this.getAttrStr(n,u),h.push(c.length?parseInt(c):0);var g=parseInt(e);if(t.length){var y=parseInt(t);d=y<=o.SimulatorAttrMax.CardGlade?y:o.SimulatorAttrMax.CardGlade,y>o.SimulatorAttrMax.CardGlade&&this.setAttrEStr(a?this.selfGladeEditBox:this.foeGladeEditBox,o.SimulatorAttrMax.CardGlade)}if(i.length){var m=parseInt(i);p=m<=o.SimulatorAttrMax.CardLv?m:1,m>o.SimulatorAttrMax.CardLv&&this.setAttrEStr(a?this.selfLvEditBox:this.foeLvEditBox,1)}var C=this.getGQMonsterAttr({cardid:g,grade:d,level:p,skilllevel:1,prop:h});if(!s)for(u=0;u<=o.AttrType.WindDef;u++)n.getChildByName(u+"").getComponent(cc.EditBox).string=C.attr_[u]?C.attr_[u]+"":"";for(u=C.skills.length;u>=1;u--)(l=this.getAttrStr(n,"skill"+u)).length?C.skills[u-1].skilllv=parseInt(l):C.skills.splice(u-1,1);if(C.skills=f.default.instance.getNormalSkillList(g,d).concat(C.skills),C.skills=C.skills.concat(f.default.instance.getBigSkillList(g,d)),s){var v=this.getEquipAttr(r,g);for(var _ in v)C.Push(parseInt(_),v[_])}return{cardid:g,grade:d,level:p,attr:C,num:1,self:a,skills:C.skills,autoUseSkill:!1}},t.prototype.getAttrStr=function(e,t){return"number"==typeof t&&(t=t.toString()),e.getChildByName(t).getComponent(cc.EditBox).string},t.prototype.setAttrStr=function(e,t,i){"number"==typeof t&&(t=t.toString());var n=e.getChildByName(t).getComponent(cc.EditBox);return p.default.instance.ShowMsg(n.placeholder+"\u8d85\u8fc7\u4e0a\u9650 \u5df2\u6539\u4e3a\u9ed8\u8ba4\u6570\u503c= "+i),n.string=i+""},t.prototype.setAttrEStr=function(e,t){return p.default.instance.ShowMsg(e.placeholder+"\u8d85\u8fc7\u4e0a\u9650 \u5df2\u6539\u4e3a\u9ed8\u8ba4\u6570\u503c= "+t),e.string=t+""},t.prototype.getEquipAttr=function(e,t){for(var i,n,a,r={},s=0;s<e.length;s++)if(i=e[s],(n=this.getAttrStr(i,0)).length){var l=parseInt(n)<=o.SimulatorAttrMax.EquipQuality?parseInt(n):1;n=this.getAttrStr(i,1);var c=parseInt(n)<=o.SimulatorAttrMax.EquipLv?parseInt(n):1;parseInt(n)>o.SimulatorAttrMax.EquipLv&&this.setAttrStr(i,1,1);var d=0;(n=this.getAttrStr(i,2)).length&&(d=parseInt(n)<=o.SimulatorAttrMax.EquipGlade?parseInt(n):1),parseInt(n)>o.SimulatorAttrMax.EquipGlade&&this.setAttrStr(i,2,1);var p=0;(n=this.getAttrStr(i,3)).length&&(p=parseInt(n)<=o.SimulatorAttrMax.RefineLv?parseInt(n):1),parseInt(n)>o.SimulatorAttrMax.RefineLv&&this.setAttrStr(i,3,1);var h=0;(n=this.getAttrStr(i,4)).length&&(h=parseInt(n)<=o.SimulatorAttrMax.AttackGemLv?parseInt(n):1),parseInt(n)>o.SimulatorAttrMax.AttackGemLv&&this.setAttrStr(i,4,1);var u=0;(n=this.getAttrStr(i,5)).length&&(u=parseInt(n)<=o.SimulatorAttrMax.HpGemLv?parseInt(n):1),parseInt(n)>o.SimulatorAttrMax.HpGemLv&&this.setAttrStr(i,5,1),n=this.getAttrStr(i,6);var f=0;for(var g in n.length&&(f=parseInt(n)<=o.SimulatorAttrMax.DefenseGemLv?parseInt(n):1),parseInt(n)>o.SimulatorAttrMax.DefenseGemLv&&this.setAttrStr(i,6,1),a=y.default.instance.data.getEquipTestAttr(t,s,l,c,d,p,u,h,f))r[g]=r[g]?r[g]+a[g]:a[g];console.log("FightSimequipAttr= "+JSON.stringify(r),"\u5f53\u524d\u88c5\u5907\u5c5e\u6027"+JSON.stringify(a),"\u5361\u724cid= "+t,"\u88c5\u5907\u7c7b\u578b= "+s,"\u88c5\u5907\u54c1\u8d28= "+l,"\u88c5\u5907\u7b49\u7ea7= "+c,"\u88c5\u5907\u7b49\u9636= "+d,"\u7cbe\u70bc\u7b49\u7ea7= "+p,"\u751f\u547d\u5b9d\u77f3\u7b49\u7ea7= "+u,"\u653b\u51fb\u5b9d\u77f3\u7b49\u7ea7= "+h,"\u9632\u5fa1\u5b9d\u77f3\u7b49\u7ea7= "+f)}return r},t.prototype.getProp=function(e,t){var i;if(e)this.selfIdEditBox.string.length?i=this.setData(this.selfIdEditBox.string,this.selfGladeEditBox.string,this.selfLvEditBox.string,this.selfCardAttr,e,this.selfEquipSelect.children,t):p.default.instance.ShowMsg("\u8bf7\u8f93\u5165\u5fc5\u586b\u9879\u5361\u724cid");else if(this.foeIdEditBox.string.length)i=this.setData(this.foeIdEditBox.string,this.foeGladeEditBox.string,this.foeLvEditBox.string,this.foeCardAttr,e,this.foeEquipSelect.children,t);else if(this.chapterEditBox.string&&!t){var n=1,o=parseInt(this.chapterEditBox.string);this.wareEditBox.string&&(n=parseInt(this.wareEditBox.string));var s=C.default.instance.getGuanqiaPlaygames(o,n);s&&s.monsters?g.default.instance.addMonsterByGQid(parseInt(this.chapterEditBox.string),n):p.default.instance.ShowMsg("\u5f53\u524d\u7ae0\u8282id\u65e0\u6b64\u6ce2\u6570")}else p.default.instance.ShowMsg("\u8bf7\u8f93\u5165\u5fc5\u586b\u9879\u5361\u724cid\u6216\u7ae0\u8282id");i&&(console.log("FightSimC_Scene_Add_Actor",i),a.GameEventDispatcher.instance.emit(r.EventDefiner.C_Scene_Add_Actor,i))},t.prototype.getGQMonsterAttr=function(e){var t=new h.StaticAttr,i=5;e.grade<i&&(i=e.grade);var n=Math.pow(e.grade>=3?1.25:1.2,e.grade-i),o=f.default.instance.getSmallSkillList(e.cardid,e.grade);return t.PushCard(e.cardid,e.level,e.grade,n,o,e.prop),t},__decorate([T(cc.Node)],t.prototype,"selfEquipAttr",void 0),__decorate([T(cc.Node)],t.prototype,"selfEquipSelect",void 0),__decorate([T(cc.EditBox)],t.prototype,"selfIdEditBox",void 0),__decorate([T(cc.EditBox)],t.prototype,"selfGladeEditBox",void 0),__decorate([T(cc.EditBox)],t.prototype,"selfLvEditBox",void 0),__decorate([T(cc.Node)],t.prototype,"selfCardAttr",void 0),__decorate([T(cc.Node)],t.prototype,"foeEquipAttr",void 0),__decorate([T(cc.Node)],t.prototype,"foeCardAttr",void 0),__decorate([T(cc.Node)],t.prototype,"foeEquipSelect",void 0),__decorate([T(cc.EditBox)],t.prototype,"foeIdEditBox",void 0),__decorate([T(cc.EditBox)],t.prototype,"foeGladeEditBox",void 0),__decorate([T(cc.EditBox)],t.prototype,"foeLvEditBox",void 0),__decorate([T(cc.EditBox)],t.prototype,"chapterEditBox",void 0),__decorate([T(cc.EditBox)],t.prototype,"wareEditBox",void 0),t=__decorate([b],t)}(n.default);i.default=S,cc._RF.pop()},{"../../Core/Const/EntityType":"EntityType","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/Widget":"Widget","../../Global/GlobalValue":"GlobalValue","../Chapter/GuanqiaController":"GuanqiaController","../Equip/equip/EquipCtrl":"EquipCtrl","../Fight/staticattr":"staticattr","../Scene/Controller/FightController":"FightController","../Scene/Controller/SceneController":"SceneController","../Scene/Controller/SkillController":"SkillController","../Scene/Manager/SceneManager":"SceneManager","../Scene/View/FightView":"FightView","../Status/StatusType":"StatusType","../Tips/OpTipsController":"OpTipsController","../Tips/TipsWinController":"TipsWinController"}],FightTimeController:[function(e,t,i){"use strict";cc._RF.push(t,"d85b5CWuahHW6uFwP57yVxt","FightTimeController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Manager/SceneManager"),o=cc._decorator,a=o.ccclass,r=(o.property,function(){function e(){this._ServerTimeSpace=0,this._heartIntervalTime=0,this._handlerDic={},this._handlerIntervalDic={}}var t;return t=e,Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),e.prototype.setTimeout=function(e,t,i,n){for(var o=[],a=4;a<arguments.length;a++)o[a-4]=arguments[a];var r={pass:0,time:n,handler:t,handlerThisObj:i,args:o};this._handlerDic[e]||(this._handlerDic[e]=r)},e.prototype.setInterval=function(e,t,i,n){for(var o=[],a=4;a<arguments.length;a++)o[a-4]=arguments[a];var r={pass:0,time:n,handler:t,handlerThisObj:i,args:o};this._handlerIntervalDic[e]||(this._handlerIntervalDic[e]=r)},e.prototype.updateTime=function(e){for(var t in this._handlerDic){(i=this._handlerDic[t]).pass+=e,i.equiptime+=e,i.pass>=i.time&&(n.default.instance.fightlogic&&i.handler.apply(i.handlerThisObj,i.args),delete this._handlerDic[t])}for(var t in this._handlerIntervalDic){var i;(i=this._handlerIntervalDic[t]).pass+=e,i.pass>=i.time&&(i.pass=0,n.default.instance.fightlogic&&i.handler.apply(i.handlerThisObj,i.args))}},e.prototype.clearTimeout=function(e){delete this._handlerDic[e]},e.prototype.clearInterval=function(e){delete this._handlerIntervalDic[e]},e.prototype.hasInterval=function(e){return this._handlerIntervalDic[e]},e.prototype.clearAll=function(){for(var e in this._handlerDic)delete this._handlerDic[e];for(var e in this._handlerDic={},this._handlerIntervalDic)delete this._handlerIntervalDic[e];this._handlerIntervalDic={}},e._instance=null,e=t=__decorate([a],e)}());i.default=r,cc._RF.pop()},{"../Manager/SceneManager":"SceneManager"}],FightUtils:[function(e,t,i){"use strict";cc._RF.push(t,"91f501NWONL0aw6qbD2Tl5f","FightUtils"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Status/StatusType"),o=e("../../Global/GlobalValue"),a=e("../Commons/WindowOpenUtils"),r=e("../../Core/WindowType"),s=e("../Role/RoleController"),l=e("../Scene/Controller/FightController"),c=e("../WarTeam/MonsterController"),d=e("../Scene/Controller/SceneController"),p=e("../../Core/GameEventDispatcher"),h=e("../../Core/Event"),u=e("../Role/RoleInfo"),f=e("../TreasureMap/TreasureMapController"),g=e("../Functionicon/FunctionIconController"),y=function(){function e(){}return e.CheakSheidHp=function(e){return e},e.getAddType=function(e){var t;switch(e){case o.AttrType.HpRate:t=o.AttrType.MaxHp;break;case o.AttrType.AttackRate:t=o.AttrType.Attack;break;case o.AttrType.DefenceRate:t=o.AttrType.Defence;break;case o.AttrType.HitRate:t=o.AttrType.Hit;break;case o.AttrType.DodgeRate:t=o.AttrType.Dodge;break;case o.AttrType.CriticalRate:t=o.AttrType.Critical;break;case o.AttrType.DefCriRate:t=o.AttrType.DefCri}return t},e.additionalReserveNum=function(){var e=0;return[n.ActivityStatus.Guide,n.ActivityStatus.Chapter,n.ActivityStatus.MoneyDailyCopy].indexOf(n.ActivityStatus.value)<0&&(e+=s.default.instance.getReserveNum()),e},e.addMonsterReserveNum=function(){var e=0;return e+=s.default.instance.getMonsterReserveNum()},e.onClickBuff=function(e){s.default.instance.setClickSkillId(e),a.default.instance.openWindowType(r.WindowType.FightBuffTips)},e.onClickSkill=function(e){s.default.instance.setClickSkillId(e),a.default.instance.openWindowType(r.WindowType.RoleSkillTips)},e.setFaShionSkill=function(e){var t=s.default.instance.nowFashionData,i=!1;if(l.default.instance.foeSkillFaShion=[],!l.default.instance.foeFaShionAttr){l.default.instance.foeFaShionAttr=[];for(var n=0;n<e.length;n++)for(var o=0;o<t.length;o++)if(t[o].skillID==e[n].id){l.default.instance.foeSkillFaShion.push(e[n].id),l.default.instance.foeFaShionAttr[t[o].attrType[0]]=t[o].attrType[1],i||(i=!0);break}}i&&p.GameEventDispatcher.instance.emit(h.EventDefiner.FightShowBuffIcon)},e.setFightAttr=function(e,t,i){var n={};if(!g.default.instance.checkIsOpenbyWindowtype(r.WindowType.RoleTrain))return n;c.default.instance.GetMonsterInfo(e).fiveLineAttributes;var o=l.default.instance.myFaShionAttr;if(o)for(var a=0;a<o.length;a+=2)n[o[a]]?n[o[a]]+=o[a+1]:n[o[a]]=o[a+1];return n},e.getRoleHp=function(){var e=d.default.instance,t=u.MyRoleInfo.MaxHp,i=!0;if(e.setRoleHpState.indexOf(n.ActivityStatus.value)>=0){switch(n.ActivityStatus.value){case n.ActivityStatus.TreasureMap:i=f.default.instance.isNoOneLayer()}var o=e.roleHps[n.ActivityStatus.value];o>0&&i&&(t=o)}return t},e}();i.FightUtils=y,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../Commons/WindowOpenUtils":"WindowOpenUtils","../Functionicon/FunctionIconController":"FunctionIconController","../Role/RoleController":"RoleController","../Role/RoleInfo":"RoleInfo","../Scene/Controller/FightController":"FightController","../Scene/Controller/SceneController":"SceneController","../Status/StatusType":"StatusType","../TreasureMap/TreasureMapController":"TreasureMapController","../WarTeam/MonsterController":"MonsterController"}],FightView:[function(e,t,i){"use strict";cc._RF.push(t,"34ba9ZPfhZGkK2JNCdFw7Wv","FightView"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Core/TimeController"),a=e("./ActorsLayer"),r=e("../../../GlobalContext"),s=e("../../../Core/LoadManager"),l=e("../../Commons/Image"),c=e("./CloudMove"),d=e("../Controller/SceneController"),p=e("../../../Core/GameEventDispatcher"),h=e("../../../Core/Event"),u=e("../../Chapter/GuanqiaController"),f=e("../Manager/SceneManager"),g=e("../../LoadingPanel/LoadingPanel"),y=e("../../Status/StatusType"),m=e("../../../Core/WindowManager"),C=e("../../../Core/WindowType"),v=e("../../SandTable/SandTableController"),_=e("../Controller/FightController"),b=e("../../HighLadder/HighLadderWin"),T=e("../../Status/StatusController"),S=e("../Avater/AvatarBase"),I=e("../../../Global/GlobalValue"),w=e("../../WorldBoss/WorldBoss"),D=e("../../OpenWin/OpenWinController"),R=e("../Controller/GuideFightController"),A=e("../../../Core/ConfigsManager"),N=e("../../WarTeam/MonsterController"),L=e("../../Activity/ActivityController"),E=e("../../PlotWin/PlotController"),B=e("../../TreasureMap/TreasureMapController"),M=e("../../Totems/TotemsCtrl"),x=e("../../TotemsCopy/TotemsCopyCtrl"),k=e("../../TotemsCopy/TotemsCopyUtils"),P=e("../../ExpCopy/ExpCopyCtrl"),G=e("../../SandTable/SandTableConditionController"),F=cc._decorator,W=F.ccclass,U=F.property,O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ActorLayer=null,t.FntEnemyLayer=null,t.FntSelfLayer=null,t.FntAddLayer=null,t.FntRealLayer=null,t.FntLZLayer=null,t.FntReduceLayer=null,t.Sky=null,t.Floor=null,t.BgMiddle=null,t.TopBg=null,t.CloudMoveBack=null,t.CloudMoveMiddle=null,t.Baffle=null,t.Bg=null,t._fightLoadCom=!1,t._guideMonsterCardidGrade=[],t.getFightDataCom=!1,t._loopIntervalTime=0,t._loopIntervalLastTime=0,t.loopIntervalCount=0,t.guanqiaId=0,t.num=0,t.loopIntervalRate=[[30,30],[40,30],[15,20]],t.addmonster=!0,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.start=function(){i.instance=this,e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this),p.GameEventDispatcher.instance.on(h.EventDefiner.C_Scene_EnterScene,this.enterScene,this)},t.prototype.hide=function(){e.prototype.hide.call(this),p.GameEventDispatcher.instance.off(h.EventDefiner.C_Scene_EnterScene,this.enterScene,this),o.default.instance.clearInterval(this._loopIntervalTime),this.clear()},t.prototype.realyShow=function(){var e;if(y.ActivityStatus.value!=y.ActivityStatus.FightSimulator)switch(-1==d.default.instance.setRoleHpState.indexOf(y.ActivityStatus.value)&&d.default.instance.addMyRole(),T.default.instance.isSingle&&d.default.instance.playMonsterEnter(),y.ActivityStatus.value){case y.ActivityStatus.Chapter:E.default.instance.iscomplete&&m.default.instance.open(C.WindowType.SandTable);break;case y.ActivityStatus.Expedition:D.default.instance.openWindow(C.WindowType.SandTable);break;case y.ActivityStatus.Arena:break;case y.ActivityStatus.HighLadder:0==b.default.instance.Is_Fight&&(D.default.instance.openWindow(C.WindowType.HighLadderFighting),D.default.instance.openWindow(C.WindowType.SandTable));break;case y.ActivityStatus.WorldBoss:case y.ActivityStatus.EliteBoss:w.default.instance.isNewLineup&&0==L.default.instance.fightNum&&D.default.instance.openWindow(C.WindowType.SandTable);break;case y.ActivityStatus.FridBoss:D.default.instance.openWindow(C.WindowType.SandTable);break;case y.ActivityStatus.TreasureMap:B.default.instance.FightNum==B.default.instance.Event_Type_Campsite&&D.default.instance.openWindow(C.WindowType.SandTable);break;case y.ActivityStatus.Guide:e=o.default.instance.setTimeout(function(){R.default.instance.iscomplete=!1,R.default.instance.startGuideFight()},this,1e3);break;case y.ActivityStatus.ThemeShop:case y.ActivityStatus.MoneyDailyCopy:case y.ActivityStatus.RefineDailyCopy:case y.ActivityStatus.GemDailyCopy:case y.ActivityStatus.ArtifactDailyCopy:D.default.instance.openWindow(C.WindowType.SandTable);break;case y.ActivityStatus.TotemsCopy:var t=x.default.instance.getStepNum();v.default.instance.setTotaleMove(t),D.default.instance.openWindow(C.WindowType.SandTable);break;case y.ActivityStatus.EquipCopy:D.default.instance.openWindow(C.WindowType.SandTable);break;case y.ActivityStatus.ExpCopy:e=o.default.instance.setTimeout(function(){p.GameEventDispatcher.instance.emit(h.EventDefiner.C_Fight_Start),o.default.instance.clearTimeout(e)},this,1e3*d.default.instance.monsterEnterMoveTime)}},t.prototype.enterScene=function(e){this.guanqiaId=e.detail.guanqiaId;var t=e.detail.chapter,i=e.detail.section,n={guanqia:this.guanqiaId,chapter:t,section:i},o=u.default.instance.getConfig(this.guanqiaId);o&&(G.default.instance.init(o),o.sceneBaffleId?this.enterSceneFight(this.guanqiaId):o.chapterGuanqiaId?(this.getFightDataCom=!0,this.enterSceneFight(this.guanqiaId)):_.default.instance.requestEnterFight(n))},t.prototype.enterSceneFight=function(e){var t=this;if(M.default.instance.initFightData(),this.addEntitys(e),y.ActivityStatus.value==y.ActivityStatus.Guide){var i=A.ConfigsManager.instance.getConfigs("guidefightconf"),n=function(e){for(var i=function(e){var i=N.default.instance.getCardGradeBySpine(e.cardId,e.grade),n=N.default.instance.getCardGradeBySpineName(e.cardId,e.grade),o=r.GlobalContext.Root+I.SPINE_RES_DIR+"monster/"+i+"/"+n;t._guideMonsterCardidGrade.find(function(t){return t==[e.cardId+"_"+e.grade]})||t._guideMonsterCardidGrade.push(e.cardId+"_"+e.grade),s.default.instance.loadResByType(o,sp.SkeletonData,t.loadMonsterComplete,t,[e.cardId,e.grade])},n=0,o=e;n<o.length;n++){i(o[n])}},o=i.guidefight[1];n(i.monsters[o.monsters]),o=i.guidefight[2],n(i.monsters[o.monsters])}s.default.instance.loadResByType(I.SPINE_RES_DIR+"effect/monstereffect/effect",sp.SkeletonData,null,null),s.default.instance.loadResByType(r.GlobalContext.Root+"prefab/attackeffect/AttackEffect",cc.Prefab,null,null)},t.prototype.addEntitys=function(e){if(this.clear(),f.default.instance.quanqiaId=-1,e>0){f.default.instance.quanqiaId=e;var t=u.default.instance.getConfig(e);if(t){switch(d.default.instance.requestFightData(y.ActivityStatus.value),t.table&&v.default.instance.clearData(),v.default.instance.setSandInfo(t),y.ActivityStatus.value==y.ActivityStatus.TotemsCopy&&(t=u.default.instance.getConfig(k.TotemsCopyUtils.getGuanqiaId())),t.sceneBaffleId?this.setBaffle(t.sceneBaffleId):this.setScene(t.sceneResId),y.ActivityStatus.value){case y.ActivityStatus.TotemsCopy:x.default.instance.addMonsterByGQidAndGames(),this.num=x.default.instance.getStepNum();break;case y.ActivityStatus.ExpCopy:P.default.instance.addMonsterByGQidAndGames(),this.num=0,this.addmonster&&_.default.instance.addMonsterByGQidAndGames(e,1);break;case y.ActivityStatus.FightSimulator:break;default:this.addmonster?(_.default.instance.addMonsterByGQidAndGames(e,1),this.num=u.default.instance.getGuanqiaStepNum(e)):this.num=1}this.initNum=!0,this.setOtherSandTable()}}},t.prototype.setOtherSandTable=function(){switch(y.ActivityStatus.value){case y.ActivityStatus.ExpCopy:this.getFightDataCom=!0}this.checkFightdata()},t.prototype.setScene=function(e){this.Bg.body.readlySpineCall=this.readlyBgSpineCall,this.Bg.body.readlySpineCallThisObj=this,this.Bg.init("fightscene",e,"BG",null,I.PRIORITY.MONSTER,!1,I.ACTION.STAND,I.DIR.LEFT),this.Bg.body.play("BG")},t.prototype.loadMonsterComplete=function(e,t,i){var n=this._guideMonsterCardidGrade.indexOf(t+"_"+i);-1!=n&&this._guideMonsterCardidGrade.splice(n,1),this._guideMonsterCardidGrade.length||this.checkFightdata()},t.prototype.readlyBgSpineCall=function(){this._fightLoadCom=!0,this.checkFightdata()},t.prototype.checkFightdata=function(){if(console.log("\u6b65\u6570\u521d\u59cb\u5316\u5b8c\u6210\uff1a"+this.initNum+" \u6218\u6597\u573a\u666f\u51c6\u5907\u5b8c\u6210\uff1a"+this._fightLoadCom+" \u83b7\u53d6\u6218\u6597\u4fdd\u5b58\u6570\u636e\uff1a"+this.getFightDataCom+" \u602a\u7269\u8d44\u6e90\u8d44\u6e90\uff1a"+!this._guideMonsterCardidGrade.length),this.initNum&&this._fightLoadCom&&this.getFightDataCom&&!this._guideMonsterCardidGrade.length){if(this.initNum=!1,this._fightLoadCom=!1,this.getFightDataCom=!1,g.default.instance.completeCallback=this.realyShow,g.default.instance.completeCallbackThisObj=this,g.default.instance.showSceneLoadingFinish(),y.ActivityStatus.value==y.ActivityStatus.TreasureMap){var e=B.default.instance.FightNum,t=0;e==B.default.instance.Event_Type_medical||e==B.default.instance.Event_Type_Trap?(t=B.default.instance.PercentNum,B.default.instance.setDataPlaySkill(!1)):B.default.instance.setDataPlaySkill(!0),d.default.instance.enterTreasureMap(e,t)}console.log("\u5173\u5361\u6b65\u6570\uff1a"+this.num+",\u989d\u5916\u589e\u52a0\u7684\u6b65\u6570:"+v.default.instance.sharpstep),this.num>0&&(v.default.instance.setTotaleMove(this.num+v.default.instance.sharpstep),this.num=0,v.default.instance.sharpstep=0,y.ActivityStatus.value==y.ActivityStatus.Guide&&R.default.instance.startGuideFight())}},t.prototype.loadMonsterRes=function(){for(var e=N.MonsterType.MonsterWarTeam[N.MonsterType.MonsterBattle],t=0,i="",n=0;n<e.length;n++)if(0!=e[n])for(var o=1;o<=2;o++){t=N.default.instance.getCardGradeBySpine(e[n],o),i=N.default.instance.getCardGradeBySpineName(e[n],o);var a=r.GlobalContext.Root+I.SPINE_RES_DIR+"monster/"+t+"/"+i;console.log("\u8fdb\u5165\u573a\u666f\u9884\u52a0\u8f7d\u6218\u961f\u602a\u7269\u8d44\u6e90 "+a),s.default.instance.loadResByType(a,sp.SkeletonData,null,null);var l=r.GlobalContext.Root+I.SPINE_RES_DIR+"monster/"+t+"/effect";s.default.instance.loadResByType(l,sp.SkeletonData,null,null)}},t.prototype.SetFightViewPlayRate=function(e){f.default.instance.fightViewPlayRate=e,p.GameEventDispatcher.instance.emit(h.EventDefiner.Fight_Speed_Change),this.setLoopInterval()},t.prototype.setLoopInterval=function(){if(o.default.instance.clearInterval(this._loopIntervalTime),this.ActorLayer.updateData(0,this.loopIntervalCount),f.default.instance.fightViewPlayRate>0){this.loopIntervalCount=0;var e=this.loopIntervalRate[f.default.instance.fightMode],t=cc.sys.isNative?e[0]-8:e[0];this._loopIntervalTime=o.default.instance.setInterval(this.setLoopIntervalHandle,this,t,e[1])}},t.prototype.setLoopIntervalHandle=function(e){this.loopIntervalCount++,this.loopIntervalCount>1e5&&(this.loopIntervalCount=0),this.loop(e*f.default.instance.fightViewPlayRate,this.loopIntervalCount)},t.prototype.loop=function(e,t){this.ActorLayer.updateData(e,t)},t.prototype.setBaffle=function(e){var t,i=this;void 0===e&&(e=1),t=r.GlobalContext.ResRoot+"resources/scenebaffle/Baffle"+e+".png",this.Baffle.loadImageByHttps(t,function(){var e=i.Baffle.sprite.spriteFrame.getRect().width/d.default.instance.sceneScale,t=i.Baffle.sprite.spriteFrame.getRect().height/d.default.instance.sceneScale;i.Baffle.node.width=e,i.Baffle.node.height=t,i._fightLoadCom=!0,g.default.instance.showSceneLoadingFinish(),i.getFightDataCom=!0,i.checkFightdata()},this)},t.prototype.clear=function(){this.Sky.clear(),this.Floor.clear(),this.BgMiddle.clear(),this.TopBg.clear(),this.CloudMoveBack.clear(),this.CloudMoveMiddle.clear(),this.Baffle.clear(),this.Bg.clear()},t.instance=null,__decorate([U(a.default)],t.prototype,"ActorLayer",void 0),__decorate([U(cc.Node)],t.prototype,"FntEnemyLayer",void 0),__decorate([U(cc.Node)],t.prototype,"FntSelfLayer",void 0),__decorate([U(cc.Node)],t.prototype,"FntAddLayer",void 0),__decorate([U(cc.Node)],t.prototype,"FntRealLayer",void 0),__decorate([U(cc.Node)],t.prototype,"FntLZLayer",void 0),__decorate([U(cc.Node)],t.prototype,"FntReduceLayer",void 0),__decorate([U(l.default)],t.prototype,"Sky",void 0),__decorate([U(l.default)],t.prototype,"Floor",void 0),__decorate([U(l.default)],t.prototype,"BgMiddle",void 0),__decorate([U(l.default)],t.prototype,"TopBg",void 0),__decorate([U(c.default)],t.prototype,"CloudMoveBack",void 0),__decorate([U(c.default)],t.prototype,"CloudMoveMiddle",void 0),__decorate([U(l.default)],t.prototype,"Baffle",void 0),__decorate([U(S.default)],t.prototype,"Bg",void 0),t=i=__decorate([W],t)}(n.default);i.default=O,cc._RF.pop()},{"../../../Core/ConfigsManager":"ConfigsManager","../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/LoadManager":"LoadManager","../../../Core/TimeController":"TimeController","../../../Core/Widget":"Widget","../../../Core/WindowManager":"WindowManager","../../../Core/WindowType":"WindowType","../../../Global/GlobalValue":"GlobalValue","../../../GlobalContext":"GlobalContext","../../Activity/ActivityController":"ActivityController","../../Chapter/GuanqiaController":"GuanqiaController","../../Commons/Image":"Image","../../ExpCopy/ExpCopyCtrl":"ExpCopyCtrl","../../HighLadder/HighLadderWin":"HighLadderWin","../../LoadingPanel/LoadingPanel":"LoadingPanel","../../OpenWin/OpenWinController":"OpenWinController","../../PlotWin/PlotController":"PlotController","../../SandTable/SandTableConditionController":"SandTableConditionController","../../SandTable/SandTableController":"SandTableController","../../Status/StatusController":"StatusController","../../Status/StatusType":"StatusType","../../Totems/TotemsCtrl":"TotemsCtrl","../../TotemsCopy/TotemsCopyCtrl":"TotemsCopyCtrl","../../TotemsCopy/TotemsCopyUtils":"TotemsCopyUtils","../../TreasureMap/TreasureMapController":"TreasureMapController","../../WarTeam/MonsterController":"MonsterController","../../WorldBoss/WorldBoss":"WorldBoss","../Avater/AvatarBase":"AvatarBase","../Controller/FightController":"FightController","../Controller/GuideFightController":"GuideFightController","../Controller/SceneController":"SceneController","../Manager/SceneManager":"SceneManager","./ActorsLayer":"ActorsLayer","./CloudMove":"CloudMove"}],FightWaveTip:[function(e,t,i){"use strict";cc._RF.push(t,"4d43dAMvWVJDLudGCHoEmL5","FightWaveTip"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=cc._decorator,a=o.ccclass,r=o.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.waveName=null,t}var i;return __extends(t,e),i=t,t.prototype.show=function(){e.prototype.show.call(this),i.instance=this},t.prototype.showTips=function(e){var t=this;void 0===e&&(e=" "),this.node.stopAllActions(),this.node.setPosition(2e3,200),this.node.active=!0,this.waveName.string=e,this.node.runAction(cc.sequence(cc.moveTo(1.5,cc.v2(0,200)),cc.delayTime(2),cc.moveTo(1.5,cc.v2(-2e3,200)),cc.callFunc(function(){t.node.active=!1},this)))},t.instance=null,__decorate([r(cc.Label)],t.prototype,"waveName",void 0),t=i=__decorate([a],t)}(n.default);i.default=s,cc._RF.pop()},{"../../Core/Widget":"Widget"}],Finger:[function(e,t,i){"use strict";cc._RF.push(t,"11a5fH5+hVOn7yfeIr9/iWl","Finger"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/SpineBase"),a=e("../../Global/GlobalValue"),r=e("../Scene/Pool/SpinePools"),s=cc._decorator,l=s.ccclass,c=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Interval=0,t.Delay=0,t.Finger=null,t.Larger=null,t.Small=null,t._effect=null,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.onEnable=function(){this.fingerAct()},t.prototype.hide=function(){this._effect.setPosition(0,0)},t.prototype.onDisable=function(){this.node.stopAllActions(),this.Finger.stopAllActions(),this.Small.stopAllActions(),this.Larger.stopAllActions(),this.Small.parent.active=!0,this.stop(),r.SpinePools.recoverSpineNoder(this._effect),this._effect=null},t.prototype.stop=function(){this.node.stopAllActions(),this.Finger.stopAllActions(),this.Small.stopAllActions(),this.Larger.stopAllActions(),this.Small.parent.active=!0},t.prototype.fingerAct=function(e,t,i,n,s){if(void 0===e&&(e=!0),void 0===t&&(t=null),void 0===i&&(i=null),void 0===n&&(n=!1),void 0===s&&(s=[]),this.stop(),this.Finger.getChildByName("finger").active=!1,this.Finger.getChildByName("tips").active=!0,this.Finger.active=!1,e)this.acting();else if(this.Small.parent.active=!1,this.Finger.active=!n,n){var l=this.node.getChildByName("fingerEffect");if(l.childrenCount<=0)this._effect=r.SpinePools.addSpineNoder(l,new cc.Vec2(0,0)),this._effect.getComponent(o.default).initSpineData(a.SPINE_RES_DIR+"effect/dailytipseffect/effect",null,"1",!0);this._effect.setPosition(l.x+s[0],l.y+s[1])}else this.node.runAction(cc.repeatForever(cc.sequence(cc.moveTo(.2,i),cc.moveTo(1.2,t))))},t.prototype.acting=function(){this.scalling(this.Finger),this.flashing(this.Small,.25,.15,.6),this.flashing(this.Larger,.35,.25,.4)},t.prototype.flashing=function(e,t,i,n){e.runAction(cc.repeatForever(cc.sequence(cc.delayTime(t),cc.fadeIn(i),cc.fadeOut(n))))},t.prototype.scalling=function(e){e.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.25,.5),cc.scaleTo(.75,.8))))},__decorate([c(cc.Integer)],t.prototype,"Interval",void 0),__decorate([c(cc.Integer)],t.prototype,"Delay",void 0),__decorate([c(cc.Node)],t.prototype,"Finger",void 0),__decorate([c(cc.Node)],t.prototype,"Larger",void 0),__decorate([c(cc.Node)],t.prototype,"Small",void 0),t=__decorate([l],t)}(n.default);i.default=d,cc._RF.pop()},{"../../Core/SpineBase":"SpineBase","../../Core/Widget":"Widget","../../Global/GlobalValue":"GlobalValue","../Scene/Pool/SpinePools":"SpinePools"}],FirstChargge:[function(e,t,i){"use strict";cc._RF.push(t,"1c14ad6oohExaMVq4ss6cqm","FirstChargge"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Core/GameEventDispatcher"),a=e("../GroupPurchase/GroupPurchaseContrl"),r=e("../../Commons/RewardUtils"),s=e("../../../Util/Utils"),l=e("../../../Core/WindowType"),c=e("../../Item/ItemIcon"),d=e("../../Commons/MonsterPreview"),p=e("../../WarTeam/MonsterController"),h=e("../../OpenWin/OpenWinController"),u=e("../../Shop/Shop"),f=e("../../../Core/Language"),g=e("../../../NetConnect/NetConnet"),y=e("../../Shop/ShopController"),m=e("../../Shop/ShopConst"),C=e("../ActivityCtrl"),v=e("../../../Core/ConfigsManager"),_=e("../../../Core/LoadManager"),b=e("../../../GlobalContext"),T=e("../../../Core/Event"),S=cc._decorator,I=S.ccclass,w=S.property,D=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fristCharge=null,t.dailyCharge=null,t.rewardLayout=null,t.chargeLabe=null,t.item=null,t.monsterContent=null,t.atlas=null,t.toggle1=null,t.toggle2=null,t.toggle3=null,t.btn=null,t.boxGrade=null,t.loopTitle=null,t.openServeTitle=null,t.config=null,t.myData=null,t.day=0,t.act=-1,t}var i;return __extends(t,e),i=t,t.prototype.show=function(){e.prototype.show.call(this);var t=a.default.instance.statue;t==C.ActivityType.OpenServe?(this.openServeTitle.active=!0,this.loopTitle.active=!1,this.act=8):t==C.ActivityType.Loop&&(this.openServeTitle.active=!1,this.loopTitle.active=!0,this.act=12),a.default.instance.SendFirstCharge(this.act),this.config=v.ConfigsManager.instance.getConfigs("firstrechargeconf"),this.myData=a.default.instance.myData,i.instance=this,o.GameEventDispatcher.instance.on("FIRSTRECHARGEINFO",this.Info,this),this.Info(),o.GameEventDispatcher.instance.emit(T.EventDefiner.Activity_countdown,this)},t.prototype.hide=function(){e.prototype.hide.call(this),o.GameEventDispatcher.instance.off("FIRSTRECHARGEINFO",this.Info,this),o.GameEventDispatcher.instance.emit(T.EventDefiner.Activity_resetTimeout,this),this.onClearItem()},t.prototype.onClearItem=function(){for(var e=this.rewardLayout.childrenCount-1;e>=0;e--)s.default.setNodeToPool(l.PoolType.ItemIcon,this.rewardLayout.children[e]);this.rewardLayout.removeAllChildren()},t.prototype.Info=function(){var e=this;if(this.onClearItem(),this.day=a.default.instance.fristDay,2==a.default.instance.isFirstCharge){var t,i=this.config.day[this.myData.idx][this.day].grade;this.fristCharge.active=!1,this.dailyCharge.active=!0,this.toggle1.isChecked?(this.boxGrade.spriteFrame=this.atlas.getSpriteFrame("icon_88"),this.ToggleInfo(0,1),t=r.default.instance.getItemList(this.config.grade[i][0].rewardID)):this.toggle2.isChecked?(this.boxGrade.spriteFrame=this.atlas.getSpriteFrame("icon_188"),this.ToggleInfo(1,2),t=r.default.instance.getItemList(this.config.grade[i][1].rewardID)):(this.boxGrade.spriteFrame=this.atlas.getSpriteFrame("icon_888"),this.ToggleInfo(2,3),t=r.default.instance.getItemList(this.config.grade[i][2].rewardID)),_.default.instance.loadResByType(b.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(i){e.item=i;for(var n=0;n<t.length;n++){var o=s.default.getNodeByPool(l.PoolType.ItemIcon,e.item);e.rewardLayout.addChild(o),o.setScale(.8,.8),o.getComponent(c.default).ItemData(t[n],!0,null,!0)}},this)}else{this.fristCharge.active=!0,this.dailyCharge.active=!1;for(var n=r.default.instance.getItemList(this.config.FirstRechargeConf[this.myData.idx].rewardID),o=this.monsterContent.childrenCount-1;o>=0;o--){this.monsterContent.children[o].getComponent(d.default).clear(),s.default.setNodeToPool(l.PoolType.MonsterPreview,this.monsterContent.children[o])}p.default.instance.infoPreview(this.monsterContent,cc.v2(0,0),this.config.FirstRechargeConf[this.myData.idx].cardID,5,.8),_.default.instance.loadResByType("prefab/Bag/ItemIcon",cc.Prefab,function(t){e.item=t;for(var i=0;i<n.length;i++){var o=s.default.getNodeByPool(l.PoolType.ItemIcon,e.item);e.rewardLayout.addChild(o),o.setScale(.8,.8),o.getComponent(c.default).ItemData(n[i],!0,null,!0)}},this),1==a.default.instance.isFirstCharge?this.btn.getComponentInChildren(cc.Label).string=f.default.getStr("\u9886 \u53d6"):this.btn.getComponentInChildren(cc.Label).string=f.default.getStr("\u5145 \u503c")}},t.prototype.ToggleInfo=function(e,t){var i=this.config.day[this.myData.idx][this.day].grade;this.chargeLabe.string=this.config.grade[i][e].money+"",a.default.instance.firstCharge&&1==a.default.instance.firstCharge[Object.keys(a.default.instance.firstCharge).length-t]?(this.btn.getComponentInChildren(cc.Label).string=f.default.getStr("\u5df2\u9886\u53d6"),this.btn.getComponent(cc.Button).interactable=!1):a.default.instance.chargeNumber>=this.config.grade[i][e].money?(this.btn.getComponentInChildren(cc.Label).string=f.default.getStr("\u9886 \u53d6"),this.btn.getComponent(cc.Button).interactable=!0):(this.btn.getComponentInChildren(cc.Label).string=f.default.getStr("\u5145 \u503c"),this.btn.getComponent(cc.Button).interactable=!0)},t.prototype.BtnClick=function(){var e=0;if(this.btn.getComponentInChildren(cc.Label).string==f.default.getStr("\u5145 \u503c"))h.default.instance.openWindow(l.WindowType.Shop,function(){var e=y.default.instance.nowSortIndex[m.ShopConst.Recharge];u.default.instance.TabBtnList2.selectItem(e)},this);else if(1==a.default.instance.isFirstCharge){var t={cmd:"firstrecharge",actid:this.act};g.default.instance.sendProto(t)}else{this.toggle1.isChecked?e=1:this.toggle2.isChecked?e=2:this.toggle3.isChecked&&(e=3);t={cmd:"dailyrecharge",layer:e,actid:this.act};g.default.instance.sendProto(t)}},t.instance=null,__decorate([w(cc.Node)],t.prototype,"fristCharge",void 0),__decorate([w(cc.Node)],t.prototype,"dailyCharge",void 0),__decorate([w(cc.Node)],t.prototype,"rewardLayout",void 0),__decorate([w(cc.Label)],t.prototype,"chargeLabe",void 0),__decorate([w(cc.Node)],t.prototype,"monsterContent",void 0),__decorate([w(cc.SpriteAtlas)],t.prototype,"atlas",void 0),__decorate([w(cc.Toggle)],t.prototype,"toggle1",void 0),__decorate([w(cc.Toggle)],t.prototype,"toggle2",void 0),__decorate([w(cc.Toggle)],t.prototype,"toggle3",void 0),__decorate([w(cc.Node)],t.prototype,"btn",void 0),__decorate([w(cc.Sprite)],t.prototype,"boxGrade",void 0),__decorate([w(cc.Node)],t.prototype,"loopTitle",void 0),__decorate([w(cc.Node)],t.prototype,"openServeTitle",void 0),t=i=__decorate([I],t)}(n.default);i.default=D,cc._RF.pop()},{"../../../Core/ConfigsManager":"ConfigsManager","../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Core/LoadManager":"LoadManager","../../../Core/Widget":"Widget","../../../Core/WindowType":"WindowType","../../../GlobalContext":"GlobalContext","../../../NetConnect/NetConnet":"NetConnet","../../../Util/Utils":"Utils","../../Commons/MonsterPreview":"MonsterPreview","../../Commons/RewardUtils":"RewardUtils","../../Item/ItemIcon":"ItemIcon","../../OpenWin/OpenWinController":"OpenWinController","../../Shop/Shop":"Shop","../../Shop/ShopConst":"ShopConst","../../Shop/ShopController":"ShopController","../../WarTeam/MonsterController":"MonsterController","../ActivityCtrl":"ActivityCtrl","../GroupPurchase/GroupPurchaseContrl":"GroupPurchaseContrl"}],FlagController:[function(e,t,i){"use strict";cc._RF.push(t,"980e1zutDtGtrwpZmjitBMv","FlagController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./Controller"),o=e("./GameEventDispatcher"),a=e("./Event"),r=e("./TimeController"),s=cc._decorator,l=s.ccclass,c=(s.property,function(e){function t(){var t=e.call(this)||this;return t._FlagDataDic={},i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){},t.prototype.SetFlagData=function(e,t){if(!this._FlagDataDic[e]||this._FlagDataDic[e]!=t){this._FlagDataDic[e]=t;var i=r.default.instance.setTimeout(function(){o.GameEventDispatcher.instance.emit(a.EventDefiner.FlagDataChange,e),r.default.instance.clearTimeout(i)},this,100)}},t.prototype.GetFlagData=function(e){return this._FlagDataDic[e]},t.instance=null,t=i=__decorate([l],t)}(n.default));i.default=c;var d=function(){function e(){}return e.AddFriend=1,e}();i.FlagType=d,cc._RF.pop()},{"./Controller":"Controller","./Event":"Event","./GameEventDispatcher":"GameEventDispatcher","./TimeController":"TimeController"}],Flag:[function(e,t,i){"use strict";cc._RF.push(t,"9a320wPTYVPZoRclDnz6+uu","Flag"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Util/Utils"),o=e("./WindowType"),a=e("./FlagController"),r=e("./GameEventDispatcher"),s=e("./Event"),l=e("./Widget"),c=cc._decorator,d=c.ccclass,p=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.FlagPoint=null,t.TypeList=[],t.FlagItem=null,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.onDestroy=function(){this.ClearFlagItem()},t.prototype.show=function(){r.GameEventDispatcher.instance.on(s.EventDefiner.FlagDataChange,this.FlagDataChange,this),this.SetShow()},t.prototype.hide=function(){r.GameEventDispatcher.instance.off(s.EventDefiner.FlagDataChange,this.FlagDataChange,this)},t.prototype.CheckShow=function(){if(this.FlagItem)if(this.TypeList.length<=0)this.FlagItem.active=!0;else{for(var e=!1,t=0;t<this.TypeList.length;t++){var i=Number(this.TypeList[t]),n=a.default.instance.GetFlagData(i);if(0==n){e=!0;break}if(n>0){e=!0;break}}this.FlagItem.active=e}},t.prototype.SetShow=function(){this.IsInit&&(this.FlagItem||(this.FlagItem=n.default.getNodeByPool(o.PoolType.FlagItem,this.FlagPoint),this.node.addChild(this.FlagItem)),this.CheckShow())},t.prototype.ClearFlagItem=function(){this.FlagItem&&n.default.setNodeToPool(o.PoolType.FlagItem,this.FlagItem)},t.prototype.FlagDataChange=function(e){var t=0;e&&(t=Number(e.getUserData())),(!t||0==t||this.TypeList.indexOf(t)>=0)&&this.CheckShow()},__decorate([p(cc.Prefab)],t.prototype,"FlagPoint",void 0),__decorate([p([cc.Integer])],t.prototype,"TypeList",void 0),t=__decorate([d],t)}(l.default);i.default=h,cc._RF.pop()},{"../Util/Utils":"Utils","./Event":"Event","./FlagController":"FlagController","./GameEventDispatcher":"GameEventDispatcher","./Widget":"Widget","./WindowType":"WindowType"}],Flash:[function(e,t,i){"use strict";cc._RF.push(t,"5e72d7snHtD5LLuD2++Vetc","Flash"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=cc._decorator,a=o.ccclass,r=o.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Interval=0,t.Delay=0,t}return __extends(t,e),t.prototype.start=function(){var t=this;e.prototype.start.call(this),this.schedule(function(){t.flashing()},this.Interval)},t.prototype.show=function(){e.prototype.show.call(this),this.schedule(this.flashing,this.Interval)},t.prototype.hide=function(){var t=this;e.prototype.hide.call(this),this.unschedule(function(){t.flashing()})},t.prototype.flashing=function(){this.node.runAction(cc.sequence(cc.fadeOut(this.Interval/2),cc.fadeIn(this.Interval/2)))},__decorate([r(cc.Integer)],t.prototype,"Interval",void 0),__decorate([r(cc.Integer)],t.prototype,"Delay",void 0),t=__decorate([a],t)}(n.default);i.default=s,cc._RF.pop()},{"../../Core/Widget":"Widget"}],FntItemAddHurt:[function(e,t,i){"use strict";cc._RF.push(t,"52c18IHXTlO27GR0NIxA/Mv","FntItemAddHurt"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./FntSwingGp"),o=cc._decorator,a=o.ccclass,r=(o.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.used=function(t,i,n,o,a,r,s,l,c,d){void 0===c&&(c=null),void 0===d&&(d=null),e.prototype.used.call(this,t,i,n,o,a,r,s,l,c,d)},t=__decorate([a],t)}(n.FntItem));i.default=r,cc._RF.pop()},{"./FntSwingGp":"FntSwingGp"}],FntItemHurt:[function(e,t,i){"use strict";cc._RF.push(t,"48708xF/mdHFoSMpRhVJ5WO","FntItemHurt"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./FntSwingGp"),o=cc._decorator,a=o.ccclass,r=(o.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.used=function(t,i,n,o,a,r,s,l,c,d){void 0===c&&(c=null),void 0===d&&(d=null),e.prototype.used.call(this,t,i,n,o,a,r,s,l,c,d)},t=__decorate([a],t)}(n.FntItem));i.default=r,cc._RF.pop()},{"./FntSwingGp":"FntSwingGp"}],FntItemLZHurt:[function(e,t,i){"use strict";cc._RF.push(t,"e22a6ygZzBEH672AolCn7uJ","FntItemLZHurt"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./FntSwingGp"),o=cc._decorator,a=o.ccclass,r=(o.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.used=function(t,i,n,o,a,r,s,l,c,d){void 0===c&&(c=null),void 0===d&&(d=null),e.prototype.used.call(this,t,i,n,o,a,r,s,l,c,d)},t=__decorate([a],t)}(n.FntItem));i.default=r,cc._RF.pop()},{"./FntSwingGp":"FntSwingGp"}],FntItemReduceCoin:[function(e,t,i){"use strict";cc._RF.push(t,"87d4aAEKdZPAL78zWGSQ/21","FntItemReduceCoin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./FntSwingGp"),o=cc._decorator,a=o.ccclass,r=(o.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.used=function(t,i,n,o,a,r,s,l,c,d){void 0===c&&(c=null),void 0===d&&(d=null),e.prototype.used.call(this,t,i,n,o,a,r,s,l,c,d)},t=__decorate([a],t)}(n.FntItem));i.default=r,cc._RF.pop()},{"./FntSwingGp":"FntSwingGp"}],FntItemSelfHurt:[function(e,t,i){"use strict";cc._RF.push(t,"c819azv/PdFq5ce8+b+RIJX","FntItemSelfHurt"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./FntSwingGp"),o=cc._decorator,a=o.ccclass,r=(o.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.used=function(t,i,n,o,a,r,s,l,c,d){void 0===c&&(c=null),void 0===d&&(d=null),e.prototype.used.call(this,t,i,n,o,a,r,s,l,c,d)},t=__decorate([a],t)}(n.FntItem));i.default=r,cc._RF.pop()},{"./FntSwingGp":"FntSwingGp"}],FntSwingGp:[function(e,t,i){"use strict";cc._RF.push(t,"0a1c4ykpB9IKZgIEsI8EilB","FntSwingGp"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Core/LoadManager"),a=e("../../../GlobalContext"),r=e("../SceneEntity"),s=e("../../../Core/TimeController"),l=e("../View/FightView"),c=cc._decorator,d=c.ccclass,p=c.property,h=function(){function e(){this.fntGroup=new cc.NodePool,this.movingfnt=[],this.pre=null,this.isInited=!1,this.waitInitTodoList=[],this.waitInitTodoTime=0,this.handleDic={}}return e.prototype.init=function(e,t){var i=a.GlobalContext.Root+"prefab/fntswing/"+e;o.default.instance.loadResByType(i,cc.Prefab,this.loadComplete,this,[t])},e.prototype.loadComplete=function(e,t){this.pre=e,this.isInited=!0,s.default.instance.clearInterval(this.waitInitTodoTime),this.waitInitTodoTime=s.default.instance.setInterval(this.waitInitTodo.bind(this),this,50)},e.prototype.waitInitTodo=function(){if(this.waitInitTodoList&&this.waitInitTodoList.length>0){var e=this.waitInitTodoList.shift(),t=Date.now(),i=e[5];if(!i||!i.parent)return;for(;e&&i.getComponent(r.default)&&t-e[10]>100;){e=this.waitInitTodoList.shift();break}var n=null;if(n=this.fntGroup.size()>0?this.fntGroup.get():cc.instantiate(this.pre)){this.movingfnt.push(n);var o=n.getComponent(u);o.recovery(),o.used.apply(o,e)}}else s.default.instance.clearInterval(this.waitInitTodoTime),this.waitInitTodoTime=0},e.prototype.showOne=function(e,t,i,n,o,a,l,c){if(void 0===l&&(l=!1),2==i||4==i||5==i){var d=a.getComponent(r.default).prop.handle;0==this.handleDic[d]?this.handleDic[d]++:this.handleDic[d]=0,e+=this.handleDic[d]%2*50-20}0!=this.isInited?(this.waitInitTodoList.push([e,t,i,n,o,a,l,c,this.recoveryItem,this,Date.now()]),0==this.waitInitTodoTime&&(this.waitInitTodoTime=s.default.instance.setInterval(this.waitInitTodo.bind(this),this,50))):this.waitInitTodoList.push([e,t,i,n,o,a,l,c,this.recoveryItem,this,Date.now()])},e.prototype.showSingle=function(e,t,i,n,o,a,r,l){void 0===r&&(r=!1),0!=this.isInited?(this.waitInitTodoList.push([e,t,i,n,o,a,r,l,this.recoveryItem,this]),0==this.waitInitTodoTime&&(this.waitInitTodoTime=s.default.instance.setInterval(this.waitInitTodo.bind(this),this,100))):this.waitInitTodoList.push([e,t,i,n,o,a,r,l,this.recoveryItem,this])},e.prototype.recoveryAll=function(){for(var e=0;e<this.movingfnt.length;e++)if(this.movingfnt[e].parent){var t=this.movingfnt[e].getComponent(u);t&&1==t.tag&&t.tweenEnd()}this.movingfnt=[],this.handleDic={},s.default.instance.clearInterval(this.waitInitTodoTime),this.waitInitTodoTime=0,this.waitInitTodoList=[]},e.prototype.recoveryItem=function(e){e.getComponent(u).recovery(),this.fntGroup.put(e)},e.prototype.clearAll=function(){this.fntGroup.clear()},e=__decorate([d],e)}();i.default=h;var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Container=null,t.fnt=null,t.baojifont=null,t.spriteAtlas=null,t.srcfont=null,t.effectAni=null,t.tag=0,t.type=0,t.callcomplete=null,t.callcompleteThis=null,t}return __extends(t,e),t.prototype.update=function(){1==this.tag&&this.updateData()},t.prototype.used=function(e,t,i,n,o,a,r,s,c,d){if(void 0===c&&(c=null),void 0===d&&(d=null),this.callcomplete=c,this.callcompleteThis=d,this.type=i,this.effectAni&&this.effectAni.on("finished",this.tweenEnd,this),this.self=s,2==i&&(this.fnt.font=r?this.baojifont:this.srcfont),this.tag=1,this.node.opacity=255,this.node.active=!0,a&&a.parent){var p=l.default.instance.FntSelfLayer,h="-";switch(i){case 1:p=l.default.instance.FntAddLayer,h="+";break;case 2:p=s?l.default.instance.FntSelfLayer:l.default.instance.FntEnemyLayer;break;case 3:p=l.default.instance.FntLZLayer;break;case 4:p=l.default.instance.FntRealLayer;break;case 5:p=l.default.instance.FntReduceLayer,h=""}p.addChild(this.node),this.node.y=t,this.node.x=e,this.fnt.string=h+n,this.startSwing()}else this.dispose()},t.prototype.recovery=function(){this.tag=0,this.node.parent&&(this.node.removeFromParent(!1),this.node.opacity=255,this.node.active=!1)},t.prototype.startSwing=function(){var e;switch(this.type){case 1:e="fntitemAdd";break;case 2:e=this.self?"fntitemSelf":"fntitem";break;case 3:e="fntitemLZ";break;case 4:e="fntitemReal";break;case 5:e="fntitemSelf"}this.effectAni.play(e)},t.prototype.tweenEnd=function(){this.effectAni.stop(),this.effectAni&&this.effectAni.off("finished",this.tweenEnd),this.callcomplete&&this.callcomplete.call(this.callcompleteThis,this.node)},t.prototype.updateData=function(){},t.prototype.dispose=function(){this.recovery()},t.prototype.destroy=function(){return this.recovery(),!1},__decorate([p(cc.Node)],t.prototype,"Container",void 0),__decorate([p(cc.Label)],t.prototype,"fnt",void 0),__decorate([p(cc.Font)],t.prototype,"baojifont",void 0),__decorate([p(cc.SpriteAtlas)],t.prototype,"spriteAtlas",void 0),__decorate([p(cc.Font)],t.prototype,"srcfont",void 0),__decorate([p(cc.Animation)],t.prototype,"effectAni",void 0),t}(n.default);i.FntItem=u,cc._RF.pop()},{"../../../Core/LoadManager":"LoadManager","../../../Core/TimeController":"TimeController","../../../Core/Widget":"Widget","../../../GlobalContext":"GlobalContext","../SceneEntity":"SceneEntity","../View/FightView":"FightView"}],FntSwingUtils:[function(e,t,i){"use strict";cc._RF.push(t,"26dc7d9XdRNaqukEZSQJrmF","FntSwingUtils"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./FntSwingGp"),o=cc._decorator,a=o.ccclass,r=(o.property,function(){function e(){this._fntHurtGp=null,this._fntSelfHurtGp=null,this._fntAddHurtGp=null,this._fntLZHurtGp=null,this._fntRealurtGp=null,this._fntReduceGp=null}var t;return t=e,Object.defineProperty(e,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fntHurtGp",{get:function(){return this._fntHurtGp||(this._fntHurtGp=new n.default,this._fntHurtGp.init("FntItemHurt",10)),this._fntHurtGp},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fntSelfHurtGp",{get:function(){return this._fntSelfHurtGp||(this._fntSelfHurtGp=new n.default,this._fntSelfHurtGp.init("FntItemSelfHurt",10)),this._fntSelfHurtGp},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fntAddHurtGp",{get:function(){return this._fntAddHurtGp||(this._fntAddHurtGp=new n.default,this._fntAddHurtGp.init("FntItemAddHurt",10)),this._fntAddHurtGp},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fntLZHurtGp",{get:function(){return this._fntLZHurtGp||(this._fntLZHurtGp=new n.default,this._fntLZHurtGp.init("FntItemLZHurt",10)),this._fntLZHurtGp},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fntRealurtGp",{get:function(){return this._fntRealurtGp||(this._fntRealurtGp=new n.default,this._fntRealurtGp.init("FntItemRealHurt",10)),this._fntRealurtGp},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fntReduceGp",{get:function(){return this._fntReduceGp||(this._fntReduceGp=new n.default,this._fntReduceGp.init("FntItemReduceCoin",10)),this._fntReduceGp},enumerable:!0,configurable:!0}),e.prototype.recoveryAll=function(){this._fntHurtGp&&this._fntHurtGp.recoveryAll(),this._fntSelfHurtGp&&this._fntSelfHurtGp.recoveryAll(),this._fntAddHurtGp&&this._fntAddHurtGp.recoveryAll(),this._fntLZHurtGp&&this._fntLZHurtGp.recoveryAll(),this._fntRealurtGp&&this._fntRealurtGp.recoveryAll(),this._fntReduceGp&&this._fntReduceGp.recoveryAll()},e.prototype.clearAll=function(){this._fntHurtGp&&this._fntHurtGp.clearAll(),this._fntSelfHurtGp&&this._fntSelfHurtGp.clearAll(),this._fntAddHurtGp&&this._fntAddHurtGp.clearAll(),this._fntLZHurtGp&&this._fntLZHurtGp.clearAll(),this._fntRealurtGp&&this._fntRealurtGp.clearAll(),this._fntReduceGp&&this._fntReduceGp.clearAll()},e.prototype.showSingleHurtValue=function(e,t,i,n,o,a,r){void 0===a&&(a=!1),void 0===r&&(r=0);var s=n+"";this.fntHurtGp.showSingle(e,t,i,s,r,o,a,!1)},e.prototype.showHurtValue=function(e,t,i,n,o,a,r){void 0===a&&(a=!1),void 0===r&&(r=0);var s=n+"";this.fntHurtGp.showOne(e,t,i,s,r,o,a,!1)},e.prototype.showSelfHurtValue=function(e,t,i,n,o,a,r){void 0===a&&(a=!1),void 0===r&&(r=0);var s=n+"";this.fntSelfHurtGp.showOne(e,t,i,s,r,o,a,!0)},e.prototype.showAddHurtValue=function(e,t,i,n,o,a,r){void 0===a&&(a=!1),void 0===r&&(r=0);var s=n+"";this.fntAddHurtGp.showOne(e,t,i,s,r,o,a,!1)},e.prototype.showLZHurtValue=function(e,t,i,n,o,a,r,s){void 0===a&&(a=!1),void 0===r&&(r=0);var l=n+"";this.fntLZHurtGp.showOne(e,t,i,l,r,o,a,s)},e.prototype.showLRealurtValue=function(e,t,i,n,o,a,r,s){void 0===a&&(a=!1),void 0===r&&(r=0);var l=n+"";this.fntRealurtGp.showOne(e,t,i,l,r,o,a,s)},e.prototype.showReduceValue=function(e,t,i,n,o,a,r,s){void 0===a&&(a=!1),void 0===r&&(r=0);var l=n+"";this.fntReduceGp.showOne(e,t,i,l,r,o,a,s)},e=t=__decorate([a],e)}());i.default=r,cc._RF.pop()},{"./FntSwingGp":"FntSwingGp"}],FridBossController:[function(e,t,i){"use strict";cc._RF.push(t,"88a64raImVI3bhOWt6c2o8D","FridBossController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../Status/StatusType"),a=e("../SandTable/SandTableController"),r=e("../../Core/GameEventDispatcher"),s=e("../../Core/Event"),l=e("../../Global/GlobalValue"),c=e("../../Util/SDKUtils"),d=e("../Role/RoleInfo"),p=e("../../Core/ConfigsManager"),h=e("../WarTeam/MonsterController"),u=e("../../NetConnect/NetConnet"),f=e("../Scene/Unit/FightLog"),g=cc._decorator,y=g.ccclass,m=(g.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.FriendBossinitInfo="",t.FriendBossTimes=0,t.ChooseTotem=0,t.cardLevel=1,t.OtherUserId="",t.RewardList=[],t.CDTime=0,t.friendBossInfo=[],t.isSeekHelp=!1,t.FriendInfo=[],t.friendUserID=null,t._configs=null,t._isinit=!0,t.IsFriend=!1,t.fightcount=null,t.guanQiaID=null,t.IsHelp=!1,t.IsGet=!1,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this._configs=p.ConfigsManager.instance.getConfigs("friendbossconf"),i.instance=this},t.prototype.start=function(){r.GameEventDispatcher.instance.on(s.EventDefiner.InitPlayerInfo,this.getSelfBossInfo,this)},t.prototype.getRoleIdTofight=function(){if((console.log("\u5224\u65ad\u662f\u5426\u8fdb\u5165\u5e2e\u52a9\u597d\u53cbboss"),c.default.instance.isInitWX)&&1==c.default.instance.getEnterType()){var e=c.default.instance.getLaunchOptionsSync().query;e.FridBossHelp&&e.FridBossHelp!=d.MyRoleInfo.id&&(console.log("\u5e2e\u52a9\u597d\u53cb:"+e.FridBossHelp),this.sendFridBossFri(e.FridBossHelp,!1))}},t.prototype.listNotification=function(){this.addProto("friendboss",this.fridbossInfo,this),this.addProto("friendbossfriinfo",this.friendbossfriinfo,this),this.addProto("gethelptaskrewardinfo",this.gethelptaskreward,this),this.addProto("getfriendbossinfo",this.FriendBossFriend,this),this.addProto("getrequesthelp",this.FriendHelpList,this)},t.prototype.getSharpstep=function(){return this._configs.FriendBossConf[1].SharpStep},t.prototype.getGuanqiaId=function(){return this._configs.FriendBossConf[1].guanqiaId},t.prototype.getRewardInfo=function(e){var t=this._configs.FriendBossConf[1].finishReward;return this._configs.finishReward[t][e-1].reward},t.prototype.getSelfBossInfo=function(){},t.prototype.fridbossInfo=function(e){console.log("\u597d\u53cbboss\u57fa\u7840\u4fe1\u606f:"+JSON.stringify(e)),this.FriendBossinitInfo=e.info,this.FriendBossTimes=e.times,this.CDTime=e.cdtime,r.GameEventDispatcher.instance.emit(s.EventDefiner.FridBossInfo),this._isinit&&(this._isinit=!1,this.FriendBossTimes>0?this.getRoleIdTofight():console.log("\u4eca\u65e5\u6b21\u6570\u6d88\u8017\u5b8c\uff0c\u65e0\u6cd5\u5e2e\u52a9\u597d\u53cb"))},t.prototype.gethelptaskreward=function(e){this.RewardList=e.reward,this.IsGet=e.flag},t.prototype.getMonterinfo=function(){var e=this._configs.FriendBossConf[1].monster;return this._configs.Monsterinfo[e]},t.prototype.friendbossfriinfo=function(e){this.FriendInfo=e.info.state,this.friendUserID=e.userId,this.fightcount=e.info,r.GameEventDispatcher.instance.emit(s.EventDefiner.HelpFriendFight),console.log("\u8bf7\u6c42\u83b7\u5f97\u597d\u53cb\u7684\u597d\u53cbboss\u6570\u636e\uff1a",e,this.FriendInfo)},t.prototype.sendFridBossfight=function(e){if(e==d.MyRoleInfo.id){var t={cmd:"friendbossfight",index:this.ChooseTotem-1};this.sendProto(t),console.log("\u597d\u53cbboss\u81ea\u5df1\u6218\u6597:"+t.index)}else{t={cmd:"friendbosshelp",friendId:e,index:this.ChooseTotem-1};this.sendProto(t),console.log("\u597d\u53cbboss\u5e2e\u52a9\u522b\u4eba:"+e+"\u4f4d\u7f6e:"+t.index)}},t.prototype.sendFridBossFri=function(e,t){var i={cmd:"friendbossfriinfo",friendId:e,flag:t};this.sendProto(i),console.log("\u597d\u53cbboss\u8bf7\u6c42\u597d\u53cb\u4fe1\u606f:"+e)},t.prototype.PermitEnter=function(e){var t=h.default.instance.getHigherCardLV(),i=h.default.instance.GetLeveMean();if(console.log("\u83b7\u53d6\u5361\u724c\u6700\u9ad8\u4e09\u4e2a\u7b49\u7ea7\u5e73\u5747\u503c:"+t),console.log(i,"\u83b7\u53d6\u524d\u4e94\u7b49\u7ea7\u6700\u9ad8\u5e73\u5747:"+i),t||(t=0),this.cardLevel=2*i,this.OtherUserId=e,c.default.instance.isInitWX){var n=c.default.instance.getItem("FridBoss");n[e]>0&&(a.default.instance.sharpstep=n[e],console.log("\u83b7\u53d6\u6e38\u620f\u5206\u4eab\u83b7\u5f97\u7684\u6b65\u6570:"+n[e]),delete n[e],"{}"==JSON.stringify(n)?c.default.instance.cleanItem("FridBoss"):c.default.instance.setItem("FridBoss",n))}r.GameEventDispatcher.instance.emit(s.EventDefiner.ChangeActivityStatus,o.ActivityStatus.FridBoss),r.GameEventDispatcher.instance.emit(s.EventDefiner.ChangeGameScene,{status:l.GameScene.Fight,guanqiaId:this.guanQiaID})},t.prototype.FriendBossFriend=function(e){this.IsHelp=!1,this.friendBossInfo=e.friendbossinfo,this.isSeekHelp=!1,r.GameEventDispatcher.instance.emit(s.EventDefiner.FriendBossFriend)},t.prototype.FriendHelpList=function(e){console.log(e.friendbossinfo.length,"\u6c42\u52a9\u5217\u8868\u4fe1\u606f"),0!=e.friendbossinfo.length?(this.IsHelp=!0,this.friendBossInfo=e.friendbossinfo,this.isSeekHelp=!0,r.GameEventDispatcher.instance.emit(s.EventDefiner.FriendBossFriend)):this.SendFetFriendBossInfo()},t.prototype.SendFetFriendBossInfo=function(){var e={cmd:"getfriendbossinfo"};u.default.instance.sendProto(e),console.log("\u53d1\u9001\u597d\u53cbboss\u597d\u53cb\u4fe1\u606f",e)},t.prototype.SendGetFriendHelp=function(){u.default.instance.sendProto({cmd:"getrequesthelp"})},t.prototype.SendHelp=function(e){var t={cmd:"requesthelp",friendid:e};u.default.instance.sendProto(t)},t.prototype.DeleteHelp=function(e){var t={cmd:"delrequesthelp",friendid:e};u.default.instance.sendProto(t)},t.prototype.sendGetReward=function(){u.default.instance.sendProto({cmd:"gethelptaskreward"})},t.prototype.onChangeAttrByCoefficient=function(e){var t=h.default.instance.getCardAverageLv(4,11,100),i=(9*(t-10)*(t-10)+1031*(t-10)+8286)/1e4,n=8*i,o=i,a=(11124*(t-10)-1124)/1e4,r=(2236*(t-10)-1236)/1e4;f.default.log("\u602a\u7269\u5361\u724cid"+e.cardid,"\u597d\u53cbboss\u5c5e\u6027----\u66ff\u6362\u524d\uff1a\u7cfb\u65701\uff1a"+n+" \u7cfb\u65702:"+o+" \u7b49\u7ea7:"+o+"\u8840\u91cf\uff1a"+e.attr.GetAttrVale(l.AttrType.MaxHp)+"\u653b\u51fb\uff1a"+e.attr.GetAttrVale(l.AttrType.Attack)+"\u9632\u5fa1\uff1a"+e.attr.GetAttrVale(l.AttrType.Defence)+"\u547d\u4e2d\uff1a"+e.attr.GetAttrVale(l.AttrType.Hit)+"\u95ea\u907f\uff1a"+e.attr.GetAttrVale(l.AttrType.Dodge)+"\u66b4\u51fb\uff1a"+e.attr.GetAttrVale(l.AttrType.Critical)+"\u97e7\u6027\uff1a"+e.attr.GetAttrVale(l.AttrType.DefCri)+"\u96f7\u653b:"+e.attr.GetAttrVale(l.AttrType.ThunderAttack)+"\u96f7\u9632\uff1a"+e.attr.GetAttrVale(l.AttrType.ThunderDef)+"\u571f\u653b\uff1a"+e.attr.GetAttrVale(l.AttrType.EarthAttack)+"\u571f\u9632\uff1a"+e.attr.GetAttrVale(l.AttrType.EarthDef)+"\u6c34\u653b\uff1a"+e.attr.GetAttrVale(l.AttrType.WaterAttack)+"\u6c34\u9632\uff1a"+e.attr.GetAttrVale(l.AttrType.WaterDef)+"\u706b\u653b \uff1a"+e.attr.GetAttrVale(l.AttrType.FireAttack)+"\u706b\u9632\uff1a"+e.attr.GetAttrVale(l.AttrType.FireDef)+"\u98ce\u653b\uff1a"+e.attr.GetAttrVale(l.AttrType.WindAttack)+"\u98ce\u9632\uff1a"+e.attr.GetAttrVale(l.AttrType.WindDef));for(var s=l.AttrType.MaxHp;s<=l.AttrType.WindDef;s++){var c=e.attr.GetVale(s),d=1;d=s<l.AttrType.Attack?n:s<l.AttrType.Hit?o:s<l.AttrType.ThunderAttack?a:r,e.attr.ChangeAtt(s,c*d)}f.default.log("\u597d\u53cbboss\u5c5e\u6027----\u66ff\u6362\u540e\uff1a","\u8840\u91cf\uff1a"+e.attr.GetAttrVale(l.AttrType.MaxHp)+"\u653b\u51fb\uff1a"+e.attr.GetAttrVale(l.AttrType.Attack)+"\u9632\u5fa1\uff1a"+e.attr.GetAttrVale(l.AttrType.Defence)+"\u547d\u4e2d\uff1a"+e.attr.GetAttrVale(l.AttrType.Hit)+"\u95ea\u907f\uff1a"+e.attr.GetAttrVale(l.AttrType.Dodge)+"\u66b4\u51fb\uff1a"+e.attr.GetAttrVale(l.AttrType.Critical)+"\u97e7\u6027\uff1a"+e.attr.GetAttrVale(l.AttrType.DefCri)+"\u96f7\u653b:"+e.attr.GetAttrVale(l.AttrType.ThunderAttack)+"\u96f7\u9632\uff1a"+e.attr.GetAttrVale(l.AttrType.ThunderDef)+"\u571f\u653b\uff1a"+e.attr.GetAttrVale(l.AttrType.EarthAttack)+"\u571f\u9632\uff1a"+e.attr.GetAttrVale(l.AttrType.EarthDef)+"\u6c34\u653b\uff1a"+e.attr.GetAttrVale(l.AttrType.WaterAttack)+"\u6c34\u9632\uff1a"+e.attr.GetAttrVale(l.AttrType.WaterDef)+"\u706b\u653b \uff1a"+e.attr.GetAttrVale(l.AttrType.FireAttack)+"\u706b\u9632\uff1a"+e.attr.GetAttrVale(l.AttrType.FireDef)+"\u98ce\u653b\uff1a"+e.attr.GetAttrVale(l.AttrType.WindAttack)+"\u98ce\u9632\uff1a"+e.attr.GetAttrVale(l.AttrType.WindDef))},t.instance=null,t=i=__decorate([y],t)}(n.default));i.default=m,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Global/GlobalValue":"GlobalValue","../../NetConnect/NetConnet":"NetConnet","../../Util/SDKUtils":"SDKUtils","../Role/RoleInfo":"RoleInfo","../SandTable/SandTableController":"SandTableController","../Scene/Unit/FightLog":"FightLog","../Status/StatusType":"StatusType","../WarTeam/MonsterController":"MonsterController"}],FridBossHelpList:[function(e,t,i){"use strict";cc._RF.push(t,"1d1cexbcGBKeIq3fz1qdLPz","FridBossHelpList"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("./FridBossController"),a=e("../../Util/GrayEffect"),r=e("../../Core/Language"),s=e("../../Util/ColorUtil"),l=e("../../Util/SDKUtils"),c=e("../Role/RoleInfo"),d=e("../Tips/OpTipsController"),p=e("../Gamelayer/RoleHead"),h=e("../../NetConnect/NetConnet"),u=cc._decorator,f=u.ccclass,g=u.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.totemList=null,t.Remain=null,t.WechatBtnstr=null,t.Remain1=null,t.fontTips=null,t.fontTips1=null,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this),this.WechatBtnstr.string=r.default.getStr("WeChatFri"),this.fontTips.string=r.default.getStr("FridbossTip3"),this.fontTips1.string=r.default.getStr("FridbossTip4")},t.prototype.show=function(){e.prototype.show.call(this),this.BuildList()},t.prototype.hide=function(){e.prototype.hide.call(this)},t.prototype.BuildList=function(){var e=o.default.instance.FriendBossinitInfo.state,t=1-o.default.instance.FriendBossinitInfo.friendFight,i=0;for(var n in this.totemList.children){var l=this.totemList.children[n];e[n]?(l.getChildByName("RoleHead").active=!0,l.getChildByName("RoleHead").getComponent(p.default).SetHead(e[n].icon),l.getComponentInChildren(a.default).setGray(!0),l.getChildByName("totemDown").active=!1,i++):(l.getChildByName("RoleHead").active=!1,l.getChildByName("totemDown").active=!0)}this.Remain.string=r.default.getStr("FridbossTip1","<color="+s.ColorUtil.BLUE_STR+">"+(this.totemList.childrenCount-i)+r.default.getStr("A")+"</color>"),this.Remain1.string=r.default.getStr("FridbossTip2","<color="+s.ColorUtil.BLUE_STR+">"+t+r.default.getStr("A")+"</color>")},t.prototype.InviteFri=function(){l.default.instance.isInitWX&&(console.log("\u9080\u8bf7\u5fae\u4fe1\u597d\u53cb"),l.default.instance.shareAppMessage(function(){h.default.instance.sendProto({cmd:"friendbossshare"}),console.log("\u5206\u4eab\u6210\u529f\uff0c\u53d1\u9001\u534f\u8baefriendbossshare")},this,"FridBossHelp="+c.MyRoleInfo.id,function(){d.default.instance.ShowMsg(r.default.getStr("SharpFair")+","+r.default.getStr("retry"))},this))},__decorate([g(cc.Node)],t.prototype,"totemList",void 0),__decorate([g(cc.RichText)],t.prototype,"Remain",void 0),__decorate([g(cc.Label)],t.prototype,"WechatBtnstr",void 0),__decorate([g(cc.RichText)],t.prototype,"Remain1",void 0),__decorate([g(cc.Label)],t.prototype,"fontTips",void 0),__decorate([g(cc.Label)],t.prototype,"fontTips1",void 0),t=__decorate([f],t)}(n.default);i.default=y,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/Widget":"Widget","../../NetConnect/NetConnet":"NetConnet","../../Util/ColorUtil":"ColorUtil","../../Util/GrayEffect":"GrayEffect","../../Util/SDKUtils":"SDKUtils","../Gamelayer/RoleHead":"RoleHead","../Role/RoleInfo":"RoleInfo","../Tips/OpTipsController":"OpTipsController","./FridBossController":"FridBossController"}],FridBossResult:[function(e,t,i){"use strict";cc._RF.push(t,"f44cbnSKrZMxLxM7v3i+BKS","FridBossResult"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/Language"),a=e("./FridBossController"),r=e("../../Util/SDKUtils"),s=e("../Status/StatusController"),l=e("../../GlobalContext"),c=e("../../Core/CommonsResManager"),d=cc._decorator,p=d.ccclass,h=d.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ChooseIcon=null,t.Totem=null,t.BtnList=null,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this),this.BtnList.getChildByName("Btn4").getComponentInChildren(cc.Label).string=o.default.getStr("SharpAdd"),this.BtnList.getChildByName("Btn3").getComponentInChildren(cc.Label).string=o.default.getStr("Sure"),this.node.getChildByName("MaskBg").setContentSize(l.GlobalContext.UIWidth,l.GlobalContext.UIHeight)},t.prototype.show=function(){e.prototype.show.call(this),i.instance=this},t.prototype.hide=function(){e.prototype.hide.call(this)},t.prototype.initInfo=function(e){void 0===e&&(e=!0),e?(this.ChooseIcon.getChildByName("succese").active=!0,this.ChooseIcon.getChildByName("fair").active=!1,this.BtnList.getChildByName("Btn4").active=!1,this.Totem.getChildByName("totem_down").active=!1,this.Totem.getChildByName("totem").getComponent(cc.Sprite).spriteFrame=c.default.instance.getSpriteFrameByName("totem_"+a.default.instance.ChooseTotem+"_1"),a.default.instance.sendFridBossfight(a.default.instance.OtherUserId)):(this.ChooseIcon.getChildByName("succese").active=!1,this.ChooseIcon.getChildByName("fair").active=!0,this.BtnList.getChildByName("Btn4").active=!0,this.Totem.getChildByName("totem_down").active=!0,this.Totem.getChildByName("totem").getComponent(cc.Sprite).spriteFrame=c.default.instance.getSpriteFrameByName("totem_"+a.default.instance.ChooseTotem))},t.prototype.Btnclicksure=function(){s.default.instance.activityStatusHandle()},t.prototype.WechatSharp=function(){console.log("\u5fae\u4fe1\u5206\u4eab\u6e38\u620f");var e=a.default.instance.getSharpstep();a.default.instance.OtherUserId;r.default.instance.shareAppMessage(function(){r.default.instance.setItem("FridBoss",{id:e})},this),this.Btnclicksure()},t.instance=null,__decorate([h(cc.Node)],t.prototype,"ChooseIcon",void 0),__decorate([h(cc.Node)],t.prototype,"Totem",void 0),__decorate([h(cc.Node)],t.prototype,"BtnList",void 0),t=i=__decorate([p],t)}(n.default);i.default=u,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Language":"Language","../../Core/Widget":"Widget","../../GlobalContext":"GlobalContext","../../Util/SDKUtils":"SDKUtils","../Status/StatusController":"StatusController","./FridBossController":"FridBossController"}],FridBossWin:[function(e,t,i){"use strict";cc._RF.push(t,"4bb32wvtYtM54gO+S3m6YPl","FridBossWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("./FridBossController"),a=e("../../Core/Language"),r=e("../../Util/ColorUtil"),s=e("../Gamelayer/RoleHead"),l=e("../Tips/OpTipsController"),c=e("../Role/RoleInfo"),d=e("../../Core/GameEventDispatcher"),p=e("../../Core/Event"),h=e("../../GlobalContext"),u=e("../../Core/WindowManager"),f=e("../../Core/WindowType"),g=e("../Commons/RewardUtils"),y=e("../../Util/Utils"),m=e("../Item/ItemIcon"),C=e("../Commons/WindowBg2"),v=e("../../Util/LocalStorageUtils"),_=e("../../Core/TimeController"),b=e("../../Util/SDKUtils"),T=e("../Commons/MonsterPreview"),S=e("../WarTeam/MonsterController"),I=e("./HelpFriendsWin"),w=e("../Activity/ActivityController"),D=e("../../Global/GlobalValue"),R=e("./HelpFriendWin"),A=e("../OpenWin/OpenWinController"),N=e("../Tips/RewardTips"),L=e("../../Core/CommonsResManager"),E=e("../../Util/CommonUtil"),B=cc._decorator,M=B.ccclass,x=B.property,k=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.HelpList=null,t.FirendWin=null,t.BtnList=null,t.AttrList=null,t.BoxList=null,t.RuleList=null,t.RewardMask=null,t.ItemList=null,t.RewardList=null,t.HelpContent=null,t.InviteTips=null,t.Selfpic=null,t.ItemIcon=null,t.DaimondList=null,t.Mask=null,t.CountDown=null,t.TimeLabe=null,t.BoxImage=null,t.OpenBox=null,t.HlepFriendList=null,t.RightNode=null,t.Finger=null,t.aureole=null,t.BoxLighit=null,t.chooseNode=null,t.attrlistarr={},t.isplayact=!1,t.playspine={},t.spinename=["stand","blue","green","purple","red","yellow"],t.timeOut=null,t.TimeCD=null,t.isCD=!1,t.isNo1=!1,t.arry=[],t.left=0,t.time=0,t.monsterinfo=null,t.guanqiaID=null,t.bool=!1,t.bool1=!1,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){var t=this;this.onInit(f.WindowType.FridBoss,!0),this.loadWindowCom=function(){t.node.getChildByName("Bg").setSiblingIndex(1)},this.loadWindowComThis=this,e.prototype.onLoad.call(this);for(var i=0;i<this.AttrList.childrenCount;i++){var n=this.AttrList.children[i];this.attrlistarr[i]={sca:n.scale,posi:n.getPosition(),index:i}}},t.prototype.show=function(){e.prototype.show.call(this),this.openInitNode(),this.isplayact=!1,this.RewardMask.active=!1,this.isNo1=!1,this.BtnList.parent.x=h.GlobalContext.UIWidth/2-this.BtnList.width/2,this.HlepFriendList.x=h.GlobalContext.UIWidth/2-this.BtnList.width/2,o.default.instance.getSelfBossInfo(),0==o.default.instance.IsFriend&&(this.BtnList.active=!0,this.RightNode.active=!0,this.HlepFriendList.active=!1,this.timeer(),this.initSecene(),d.GameEventDispatcher.instance.on(p.EventDefiner.FridBossInfo,this.Boxanimevent,this))},t.prototype.hide=function(){e.prototype.hide.call(this),d.GameEventDispatcher.instance.off(p.EventDefiner.FridBossInfo,this.Boxanimevent,this);for(var t=0;t<this.HelpContent.childrenCount;t++)this.HelpContent.children[t].active=!1;this.BtnList.active=!1,o.default.instance.IsFriend=!1,this.CountDown.active=!1,this.bool=!1,this.bool1=!1,R.default.instance.isFriend=!1,this.timeOut&&_.default.instance.clearInterval(this.timeOut),this.timeOut=null},t.prototype.start=function(){e.prototype.start.call(this),this.BtnList.getComponentInChildren(cc.Button).node.getComponentInChildren(cc.Label).string=a.default.getStr("Seek")+a.default.getStr("Help"),i.instance=this;var t=h.GlobalContext.UIHeight/2-this.node.height/2;this.BtnList.parent.y+=t,this.HelpList.getChildByName("MaskBg").setContentSize(h.GlobalContext.UIWidth,h.GlobalContext.UIHeight),this.InviteTips.string=a.default.getStr("InviteTips")},t.prototype.Boxanimevent=function(){var e=this,t=!0;this.timeer(),w.default.instance.isFrist&&(this.BoxList.active=!0);var i=[];if(this.playspine={},this.arry=this.arry=o.default.instance.FriendBossinitInfo.state,this.time=o.default.instance.FriendBossTimes,cc.find("helpCount",this.BtnList).getComponent(cc.RichText).string=a.default.getStr("Helpcount")+"<color="+r.ColorUtil.BLUE_STR+">:"+a.default.getStr("Times",this.time)+"</color>",w.default.instance.isFrist)for(var n=0;n<this.AttrList.childrenCount;n++){var s=this.AttrList.getChildByName("downstage"+(n+1)),l=s.index_td_num;if(this.arry[l]&&(this.playspine[l]=this.arry[l].userId,i.push(s.getSiblingIndex()),s.getChildByName("SecondBtn1").active=!1),Object.keys(this.playspine).length>0){var d=Math.floor(Math.random()*i.length);this.setDownstageposi(null,i[d]+"")}}var p=function(i){h.BoxList.children[i].getComponent(sp.Skeleton).setCompleteListener(function(n){if(n.animation.name.indexOf("1")>-1&&n.animation.name.indexOf("box_1_")>-1&&t&&(console.log("\u5b9d\u77f3\u788e\u88c2",i),t=!1,e.initSecene(1),null!=o.default.instance.RewardList&&e.arry.length>=5&&0==o.default.instance.IsGet)){for(var a=5;a>=1;a--)e.BoxList.active=!0,e.BoxList.children[a].active=!0;e.BoxList.runAction(cc.fadeTo(0,255)),e.BoxList.children[0].stopAllActions(),e.BoxList.children[0].getComponent(sp.Skeleton).setAnimation(0,"box_1_stand",!0),e.RewardMask.active=!0,e.Mask.active=!1}if(n.animation.name.indexOf("monster")>-1){console.log(n.animation.name,"\u7b2c\u4e09\u4e2aif=============="),e.BoxList.active=!0,e.BoxList.children[6].active=!1,w.default.instance.isFrist&&(e.BoxList.children[0].active=!0);for(a=5;a>=1;a--)e.BoxList.children[a].getComponent(sp.Skeleton).setAnimation(0,"box_1_"+e.spinename[a]+"1",!0);e.BoxList.runAction(cc.fadeTo(0,255)),e.BoxList.children[0].runAction(cc.fadeTo(0,255)),e.BoxList.children[i].runAction(cc.fadeTo(0,255)),e.BoxList.children[0].getComponent(sp.Skeleton).setAnimation(0,"box_2_guang",!0),e.Mask.active=!0}if(n.animation.name.indexOf("guang")>-1&&n.animation.name.indexOf("2")>-1){console.log("\u7b2c\u4e8c\u4e2aif=============="),e.BoxList.children[6].active=!1;var r=new Date(_.default.instance.ServerTimeMins),s={};s[""+r.getFullYear()+r.getMonth()+r.getDate()]={};var l=v.default.instance.getItem(c.MyRoleInfo.id+"FridBoss_SLM");l&&l[""+r.getFullYear()+r.getMonth()+r.getDate()]&&(s[""+r.getFullYear()+r.getMonth()+r.getDate()]=l[""+r.getFullYear()+r.getMonth()+r.getDate()]),t=!0;for(a=5;a>=1;a--)e.BoxList.children[a].getComponent(sp.Skeleton).paused=!1,e.playspine[a-1]?(s[""+r.getFullYear()+r.getMonth()+r.getDate()][e.playspine[a-1]]=!0,e.BoxList.children[a].active=!0,e.BoxList.children[a].getComponent(sp.Skeleton).setAnimation(0,"box_1_"+e.spinename[a]+"1",!0)):e.BoxList.children[a].getComponent(sp.Skeleton).setAnimation(0,"box_1_"+e.spinename[a]+"2",!1);if(e.Mask.active=!1,e.BoxList.children[0].getComponent(sp.Skeleton).setAnimation(0,"box_1_stand",!1),v.default.instance.setItem(c.MyRoleInfo.id+"FridBoss_SLM",s),null!=o.default.instance.RewardList&&e.arry.length>=5&&0==o.default.instance.IsGet){for(a=5;a>=1;a--)e.BoxList.active=!0,e.BoxList.children[a].active=!0;e.BoxList.runAction(cc.fadeTo(0,255)),e.BoxList.children[0].getComponent(sp.Skeleton).setAnimation(0,"box_1_stand",!0),e.RewardMask.active=!0,e.BoxList.children[0].active=!0,e.BoxList.stopAllActions(),e.BoxLighit.stopAllActions()}else e.BoxList.runAction(cc.fadeTo(1,0)),e.BoxList.children[i].runAction(cc.fadeTo(1,0))}if(n.animation.name.indexOf("box_2_open")>-1){console.log("\u7b2c\u56db\u4e2aif============="),e.BoxList.active=!0,e.BoxList.children[0].active=!0,e.BoxList.children[0].getComponent(sp.Skeleton).setAnimation(0,"box_2_stand",!0);var d=o.default.instance.RewardList,p=g.default.instance.getItemListByServerData(d);A.default.instance.openWindow(f.WindowType.RewardTips,function(){N.default.instance.setData(p)})}})},h=this;for(n=0;n<this.BoxList.childrenCount;n++)p(n);w.default.instance.isFrist=!0},t.prototype.Rewardmaskevent=function(){if(console.log("Rewardmaskevent\u65b9\u6cd5\u6267\u884c\u4e86"),!o.default.instance.IsGet){this.Finger.active=!1,this.aureole.active=!1,this.Finger.stopAllActions(),this.aureole.stopAllActions(),this.BoxLighit.active=!1,this.BoxList.active=!1;for(var e=5;e>=1;e--)this.BoxList.children[e].active=!1;o.default.instance.sendGetReward(),this.BoxList.active=!0,this.BoxList.children[0].active=!0,A.default.instance.openWindow(f.WindowType.RewardTips,function(){var e=o.default.instance.RewardList,t=g.default.instance.getItemListByServerData(e);N.default.instance.setData(t)}),this.BoxList.active=!0,this.BoxList.children[0].active=!0,this.BoxList.children[0].getComponent(sp.Skeleton).setAnimation(0,"box_2_stand",!0)}},t.prototype.initSecene=function(e){var t=this;console.log("\u597d\u53cbBoss\u754c\u9762\u8bbe\u7f6e",e);var i=new Date(_.default.instance.ServerTimeMins),n={};n[""+i.getFullYear()+i.getMonth()+i.getDate()]={},this.BoxList.children[6].active=!1,this.arry=o.default.instance.FriendBossinitInfo.state,this.left=o.default.instance.FriendBossinitInfo.selfFight,this.monsterinfo=o.default.instance.getMonterinfo(),v.default.instance.setItem(c.MyRoleInfo.id+"FridBoss_SLM",n);var l=v.default.instance.getItem(c.MyRoleInfo.id+"FridBoss_SLM"),d=null;l&&(d=l[""+i.getFullYear()+i.getMonth()+i.getDate()]),d||v.default.instance.removeItem(c.MyRoleInfo.id+"FridBoss_SLM");for(var p=null,h=0;h<this.arry.length;h++){if(null==this.arry[h]){p=!0;break}p=!1}if(d&&this.arry.length>=5&&0==p&&1!=e&&1==o.default.instance.IsGet)this.BoxImage.active=!1,this.OpenBox.active=!0,this.BoxList.children[0].getComponent(sp.Skeleton).setAnimation(0,"box_2_stand",!0);else{this.BoxImage.active=!0,this.OpenBox.active=!1,this.BoxList.stopAllActions(),this.BoxLighit.stopAllActions(),this.BoxList.y=-135,this.BoxLighit.y=156.6;var u=cc.sequence(cc.moveTo(.5,-233,148),cc.moveTo(.5,-233,153)),C=cc.sequence(cc.moveTo(.5,-233,-150),cc.moveTo(.5,-233,-135));u.repeatForever(),C.repeatForever(),this.BoxLighit.runAction(u)}if(null!=o.default.instance.RewardList&&this.arry.length>=5&&0==o.default.instance.IsGet){for(var b=5;b>=1;b--)this.BoxList.children[b].active=!0;this.BoxLighit.active=!0,this.BoxList.active=!0,this.BoxList.children[0].getComponent(sp.Skeleton).setAnimation(0,"box_1_stand",!0),this.BoxList.children[0].active=!0,this.BoxList.runAction(cc.fadeTo(0,255)),this.RewardMask.active=!0,this.Finger.active=!0,this.aureole.active=!0,this.Finger.stopAllActions(),this.Finger.runAction(cc.repeatForever(cc.sequence(cc.moveTo(.8,-111,28),cc.moveTo(.8,-192,83)))),this.aureole.children[1].runAction(cc.repeatForever(cc.sequence(cc.scaleTo(1,.3),cc.scaleTo(0,1.5)))),this.BoxList.children[0].active=!0}if(null!=o.default.instance.RewardList&&1==o.default.instance.IsGet){for(b=5;b>=1;b--)this.BoxList.children[b].active=!1;this.Finger.active=!1,this.aureole.active=!1,this.BoxLighit.active=!1,this.Finger.stopAllActions(),this.aureole.stopAllActions(),this.BoxList.active=!0,this.BoxList.children[0].active=!0,this.BoxList.runAction(cc.fadeTo(0,250)),this.BoxList.children[0].runAction(cc.fadeTo(0,250)),this.BoxList.children[0].getComponent(sp.Skeleton).setAnimation(0,"box_2_stand",!0),this.BoxList.runAction(cc.fadeTo(2.5,0))}this.AttrList.active=!0;this.playspine={};var I=[];for(h=0;h<this.arry.length;h++)null!=this.arry[h]?this.DaimondList.children[h].children[0].active=!0:this.DaimondList.children[h].children[0].active=!1;var R=0,A=function(i){var n=N.AttrList.getChildByName("downstage"+(i+1));n.index_td_num||0==n.index_td_num||(n.attr({index_td_num:i}),console.log("\u8282\u70b9\u521d\u59cb\u4f4d\u7f6e:"+i));var o=n.index_td_num;if(n.off("touchstart",N.setDownstageposi,N),n.getChildByName("SecondBtn1").active=!0,n.getChildByName("MonsterPreview").active=!1,0==i&&(R=1==N.isNo1?2e3:0),N.arry[o]&&d)if(N.TimeCD=_.default.instance.setTimeout(function(){w.default.instance.isFrist&&t.arry.length<5&&(t.BoxList.children[o+1].active=!0),n.getChildByName("Light").active=!0,n.getChildByName("MonsterPreview").active=!1,n.getChildByName("rune").active=!1,n.getChildByName("Light").getChildByName("RoleHead").getComponent(s.default).SetHead(t.arry[o].icon);var e=t.arry[o].name.length>6?t.arry[o].name.substr(0,6)+"...":t.arry[o].name;n.getChildByName("Light").getChildByName("nameDown").getComponentInChildren(cc.Label).string=e,_.default.instance.clearTimeout(t.TimeCD),t.TimeCD=0},N,R),N.arry[o].userId==c.MyRoleInfo.id)n.getChildByName("SecondBtn1").active=!1,n.getChildByName("SecondBtn3").active=!1,n.getChildByName("Five").active=!1;else{n.getChildByName("SecondBtn1").active=!0,n.getChildByName("SecondBtn1").getComponentInChildren(cc.Label).string=a.default.getStr("ThankFrid"),n.getChildByName("SecondBtn1").getComponent(cc.Button).clickEvents[0].customEventData="1",n.getChildByName("SecondBtn3").active=!1,n.getChildByName("Five").active=!1;var l=void 0;N.HelpContent.children[i]?l=N.HelpContent.children[i]:(l=cc.instantiate(N.HelpContent.children[0]),N.HelpContent.addChild(l));var p=S.default.instance.GetMonsterInfo(N.monsterinfo[o].id).cardName;console.log(p),l.active=!0;var h=N.arry[o].name.length>6?N.arry[o].name.substr(0,6)+"...":N.arry[o].name;l.getComponent(cc.RichText).string="<colcor = '"+r.ColorUtil.colorStr(7)+"'>"+h+"</color><color = '"+r.ColorUtil.colorStr(8)+"'>"+a.default.getStr("successkill")+p+"</color>"}else if(n.getChildByName("Light").active=!1,n.getChildByName("rune").active=!0,N.BoxList.children[o+1].active=!1,0==N.left||1==N.isCD?(n.getChildByName("SecondBtn1").getComponentInChildren(cc.Label).string=a.default.getStr("fight"),n.getChildByName("SecondBtn1").getComponent(cc.Button).clickEvents[0].customEventData="0",n.getChildByName("SecondBtn3").active=!1):(n.getChildByName("SecondBtn1").getComponent(cc.Button).clickEvents[0].customEventData="2",n.getChildByName("SecondBtn1").getComponentInChildren(cc.Label).string=a.default.getStr("FindHelp"),n.getChildByName("SecondBtn3").active=!1),N.arry[o])N.playspine[o]=N.arry[o].userId,I.push(n.getSiblingIndex()),n.getChildByName("SecondBtn1").active=!1,n.getChildByName("Five").active=!1;else switch(n.getChildByName("MonsterPreview").active=!0,n.getChildByName("MonsterPreview").setScale(.8),n.getChildByName("MonsterPreview").getComponent(T.default).init("monster",N.monsterinfo[i].id,N.monsterinfo[i].grade,D.DEFAULTS_SKIN+"5"),n.getChildByName("SecondBtn3").active=!1,n.getChildByName("Five").active=!0,N.monsterinfo[i].attribute){case 1:n.getChildByName("Five").getComponent(cc.Sprite).spriteFrame=L.default.instance.getSpriteFrameByName("fiveLine_1");break;case 2:n.getChildByName("Five").getComponent(cc.Sprite).spriteFrame=L.default.instance.getSpriteFrameByName("fiveLine_2");break;case 3:n.getChildByName("Five").getComponent(cc.Sprite).spriteFrame=L.default.instance.getSpriteFrameByName("fiveLine_3");break;case 4:n.getChildByName("Five").getComponent(cc.Sprite).spriteFrame=L.default.instance.getSpriteFrameByName("fiveLine_4");break;case 5:n.getChildByName("Five").getComponent(cc.Sprite).spriteFrame=L.default.instance.getSpriteFrameByName("fiveLine_5")}n.on("touchstart",N.setDownstageposi,N),1!=e&&(N.isNo1=!0)},N=this;for(h=0;h<this.AttrList.childrenCount;h++)A(h);var E=o.default.instance.getRewardInfo(5),B=g.default.instance.getItemList(E);for(h=0;h<6&&B[h];h++){var M=y.default.getNodeByPool(f.PoolType.ItemIcon,this.ItemIcon);M.getComponent(m.default).ItemData(B[h],!0,null,!0),this.ItemList.insertChild(M,h)}for(h=this.ItemList.childrenCount-1;h>=B.length;h--)y.default.setNodeToPool(f.PoolType.ItemIcon,this.ItemList.children[h])},t.prototype.chooseAttr=function(e,t){switch(o.default.instance.IsFriend=!1,this.chooseNode,this.chooseNode=e.target,o.default.instance.ChooseTotem=this.chooseNode.parent.index_td_num+1,this.setDownstageposi(null,e.target.parent.getSiblingIndex()+""),this.guanqiaID=this.monsterinfo[this.chooseNode.parent.index_td_num].guanqia,console.log("\u9009\u62e9\u5c5e\u6027\u6218\u6597:"+(this.chooseNode.parent.index_td_num+1)),t){case"0":console.log("\u81ea\u5df1\u6218\u6597"),o.default.instance.ChooseTotem=this.chooseNode.parent.index_td_num+1,o.default.instance.guanQiaID=this.guanqiaID,this.PermitEnter();break;case"1":b.default.instance.isInitWX?b.default.instance.shareAppMessage(function(){console.log("\u5206\u4eab\u611f\u8c22\u597d\u53cb\u6210\u529f")},this,null,null,null,a.default.getStr("ThankFrid")):console.log("\u65e0\u6cd5\u611f\u8c22\uff0c\u4e0d\u662f\u5fae\u4fe1");break;case"2":o.default.instance.ChooseTotem=this.chooseNode.parent.index_td_num+1,this.openHelpList()}},t.prototype.setDownstageposi=function(e,t){var i=e?e.target.getSiblingIndex():parseInt(t);if(console.log(i),!this.isplayact){this.isplayact=!0;var n={};if(i>2)for(var o=0;o<this.AttrList.childrenCount;o++){n[o]=[];for(var a=1;a<=5-i;a++){(r=a+o)>=5&&(r-=5),n[o].push(this.attrlistarr[r])}}else for(o=0;o<this.AttrList.childrenCount;o++){n[o]=[];for(a=1;a<=i;a++){var r;(r=o-a)<0&&(r+=5),n[o].push(this.attrlistarr[r])}}this.switchposi(n)}},t.prototype.openInitNode=function(){this.HelpList.active=!1},t.prototype.openHelpList=function(){this.HelpList.active=!0},t.prototype.HelpFriend=function(){this.FirendWin.active=!0,this.FirendWin.getComponent(I.default).show(),o.default.instance.SendGetFriendHelp()},t.prototype.findHelp=function(){E.CommonUtil.OpenChatWin()},t.prototype.PermitEnter=function(){var t=o.default.instance.FriendBossinitInfo.selfFight;console.log("\u8fdb\u5165\u6218\u6597:"+o.default.instance.ChooseTotem),t<=0||1==this.isCD?o.default.instance.PermitEnter(c.MyRoleInfo.id):l.default.instance.ShowMsg(a.default.getStr("\u4eca\u5929\u5df2\u7ecf\u5e2e\u52a9\u8fc7\u4ed6\u4e86\uff0c\u660e\u5929\u518d\u6765\u5427")),e.prototype.hide.call(this)},t.prototype.closethisWindow=function(){u.default.instance.close(f.WindowType.FridBoss)},t.prototype.OpenRuleList=function(e,t){if(this.node.getChildByName("RuleMaskBg").setContentSize(h.GlobalContext.UIWidth,h.GlobalContext.UIHeight),t)this.RuleList.active=!1,this.node.getChildByName("RuleMaskBg").active=!1;else{this.RuleList.getComponent(C.default).Title=a.default.getStr("FridbossRuletitle");for(var i=0;i<this.RuleList.getChildByName("Container").getComponentsInChildren(cc.Label).length;i++)this.RuleList.getChildByName("Container").getComponentsInChildren(cc.Label)[i].string=a.default.getStr("FridbossRule"+(i+1));this.RuleList.active=!0,this.node.getChildByName("RuleMaskBg").active=!0}},t.prototype.switchposi=function(e){var t=this,i=function(o,a){a.stopAllActions();if(void 0!=e[o][0]){var r=cc.sequence(cc.spawn(cc.scaleTo(.5,e[o][0].sca),cc.moveTo(.5,e[o][0].posi)),cc.callFunc(function(){a.setPosition(e[o][0].posi),a.setScale(e[o][0].sca);e[o].shift();e[o].length>0?i(o,a):n()},t));r.setTag(o),a.runAction(r)}},n=function(){t.isplayact=!1,Object.keys(t.playspine).length>0&&(t.BoxList.children[6].active=!0,t.BoxList.stopAllActions(),t.BoxLighit.stopAllActions(),t.BoxList.y=-135,t.BoxList.children[6].getComponent(sp.Skeleton).setAnimation(1,"monster_glow",!1));for(var e=0;e<t.AttrList.childrenCount;e++){var i=t.AttrList.getChildByName("downstage"+(e+1));for(var n in t.attrlistarr)if(i.getPosition().equals(t.attrlistarr[n].posi)){i.zIndex=parseInt(n);break}}};for(var o in e)if(e[o].length>=0&&w.default.instance.isFrist){n();break}for(var o in e){this.isplayact=!1;var a=parseInt(o),r=this.AttrList.children[a];i(a,r)}},t.prototype.repeargem=function(){for(var e in this.playspine)parseInt(e)},t.prototype.timeer=function(){var e=this,t=_.default.instance.ServerTimeMins,i=o.default.instance.CDTime;this.timeOut&&(_.default.instance.clearInterval(this.timeOut),this.timeOut=null),this.timeOut=_.default.instance.setInterval(function(){var n=i-(t+=1e3);if(n<=1e3&&0==e.bool)e.isCD=!0,e.CountDown.active=!1,e.initSecene(),e.bool=!0;else if(n>=1e3){e.isCD=!1;var o=parseInt(""+n/1e3/60%60),a=parseInt(""+n/1e3%60);e.TimeLabe&&(e.TimeLabe.string=o+":"+a);for(var r=0;r<e.AttrList.childrenCount;r++){if(!(e.arry.length>=5)){e.CountDown.active=!0;break}if(null==e.arry[r]||void 0==e.arry[r]){e.CountDown.active=!0;break}e.CountDown.active=!1}0==e.bool1&&(e.initSecene(),e.bool1=!0)}},this,1e3)},t.instance=null,__decorate([x(cc.Node)],t.prototype,"HelpList",void 0),__decorate([x(cc.Node)],t.prototype,"FirendWin",void 0),__decorate([x(cc.Node)],t.prototype,"BtnList",void 0),__decorate([x(cc.Node)],t.prototype,"AttrList",void 0),__decorate([x(cc.Node)],t.prototype,"BoxList",void 0),__decorate([x(cc.Node)],t.prototype,"RuleList",void 0),__decorate([x(cc.Node)],t.prototype,"RewardMask",void 0),__decorate([x(cc.Node)],t.prototype,"ItemList",void 0),__decorate([x(cc.Node)],t.prototype,"RewardList",void 0),__decorate([x(cc.Node)],t.prototype,"HelpContent",void 0),__decorate([x(cc.Label)],t.prototype,"InviteTips",void 0),__decorate([x(cc.SpriteAtlas)],t.prototype,"Selfpic",void 0),__decorate([x(cc.Prefab)],t.prototype,"ItemIcon",void 0),__decorate([x(cc.Node)],t.prototype,"DaimondList",void 0),__decorate([x(cc.Node)],t.prototype,"Mask",void 0),__decorate([x(cc.Node)],t.prototype,"CountDown",void 0),__decorate([x(cc.Label)],t.prototype,"TimeLabe",void 0),__decorate([x(cc.Node)],t.prototype,"BoxImage",void 0),__decorate([x(cc.Node)],t.prototype,"OpenBox",void 0),__decorate([x(cc.Node)],t.prototype,"HlepFriendList",void 0),__decorate([x(cc.Node)],t.prototype,"RightNode",void 0),__decorate([x(cc.Node)],t.prototype,"Finger",void 0),__decorate([x(cc.Node)],t.prototype,"aureole",void 0),__decorate([x(cc.Node)],t.prototype,"BoxLighit",void 0),t=i=__decorate([M],t)}(n.default);i.default=k,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/TimeController":"TimeController","../../Core/Window":"Window","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/ColorUtil":"ColorUtil","../../Util/CommonUtil":"CommonUtil","../../Util/LocalStorageUtils":"LocalStorageUtils","../../Util/SDKUtils":"SDKUtils","../../Util/Utils":"Utils","../Activity/ActivityController":"ActivityController","../Commons/MonsterPreview":"MonsterPreview","../Commons/RewardUtils":"RewardUtils","../Commons/WindowBg2":"WindowBg2","../Gamelayer/RoleHead":"RoleHead","../Item/ItemIcon":"ItemIcon","../OpenWin/OpenWinController":"OpenWinController","../Role/RoleInfo":"RoleInfo","../Tips/OpTipsController":"OpTipsController","../Tips/RewardTips":"RewardTips","../WarTeam/MonsterController":"MonsterController","./FridBossController":"FridBossController","./HelpFriendWin":"HelpFriendWin","./HelpFriendsWin":"HelpFriendsWin"}],FriendBlackList:[function(e,t,i){"use strict";cc._RF.push(t,"1cc6biv6B1Fo7FBC0wnqxnY","FriendBlackList"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/GameEventDispatcher"),o=e("./FriendsController"),a=e("../../Core/Language"),r=e("../Tips/OpTipsController"),s=e("../../Core/Event"),l=e("../Commons/CommonPageBG"),c=e("../../Core/LoadManager"),d=e("../../GlobalContext"),p=e("../../Util/Utils"),h=cc._decorator,u=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.listNode=null,t.allConfirm=null,t.allRefuse=null,t.noBlacklist=null,t.btnLabel1=null,t.btnLabel2=null,t.noBlacklistLabel=null,t.type=!1,t.symbolArr=[],t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this,this.onInit(785,588,a.default.getStr("Blacklist"),!0)},t.prototype.start=function(){e.prototype.start.call(this),this.onResetTitle(a.default.getStr("Blacklist")),this.btnLabel1.string=a.default.getStr("AllCancel"),this.btnLabel2.string=a.default.getStr("AllAgree"),this.noBlacklistLabel.string=a.default.getStr("NoBlackListText")},t.prototype.show=function(){this.node.active=!0,e.prototype.show.call(this),this.onResetTitle(this.type?a.default.getStr("Blacklist"):a.default.getStr("Applicationlist")),n.GameEventDispatcher.instance.on(s.EventDefiner.FRIENDS_APPLY,this._application,this),n.GameEventDispatcher.instance.on(s.EventDefiner.FRIENDS_OUTBLACK,this._setOutBlack,this)},t.prototype.hide=function(){e.prototype.hide.call(this),p.default.setNodeChildDestoryByUrl(this.listNode,d.GlobalContext.Root+"prefab/Friend/blackSons"),this.symbolArr=[],n.GameEventDispatcher.instance.off(s.EventDefiner.FRIENDS_APPLY,this._application,this),n.GameEventDispatcher.instance.off(s.EventDefiner.FRIENDS_OUTBLACK,this._setOutBlack,this)},t.prototype.setType=function(e,t){var i=this;this.allConfirm.node.active=!1,this.allRefuse.node.active=!1,this.noBlacklist.active=!1,p.default.setNodeChildDestoryByUrl(this.listNode,d.GlobalContext.Root+"prefab/Friend/blackSons"),this.symbolArr=[],e?(this.onResetTitle(a.default.getStr("Blacklist")),this.noBlacklist.active=t.length<=0):(this.onResetTitle(a.default.getStr("Applicationlist")),t.length>0?(this.allRefuse.interactable=!0,this.allConfirm.interactable=!0):(this.allRefuse.interactable=!1,this.allConfirm.interactable=!1),this.allConfirm.node.active=!0,this.allRefuse.node.active=!0),this.type=e,t.length&&c.default.instance.loadResByType(d.GlobalContext.Root+"prefab/Friend/blackSons",cc.Prefab,function(e){var n=i.type?3:4;for(var o in t){var a=p.default.getNodeByUrl(e,d.GlobalContext.Root+"prefab/Friend/blackSons");a.getComponent("FriendsInfo").setIndex(o,n),a.getComponent("FriendsInfo").setInfo(t[o]),i.symbolArr.push(a),i.listNode.addChild(a)}},this)},t.prototype.allOperation=function(e,t){var i=1!=parseInt(t),n=o.default.instance;if(i&&n.data.friendArr.length+this.symbolArr.length>n.cfg[1].maxFriendNum)r.default.instance.ShowMsg(a.default.getStr("FriendUpLimit"));else{if(this.symbolArr.length>0){for(var s in this.symbolArr){var l=this.symbolArr[s].getComponent("FriendsInfo").getActorId();o.default.instance.repaddfri(l,i),this.symbolArr&&(this.symbolArr[s].destroy(),this.symbolArr[s]=null)}1==parseInt(t)?r.default.instance.ShowMsg(a.default.getStr("cancelSuccess")):r.default.instance.ShowMsg(a.default.getStr("addSuccess"))}this.allRefuse.interactable=!0,this.allConfirm.interactable=!0}},t.prototype.friendAdd=function(e,t){var i=this;this.node.active&&c.default.instance.loadResByType(d.GlobalContext.Root+"prefab/Friend/blackSons",cc.Prefab,function(n){var o=e?3:4,a=p.default.getNodeByUrl(n,d.GlobalContext.Root+"prefab/Friend/blackSons");a.getComponent("FriendsInfo").setIndex(i.symbolArr.length,o),a.getComponent("FriendsInfo").setInfo(t),i.symbolArr.push(a),i.listNode.addChild(a)},this)},t.prototype._application=function(e){var t=e.getUserData(),i=this.symbolArr[t.index].getComponent("FriendsInfo").getActorId();o.default.instance.repaddfri(i,t.type),n.GameEventDispatcher.instance.emit(s.EventDefiner.FRIENDS_APPLICATION,{actorId:i}),this.listNode.removeChild(this.symbolArr[t.index]),p.default.setNodeDestoryByUrl(this.symbolArr[t.index],d.GlobalContext.Root+"prefab/Friend/blackSons"),this.symbolArr[t.index].destroy(),this.symbolArr[t.index]=null},t.prototype._setOutBlack=function(e){var t=e.getUserData(),i=this.symbolArr[t.index].getComponent("FriendsInfo").getActorId();o.default.instance.delblack(i),this.listNode.removeChild(this.symbolArr[t.index]),p.default.setNodeDestoryByUrl(this.symbolArr[t.index],d.GlobalContext.Root+"prefab/Friend/blackSons"),this.symbolArr[t.index].destroy(),this.symbolArr[t.index]=null},t.prototype.close=function(){this.hide(),p.default.setNodeChildDestoryByUrl(this.listNode,d.GlobalContext.Root+"prefab/Friend/blackSons");for(var e=0;e<this.symbolArr.length;e++)this.symbolArr[e]&&(this.symbolArr[e].destroy(),this.symbolArr[e]=null);this.symbolArr=[]},t.instance=null,__decorate([f(cc.Node)],t.prototype,"listNode",void 0),__decorate([f(cc.Button)],t.prototype,"allConfirm",void 0),__decorate([f(cc.Button)],t.prototype,"allRefuse",void 0),__decorate([f(cc.Node)],t.prototype,"noBlacklist",void 0),__decorate([f(cc.Label)],t.prototype,"btnLabel1",void 0),__decorate([f(cc.Label)],t.prototype,"btnLabel2",void 0),__decorate([f(cc.Label)],t.prototype,"noBlacklistLabel",void 0),t=i=__decorate([u],t)}(l.default);i.default=g,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/CommonPageBG":"CommonPageBG","../Tips/OpTipsController":"OpTipsController","./FriendsController":"FriendsController"}],FriendBossItem:[function(e,t,i){"use strict";cc._RF.push(t,"ec65fUL+lBKZ55WsrOOWJxc","FriendBossItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("./FridBossController"),a=e("../Tips/OpTipsController"),r=e("../../Core/Language"),s=e("../../Core/TimeController"),l=e("./FridBossWin"),c=e("./HelpFriendWin"),d=e("../LoadingPanel/LoadingPanel"),p=e("../Scene/Controller/SceneController"),h=e("../../Global/GlobalValue"),u=cc._decorator,f=u.ccclass,g=u.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Man=null,t.Woman=null,t.IDLabe=null,t.TimesLabe=null,t.BossTimes=null,t.GrayBossTimes=null,t.GreenBossTimes=null,t.IsHelpForYou=null,t.RefuseBtn=null,t.seekHelpBtn=null,t.roleHande=null,t.id=null,t.time=null,t.isLine=!1,t.timeout=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),this.setTime(),this.seekHelpBtn.getComponent(cc.Button).interactable=!1},t.prototype.hide=function(){e.prototype.hide.call(this),this.timeout&&s.default.instance.clearInterval(this.timeout),this.timeout=null},t.prototype.seekHelp=function(){o.default.instance.SendHelp(this.id),a.default.instance.ShowMsg(r.default.getStr("\u6c42\u52a9\u6210\u529f"))},t.prototype.helpBtn=function(){l.default.instance.hide(),o.default.instance.sendFridBossFri(this.id+"",o.default.instance.IsHelp),d.default.instance._currentPercent=0,p.default.instance.scenestatus=h.GameScene.Scene,d.default.instance.showSceneLoading(100,2500,-1),c.default.instance.Friendname=this.IDLabe.string,c.default.instance.FriendlastTime=this.TimesLabe.string,c.default.instance.FriendroleHeand=this.roleHande,o.default.instance.IsFriend=!0,l.default.instance.FirendWin.active=!1,l.default.instance.HelpList.active=!1,c.default.instance.userID=this.id},t.prototype.refuse=function(){o.default.instance.DeleteHelp(this.id),this.seekHelpBtn.getComponent(cc.Button).interactable=!1,this.node.destroy()},t.prototype.setTime=function(){var e=this,t=s.default.instance.ServerTimeMins;this.timeout=s.default.instance.setInterval(function(){t+=1e3;var i=e.time+6e5-t;e.seekHelpBtn.getComponent(cc.Button).interactable=i<=1e3},this,1e3)},__decorate([g(cc.Node)],t.prototype,"Man",void 0),__decorate([g(cc.Node)],t.prototype,"Woman",void 0),__decorate([g(cc.Label)],t.prototype,"IDLabe",void 0),__decorate([g(cc.Label)],t.prototype,"TimesLabe",void 0),__decorate([g(cc.Label)],t.prototype,"BossTimes",void 0),__decorate([g(cc.Node)],t.prototype,"GrayBossTimes",void 0),__decorate([g(cc.Node)],t.prototype,"GreenBossTimes",void 0),__decorate([g(cc.Node)],t.prototype,"IsHelpForYou",void 0),__decorate([g(cc.Node)],t.prototype,"RefuseBtn",void 0),__decorate([g(cc.Node)],t.prototype,"seekHelpBtn",void 0),t=__decorate([f],t)}(n.default);i.default=y,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../../Global/GlobalValue":"GlobalValue","../LoadingPanel/LoadingPanel":"LoadingPanel","../Scene/Controller/SceneController":"SceneController","../Tips/OpTipsController":"OpTipsController","./FridBossController":"FridBossController","./FridBossWin":"FridBossWin","./HelpFriendWin":"HelpFriendWin"}],FriendSearchList:[function(e,t,i){"use strict";cc._RF.push(t,"02f72evtG5DqLWi01DUTh5l","FriendSearchList"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./FriendsController"),o=e("../../Core/GameEventDispatcher"),a=e("../../Core/Language"),r=e("../Tips/OpTipsController"),s=e("../../Core/Event"),l=e("../Commons/CommonPageBG"),c=e("../../Util/Utils"),d=e("../../Core/WindowType"),p=e("../../GlobalContext"),h=cc._decorator,u=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.chatContent=null,t.starBtn=null,t.friendPrefab=null,t.conNode=null,t.recommendPrefab=null,t.recommendNode=null,t.searchTitle=null,t.recFriendNode=null,t.btnText=null,t.btnText2=null,t.friendNode=null,t.nameRecord="",t.added=!1,t._lastClickActorId=null,t._nowClickActorId=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.onInit(900,660,a.default.getStr("FriendsAdd"),!0)},t.prototype.start=function(){e.prototype.start.call(this),this.btnText.string=a.default.getStr("\u4e00\u952e\u6dfb\u52a0"),this.btnText2.string=a.default.getStr("ThemeshopTips2")},t.prototype.show=function(){e.prototype.show.call(this),this.chatContent.string="",this.starBtn.enabled=this.node.active=this.recFriendNode.active=!0,this.setRecommendData(),this.searchTitle.string=a.default.getStr("recommandfriend"),this.addEvent()},t.prototype.addEvent=function(){o.GameEventDispatcher.instance.on(s.EventDefiner.FRIENDS_SEARCHFRI,this._friendCome,this),o.GameEventDispatcher.instance.on(s.EventDefiner.FRIENDS_ADD,this._friendAdd,this),o.GameEventDispatcher.instance.on(s.EventDefiner.RECOMMEND_UP,this.setRecommendData,this),o.GameEventDispatcher.instance.on(s.EventDefiner.RECOMMEND_Add,this.recommendAdd,this)},t.prototype.removeEvent=function(){o.GameEventDispatcher.instance.off(s.EventDefiner.FRIENDS_SEARCHFRI,this._friendCome,this),o.GameEventDispatcher.instance.off(s.EventDefiner.FRIENDS_ADD,this._friendAdd,this),o.GameEventDispatcher.instance.on(s.EventDefiner.RECOMMEND_UP,this.setRecommendData,this),o.GameEventDispatcher.instance.off(s.EventDefiner.RECOMMEND_Add,this.recommendAdd,this)},t.prototype.hide=function(){e.prototype.hide.call(this),this.node.active=!1,this.friendNode&&(this.conNode.removeChild(this.friendNode),this.friendNode.destroy(),this.friendNode=null),this._lastClickActorId=null,this._nowClickActorId=null,this.nameRecord=null,this.removeEvent();for(var t=this.conNode.childrenCount-1;t>=0;t--)c.default.setNodeToPool(d.PoolType.FriendPrefab,this.conNode.children[t]);for(t=this.recommendNode.childrenCount-1;t>=0;t--)c.default.setNodeToPool(d.PoolType.RecommendPrefab,this.recommendNode.children[t])},t.prototype.searchStar=function(){var e=this.chatContent.string;this.nameRecord!=e&&(this.nameRecord=e,this.friendNode&&(this.node.removeChild(this.friendNode),this.friendNode.destroy(),this.friendNode=null),e&&e.length&&(console.log("\u641c\u7d22\u7684\u540d\u5b57\u662f\uff1a",e),n.default.instance.searchfri(e)))},t.prototype._friendCome=function(e){this.searchTitle.string=a.default.getStr("searchResult"),this.recFriendNode.active=!1;var t=e.getUserData().info;if(t){var i=c.default.getNodeByPool(d.PoolType.FriendPrefab,this.friendPrefab,p.GlobalContext.Root+"prefab/Friend/friendApplication");i.getComponent("FriendsInfo").setIndex(0,2),i.getComponent("FriendsInfo").setInfo(t),this.conNode.addChild(i),this.friendNode=i,this.added=!1,n.default.instance.data.searchData(t)&&(i.getComponent("FriendsInfo").setAddFriendStr(a.default.getStr("addedFriends")),this.added=!0)}},t.prototype._friendAdd=function(e){if(this.added)r.default.instance.ShowMsg(a.default.getStr("addedFriends"));else{var t=n.default.instance;if(t.data.friendArr.length+1>t.cfg[1].maxFriendNum)r.default.instance.ShowMsg(a.default.getStr("FriendUpLimit"));else{var i=e.getUserData().actorId;n.default.instance.reqaddfri(i)}}},t.prototype.setRecommendData=function(){this._lastClickActorId=null;var e,t=n.default.instance.data.recommendArr;if(this.recommendNode.childrenCount-t.length>0)for(var i=this.recommendNode.childrenCount-1;i>=t.length;i--)c.default.setNodeToPool(d.PoolType.RecommendPrefab,this.recommendNode.children[i]);for(var i in t)this.recommendNode.children[i]?e=this.recommendNode.children[i]:(e=c.default.getNodeByPool(d.PoolType.RecommendPrefab,this.recommendPrefab,p.GlobalContext.Root+"prefab/Friend/recommend"),this.recommendNode.addChild(e)),e.getComponent("RecommendFriends").setData(t[i])},t.prototype.addrecommandfriends=function(){var e=n.default.instance;e.data.recommendArr.length<=0||(0!=e.cfg[1].maxFriendNum-e.data.friendArr.length?n.default.instance.reqonekeyaddfriend():r.default.instance.ShowMsg(a.default.getStr("FriendUpLimit")))},t.prototype.btnUpData=function(){n.default.instance.reqRecommandfriend()},t.prototype.delRecommon=function(e){for(var t=n.default.instance.data.recommendArr,i=0;i<this.recommendNode.childrenCount;i++)if(this.recommendNode.children[i].getComponent("RecommendFriends").getActorId()==e){c.default.setNodeToPool(d.PoolType.RecommendPrefab,this.recommendNode.children[i]),t.splice(i,1),i--;break}},t.prototype.recommendAdd=function(e){var t=e.getUserData().actorId;this.delRecommon(t)},__decorate([f(cc.EditBox)],t.prototype,"chatContent",void 0),__decorate([f(cc.Button)],t.prototype,"starBtn",void 0),__decorate([f(cc.Prefab)],t.prototype,"friendPrefab",void 0),__decorate([f(cc.Node)],t.prototype,"conNode",void 0),__decorate([f(cc.Prefab)],t.prototype,"recommendPrefab",void 0),__decorate([f(cc.Node)],t.prototype,"recommendNode",void 0),__decorate([f(cc.Label)],t.prototype,"searchTitle",void 0),__decorate([f(cc.Node)],t.prototype,"recFriendNode",void 0),__decorate([f(cc.Label)],t.prototype,"btnText",void 0),__decorate([f(cc.Label)],t.prototype,"btnText2",void 0),t=__decorate([u],t)}(l.default);i.default=g,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/CommonPageBG":"CommonPageBG","../Tips/OpTipsController":"OpTipsController","./FriendsController":"FriendsController"}],FriendUtils:[function(e,t,i){"use strict";cc._RF.push(t,"ba972IYTSdAxKXWZqhmTIQB","FriendUtils"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./FriendsController"),o=function(){function e(){}return Object.defineProperty(e,"ctrl",{get:function(){return n.default.instance},enumerable:!0,configurable:!0}),e.onClickFriend=function(e){this.ctrl.getplayerinfo(e)},e}();i.FriendUtils=o,cc._RF.pop()},{"./FriendsController":"FriendsController"}],FriendsController:[function(e,t,i){"use strict";cc._RF.push(t,"53e3a3Arz5OKJ5ixjhPpoGi","FriendsController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../NetConnect/NetConnet"),a=e("../../Core/GameEventDispatcher"),r=e("../../Core/Event"),s=e("../Functionicon/FunctionIconController"),l=e("./PartnerMain"),c=e("../../Core/WindowType"),d=e("./FriendsData"),p=e("../../Core/ConfigsManager"),h=e("../Chat/ChatController"),u=e("../Tips/OpTipsController"),f=e("../../Core/Language"),g=e("../Commons/WindowOpenUtils"),y=e("./FriendsNewsVo"),m=cc._decorator,C=m.ccclass,v=(m.property,function(e){function t(){var t=e.call(this)||this;return t._friendDatasFlag=!1,t.bool=null,t.data=null,t.cfg=null,i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){this.data=new d.default,this.cfg=p.ConfigsManager.instance.getConfigs("friendConf").friendConf,this.maxFriendNum=this.cfg[1].maxFriendNum,this.addProto("frilist",this.friendComeback,this),this.addProto("searchfri",this.searchfriComback,this),this.addProto("friadd",this.friendAddCome,this),this.addProto("fridel",this.friendDeleteCome,this),this.addProto("frionline",this.friendOnLineCome,this),this.addProto("onekeyaddfinish",this.onekeyaddfinish,this),this.addProto("recommandfriend",this.recommandfriend,this),this.addProto("playerinfo",this.setPlayerinfo,this)},t.prototype.setPlayerinfo=function(e){this.friendNewsInfo||(this.friendNewsInfo=new y.FriendsNewsVo),this.friendNewsInfo.updateData(e.data),g.default.instance.openWindowType(c.WindowType.FriendNews)},t.prototype.getplayerinfo=function(e){var t={cmd:"getplayerinfo",aid:e};o.default.instance.sendProto(t)},t.prototype.friendList=function(){o.default.instance.sendProto({cmd:"frilist"}),console.log("\u89e6\u53d1 \u597d\u53cb\u8bf7\u6c42")},t.prototype.friendComeback=function(e){this._friendDatasFlag=!!e.list,this.data.setData(e.list),0!=this.data.applyArr.length&&(s.default.instance.FuncIconRedDeal(c.WindowType.Friends,!0),this.bool=!0,l.default.instance&&l.default.instance.btnRed&&(l.default.instance.btnRed.active=!0)),0==this.data.applyArr.length&&(s.default.instance.FuncIconRedDeal(c.WindowType.Friends,!1),this.bool=!1,l.default.instance&&l.default.instance.btnRed&&(l.default.instance.btnRed.active=!1)),a.GameEventDispatcher.instance.emit(r.EventDefiner.FRIENDS_COME)},t.prototype.recommandfriend=function(e){this.data.setRecommendData(e.list),a.GameEventDispatcher.instance.emit(r.EventDefiner.RECOMMEND_UP)},t.prototype.onekeyaddfinish=function(){this.reqRecommandfriend()},t.prototype.isMaxFriend=function(){return this.maxFriendNum==this.data.friendArr.length},t.prototype.getFriendLen=function(){return this.data.friendArr.length},t.prototype.getFriendOnlineLen=function(){var e=0,t=this.data.friendArr;for(var i in t)t[i].online&&e++;return e},t.prototype.reqaddfri=function(e){if(this.maxFriendNum!=this.data.friendArr.length){var t={cmd:"reqaddfri",actorId:e};o.default.instance.sendProto(t),console.log("\u6dfb\u52a0\u597d\u53cb id: ",e)}else u.default.instance.ShowMsg(f.default.getStr("FriendUpLimit"))},t.prototype.searchfri=function(e){var t={cmd:"searchfri",name:e};o.default.instance.sendProto(t),console.log("\u67e5\u627e\u597d\u53cb id: ",e)},t.prototype.delblack=function(e){var t={cmd:"delblack",actorId:e};o.default.instance.sendProto(t),console.log("\u5220\u9664\u9ed1\u540d\u5355 id: ",name)},t.prototype.dtapply=function(e){var t={cmd:"dtapply",actorId:e};o.default.instance.sendProto(t)},t.prototype.repaddfri=function(e,t){var i={cmd:"repaddfri",actorId:e,pass:t};o.default.instance.sendProto(i),console.log("\u901a\u8fc7\u597d\u53cb\u7533\u8bf7 \u597d\u53cb id: ",name)},t.prototype.searchfriComback=function(e){var t=e.info;a.GameEventDispatcher.instance.emit(r.EventDefiner.FRIENDS_SEARCHFRI,{info:t})},t.prototype.delfri=function(e){var t={cmd:"delfri",actorId:e};o.default.instance.sendProto(t),console.log("\u5220\u9664\u597d\u53cb id\uff1a",e)},t.prototype.addblack=function(e){var t={cmd:"addblack",actorId:e};o.default.instance.sendProto(t),console.log("\u62c9\u9ed1\u64cd\u4f5c \u5bf9\u8c61 id\uff1a",e)},t.prototype.reqRecommandfriend=function(){o.default.instance.sendProto({cmd:"recommandfriend"})},t.prototype.reqonekeyaddfriend=function(){o.default.instance.sendProto({cmd:"onekeyaddfriend"})},t.prototype.friendAddCome=function(e){if(console.log("\u68c0\u6d4b\u662f\u4e0d\u662f\u6709\u597d\u53cb\u7533\u8bf7\u6216\u8005\u6dfb\u52a0\u4fe1\u606f"),e&&this._friendDatasFlag){var t=e.info,i=null,n=!0;1==e.type?i=this.data.blackArr:2==e.type?i=this.data.applyArr:(i=this.data.friendArr,u.default.instance.ShowMsg(f.default.getStr("addSuccess")),h.default.instance.addFriendsId(t),a.GameEventDispatcher.instance.emit(r.EventDefiner.ChatAddfrid));for(var o=0;o<i.length;o++)t.actorId==i[o].actorId&&(n=!1);console.log("\u6709\u597d\u53cb\u7533\u8bf7 \u662f\u5426\u5b58\u5728 ",n),s.default.instance.FuncIconRedDeal(c.WindowType.Friends,n&&2==e.type),l.default.instance&&l.default.instance.btnRed&&(l.default.instance.btnRed.active=n&&2==e.type),n&&(i.push(e.info),this.data.srotAllData()),a.GameEventDispatcher.instance.emit(r.EventDefiner.FRIENDS_ADDONE,{type:e.type,info:t}),a.GameEventDispatcher.instance.emit(r.EventDefiner.RECOMMEND_BTNUP)}},t.prototype.friendDeleteCome=function(e){if(e&&this._friendDatasFlag){var t=e,i=null;i=1==e.type?this.data.blackArr:2==e.type?this.data.applyArr:this.data.friendArr;for(var n=0;n<i.length;n++)t.actorId==i[n].actorId&&i.splice(n,1);a.GameEventDispatcher.instance.emit(r.EventDefiner.Chatdelfrid,t.actorId),t.actorId&&h.default.instance.clearFriendsId(t.actorId),a.GameEventDispatcher.instance.emit(r.EventDefiner.FriDel,{type:e.type,info:t}),a.GameEventDispatcher.instance.emit(r.EventDefiner.RECOMMEND_BTNUP)}},t.prototype.friendOnLineCome=function(e){if(e&&this._friendDatasFlag){var t=this.data.friendArr;for(var i in t)t[i].actorId==e.actorId&&(t[i].online=e.online);a.GameEventDispatcher.instance.emit(r.EventDefiner.FriOnline,{actorId:e.actorId,online:e.online})}},t.prototype.getFriendArr=function(){return this._friendDatasFlag||this.friendList(),this._friendDatasFlag&&this.data.friendArr},t.prototype.getBlackLsit=function(){return this._friendDatasFlag&&this.data.blackArr},t.prototype.getAddLsit=function(){return this._friendDatasFlag&&this.data.applyArr},t.prototype.getLsit=function(){return this.data},t.instance=null,t=i=__decorate([C],t)}(n.default));i.default=v,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/WindowType":"WindowType","../../NetConnect/NetConnet":"NetConnet","../Chat/ChatController":"ChatController","../Commons/WindowOpenUtils":"WindowOpenUtils","../Functionicon/FunctionIconController":"FunctionIconController","../Tips/OpTipsController":"OpTipsController","./FriendsData":"FriendsData","./FriendsNewsVo":"FriendsNewsVo","./PartnerMain":"PartnerMain"}],FriendsData:[function(e,t,i){"use strict";cc._RF.push(t,"3ce86xWAPJGTZSLl9xmW3eu","FriendsData"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(){this._applyArr=[],this._blackArr=[],this._friendArr=[],this._recommendArr=[]}return e.prototype.setData=function(e){this.setApplyData(e.apply),this.setBlackData(e.black),this.setfriendData(e.friend)},e.prototype.setApplyData=function(e){this.isNull(e)||(this._applyArr=this.srot(e))},e.prototype.setBlackData=function(e){this.isNull(e)||(this._blackArr=this.srot(e))},e.prototype.setfriendData=function(e){this.isNull(e)||(this._friendArr=this.srot(e))},e.prototype.setRecommendData=function(e){this._recommendArr=this.srot(e)},Object.defineProperty(e.prototype,"applyArr",{get:function(){return this._applyArr},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blackArr",{get:function(){return this._blackArr},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"friendArr",{get:function(){return this._friendArr},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recommendArr",{get:function(){return this._recommendArr},enumerable:!0,configurable:!0}),e.prototype.srotAllData=function(){this.setApplyData(this.applyArr),this.setBlackData(this.blackArr),this.setfriendData(this.friendArr)},e.prototype.srot=function(e){var t=[],i=[];for(var n in e)e[n].online?t.push(e[n]):i.push(e[n]);return t.sort(function(e,t){return e.fight<t.fight?1:-1}),i.sort(function(e,t){return e.fight<t.fight?1:-1}),t.concat(i)},e.prototype.isNull=function(e){return!(e instanceof Array)||e.length<=0},e.prototype.searchDataByName=function(e){if(this.friendArr.length<=0)return null;var t=[],i=new RegExp(e);for(var n in this.friendArr)i.test(this.friendArr[n].name)&&t.push(this.friendArr[n]);return t},e.prototype.searchData=function(e){for(var t in this.friendArr)if(this.friendArr[t].actorId==e.actorId&&this.friendArr[t].srvid==e.srvid)return!0;return!1},e.prototype.getFriendOnLineNum=function(){for(var e=0,t=0;t<this.friendArr.length;++t)this.friendArr[t].online&&(e+=1);return e},e}();i.default=n,cc._RF.pop()},{}],FriendsInfo:[function(e,t,i){"use strict";cc._RF.push(t,"40072YBBz5IPauxvW16KZ+/","FriendsInfo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/GameEventDispatcher"),a=e("../Gamelayer/RoleHead"),r=e("../Tips/OpTipsController"),s=e("./FriendsController"),l=e("../WarTeam/MonsterController"),c=e("../../Util/GrayEffect"),d=e("../../Core/WindowType"),p=e("../../Core/Language"),h=e("../../Core/Event"),u=e("../Item/ItemData"),f=e("../Item/ItemIcon"),g=e("../../Util/Utils"),y=e("../../Core/LoadManager"),m=e("../../GlobalContext"),C=cc._decorator,v=C.ccclass,_=C.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bgImage=null,t.portraitImage=null,t.sexImage=null,t.nameLabel=null,t.powerLabel=null,t.gradeLabel=null,t.CardItemList=null,t.clickShowBtn=null,t.offLineTime=null,t.addFriends=null,t.btnArr=[],t.images=null,t.btnHomeNode=null,t.addFriendStr=null,t.actorId=null,t.index=0,t.ifOddInfo=0,t._gender=0,t._isOnClick=!1,t.data=null,t.friendHomeData=null,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.setRType=function(e){},t.prototype.hide=function(){for(var e=this.CardItemList.childrenCount-1;e>=0;e--)g.default.setNodeToPool(d.PoolType.ItemIcon,this.CardItemList.children[e])},t.prototype.setInfo=function(e){var t=this;this.data=e,this._gender=e.gender,this.powerLabel.string=e.fight+"",this.gradeLabel.string=e.level+"",this.nameLabel.string="s"+e.srvid+" "+e.name,this.actorId=e.actorId,console.log(e,"33333"),this.setOffLineTime(e.lastlogouttime,e.online);var i=e.icon;this.setOnLineState(e.online),this.portraitImage.SetHead(i);var n,o=l.default.instance.data.getCardCfg();y.default.instance.loadResByType(m.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(i){if(e.team&&t.CardItemList.childrenCount>0)for(var a=0;a<e.team.length;++a)if(t.CardItemList.children[a]?n=t.CardItemList.children[a]:(n=g.default.getNodeByPool(d.PoolType.ItemIcon,i,m.GlobalContext.Root+"prefab/Bag/ItemIcon"),t.CardItemList.addChild(n)),e.team[a]){n.active=!0;var r=o.Card[e.team[a]].pieceId,s=u.default.creatItem(r,1);n.getComponent(f.default).ItemData(s,!1,null,!0),n.scale=.75}else n.active=!1},this)},t.prototype.setIndex=function(e,t){if(this.index=e,this.ifOddInfo=t,t<3)2==this.ifOddInfo?this.addFriends.node.active=!0:(this.addFriends.node.active=!1,this.node.on(cc.Node.EventType.TOUCH_START,this.OnSceenTouchEnd,this)),this.setShow();else for(var i in this.btnArr)3==t?0==parseInt(i)?this.btnArr[i].node.active=!0:this.btnArr[i].node.active=!1:0==parseInt(i)?this.btnArr[i].node.active=!1:this.btnArr[i].node.active=!0},t.prototype.OnSceenTouchEnd=function(){o.GameEventDispatcher.instance.emit("FRIENDS_ONCLICK",{actorId:this.data.actorId})},t.prototype.setOnLineState=function(e){this.sexImage.spriteFrame=this.images.getSpriteFrame("gender_"+this._gender);(this.portraitImage.getComponent(c.default)?this.portraitImage.getComponent(c.default):this.portraitImage.addComponent(c.default)).setGray(!e)},t.prototype.getActorId=function(){return this.actorId},t.prototype.shiftOutBlack=function(){o.GameEventDispatcher.instance.emit(h.EventDefiner.FRIENDS_OUTBLACK,{index:this.index})},t.prototype.decline=function(){o.GameEventDispatcher.instance.emit(h.EventDefiner.FRIENDS_APPLY,{type:!1,index:this.index}),s.default.instance.friendList(),r.default.instance.ShowMsg(p.default.getStr("RefusedToAdd"))},t.prototype.agree=function(){var e=s.default.instance;e.data.friendArr.length+1>e.cfg[1].maxFriendNum?r.default.instance.ShowMsg(p.default.getStr("FriendUpLimit")):(r.default.instance.ShowMsg(p.default.getStr("addSuccess")),o.GameEventDispatcher.instance.emit(h.EventDefiner.FRIENDS_APPLY,{type:!0,index:this.index}),s.default.instance.friendList())},t.prototype.friendsRequest=function(){o.GameEventDispatcher.instance.emit(h.EventDefiner.FRIENDS_ADD,{actorId:this.actorId})},t.prototype.callMeBack=function(){o.GameEventDispatcher.instance.emit(h.EventDefiner.FRIENDS_CHAT,{actorId:this.actorId})},t.prototype.setShow=function(){this.clickShowBtn&&(this.addFriends.node.active?(this.clickShowBtn.active=!1,this.offLineTime.node.active=!0):(this.clickShowBtn.active=this._isOnClick,this.offLineTime.node.active=!this._isOnClick),this.btnHomeNode.active=!1)},t.prototype.setOnClick=function(e){this._isOnClick=e;var t=this._isOnClick?"base02":"base01";this.bgImage.spriteFrame=this.images.getSpriteFrame(t),this.setShow()},t.prototype.PullBlack=function(){var e=s.default.instance;e.cfg[1].maxShieldNum<e.data.blackArr.length+1?r.default.instance.ShowMsg(p.default.getStr("BlacklistUpLimit")):(s.default.instance.addblack(this.actorId),r.default.instance.ShowMsg(p.default.getStr("addBlacklist")))},t.prototype.delFriends=function(){s.default.instance.delfri(this.actorId),r.default.instance.ShowMsg(p.default.getStr("DeleteFriends"))},t.prototype.setOffLineTime=function(e,t){if(this.offLineTime){if(t)return this.offLineTime.string=p.default.getStr("state_1"),void(this.offLineTime.node.color=cc.color(0,255,0));if(e){var i=(new Date).getTime()-e,n=Math.floor(i/864e5),o=Math.floor(i/36e5),a=Math.floor(i/6e4),r=null;this.offLineTime.node.color=cc.color(0,0,0),r=n>0?p.default.getStr("day",n):o>0?p.default.getStr("hours",o):a>0?p.default.getStr("minutes",a):p.default.getStr("oneMinute"),r+=p.default.getStr("qian"),this.offLineTime.string=r}}},t.prototype.setAddFriendStr=function(e){this.addFriendStr.string=e},__decorate([_(cc.Sprite)],t.prototype,"bgImage",void 0),__decorate([_(a.default)],t.prototype,"portraitImage",void 0),__decorate([_(cc.Sprite)],t.prototype,"sexImage",void 0),__decorate([_(cc.Label)],t.prototype,"nameLabel",void 0),__decorate([_(cc.Label)],t.prototype,"powerLabel",void 0),__decorate([_(cc.Label)],t.prototype,"gradeLabel",void 0),__decorate([_(cc.Node)],t.prototype,"CardItemList",void 0),__decorate([_(cc.Node)],t.prototype,"clickShowBtn",void 0),__decorate([_(cc.Label)],t.prototype,"offLineTime",void 0),__decorate([_(cc.Button)],t.prototype,"addFriends",void 0),__decorate([_([cc.Button])],t.prototype,"btnArr",void 0),__decorate([_(cc.SpriteAtlas)],t.prototype,"images",void 0),__decorate([_(cc.Node)],t.prototype,"btnHomeNode",void 0),__decorate([_(cc.Label)],t.prototype,"addFriendStr",void 0),t=__decorate([v],t)}(n.default);i.default=b,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/GrayEffect":"GrayEffect","../../Util/Utils":"Utils","../Gamelayer/RoleHead":"RoleHead","../Item/ItemData":"ItemData","../Item/ItemIcon":"ItemIcon","../Tips/OpTipsController":"OpTipsController","../WarTeam/MonsterController":"MonsterController","./FriendsController":"FriendsController"}],FriendsNewsVo:[function(e,t,i){"use strict";cc._RF.push(t,"4552bokK41LV7fptItvtV+I","FriendsNewsVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(){this.card={}}return e.prototype.updateData=function(e){for(var t in e)this[t]=e[t]},e}();i.FriendsNewsVo=n,cc._RF.pop()},{}],FriendsNewsWin:[function(e,t,i){"use strict";cc._RF.push(t,"24908lfVcRDG7+kPpWrlVO3","FriendsNewsWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Commons/CommonPageBG"),o=e("../../Core/Language"),a=e("../../Core/GameEventDispatcher"),r=e("../../Core/Event"),s=e("./FriendsController"),l=e("../../Util/DateUtil"),c=e("../../Global/GlobalValue"),d=e("../Commons/MonsterPreview"),p=e("../../Util/Utils"),h=e("../../Core/WindowType"),u=e("../WarTeam/MonsterController"),f=e("../../Core/LoadManager"),g=e("../../GlobalContext"),y=e("../Tips/OpTipsController"),m=e("../Chat/ChatController"),C=e("../Role/RoleInfo"),v=cc._decorator,_=v.ccclass,b=v.property,T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.model=null,t.leftBtn=null,t.rightBtn=null,t.baseTitle=null,t.playName=null,t.level=null,t.time=null,t.chapter=null,t.card=null,t.teamTitle=null,t.teamGroup=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.onInit(1072,591,null,!0),this.baseTitle.string=o.default.getStr("3505"),this.teamTitle.string=o.default.getStr("3506")},t.prototype.show=function(){e.prototype.show.call(this),this.setInitData(),a.GameEventDispatcher.instance.on(r.EventDefiner.RECOMMEND_BTNUP,this.updateBtnData,this)},t.prototype.hide=function(){if(e.prototype.hide.call(this),a.GameEventDispatcher.instance.off(r.EventDefiner.RECOMMEND_BTNUP,this.updateBtnData,this),this.model.childrenCount){var t=this.model.getComponentInChildren(d.default);t.clear(),p.default.setNodeToPool(h.PoolType.MonsterPreview,t.node)}for(var i=this.teamGroup.childrenCount-1;i>=0;i--)p.default.setNodeToPool(h.PoolType.CardNews,this.teamGroup.children[i])},t.prototype.updateBtnData=function(){var e=this.serData.aid,t=e!=parseInt(C.MyRoleInfo.id);this.leftBtn.active=t,this.rightBtn.active=t;var i=!!m.default.instance.getFridinfobyId(e);this.leftBtn.getComponentInChildren(cc.Label).string=o.default.getStr("350"+(i?2:1)),i=!!m.default.instance.getblackinfobyId(e),this.rightBtn.getComponentInChildren(cc.Label).string=o.default.getStr("350"+(i?4:3))},t.prototype.sendBtn=function(e,t){var i=this.serData.aid;switch("0"==t?this.leftBtn.getComponentInChildren(cc.Label).string:this.rightBtn.getComponentInChildren(cc.Label).string){case o.default.getStr("3501"):s.default.instance.reqaddfri(i);break;case o.default.getStr("3502"):s.default.instance.delfri(i);break;case o.default.getStr("3503"):var n=s.default.instance;if(n.cfg[1].maxShieldNum<n.data.blackArr.length+1)return void y.default.instance.ShowMsg(o.default.getStr("BlacklistUpLimit"));s.default.instance.addblack(i),y.default.instance.ShowMsg(o.default.getStr("3500"));break;case o.default.getStr("3504"):s.default.instance.delblack(i)}},t.prototype.setInitData=function(){var e=this;if(this.serData=s.default.instance.friendNewsInfo,this.updateBtnData(),this.playName.string=o.default.getStr("3507",this.serData.name),this.level.string=o.default.getStr("3508",this.serData.level),this.time.string=o.default.getStr("3509",l.DateUtil.timeSecondsToChineseDate1(this.serData.createTime)),this.chapter.string=o.default.getStr("3510",this.serData.chapter+1),this.card.string=o.default.getStr("3511",this.serData.cardNum),!this.model.childrenCount){var t=p.default.getNodeByPool(h.PoolType.MonsterPreview,u.default.instance.MonsterPreview);t.setScale(1),this.model.addChild(t)}this.model.getComponentInChildren(d.default).init("role",this.serData.model,1,c.DEFAULTS_SKIN+1+"",c.PRIORITY.MONSTER),this.model.getComponentInChildren(d.default).onShowRoleTitle(this.serData.title?"title_icon_"+this.serData.title:""),f.default.instance.loadResByType(g.GlobalContext.Root+"prefab/WarTeam/CardNews",cc.Prefab,function(t){var i;for(var n in e.serData.card)i=p.default.getNodeByPool(h.PoolType.CardNews,t,g.GlobalContext.Root+"prefab/WarTeam/CardNews"),e.teamGroup.addChild(i),i.getComponent("CardNews").setData(e.serData.card[n])},this)},__decorate([b(cc.Node)],t.prototype,"model",void 0),__decorate([b(cc.Node)],t.prototype,"leftBtn",void 0),__decorate([b(cc.Node)],t.prototype,"rightBtn",void 0),__decorate([b(cc.Label)],t.prototype,"baseTitle",void 0),__decorate([b(cc.RichText)],t.prototype,"playName",void 0),__decorate([b(cc.RichText)],t.prototype,"level",void 0),__decorate([b(cc.RichText)],t.prototype,"time",void 0),__decorate([b(cc.RichText)],t.prototype,"chapter",void 0),__decorate([b(cc.RichText)],t.prototype,"card",void 0),__decorate([b(cc.Label)],t.prototype,"teamTitle",void 0),__decorate([b(cc.Node)],t.prototype,"teamGroup",void 0),t=__decorate([_],t)}(n.default);i.default=T,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/DateUtil":"DateUtil","../../Util/Utils":"Utils","../Chat/ChatController":"ChatController","../Commons/CommonPageBG":"CommonPageBG","../Commons/MonsterPreview":"MonsterPreview","../Role/RoleInfo":"RoleInfo","../Tips/OpTipsController":"OpTipsController","../WarTeam/MonsterController":"MonsterController","./FriendsController":"FriendsController"}],FunBottomList:[function(e,t,i){"use strict";cc._RF.push(t,"0f63f6CQnpNuo5yz52xlN2k","FunBottomList"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../GlobalContext"),a=e("../Functionicon/FunctionIconController"),r=e("../../Util/Utils"),s=e("./FunctionIconListCell"),l=e("../../Core/LoadManager"),c=cc._decorator,d=c.ccclass,p=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bottomBtnContent=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.node.setContentSize(o.GlobalContext.UIWidth,o.GlobalContext.UIHeight)},t.prototype.onInitData=function(e){var t=this;r.default.setNodeChildDestoryByUrl(this.bottomBtnContent,o.GlobalContext.Root+"prefab/FunList/FunList6"),l.default.instance.loadResByType(o.GlobalContext.Root+"prefab/FunList/FunList6",cc.Prefab,function(i){for(var n=a.default.instance.getFunctionIconInfoList(e,!0),l=0;l<n.length;l++){var c=r.default.getNodeByUrl(i,o.GlobalContext.Root+"prefab/FunList/FunList6");t.bottomBtnContent.addChild(c),c.attr({index_td:n[l].config}),c.name="icon"+n[l].id,c.getComponent(s.default).initScene(n[l],!0)}},this)},__decorate([p(cc.Node)],t.prototype,"bottomBtnContent",void 0),t=__decorate([d],t)}(n.default);i.default=h,cc._RF.pop()},{"../../Core/LoadManager":"LoadManager","../../Core/Widget":"Widget","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Functionicon/FunctionIconController":"FunctionIconController","./FunctionIconListCell":"FunctionIconListCell"}],FunctionIconBtn:[function(e,t,i){"use strict";cc._RF.push(t,"9d531gVMRFLJo4b0kSOCYb/","FunctionIconBtn"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Commons/CommonPageBG"),o=e("./FunctionIconController"),a=e("../../Core/WindowType"),r=e("../OpenWin/OpenWinController"),s=cc._decorator,l=s.ccclass,c=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sysIcon=null,t._info=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.show=function(){e.prototype.show.call(this),this.setLabel()},t.prototype.setLabel=function(){var e=o.default.instance.systemid,t=null,i=!0;e.length==o.default.instance.systemLen&&(i=!1);for(var n=0;n<o.default.instance.systemLen;n++)if(i){if(null==e[n]){t=o.default.instance.getsysConfig(n);break}}else if(1==e[n]){t=o.default.instance.getsysConfig(n);break}t&&(this.node.getChildByName("openText").getComponent(cc.Label).string="\u7ae0\u8282"+t.openChapter+"\u5173\u5361("+t.openGuanqia+")",this.node.getChildByName("cont").getChildByName("iconSprite").getComponent(cc.Sprite).spriteFrame=this.sysIcon.getSpriteFrame(t.iconId)),this.setRed(e)},t.prototype.setRed=function(e){-1!=e.indexOf(1)?this.node.getChildByName("Red").active=!0:this.node.getChildByName("Red").active=!1},t.prototype.onClickOpenFuncIconWin=function(){r.default.instance.openWindow(a.WindowType.OpenFuncWin)},t.instance=null,__decorate([c(cc.SpriteAtlas)],t.prototype,"sysIcon",void 0),t=i=__decorate([l],t)}(n.default);i.default=d,cc._RF.pop()},{"../../Core/WindowType":"WindowType","../Commons/CommonPageBG":"CommonPageBG","../OpenWin/OpenWinController":"OpenWinController","./FunctionIconController":"FunctionIconController"}],FunctionIconController:[function(e,t,i){"use strict";cc._RF.push(t,"dd570lWe89FE5WbRD9iHsy0","FunctionIconController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../Core/ConfigsManager"),a=e("../Role/RoleInfo"),r=e("./FunctionIconInfo"),s=e("../Chapter/ChapterController"),l=e("../../Core/GameEventDispatcher"),c=e("../../Core/Event"),d=e("../OpenWin/OpenWinController"),p=e("../../Core/WindowType"),h=e("../../Core/Language"),u=e("../Tips/OpTipsController"),f=e("../OpenFuncTips/OpenFuncTips"),g=e("../Scene/Controller/SceneController"),y=e("../../Global/GlobalValue"),m=e("../PlotWin/PlotController"),C=e("../../NetConnect/NetConnet"),v=e("../../Core/WindowManager"),_=e("./FunctionIconWin"),b=e("../Gamelayer/GameLayer"),T=e("../Gamelayer/FunctionIconListCell"),S=e("../../Util/NumberUtil"),I=e("../BaiBeiFanLi/BaiBeiFanLiCtrl"),w=cc._decorator,D=w.ccclass,R=(w.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._isFirst=!0,t._configs=null,t._infoDic={},t._windowtype={},t._SysId={},t._systemOpenConfigs=null,t.OpenserverList=[],t.openTips=!0,t.RedData={},t.HideData={},t.NewFunc=[],t.systemid=[],t._activityStatus=[[p.WindowType.SingleRechargeRebate,0],[p.WindowType.SevenDayTarget,0],[p.WindowType.BaiBeiFanLi,0],[p.WindowType.LoopActivity,0],[p.WindowType.RechargeWin,0],[p.WindowType.OneSeckill,0]],t._activityWindow=[p.WindowType.FristCharge,p.WindowType.DrawCard,p.WindowType.DailyQusest,p.WindowType.WelfareLobby,p.WindowType.LoopActivity,p.WindowType.InviteWin,p.WindowType.SevenDayTarget,p.WindowType.SingleRechargeRebate,p.WindowType.BaiBeiFanLi,p.WindowType.LoopActivity,p.WindowType.RechargeWin,p.WindowType.SevenDayRanking,p.WindowType.OneSeckill,p.WindowType.Decompose,p.WindowType.CardRecommend,p.WindowType.HalfPrice],t.currentFunData=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){for(var t=0;t<this._activityWindow.length;t++)this.FuncIconHideDeal(this._activityWindow[t],!0);for(var n in e.prototype.onLoad.call(this),i.instance=this,this._systemOpenConfigs=o.ConfigsManager.instance.getConfigs("systemopentipconf"),this._configs=o.ConfigsManager.instance.getConfigs("functioniconconf"),this._configs.functionIcon){var a=new r.default;a.id=Number(n),a.config=this._configs.functionIcon[n],this._infoDic[n]=a;var s=this._configs.functionIcon[n].windowType;s&&(this._windowtype[s]=a);var d=this._configs.functionIcon[n].sysId;d&&(this._SysId[d]=a)}l.GameEventDispatcher.instance.on(c.EventDefiner.ChapterReset,this.onChapterChange,this),this.systemLen=this.getSystemOpenTipConfList().length},t.prototype.start=function(){e.prototype.start.call(this),l.GameEventDispatcher.instance.on(c.EventDefiner.FunOpenEvent,this.onPlotComplete,this)},t.prototype.listNotification=function(){this.addProto("sysopen",this.sysopen,this),this.addProto("systemopentip",this.systemopentip,this)},t.prototype.getConfig=function(e){return this._configs.functionIcon[e]},t.prototype.getopenChapter=function(e){return this.getConfig(e).openChapter},t.prototype.getopenGuanqia=function(e){return this.getConfig(e).openGuanqia},t.prototype.getsysConfig=function(e){return this._systemOpenConfigs.SystemOpenTipConf[e]},t.prototype.getInfo=function(e){return this._infoDic[e]},t.prototype.getWindowtype=function(e){return this._windowtype[e]},t.prototype.getsysInfo=function(e){return this._SysId[e]},t.prototype.checkIsPass=function(e,t){return s.default.instance.currentChapterId>e||!!s.default.instance.section[e]&&!!s.default.instance.section[e][t]},t.prototype.checkIsOpenbyWindowtype=function(e,t){void 0===t&&(t=!1);var n=!0,o=this.getWindowtype(e);if(o&&o.config){if(o.config.isFinish<1)return t&&u.default.instance.ShowMsg(h.default.getStr("function_finish_tips")),!1;if(n=this.checkIsOpen(o.config.id),t&&!n){var a=s.default.instance.getChapterConfig(i.instance.getopenChapter(o.config.id)),r=s.default.instance.getGuanqiaConfigList(a.chapterId)[i.instance.getopenGuanqia(o.config.id)-1],l=S.NumberUtil.unitsDigitToText(a.chapterId);u.default.instance.ShowMsg(h.default.getStr("function_open_tips",h.default.getStr("chapterNumber",l),r.guanqiaName))}}return n},t.prototype.checkIsOpen=function(e){var t=this.getConfig(e);if(!t)return!0;if(t.isFinish<1)return!1;if(t.clientControl&&t.clientControl>0)return!t.openChapter||this.checkIsPass(t.openChapter-1,t.openGuanqia-1);var i=this.getConfig(e).sysId;return!(!a.MyRoleInfo.system[Math.floor(i/32)]||0==(a.MyRoleInfo.system[Math.floor(i/32)]&1<<i%32))},t.prototype.getFunctionIconInfoList=function(e,t){void 0===e&&(e=0),void 0===t&&(t=!1);var i=[],n=null;for(var o in this._infoDic)n=this._infoDic[o],(0==e||n.config.layerType&&n.config.layerType.indexOf(e)>-1)&&(n.isOpen=this.checkIsOpen(n.id),t?n.isOpen&&i.push(n):i.push(n));return i.sort(function(t,i){var n=t.config.layerType.indexOf(e)>-1?t.config.layerType.indexOf(e):0,o=i.config.layerType.indexOf(e)>-1?i.config.layerType.indexOf(e):0;return t.priority[n]<i.priority[o]?-1:t.priority[n]>i.priority[o]?1:0}),i},t.prototype.sysopen=function(e){this.NewFunc[e.id]=e.id,a.MyRoleInfo.system[Math.floor(e.id/32)]|=1<<e.id%32;var t=this.getsysInfo(e.id);t&&t.config&&this.onOpenNewFun(t,!0),g.default.instance.scenestatus!=y.GameScene.Fight&&m.default.instance.iscomplete&&this.onPlotComplete(),l.GameEventDispatcher.instance.emit(c.EventDefiner.OpenwindowFunc)},t.prototype.systemopentip=function(e){this.systemid=e.systemopentip,l.GameEventDispatcher.instance.emit(c.EventDefiner.SystemOpen),v.default.instance.isOpenWindow(p.WindowType.OpenFuncWin)&&_.default.instance.Info()},t.prototype.FuncIconRedDeal=function(e,t){this.RedData[e]=t,t||delete this.RedData[e],l.GameEventDispatcher.instance.emit(c.EventDefiner.ShowFunRed,{type:e,show:t})},t.prototype.FuncIconHideDeal=function(e,t){if(this.HideData[e]=t,b.default.instance&&b.default.instance.funcIconnum)for(var i=0;i<b.default.instance.funcIconnum.length;i++)if(1==i||4==i){var n=b.default.instance.funcIconnum[i].getChildByName(e+"");n&&(n.getComponent(T.default).IconActive=!t&&this.checkIsOpenbyWindowtype(e),b.default.instance.setFlagBtn())}for(i=0;i<this._activityStatus.length;i++)this._activityStatus[i][0]==e&&(this._activityStatus[i][1]=t?0:1)},t.prototype.onOpenNewFun=function(e,t){if(void 0===t&&(t=!1),e.config){e.config.isShowOpenPage>=1&&t&&(this.OpenserverList.push(e),this.currentFunData=e);for(var i=!1,n=0;n<this._activityStatus.length;n++)if(this._activityStatus[n][0]==e.config.windowType){var o=1!=this._activityStatus[n][1];this.FuncIconHideDeal(e.config.windowType,o),i=!0;break}i||this.FuncIconHideDeal(e.config.windowType,!1)}},t.prototype.onChapterChange=function(){var e=null;for(var t in this._infoDic)if(e=this._infoDic[t].config,!this._isFirst&&e.clientControl&&e.clientControl>0&&e.openChapter==s.default.instance.currentChapterId+1&&e.openGuanqia==s.default.instance.currentGuanqiaId)this.onOpenNewFun(this._infoDic[t],!0);else for(var i in this.HideData)this.HideData[i]&&this.checkIsOpenbyWindowtype(Number(i))&&this.onOpenNewFun(this._infoDic[t],!1);this._isFirst=!1},t.prototype.onPlotComplete=function(e){void 0===e&&(e=null);var t=!1;e&&(t=e.detail),i.instance.OpenserverList.length>0?d.default.instance.openWindow(p.WindowType.OpenFuncTips,function(){f.default.instance.onShowPage(0,t)},this):t&&l.GameEventDispatcher.instance.emit(c.EventDefiner.CardActive)},Object.defineProperty(t.prototype,"getOpenConfig",{get:function(){return this.currentFunData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"setOpenConfig",{set:function(e){this.currentFunData=e},enumerable:!0,configurable:!0}),t.prototype.getSystemOpenTipConfList=function(){var e=[],t=this._systemOpenConfigs.SystemOpenTipConf;for(var i in t){var n=t[i];this.systemid.length>0&&(n.state=this.systemid[i]),e.push(n)}return e},t.prototype.getSystemReward=function(e){var t={cmd:"systemopentipreward",id:e};C.default.instance.sendProto(t)},t.prototype.getSystemRedpoint=function(e){return!!e&&(!!this.RedData[e]&&this.RedData[e])},t.prototype.getIconStr=function(e){var t=e.windowType,i=e.iconRes;switch(t){case p.WindowType.BaiBeiFanLi:i=I.default.instance.isFristBag()?e.iconRes:e.iconRes1}return i},t.instance=null,t=i=__decorate([D],t)}(n.default));i.default=R,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../NetConnect/NetConnet":"NetConnet","../../Util/NumberUtil":"NumberUtil","../BaiBeiFanLi/BaiBeiFanLiCtrl":"BaiBeiFanLiCtrl","../Chapter/ChapterController":"ChapterController","../Gamelayer/FunctionIconListCell":"FunctionIconListCell","../Gamelayer/GameLayer":"GameLayer","../OpenFuncTips/OpenFuncTips":"OpenFuncTips","../OpenWin/OpenWinController":"OpenWinController","../PlotWin/PlotController":"PlotController","../Role/RoleInfo":"RoleInfo","../Scene/Controller/SceneController":"SceneController","../Tips/OpTipsController":"OpTipsController","./FunctionIconInfo":"FunctionIconInfo","./FunctionIconWin":"FunctionIconWin"}],FunctionIconInfo:[function(e,t,i){"use strict";cc._RF.push(t,"df944A1CxFMkrpfvw0Sz0uG","FunctionIconInfo"),Object.defineProperty(i,"__esModule",{value:!0});var n=cc._decorator,o=n.ccclass,a=(n.property,function(){function e(){this.id=0,this.config=null,this.isOpen=!1,this.status=0,this.leaveTime=0,this.getDataTime=0,this.num=0,this.tips=null}return Object.defineProperty(e.prototype,"priority",{get:function(){return this.config?this.config.priority:0},enumerable:!0,configurable:!0}),e=__decorate([o],e)}());i.default=a,cc._RF.pop()},{}],FunctionIconItem:[function(e,t,i){"use strict";cc._RF.push(t,"ee5a79hCkpHDZoX9HV2e9bU","FunctionIconItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../Commons/RewardUtils"),a=e("../../Core/LoadManager"),r=e("../../GlobalContext"),s=e("../../Core/WindowType"),l=e("../../Util/Utils"),c=e("../Item/ItemIcon"),d=e("../../Core/GameEventDispatcher"),p=e("../../Core/Event"),h=e("./FunctionIconController"),u=e("../Gamelayer/GameLayer"),f=cc._decorator,g=f.ccclass,y=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ItemIconItem=null,t.systemOpenNum=null,t.systemIcon=null,t.getReward=null,t.goToReward=null,t.spriteReward=null,t.rewardGroup=null,t.redSprite=null,t.SysIcon=null,t._SystemOpenData=null,t}return __extends(t,e),t.prototype.onInitData=function(e){this._SystemOpenData=e,this.onShowPage()},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),l.default.setNodeChildDestoryByUrl(this.rewardGroup,r.GlobalContext.Root+"prefab/Bag/ItemIcon")},t.prototype.onShowPage=function(){this.setChapterRewardShow(),this.systemOpenNum.string="\u901a\u8fc7\u7ae0\u8282"+this._SystemOpenData.openChapter+"(\u5173\u5361"+this._SystemOpenData.openGuanqia+")",this.systemIcon.getComponent(cc.Sprite).spriteFrame=this.SysIcon.getSpriteFrame(this._SystemOpenData.iconId),this.btnInit()},t.prototype.btnInit=function(){switch(this.getReward.active=!1,this.goToReward.active=!1,this.spriteReward.active=!1,this.redSprite.active=!1,this._SystemOpenData.state){case 2:this.spriteReward.active=!0;break;case 0:this.goToReward.active=!0;break;case 1:this.getReward.active=!0,this.redSprite.active=!0;break;default:this.goToReward.active=!0}},t.prototype.setChapterRewardShow=function(){for(var e=this,t=this._SystemOpenData.reward,i=o.default.instance.getItemList(t),n=0;n<this.rewardGroup.childrenCount;n++)this.rewardGroup.children[n].active=!1;if(this.rewardGroup.childrenCount<i.length)a.default.instance.loadResByType(r.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(t){for(var n=0;n<i.length;n++){var o=void 0;(o=l.default.getNodeByPool(s.PoolType.ItemIcon,t,r.GlobalContext.Root+"prefab/Bag/ItemIcon")).scale=.8,e.rewardGroup.addChild(o),o.getComponent(c.default).ItemData(i[n],!0,null,!0),o.attr({index_td:i[n].id})}},this);else for(n=0;n<i.length;n++)this.rewardGroup.children[n].getComponent(c.default).ItemData(i[n],!0,null,!0),this.rewardGroup.children[n].attr({index_td:i[n].id}),this.rewardGroup.children[n].active=!0},t.prototype.gotoReward=function(){d.GameEventDispatcher.instance.emit(p.EventDefiner.CloseCommonPage4),u.default.instance.MainlineLevelBtnClick()},t.prototype.getOpenReward=function(){h.default.instance.getSystemReward(this._SystemOpenData.id)},__decorate([y(cc.Label)],t.prototype,"systemOpenNum",void 0),__decorate([y(cc.Sprite)],t.prototype,"systemIcon",void 0),__decorate([y(cc.Node)],t.prototype,"getReward",void 0),__decorate([y(cc.Node)],t.prototype,"goToReward",void 0),__decorate([y(cc.Node)],t.prototype,"spriteReward",void 0),__decorate([y(cc.Node)],t.prototype,"rewardGroup",void 0),__decorate([y(cc.Node)],t.prototype,"redSprite",void 0),__decorate([y(cc.SpriteAtlas)],t.prototype,"SysIcon",void 0),t=__decorate([g],t)}(n.default);i.default=m,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/LoadManager":"LoadManager","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/RewardUtils":"RewardUtils","../Gamelayer/GameLayer":"GameLayer","../Item/ItemIcon":"ItemIcon","./FunctionIconController":"FunctionIconController"}],FunctionIconListCell:[function(e,t,i){"use strict";cc._RF.push(t,"3f872AxraVLWo0Oy9Ah6HGX","FunctionIconListCell"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../OpenWin/OpenWinController"),a=e("../../Util/GrayEffect"),r=e("../Functionicon/FunctionIconController"),s=e("../../Core/GameEventDispatcher"),l=e("../../Core/Event"),c=e("../../Core/LoadManager"),d=e("../../GlobalContext"),p=e("../Commons/Image"),h=e("../Effects/UIBtnEffect/UIBtnEffectController"),u=e("../Functionicon/UtilsFunClick"),f=e("./GameLayer"),g=cc._decorator,y=g.ccclass,m=(g.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.funcinfo=null,t.functionIcon=null,t.time=30,t.isWinPage=!1,t.haveEffect=!0,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this),this.funcinfo&&(this.openFunc(),this.showRed(),this.hideFun(),this.funcinfo.isOpen||s.GameEventDispatcher.instance.on(l.EventDefiner.OpenwindowFunc,this.openFunc,this)),s.GameEventDispatcher.instance.on(l.EventDefiner.ShowFunRed,this.showRed,this),s.GameEventDispatcher.instance.on(l.EventDefiner.ShowBtnPic,this.onShowBtnPic,this)},t.prototype.hide=function(){e.prototype.hide.call(this),s.GameEventDispatcher.instance.off(l.EventDefiner.OpenwindowFunc,this.openFunc,this),s.GameEventDispatcher.instance.off(l.EventDefiner.ShowFunRed,this.showRed,this),s.GameEventDispatcher.instance.off(l.EventDefiner.ShowBtnPic,this.onShowBtnPic,this)},t.prototype.initScene=function(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=!0),this.funcinfo=e,this.isWinPage=t,this.haveEffect=i,this.functionIcon?(this.onShowBtnPic(),this.openFunc()):c.default.instance.loadResByType(d.GlobalContext.Root+"ui/functionIcon/FunIcon",cc.SpriteAtlas,this.loadSpriteAtlasComplete,this)},t.prototype.loadSpriteAtlasComplete=function(e){this.functionIcon=e,this.onShowBtnPic(),this.openFunc()},t.prototype.onShowBtnPic=function(){if(this.functionIcon){var e=this.node.getChildByName("spriteBtn").getComponent(p.default),t=d.GlobalContext.Root+"ui/functionIcon/FunIcon";if(this.functionIcon.getSpriteFrame(this.funcinfo.config.iconTips)&&this.isWinPage)e.loadSpriteAtlas(t,this.funcinfo.config.iconTips);else if(this.functionIcon.getSpriteFrame(this.funcinfo.config.iconRes)){var i=r.default.instance.getIconStr(this.funcinfo.config);e.loadSpriteAtlas(t,i)}else e.loadSpriteAtlas(t,"other");e.getComponentInChildren(cc.Sprite)&&(e.getComponentInChildren(cc.Sprite).sizeMode=2,e.getComponentInChildren(cc.Sprite).trim=!1),this.node.getChildByName("spritBG")&&this.funcinfo.config.iconBG&&""!=this.funcinfo.config.iconBG&&this.node.getChildByName("spritBG").getComponent(p.default).loadSpriteAtlas(t,this.funcinfo.config.iconBG)}},t.prototype.openWindow=function(){o.default.instance.openWindow(this.funcinfo.config.windowType),h.default.instance.onPushClickWindowType(this.funcinfo.config.windowType,this.node),u.default.instance.onClickWin(this.funcinfo.config.windowType)},t.prototype.openFunc=function(){this.funcinfo.isOpen=r.default.instance.checkIsOpen(this.funcinfo.id),this.node.getComponentInChildren(a.default).setGray(!this.funcinfo.isOpen),this.node.getChildByName("spritBG")&&this.node.getChildByName("spritBG").getComponent(a.default)&&this.node.getChildByName("spritBG").getComponent(a.default).setGray(!this.funcinfo.isOpen),this.funcinfo.isOpen&&s.GameEventDispatcher.instance.off(l.EventDefiner.OpenwindowFunc,this.openFunc,this),this.showRed(),this.hideFun()},t.prototype.showRed=function(e){if((!e||this.funcinfo.config.windowType==e.detail.type)&&this.funcinfo.isOpen){var t=r.default.instance.RedData[this.funcinfo.config.windowType];this.node.getChildByName("spriteBtn").getChildByName("red").active=t,this.haveEffect&&h.default.instance.onSetEffect(this.node,this.funcinfo.config.windowType,t)}},t.prototype.onShowBtn=function(){this.node.active=!0},t.prototype.hideFun=function(){var e=!r.default.instance.HideData[this.funcinfo.config.windowType]&&r.default.instance.checkIsOpenbyWindowtype(this.funcinfo.config.windowType);this.node.active=e,6==this.funcinfo.config.layerType&&f.default.instance.setFlagBtn()},Object.defineProperty(t.prototype,"IconActive",{set:function(e){this.node.active=e},enumerable:!0,configurable:!0}),t=__decorate([y],t)}(n.default));i.default=m,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/LoadManager":"LoadManager","../../Core/Widget":"Widget","../../GlobalContext":"GlobalContext","../../Util/GrayEffect":"GrayEffect","../Commons/Image":"Image","../Effects/UIBtnEffect/UIBtnEffectController":"UIBtnEffectController","../Functionicon/FunctionIconController":"FunctionIconController","../Functionicon/UtilsFunClick":"UtilsFunClick","../OpenWin/OpenWinController":"OpenWinController","./GameLayer":"GameLayer"}],FunctionIconWin:[function(e,t,i){"use strict";cc._RF.push(t,"b9fa0ZVARtIMLC5mpVhT8MS","FunctionIconWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Commons/CommonPageBG"),o=e("../../Core/Language"),a=e("../Commons/ListViewCtrl"),r=e("./FunctionIconController"),s=e("./FunctionIconItem"),l=cc._decorator,c=l.ccclass,d=l.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.SystemItem=null,t.listViewCtrl=null,t._info=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this,this.onInit(875,638,o.default.getStr("ChapterTips9"),!0)},t.prototype.show=function(){e.prototype.show.call(this),this.Info()},t.prototype.onDisable=function(){e.prototype.onDisable.call(this)},t.prototype.hide=function(){e.prototype.hide.call(this)},t.prototype.Info=function(){this._info=r.default.instance.getSystemOpenTipConfList(),this.sortList(),this.setData(this._info)},t.prototype.setData=function(e){this.listViewCtrl.refreshItem=this.updateCardItem,this.listViewCtrl.refreshItemThis=this,this.listViewCtrl.initialize(e),this.listViewCtrl.scrollToTop()},t.prototype.sortList=function(){for(var e=[],t=0;t<this._info.length;t++)if(2==this._info[t].state){var i=this._info.splice(t,1);e=e.concat(i),t--}this._info.sort(this.sortup),e.sort(this.sortup),this._info=this._info.concat(e)},t.prototype.sortup=function(e,t){return e.state-t.state>0?-1:e.state-t.state<0?1:e.openChapter-t.openChapter>0?1:e.openChapter-t.openChapter<0?-1:e.openGuanqia-t.openGuanqia},t.prototype.updateCardItem=function(e,t){e.getComponent(s.default).onInitData(this.listViewCtrl.dataLsit[t])},t.instance=null,__decorate([d(a.default)],t.prototype,"listViewCtrl",void 0),t=i=__decorate([c],t)}(n.default);i.default=p,cc._RF.pop()},{"../../Core/Language":"Language","../Commons/CommonPageBG":"CommonPageBG","../Commons/ListViewCtrl":"ListViewCtrl","./FunctionIconController":"FunctionIconController","./FunctionIconItem":"FunctionIconItem"}],FunctionType:[function(e,t,i){"use strict";cc._RF.push(t,"59072rLbShDTqH+X/ouMN/8","FunctionType"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(){}return e.Expedition=7,e.TreasureMap=5,e.WorldBoss=11,e.EliteBoss=19,e.FridBoss=18,e.Arena=9,e.Ladder=10,e.Mine=61,e}();i.FunctionType=n,cc._RF.pop()},{}],GameBaseSDK:[function(e,t,i){"use strict";cc._RF.push(t,"dc4dcLfZMVLeronDj3OjdaI","GameBaseSDK"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../GlobalContext"),o=e("../../Core/GameEventDispatcher"),a=e("../../Core/Event"),r=e("../Login/LoginController"),s=function(){function e(){this.qq=86421899,this._userInfo={},this.openId="",this.gameID="slm",this.uid="",this.username="",this.session_key="",this.wsUrl="",this.help="",this.helpname="",this.topupinfo="",this.deviceid=null,this.access_token="",this.isCreateRole=!1,this.payCallBack=null,this.payCallBackThis=null,this.payCallBackThisObj=null,this._timestamp=null,this.init()}return Object.defineProperty(e.prototype,"timestamp",{get:function(){return null==this._timestamp?this._timestamp=Date.now():this._timestamp},set:function(e){this._timestamp=e},enumerable:!0,configurable:!0}),e.prototype.init=function(){n.GlobalContext.fightMode=1;var e={channelid:"guangzhou1",gameid:"slm",roomid:10,avatarUrl:"https://jxx-update.szfyhd.com/tdgame/robot_head/sprRobot"+(Math.floor(100*Math.random())+1)+".png",player:{uid:this.openId,name:this.openId,avatarUrl:"https://jxx-update.szfyhd.com/tdgame/robot_head/sprRobot"+(Math.floor(100*Math.random())+1)+".png",opt:""},nickname:this.openId,gender:1};this.userInfo=e},e.prototype.getGameData=function(){},e.prototype.login=function(){console.log("\u8bf7\u6c42\u767b\u5f55")},e.prototype.loginBack=function(e){console.log("\u767b\u5f55\u8fd4\u56de",e),o.GameEventDispatcher.instance.emit(a.EventDefiner.SDKLogin)},e.prototype.logout=function(){console.log("\u8bf7\u6c42\u767b\u51fa")},e.prototype.notifyroleInfo=function(){console.log("\u53d1\u9001\u89d2\u8272\u767b\u9646"),this.isCreateRole&&this.createRole()},e.prototype.createRole=function(){console.log("\u53d1\u9001\u521b\u89d2\u4fe1\u606f")},e.prototype.exit=function(){},e.prototype.onlineTime=function(e){},e.prototype.pay=function(e,t,i,n){void 0===t&&(t=null),void 0===i&&(i=null),void 0===n&&(n=null),this.payCallBack=t,this.payCallBackThis=i,this.payCallBackThisObj=n},e.prototype.payBack=function(){this.payCallBack&&this.payCallBack.call(this.payCallBackThis,this.payCallBackThisObj)},e.prototype.onAccountInvalid=function(){r.default.instance.resetGame()},Object.defineProperty(e.prototype,"userInfo",{get:function(){return this._userInfo},set:function(e){n.PlayerData.userInfo=this._userInfo=e},enumerable:!0,configurable:!0}),e}();i.GameBaseSDK=s,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../GlobalContext":"GlobalContext","../Login/LoginController":"LoginController"}],GameEventDispatcher:[function(e,t,i){"use strict";cc._RF.push(t,"94d0cdVu49CB7jx5H27ev/F","GameEventDispatcher"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.eventDic={},t}return __extends(t,e),Object.defineProperty(t,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t.clear=function(){t._instance=null},t.prototype.dispatchEvent=function(t){e.prototype.dispatchEvent.call(this,t)},t.prototype.emit=function(t,i){null!=i&&void 0!=i?e.prototype.emit.call(this,t,{detail:i,getUserData:function(){return i}}):e.prototype.emit.call(this,t,i)},t}(cc.EventTarget);i.GameEventDispatcher=n,cc._RF.pop()},{}],GameLayer:[function(e,t,i){"use strict";cc._RF.push(t,"ed464OVe2VDfYrGgBbhVz8K","GameLayer"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/GameEventDispatcher"),o=e("../../Core/Event"),a=e("../../Core/Window"),r=e("../Role/RoleInfo"),s=e("../Functionicon/FunctionIconController"),l=e("../../Util/NumberUtil"),c=e("../../GlobalContext"),d=e("../Status/StatusType"),p=e("../OpenWin/OpenWinController"),h=e("./RoleHead"),u=e("../Sound/SoundController"),f=e("../../Core/ConfigsManager"),g=e("./FunctionIconListCell"),y=e("../../Core/WindowType"),m=e("../Commons/MonsterPreview"),C=e("../Scene/Controller/FightController"),v=e("../Chapter/ChapterController"),_=e("../../Core/LoadManager"),b=e("../LoadingPanel/LoadingPanel"),T=e("../../Global/GlobalValue"),S=e("../Scene/Controller/SceneController"),I=e("../Scene/Controller/GuideFightController"),w=e("../Guide/GuideNewController"),D=e("../Shop/ShopController"),R=e("../Shop/ShopConst"),A=e("../Shop/Shop"),N=e("../Scene/Pool/SpinePools"),L=e("../../Core/SpineBase"),E=e("../../Core/CacheManager"),B=e("../../Core/TimeController"),M=e("../Scene/Pool/ActorPools"),x=e("../Role/RoleTitle/RoleTitleEvent"),k=e("../Activity/ActivityHallPage"),P=e("../Activity/ActivityController"),G=e("../Sports/SportsWindow"),F=e("../Role/RoleStrengthen/RoleStrengthenPage"),W=e("../ArtifactCollection/ArtifactCollectionCtrl"),U=e("../Role/RoleStrengthen/RoleStrengthenController"),O=e("../../Core/Language"),V=e("../Role/RoleStrengthen/RoleStrengthenEvent"),q=e("../Effects/UIBtnEffect/UIBtnEffectController"),H=e("../Commons/RulePage"),j=e("../../Util/Utils"),K=e("../../Core/WindowManager"),Y=e("../Functionicon/FunctionIconBtn"),z=e("../Vip/VipCtrl"),X=e("../Commons/WindowOpenUtils"),J=e("../Tips/OpTipsController"),Q=e("../Login/LoginRequest"),Z=cc._decorator,$=Z.ccclass,ee=Z.property,te=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.RoleName=null,t.EnemyLabel=null,t.MoneyLabel=null,t.DiamondLabel=null,t.LevelLabel=null,t.RoleHead=null,t.Exp=null,t.spriteVipLv=null,t.labelCombatValue=null,t.funcIconnum=[],t.funcPrefab=[],t.roleinfo=null,t.layerArtifact=null,t.btnRoleStrengthen=null,t.strengthenRed=null,t.layerTaskTips=null,t.spriteAtlas=null,t.vipSpriteAtlas=null,t.maingame=null,t.monsterPreview=null,t.systemOpenNode=null,t.shrink=null,t.curPlotSubsection=1,t.trackTimes=[0,7.266,12.166,16.8],t._hallWindowType=0,t.funList3W=97,t.lineWidth=4,t.layerBottomRetract=215,t.taskTips=null,t._roleFightChange=null,t.FuncIconPool1=new cc.NodePool,t.FuncIconPool2=new cc.NodePool,t.FuncIconPool3=new cc.NodePool,t.FuncIconPool4=new cc.NodePool,t.FuncIconPool5=new cc.NodePool,t.FuncIconPool=[],t.FuncopenList=[],t.SportWin=[y.WindowType.HighLadderWin,y.WindowType.Arena],t.activeList=[],t.begainanim=[],t._sevenDayLoginRewardFlag=!1,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){this.FuncIconPool=[this.FuncIconPool1,this.FuncIconPool2,this.FuncIconPool3,this.FuncIconPool4,this.FuncIconPool5,this.FuncIconPool5],r.MyRoleInfo.firstgame?this.loadBegainanim():u.default.instance.PlayBGM(u.SoundType.mainBG),i.instance=this,Q.default.longinReq(),this.node.setContentSize(c.GlobalContext.UIWidth,c.GlobalContext.UIHeight),this.onAddEvent(),B.default.instance.init()},t.prototype.onAddEvent=function(){n.GameEventDispatcher.instance.on(o.EventDefiner.PlayerFightChange,this.onShowPlayerFight,this),n.GameEventDispatcher.instance.on(o.EventDefiner.OpenRulePage,this.onOpenRule,this),n.GameEventDispatcher.instance.on(V.RoleStrengthenEvent.CanGetReward,this.onRoleStrengthenReward,this),n.GameEventDispatcher.instance.on(o.EventDefiner.ArtifactCollection_up_info,this.setArtifactCollectionBtnshow,this),n.GameEventDispatcher.instance.on(o.EventDefiner.ChangeGameScene,this.onGameSceneChange,this),n.GameEventDispatcher.instance.on(o.EventDefiner.CardPushWarm,this.onChangeFight,this),n.GameEventDispatcher.instance.on(o.EventDefiner.SystemOpen,this.systemOpen,this)},t.prototype.show=function(){e.prototype.show.call(this),this.activeList=P.default.instance.activityWindowTypeList,this.FuncopenList=[this.activeList,this.SportWin],n.GameEventDispatcher.instance.on(x.RoleTitleEvent.RoleTitleInfo,this.onChangeRoleTitle,this),n.GameEventDispatcher.instance.on(o.EventDefiner.PlayerMoneyChange,this.PlayerInfoInit,this),n.GameEventDispatcher.instance.on(o.EventDefiner.PowerChange,this.PlayerInfoInit,this),n.GameEventDispatcher.instance.on(o.EventDefiner.Integral,this.PlayerInfoInit,this),n.GameEventDispatcher.instance.on(o.EventDefiner.InitPlayerInfo,this.PlayerInfoInit,this),n.GameEventDispatcher.instance.on(o.EventDefiner.ExpChange,this.PlayerInfoInit,this),n.GameEventDispatcher.instance.on(o.EventDefiner.LevelChange,this.PlayerInfoInit,this),n.GameEventDispatcher.instance.on(o.EventDefiner.LevelChange,this.funcIconDeal,this),n.GameEventDispatcher.instance.on(o.EventDefiner.SkillChange,this.setmodelId,this),n.GameEventDispatcher.instance.on(o.EventDefiner.Vip_info_up,this.PlayerInfoInit,this),n.GameEventDispatcher.instance.on(o.EventDefiner.vipbenefitsUp,this.PlayerInfoInit,this),n.GameEventDispatcher.instance.on(o.EventDefiner.RoleSetUpDate,this.PlayerHead,this),n.GameEventDispatcher.instance.on("RoleNameChange",this.roleName,this),(i.showInfo||""!=r.MyRoleInfo.id)&&(this.PlayerInfoInit(),this.funcIconDeal()),this.onShowPlayerFight(!1),this.loadTaskTips(),this.setmodelId()},t.prototype.hide=function(){e.prototype.hide.call(this),n.GameEventDispatcher.instance.off(x.RoleTitleEvent.RoleTitleInfo,this.onChangeRoleTitle,this),n.GameEventDispatcher.instance.off(o.EventDefiner.PlayerMoneyChange,this.PlayerInfoInit,this),n.GameEventDispatcher.instance.off(o.EventDefiner.PowerChange,this.PlayerInfoInit,this),n.GameEventDispatcher.instance.off(o.EventDefiner.Integral,this.PlayerInfoInit,this),n.GameEventDispatcher.instance.off(o.EventDefiner.InitPlayerInfo,this.PlayerInfoInit,this),n.GameEventDispatcher.instance.off(o.EventDefiner.ExpChange,this.PlayerInfoInit,this),n.GameEventDispatcher.instance.off(o.EventDefiner.LevelChange,this.PlayerInfoInit,this),n.GameEventDispatcher.instance.off(o.EventDefiner.LevelChange,this.funcIconDeal,this),n.GameEventDispatcher.instance.off(o.EventDefiner.SkillChange,this.setmodelId,this),n.GameEventDispatcher.instance.off(o.EventDefiner.RoleSetUpDate,this.PlayerHead,this),n.GameEventDispatcher.instance.off(o.EventDefiner.Vip_info_up,this.PlayerInfoInit,this),n.GameEventDispatcher.instance.off(o.EventDefiner.vipbenefitsUp,this.PlayerInfoInit,this),n.GameEventDispatcher.instance.off("RoleNameChange",this.roleName,this)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this);for(var t=0;t<this.FuncIconPool.length;t++)this.FuncIconPool[t].clear()},t.prototype.PlayerHead=function(){this.RoleHead.getComponent("RoleHead").SetHead(r.MyRoleInfo.icon)},t.prototype.onClickHeadSetUp=function(){X.default.instance.openWindowType(y.WindowType.RoleHeadSetUp)},t.prototype.setVipRedPoint=function(){this.spriteVipLv.node.parent.getChildByName("red").active=z.default.instance.data.getVipbenefitsRedPoint()},t.prototype.setmodelId=function(){0!=r.MyRoleInfo.currentsurface&&this.monsterPreview.getComponent(m.default).init("role",r.MyRoleInfo.currentsurface,1,"default"),this.onChangeRoleTitle()},t.prototype.onChangeRoleTitle=function(){},t.prototype.onShowPlayerFight=function(e){var t=this;if(void 0===e&&(e=!0),U.default.instence&&U.default.instence.strengthenData.currentFight>=0){if(this.labelCombatValue.string=U.default.instence.strengthenData.currentFight+"",S.default.instance.scenestatus==T.GameScene.Fight||!e)return void(e&&(U.default.instence.delayShowFightChange=1));if(U.default.instence.strengthenData.clientOldFight>0&&U.default.instence.strengthenData.currentFight!=U.default.instence.strengthenData.clientOldFight)if(this._roleFightChange)this._roleFightChange.removeFromParent(),this.onClearFightChange(),c.PlayerData.TipsLayer.insertChild(this._roleFightChange,999);else{var i=c.GlobalContext.Root+"prefab/Role/RoleStrengthen/RoleFightChange";_.default.instance.loadResByType(i,cc.Prefab,function(e){t._roleFightChange=j.default.getNodeByUrl(e,i),t._roleFightChange.name="fightChange",t.onClearFightChange(),c.PlayerData.TipsLayer.insertChild(t._roleFightChange,999)},this)}}},t.prototype.onClearFightChange=function(){c.PlayerData.TipsLayer.getChildByName("fightChange")&&c.PlayerData.TipsLayer.removeChild(c.PlayerData.TipsLayer.getChildByName("fightChange"))},t.prototype.roleName=function(){this.RoleName.string=r.MyRoleInfo.name,J.default.instance.ShowMsg(O.default.getStr("\u4fee\u6539\u6210\u529f")),n.GameEventDispatcher.instance.emit("CloseNameChange",this)},t.prototype.PlayerInfoInit=function(){n.GameEventDispatcher.instance.emit(o.EventDefiner.OpenwindowFunc),0==i.showInfo&&this.funcIconDeal(),i.showInfo=!0,this.RoleName.string=r.MyRoleInfo.name,this.DiamondLabel.string=l.NumberUtil.getDiamondNum(r.MyRoleInfo.diamond),this.MoneyLabel.string=l.NumberUtil.getNumber(r.MyRoleInfo.money),this.EnemyLabel.string=l.NumberUtil.getNumber(r.MyRoleInfo.energy)+"/"+r.MyRoleInfo.showEnergy,this.LevelLabel.string="Lv "+r.MyRoleInfo.level;var e=Math.min(T.RoleMaxLevel,r.MyRoleInfo.level);this.spriteVipLv.spriteFrame=this.vipSpriteAtlas.getSpriteFrame("vip"+r.MyRoleInfo.vipLevel),this.Exp.progress=r.MyRoleInfo.level>0?r.MyRoleInfo.exp/f.ConfigsManager.instance.getConfigs("levelconf").LevelConf[e].exp:0,this.spriteVipLv.node.parent.parent.active=s.default.instance.checkIsOpenbyWindowtype(y.WindowType.VIP),this.PlayerHead(),this.setVipRedPoint()},t.prototype.funcIconDeal=function(){for(var e=0;e<this.funcIconnum.length;e++){for(var t=s.default.instance.getFunctionIconInfoList(e+1),i=this.funcIconnum[e],n=i.childrenCount-1;n>=0;n--)i.children[n].getComponent(g.default)&&this.FuncIconPool[e].put(i.children[n]);i.destroyAllChildren();for(var o=0;o<t.length;o++){var a=void 0;(a=this.FuncIconPool[e]&&this.FuncIconPool[e].size()>0?this.FuncIconPool[e].get():cc.instantiate(this.funcPrefab[e])).name=t[o].config.windowType+"",a.getComponent(g.default).initScene(t[o]),i.addChild(a),0==s.default.instance.HideData[t[o].config.windowType]?a.getComponent(g.default).IconActive=!0:a.getComponent(g.default).IconActive=!1}}},t.prototype.setFlagBtn=function(){var e=this.funcIconnum[4].parent.parent.parent.parent,t=this.getIconShowNum(this.funcIconnum[5]);e.x=this.funcIconnum[5].parent.parent.x+106*t;var i=!1;for(var n in this.funcIconnum[4].children)if(s.default.instance.checkIsOpenbyWindowtype(parseInt(this.funcIconnum[4].children[n].name))){i=!0;break}e.active!=i&&(e.active=i)},t.prototype.onOpenRule=function(e){e&&e.detail>0&&p.default.instance.openWindow(y.WindowType.RulePage,function(){H.default.instance.setDataByWindowType(e.detail)},this)},t.prototype.onClickShrink=function(){var e=this.shrink.getChildByName("layerContent");e.active=!e.active},t.prototype.MainlineLevelBtnClick=function(){K.default.instance.closeAll(),n.GameEventDispatcher.instance.emit(o.EventDefiner.ChangeActivityStatus,d.ActivityStatus.Chapter)},t.prototype.onClickOpenUnion=function(){},t.prototype.onClickOpenTotems=function(){p.default.instance.openWindow(y.WindowType.Totems)},t.prototype.onGameSceneChange=function(e){var t=e.getUserData();t&&(S.default.instance.scenestatus=Number(t.status),S.default.instance.scenestatus!=T.GameScene.Fight&&(0==v.default.instance.currentChapterId&&v.default.instance.currentGuanqiaId>2||v.default.instance.currentChapterId>0)&&this.onChangeFight(),this.checkSysteamOpenNodeActive())},t.prototype.checkSysteamOpenNodeActive=function(){this.systemOpenNode.active=S.default.instance.scenestatus==T.GameScene.Main},t.prototype.onChangeFight=function(){U.default.instence.delayShowFightChange>0&&(U.default.instence.delayShowFightChange=0,this.onShowPlayerFight())},t.prototype.onRoleStrengthenReward=function(){var e=U.default.instence.strengthenData.isCanGet;this.strengthenRed.active=e,q.default.instance.onSetEffect(this.btnRoleStrengthen,y.WindowType.RoleStrengthen,e,.6)},t.prototype.IconChange=function(e,t){void 0===e&&(e=null),void 0===t&&(t=200),this.DiamondLabel.string=l.NumberUtil.getDiamondNum(r.MyRoleInfo.diamond),this.MoneyLabel.string=l.NumberUtil.getNumber(r.MyRoleInfo.money),this.EnemyLabel.string=l.NumberUtil.getNumber(r.MyRoleInfo.energy)+"/"+r.MyRoleInfo.showEnergy},t.prototype.loadBegainanim=function(){var e,t=this;u.default.instance.PlayEffect(u.SoundType.firstPlot+"1");var i=new cc.Node,a=new cc.Node,r=new cc.Node;i.setContentSize(c.GlobalContext.UIWidth,c.GlobalContext.UIHeight),i.addComponent(cc.BlockInputEvents);var s=new cc.Component.EventHandler;s.target=this.node,s.component="GameLayer",s.handler="speedchange",s.customEventData="0";var l=new cc.Component.EventHandler;l.target=this.node,l.component="GameLayer",l.handler="speedchange",l.customEventData="2",a.addComponent(cc.Button).clickEvents[0]=s,a.addComponent(cc.Sprite).spriteFrame=this.maingame.getSpriteFrame("queqick"),r.addComponent(cc.Button).clickEvents[0]=l,r.width=c.GlobalContext.UIWidth,r.height=c.GlobalContext.UIHeight,r.setPosition(0,0);var d=(e=N.SpinePools.addSpineNoder(this.node,new cc.Vec2(0,0))).getComponent(L.default);d.initSpineData("ui/scene/beginanim/anim",null,"ani"+this.curPlotSubsection,!1),this.node.addChild(i),w.default.instance.node.addChild(r),this.begainanim=[e,i,a,r],d.completeCallbackThisObj=this,d.completeCallbackParam=["P1"],d.completeCallback=function(s){t.curPlotSubsection++,t.curPlotSubsection<=4?(d.changeAction(null,"ani"+t.curPlotSubsection),t.playFirstPlot(t.curPlotSubsection)):"P1"==s?(console.log("\u7b2c\u4e00\u6bb5\u64ad\u653e\u5b8c\u6210"),t.enternextfight(),u.default.instance.StopEffectByType(u.SoundType.firstPlot+"4")):(console.log("\u7b2c\u4e8c\u6bb5\u64ad\u653e\u5b8c\u6210"),e.destroy(),i.destroy(),a.destroy(),r.destroy(),t.begainanim=[],I.default.instance.guidefightstatus=1,n.GameEventDispatcher.instance.emit(o.EventDefiner.ChangeGameScene,{status:T.GameScene.Main}),w.default.instance.checkCondition(2),E.default.instance.deteleRecordUrlDic("ui/scene/beginanim/anim"),M.ActorPools.clearAll(),u.default.instance.PlayBGM(u.SoundType.mainBG))}},t.prototype.playFirstPlot=function(e){u.default.instance.StopEffectByType(u.SoundType.firstPlot+(e-1)),u.default.instance.PlayEffect(u.SoundType.firstPlot+e)},t.prototype.speedchange=function(e,t){switch(t){case"0":console.log("\u52a0\u901f\u4e00\u500d\u64ad\u653e"),this.begainanim[0].getComponent(sp.Skeleton).timeScale=2,this.begainanim[2].getComponent(cc.Button).clickEvents[0].customEventData="1";break;case"1":console.log("\u6b63\u5e38\u64ad\u653e"),this.begainanim[0].getComponent(sp.Skeleton).timeScale=1,this.begainanim[2].getComponent(cc.Button).clickEvents[0].customEventData="0";break;case"2":var i=this.begainanim[0].getComponent(L.default);this.curPlotSubsection++,this.curPlotSubsection<=4?(i.changeAction(null,"ani"+this.curPlotSubsection),this.playFirstPlot(this.curPlotSubsection)):(this.enternextfight(),u.default.instance.StopEffectByType(u.SoundType.firstPlot+"1"),u.default.instance.StopEffectByType(u.SoundType.firstPlot+"2"),u.default.instance.StopEffectByType(u.SoundType.firstPlot+"3"),u.default.instance.StopEffectByType(u.SoundType.firstPlot+"4"));break;case"3":I.default.instance.completeGuideFight()}},t.prototype.enternextfight=function(){this.begainanim[3].getComponent(cc.Button).clickEvents[0].customEventData="3",i.instance.begainanim.forEach(function(e){e.active=!1},i.instance),C.default.instance.enterGuide(),i.instance.begainanim[0].getComponent(sp.Skeleton).timeScale=1,i.instance.begainanim[0].getComponent(sp.Skeleton).paused=!0},t.prototype.playendani=function(){if(i.instance&&i.instance.begainanim.length>0){b.default.instance.SceneLoading.active=!1;for(var e=0;e<i.instance.begainanim.length;e++)i.instance.begainanim[e].active=!1,i.instance.begainanim[0].active=!0,i.instance.begainanim[e].zIndex=90+e;i.instance.begainanim[0].getComponent(L.default).completeCallbackParam=["P2"],i.instance.begainanim[0].getComponent(L.default).play("P2"),i.instance.begainanim[0].getComponent(L.default).spine.paused=!1}},t.prototype.loadTaskTips=function(){var e=this;if(null==this.taskTips)var t=B.default.instance.setTimeout(function(){var i=c.GlobalContext.Root+"prefab/Daily/TaskTips";_.default.instance.loadResByType(i,cc.Prefab,function(t){e.taskTips=j.default.getNodeByUrl(t,i),e.layerTaskTips.addChild(e.taskTips)},e),B.default.instance.clearTimeout(t)},this,5e3)},t.prototype.onClickOpenDrawCard=function(){p.default.instance.openWindow(y.WindowType.DrawCard)},t.prototype.onClickOpenWarTeam=function(){p.default.instance.openWindow(y.WindowType.WarTeam)},t.prototype.onClickOpenArtifact=function(){p.default.instance.openWindow(y.WindowType.Artifact)},t.prototype.onClickVIPWin=function(){p.default.instance.openWindow(y.WindowType.VIP)},t.prototype.onClickShop=function(){p.default.instance.openWindow(y.WindowType.Shop,function(){var e=D.default.instance.nowSortIndex[R.ShopConst.Diamonds];A.default.instance.TabBtnList2.selectItem(e)},this)},t.prototype.onClickOpenActivity=function(){var e=this;p.default.instance.openWindow(y.WindowType.ActivityWin,function(){k.default.instance.onInitData(e._hallWindowType),e._hallWindowType=0},this)},t.prototype.onClickOpenSportsWin=function(){p.default.instance.openWindow(y.WindowType.SportsWin,function(){G.default.instance.onInitData()},this)},t.prototype.onClickStrengthen=function(){p.default.instance.openWindow(y.WindowType.RoleStrengthen,function(){F.default.instance.onInitData()},this),q.default.instance.onPushClickWindowType(y.WindowType.RoleStrengthen,this.btnRoleStrengthen)},t.prototype.onClickArtifactCollectionBtn=function(){s.default.instance.checkIsOpenbyWindowtype(y.WindowType.ArtifactCollection,!0)&&p.default.instance.openWindow(y.WindowType.ArtifactCollection)},t.prototype.systemOpen=function(){var e=s.default.instance.systemid;v.default.instance.currentChapterId+1<s.default.instance.getopenChapter(146)||s.default.instance.systemLen==e.length&&-1==e.indexOf(1)&&-1==e.indexOf(null)?this.onOpenFuncIconWin(!1):this.onOpenFuncIconWin(!0)},t.prototype.onOpenFuncIconWin=function(e){e?this.systemOpenNode.children.length?Y.default.instance.setLabel():this.funcIconBtn():this.systemOpenNode.children.length&&this.systemOpenNode.removeAllChildren()},t.prototype.funcIconBtn=function(){var e=this;_.default.instance.loadResByType(c.GlobalContext.Root+"prefab/FunctionIcon/FuncIconOpen",cc.Prefab,function(t){var i=j.default.getNodeByUrl(t,c.GlobalContext.Root+"prefab/FunctionIcon/FuncIconOpen");e.systemOpenNode.addChild(i),Y.default.instance&&Y.default.instance.setLabel()},this)},t.prototype.setArtifactCollectionBtnshow=function(){s.default.instance.checkIsOpenbyWindowtype(y.WindowType.ArtifactCollection,!1);!W.default.instance||!W.default.instance.data||(this.layerArtifact.active=!1,this.layerArtifact.active)},t.prototype.setListEffect=function(e,t){var i=this,n=this.funcIconnum[4].parent.parent.parent;n.stopAllActions();var o=this.funcIconnum[4].parent.parent.width;o*=n.getChildByName("btn").rotation>0?-1:1;var a=4==t,r=cc.moveBy(1,a?cc.v2(o,0):cc.v2(0,o)),s=cc.callFunc(function(){for(var e in i.funcIconnum[t].children)i.funcIconnum[t].children[e].active&&(i.funcIconnum[t].children[e].getComponent(cc.Button).interactable=!(n.getChildByName("btn").rotation>0));n.getChildByName("btn").rotation=n.getChildByName("btn").rotation>0?0:180}),l=cc.sequence([r,s]);n.runAction(l)},t.prototype.getIconShowNum=function(e){var t=0;for(var i in e.children)e.children[i].active&&(t+=1);return t},t.showInfo=!1,t.instance=null,__decorate([ee(cc.Label)],t.prototype,"RoleName",void 0),__decorate([ee(cc.Label)],t.prototype,"EnemyLabel",void 0),__decorate([ee(cc.Label)],t.prototype,"MoneyLabel",void 0),__decorate([ee(cc.Label)],t.prototype,"DiamondLabel",void 0),__decorate([ee(cc.Label)],t.prototype,"LevelLabel",void 0),__decorate([ee(h.default)],t.prototype,"RoleHead",void 0),__decorate([ee(cc.ProgressBar)],t.prototype,"Exp",void 0),__decorate([ee(cc.Sprite)],t.prototype,"spriteVipLv",void 0),__decorate([ee(cc.Label)],t.prototype,"labelCombatValue",void 0),__decorate([ee(cc.Node)],t.prototype,"funcIconnum",void 0),__decorate([ee(cc.Prefab)],t.prototype,"funcPrefab",void 0),__decorate([ee(cc.Node)],t.prototype,"roleinfo",void 0),__decorate([ee(cc.Node)],t.prototype,"layerArtifact",void 0),__decorate([ee(cc.Node)],t.prototype,"btnRoleStrengthen",void 0),__decorate([ee(cc.Node)],t.prototype,"strengthenRed",void 0),__decorate([ee(cc.Node)],t.prototype,"layerTaskTips",void 0),__decorate([ee(cc.SpriteAtlas)],t.prototype,"spriteAtlas",void 0),__decorate([ee(cc.SpriteAtlas)],t.prototype,"vipSpriteAtlas",void 0),__decorate([ee(cc.SpriteAtlas)],t.prototype,"maingame",void 0),__decorate([ee(cc.Node)],t.prototype,"monsterPreview",void 0),__decorate([ee(cc.Node)],t.prototype,"systemOpenNode",void 0),__decorate([ee(cc.Node)],t.prototype,"shrink",void 0),t=i=__decorate([$],t)}(a.default);i.default=te,cc._RF.pop()},{"../../Core/CacheManager":"CacheManager","../../Core/ConfigsManager":"ConfigsManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/SpineBase":"SpineBase","../../Core/TimeController":"TimeController","../../Core/Window":"Window","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/NumberUtil":"NumberUtil","../../Util/Utils":"Utils","../Activity/ActivityController":"ActivityController","../Activity/ActivityHallPage":"ActivityHallPage","../ArtifactCollection/ArtifactCollectionCtrl":"ArtifactCollectionCtrl","../Chapter/ChapterController":"ChapterController","../Commons/MonsterPreview":"MonsterPreview","../Commons/RulePage":"RulePage","../Commons/WindowOpenUtils":"WindowOpenUtils","../Effects/UIBtnEffect/UIBtnEffectController":"UIBtnEffectController","../Functionicon/FunctionIconBtn":"FunctionIconBtn","../Functionicon/FunctionIconController":"FunctionIconController","../Guide/GuideNewController":"GuideNewController","../LoadingPanel/LoadingPanel":"LoadingPanel","../Login/LoginRequest":"LoginRequest","../OpenWin/OpenWinController":"OpenWinController","../Role/RoleInfo":"RoleInfo","../Role/RoleStrengthen/RoleStrengthenController":"RoleStrengthenController","../Role/RoleStrengthen/RoleStrengthenEvent":"RoleStrengthenEvent","../Role/RoleStrengthen/RoleStrengthenPage":"RoleStrengthenPage","../Role/RoleTitle/RoleTitleEvent":"RoleTitleEvent","../Scene/Controller/FightController":"FightController","../Scene/Controller/GuideFightController":"GuideFightController","../Scene/Controller/SceneController":"SceneController","../Scene/Pool/ActorPools":"ActorPools","../Scene/Pool/SpinePools":"SpinePools","../Shop/Shop":"Shop","../Shop/ShopConst":"ShopConst","../Shop/ShopController":"ShopController","../Sound/SoundController":"SoundController","../Sports/SportsWindow":"SportsWindow","../Status/StatusType":"StatusType","../Tips/OpTipsController":"OpTipsController","../Vip/VipCtrl":"VipCtrl","./FunctionIconListCell":"FunctionIconListCell","./RoleHead":"RoleHead"}],GameSDK:[function(e,t,i){"use strict";cc._RF.push(t,"c3d755Y8ghA2aQee31SptaN","GameSDK"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./BilibiliSDK"),o=e("./WebSDK"),a=e("./SDKPlatform"),r=e("./QQSDK"),s=e("../../GlobalContext"),l=e("../../Util/SDKUtils"),c=e("./GameBaseSDK"),d=e("./XYHDSDK"),p=function(){function e(){this._sdk=null}return Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sdk",{get:function(){if(this._sdk)return this._sdk;switch(l.default.instance.plat_id){case a.SDKPlatfotmType.Test:this._sdk=new o.WebSDK,l.default.instance.getQueryString("resurl")&&(s.GlobalContext.ResRoot=l.default.instance.getQueryString("resurl"));var e=l.default.instance.getQueryString("post_data"),t=JSON.parse(e);t&&(this._sdk.userInfo=t,this._sdk.gameID=t.gameid,this._sdk.openId=t.player.uid);break;case a.SDKPlatfotmType.QQAudit:tdgamesdk&&(console.log("\u83b7\u53d6sdk : \u5fae\u4fe1\u5c0f\u6e38\u620f",cc.sys,cc.sys.platform,cc.sys.WECHAT_GAME),this._sdk=new r.QQSDK,this._sdk.openId=tdgamesdk.openId,this._sdk.gameID=tdgamesdk.gameID,this._sdk.session_key=tdgamesdk.session_key,this._sdk.userInfo=tdgamesdk.userInfo,l.default.instance.initWX(),s.GlobalContext.fightMode=1);break;case a.SDKPlatfotmType.Bilibili:this._sdk=new n.default;break;case a.SDKPlatfotmType.XYHD:this._sdk=new d.XYHDSDK}return console.log("\u83b7\u53d6SDK",l.default.instance.plat_id,JSON.stringify(this._sdk)),this._sdk||(this._sdk=new c.GameBaseSDK),this._sdk},enumerable:!0,configurable:!0}),e}();i.default=p,cc._RF.pop()},{"../../GlobalContext":"GlobalContext","../../Util/SDKUtils":"SDKUtils","./BilibiliSDK":"BilibiliSDK","./GameBaseSDK":"GameBaseSDK","./QQSDK":"QQSDK","./SDKPlatform":"SDKPlatform","./WebSDK":"WebSDK","./XYHDSDK":"XYHDSDK"}],Gemstone:[function(e,t,i){"use strict";cc._RF.push(t,"acd544C/XVLApqvcNImuqug","Gemstone"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Item/ItemData"),o=e("../../../Core/Widget"),a=e("../../Item/ItemIcon"),r=e("./EquipCtrl"),s=e("../../../Core/Language"),l=e("../../Tips/OpTipsController"),c=e("../../../Core/GameEventDispatcher"),d=e("../../../Core/Event"),p=e("../../WarTeam/MonsterController"),h=e("../../Sound/SoundController"),u=e("../../../Util/Utils"),f=e("../../../Util/AttrUtil"),g=e("../../../Global/GlobalValue"),y=cc._decorator,m=y.ccclass,C=(y.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onClickIndex=null,t._equipData=null,t._guid=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.setBtnText(s.default.getStr("\u5347 \u7ea7"))},t.prototype.show=function(){e.prototype.show.call(this),c.GameEventDispatcher.instance.on(d.EventDefiner.EQUIP_up_GemInfo,this.upGemInfo,this),c.GameEventDispatcher.instance.on("BagPackInfoChange",this.upShowData,this)},t.prototype.hide=function(){this._onClickIndex=null,this._equipData=null,this._guid=null,e.prototype.hide.call(this),c.GameEventDispatcher.instance.off(d.EventDefiner.EQUIP_up_GemInfo,this.upGemInfo,this),c.GameEventDispatcher.instance.off("BagPackInfoChange",this.upShowData,this)},t.prototype.setData=function(e){this._guid=e,this._onClickIndex=r.default.instance.data.getGemClickIndex(e),this.upShowData()},t.prototype.upGemInfo=function(e){var t=e?e.getUserData():null;t&&t.flag&&h.default.instance.PlayEffect(h.SoundType.upSucceeds),this.upShowData()},t.prototype.upShowData=function(){this._equipData=r.default.instance.data.getItemByGuid(this._guid),this._equipData?(this.setItemData(this._equipData),this.setGemstoneData(this._equipData)):this.initData(),this.setClickShow(),this.upRedPoit()},t.prototype.initData=function(){this.node.getChildByName("ItemIcon").active=!1;var e=this.node.getChildByName("gemstoneNode");for(var t in e.children)this.setGemstoneInfo(e.children[t],null,parseInt(t))},t.prototype.setItemData=function(e){var t=!!e,i=this.node.getChildByName("ItemIcon");i.active=t,t&&i.getComponent(a.default).ItemData(e)},t.prototype.setGemstoneData=function(e){var t=this.node.getChildByName("gemstoneNode");for(var i in t.children)this.setGemstoneInfo(t.children[i],e.gem[i]?e.gem[i]:null,parseInt(i))},t.prototype.setGemstoneInfo=function(e,t,i){var o=r.default.instance.data.getGemstoneCfg(t);e.getChildByName("bg").active=!1;var s=!!o,l="";if(this._equipData&&o){var c=r.default.instance.data.getGemstoneAttr(o.attr),d={};d[c.type]=c.value,d=p.default.instance.getAttrPrecentByGradeAndType(p.default.instance.data.MorphologicalTag,d),l=u.default.getGemVal(c.type,d&&d[c.type]?d[c.type]:0)}e.getChildByName("img2").active=!s;var h=s?o.level:0;e.getChildByName("img").active=s,e.getChildByName("img").getChildByName("Label").getComponent(cc.Label).string=h;var g=e.getChildByName("ItemIcon");if(g.active=s,s){var y=n.default.creatItem(t,1);g.getComponent(a.default).ItemData(y,!1,null,!1)}e.getChildByName("attrbg").active=!0;var m=e.getChildByName("attrbg").getChildByName("attrNode"),C=r.default.instance.data.getGemType(this._equipData,i);m.getChildByName("Label").getComponent(cc.Label).string=null!=C&&s?f.default.getAttrName(C)+":":f.default.getAttrName(C),m.getChildByName("value").getComponent(cc.Label).string=l},t.prototype.setClickShow=function(){var e=this.node.getChildByName("gemstoneNode");for(var t in e.children)e.children[t].getChildByName("bg").active=parseInt(t)==this._onClickIndex},t.prototype.onClickItem=function(e,t){if(h.default.instance.PlayEffect(h.SoundType.replaceSucceeds),this._onClickIndex=Number(t),this.setClickShow(),this._equipData&&(0==this._equipData.gem.length||!this._equipData.gem[parseInt(t)])){var i=r.default.instance.data.getGemType(this._equipData,parseInt(t)),n=r.default.instance.data.getGemstone();if(n.length>0&&null!=i){var o=r.default.instance.data.getGemGuidByGemType(n,i);r.default.instance.reqInlayGemstone(this._onClickIndex,this._equipData.guid,o)}}},t.prototype.setBtnText=function(e){this.node.getChildByName("btn_02").getChildByName("New Label").getComponent(cc.Label).string=e},t.prototype.unloadGemstone=function(){this._equipData?null!=this._onClickIndex?r.default.instance.reqUnloadGemstone(this._onClickIndex,this._equipData.guid):l.default.instance.ShowMsg(s.default.getStr("\u8bf7\u9009\u62e9\u9576\u5d4c\u69fd")):l.default.instance.ShowMsg(s.default.getStr("\u8bf7\u7a7f\u6234\u88c5\u5907"))},t.prototype.onClickBtnTwo=function(){if(h.default.instance.PlayEffect(h.SoundType.replaceSucceeds),this._equipData)if(null!=this._onClickIndex)switch(r.default.instance.data.getGameActionType(this._equipData,this._onClickIndex)){case g.GemActionType.REPLACE:var e=r.default.instance.data.getGemstone(),t=r.default.instance.data.getGemType(this._equipData,this._onClickIndex),i=r.default.instance.data.getGemGuidByGemType(e,t);this.replacementGemstone(this._onClickIndex,this._equipData.guid,i);break;case g.GemActionType.UPGRADE:this.reqSynthesis(this._onClickIndex,this._equipData.guid,this._equipData.gem[this._onClickIndex]);break;case g.GemActionType.NULL:l.default.instance.ShowMsg(s.default.getStr("noMaterial"))}else l.default.instance.ShowMsg(s.default.getStr("\u8bf7\u9009\u62e9\u9576\u5d4c\u69fd"));else l.default.instance.ShowMsg(s.default.getStr("\u8bf7\u7a7f\u6234\u88c5\u5907"))},t.prototype.replacementGemstone=function(e,t,i){r.default.instance.reqReplacementGemstone(e,t,i)},t.prototype.reqSynthesis=function(e,t,i){r.default.instance.reqGemGemupgrade(e,t,i)},t.prototype.upRedPoit=function(){var e=this.node.getChildByName("gemstoneNode"),t=!(!this._equipData||!p.default.instance.getIsLineup(this._equipData.ower));for(var i in e.children){var n=r.default.instance.data.getGameActionType(this._equipData,parseInt(i))!=g.GemActionType.NULL;e.children[i].getChildByName("red").active=t&&n}},t=__decorate([m],t)}(o.default));i.default=C,cc._RF.pop()},{"../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Core/Widget":"Widget","../../../Global/GlobalValue":"GlobalValue","../../../Util/AttrUtil":"AttrUtil","../../../Util/Utils":"Utils","../../Item/ItemData":"ItemData","../../Item/ItemIcon":"ItemIcon","../../Sound/SoundController":"SoundController","../../Tips/OpTipsController":"OpTipsController","../../WarTeam/MonsterController":"MonsterController","./EquipCtrl":"EquipCtrl"}],GiftBagItem:[function(e,t,i){"use strict";cc._RF.push(t,"f12ddQ7LoVF/qZ/1imOAJP7","GiftBagItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("./ItemIcon"),a=cc._decorator,r=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.itemName=null,t.itemNode=null,t.checkedNode=null,t._isChecked=!1,t}var i;return __extends(t,e),i=t,t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.setData=function(e){this.itemNode.getComponent(o.default).ItemData(e,!0,null,!0),this.itemName.string=e.name,this.setCheckedFlag()},t.prototype.setCheckedFlag=function(e){void 0===e&&(e=!1),this._isChecked=e,this.checkedNode.active=e},Object.defineProperty(t.prototype,"isChecked",{get:function(){return this._isChecked},enumerable:!0,configurable:!0}),t.prototype.onClickImg=function(e){if(e.type==cc.Node.EventType.TOUCH_END){var t=e.currentTarget,n=t.parent.getSiblingIndex();for(var o in t.parent.parent.children)t.parent.parent.children[o].getComponent(i).setCheckedFlag(parseInt(o)==n)}},__decorate([s(cc.Label)],t.prototype,"itemName",void 0),__decorate([s(cc.Node)],t.prototype,"itemNode",void 0),__decorate([s(cc.Node)],t.prototype,"checkedNode",void 0),t=i=__decorate([r],t)}(n.default);i.default=l,cc._RF.pop()},{"../../Core/Widget":"Widget","./ItemIcon":"ItemIcon"}],GiftBagWin:[function(e,t,i){"use strict";cc._RF.push(t,"474a9uzjQ1F+7ItDgElD6fs","GiftBagWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("./ItemIcon"),a=e("../../Core/Language"),r=e("../../NetConnect/NetConnet"),s=e("../Role/RoleInfo"),l=e("../Tips/OpTipsController"),c=e("./BagpackWin"),d=e("../../Core/LoadManager"),p=e("../../GlobalContext"),h=e("../../Util/Utils"),u=e("./GiftBagItem"),f=cc._decorator,g=f.ccclass,y=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Type1=null,t.Type2=null,t.TypeContent1=null,t.TypeContent2=null,t.TitleLabe=null,t.MaxLabe=null,t.CurrNumLabe=null,t.Diamond=null,t.CurrNum=1,t.itemInfo=null,t.type=null,t.itemList=null,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this),i.instance=this},t.prototype.hide=function(){e.prototype.hide.call(this),this.CurrNum=1},t.prototype.OpenGift=function(e,t,i,n,r){var s=this;void 0===t&&(t=null),void 0===n&&(n=0),void 0===r&&(r=""),this.itemInfo=i,this.type=e,e?(h.default.setNodeChildDestoryByUrl(this.TypeContent1,p.GlobalContext.Root+"prefab/Bag/ItemIcon"),this.Type1.active=!0,this.Type2.active=!1,this.TitleLabe.string=a.default.getStr("\u4ed8\u8d39\u793c\u5305"),this.Diamond.string=r,d.default.instance.loadResByType("prefab/Bag/ItemIcon",cc.Prefab,function(e){for(var i=0;i<t.length;i++){var n=h.default.getNodeByUrl(e,"prefab/Bag/ItemIcon");n.getComponent(o.default).ItemData(t[i],!0,null,!0),s.TypeContent1.addChild(n)}s.Type1.getChildByName("ScrollView").getComponent(cc.ScrollView).scrollToTop()},this)):(this.itemList=t,this.Type1.active=!1,this.Type2.active=!0,this.TitleLabe.string=a.default.getStr("\u81ea\u9009\u793c\u5305"),this.MaxLabe.string=n+"",this.CurrNumLabe.string="1",h.default.setNodeChildDestoryByUrl(this.TypeContent2,p.GlobalContext.Root+"prefab/Bag/prefab"),d.default.instance.loadResByType("prefab/Bag/prefab",cc.Prefab,function(e){for(var i=0;i<t.length;i++){var n=h.default.getNodeByUrl(e,"prefab/Bag/prefab");n.active=!0,n.getComponent(u.default).setData(t[i]),s.TypeContent2.addChild(n)}s.Type2.getChildByName("ScrollView").getComponent(cc.ScrollView).scrollToTop()},this))},t.prototype.ChangeNum=function(e,t){switch(Number(t)){case 1:this.CurrNum=1;break;case 2:this.CurrNum>1&&(this.CurrNum-=10);break;case 3:this.CurrNum>1&&(this.CurrNum-=1);break;case 4:this.CurrNum<=Number(this.CurrNumLabe.string)&&(this.CurrNum+=1);break;case 5:this.CurrNum<=Number(this.MaxLabe.string)&&(this.CurrNum+=10);break;case 6:this.CurrNum=Number(this.MaxLabe.string)}this.CurrNumLabe.string=this.CurrNum+"",this.CurrNum>Number(this.MaxLabe.string)?(this.CurrNumLabe.string=this.MaxLabe.string,this.CurrNum=Number(this.MaxLabe.string)):this.CurrNum<1&&(this.CurrNumLabe.string="1",this.CurrNum=1)},t.prototype.OpenGiftBtnClick=function(){if(this.type){if(s.MyRoleInfo.diamond<Number(c.default.instance.ChooseInfo.dealPrice))return void l.default.instance.ShowMsg(a.default.getStr("diamond"));var e={cmd:"useitem",guid:this.itemInfo.guid,count:1};r.default.instance.sendProto(e)}else{var t=null;if(!this.CheackIsCheack())return void l.default.instance.ShowMsg(a.default.getStr("\u8bf7\u5148\u9009\u62e9\u4e00\u79cd\u9053\u5177"));for(var i=0;i<this.TypeContent2.childrenCount;i++)if(this.TypeContent2.children[i].getComponent(u.default).isChecked){t=i;break}e={cmd:"useitem",guid:this.itemInfo.guid,select:t,count:Number(this.CurrNumLabe.string)};r.default.instance.sendProto(e)}this.close()},t.prototype.CheackIsCheack=function(){for(var e=0;e<this.TypeContent2.childrenCount;e++)if(this.TypeContent2.children[e].getComponent(u.default).isChecked)return!0},t.instance=null,__decorate([y(cc.Node)],t.prototype,"Type1",void 0),__decorate([y(cc.Node)],t.prototype,"Type2",void 0),__decorate([y(cc.Node)],t.prototype,"TypeContent1",void 0),__decorate([y(cc.Node)],t.prototype,"TypeContent2",void 0),__decorate([y(cc.Label)],t.prototype,"TitleLabe",void 0),__decorate([y(cc.Label)],t.prototype,"MaxLabe",void 0),__decorate([y(cc.Label)],t.prototype,"CurrNumLabe",void 0),__decorate([y(cc.Label)],t.prototype,"Diamond",void 0),t=i=__decorate([g],t)}(n.default);i.default=m,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/Window":"Window","../../GlobalContext":"GlobalContext","../../NetConnect/NetConnet":"NetConnet","../../Util/Utils":"Utils","../Role/RoleInfo":"RoleInfo","../Tips/OpTipsController":"OpTipsController","./BagpackWin":"BagpackWin","./GiftBagItem":"GiftBagItem","./ItemIcon":"ItemIcon"}],GlobalContext:[function(e,t,i){"use strict";cc._RF.push(t,"68895Na8mJBrp7CTHOnE0FT","GlobalContext"),Object.defineProperty(i,"__esModule",{value:!0}),i.PlayerData={SoundPlaying:!0,userInfo:null,SceneBorld:0,actorid:0},i.GlobalContext={Root:"",MonsterType:0,GameForeground:!0,fightMode:0,Version:"",VersionBackstageData:{},currentServerData:{},backstageLoginData:{},ResRoot:""},cc._RF.pop()},{}],GlobalValue:[function(e,t,i){"use strict";var n;cc._RF.push(t,"407faeTovhOAJ+vJtMk7sud","GlobalValue"),Object.defineProperty(i,"__esModule",{value:!0}),function(e){e[e.NONE=1]="NONE",e[e.UP=0]="UP",e[e.RIGHT_UP=-1]="RIGHT_UP",e[e.RIGHT=-1]="RIGHT",e[e.RIGHT_DOWN=-1]="RIGHT_DOWN",e[e.DOWN=0]="DOWN",e[e.LEFT_DOWN=1]="LEFT_DOWN",e[e.LEFT=1]="LEFT",e[e.LEFT_UP=1]="LEFT_UP"}(i.DIR||(i.DIR={})),function(e){e[e.COMMON=1]="COMMON",e[e.TAPHROGENIC=2]="TAPHROGENIC"}(i.ROLE_ATTACK_EFFECT||(i.ROLE_ATTACK_EFFECT={})),function(e){e[e.SELF=0]="SELF",e[e.ENEMY=1]="ENEMY",e[e.FRIENDLY=2]="FRIENDLY",e[e.FRIENDLY_DEAD=3]="FRIENDLY_DEAD",e[e.FAMILY=4]="FAMILY",e[e.COPY=5]="COPY",e[e.DRIFTLESS=6]="DRIFTLESS",e[e.ALL=7]="ALL"}(i.ATTACK_TARGE||(i.ATTACK_TARGE={})),function(e){e[e.ATTACK=0]="ATTACK",e[e.RELIVE=1]="RELIVE",e[e.RESCURE=2]="RESCURE"}(i.SKILL_RESULT||(i.SKILL_RESULT={})),function(e){e[e.INITIATIVE=1]="INITIATIVE",e[e.PERIOD=2]="PERIOD",e[e.PASSIVITY=3]="PASSIVITY",e[e.COMBO=4]="COMBO",e[e.COMMON=5]="COMMON",e[e.ANGER=6]="ANGER"}(i.TRIGGER_WAY||(i.TRIGGER_WAY={})),function(e){e[e.NONE=0]="NONE",e[e.COMBO=1]="COMBO",e[e.SPECIAL_SKILL_STATUS1=2]="SPECIAL_SKILL_STATUS1",e[e.SPECIAL_SKILL_STATUS2=3]="SPECIAL_SKILL_STATUS2",e[e.SPECIAL_SKILL_STATUS3=4]="SPECIAL_SKILL_STATUS3",e[e.SPECIAL_SKILL_STATUS4=5]="SPECIAL_SKILL_STATUS4",e[e.SPECIAL_SKILL_STATUS5=6]="SPECIAL_SKILL_STATUS5",e[e.SPECIAL_SKILL_STATUS6=7]="SPECIAL_SKILL_STATUS6",e[e.SPECIAL_SKILL_STATUS7=8]="SPECIAL_SKILL_STATUS7",e[e.SPECIAL_SKILL_STATUS8=9]="SPECIAL_SKILL_STATUS8",e[e.SPECIAL_SKILL_STATUS9=10]="SPECIAL_SKILL_STATUS9",e[e.SPECIAL_SKILL_STATUS10=11]="SPECIAL_SKILL_STATUS10",e[e.SPECIAL_SKILL_STATUS11=12]="SPECIAL_SKILL_STATUS11",e[e.SPECIAL_SKILL_STATUS12=13]="SPECIAL_SKILL_STATUS12"}(i.SPECIAL_SKILL_STATUS||(i.SPECIAL_SKILL_STATUS={})),function(e){e[e.NONE=0]="NONE",e[e.REPEL=1]="REPEL",e[e.STRIKEFLY=2]="STRIKEFLY",e[e.DRAP=3]="DRAP",e[e.IMPACT=4]="IMPACT",e[e.STRIKEFLYBACK=5]="STRIKEFLYBACK"}(i.HIT_STATUS||(i.HIT_STATUS={})),function(e){e.NONE="none",e.STAND="stand",e.STAND2="stand2",e.WALK="walk",e.DEAD="head",e.FIGHT1="fight1",e.FIGHT2="fight2",e.FIGHT3="fight3",e.FIGHT4="fight4",e.OTHER1="other1",e.WIN="win"}(i.ACTION||(i.ACTION={})),i.ACTOR_STS_NAME=["none","stand","walk","head","fight1","fight2","fight3","fight4","other1"],i.ACTOR_STS_NAME_NO_LOOP=["fight1","fight2","fight3","fight4"],i.ACTOR_STS_NAME_LOOP=["stand","walk"],i.DEFAULTS_SKIN="skin",function(e){e.FUHUO="fuhuo",e.ZHAOHUAN1="zhaohuan1",e.ZHAOHUAN2="zhaohuan2",e.ZHAOHUAN3="zhaohuan3",e.JIAFANG="jiafang",e.ZENGYI="zengyi",e.JIANYI="jianyi",e.JIAGONGJILI="jiagongjili",e.JIANGONG="jiangong",e.JIANFANG="jianfang",e.MIANYIJIFEI="mianyijifei",e.MIANYIZHUANGTAI="mianyizhuangtai",e.CHAOFENG="chaofeng",e.DIANRAN="dianran",e.MABI="mabi",e.JINGHUA="jinghua",e.NEW_JIADUN="new_jiadun",e.NEW_LIUXUE="new_liuxue",e.XIXUE="xixue",e.XIXUEZHILIAO="xixuezhiliao",e.XUANYUN="xuanyun",e.ZHILIAO="zhiliao",e.ZHONGDU="zhongdu"}(n=i.BuffEffectName||(i.BuffEffectName={})),i.BUFF_TYPE_NO_LOOP=[n.FUHUO,n.ZHAOHUAN1,n.ZHAOHUAN2,n.ZHAOHUAN3,n.JIAGONGJILI,n.JIANGONG,n.JIAFANG,n.JIANFANG,n.ZHILIAO,n.MIANYIZHUANGTAI],function(e){e[e.ATTACK_TYPE_1=1]="ATTACK_TYPE_1",e[e.ATTACK_TYPE_2=2]="ATTACK_TYPE_2",e[e.ATTACK_TYPE_3=3]="ATTACK_TYPE_3",e[e.ATTACK_TYPE_4=4]="ATTACK_TYPE_4",e[e.ATTACK_TYPE_5=5]="ATTACK_TYPE_5",e[e.ATTACK_TYPE_6=6]="ATTACK_TYPE_6"}(i.ATTACK_TYPE||(i.ATTACK_TYPE={})),function(e){e[e.NONE=0]="NONE",e[e.RESCURE=1]="RESCURE",e[e.DEADMAN=2]="DEADMAN",e[e.REINFORCEMENTS=3]="REINFORCEMENTS",e[e.REEL=4]="REEL",e[e.CAPTIVE=6]="CAPTIVE",e[e.WANGHUN=7]="WANGHUN",e[e.JINGXIANG=8]="JINGXIANG"}(i.ADD_ACTOR_TYPE||(i.ADD_ACTOR_TYPE={})),function(e){e[e.TYPE1=1]="TYPE1",e[e.TYPE2=2]="TYPE2",e[e.TYPE3=3]="TYPE3"}(i.INDIVIDUALITY||(i.INDIVIDUALITY={})),function(e){e[e.TYPE1=1]="TYPE1",e[e.TYPE2=2]="TYPE2"}(i.INDIVIDUALITYSHOW||(i.INDIVIDUALITYSHOW={})),function(e){e[e.CONFIG=2e3]="CONFIG",e[e.ROLE_SELF=1800]="ROLE_SELF",e[e.DAOGUANG_SELF=1700]="DAOGUANG_SELF",e[e.MONSTER=1650]="MONSTER",e[e.MAP=1600]="MAP",e[e.UI=1200]="UI",e[e.PROP=1100]="PROP",e[e.ROLE=1e3]="ROLE",e[e.EF_SELF=800]="EF_SELF",e[e.DAOGUANG=700]="DAOGUANG",e[e.EF=200]="EF",e[e.ACCESSORY=100]="ACCESSORY"}(i.PRIORITY||(i.PRIORITY={})),function(e){e[e.MaxHp=0]="MaxHp",e[e.Attack=1]="Attack",e[e.Defence=2]="Defence",e[e.Hit=3]="Hit",e[e.Dodge=4]="Dodge",e[e.Critical=5]="Critical",e[e.DefCri=6]="DefCri",e[e.ThunderAttack=7]="ThunderAttack",e[e.ThunderDef=8]="ThunderDef",e[e.EarthAttack=9]="EarthAttack",e[e.EarthDef=10]="EarthDef",e[e.WaterAttack=11]="WaterAttack",e[e.WaterDef=12]="WaterDef",e[e.FireAttack=13]="FireAttack",e[e.FireDef=14]="FireDef",e[e.WindAttack=15]="WindAttack",e[e.WindDef=16]="WindDef",e[e.HpRate=200]="HpRate",e[e.AttackRate=201]="AttackRate",e[e.DefenceRate=202]="DefenceRate",e[e.HitRate=203]="HitRate",e[e.DodgeRate=204]="DodgeRate",e[e.CriticalRate=205]="CriticalRate",e[e.DefCriRate=206]="DefCriRate",e[e.ThunderAttackRate=207]="ThunderAttackRate",e[e.ThunderDefRate=208]="ThunderDefRate",e[e.EarthAttackRate=209]="EarthAttackRate",e[e.EarthDefRate=210]="EarthDefRate",e[e.WaterAttackRate=211]="WaterAttackRate",e[e.WaterDefRate=212]="WaterDefRate",e[e.FireAttackRate=213]="FireAttackRate",e[e.FireDefRate=214]="FireDefRate",e[e.WindAttackRate=215]="WindAttackRate",e[e.WindDefRate=216]="WindDefRate",e[e.FHpRate=300]="FHpRate",e[e.FAttackRate=301]="FAttackRate",e[e.FDefenceRate=302]="FDefenceRate",e[e.FHitRate=303]="FHitRate",e[e.FDodgeRate=304]="FDodgeRate",e[e.FCriticalRate=305]="FCriticalRate",e[e.FDefCriRate=306]="FDefCriRate",e[e.FThunderAttackRate=307]="FThunderAttackRate",e[e.FThunderDefRate=308]="FThunderDefRate",e[e.FEarthAttackRate=309]="FEarthAttackRate",e[e.FEarthDefRate=310]="FEarthDefRate",e[e.FWaterAttackRate=311]="FWaterAttackRate",e[e.FWaterDefRate=312]="FWaterDefRate",e[e.FFireAttackRate=313]="FFireAttackRate",e[e.FFireDefRate=314]="FFireDefRate",e[e.FWindAttackRate=315]="FWindAttackRate",e[e.FWindDefRate=316]="FWindDefRate",e[e.MHpRate=400]="MHpRate",e[e.MAttackRate=401]="MAttackRate",e[e.MDefenceRate=402]="MDefenceRate",e[e.MHitRate=403]="MHitRate",e[e.MDodgeRate=404]="MDodgeRate",e[e.MCriticalRate=405]="MCriticalRate",e[e.MDefCriRate=406]="MDefCriRate",e[e.MThunderAttackRate=407]="MThunderAttackRate",e[e.MThunderDefRate=408]="MThunderDefRate",e[e.MEarthAttackRate=409]="MEarthAttackRate",e[e.MEarthDefRate=410]="MEarthDefRate",e[e.MWaterAttackRate=411]="MWaterAttackRate",e[e.MWaterDefRate=412]="MWaterDefRate",e[e.MFireAttackRate=413]="MFireAttackRate",e[e.MFireDefRate=414]="MFireDefRate",e[e.MWindAttackRate=415]="MWindAttackRate",e[e.MWindDefRate=416]="MWindDefRate",e[e.LHpRate=500]="LHpRate",e[e.LAttackRate=501]="LAttackRate",e[e.LDefenceRate=502]="LDefenceRate",e[e.LHitRate=503]="LHitRate",e[e.LDodgeRate=504]="LDodgeRate",e[e.LCriticalRate=505]="LCriticalRate",e[e.LDefCriRate=506]="LDefCriRate",e[e.LThunderAttackRate=507]="LThunderAttackRate",e[e.LThunderDefRate=508]="LThunderDefRate",e[e.LEarthAttackRate=509]="LEarthAttackRate",e[e.LEarthDefRate=510]="LEarthDefRate",e[e.LWaterAttackRate=511]="LWaterAttackRate",e[e.LWaterDefRate=512]="LWaterDefRate",e[e.LFireAttackRate=513]="LFireAttackRate",e[e.LFireDefRate=514]="LFireDefRate",e[e.LWindAttackRate=515]="LWindAttackRate",e[e.LWindDefRate=516]="LWindDefRate",e[e.RetainStep=600]="RetainStep",e[e.FubenStep=601]="FubenStep",e[e.CardLevel=602]="CardLevel",e[e.SkillOne=603]="SkillOne",e[e.SkillTwo=604]="SkillTwo",e[e.SkillThree=605]="SkillThree",e[e.AllCardRate=700]="AllCardRate",e[e.ThunderRate=701]="ThunderRate",e[e.EarthRate=702]="EarthRate",e[e.WaterRate=703]="WaterRate",e[e.FireRate=704]="FireRate",e[e.WindRate=705]="WindRate",e[e.FAllCardRate=706]="FAllCardRate",e[e.MAllCardRate=707]="MAllCardRate",e[e.LAllCardRate=708]="LAllCardRate",e[e.ExtraHurt=709]="ExtraHurt",e[e.CardHurtRate=710]="CardHurtRate",e[e.CardPassiveHurtRate=711]="CardPassiveHurtRate",e[e.ThuHp=800]="ThuHp",e[e.ThuAttack=801]="ThuAttack",e[e.ThuDefence=802]="ThuDefence",e[e.ThuHit=803]="ThuHit",e[e.ThuDodge=804]="ThuDodge",e[e.ThuCritical=805]="ThuCritical",e[e.ThuDefCri=806]="ThuDefCri",e[e.EarHp=900]="EarHp",e[e.EarAttack=901]="EarAttack",e[e.EarDefence=902]="EarDefence",e[e.EarHit=903]="EarHit",e[e.EarDodge=904]="EarDodge",e[e.EarCritical=905]="EarCritical",e[e.EarDefCri=906]="EarDefCri",e[e.WatHp=1e3]="WatHp",e[e.WatAttack=1001]="WatAttack",e[e.WatDefence=1002]="WatDefence",e[e.WatHit=1003]="WatHit",e[e.WatDodge=1004]="WatDodge",e[e.WatCritical=1005]="WatCritical",e[e.WatDefCri=1006]="WatDefCri",e[e.FirHp=1100]="FirHp",e[e.FirAttack=1101]="FirAttack",e[e.FirDefence=1102]="FirDefence",e[e.FirHit=1103]="FirHit",e[e.FirDodge=1104]="FirDodge",e[e.FirCritical=1105]="FirCritical",e[e.FirDefCri=1106]="FirDefCri",e[e.WinHp=1200]="WinHp",e[e.WinAttack=1201]="WinAttack",e[e.WinDefence=1202]="WinDefence",e[e.WinHit=1203]="WinHit",e[e.WinDodge=1204]="WinDodge",e[e.WinCritical=1205]="WinCritical",e[e.WinDefCri=1206]="WinDefCri",e[e.ThuHpRate=1300]="ThuHpRate",e[e.ThuAttackRate=1301]="ThuAttackRate",e[e.ThuDefenceRate=1302]="ThuDefenceRate",e[e.ThuHitRate=1303]="ThuHitRate",e[e.ThuDodgeRate=1304]="ThuDodgeRate",e[e.ThuCriticalRate=1305]="ThuCriticalRate",e[e.ThuDefCriRate=1306]="ThuDefCriRate",e[e.EarHpRate=1400]="EarHpRate",e[e.EarAttackRate=1401]="EarAttackRate",e[e.EarDefenceRate=1402]="EarDefenceRate",e[e.EarHitRate=1403]="EarHitRate",e[e.EarDodgeRate=1404]="EarDodgeRate",e[e.EarCriticalRate=1405]="EarCriticalRate",e[e.EarDefCriRate=1406]="EarDefCriRate",e[e.WatHpRate=1500]="WatHpRate",e[e.WatAttackRate=1501]="WatAttackRate",e[e.WatDefenceRate=1502]="WatDefenceRate",e[e.WatHitRate=1503]="WatHitRate",e[e.WatDodgeRate=1504]="WatDodgeRate",e[e.WatCriticalRate=1505]="WatCriticalRate",e[e.WatDefCriRate=1506]="WatDefCriRate",e[e.FirHpRate=1600]="FirHpRate",e[e.FirAttackRate=1601]="FirAttackRate",e[e.FirDefenceRate=1602]="FirDefenceRate",e[e.FirHitRate=1603]="FirHitRate",e[e.FirDodgeRate=1604]="FirDodgeRate",e[e.FirCriticalRate=1605]="FirCriticalRate",e[e.FirDefCriRate=1606]="FirDefCriRate",e[e.WinHpRate=1700]="WinHpRate",e[e.WinAttackRate=1701]="WinAttackRate",e[e.WinDefenceRate=1702]="WinDefenceRate",e[e.WinHitRate=1703]="WinHitRate",e[e.WinDodgeRate=1704]="WinDodgeRate",e[e.WinCriticalRate=1705]="WinCriticalRate",e[e.WinDefCriRate=1706]="WinDefCriRate",e[e.Shield=11007]="Shield",e[e.MaxHp_P=11100]="MaxHp_P",e[e.Attack_P=11101]="Attack_P",e[e.Defence_P=11102]="Defence_P",e[e.Hit_P=11103]="Hit_P",e[e.Dodge_P=11104]="Dodge_P",e[e.Critical_P=11105]="Critical_P",e[e.DefCri_P=11106]="DefCri_P",e[e.Hit_Imbue=11150]="Hit_Imbue",e[e.Dodge_Imbue=11151]="Dodge_Imbue",e[e.Critical_Imbue=11152]="Critical_Imbue",e[e.DefCri_Imbue=11153]="DefCri_Imbue",e[e.MS_MaxHp_P=11200]="MS_MaxHp_P",e[e.MS_Attack_P=11201]="MS_Attack_P",e[e.MS_Defence_P=11202]="MS_Defence_P",e[e.MS_Hit_P=11203]="MS_Hit_P",e[e.MS_Dodge_P=11204]="MS_Dodge_P",e[e.MS_Critical_P=11205]="MS_Critical_P",e[e.MS_DefCri_P=11206]="MS_DefCri_P",e[e.Crit_P=13005]="Crit_P",e[e.MS_Harm_P=13007]="MS_Harm_P",e[e.Harm_P=12007]="Harm_P",e[e.Critical_Harm_P=12008]="Critical_Harm_P",e[e.Critical_Harm_Down_P=12009]="Critical_Harm_Down_P",e[e.Harm_Down_P=12010]="Harm_Down_P",e[e.AllAddLvPVE=12100]="AllAddLvPVE",e[e.HightAddForm=12101]="HightAddForm",e[e.CARD_ATTR_ADD=12102]="CARD_ATTR_ADD",e[e.CARD_ATTR_MAXADD=12103]="CARD_ATTR_MAXADD",e[e.FIRECARD_ATTR_ADD=12104]="FIRECARD_ATTR_ADD",e[e.THUNDER_CARD_ATTR_ADD=12105]="THUNDER_CARD_ATTR_ADD",e[e.ZF_Crit_P=14005]="ZF_Crit_P",e[e.ZF_Harm_P=14007]="ZF_Harm_P",e[e.ZF_Harm_Down_P=14010]="ZF_Harm_Down_P"}(i.AttrType||(i.AttrType={})),function(e){e[e.NONE=0]="NONE",e[e.Die=1]="Die",e[e.FinalHit=2]="FinalHit",e[e.HpChange=3]="HpChange",e[e.Strike=4]="Strike",e[e.Injuried=5]="Injuried",e[e.Critical=6]="Critical",e[e.FightStart=7]="FightStart",e[e.update=8]="update",e[e.RoleTalent=9]="RoleTalent",e[e.Restrain=10]="Restrain"}(i.PassivityType||(i.PassivityType={})),function(e){e[e.ALL=1]="ALL",e[e.FRONTROW=2]="FRONTROW",e[e.MIDDLEROW=3]="MIDDLEROW",e[e.BACKROW=4]="BACKROW",e[e.WIND=5]="WIND",e[e.FIRE=6]="FIRE",e[e.THUNDER=7]="THUNDER",e[e.WATER=8]="WATER",e[e.SOIL=9]="SOIL"}(i.CardType||(i.CardType={})),function(e){e[e.CLEAN=0]="CLEAN",e[e.FIGHT=1]="FIGHT",e[e.STOP=2]="STOP",e[e.CLOSE=3]="CLOSE",e[e.EquipATTRSELF=4]="EquipATTRSELF",e[e.CARDATTRSELF=5]="CARDATTRSELF",e[e.CREATESELF=6]="CREATESELF",e[e.EquipATTRFOE=7]="EquipATTRFOE",e[e.CARDATTRSFOE=8]="CARDATTRSFOE",e[e.CREATEFOE=9]="CREATEFOE",e[e.SELFNEWADD=10]="SELFNEWADD",e[e.FOENEWADD=11]="FOENEWADD",e[e.ADDROLE=12]="ADDROLE",e[e.SELFBACKOFF=13]="SELFBACKOFF",e[e.FOEBACKOFF=14]="FOEBACKOFF",e[e.CLEANATTR=15]="CLEANATTR"}(i.SimulatorType||(i.SimulatorType={})),function(e){e[e.CardGlade=5]="CardGlade",e[e.CardLv=100]="CardLv",e[e.EquipQuality=5]="EquipQuality",e[e.EquipLv=100]="EquipLv",e[e.EquipGlade=20]="EquipGlade",e[e.RefineLv=50]="RefineLv",e[e.HpGemLv=15]="HpGemLv",e[e.AttackGemLv=15]="AttackGemLv",e[e.DefenseGemLv=15]="DefenseGemLv"}(i.SimulatorAttrMax||(i.SimulatorAttrMax={})),function(e){e[e.Undefined=0]="Undefined",e[e.Attack=1]="Attack",e[e.Attack_P=2]="Attack_P",e[e.Defence=3]="Defence",e[e.Defence_P=4]="Defence_P",e[e.MaxHp=5]="MaxHp",e[e.MaxHp_P=6]="MaxHp_P",e[e.DamageInc=7]="DamageInc",e[e.BeDamageDec=8]="BeDamageDec",e[e.Critical=9]="Critical",e[e.Hit=10]="Hit",e[e.Dodge=11]="Dodge",e[e.ResistFly=12]="ResistFly",e[e.ResistDebuff=13]="ResistDebuff",e[e.Dizzy=14]="Dizzy",e[e.Recover=15]="Recover",e[e.Poison=16]="Poison",e[e.Fire=17]="Fire",e[e.Taunt=18]="Taunt",e[e.Burn=19]="Burn",e[e.Recover2=20]="Recover2",e[e.SuperArmor=21]="SuperArmor",e[e.DelDamage=22]="DelDamage",e[e.NotCopy=23]="NotCopy",e[e.Bleed=24]="Bleed",e[e.MoveSpeed=25]="MoveSpeed",e[e.DelayShield=26]="DelayShield",e[e.Puzzle=27]="Puzzle",e[e.Shield=28]="Shield",e[e.DefCri=29]="DefCri",e[e.Silence=30]="Silence",e[e.Sputtering=31]="Sputtering",e[e.Vow=32]="Vow",e[e.BombMembrane=33]="BombMembrane",e[e.Max=34]="Max"}(i.BuffType||(i.BuffType={})),function(e){e[e.Money=0]="Money",e[e.Diamond=1]="Diamond",e[e.Honor=2]="Honor",e[e.Integral=3]="Integral",e[e.Energy=200]="Energy",e[e.RobEnergy=200]="RobEnergy",e[e.Vitality=4]="Vitality",e[e.Equip=5]="Equip",e[e.SoulCard=6]="SoulCard"}(i.WealthType||(i.WealthType={})),function(e){e[e.Arena=9e5]="Arena",e[e.TianTi=900001]="TianTi",e[e.TianTi2=900002]="TianTi2",e[e.Home=900003]="Home",e[e.WorldBoss=900004]="WorldBoss",e[e.EliteBoss=900005]="EliteBoss",e[e.ZangBaoTu=900006]="ZangBaoTu",e[e.Robbery=900007]="Robbery",e[e.LoardCrusad=900008]="LoardCrusad",e[e.GuideFight=910001]="GuideFight"}(i.GQIdType||(i.GQIdType={})),function(e){e.Money="\u91d1\u5e01",e.Diamond="\u94bb\u77f3",e.Honor="\u8363\u8a89",e.Integral="\u79ef\u5206",e.Add_Diamond="\u5145\u503c",e.Equip="\u88c5\u5907",e.SoulCard="\u9b42\u5361",e.Other="\u5176\u4ed6"}(i.SHOP_TAG||(i.SHOP_TAG={})),function(e){e[e.thunder=1]="thunder",e[e.soil=2]="soil",e[e.water=3]="water",e[e.fire=4]="fire",e[e.wind=5]="wind"}(i.ElementType||(i.ElementType={})),function(e){e[e.NONE=0]="NONE",e[e.Front=1]="Front",e[e.Centre=2]="Centre",e[e.Back=3]="Back"}(i.CardType||(i.CardType={})),function(e){e[e.Main=1]="Main",e[e.Scene=2]="Scene",e[e.Fight=3]="Fight"}(i.GameScene||(i.GameScene={})),function(e){e[e.Hpchangeadd=1]="Hpchangeadd",e[e.MaxHpchange=2]="MaxHpchange",e[e.ExtraCombohurt=3]="ExtraCombohurt",e[e.ExtraBuffuerhurt=4]="ExtraBuffuerhurt",e[e.CradTypebuffe=5]="CradTypebuffe"}(i.OtherAttr||(i.OtherAttr={})),i.MaxEquipNum=4,function(e){e[e.Add=1]="Add",e[e.Minus=2]="Minus"}(i.SymbolShotType||(i.SymbolShotType={})),function(e){e[e.TYPE1=1]="TYPE1",e[e.TYPE2=2]="TYPE2",e[e.TYPE3=3]="TYPE3",e[e.TYPE4=4]="TYPE4",e[e.TYPE5=5]="TYPE5"}(i.RefiningQuality||(i.RefiningQuality={})),function(e){e[e.TYPE1=0]="TYPE1",e[e.TYPE2=1]="TYPE2",e[e.TYPE3=2]="TYPE3",e[e.TYPE4=3]="TYPE4"}(i.WearType||(i.WearType={})),function(e){e[e.TYPE=0]="TYPE",e[e.TYPE1=1]="TYPE1"}(i.OrnamentItemType||(i.OrnamentItemType={})),function(e){e[e.TYPE1=1]="TYPE1",e[e.TYPE2=2]="TYPE2",e[e.TYPE3=3]="TYPE3"}(i.RangeType||(i.RangeType={})),function(e){e[e.Refining=0]="Refining",e[e.Gemstone=1]="Gemstone"}(i.SyntheticType||(i.SyntheticType={})),function(e){e[e.TYPE=0]="TYPE",e[e.TYPE1=1]="TYPE1",e[e.TYPE2=2]="TYPE2",e[e.TYPE3=3]="TYPE3"}(i.EquipWinBtnTag||(i.EquipWinBtnTag={})),function(e){e[e.TYPE=0]="TYPE"}(i.AttrNodeType||(i.AttrNodeType={})),function(e){e[e.JITAN=51]="JITAN",e[e.TIECHUI=52]="TIECHUI",e[e.SHENGJI=53]="SHENGJI",e[e.HUOPAO=54]="HUOPAO",e[e.QIYUAN=55]="QIYUAN",e[e.LEITING=56]="LEITING",e[e.PINGDENG=57]="PINGDENG",e[e.CUIMIAN=58]="CUIMIAN",e[e.JIANGJI=59]="JIANGJI",e[e.HEIDONG=60]="HEIDONG",e[e.CHUANSONG=61]="CHUANSONG",e[e.TANGHUANG=62]="TANGHUANG",e[e.WODI=63]="WODI",e[e.MEIDUSHA=64]="MEIDUSHA",e[e.YAOJI=65]="YAOJI",e[e.WUSHU=66]="WUSHU"}(i.SandTableTrapType||(i.SandTableTrapType={})),function(e){e[e.EquipFBReset=1]="EquipFBReset",e[e.EBCheallenge=2]="EBCheallenge",e[e.HLCheallenge=3]="HLCheallenge",e[e.RobCheallenge=4]="RobCheallenge",e[e.Replacement=5]="Replacement",e[e.ItemBuy=6]="ItemBuy",e[e.VIPExpression=7]="VIPExpression",e[e.TerritoryWarNum=8]="TerritoryWarNum",e[e.Expedition=11]="Expedition",e[e.TotemsCopyReset=12]="TotemsCopyReset",e[e.ExpCopyBuyNum=13]="ExpCopyBuyNum",e[e.DailyCopyMoneyNum=14]="DailyCopyMoneyNum",e[e.DailyCopyArtifactNum=15]="DailyCopyArtifactNum",e[e.DailyCopyGemNum=16]="DailyCopyGemNum",e[e.DailyCopyEquipNum=17]="DailyCopyEquipNum",e[e.LoardCrusadNum=18]="LoardCrusadNum"}(i.VipPrivilegeType||(i.VipPrivilegeType={})),function(e){e[e.card=0]="card",e[e.scrolls=1]="scrolls",e[e.equip=2]="equip",e[e.material=3]="material",e[e.other=4]="other"}(i.BagpackTabType||(i.BagpackTabType={})),function(e){e[e.SHOP=1]="SHOP",e[e.BAIBEIFANLI=2]="BAIBEIFANLI",e[e.DAZHE=3]="DAZHE",e[e.PRIVILEGE=4]="PRIVILEGE"}(i.RechangeType||(i.RechangeType={})),function(e){e[e.openServer=1]="openServer",e[e.LoopActivity=2]="LoopActivity",e[e.mergeServer=3]="mergeServer",e[e.otherServer=4]="otherServer"}(i.ActivityWinType||(i.ActivityWinType={})),function(e){e[e.info=0]="info",e[e.upgrade=1]="upgrade",e[e.upStage=2]="upStage"}(i.OrnamentTagType||(i.OrnamentTagType={})),function(e){e[e.CardChip=0]="CardChip",e[e.Equip=1]="Equip",e[e.Ornament=2]="Ornament"}(i.DecomposeTag||(i.DecomposeTag={})),i.CardLvType=[null,"C","B","A","S","SS","SSS"],i.MaxArtifactAttrLevel=10,i.MaxArtifactNum=5,i.FightSceneWidth=1280,i.MaxEquipLevel=100,i.MaxQuality=5,i.MaxVipLev=15,i.MaxMailNum=100,i.OrnamentLev=5,i.RoleMaxLevel=100,i.validTime=12924e5,i.VIPBaseParam=20,i.VIPMinExp=20,i.VIPMaxExp=50,function(e){e[e.LEVEL=0]="LEVEL",e[e.FIGHT=1]="FIGHT",e[e.TIAN_TI=2]="TIAN_TI",e[e.ARENA=3]="ARENA"}(i.RankType||(i.RankType={})),function(e){e[e.NULL=0]="NULL",e[e.MOSAIC=1]="MOSAIC",e[e.REPLACE=2]="REPLACE",e[e.UPGRADE=3]="UPGRADE"}(i.GemActionType||(i.GemActionType={})),function(e){e[e.BASE_ATTR=0]="BASE_ATTR",e[e.UP_LEVEL_ATTR=1]="UP_LEVEL_ATTR",e[e.UP_STAGE_ATTR=2]="UP_STAGE_ATTR",e[e.REFINE_ATTR=3]="REFINE_ATTR",e[e.GEMSTONE_ATTR=4]="GEMSTONE_ATTR",e[e.EQUIP_EFFECT_ATTR=5]="EQUIP_EFFECT_ATTR"}(i.EqupiTipsAttrType||(i.EqupiTipsAttrType={})),i.MonsterMaxLevel=200,i.MapTiledSize=64,i.HOST_ADDRESS="",i.RES_DIR="",i.ANIM_RES_DIR="anim/",i.SPINE_RES_DIR="spine/",i.CACHE_DISPOS_TIME=36e5,i.VERSION="01",i.RELEASE_TAG=3,function(e){e.welfareOnlineReward="welfareOnlineReward",e.DailySignIn="DailySignIn",e.DailyMeal="DailyMeal",e.PrivilegeCard="PrivilegeCard",e.InvestmentPlan="InvestmentPlan",e.VipBenefit="VipBenefit",e.VipGift="vipGiftbag"}(i.WelfareType||(i.WelfareType={})),i.spinenamelist=["01jitai","02chuizi_ani1","09shanshen","13huopao_ani1","03qiyuan","14shandian","04tianping","10cuimian","05xiajiang","07heidong","11chuansongzhen_ani1","16tanghuang_ani1","12wodi_ani1","08meidusha","15yaoji_ani1","06wusu"],cc._RF.pop()},{}],GrayEffect:[function(e,t,i){"use strict";cc._RF.push(t,"a52a7ycFa5HTIhKdOz+CCbQ","GrayEffect"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./Utils"),o=cc._decorator,a=o.ccclass,r=o.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.IsGray=!1,t.isAllChildrenUse=!0,t._grayCanClick=!1,t}return __extends(t,e),t.prototype.start=function(){1==this.IsGray&&this.setGray(!0,this._grayCanClick)},t.prototype.setGray=function(e,t){void 0===t&&(t=!1),this.IsGray=e,this._grayCanClick=t,1==e?this.grayShader():this.resetShader();var i=this.node.getComponentsInChildren(cc.Button);if(i&&i.length>0)for(var n=0;n<i.length;n++)i[n].interactable=!e||t},t.prototype.grayShader=function(){this.resetSpriteState(this.node,1)},t.prototype.resetShader=function(){this.resetSpriteState(this.node,0)},t.prototype.resetSpriteState=function(e,t){if(e.getComponent(cc.Sprite))if(2==n.default.isHightVersion){var i=t?"2d-gray-sprite":"2d-sprite";e.getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial(i))}else e.getComponent(cc.Sprite).setState(t);var o=e.children;if(o)for(var a=0;a<o.length;a++)this.resetSpriteState(o[a],t)},__decorate([r(cc.Boolean)],t.prototype,"IsGray",void 0),t=__decorate([a],t)}(cc.Component);i.default=s;var l=function(){function e(){}return e.default_vert="\n    attribute vec4 a_position;\n    attribute vec2 a_texCoord;\n    attribute vec4 a_color;\n    varying vec2 v_texCoord;\n    varying vec4 v_fragmentColor;\n    void main()\n    {\n        gl_Position = CC_PMatrix * a_position;\n        v_fragmentColor = a_color;\n        v_texCoord = a_texCoord;\n    }\n    ",e.gray_frag="\n    #ifdef GL_ES\n    precision mediump float;\n    #endif\n    varying vec4 v_fragmentColor;\n    varying vec2 v_texCoord;\n    void main()\n    {\n        vec4 c = v_fragmentColor * texture2D(CC_Texture0, v_texCoord);\n        gl_FragColor.xyz = vec3(0.2126*c.r + 0.7152*c.g + 0.0722*c.b);\n        gl_FragColor.w = c.w;\n    }\n    ",e}();i.GrayFrag=l,cc._RF.pop()},{"./Utils":"Utils"}],GroupPurchaseContrl:[function(e,t,i){"use strict";cc._RF.push(t,"62f3epHModGiKeLR4kPbSgq","GroupPurchaseContrl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Controller"),o=e("../../../Core/GameEventDispatcher"),a=e("../../../Core/WindowType"),r=e("../ActivityCtrl"),s=e("../../Functionicon/FunctionIconController"),l=e("../../../Core/Event"),c=e("../../../NetConnect/NetConnet"),d=e("../../../Core/ConfigsManager"),p=cc._decorator,h=p.ccclass,u=(p.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.peopleBuyNumber=0,t.isBuy=!1,t.infoArry=[],t.firstCharge=null,t.chargeNumber=0,t.isFirstCharge=-1,t.day=1,t.fristDay=-1,t.groupDay=-1,t.rechargeNumber=0,t.OneSeckill=[],t.SeckillDay=-1,t.myData=null,t.config=null,t.statue=null,t.groupWin=0,t.GroupData=null,t.config1=null,t.groupGrade=null,t}var i;return __extends(t,e),i=t,t.prototype.listNotification=function(){i.instance=this,this.config1=d.ConfigsManager.instance.getConfigs("firstrechargegroupbuyConf"),this.addProto("frgroupbuy",this.GroupPurchaseInfo,this),this.addProto("dailyrechargecount",this.PeopleButNumber,this),this.addProto("firstrecharge",this.FirstreChargeInfo,this),this.addProto("seckill",this.Seckill,this),this.addProto("seckillgiftbagnum",this.SeckillNum,this);c.default.instance.sendProto({cmd:"seckillopenUI",actid:16}),o.GameEventDispatcher.instance.on(l.EventDefiner.Activity_YunyingUP,this.FunHidOrShow,this)},t.prototype.GroupPurchaseInfo=function(e){var t=this;this.infoArry=e.data,this.isBuy=e.data.firstflag,this.groupDay=e.day,this.GropuPurchaseConf(),this.scheduleOnce(function(){r.default.instance.data.setRedFlag(t.groupWin,t.GroupPurchaseIsRed())},0),o.GameEventDispatcher.instance.emit("GROUPPURCHASE",this)},t.prototype.PeopleButNumber=function(e){this.peopleBuyNumber=e.dailyrechargecount,o.GameEventDispatcher.instance.emit("GROUPPURCHASE",this)},t.prototype.FirstreChargeInfo=function(e){e.data.flag[0]?this.firstCharge=e.data.flag[0].toString(2):this.firstCharge=e.data.flag,this.chargeNumber=e.data.recharge,this.isFirstCharge=e.data.firstsign,this.fristDay=e.day,this.statue=r.default.instance.data.getActivityType();var t=this.statue==r.ActivityType.OpenServe?a.WindowType.FristCharge:a.WindowType.Loop_FristCharge;r.default.instance.data.setRedFlag(t,this.FristRechargeIsRed());var i=2==this.isFirstCharge?"\u6bcf\u65e5\u9996\u5145":"\u9996  \u5145";r.default.instance.data.setTabName(t,i),o.GameEventDispatcher.instance.emit("FIRSTRECHARGEINFO",this),o.GameEventDispatcher.instance.emit("SETLEFTDATA",this)},t.prototype.isCharge=function(){},t.prototype.Seckill=function(e){this.SeckillDay=e.day,this.OneSeckill=e.seckillsign,this.FunHidOrShow(),this.IsGet()?s.default.instance.FuncIconRedDeal(a.WindowType.OneSeckill,!0):s.default.instance.FuncIconRedDeal(a.WindowType.OneSeckill,!1),o.GameEventDispatcher.instance.emit("SECKILL",this)},t.prototype.SeckillNum=function(e){o.GameEventDispatcher.instance.emit("ChangeNum",{data:e})},t.prototype.FunHidOrShow=function(){var e=r.default.instance.data.getYunyingData(a.WindowType.OneSeckill);s.default.instance.FuncIconHideDeal(a.WindowType.OneSeckill,e),e?(s.default.instance.FuncIconHideDeal(a.WindowType.OneSeckill,!1),this.IsGet()||3!=this.OneSeckill.length||s.default.instance.FuncIconHideDeal(a.WindowType.OneSeckill,!0)):s.default.instance.FuncIconHideDeal(a.WindowType.OneSeckill,!0)},t.prototype.IsGet=function(){for(var e in this.OneSeckill)if(this.OneSeckill[e]&&!this.OneSeckill[e].flag)return!0},t.prototype.SendFirstCharge=function(e){var t={cmd:"firstrechargeopenUI",actid:e};c.default.instance.sendProto(t)},t.prototype.SendGroupBuy=function(e){var t={cmd:"frgroupbuyopenUI",actid:e};c.default.instance.sendProto(t)},t.prototype.SendRecharge=function(){c.default.instance.sendProto({cmd:"sevendayrechargeinfo",actid:4})},t.prototype.FristRechargeIsRed=function(){this.myData=r.default.instance.data.getYunyingData(this.statue==r.ActivityType.OpenServe?a.WindowType.FristCharge:a.WindowType.Loop_FristCharge),this.config=d.ConfigsManager.instance.getConfigs("firstrechargeconf");var e=this.config.day[this.myData.idx][this.day].grade;if(1==this.isFirstCharge)return!0;if(2==this.isFirstCharge){for(var t=0;t<3;t++)if(this.chargeNumber>=this.config.grade[e][t].money&&1!=this.firstCharge[Object.keys(this.firstCharge).length-Number(t)-1])return!0;return!1}},t.prototype.GropuPurchaseConf=function(){this.groupWin=this.statue==r.ActivityType.OpenServe?a.WindowType.GroupPurchase:a.WindowType.Loop_GroupPurchase,this.GroupData=r.default.instance.data.getYunyingData(this.groupWin);var e=this.config1.day[this.GroupData.idx][this.groupDay].grade;this.groupGrade=this.config1.grade[e]},t.prototype.GroupPurchaseIsRed=function(){for(var e in this.groupGrade){if(!(this.peopleBuyNumber>=this.groupGrade[e].groupBuyLv))return!1;if(!this.infoArry.flag[e]||!this.infoArry.flag[e].free||!this.infoArry.flag[e].recharge&&this.isBuy)return!0}return!1},t.instance=null,t=i=__decorate([h],t)}(n.default));i.default=u,cc._RF.pop()},{"../../../Core/ConfigsManager":"ConfigsManager","../../../Core/Controller":"Controller","../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/WindowType":"WindowType","../../../NetConnect/NetConnet":"NetConnet","../../Functionicon/FunctionIconController":"FunctionIconController","../ActivityCtrl":"ActivityCtrl"}],GroupPurchase:[function(e,t,i){"use strict";cc._RF.push(t,"c7d65717bZNxoIQ21JdFn+L","GroupPurchase"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Core/GameEventDispatcher"),a=e("../../../Core/Language"),r=e("../../../NetConnect/NetConnet"),s=e("./GroupPurchaseContrl"),l=e("../../Commons/RewardUtils"),c=e("../../Item/ItemIcon"),d=e("../../InvestmentPlan/InvestmentItem"),p=e("../../../Util/GrayEffect"),h=e("../../OpenWin/OpenWinController"),u=e("../../../Core/WindowType"),f=e("../../Shop/ShopController"),g=e("../../Shop/ShopConst"),y=e("../../Shop/Shop"),m=e("../../../Util/Utils"),C=e("../ActivityCtrl"),v=e("../../Tips/OpTipsController"),_=e("../../../Core/LoadManager"),b=e("../../../Core/Event"),T=e("../../Commons/Image"),S=cc._decorator,I=S.ccclass,w=S.property,D=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.top=null,t.content=null,t.peopleBuy=null,t.itemPrefab=null,t.commAtlas=null,t.item=null,t.buyBtn=null,t.isBuy=null,t.toggle1=null,t.toggle2=null,t.rightSprite=null,t.config=null,t.config1=null,t.Investmentarry=[],t.bg_banner1="",t.bg_banner2="",t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this);var t=s.default.instance.statue;t==C.ActivityType.OpenServe?(this.bg_banner1="bg_banner1.png",this.bg_banner2="bg_banner2.png",this.rightSprite.getComponent(T.default).resourceUrl="resources/Activity/OpenService/GroupPurchase/bg_sctg1.png",this.act=9):t==C.ActivityType.Loop&&(this.bg_banner1="bg_banner4.png",this.bg_banner2="bg_banner3.png",this.rightSprite.getComponent(T.default).resourceUrl="resources/Activity/OpenService/GroupPurchase/bg_sctg3.png",this.act=13),s.default.instance.SendGroupBuy(this.act),o.GameEventDispatcher.instance.on("GROUPPURCHASE",this.ChangeStatue,this),o.GameEventDispatcher.instance.emit(b.EventDefiner.Activity_countdown,this)},t.prototype.hide=function(){e.prototype.hide.call(this),o.GameEventDispatcher.instance.off("GROUPPURCHASE",this.ChangeStatue,this),o.GameEventDispatcher.instance.emit(b.EventDefiner.Activity_resetTimeout,this),this.act=null},t.prototype.TabChange=function(){var e=this;this.config=s.default.instance.groupGrade,m.default.setNodeChildDestoryByUrl(this.content,"prefab/GroupPurchase/GroupPurchasePrefab"),this.Investmentarry=[];for(var t=[],i=0;i<this.peopleBuy.childrenCount;i++)s.default.instance.peopleBuyNumber.toString().length<this.peopleBuy.childrenCount?s.default.instance.peopleBuyNumber.toString().substr(i,1)&&t.push(s.default.instance.peopleBuyNumber.toString().substr(i,1)):t.push(s.default.instance.peopleBuyNumber.toString().substr(i,1));for(i=0;i<4;i++)4==t.length?this.peopleBuy.children[i].getComponent(cc.Label).string=t[i]+"":3==t.length?(this.peopleBuy.children[0].getComponent(cc.Label).string="0",this.peopleBuy.children[1].getComponent(cc.Label).string=t[0]+"",this.peopleBuy.children[2].getComponent(cc.Label).string=t[1]+"",this.peopleBuy.children[3].getComponent(cc.Label).string=t[2]+""):2==t.length?(this.peopleBuy.children[0].getComponent(cc.Label).string="0",this.peopleBuy.children[1].getComponent(cc.Label).string="0",this.peopleBuy.children[2].getComponent(cc.Label).string=t[0]+"",this.peopleBuy.children[3].getComponent(cc.Label).string=t[1]+""):1==t.length&&(this.peopleBuy.children[0].getComponent(cc.Label).string="0",this.peopleBuy.children[1].getComponent(cc.Label).string="0",this.peopleBuy.children[2].getComponent(cc.Label).string="0",this.peopleBuy.children[3].getComponent(cc.Label).string=t[0]+"");var n=s.default.instance.infoArry,o="resources/Activity/OpenService/GroupPurchase/",a=this.toggle1.isChecked?o+this.bg_banner1:o+this.bg_banner2;this.top.getComponent(T.default).updateBg(a),s.default.instance.isBuy?(this.buyBtn.active=!1,this.isBuy.active=!0):(this.buyBtn.active=!0,this.isBuy.active=!1),_.default.instance.loadResByType("prefab/GroupPurchase/GroupPurchasePrefab",cc.Prefab,function(t){e.itemPrefab=t;var i=function(t){var i=m.default.getNodeByUrl(e.itemPrefab,"prefab/GroupPurchase/GroupPurchasePrefab"),o=e.toggle1.isChecked?e.config[t].freereward:e.config[t].rechargereward,a=l.default.instance.getItemList(o);if(_.default.instance.loadResByType("prefab/Bag/ItemIcon",cc.Prefab,function(t){e.item=t;for(var n=0;n<a.length;n++){var o=m.default.getNodeByPool(u.PoolType.ItemIcon,e.item);i.getChildByName("Layout").addChild(o),o.setScale(.8,.8),o.getComponent(c.default).ItemData(a[n],!0,null,!0)}},e),i.getChildByName("titleLabe").getComponent(cc.Label).string=e.config[t].desc,i.getComponent(d.default).index=Number(t),i.getComponent(d.default).buyNumber=e.config[t].groupBuyLv,n.flag&&n.flag[t]){var r=e.toggle1.isChecked?n.flag[t].free:n.flag[t].recharge;i.getComponent(d.default).statue=r,r?(i.children[6].active=!0,i.children[4].active=!1):(i.children[6].active=!1,i.children[4].active=!0)}var h=i.getComponent(d.default).index;s.default.instance.peopleBuyNumber<e.config[h].groupBuyLv?i.children[4].addComponent(p.default).setGray(!0):s.default.instance.peopleBuyNumber>=e.config[h].groupBuyLv&&i.children[4].on(cc.Node.EventType.TOUCH_END,e.GetReward,e),e.Investmentarry.push(i)};for(var o in e.config)i(o);e.sort()},this)},t.prototype.ChangeStatue=function(e,t){this.TabChange(),this.toggle1.node.getChildByName("Red").active=this.GroupPurchaseAllRed(),this.toggle2.node.getChildByName("Red").active=this.GroupurchaseRechargeRed()},t.prototype.sort=function(){for(var e=[],t=s.default.instance.peopleBuyNumber,i=s.default.instance.infoArry,n=0;n<this.Investmentarry.length;n++){if(i.flag&&i.flag[n])void 0==(this.toggle1.isChecked?i.flag[n].free:i.flag[n].recharge)&&(e.push(this.Investmentarry[n]),this.Investmentarry.splice(n,1),n--);else i.flag&&!i.flag[n]&&(e.push(this.Investmentarry[n]),this.Investmentarry.splice(n,1),n--)}for(n=0;n<this.Investmentarry.length;n++)this.Investmentarry[n].getComponent(d.default).buyNumber>t&&(e.push(this.Investmentarry[n]),this.Investmentarry.splice(n,1),n--);for(n=0;n<this.Investmentarry.length;n++)1==this.Investmentarry[n].getComponent(d.default).statue&&(e.push(this.Investmentarry[n]),this.Investmentarry.splice(n,1),n--);for(var n in e)this.content.addChild(e[n])},t.prototype.BuyBtnClick=function(){h.default.instance.openWindow(u.WindowType.Shop,function(){var e=f.default.instance.nowSortIndex[g.ShopConst.Recharge];y.default.instance.TabBtnList2.selectItem(e)},this)},t.prototype.GetReward=function(e){if(s.default.instance.isBuy||this.toggle1.isChecked){if(e.type==cc.Node.EventType.TOUCH_END){var t=e.currentTarget,i={cmd:"frgroupbuyreward",type:this.toggle1.isChecked?0:1,layer:t.parent.getComponent(d.default).index+1,actid:this.act};r.default.instance.sendProto(i)}}else v.default.instance.ShowMsg(a.default.getStr("6526"))},t.prototype.GroupPurchaseAllRed=function(){var e=s.default.instance.groupGrade;for(var t in e){if(!(s.default.instance.peopleBuyNumber>=e[t].groupBuyLv))return!1;if(!s.default.instance.infoArry.flag[t]||!s.default.instance.infoArry.flag[t].free)return!0}return!1},t.prototype.GroupurchaseRechargeRed=function(){var e=s.default.instance.groupGrade;if(s.default.instance.isBuy)for(var t in e){if(!(s.default.instance.peopleBuyNumber>=e[t].groupBuyLv))return!1;if(!s.default.instance.infoArry.flag[t]||!s.default.instance.infoArry.flag[t].recharge)return!0}return!1},__decorate([w(cc.Sprite)],t.prototype,"top",void 0),__decorate([w(cc.Node)],t.prototype,"content",void 0),__decorate([w(cc.Node)],t.prototype,"peopleBuy",void 0),__decorate([w(cc.SpriteAtlas)],t.prototype,"commAtlas",void 0),__decorate([w(cc.Node)],t.prototype,"buyBtn",void 0),__decorate([w(cc.Node)],t.prototype,"isBuy",void 0),__decorate([w(cc.Toggle)],t.prototype,"toggle1",void 0),__decorate([w(cc.Toggle)],t.prototype,"toggle2",void 0),__decorate([w(cc.Sprite)],t.prototype,"rightSprite",void 0),t=__decorate([I],t)}(n.default);i.default=D,cc._RF.pop()},{"../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Core/LoadManager":"LoadManager","../../../Core/Widget":"Widget","../../../Core/WindowType":"WindowType","../../../NetConnect/NetConnet":"NetConnet","../../../Util/GrayEffect":"GrayEffect","../../../Util/Utils":"Utils","../../Commons/Image":"Image","../../Commons/RewardUtils":"RewardUtils","../../InvestmentPlan/InvestmentItem":"InvestmentItem","../../Item/ItemIcon":"ItemIcon","../../OpenWin/OpenWinController":"OpenWinController","../../Shop/Shop":"Shop","../../Shop/ShopConst":"ShopConst","../../Shop/ShopController":"ShopController","../../Tips/OpTipsController":"OpTipsController","../ActivityCtrl":"ActivityCtrl","./GroupPurchaseContrl":"GroupPurchaseContrl"}],GuanqiaController:[function(e,t,i){"use strict";cc._RF.push(t,"ecbd9KOkuxHA5bcDhMzdgye","GuanqiaController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../Core/ConfigsManager"),a=e("../Role/RoleInfo"),r=cc._decorator,s=r.ccclass,l=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._configs=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){i.instance=this,this._configs=o.ConfigsManager.instance.getConfigs("guanqiaconf")},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.getConfig=function(e){return this._configs.guanqiaconf[e]},t.prototype.getGuanqiaMonsters=function(e,t){var i=this.getConfig(e);return i?this._configs.monsters[this._configs.playgames[i.playgames][t-1].monsters]:[]},t.prototype.getGuanqiaPlaygames=function(e,t){var i=this.getConfig(e);return i&&this._configs.playgames[i.playgames]?this._configs.playgames[i.playgames][t-1]:[]},t.prototype.getGuanqiaStepNum=function(e,t){void 0===t&&(t=1);var i=this.getConfig(e);if(!i)return 0;var n=this._configs.playgames[i.playgames][t-1].stepnum;return n||this.getGuanqiaStepFormula(e,t)},t.prototype.getGuanqiaStepFormula=function(e,t){var i=0,n=this.getConfig(e);if(!n)return 0;var o=this._configs.playgames[n.playgames][t-1].formula;if(o)switch(o){case 1:i=5+Math.floor(a.MyRoleInfo.level/5);break;case 2:i=12+Math.floor(a.MyRoleInfo.level/5)}return Math.min(12,i)},t.prototype.getGuanqiaPlayGames=function(e){var t=this.getConfig(e);return t?this._configs.playgames[t.playgames]:[]},t.prototype.getGuanqiaPlayGamesId=function(e){var t=this.getConfig(e);return t?t.playgames:[]},Object.defineProperty(t.prototype,"config",{get:function(){return this._configs},enumerable:!0,configurable:!0}),t.instance=null,t=i=__decorate([s],t)}(n.default));i.default=l,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Controller":"Controller","../Role/RoleInfo":"RoleInfo"}],GuideFightController:[function(e,t,i){"use strict";cc._RF.push(t,"a54e9kg7SpBcLm2QYBSrO6D","GuideFightController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Manager/SceneManager"),o=e("../../../Core/TimeController"),a=e("../View/FightView"),r=e("./EntityQiPaoController"),s=e("./SceneController"),l=e("../../../Core/GameEventDispatcher"),c=e("../../../Core/Event"),d=e("../../../Core/ConfigsManager"),p=e("../View/ActorsLayer"),h=e("./FightController"),u=e("../../../Core/SimpleActionEffect"),f=e("../View/ActorsBigSkillLayer"),g=e("../../../Global/GlobalValue"),y=e("../../Fight/staticattr"),m=e("../../Gamelayer/GameLayer"),C=e("./SpecialSkillEffectController"),v=e("../../Guide/GuideNewController"),_=e("../../OpenWin/OpenWinController"),b=e("../../../Core/WindowType"),T=e("../../SandTable/SandTableController"),S=e("../../Chapter/GuanqiaController"),I=e("../../Sound/SoundController"),w=cc._decorator,D=w.ccclass,R=(w.property,function(){function e(){this.guidefightstatus=1,this.guideskill=-1,this.useSkillFinger=null,this.step=1,this.conf=null,this.iscomplete=!0,this.fightconf=null,this.curbattle=[],this.addMonster=!1,this.waitaddmonsters=[]}var t;return t=e,Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new t,t.instance.init()),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.conf=d.ConfigsManager.instance.getConfigs("guidefightconf")},e.prototype.startGuideFight=function(){f.default.instance.isShow=!1,this.iscomplete=!1,a.default.instance.node.insertChild(m.default.instance.begainanim[3],0),m.default.instance.begainanim[3].zIndex=99,m.default.instance.begainanim[3].active=!1,this.step=1,n.default.instance.myRole||s.default.instance.addMyRole(!1),this.updateStep()},e.prototype.stepCall=function(e){switch(e){case 1:I.default.instance.StopBGM(),l.GameEventDispatcher.instance.emit(c.EventDefiner.C_Fight_Start,!0)}},e.prototype.addMonsters=function(e,t){this.addMonster=!0;for(var i=0,n=this.conf.monsters[e];i<n.length;i++){var o=n[i],a={cardid:o.cardId,grade:o.grade,level:o.level,num:1,self:1==t,x:o.x,y:o.y,handle:o.handle,autoUseSkill:!1,playeffect:!1};l.GameEventDispatcher.instance.emit(c.EventDefiner.C_Scene_Add_Actor,a)}this.addMonster=!1},e.prototype.checkAddMonster=function(){if(this.waitaddmonsters.length>0){var e=this.waitaddmonsters.shift();this.addMonsters(e[0],e[1])}},e.prototype.updateStep=function(){if(this.fightconf&&this.fightconf.call&&this.stepCall(this.fightconf.call),this.fightconf=this.conf.guidefight[this.step],this.fightconf&&this.fightconf.battles&&(this.curbattle=this.fightconf.battles),!this.iscomplete)if(this.fightconf){var e;switch(this.fightconf.type){case 1:case 2:this.conf.guidefight[this.step-1]&&8==this.conf.guidefight[this.step-1].type?this.waitaddmonsters.push([this.conf.guidefight[this.step].monsters,this.fightconf.type]):this.addMonsters(this.fightconf.monsters,this.fightconf.type);break;case 3:var t=0;e=p.default.instance.getSceneEntity(this.fightconf.value),t=-1==this.fightconf.showtime?1e6:this.fightconf.showtime,r.default.instance.showQiPao(e,this.fightconf.say,t),this.palyrate=n.default.instance.fightViewPlayRate;break;case 4:this.guidefightstatus=1,(e=p.default.instance.getSceneEntity(this.fightconf.value)).useInitiativeSkill(this.fightconf.skillId,1,!0);break;case 5:return this.palyrate=n.default.instance.fightViewPlayRate,this.guideskill=this.fightconf.skillId,void this.guideUserSkill();case 6:this.guidefightstatus=1;for(var i=0;i<n.default.instance.rightentitys.length;i++){var o=n.default.instance.rightentitys[i];o.prop.cardid==this.fightconf.value&&(e=p.default.instance.getSceneEntity(o.prop.handle)).hpOverDead()}break;case 7:return this.compoundMosnter(this.fightconf.value),void(this.guidefightstatus=2);case 8:return T.default.instance.setOldArr([]),T.default.instance.setSandInfo(S.default.instance.getConfig(this.fightconf.value)),T.default.instance.setTotaleMove(1),void _.default.instance.openWindow(b.WindowType.SandTable)}this.checkStep()}else this.completeGuideFight()},e.prototype.checkStep=function(){var e=this;if(!this.iscomplete){var t=this.conf.guidefight[this.step];if(-1!=t.nexttime)if(t.nexttime)var i=o.default.instance.setTimeout(function(){if(!e.iscomplete)if(3==t.type&&(e.guidefightstatus=1),2==t.type)var n=o.default.instance.setTimeout(function(){e.step++,e.updateStep(),o.default.instance.clearTimeout(n)},e,2e3);else e.step++,e.updateStep();o.default.instance.clearTimeout(i)},this,t.nexttime);else this.step++,this.updateStep()}},e.prototype.checkSandtable=function(){return!this.iscomplete&&(-1==this.fightconf.nexttime&&(this.step++,this.updateStep()),-1==this.fightconf.nexttime)},e.prototype.checkCompoundStep=function(){-1==this.fightconf.nexttime&&8==this.fightconf.type&&(this.step++,this.updateStep())},e.prototype.guideUserSkill=function(){f.default.instance.isShow=!0,this.guidefightstatus=2,p.default.instance.getSceneEntity(this.fightconf.value).setTarget(n.default.instance.rightentitys),v.default.instance.checkCondition(1)},e.prototype.reover=function(){this.guidefightstatus=1,this.useSkillFinger&&(this.useSkillFinger.removeFromParent(),this.useSkillFinger.destroy(),this.useSkillFinger=null)},e.prototype.compoundMosnter=function(e){for(var t=this,i=[],o=0,a=0;a<n.default.instance.leftentitys.length;a++){var r=n.default.instance.leftentitys[a];if(r.prop.cardid==e){o++;var s=p.default.instance.getSceneEntity(r.prop.handle);p.default.instance.changeByLayer(s,s.node.parent.childrenCount+1),i.push(s),s.node.runAction(cc.sequence(cc.moveTo(1,new cc.Vec2(0,0)),cc.callFunc(function(){--o<=0&&t.compoundMosnterCom(i,e)})))}}},e.prototype.compoundMosnterCom=function(e,t){var i=this,n=new cc.Node;n.setScale(4,4),a.default.instance.node.addChild(n),n.addComponent(u.default);n.getComponent(u.default).playById(3,"cardSynthesis",!1,function(){for(var o=0;o<e.length;o++){var a=e[o];a.node.active=!1,a.hpOverDead()}var r=new y.StaticAttr;r.PushCard(t,1,5);var s={cardid:t,grade:5,level:1,num:1,self:!0,x:-100,y:0,handle:26,attr:r,autoUseSkill:!1};h.default.instance.fightingAddActor(s,g.ADD_ACTOR_TYPE.NONE,r.GetMaxHp(),null,!0,g.ACTION.STAND,!0),i.guidefightstatus=1,i.checkStep(),n.removeFromParent(),n.destroy()},this),n.getComponent(u.default).endframe=6},e.prototype.completeGuideFight=function(){T.default.instance.setOldArr([]),T.default.instance.setSandInfo(null),this.iscomplete=!0,T.default.instance.openTipe=!1;for(var e=0,t=m.default.instance.begainanim;e<t.length;e++){var i=t[e];a.default.instance.node.insertChild(i,0)}this.palyrate=n.default.instance.fightViewPlayRate,a.default.instance.SetFightViewPlayRate(0),m.default.instance.playendani(),a.default.instance.SetFightViewPlayRate(this.palyrate);o.default.instance.setTimeout(function(){C.default.instance.allcom(),s.default.instance.clearAll()},this,1e3)},e.prototype.getBattleList=function(e){if(this.curbattle.length>0)return this.curbattle[e]},e._instance=null,e=t=__decorate([D],e)}());i.default=R,cc._RF.pop()},{"../../../Core/ConfigsManager":"ConfigsManager","../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/SimpleActionEffect":"SimpleActionEffect","../../../Core/TimeController":"TimeController","../../../Core/WindowType":"WindowType","../../../Global/GlobalValue":"GlobalValue","../../Chapter/GuanqiaController":"GuanqiaController","../../Fight/staticattr":"staticattr","../../Gamelayer/GameLayer":"GameLayer","../../Guide/GuideNewController":"GuideNewController","../../OpenWin/OpenWinController":"OpenWinController","../../SandTable/SandTableController":"SandTableController","../../Sound/SoundController":"SoundController","../Manager/SceneManager":"SceneManager","../View/ActorsBigSkillLayer":"ActorsBigSkillLayer","../View/ActorsLayer":"ActorsLayer","../View/FightView":"FightView","./EntityQiPaoController":"EntityQiPaoController","./FightController":"FightController","./SceneController":"SceneController","./SpecialSkillEffectController":"SpecialSkillEffectController"}],GuideNewController:[function(e,t,i){"use strict";cc._RF.push(t,"10349i5zB1FLZax2kyTPt/V","GuideNewController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./GuideVo"),o=e("../../Core/GameEventDispatcher"),a=e("../../Core/Event"),r=e("../../Core/TimeController"),s=e("../Chapter/ChapterController"),l=e("../../Core/LoadManager"),c=e("../../GlobalContext"),d=e("../Role/RoleInfo"),p=e("../../Core/Controller"),h=e("../Scene/Controller/SceneController"),u=e("../../Global/GlobalValue"),f=e("../Scene/View/ActorsBigSkillLayer"),g=e("../Scene/View/FightView"),y=e("../../Core/ConfigsManager"),m=e("../SandTable/SandTableMain"),C=e("../../Core/WindowManager"),v=e("../../Core/WindowType"),_=e("../Gamelayer/GameLayer"),b=e("../Scene/Manager/SceneManager"),T=e("../Scene/View/ActorsLayer"),S=e("../WarTeam/MonsterController"),I=e("../SandTable/SandTableSymbol"),w=e("../Status/StatusType"),D=e("../Scene/Controller/GuideFightController"),R=e("../Reel/ReelController"),A=e("../../Util/Utils"),N=e("../Commons/MorphologicalTags"),L=e("../Commons/WindowOpenUtils"),E=e("../Sound/SoundController"),B=e("../PlotWin/PlotController"),M=cc._decorator,x=M.ccclass,k=M.property,P=function(e){function t(){var t=e.call(this)||this;return t.guideMaskNode=null,t.bgmask=null,t.clickBtn=null,t.talkContainer=null,t.finger=null,t.vo=new n.default,t.waitLooIndex=0,t.waitMaxLooIndex=30,t.curGuideNode=null,t.isGuide=!1,t.isPause=!1,t.autoNextTime=0,t.delayNextTime=0,t.loopCheckGuideMaskTime=0,t.needloopCheckGuideMaskTime=!0,t.guideCanClick=!0,t.open=!0,t.guideconf=null,t.canNextStep=!0,t.openWinSkipGuide=!0,t.guidebtneffectTime=0,t.isShowBtnEffect=!0,t.reelMonsterId=0,t.reelMonsterGrade=0,t.curtime=0,t.firstBigIndex=[67,68],t.currSound=0,t.findIntervalTime=0,t.fingerLoading=!1,t.talkLoading=!1,i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.guideconf=y.ConfigsManager.instance.getConfigs("guideconf")},t.prototype.start=function(){e.prototype.start.call(this),o.GameEventDispatcher.instance.on(a.EventDefiner.GuideActive,this.checkOnline,this),o.GameEventDispatcher.instance.on(a.EventDefiner.GuideCheckSkipNode,this.onSkipNode,this),o.GameEventDispatcher.instance.on(a.EventDefiner.C_Fight_Start,this.setBigSkill,this),this.bgmask.getChildByName("Bg").on(cc.Node.EventType.TOUCH_END,this.skipCurStep,this,!0)},t.prototype.setBigSkill=function(){var e=this;if(m.default.instance&&m.default.instance.isHaveMasSenior&&w.ActivityStatus.value!=w.ActivityStatus.Guide&&!f.default.instance.isHaveCard())var t=r.default.instance.setTimeout(function(){for(var i in e.firstBigIndex)if(-1==d.MyRoleInfo.guide.indexOf(e.firstBigIndex[i])){e.checkCondition(33,e.firstBigIndex[i]);break}r.default.instance.clearTimeout(t)},this,1200)},t.prototype.stopCondition=function(e){this.isGuide&&this.vo.condition==e&&(console.log("\u505c\u6b62\u5f15\u5bfc"+e),this.openWinSkipGuide=!0,this.isGuide&&this.vo&&this.vo.curstep&&(!this.vo.curstep.compel||20==this.vo.condition||21==this.vo.condition)&&this.checkSkipOperation())},t.prototype.checkCondition=function(e,t){if(D.default.instance.iscomplete||1==e){this.vo.id&&this.vo.condition==e&&(this.vo.param=t);var i=this.vo.setData(e,t);return this.vo.id&&(this.vo&&this.vo.finMove?this.needloopCheckGuideMaskTime=!0:this.needloopCheckGuideMaskTime=!1),i&&(this.isPause=!1,this.startGuide()),i}},t.prototype.startGuide=function(){this.open&&0!=this.vo.id&&(console.log("\u4fdd\u7559\u754c\u9762"+this.vo.reservewindow,this.vo),-1!=this.vo.reservewindow&&this.vo.curstep&&this.vo.curstep.compel&&C.default.instance.closeAll(this.vo.reservewindow),this.isGuide=!0,this.loopStep(),void 0!==this.vo.saveguideid&&0==this.vo.saveguideid[0]&&this.sent(this.vo.id),o.GameEventDispatcher.instance.emit(a.EventDefiner.CurGuideStart),console.log("\u5f00\u59cb\u5f15\u5bfc",this.vo))},t.prototype.pause=function(){o.GameEventDispatcher.instance.emit(a.EventDefiner.C_Fight_StopTask),this.isGuide&&(console.log("\u6682\u505c\u5f15\u5bfc",this.vo),this.isPause=!0,this.clear())},t.prototype.resume=function(){this.isGuide&&this.isPause&&(o.GameEventDispatcher.instance.emit(a.EventDefiner.C_Fight_StartTask),console.log("\u6062\u590d\u5f15\u5bfc",this.vo),this.isPause=!1,this.startGuide())},t.prototype.loopStep=function(){var e=this,t=0;this.clickBtn.active=!1,this.stopBtnEffect(),void 0!==this.vo.curstep.delayTime&&(this.hideGuideNode(),this.guideCanClick=!1,t=this.vo.curstep.delayTime),t>0?this.delayNextTime=r.default.instance.setTimeout(function(){e.vo.curstep&&(14!=e.vo.curstep.scene&&18!=e.vo.curstep.scene&&29!=e.vo.curstep.scene||g.default.instance.SetFightViewPlayRate(0),e.setMaskTalkNode()),e.clearDelayNextTime()},this,t):(this.vo.curstep&&(14!=this.vo.curstep.scene&&18!=this.vo.curstep.scene&&29!=this.vo.curstep.scene||g.default.instance.SetFightViewPlayRate(0),this.setMaskTalkNode()),this.clearDelayNextTime())},t.prototype.hideGuideNode=function(){this.talkContainer&&(this.talkContainer.active=!1),this.finger&&(this.finger.active=!1)},t.prototype.otherCheckNextStep=function(e){this.vo.curstep&&this.vo.curstep.othernextstep==e&&(this.canNextStep=!0,this.checkNextStep())},t.prototype.checkNextStep=function(){B.default.instance.getPlotInfo(B.PlotType.EnterMap),this.canNextStep&&(this.setStepIndex(this.vo.stepIndex+1),this.vo&&this.vo.finMove?this.needloopCheckGuideMaskTime=!0:this.needloopCheckGuideMaskTime=!1,this.clear(),this.vo.curstep?(this.canNextStep=void 0===this.vo.curstep.othernextstep,this.hideGuideNode(),B.default.instance.stepTypeDic[B.PlotType.EnterMap].length||this.loopStep()):this.curGuideEnd())},t.prototype.curGuideEnd=function(){var e=this;console.log("\u7ed3\u675f\u5f15\u5bfc",this.vo,this.vo.saveguideid),this.vo&&(void 0!==this.vo.saveguideid?this.vo.saveguideid.forEach(function(t){-1!=e.vo.saveguideid[0]&&e.sent(t)}):this.sent(this.vo.id),this.completeStep(),this.completeCall(this.vo.call))},t.prototype.curGuideSkip=function(){this.vo&&this.isGuide&&(this.sent(this.vo.id),this.completeCall(this.vo.call),this.completeStep())},t.prototype.setMaskTalkNode=function(){if(!this.isPause&&this.isGuide)if(this.vo.curstep){if(this.waitLooIndex++,this.waitLooIndex>this.waitMaxLooIndex)return console.log("\u6e05\u7406\u5f15\u5bfcthis.waitLooIndex"+this.waitLooIndex),this.sent(this.vo.id),void this.completeStep();this.setBgMask(0,0),this.hideGuideNode(),this.guideMaskNode.active=this.vo.curstep.showMask,this.findNode(),this.clearAutoNextTime(),this.vo.curstep.nextTime&&(this.autoNextTime=r.default.instance.setTimeout(this.autocheckNextStep,this,this.vo.curstep.nextTime))}else this.clearFindInterval()},t.prototype.autocheckNextStep=function(){this.checkNextStep()},t.prototype.findNode=function(){if(!this.vo.curstep)return this.clearFindInterval(),void this.clearLoopCheckGuideMask();var e=null;if(!this.vo.curstep.maskNode||null!=(e=cc.find(this.vo.curstep.maskNode))&&e.active){switch(this.vo.curstep.scene){case 2:e=e.children.length>0&&h.default.instance.scenestatus==u.GameScene.Scene?e.children[e.childrenCount-1-s.default.instance.currentGuanqiaId]:null;break;case 15:e=e.children[e.childrenCount-4].getChildByName("btnType");break;case 18:R.default.instance.addProp=A.default.AttrListToMapAttr(this.vo.curstep.prop);break;case 20:e=e.children[1].getChildByName("btnLineup");break;case 22:e=b.default.instance.leftlives.length>0?T.default.instance.entities[b.default.instance.leftlives[0].handle].node:null;break;case 21:case 28:case 25:e=e.getChildByName("symbol"+this.vo.param);break;case 27:e=e.children[0].getChildByName("btnLineup");break;case 23:(e=e.getChildByName("GoBtn")).active||(e=e.getChildByName("GetBtn"));break;case 24:T.default.instance.setEntitysOpacity(0);for(var t=0,i=b.default.instance.leftentitys;t<i.length;t++){var n=i[t];if(n.prop.addtype==u.ADD_ACTOR_TYPE.REEL&&n.prop.cardid==this.reelMonsterId){(e=n.node).opacity=255,this.vo.curstep.masksize=[];var o=S.default.instance.getCardGradeByGradeConf(this.reelMonsterId,this.reelMonsterGrade);this.vo.curstep.masksize.push(o.width),this.vo.curstep.masksize.push(o.height);break}}break;case 26:var a=m.default.instance.findNode();if(a){var l=e.getChildByName("symbol"+this.vo.param),c=void 0,d=void 0;a.x<0&&l.x<0||a.x>0&&l.x>0?(d=Math.abs(a.x-l.x)+1.5*a.width,c=Math.abs(a.x-l.x)):(d=Math.abs(Math.abs(a.x)+Math.abs(l.x))+1.5*a.width,c=Math.abs(Math.abs(a.x)+Math.abs(l.x)));var p=void 0,f=void 0;a.y<0&&l.y<0||a.y>0&&l.y>0?(f=Math.abs(a.y-l.y)+1.5*a.height,p=Math.abs(a.y-l.y)):(f=Math.abs(Math.abs(a.y)+Math.abs(l.y))+1.5*a.height,p=Math.abs(Math.abs(a.y)+Math.abs(l.y))),this.vo.curstep.masksize=[d,f];var g=void 0,y=void 0,C=void 0,v=void 0,_=Math.floor((d-.5*a.width)/100)/4,I=Math.floor((f-.5*a.height)/100)/4,w=a.width/2/_,D=a.height/2/I;l.y==a.y?(y=C=0,g=l.x>a.x?(d-w)/2:-(d-w)/2,v=l.x>a.x?c:-c):l.x==a.x?(g=v=0,y=l.y>a.y?(f-D)/2:-(f-D)/2,C=l.y>a.y?p:-p):(g=l.x>a.x?(d-w)/2:-(d-w)/2,y=l.y>a.y?(f-D)/2:-(f-D)/2,v=l.x>a.x?c:-c,C=l.y>a.y?p:-p),this.vo.curstep.maskoff=[g,y],l.x>a.x&&(this.vo.curstep.talkdir=-1),this.vo.curstep.finMovey=C,this.vo.curstep.finMovex=v,e=a,console.log("\u673a\u5173\u79fb\u52a8\u7ed3\u679c",this.vo.curstep)}}if(e&&void 0!==this.vo.curstep.nodeParam&&(e=e.children[this.vo.curstep.nodeParam]),19==this.vo.curstep.scene&&e&&(e=e.getChildByName("SwitchNode")?e.getChildByName("SwitchNode").getChildByName("OneLayer"):null),null!=e)if(this.clearFindInterval(),e){this.openWinSkipGuide=!0,this.curGuideNode!=e&&(this.curGuideNode&&this.curGuideNode.off(cc.Node.EventType.TOUCH_END,this.clickGuideNode,this,!0),this.curGuideNode=e,console.log("\u627e\u5230\u8282\u70b9"+this.curGuideNode.name),this.curGuideNode.on(cc.Node.EventType.TOUCH_END,this.clickGuideNode,this,!0),this.curtime=Date.now()),this.guideCanClick=!0,this.vo.curstep.compel?this.setMask(e):(this.bgmask.active=!1,this.isShowBtnEffect);var N=e;2==this.vo.curstep.scene&&(N=e.getChildByName("model").getChildByName("MonsterPreview").getChildByName("PreviewBody")),this.setTalk(N),this.setFinger(N),this.setClick(N),!this.loopCheckGuideMaskTime&&this.needloopCheckGuideMaskTime?(console.log("\u5faa\u73af\u627e\u8282\u70b9"),this.loopCheckGuideMaskTime=r.default.instance.setInterval(this.findNode,this,500,e)):(console.log("\u53d6\u6d88\u5faa\u73af\u627e\u8282\u70b9"),this.clearLoopCheckGuideMask())}else console.warn(this.vo,"\u663e\u793a\u9ad8\u4eae\u6216\u5bf9\u8bdd\u6ca1\u6709\u8282\u70b9");else this.waitIntervalTime()}else this.waitIntervalTime()},t.prototype.setClick=function(e){var t=null,i=0,n=0;i=e.width*e.scaleX,n=e.height*e.scaleY,t=e.convertToWorldSpaceAR(cc.v2(0,0)),void 0!==this.vo.curstep.maskoff&&(t.x+=this.vo.curstep.maskoff[0]*e.scaleX,t.y+=this.vo.curstep.maskoff[1]*e.scaleY),t=this.node.convertToNodeSpaceAR(t),void 0!==this.vo.curstep.masksize&&(i=this.vo.curstep.masksize[0],n=this.vo.curstep.masksize[1],24==this.vo.curstep.scene&&(t.y+=this.vo.curstep.masksize[1]/4)),this.clickBtn.active=void 0===this.vo.curstep.buttonCall,this.clickBtn.width=i,this.clickBtn.height=n,this.clickBtn.setPosition(t)},t.prototype.playBtnEffect=function(e){var t=this,i=this.clickBtn.getChildByName("Guidebtneffect");if(i.active||(i.active=!0),i&&!this.guidebtneffectTime){var n=e.width*e.scaleX,o=e.height*e.scaleY;void 0!==this.vo.curstep.masksize&&(n=this.vo.curstep.masksize[0],o=this.vo.curstep.masksize[1]),i.height=800,i.width=800;var a=(800-n)/20,s=(800-o)/20;this.guidebtneffectTime=r.default.instance.setInterval(function(){i.width-=a,i.height-=s,i.width<n&&(t.isShowBtnEffect=!1,i.active=!1,r.default.instance.clearInterval(t.guidebtneffectTime),t.guidebtneffectTime=0)},this,50)}},t.prototype.stopBtnEffect=function(){var e=this.clickBtn.getChildByName("Guidebtneffect");e.active=!1,this.isShowBtnEffect=!0,e&&(r.default.instance.clearInterval(this.guidebtneffectTime),this.guidebtneffectTime=0)},t.prototype.setMask=function(e){this.bgmask.active=!0;var t=null,i=0,n=0;if(this.vo.curstep.showMask){if(1==this.vo.curstep.scene||14==this.vo.curstep.scene){var o=e.getChildByName("bg_bsjnyk").getChildByName("SkillButton");i=o.width,n=o.height,t=o.convertToWorldSpaceAR(cc.v2(0,0)),void 0!==this.vo.curstep.maskoff&&(t.x+=this.vo.curstep.maskoff[0]*o.scaleX,t.y+=this.vo.curstep.maskoff[1]*o.scaleY),t=this.node.convertToNodeSpaceAR(t)}else i=e.width*e.scaleX,n=e.height*e.scaleY,t=e.convertToWorldSpaceAR(cc.v2(0,0)),void 0!==this.vo.curstep.maskoff&&(t.x+=this.vo.curstep.maskoff[0]*e.scaleX,t.y+=this.vo.curstep.maskoff[1]*e.scaleY),void 0!==this.vo.curstep.masksize&&(i=this.vo.curstep.masksize[0],n=this.vo.curstep.masksize[1],24==this.vo.curstep.scene&&(t.y+=this.vo.curstep.masksize[1]/4)),t=this.node.convertToNodeSpaceAR(t);1===this.vo.curstep.masktype?this.bgmask.getComponent(cc.Mask).type=cc.Mask.Type.RECT:this.bgmask.getComponent(cc.Mask).type=cc.Mask.Type.ELLIPSE,this.setBgMask(i,n,t)}},t.prototype.clearLoopCheckGuideMask=function(){this.loopCheckGuideMaskTime&&(r.default.instance.clearInterval(this.loopCheckGuideMaskTime),this.loopCheckGuideMaskTime=0)},t.prototype.waitIntervalTime=function(){0==this.findIntervalTime&&(this.findIntervalTime=r.default.instance.setInterval(this.setMaskTalkNode,this,500))},t.prototype.setFinger=function(e){var t=this;if(this.vo.finMove&&this.vo.curstep)if(this.finger){this.finger.active=!0;var i=null;i=e.convertToWorldSpaceAR(new cc.Vec2(0,0)),i=this.node.convertToNodeSpaceAR(i),this.finger.setPosition(i),21==this.vo.curstep.scene?this.finger.getComponent("Finger").fingerAct(!1,new cc.Vec2(-600,i.y),i,this.vo.curstep.showfingereff):this.finger.getComponent("Finger").fingerAct(!1,new cc.Vec2(i.x+this.vo.finMove.x,i.y+this.vo.finMove.y),i,this.vo.curstep.showfingereff,[this.vo.finMove.x,this.vo.finMove.y])}else if(!this.fingerLoading){this.fingerLoading=!0;var n=c.GlobalContext.Root+"prefab/Guide/finger";l.default.instance.loadResByType(n,cc.Prefab,function(i){t.finger=A.default.getNodeByUrl(i,n),t.node.addChild(t.finger),t.isGuide&&t.setFinger(e),t.finger.active=t.isGuide},this)}},t.prototype.setTalk=function(e){var t=this;if(this.vo.curstep.talk)if(this.talkContainer){this.talkContainer.active=!0;var i=null;i=e.convertToWorldSpaceAR(new cc.Vec2(0,0)),i=this.node.convertToNodeSpaceAR(i);var n=this.talkContainer.getChildByName("talkNode").getChildByName("speach"),o=this.talkContainer.getChildByName("talkNode").getChildByName("speach").getChildByName("New Label");this.vo.curstep.talkdir?(o.scaleX=this.vo.curstep.talkdir,this.talkContainer.scaleX=this.vo.curstep.talkdir):i.x>0?(this.talkContainer.scaleX=-1,o.scaleX=-1):(this.talkContainer.scaleX=1,o.scaleX=1),o.getComponent(cc.Label).string=this.vo.curstep.talk,this.currSound!=this.vo.curstep.soundID&&(E.default.instance.stopCardEffect(),this.vo.curstep.soundID&&(E.default.instance.playCardEffect(E.SoundType.guidSound+this.vo.curstep.soundID),this.currSound=this.vo.curstep.soundID));var a=r.default.instance.setTimeout(function(){if(t.vo.curstep){var e=0,o=0;if(c.GlobalContext.UIHeight/2<i.y+280&&n.width/2<c.GlobalContext.UIWidth/2-Math.abs(i.x))i.y-=220,t.vo.curstep.showfingereff?(e=100+t.vo.finMove.x,o=t.vo.finMove.y):(e=100,o=0);else{t.vo.curstep.showfingereff?(e=350+t.vo.finMove.x,o=t.vo.finMove.y):(e=350,o=0);var s=c.GlobalContext.UIHeight-246;i.y>s/2?i.y=s/2:i.y<-s/2&&(i.y=-s/2)}n.x=e,n.y=o,t.talkContainer.setPosition(i)}r.default.instance.clearTimeout(a)},this,100)}else if(!this.talkLoading){this.talkLoading=!0;var s=c.GlobalContext.Root+"prefab/Guide/TalkContainer";l.default.instance.loadResByType(s,cc.Prefab,function(i){t.talkContainer=A.default.getNodeByUrl(i,s),t.node.addChild(t.talkContainer),t.isGuide&&t.setTalk(e),t.talkContainer.active=t.isGuide,t.currSound!=t.vo.curstep.soundID&&(E.default.instance.stopCardEffect(),t.vo.curstep.soundID&&(E.default.instance.playCardEffect(E.SoundType.guidSound+t.vo.curstep.soundID),t.currSound=t.vo.curstep.soundID))},this)}},t.prototype.setBgMask=function(e,t,i){this.bgmask.width=e,this.bgmask.height=t,i&&this.bgmask.setPosition(i)},t.prototype.setStepIndex=function(e){this.vo.stepIndex=e},t.prototype.onSkipNode=function(e){console.log("1\u8df3\u8fc7\u5f15\u5bfc\u62c9",e,this.vo),this.checkSkipOperation()},t.prototype.skipCurStep=function(e){this.vo.curstep.isSkip&&this.curGuideNode&&this.clickGuideNode(null)},t.prototype.sent=function(e){-1==d.MyRoleInfo.guide.indexOf(e)&&(e>1e3?d.MyRoleInfo.guide.push(e/1e3):d.MyRoleInfo.guide.push(e));var t={cmd:"guide",guide:d.MyRoleInfo.guide};console.log("\u4fdd\u5b58\u5f15\u5bfc",d.MyRoleInfo.guide),this.sendProto(t)},t.prototype.checkSkipOperation=function(){this.isGuide&&this.openWinSkipGuide&&this.curGuideSkip()},t.prototype.clickGuideNode=function(e){if(e&&(this.openWinSkipGuide=!1),this.isGuide&&!(Date.now()-this.curtime<500)){if(console.log("\u70b9\u51fb\u5f15\u5bfc\u6216\u5f00\u5173\u754c\u9762",e,this.vo.curstep),null!=this.vo.click)switch(this.vo.click[0]){case 1:o.GameEventDispatcher.instance.emit(a.EventDefiner.ChangeGameScene,{status:u.GameScene.Main});break;case 2:_.default.instance._hallWindowType=this.vo.click[1],this.emitClickBtn();break;case 3:L.default.instance.openWindowType(this.vo.click[1])}else 25==this.vo.curstep.scene?this.curGuideNode.getComponent(I.default).OnSceneTouchStart(null):30==this.vo.curstep.scene?(S.default.instance.data.MorphologicalTag=5,this.curGuideNode.parent.getComponent(N.default).setShow(5),o.GameEventDispatcher.instance.emit(a.EventDefiner.MorphologicalTags_onClick,{tabIndex:5})):this.emitClickBtn();this.checkNextStep()}},t.prototype.emitClickBtn=function(){if(this.curGuideNode&&this.curGuideNode.getComponent(cc.Button)&&this.curGuideNode.getComponent(cc.Button).clickEvents){var e=this.curGuideNode.getComponent(cc.Button).clickEvents,t=new cc.Event.EventCustom(cc.Node.EventType.TOUCH_END,!0);t.target=this.curGuideNode,t.currentTarget=this.curGuideNode;var i=r.default.instance.setTimeout(function(){for(var n=0;n<e.length;n++)e[n].emit([t]);r.default.instance.clearTimeout(i)},this,100)}},t.prototype.onBg=function(){this.vo.curstep.isSkip&&this.curGuideNode&&this.checkNextStep()},t.prototype.clearGuideNode=function(){this.curGuideNode&&(this.curGuideNode.off(cc.Node.EventType.TOUCH_END,this.clickGuideNode,this,!0),console.log("\u79fb\u9664\u70b9\u51fb\u5f15\u5bfc\u8282\u70b9\u4e8b\u4ef6"),this.curGuideNode=null,this.guideCanClick=!0)},t.prototype.clearFindInterval=function(){0!=this.findIntervalTime&&r.default.instance.clearInterval(this.findIntervalTime),this.waitLooIndex=0,this.findIntervalTime=0},t.prototype.clearAutoNextTime=function(){0!=this.autoNextTime&&r.default.instance.clearTimeout(this.autoNextTime),this.autoNextTime=0},t.prototype.clearDelayNextTime=function(){0!=this.delayNextTime&&r.default.instance.clearTimeout(this.delayNextTime),this.delayNextTime=0},t.prototype.completeStep=function(){this.isGuide=!1,o.GameEventDispatcher.instance.emit(a.EventDefiner.CurGuideComplete),this.clear()},t.prototype.clear=function(){this.hideGuideNode(),this.guideMaskNode.active=!1,this.clickBtn.active=!1,this.guideCanClick=!0,this.clearLoopCheckGuideMask(),this.clearGuideNode(),this.clearFindInterval(),this.clearAutoNextTime(),this.clearDelayNextTime()},t.prototype.completeCall=function(e){switch(e){case 1:m.default.instance&&C.default.instance.isOpenWindow(v.WindowType.SandTable)&&m.default.instance.openTips(1);break;case 2:g.default.instance.SetFightViewPlayRate(1),T.default.instance.setEntitysOpacity(255);break;case 3:g.default.instance.SetFightViewPlayRate(1)}},t.prototype.checkOnline=function(){var e=this;if(!d.MyRoleInfo.firstgame){console.log("\u7ebf\u4e0a\u68c0\u6d4b\u5f15\u5bfc\u6761\u4ef61");var t=r.default.instance.setTimeout(function(){console.log("\u7ebf\u4e0a\u68c0\u6d4b\u5f15\u5bfc\u6761\u4ef62"),e.vo.setDataTwo(),e.startGuide(),r.default.instance.clearTimeout(t)},this,100)}},t.prototype.isSandTableGuide=function(){return this.vo&&this.isGuide&&this.vo.curstep&&1==this.vo.curstep.othernextstep},t.prototype.isSandTableDropGuide=function(){return this.vo&&this.isGuide&&this.vo.curstep&&2==this.vo.curstep.othernextstep},t.prototype.isSandTableGuideArea=function(){return this.vo&&this.isGuide&&this.vo.curstep&&1==this.vo.curstep.othernextstep},t.prototype.checkChapterChallenge=function(){if(this.guideCanClick&&this.isGuide)return!0;switch(s.default.instance.currentGuanqiaId){case 0:return-1!=d.MyRoleInfo.guide.indexOf(2);case 1:return-1!=d.MyRoleInfo.guide.indexOf(3);case 2:return-1!=d.MyRoleInfo.guide.indexOf(5)}return!1},t.instance=null,__decorate([k(cc.Node)],t.prototype,"guideMaskNode",void 0),__decorate([k(cc.Node)],t.prototype,"bgmask",void 0),__decorate([k(cc.Node)],t.prototype,"clickBtn",void 0),t=i=__decorate([x],t)}(p.default);i.default=P,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Chapter/ChapterController":"ChapterController","../Commons/MorphologicalTags":"MorphologicalTags","../Commons/WindowOpenUtils":"WindowOpenUtils","../Gamelayer/GameLayer":"GameLayer","../PlotWin/PlotController":"PlotController","../Reel/ReelController":"ReelController","../Role/RoleInfo":"RoleInfo","../SandTable/SandTableMain":"SandTableMain","../SandTable/SandTableSymbol":"SandTableSymbol","../Scene/Controller/GuideFightController":"GuideFightController","../Scene/Controller/SceneController":"SceneController","../Scene/Manager/SceneManager":"SceneManager","../Scene/View/ActorsBigSkillLayer":"ActorsBigSkillLayer","../Scene/View/ActorsLayer":"ActorsLayer","../Scene/View/FightView":"FightView","../Sound/SoundController":"SoundController","../Status/StatusType":"StatusType","../WarTeam/MonsterController":"MonsterController","./GuideVo":"GuideVo"}],GuideTarget:[function(e,t,i){"use strict";cc._RF.push(t,"f8db94+OaBEcbXXJiulL4AN","GuideTarget"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/GameEventDispatcher"),o=cc._decorator,a=o.ccclass,r=(o.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.IsInit=!1,t.IsReady=!1,t}return __extends(t,e),t.prototype.start=function(){this.IsInit=!0},t.prototype.onEnable=function(){this.IsInit&&this.IsReady&&n.GameEventDispatcher.instance.emit("GuideTargetOnEnable")},t.prototype.onDisable=function(){this.IsReady&&n.GameEventDispatcher.instance.emit("GuideTargetOnDisable")},t=__decorate([a],t)}(cc.Component));i.default=r,cc._RF.pop()},{"../../Core/GameEventDispatcher":"GameEventDispatcher"}],GuideVo:[function(e,t,i){"use strict";cc._RF.push(t,"a00aeyPSvJHqoyQGZw9cPtt","GuideVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Role/RoleInfo"),o=e("../Chapter/ChapterController"),a=e("../OpenFuncTips/OpenFuncTips"),r=e("../Reel/ReelMode"),s=e("../Scene/Upgrading/CardSynthesis"),l=e("../../Core/ConfigsManager"),c=e("../Scene/View/ActorsBigSkillLayer"),d=e("../SandTable/SandTableMain"),p=e("../../Core/WindowManager"),h=e("../../Core/WindowType"),u=e("../SandTable/SandTableController"),f=cc._decorator,g=f.ccclass,y=(f.property,function(){function e(){this._config=null,this._id=0,this._vo=null,this.stepIndex=0,this.param=null}return e.prototype.setData=function(e,t){if(this.config.guidenewconf[e]){var i=this._id;this._id=0;for(var l=null,f=0;f<this.config.guidenewconf[e].length;f++){if(l=this.config.guidenewconf[e][f],-1==n.MyRoleInfo.guide.indexOf(parseInt(l.index))&&void 0!==l.condition&&l.condition==e)switch(e){case 2:case 3:case 7:case 18:case 29:case 30:case 9:o.default.instance.currentChapterId==l.param1&&o.default.instance.currentGuanqiaId==l.param2&&(this._id=parseInt(l.index));break;case 1:case 33:this._id=t||parseInt(l.index);case 8:a.default.instance&&a.default.instance.openFunData&&a.default.instance.openFunData.id==l.param1&&(this._id=parseInt(l.index));break;case 27:this.param=t,this._id=parseInt(l.index);break;case 14:s.default.instance&&s.default.instance.cardId&&s.default.instance.cardId==l.param1&&(this._id=parseInt(l.index));break;case 19:t==l.param1&&(this._id=parseInt(l.index));break;case 22:l.param1==d.default.instance._moveNum&&(this._id=parseInt(l.index),p.default.instance.isOpenWindow(h.WindowType.SandTable)&&(u.default.instance.automatic=!1,d.default.instance.openTips(0)));break;case 21:case 23:case 24:case 26:this.param=t,this._id=parseInt(l.index),p.default.instance.isOpenWindow(h.WindowType.SandTable)&&(u.default.instance.automatic=!1,d.default.instance.openTips(0));break;default:this._id=parseInt(l.index)}if(4==this.id&&0==c.default.instance.node.childrenCount&&(this._id=0),15==this.id&&(!r.MyReelData||r.MyReelData.curreellist.length<=0)&&(this._id=0),0!=this._id)break}return 0==this._id?this._id=i:i!=this._id&&(this._vo=l,this.setStepInde(0)),i!=this._id}console.log("\u6ca1\u6709\u8be5\u5f15\u5bfc\u6761\u4ef6: "+e)},e.prototype.setDataTwo=function(){if(0==this._id){for(var e=0;e<this.config.guidenewconf[1e3].length;e++){var t=this.config.guidenewconf[1e3][e];if(-1==n.MyRoleInfo.guide.indexOf(parseInt(t.index)/1e3))switch(t.condition){case 1e3:o.default.instance.currentChapterId==t.param1&&o.default.instance.currentGuanqiaId==t.param2&&(this._id=parseInt(t.index),this._vo=t)}if(0!=this._id)break}this.setStepInde(0)}},e.prototype.setStepInde=function(e){this.stepIndex=e},Object.defineProperty(e.prototype,"config",{get:function(){return this._config=l.ConfigsManager.instance.getConfigs("guideconf"),this._config},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"condition",{get:function(){return this._vo.condition},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reservewindow",{get:function(){return this._vo?this._vo.reservewindow:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"click",{get:function(){return this.curstep&&this.curstep.click||null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"call",{get:function(){return this._vo.call},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"step",{get:function(){return this.config.step[this._vo.step]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"param1",{get:function(){return this._vo.param1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"param2",{get:function(){return this._vo.param2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"saveguideid",{get:function(){return this._vo.saveguideid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"finMove",{get:function(){return this.curstep&&void 0!==this.curstep.finMovex&&void 0!==this.curstep.finMovey?new cc.Vec2(this.curstep.finMovex,this.curstep.finMovey):null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"curstep",{get:function(){return this.step&&this.step[this.stepIndex]?this.step[this.stepIndex]:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),e=__decorate([g],e)}());i.default=y,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../Chapter/ChapterController":"ChapterController","../OpenFuncTips/OpenFuncTips":"OpenFuncTips","../Reel/ReelMode":"ReelMode","../Role/RoleInfo":"RoleInfo","../SandTable/SandTableController":"SandTableController","../SandTable/SandTableMain":"SandTableMain","../Scene/Upgrading/CardSynthesis":"CardSynthesis","../Scene/View/ActorsBigSkillLayer":"ActorsBigSkillLayer"}],HalfPriceCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"e5d1448pvRFDb3ZqThd5qE5","HalfPriceCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Controller"),o=e("../../../NetConnect/NetConnet"),a=e("../../../Core/GameEventDispatcher"),r=e("../../../Core/Event"),s=e("../../../Core/WindowType"),l=e("../../Commons/RewardUtils"),c=e("../../OpenWin/OpenWinController"),d=e("../../Tips/RewardTips"),p=e("../ActivityCtrl"),h=e("../../Functionicon/FunctionIconController"),u=cc._decorator,f=u.ccclass,g=(u.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.redState=!1,t.giftState={},t.gift={},t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.start=function(){e.prototype.start.call(this),a.GameEventDispatcher.instance.on(r.EventDefiner.Activity_YunyingUP,this.serStateData,this)},t.prototype.serStateData=function(){var e=p.default.instance.data.getActivityState(s.WindowType.HalfPrice),t=p.default.instance.data.getActivityState(s.WindowType.Loop_HalfPrice);e||t?(this.isOpen=!0,this.activityId=p.default.instance.data.getYunyingId(t?s.WindowType.Loop_HalfPrice:s.WindowType.HalfPrice),this.parameter=p.default.instance.data.getYunyingInfo(this.activityId).idx,this.openDay=p.default.instance.data.getOpenDay(),this.halfpriceinfo()):h.default.instance.FuncIconHideDeal(s.WindowType.HalfPrice,!0)},t.prototype.listNotification=function(){this.addProto("halfpriceinfo",this.setSerData,this),this.addProto("halfpricereward",this.rewardPanel,this)},t.prototype.halfpriceinfo=function(){var e={cmd:"halfpriceinfo",actid:this.activityId};o.default.instance.sendProto(e)},t.prototype.setSerData=function(e){for(var t in this.giftState=e.giftState,this.gift=e.conf,this.gift)for(var i=this.gift[t].gift,n=0;n<i.length;n++)i[n].index=n;this.day=e.day,a.GameEventDispatcher.instance.emit(r.EventDefiner.HalfPriceUpdate),a.GameEventDispatcher.instance.emit(r.EventDefiner.Activity_SevenDayTargetUpdate)},t.prototype.rewardPanel=function(e){var t=l.default.instance.getItemListByServerData(e.awards);c.default.instance.openWindow(s.WindowType.RewardTips,function(){d.default.instance.setData(t)},this)},t.prototype.halfpricebuy=function(e,t){var i={cmd:"halfpricebuy",actid:this.activityId,index:e,day:t};o.default.instance.sendProto(i)},t.prototype.isCanBuy=function(e,t){if(!this.giftState[e])return!0;var i=this.giftState[e][t];return null==i||i<this.gift[e].gift[t].count},t.instance=null,t=i=__decorate([f],t)}(n.default));i.default=g,cc._RF.pop()},{"../../../Core/Controller":"Controller","../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/WindowType":"WindowType","../../../NetConnect/NetConnet":"NetConnet","../../Commons/RewardUtils":"RewardUtils","../../Functionicon/FunctionIconController":"FunctionIconController","../../OpenWin/OpenWinController":"OpenWinController","../../Tips/RewardTips":"RewardTips","../ActivityCtrl":"ActivityCtrl"}],HalfPriceGiftVo:[function(e,t,i){"use strict";cc._RF.push(t,"4ac95OSGyZMGaQX8xl75e7/","HalfPriceGiftVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){return function(e){for(var t in e)this[t]=e[t]}}();i.HalfPriceGiftVo=n,cc._RF.pop()},{}],HalfPriceItem:[function(e,t,i){"use strict";cc._RF.push(t,"b74ecfZenVEY5D3LtM3xo98","HalfPriceItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Util/Utils"),a=e("../../Item/ItemIcon"),r=e("../../../Core/Language"),s=e("./HalfPriceCtrl"),l=e("../../Commons/RewardUtils"),c=e("../../../Util/RechargeUtils"),d=e("../../../GlobalContext"),p=e("../../../Core/LoadManager"),h=e("../../../Util/RechargeConst"),u=e("../../Tips/TipsWinController"),f=cc._decorator,g=f.ccclass,y=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.curPrice=null,t.costPrice=null,t.btn=null,t.content=null,t}return __extends(t,e),t.prototype.setData=function(e,t){var i=this;this.index=t;var n=s.default.instance.giftState[t];this.btn.interactable=!!n;var c="710"+(n?0:1);this.btn.node.getChildByName("Label").getComponent(cc.Label).string=r.default.getStr(c);var h=l.default.instance.getItemList(e.rewardId);this.curPrice.string=e.curPrice+"",this.costPrice.string=e.costPrice+"",p.default.instance.loadResByType(d.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(e){if(i.content.childrenCount)for(var t in h){(n=i.content.children[t]).getComponent(a.default).ItemData(h[t],!0,h[t].count+"",!0)}else for(var t in h){var n;(n=o.default.getNodeByUrl(e,d.GlobalContext.Root+"prefab/Bag/ItemIcon")).scale=.65*n.scale,n.getComponent(a.default).ItemData(h[t],!0,h[t].count+"",!0),i.content.addChild(n)}},this)},t.prototype.send=function(){s.default.instance.halfpricebuy(this.index)},t.prototype.onClickBtn=function(){var e=this,t=s.default.instance,i=s.default.instance.gift[t.day][this.index].curPrice;u.default.instance.ShowTips(r.default.getStr("7102",i),function(){c.default.PurchaseItemOrRechage(h.RechargeTypeConst.Diamonds,i,e.send,e)},this)},__decorate([y(cc.Label)],t.prototype,"curPrice",void 0),__decorate([y(cc.Label)],t.prototype,"costPrice",void 0),__decorate([y(cc.Button)],t.prototype,"btn",void 0),__decorate([y(cc.Node)],t.prototype,"content",void 0),t=__decorate([g],t)}(n.default);i.default=m,cc._RF.pop()},{"../../../Core/Language":"Language","../../../Core/LoadManager":"LoadManager","../../../Core/Widget":"Widget","../../../GlobalContext":"GlobalContext","../../../Util/RechargeConst":"RechargeConst","../../../Util/RechargeUtils":"RechargeUtils","../../../Util/Utils":"Utils","../../Commons/RewardUtils":"RewardUtils","../../Item/ItemIcon":"ItemIcon","../../Tips/TipsWinController":"TipsWinController","./HalfPriceCtrl":"HalfPriceCtrl"}],HalfPriceWin:[function(e,t,i){"use strict";cc._RF.push(t,"d8038jXsVVAu6tqGTIw+XqR","HalfPriceWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Core/GameEventDispatcher"),a=e("../../../Core/Event"),r=e("../../Commons/ListViewCtrl"),s=e("./HalfPriceItem"),l=e("./HalfPriceCtrl"),c=e("../../Commons/Image"),d=cc._decorator,p=d.ccclass,h=d.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.listViewCtrl=null,t.img=null,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this),i.instance=this},t.prototype.show=function(){e.prototype.show.call(this),this.updateData(),o.GameEventDispatcher.instance.on(a.EventDefiner.HalfPriceUpdate,this.updateData,this),l.default.instance.halfpriceinfo(),o.GameEventDispatcher.instance.emit(a.EventDefiner.Activity_countdown,this)},t.prototype.hide=function(){e.prototype.hide.call(this),o.GameEventDispatcher.instance.on(a.EventDefiner.HalfPriceUpdate,this.updateData,this)},t.prototype.updateData=function(){var e=l.default.instance,t=e.gift[e.day].gift,i="resources/Activity/Bg/bg_1_"+(l.default.instance.openDay+1)+".png";this.img.getComponent(c.default).updateBg(i),this.setData(t)},t.prototype.setData=function(e){this.listViewCtrl.refreshItem=this.updateitem,this.listViewCtrl.refreshItemThis=this,this.listViewCtrl.initialize(e),this.listViewCtrl.scrollToLeft()},t.prototype.updateitem=function(e,t){var i=this.listViewCtrl.dataLsit[t];e.getComponent(s.default).setData(i,t)},t.instance=null,__decorate([h(r.default)],t.prototype,"listViewCtrl",void 0),__decorate([h(cc.Node)],t.prototype,"img",void 0),t=i=__decorate([p],t)}(n.default);i.default=u,cc._RF.pop()},{"../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Widget":"Widget","../../Commons/Image":"Image","../../Commons/ListViewCtrl":"ListViewCtrl","./HalfPriceCtrl":"HalfPriceCtrl","./HalfPriceItem":"HalfPriceItem"}],HelpFriendItem:[function(e,t,i){"use strict";cc._RF.push(t,"05878LGLoNAYYYJZihenxib","HelpFriendItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("./FridBossController"),a=e("./HelpFriendWin"),r=e("../Tips/OpTipsController"),s=e("../../Core/Language"),l=e("../LoadingPanel/LoadingPanel"),c=e("../Scene/Controller/SceneController"),d=e("../../Global/GlobalValue"),p=cc._decorator,h=p.ccclass,u=p.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Name=null,t.NoTime=null,t.TimeNode=null,t.TimeLabe=null,t.id=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.hide=function(){e.prototype.hide.call(this)},t.prototype.FriendHelpBtn=function(){o.default.instance.sendFridBossFri(this.id+"",!1),l.default.instance._currentPercent=0,c.default.instance.scenestatus=d.GameScene.Scene,l.default.instance.showSceneLoading(100,2500,-1),this.id==a.default.instance.userID&&r.default.instance.ShowMsg(s.default.getStr("\u5df2\u5728\u8be5\u597d\u53cb\u573a\u666f"))},__decorate([u(cc.Label)],t.prototype,"Name",void 0),__decorate([u(cc.Node)],t.prototype,"NoTime",void 0),__decorate([u(cc.Node)],t.prototype,"TimeNode",void 0),__decorate([u(cc.Label)],t.prototype,"TimeLabe",void 0),t=__decorate([h],t)}(n.default);i.default=f,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/Widget":"Widget","../../Global/GlobalValue":"GlobalValue","../LoadingPanel/LoadingPanel":"LoadingPanel","../Scene/Controller/SceneController":"SceneController","../Tips/OpTipsController":"OpTipsController","./FridBossController":"FridBossController","./HelpFriendWin":"HelpFriendWin"}],HelpFriendWin:[function(e,t,i){"use strict";cc._RF.push(t,"e589464dqhOzpMhuvJ84cA9","HelpFriendWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("./FridBossController"),a=e("./FridBossWin"),r=e("../Commons/MonsterPreview"),s=e("../Gamelayer/RoleHead"),l=e("../../Core/Language"),c=e("../../Core/GameEventDispatcher"),d=e("../../Core/Event"),p=e("../../Global/GlobalValue"),h=e("./HelpFriendItem"),u=e("../Role/RoleInfo"),f=e("../Tips/OpTipsController"),g=e("../../GlobalContext"),y=e("../../Core/CommonsResManager"),m=e("../../Core/TimeController"),C=cc._decorator,v=C.ccclass,_=C.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.CountDown=null,t.AttrList=null,t.HelpList=null,t.Content=null,t.Prefab=null,t.boxWin=null,t.timeOut=null,t.monsterinfo=null,t.isplayact=!1,t.attrlistarr={},t.userID=null,t.guanqiaID=null,t.chooseNode=null,t.FriendroleHeand=null,t.Friendname=null,t.FriendlastTime=null,t.isFriend=!1,t.isFrist=!1,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){i.instance=this;for(var e=0;e<this.AttrList.childrenCount;e++){var t=this.AttrList.children[e];this.attrlistarr[e]={sca:t.scale,posi:t.getPosition(),index:e}}},t.prototype.onEnable=function(){console.log("\u662f\u5426\u597d\u53cb\u754c\u9762\u8fdb\u5165\u7684\u6218\u6597\u573a\u666f",this.isFriend),this.isFriend&&o.default.instance.sendFridBossFri(this.userID+"",!1),c.GameEventDispatcher.instance.on(d.EventDefiner.HelpFriendFight,this.friendInitSecene,this),c.GameEventDispatcher.instance.on(d.EventDefiner.FriendBossFriend,this.InitLeftList,this)},t.prototype.onDisable=function(){c.GameEventDispatcher.instance.off(d.EventDefiner.HelpFriendFight,this.friendInitSecene,this),c.GameEventDispatcher.instance.off(d.EventDefiner.FriendBossFriend,this.InitLeftList,this),console.log(this.userID,"onDisable")},t.prototype.friendInitSecene=function(){var e=this;console.log("\u8fdb\u5165\u597d\u53cb\u573a\u666f\uff0cID\u4e3a\uff1a",this.userID),this.HelpList.x=g.GlobalContext.UIWidth/2-this.HelpList.width/2;var t=0;t=1==this.isFriend?0:2800;var i=m.default.instance.setTimeout(function(){a.default.instance.RightNode.active=!1,e.boxWin.active=!1,e.HelpList.active=!0,e.CountDown.active=!1,u.MyRoleInfo.vipLevel?(cc.find("MyNode/Layout/vipImg/vipLev",e.HelpList).active=!0,cc.find("MyNode/Layout/vipImg/vipLev",e.HelpList).getComponent(cc.Label).string=u.MyRoleInfo.vipLevel+""):cc.find("MyNode/Layout/vipImg/vipLev",e.HelpList).active=!1,e.HelpList.getChildByName("MyNode").getChildByName("Layout").getChildByName("Name").getComponent(cc.Label).string=e.Friendname,e.HelpList.getChildByName("MyNode").getChildByName("RoleHead").getComponent(s.default).SetHead(e.FriendroleHeand),e.HelpList.getChildByName("MyNode").getChildByName("time").getComponent(cc.Label).string=e.FriendlastTime,e.monsterinfo=o.default.instance.getMonterinfo();for(var t=0;t<e.AttrList.childrenCount;t++){var n=e.AttrList.getChildByName("downstage"+(t+1));n.index_td_num||0==n.index_td_num||(n.attr({index_td_num:t}),console.log("\u8282\u70b9\u521d\u59cb\u4f4d\u7f6e:"+t));var l=n.index_td_num;if(n.off("touchstart",a.default.instance.setDownstageposi,e),n.getChildByName("SecondBtn1").active=!0,n.getChildByName("MonsterPreview").active=!1,null==o.default.instance.FriendInfo[t]||void 0==o.default.instance.FriendInfo[t])switch(n.getChildByName("MonsterPreview").active=!0,n.getChildByName("MonsterPreview").getComponent(r.default).init("monster",e.monsterinfo[t].id,e.monsterinfo[t].grade,p.DEFAULTS_SKIN+"5"),n.getChildByName("MonsterPreview").setScale(.8),n.getChildByName("SecondBtn3").active=!0,n.getChildByName("SecondBtn1").active=!1,n.getChildByName("rune").active=!0,n.getChildByName("Light").active=!1,n.getChildByName("SecondBtn3").active=!0,n.getChildByName("Five").active=!0,e.monsterinfo[t].attribute){case 1:n.getChildByName("Five").getComponent(cc.Sprite).spriteFrame=y.default.instance.getSpriteFrameByName("fiveLine_1");break;case 2:n.getChildByName("Five").getComponent(cc.Sprite).spriteFrame=y.default.instance.getSpriteFrameByName("fiveLine_2");break;case 3:n.getChildByName("Five").getComponent(cc.Sprite).spriteFrame=y.default.instance.getSpriteFrameByName("fiveLine_3");break;case 4:n.getChildByName("Five").getComponent(cc.Sprite).spriteFrame=y.default.instance.getSpriteFrameByName("fiveLine_4");break;case 5:n.getChildByName("Five").getComponent(cc.Sprite).spriteFrame=y.default.instance.getSpriteFrameByName("fiveLine_5")}else{n.getChildByName("Light").active=!0,n.getChildByName("MonsterPreview").active=!1,n.getChildByName("rune").active=!1,n.getChildByName("Light").getChildByName("RoleHead").getComponent(s.default).SetHead(o.default.instance.FriendInfo[t].icon);var c=o.default.instance.FriendInfo[l].name.length>6?o.default.instance.FriendInfo[t].name.substr(0,6)+"...":o.default.instance.FriendInfo[t].name;n.getChildByName("Light").getChildByName("nameDown").getComponentInChildren(cc.Label).string=c,n.getChildByName("SecondBtn1").getComponent(cc.Button).clickEvents[0].customEventData="0",n.getChildByName("SecondBtn1").active=!1,n.getChildByName("SecondBtn2").active=!1,n.getChildByName("SecondBtn3").active=!1,n.getChildByName("Five").active=!1}}m.default.instance.clearTimeout(i)},this,t);this.isFrist=!0},t.prototype.InitLeftList=function(){this.Content.destroyAllChildren();for(var e=o.default.instance.friendBossInfo,t=0;t<e.length;t++){var i=cc.instantiate(this.Prefab);this.SetItemInfo(i,e[t].icon,e[t].name,e[t].remainnum,e[t].friendid),this.Content.addChild(i)}},t.prototype.SetItemInfo=function(e,t,i,n,o){var a=e.getComponent(h.default);e.getChildByName("RoleHead").getComponent("RoleHead").SetHead(t),a.Name.string=i,a.id=o,0==n?(a.NoTime.active=!0,a.TimeNode.active=!1):(a.TimeNode.active=!0,a.NoTime.active=!1,a.TimeLabe.string=l.default.getStr("BossNum",n))},t.prototype.setDownstageposi=function(e,t){var i=e?e.target.getSiblingIndex():parseInt(t);if(console.log(i),!this.isplayact){this.isplayact=!0;var n={};if(i>2)for(var o=0;o<this.AttrList.childrenCount;o++){n[o]=[];for(var a=1;a<=5-i;a++){(r=a+o)>=5&&(r-=5),n[o].push(this.attrlistarr[r])}}else for(o=0;o<this.AttrList.childrenCount;o++){n[o]=[];for(a=1;a<=i;a++){var r;(r=o-a)<0&&(r+=5),n[o].push(this.attrlistarr[r])}}this.switchposi(n)}},t.prototype.switchposi=function(e){var t=this,i=function(n,o){o.stopAllActions();if(void 0!=e[n][0]){var a=cc.sequence(cc.spawn(cc.scaleTo(.5,e[n][0].sca),cc.moveTo(.5,e[n][0].posi)),cc.callFunc(function(){o.setPosition(e[n][0].posi),o.setScale(e[n][0].sca);e[n].shift();e[n].length>0&&i(n,o)},t));a.setTag(n),o.runAction(a)}};for(var n in e){this.isplayact=!1;var o=parseInt(n),a=this.AttrList.children[o];i(o,a)}},t.prototype.FightBtn=function(e){this.chooseNode=e.target,this.guanqiaID=this.monsterinfo[this.chooseNode.parent.index_td_num].guanqia;for(var t=[],i=0;i<5;i++)o.default.instance.fightcount.state[i]||t.push(i+1);if(0!=t.length){o.default.instance.ChooseTotem=this.chooseNode.parent.index_td_num+1;var n=!1;if(t.length<=0||1==t.length&&0==o.default.instance.fightcount.friendFight)f.default.instance.ShowMsg(l.default.getStr("ChallengeLiit"));else{for(var a=0,r=o.default.instance.fightcount.state;a<r.length;a++){var s=r[a];if(s&&s.userId==u.MyRoleInfo.id){n=!0;break}n=!1}n?f.default.instance.ShowMsg(l.default.getStr("\u4eca\u5929\u5df2\u7ecf\u5e2e\u52a9\u8fc7\u4ed6\u4e86\uff0c\u660e\u5929\u518d\u6765\u5427")):(o.default.instance.guanQiaID=this.guanqiaID,o.default.instance.PermitEnter(this.userID),o.default.instance.IsFriend=!0,this.isFriend=!0)}}else console.log("\u5df2\u67095\u4e2a\u597d\u53cb\u5e2e\u52a9\uff0c\u4e0d\u9700\u8981")},t.instance=null,__decorate([_(cc.Node)],t.prototype,"CountDown",void 0),__decorate([_(cc.Node)],t.prototype,"AttrList",void 0),__decorate([_(cc.Node)],t.prototype,"HelpList",void 0),__decorate([_(cc.Node)],t.prototype,"Content",void 0),__decorate([_(cc.Prefab)],t.prototype,"Prefab",void 0),__decorate([_(cc.Node)],t.prototype,"boxWin",void 0),t=i=__decorate([v],t)}(n.default);i.default=b,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../Commons/MonsterPreview":"MonsterPreview","../Gamelayer/RoleHead":"RoleHead","../Role/RoleInfo":"RoleInfo","../Tips/OpTipsController":"OpTipsController","./FridBossController":"FridBossController","./FridBossWin":"FridBossWin","./HelpFriendItem":"HelpFriendItem"}],HelpFriendsWin:[function(e,t,i){"use strict";cc._RF.push(t,"d267cuLywJJNapIfrkYS/LT","HelpFriendsWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/GameEventDispatcher"),a=e("../../Core/Event"),r=e("./FridBossController"),s=e("./FriendBossItem"),l=e("../../Core/Language"),c=e("../../Util/GrayEffect"),d=cc._decorator,p=d.ccclass,h=d.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=null,t.item=null,t.helpTimes=null,t.arry=[],t.itemArry=[],t}var i;return __extends(t,e),i=t,t.prototype.show=function(){e.prototype.show.call(this),i.instance=this,o.GameEventDispatcher.instance.on(a.EventDefiner.FriendBossFriend,this.Info,this)},t.prototype.hide=function(){e.prototype.hide.call(this),this.content.destroyAllChildren(),this.arry=[],o.GameEventDispatcher.instance.off(a.EventDefiner.FriendBossFriend,this.Info,this)},t.prototype.Info=function(){this.arry=[],this.content.destroyAllChildren(),this.arry=r.default.instance.friendBossInfo,this.helpTimes.string=r.default.instance.FriendBossTimes+" / 5";for(var e=0;e<this.arry.length;e++){var t=cc.instantiate(this.item);this.setInfo(t,this.arry[e].icon,this.arry[e].name,this.arry[e].gender,this.arry[e].helpnum,this.arry[e].remainnum,this.arry[e].helpself,this.arry[e].friendid,this.arry[e].helptimestamp,this.arry[e].online),this.itemArry.push(t)}for(var i=[],n=0;n<this.itemArry.length;n++)1==this.itemArry[n].getComponent(s.default).isLine&&0!=Number(this.itemArry[n].getComponent(s.default).TimesLabe.string)&&(i.push(this.itemArry[n]),this.itemArry.splice(n,1),n--);for(var o=0;o<this.itemArry.length;o++)i.push(this.itemArry[o]),this.itemArry.splice(o,1),o--;this.itemArry=[];for(var a=0;a<i.length;a++)this.content.addChild(i[a])},t.prototype.setInfo=function(e,t,i,n,o,a,d,p,h,u){var f=e.getComponent(s.default);switch(e.getChildByName("RoleHead").getComponent("RoleHead").SetHead(t),f.roleHande=t,f.IDLabe.string=i,f.id=p,f.time=h,f.isLine=u,n){case 0:f.Man.active=!0,f.Woman.active=!1;break;case 1:f.Man.active=!1,f.Woman.active=!0}f.TimesLabe.string=o+"",0==a?(f.GrayBossTimes.active=!0,f.GreenBossTimes.active=!1):(f.GrayBossTimes.active=!1,f.GreenBossTimes.active=!0,f.BossTimes.string=l.default.getStr("BossNum",a)),f.IsHelpForYou.active=1==d,1==r.default.instance.isSeekHelp?(f.RefuseBtn.active=!0,f.seekHelpBtn.active=!1):(f.RefuseBtn.active=!1,f.seekHelpBtn.active=!0);var g=e.getChildByName("RoleHead").addComponent(c.default);1==u?g.setGray(!1):g.setGray(!0)},t.prototype.closeNode=function(){this.node.active=!1},t.instance=null,__decorate([h(cc.Node)],t.prototype,"content",void 0),__decorate([h(cc.Prefab)],t.prototype,"item",void 0),__decorate([h(cc.Label)],t.prototype,"helpTimes",void 0),t=i=__decorate([p],t)}(n.default);i.default=u,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/Widget":"Widget","../../Util/GrayEffect":"GrayEffect","./FridBossController":"FridBossController","./FriendBossItem":"FriendBossItem"}],HighLadderController:[function(e,t,i){"use strict";cc._RF.push(t,"09747yxCfNHcKH+kzrNRKBS","HighLadderController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("./HighLadderData"),a=e("../../Core/GameEventDispatcher"),r=e("../../Core/Event"),s=e("../WarTeam/MonsterController"),l=e("../../Core/ConfigsManager"),c=e("../Commons/RewardUtils"),d=e("../../NetConnect/NetConnet"),p=cc._decorator,h=p.ccclass,u=(p.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.MyFigh=0,t._skillArr=[],t}var i;return __extends(t,e),i=t,t.prototype.start=function(){},t.prototype.listNotification=function(){i.instance=this,this._config=l.ConfigsManager.instance.getConfigs("highladderconf"),this.rankingReward=this._config.Ranking[1],this.addProto("ladderimage",this.InitImage,this),this.addProto("ladderrace",this.InitRace,this),this.addProto("ladderrank",this.InitRank,this),this.addProto("ladderrival",this.RivalInfo,this),this.addProto("lrrankdiff",this.ChangeRanking,this),this.addProto("lrrewardid",this.onGetRewardInfo,this),this.addProto("lrfightrecord",this.ChangeRecord,this),this.addProto("ladderfight",this.myFight,this),this.addProto("rivalfighting",this.IsChange,this),this.addProto("ladderrankdiff",this.rankChange,this),this.addProto("ladderskill",this.ladderSkill,this),this.getHighLadderSkill()},t.prototype.sendCmdBuyChallenge=function(){d.default.instance.sendProto({cmd:"lrtimes"})},t.prototype.sendCmdSetSquad=function(){d.default.instance.sendProto({cmd:"lrsetimage"})},t.prototype.sendCmdChallenge=function(e,t){var i={cmd:"lrfight",rivalid:e,rank:t};d.default.instance.sendProto(i)},t.prototype.sendCmdGetReward=function(){d.default.instance.sendProto({cmd:"lrreward"})},t.prototype.getHighLadderSkill=function(){var e=this._config.skill[1];for(var t in e)this._skillArr.push(e[t])},Object.defineProperty(t.prototype,"getLadderSkill",{get:function(){return this._skillArr},enumerable:!0,configurable:!0}),t.prototype.getRankingReward=function(e){var t,i,n;for(var o in this.rankingReward)if(t=this.rankingReward[o].minRank,i=this.rankingReward[o].rank,t<=e&&e<=i){n=c.default.instance.getItemList(this.rankingReward[o].reward);break}return n},t.prototype.InitImage=function(e){o.SelfHighLadderData.Lineup=e.image,a.GameEventDispatcher.instance.emit(r.EventDefiner.SelfLadderInfo)},t.prototype.myFight=function(e){o.SelfHighLadderData.fight=e.totalfight,a.GameEventDispatcher.instance.emit(r.EventDefiner.SelfLadderInfo)},t.prototype.Calculation=function(){var e=0,t=[{skillid:o.SelfHighLadderData.skill.id,skilllv:o.SelfHighLadderData.skill.level}];if(o.SelfHighLadderData.Lineup&&0!=o.SelfHighLadderData.Lineup.length){if(0!=o.SelfHighLadderData.Lineup.length){for(var i=s.default.instance.getServerListChangeBattleList(o.SelfHighLadderData.Lineup),n=0;n<i.length;n++)e+=s.default.instance.getCarFight(i[n].cardid,i[n].level,i[n].grade,!0,t)*i[n].count;this.MyFigh=e}}else this.MyFigh=0},t.prototype.InitRace=function(e){o.SelfHighLadderData.num=e.times,o.SelfHighLadderData.buynum=e.buytimes,a.GameEventDispatcher.instance.emit(r.EventDefiner.SelfLadderInfo)},t.prototype.InitRank=function(e){o.SelfHighLadderData.ranking=e.rank,a.GameEventDispatcher.instance.emit(r.EventDefiner.SelfLadderInfo)},t.prototype.RivalInfo=function(e){o.SelfHighLadderData.otherinfo=e.rival,a.GameEventDispatcher.instance.emit(r.EventDefiner.RivalLadderInfo)},t.prototype.ChangeRanking=function(){a.GameEventDispatcher.instance.emit(r.EventDefiner.RankingChange)},t.prototype.onGetRewardInfo=function(e){o.SelfHighLadderData.selfranking=e.rank,o.SelfHighLadderData.reward=e.reward,a.GameEventDispatcher.instance.emit(r.EventDefiner.RankingRewardInfo)},t.prototype.ChangeRecord=function(e){o.SelfHighLadderData.ChangeRecord=e.record,a.GameEventDispatcher.instance.emit(r.EventDefiner.ChangeRecord)},t.prototype.IsChange=function(e){a.GameEventDispatcher.instance.emit("ISCHANGE",this)},t.prototype.rankChange=function(e){a.GameEventDispatcher.instance.emit("RANKCHANGE",this)},t.prototype.ladderSkill=function(e){o.SelfHighLadderData.skill=e.skill,a.GameEventDispatcher.instance.emit("LADDERSKILL")},t.instance=null,t=i=__decorate([h],t)}(n.default));i.default=u,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../NetConnect/NetConnet":"NetConnet","../Commons/RewardUtils":"RewardUtils","../WarTeam/MonsterController":"MonsterController","./HighLadderData":"HighLadderData"}],HighLadderData:[function(e,t,i){"use strict";cc._RF.push(t,"9e30edko6BDJIw/fSV6Ci1R","HighLadderData"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){return function(){this.ranking=0,this.fight=0,this.num=0,this.buynum=0,this.selfranking=0}}();i.HighLadderData=n,i.SelfHighLadderData=new n,cc._RF.pop()},{}],HighLadderFightingWin:[function(e,t,i){"use strict";cc._RF.push(t,"ff8d2qLp49H1KQGTUTCCGSI","HighLadderFightingWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../../Core/GameEventDispatcher"),a=e("../../Core/WindowType"),r=e("../SandTable/SandTableMain"),s=e("../Scene/Controller/SceneController"),l=e("../Status/StatusController"),c=e("../OpenWin/OpenWinController"),d=e("../../Core/Language"),p=e("../../GlobalContext"),h=e("../Activity/ActivityController"),u=e("../Tips/TipsWinController"),f=cc._decorator,g=f.ccclass,y=(f.property,function(e){function t(){var t=e.call(this)||this;return i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),o.GameEventDispatcher.instance.on("CloseSetSand",this.onAgressBtn,this),cc.find("Back Button",this.node).setPosition(-p.GlobalContext.UIWidth/2+cc.find("Back Button",this.node).height/2,-p.GlobalContext.UIHeight/2-cc.find("Back Button",this.node).height/2+150)},t.prototype.hide=function(){e.prototype.hide.call(this),h.default.instance.isSetSandTab=!1,o.GameEventDispatcher.instance.off("CloseSetSand",this.onAgressBtn,this)},t.prototype.onImageBackBtn=function(){c.default.instance.openWindow(a.WindowType.LadderFighTips)},t.prototype.onBackBtn=function(){u.default.instance.ShowTips(d.default.getStr("Ladder_5"),this.onAgressBtn,this,[],1,d.default.getStr("Ladder_6"),d.default.getStr("Ladder_7"),function(){},this,[])},t.prototype.onAgressBtn=function(){s.default.instance.clearAll(),r.default.instance.close(),l.default.instance.activityStatusHandle(),this.close()},t.instance=null,t=i=__decorate([g],t)}(n.default));i.default=y,cc._RF.pop()},{"../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/Window":"Window","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../Activity/ActivityController":"ActivityController","../OpenWin/OpenWinController":"OpenWinController","../SandTable/SandTableMain":"SandTableMain","../Scene/Controller/SceneController":"SceneController","../Status/StatusController":"StatusController","../Tips/TipsWinController":"TipsWinController"}],HighLadderReward:[function(e,t,i){"use strict";cc._RF.push(t,"94693EiPPpKJawmbDKJot0R","HighLadderReward"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./HighLadderData"),o=e("../../Core/CommonsResManager"),a=e("../../Core/Language"),r=e("../Gamelayer/RoleHead"),s=e("../Fight/staticattr"),l=e("../Commons/CommonPageBG"),c=e("../../Util/DateUtil"),d=e("../Commons/ListViewCtrl"),p=cc._decorator,h=p.ccclass,u=p.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.highladderAtlas=null,t.listViewCtrl=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.onInit(911,658,a.default.getStr("Ladder_11"),!0),i.instance=this},t.prototype.show=function(){e.prototype.show.call(this),this.listViewCtrl.refreshItem=this.ScrollInfo,this.listViewCtrl.refreshItemThis=this,this.listViewCtrl.initialize(n.SelfHighLadderData.ChangeRecord)},t.prototype.ScrollInfo=function(e,t){var i=new s.StaticAttr,l=n.SelfHighLadderData.ChangeRecord[t].fight;for(var d in e.x=435,n.SelfHighLadderData.ChangeRecord[t].attr)i.Push(parseInt(d),n.SelfHighLadderData.ChangeRecord[t].attr[d]);e.getChildByName("RankLabe").getComponent(cc.Label).string=a.default.getStr("Ladder_8")+n.SelfHighLadderData.ChangeRecord[t].rank,e.getChildByName("RoleHead").getComponent(r.default).SetHead(n.SelfHighLadderData.ChangeRecord[t].icon),e.getChildByName("Name").getComponent(cc.Label).string=n.SelfHighLadderData.ChangeRecord[t].name,e.getChildByName("RankChange").getComponent(cc.Label).string=n.SelfHighLadderData.ChangeRecord[t].rankchangevalue,e.getChildByName("fightBase").getComponentInChildren(cc.Label).string=l+i.GetFight()+"",e.getChildByName("sex").getComponent(cc.Sprite).spriteFrame=o.default.instance.getSpriteFrameByName("gender_"+n.SelfHighLadderData.ChangeRecord[t].gender),e.getChildByName("timeLabe").getComponent(cc.Label).string=c.DateUtil.timeSecondsToChineseDate2(n.SelfHighLadderData.ChangeRecord[t].time)+" "+c.DateUtil.getYMDHM(n.SelfHighLadderData.ChangeRecord[t].time),n.SelfHighLadderData.ChangeRecord[t].challenge?(e.getChildByName("stateIcon").getComponent(cc.Sprite).spriteFrame=o.default.instance.getSpriteFrameByName("icon_shanghai1"),e.getChildByName("stateText").getComponent(cc.Sprite).spriteFrame=this.highladderAtlas.getSpriteFrame("i18n_jg")):(e.getChildByName("stateIcon").getComponent(cc.Sprite).spriteFrame=o.default.instance.getSpriteFrameByName("icon_shanghai1"),e.getChildByName("stateText").getComponent(cc.Sprite).spriteFrame=this.highladderAtlas.getSpriteFrame("i18n_fs")),"win"==n.SelfHighLadderData.ChangeRecord[t].fightresult?(e.getChildByName("stateBase").getComponent(cc.Sprite).spriteFrame=this.highladderAtlas.getSpriteFrame("bg_tianti11"),e.getChildByName("stateImage").getComponent(cc.Sprite).spriteFrame=this.highladderAtlas.getSpriteFrame("i18n_sl"),e.getChildByName("stateArrows").getComponent(cc.Sprite).spriteFrame=this.highladderAtlas.getSpriteFrame("icon_shangcheng"),e.getChildByName("RankChange").color=cc.color(122,255,62),e.getChildByName("RankChange").getComponent(cc.LabelOutline).color=cc.color(27,99,14)):(e.getChildByName("stateBase").getComponent(cc.Sprite).spriteFrame=this.highladderAtlas.getSpriteFrame("bg_tianti10"),e.getChildByName("stateImage").getComponent(cc.Sprite).spriteFrame=this.highladderAtlas.getSpriteFrame("i18n_sb"),e.getChildByName("stateArrows").getComponent(cc.Sprite).spriteFrame=this.highladderAtlas.getSpriteFrame("icon_xiajian"),e.getChildByName("RankChange").color=cc.color(255,0,0),e.getChildByName("RankChange").getComponent(cc.LabelOutline).color=cc.color(83,0,0))},t.prototype.hide=function(){e.prototype.hide.call(this)},t.instance=null,__decorate([u(cc.SpriteAtlas)],t.prototype,"highladderAtlas",void 0),__decorate([u(d.default)],t.prototype,"listViewCtrl",void 0),t=i=__decorate([h],t)}(l.default);i.default=f,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Language":"Language","../../Util/DateUtil":"DateUtil","../Commons/CommonPageBG":"CommonPageBG","../Commons/ListViewCtrl":"ListViewCtrl","../Fight/staticattr":"staticattr","../Gamelayer/RoleHead":"RoleHead","./HighLadderData":"HighLadderData"}],HighLadderSkill:[function(e,t,i){"use strict";cc._RF.push(t,"e1d9e9AYrxMiYSqydY26gJh","HighLadderSkill"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./HighLadderData"),o=e("../../Core/Language"),a=e("../WarTeam/MonsterController"),r=e("../Commons/CommonPageBG"),s=e("../../Core/GameEventDispatcher"),l=e("../Scene/Controller/SkillController"),c=cc._decorator,d=c.ccclass,p=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.icon=null,t.laber=null,t.time=null,t.skillName=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.onInit(647,403,o.default.getStr("Ladder_17"),!0),i.instance=this},t.prototype.show=function(){e.prototype.show.call(this),s.GameEventDispatcher.instance.on("LADDERSKILL",this.init,this),this.init()},t.prototype.hide=function(){e.prototype.hide.call(this),s.GameEventDispatcher.instance.off("LADDERSKILL",this.init,this)},t.prototype.init=function(){var e=n.SelfHighLadderData.skill,t=this.icon.getComponent(cc.Sprite);a.default.instance.setSkillPic(e.id,t),this.laber.string=l.default.instance.getSkillDescBySkillIdAndLv(e.id,e.level),this.time.string="<color=#5c3c34>\u6709\u6548\u671f\u81f3:</c><color=#07a044>"+this.setTime(e.time)+"</color>",this.skillName.string=l.default.instance.getSkillBySkillId(e.id).name},t.prototype.setTime=function(e){var t=new Date(e);return t.getMonth()+1+"\u6708"+t.getDate()+"\u65e5"},t.instance=null,__decorate([p(cc.Node)],t.prototype,"icon",void 0),__decorate([p(cc.Label)],t.prototype,"laber",void 0),__decorate([p(cc.RichText)],t.prototype,"time",void 0),__decorate([p(cc.Label)],t.prototype,"skillName",void 0),t=i=__decorate([d],t)}(r.default);i.default=h,cc._RF.pop()},{"../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../Commons/CommonPageBG":"CommonPageBG","../Scene/Controller/SkillController":"SkillController","../WarTeam/MonsterController":"MonsterController","./HighLadderData":"HighLadderData"}],HighLadderWin:[function(e,t,i){"use strict";cc._RF.push(t,"07662wQIP9GM6WFGEEjSxhP","HighLadderWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/GameEventDispatcher"),o=e("../../Core/Event"),a=e("../../NetConnect/NetConnet"),r=e("../../Core/Window"),s=e("../../Core/WindowManager"),l=e("../../Core/WindowType"),c=e("../../Global/GlobalValue"),d=e("../Shop/ShopModel"),p=e("./HighLadderData"),h=e("../WarTeam/MonsterController"),u=e("../Commons/MonsterPreview"),f=e("../../Util/Utils"),g=e("../Role/RoleInfo"),y=e("../../Core/TimeController"),m=e("../../Core/ConfigsManager"),C=e("./HighLadderController"),v=e("../SandTable/SandTableController"),_=e("../OpenWin/OpenWinController"),b=e("../../GlobalContext"),T=e("../../Core/Language"),S=e("./ChallengePlayer"),I=e("../Tips/OpTipsController"),w=e("../../Core/LoadManager"),D=e("../Status/StatusType"),R=e("../Activity/ActivityController"),A=e("../../Util/RechargeUtils"),N=e("../Shop/ShopController"),L=e("../Shop/ShopConst"),E=e("../../Util/RechargeConst"),B=e("../../Util/NumberUtil"),M=e("../Guide/GuideNewController"),x=e("../Scene/Controller/SkillController"),k=e("../Tips/TipsWinController"),P=e("../RankingList/RankListCtrl"),G=cc._decorator,F=G.ccclass,W=G.property,U=function(e){function t(){var t=e.call(this)||this;return t.MyRankingNumber=null,t.MyFighNumer=null,t.MyChangeNumber=null,t.TimeCountDown=null,t.TarNum=null,t.Content=null,t.Layout=null,t.translateNum=null,t.leftNode=null,t.skillIcon=null,t.skillNameLabe=null,t.timeLabe=null,t.challengePrefab=null,t.teamBtn=null,t.setTeamBtn=null,t.w=null,t._configs=null,t.time=10,t.Price=0,t.RangingChange=!1,t.Is_Fight=!1,t.Player=0,t.Key=0,t.isReward=!1,t.lastRank=0,t.countDown=null,i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){this.onInit(l.WindowType.HighLadderWin,!0),e.prototype.onLoad.call(this),this._configs=m.ConfigsManager.instance.getConfigs("highladderconf"),this.onGetPlayerInfo(),cc.find("MySelfInfo/Label",this.Content).getComponent(cc.Label).string=T.default.getStr("Ladder_1"),cc.find("Top/TextBG/Ladder",this.Content).getComponent(cc.Label).string=T.default.getStr("Ladder_2"),n.GameEventDispatcher.instance.emit(o.EventDefiner.ChangeActivityStatus,D.ActivityStatus.HighLadder)},t.prototype.show=function(){e.prototype.show.call(this),this.List=p.SelfHighLadderData.otherinfo,this.onGetPlayerInfo(),this.RandomOtherPlayerInfo(),this.onGetInfo(),this.showTranslate(),-1!=g.MyRoleInfo.guide.indexOf(16)&&M.default.instance.checkCondition(31),this.Content.getChildByName("itembg").x=b.GlobalContext.UIWidth/2-this.Content.children[1].width/2+80,this.Content.getChildByName("Top").x=b.GlobalContext.UIWidth/2-this.Content.children[3].children[0].width/2-200,n.GameEventDispatcher.instance.on(o.EventDefiner.SelfLadderInfo,this.onGetPlayerInfo,this),n.GameEventDispatcher.instance.on(o.EventDefiner.RivalLadderInfo,this.RandomOtherPlayerInfo,this),n.GameEventDispatcher.instance.on(o.EventDefiner.RankingChange,this.onRankingChange,this),n.GameEventDispatcher.instance.on(o.EventDefiner.ChangeRecord,this.changeRecord,this),n.GameEventDispatcher.instance.on("ISCHANGE",this.ChangeReturn,this),n.GameEventDispatcher.instance.on("RANKCHANGE",this.RankChangeReturn,this);var t=p.SelfHighLadderData.skill;this.timeOut(t);var i=this.skillIcon.getComponent(cc.Sprite);h.default.instance.setSkillPic(t.id,i),this.skillNameLabe.string=x.default.instance.getSkillBySkillId(t.id).name},t.prototype.hide=function(){e.prototype.hide.call(this),n.GameEventDispatcher.instance.off(o.EventDefiner.SelfLadderInfo,this.onGetPlayerInfo,this),n.GameEventDispatcher.instance.off(o.EventDefiner.RivalLadderInfo,this.RandomOtherPlayerInfo,this),n.GameEventDispatcher.instance.off(o.EventDefiner.RankingChange,this.onRankingChange,this),n.GameEventDispatcher.instance.off(o.EventDefiner.ChangeRecord,this.changeRecord,this),n.GameEventDispatcher.instance.off("ISCHANGE",this.ChangeReturn,this),n.GameEventDispatcher.instance.off("RANKCHANGE",this.RankChangeReturn,this),this.countDown&&clearInterval(this.countDown)},t.prototype.showTranslate=function(){this.translateNum.string=B.NumberUtil.getNumber(g.MyRoleInfo.honor)},t.prototype.onGetPlayerInfo=function(){for(var e in C.default.instance.Calculation(),this.MyRankingNumber.string=T.default.getStr("Ladder_1")+p.SelfHighLadderData.ranking,p.SelfHighLadderData.Lineup&&0==p.SelfHighLadderData.Lineup.length?(this.MyFighNumer.node.parent.parent.active=!1,this.MyRankingNumber.node.parent.children[2].active=!0):(this.MyFighNumer.node.parent.parent.active=!0,this.MyRankingNumber.node.parent.children[2].active=!1,p.SelfHighLadderData.Lineup?(this.MyFighNumer.string=B.NumberUtil.getNumberW(C.default.instance.MyFigh+g.MyRoleInfo.Fight),this.w.active=(C.default.instance.MyFigh+g.MyRoleInfo.Fight+"").length>=5):this.MyFighNumer.string="0"),this.MyChangeNumber.string=p.SelfHighLadderData.num+"",this._configs.LadderRaceConf)this.Key=parseInt(e),this.TarNum.string=this.Key+"";p.SelfHighLadderData.Lineup&&0!=p.SelfHighLadderData.Lineup.length?(this.setTeamBtn.active=!1,this.teamBtn.active=!0):(this.setTeamBtn.active=!0,this.teamBtn.active=!1)},t.prototype.RandomOtherPlayerInfo=function(){var e;this.List=p.SelfHighLadderData.otherinfo;for(var t=0;t<this.List.length;t++)for(var i=t+1;i<this.List.length;i++)this.List[t].rank>this.List[i].rank&&(e=this.List[t],this.List[t]=this.List[i],this.List[i]=e);this.GetOtherPlayerInfo(this.List)},t.prototype.GetOtherPlayerInfo=function(e){var t=this,i=this;f.default.setNodeChildDestoryByUrl(i.Layout,b.GlobalContext.Root+"prefab/Ladder/LadderItem"),w.default.instance.loadResByType(b.GlobalContext.Root+"prefab/Ladder/LadderItem",cc.Prefab,function(n){t.challengePrefab=n;var o=0;for(o=p.SelfHighLadderData.Lineup&&0!=p.SelfHighLadderData.Lineup.length&&p.SelfHighLadderData.ranking<=10?0:3;o<e.length;o++){var a=f.default.getNodeByUrl(t.challengePrefab,"prefab/Ladder/LadderItem");a.name="challengePrefab"+o,a.getComponent(S.default).info=e[o],a.getComponent(S.default).index=Number(o),a.getComponent(S.default).show(),i.Layout.addChild(a)}t.Layout.parent.getComponent(cc.ScrollView).scrollToTop(.1)},this);for(var n=0;n<this.leftNode.childrenCount;n++){var o=this.leftNode.children[n].getChildByName("Up").getChildByName("monster");this.leftNode.children[n].getChildByName("Up").getChildByName("title").getChildByName("Name").getComponent(cc.Label).string=e[n].name;var a=null;o.childrenCount||(a=f.default.getNodeByPool(l.PoolType.MonsterPreview,h.default.instance.MonsterPreview),o.addChild(a)),o.scale=1,105!=e[n].model&&106!=e[n].model&&205!=e[n].model&&206!=e[n].model||(o.scale=.8),o.getComponentInChildren(u.default).init("role",e[n].model,1,c.DEFAULTS_SKIN+1,c.PRIORITY.MONSTER)}},t.prototype.ChangeReturn=function(){I.default.instance.ShowMsg(T.default.getStr("Ladder_13"))},t.prototype.RankChangeReturn=function(){I.default.instance.ShowMsg(T.default.getStr("Ladder_15"))},t.prototype.onChange=function(){if(0==this.TimeCountDown.node.active){this.TimeCountDown.node.active=!0,cc.find("MainContent/ChangeBtn",this.node).getComponent(cc.Button).enableAutoGrayEffect=!0,cc.find("MainContent/ChangeBtn",this.node).getComponent(cc.Button).interactable=!1,this.TimeCountDown.string=this.time+"",this.schedule(this.Count,1);a.default.instance.sendProto({cmd:"lrrefresh"})}},t.prototype.Count=function(){if(0==this.time)return this.unschedule(this.Count),this.TimeCountDown.node.active=!1,cc.find("MainContent/ChangeBtn",this.node).getComponent(cc.Button).enableAutoGrayEffect=!0,cc.find("MainContent/ChangeBtn",this.node).getComponent(cc.Button).interactable=!0,void(this.time=10);this.time--,this.TimeCountDown.string=this.time+""},t.prototype.onRankingChange=function(){console.warn("\u6392\u540d\u53d1\u751f\u53d8\u5316"),this.RangingChange,k.default.instance.ShowTips(T.default.getStr("Ladder_3"),this.onChange,this,null,2,null,null,function(){},this)},t.prototype.onAddBtn=function(){var e,t,i=this;t=this._configs.BuyConf[1][this._configs.BuyConf[1].length-1].bugcount,(e=p.SelfHighLadderData.buynum)>=10?I.default.instance.ShowMsg(T.default.getStr("Ladder_14")):(this.Price=e>=t?this._configs.BuyConf[1][this._configs.BuyConf[1].length-1].bugprice:this._configs.BuyConf[this._configs.LadderRaceConf[this.Key].BuyConf][e].bugprice,k.default.instance.ShowTips(T.default.getStr("Ladder_4",this.Price),function(){i.onConfirmBtn()},this,null,1))},t.prototype.onConfirmBtn=function(){A.default.PurchaseItemOrRechage(E.RechargeTypeConst.Diamonds,this.Price,function(){C.default.instance.sendCmdBuyChallenge()})},t.prototype.onJumpCard=function(){_.default.instance.openWindow(l.WindowType.WarTeam,function(e){},this)},t.prototype.onJumpRanking=function(){P.default.instance.openRankList(c.RankType.TIAN_TI)},t.prototype.onGetInfo=function(){p.SelfHighLadderData.selfranking},t.prototype.onClickRewardPage=function(){_.default.instance.openWindow(l.WindowType.HighLadderReward)},t.prototype.onJumpShop=function(){_.default.instance.openWindow(l.WindowType.Shop,function(){var e=N.default.instance.nowSortIndex[L.ShopConst.Honor];d.default.instance.openShopByTab(e)})},t.prototype.changeRecord=function(){s.default.instance.open(l.WindowType.HighLadderReward)},t.prototype.onChangeRecord=function(){a.default.instance.sendProto({cmd:"lrfightrecord"})},t.prototype.chackLineUp=function(){p.SelfHighLadderData.Lineup?s.default.instance.open(l.WindowType.TreasureTroop):this.onSetSquad()},t.prototype.onSetSquad=function(){v.default.instance.clearData(),C.default.instance.sendCmdSetSquad(),R.default.instance.isSetSandTab=!0,n.GameEventDispatcher.instance.emit(o.EventDefiner.ChangeGameScene,{status:c.GameScene.Fight,guanqiaId:c.GQIdType.TianTi}),_.default.instance.openWindow(l.WindowType.HighLadderFighting),_.default.instance.openWindow(l.WindowType.SandTable)},t.prototype.onClickSkill=function(){s.default.instance.open(l.WindowType.HighLadderSkill)},t.prototype.timeOut=function(e){var t=this,i=y.default.instance.ServerTimeMins;this.countDown&&clearInterval(this.countDown),this.countDown=setInterval(function(){i+=1e3;var n=e.time-i;if(i<e.time){var o=parseInt(""+n/1e3/60/60/24),a=parseInt(""+n/1e3/60/60%24),r=parseInt(""+n/1e3/60%60);t.timeLabe.string="<color=#301810>\u5929\u68af\u9650\u65f6\u6280\u80fd:</c><color=#87361c>"+o+"\u5929"+a+"\u65f6"+r+"\u5206</color>"}},1e3)},t.instance=null,__decorate([W(cc.Label)],t.prototype,"MyRankingNumber",void 0),__decorate([W(cc.Label)],t.prototype,"MyFighNumer",void 0),__decorate([W(cc.Label)],t.prototype,"MyChangeNumber",void 0),__decorate([W(cc.Label)],t.prototype,"TimeCountDown",void 0),__decorate([W(cc.Label)],t.prototype,"TarNum",void 0),__decorate([W(cc.Node)],t.prototype,"Content",void 0),__decorate([W(cc.Node)],t.prototype,"Layout",void 0),__decorate([W(cc.Label)],t.prototype,"translateNum",void 0),__decorate([W(cc.Node)],t.prototype,"leftNode",void 0),__decorate([W(cc.Node)],t.prototype,"skillIcon",void 0),__decorate([W(cc.Label)],t.prototype,"skillNameLabe",void 0),__decorate([W(cc.RichText)],t.prototype,"timeLabe",void 0),__decorate([W(cc.Node)],t.prototype,"teamBtn",void 0),__decorate([W(cc.Node)],t.prototype,"setTeamBtn",void 0),__decorate([W(cc.Node)],t.prototype,"w",void 0),t=i=__decorate([F],t)}(r.default);i.default=U,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/Window":"Window","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../NetConnect/NetConnet":"NetConnet","../../Util/NumberUtil":"NumberUtil","../../Util/RechargeConst":"RechargeConst","../../Util/RechargeUtils":"RechargeUtils","../../Util/Utils":"Utils","../Activity/ActivityController":"ActivityController","../Commons/MonsterPreview":"MonsterPreview","../Guide/GuideNewController":"GuideNewController","../OpenWin/OpenWinController":"OpenWinController","../RankingList/RankListCtrl":"RankListCtrl","../Role/RoleInfo":"RoleInfo","../SandTable/SandTableController":"SandTableController","../Scene/Controller/SkillController":"SkillController","../Shop/ShopConst":"ShopConst","../Shop/ShopController":"ShopController","../Shop/ShopModel":"ShopModel","../Status/StatusType":"StatusType","../Tips/OpTipsController":"OpTipsController","../Tips/TipsWinController":"TipsWinController","../WarTeam/MonsterController":"MonsterController","./ChallengePlayer":"ChallengePlayer","./HighLadderController":"HighLadderController","./HighLadderData":"HighLadderData"}],HotUpdateController:[function(e,t,i){"use strict";cc._RF.push(t,"a8cf9GjIuJI6qdoLF9GvcTy","HotUpdateController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Util/SDKUtils"),o=e("../../Core/Language"),a=e("../../GlobalContext"),r=e("../Cmd/CmdUtils"),s=e("../../Util/ReportSdkUtils"),l=e("../../Core/TimeController"),c=e("../../NetConnect/NetConnet"),d=e("../../Core/WindowManager"),p=e("../../Util/Utils"),h=e("../../Core/GameEventDispatcher"),u=e("../../Core/ConfigsManager"),f=e("../../Core/Controller"),g=e("../../Core/LoadManager"),y=e("../../Util/InitUIPropertyUtils"),m=e("../SDK/GameSDK"),C=e("../SDK/SDKPlatform"),v=cc._decorator,_=v.ccclass,b=v.property,T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.PercentBar=null,t.PercentLabel=null,t.manifestUrl=null,t.Loading=null,t.PercentBarPoint=null,t.soundNode=null,t.tipWinNode=null,t.versions=null,t.updateFile=null,t.updateBytes=null,t._storagePath="",t._am=null,t._updating=!1,t._retryCount=0,t.gameId="slm",t._configData=null,t._versionNum="",t._isForceUpdate=!1,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){var e=this;i.instance=this,this.init(),this.PercentLabel.string=o.default.getStr("\u68c0\u67e5\u66f4\u65b0"),cc.director.preloadScene("Enter",function(t,i,n){e.setProgress(t/i)},function(e){if(e)return console.log(e.name),console.log(e.message),void console.log(e.stack)}),n.default.instance.initJsb(this.initConfig,this)},t.prototype.init=function(){n.default.instance.clear(),r.default.instance.clear(),p.default.clearPool(),h.GameEventDispatcher.clear(),u.ConfigsManager.clear(),f.default.ProtoCallbackDic={},g.default.instance.clear(),c.default.instance.clear(),d.default.instance.init(),l.default._instance=null,y.InitUIPropertyUtils.instance.init(),a.PlayerData.SoundNode=this.soundNode,a.PlayerData.tipWinNode=this.tipWinNode,cc.game.addPersistRootNode(a.PlayerData.SoundNode),cc.game.addPersistRootNode(a.PlayerData.tipWinNode)},t.prototype.onstart=function(){try{tdgamesdk.userInfo,this.checkNeedUpdateCallback(0)}catch(e){this.checkNeedUpdateCallback(0)}},t.prototype.onDestroy=function(){this._am&&this._am.setEventCallback(null)},t.prototype.checkNeedUpdateCallback=function(e){console.log("HotUpdate.checkNeedUpdateCallback, status:"+e),0==e?(cc.director.loadScene("Enter"),m.default.instance.sdk.login()):1==e?this.setProgress(0):2==e&&this.setProgress(0)},t.prototype.checkUpdate=function(){if(this._updating)this.showMsg("Checking or updating ...");else{if(this._retryCount=0,this._am.getState()===jsb.AssetsManager.State.UNINITED&&!this._am.getLocalManifest()){var e=this.manifestUrl;cc.loader.md5Pipe&&(e=cc.loader.md5Pipe.transformURL(e)),this._am.loadLocalManifest(e),console.log("am.loadLocalManifest, 1, url:"+e)}if(console.log("am.getLocalManifest()="+this._am.getLocalManifest()+", isLoaded="+this._am.getLocalManifest().isLoaded()),!this._am.getLocalManifest()||!this._am.getLocalManifest().isLoaded())return this.showMsg("Failed to load local manifest ..."),void this.checkNeedUpdateCallback(0);this._am.setEventCallback(this.checkUpdateComplete.bind(this)),this._am.checkUpdate(),this._updating=!0,a.GlobalContext.Version="v"+this._versionNum,console.log("HotUpdate, GlobalContext.Version: v"+this._versionNum+"-"+this._am.getLocalManifest().getVersion()),this.versions.string=o.default.getStr("updateversion")+this._versionNum+"-"+this._am.getLocalManifest().getVersion()}},t.prototype.checkUpdateComplete=function(e){var t=!1;switch(console.log("Code: "+e.getEventCode()),e.getEventCode()){case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:this.showMsg("No local manifest file found, hot update skipped.");break;case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:this.showMsg("Fail to download manifest file, hot update skipped.");break;case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:this.showMsg("Already up to date with the latest remote version.");break;case jsb.EventAssetsManager.NEW_VERSION_FOUND:this.showMsg("New version found, please try to update."),t=!0;break;default:return}this._am.setEventCallback(null),this._updating=!1,1==t?(this.checkNeedUpdateCallback(1),this.hotUpdate()):this.checkNeedUpdateCallback(0)},t.prototype.hotUpdate=function(){if(this._am&&!this._updating){if(this._am.setEventCallback(this.hotUpdateComplete.bind(this)),this._am.getState()===jsb.AssetsManager.State.UNINITED&&!this._am.getLocalManifest()){var e=this.manifestUrl;cc.loader.md5Pipe&&(e=cc.loader.md5Pipe.transformURL(e)),this._am.loadLocalManifest(e),console.log("am.loadLocalManifest, 2, url:"+e)}this._am.update(),this._updating=!0,this.PercentLabel.string=o.default.getStr("\u66f4\u65b0\u4e2d")}},t.prototype.hotUpdateComplete=function(e){var t=!1,i=!1,n=!1;switch(e.getEventCode()){case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:this.showMsg("No local manifest file found, hot update skipped."),i=!0;break;case jsb.EventAssetsManager.UPDATE_PROGRESSION:var a=1/e.getTotalFiles(),r=e.getDownloadedFiles()*a;r+=a*Number(e.getDownloadedBytes()/e.getTotalBytes()),this.PercentLabel.string=o.default.getStr("\u66f4\u65b0\u4e2d"),this.updateFile.string="\u66f4\u65b0\u6587\u4ef6\u6570\u91cf: "+e.getDownloadedFiles()+"/"+e.getTotalFiles(),this.updateBytes.string="\u66f4\u65b0\u6587\u4ef6\u5927\u5c0f: "+e.getDownloadedBytes()+"/"+e.getTotalBytes(),this.setProgress(r);var s=e.getMessage();s&&this.showMsg("Updated file: "+s);break;case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:this.showMsg("Fail to download manifest file, hot update skipped."),i=!0;break;case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:this.showMsg("Already up to date with the latest remote version."),i=!0;break;case jsb.EventAssetsManager.UPDATE_FINISHED:this.showMsg("Update finished. "+e.getMessage()),t=!0;break;case jsb.EventAssetsManager.UPDATE_FAILED:this.showMsg("Update failed. "+e.getMessage()),this._updating=!1,this._retryCount++,this._retryCount<=5?n=!0:i=!0;break;case jsb.EventAssetsManager.ERROR_UPDATING:this.showMsg("Asset update error: "+e.getAssetId()+", "+e.getMessage());break;case jsb.EventAssetsManager.ERROR_DECOMPRESS:this.showMsg(e.getMessage())}if(1==n&&this.retry(),i&&(this._am.setEventCallback(null),this._updating=!1,this.checkNeedUpdateCallback(2)),t){this._am.setEventCallback(null);var l=jsb.fileUtils.getSearchPaths(),c=this._am.getLocalManifest().getSearchPaths();console.log(JSON.stringify(c)),Array.prototype.unshift.apply(l,c),console.log("\u66f4\u65b0\u4f18\u5148\u76ee\u5f55: "+(l?JSON.stringify(l):"null")),cc.sys.localStorage.setItem("HotUpdateSearchPaths",JSON.stringify(l)),jsb.fileUtils.setSearchPaths(l),this.checkNeedUpdateCallback(3),console.log("HotUpdate complete!!! Restart Game!"),cc.audioEngine.stopAll(),cc.game.restart()}},t.prototype.retry=function(){this._updating||(this.showMsg("Retry failed Assets..., _retryCount:"+this._retryCount),this._am.downloadFailedAssets())},t.prototype.initConfig=function(){var e=this,t=n.default.instance.plat_id,i=n.default.instance.ditch_id,o=n.default.instance.localBigVersion,l=n.default.instance.BackstageUrl+"/login/getloginparams?plat_id="+t+"&ditch_id="+i+"&v="+Math.random();n.default.instance.sendToHttps(l,function(t){if(e._configData=t,a.GlobalContext.VersionBackstageData=t,t&&t.client_bi_url&&n.default.instance.isInitWX&&(s.default.instance.reportUrl=decodeURIComponent(t.client_bi_url+""),s.default.instance.loginPointOut(s.default.LoginPointKingdom_1)),t&&t.client_msg_url&&(r.default.instance.reportUrl=decodeURIComponent(t.client_msg_url+"")),n.default.instance.plat_id!=C.SDKPlatfotmType.NONE&&(a.GlobalContext.ResRoot=decodeURIComponent(e._configData.cache_url)),cc.sys.isNative){e._isForceUpdate=!1,e._versionNum=e._configData.game_num+"",e._configData.force_ver&&""!=e._configData.force_ver&&0!=e._configData.force_ver&&"0"!=e._configData.force_ver&&(e._versionNum=e._configData.force_ver+"",e._isForceUpdate=!0),console.log("VersionNum: "+e._versionNum),e._storagePath=(jsb.fileUtils?jsb.fileUtils.getWritablePath():"/")+"tdgame-"+e.gameId+"-remote-asset",console.log("Storage path for remote asset : "+e._storagePath);var i=parseInt(e._versionNum.split(".")[0]);console.log("HotUpdate, newBigVersion: "+i+", localBigVersion: "+o),o<i?(console.log("\u5927\u7248\u672c\u66f4\u65b0"),e.Loading.active=!1,jsb.fileUtils.removeDirectory(e._storagePath)):o==i?(console.log("\u5c0f\u7248\u672c\u70ed\u66f4"),e.Loading.active=!0,e.initHotUpdate()):(console.log("\u5927\u7248\u672c\u56de\u9000\uff1f"),e.Loading.active=!1,jsb.fileUtils.removeDirectory(e._storagePath))}else e.checkNeedUpdateCallback(0)},this)},t.prototype.initHotUpdate=function(){var e=this;if(cc.sys.isNative){this._am=new jsb.AssetsManager("",this._storagePath,function(t,i){console.log("JS Custom Version Compare: version A is "+t+", version B is "+i+", _isForceUpdate: "+e._isForceUpdate);for(var n=t.split("."),o=i.split("."),a=0;a<n.length;++a){var r=parseInt(n[a]),s=parseInt(o[a]||0);if(r!==s)return r>s&&1==e._isForceUpdate?-1:r-s}return o.length>n.length?-1:0}),this._am.setVerifyCallback(function(t,i){var n=i.compressed,o=i.md5,a=i.path;i.size;return n?(e.showMsg("Verification passed : "+a),!0):(e.showMsg("Verification passed : "+a+" ("+o+")"),!0)}),console.log("Hot update is ready, please check or directly update."),cc.sys.os===cc.sys.OS_ANDROID&&this._am.setMaxConcurrentTask(2);var t=this._storagePath;jsb.fileUtils.isDirectoryExist(t)||jsb.fileUtils.createDirectory(t);var i=t+"/project.manifest",n="";if(jsb.fileUtils.isFileExist(i)){console.log("path_Manifest_Cache \u5df2\u5b58\u5728: "+i),n=jsb.fileUtils.getStringFromFile(i),console.log("old: project.manifest: "+n),(r=JSON.parse(n)).packageUrl=a.GlobalContext.ResRoot+this._versionNum+"/",r.remoteManifestUrl=r.packageUrl+"resources/Version/project.manifest?v="+Math.random(),r.remoteVersionUrl=r.packageUrl+"resources/Version/version.manifest?v="+Math.random(),n=JSON.stringify(r),jsb.fileUtils.writeStringToFile(n,i)}else{console.log("path_Manifest_Cache \u4e0d\u5b58\u5728: "+i);var r,s=cc.url.raw("resources/Version/project.manifest");console.log("localManifest",s),n=jsb.fileUtils.getStringFromFile(s),console.log("jsonString",n),(r=JSON.parse(n)).packageUrl=a.GlobalContext.ResRoot+this._versionNum+"/",r.remoteManifestUrl=r.packageUrl+"resources/Version/project.manifest?v="+Math.random(),r.remoteVersionUrl=r.packageUrl+"resources/Version/version.manifest?v="+Math.random(),n=JSON.stringify(r),jsb.fileUtils.writeStringToFile(n,i)}console.log("new: project.manifest: "+n);var l=new jsb.Manifest(n,t);this._am.loadLocalManifest(l,this._storagePath),console.log("packageUrl: "+r.packageUrl+", version: "+r.version),this.versions.string=o.default.getStr("version")+this._configData.force_ver,this.PercentLabel.string=o.default.getStr("\u68c0\u67e5\u66f4\u65b0"),this.checkUpdate()}else this.checkNeedUpdateCallback(0)},t.prototype.showMsg=function(e){console.log("HotUpdate: "+e)},t.prototype.setProgress=function(e){1!=isNaN(e)&&(e<0&&(e=0),e>1&&(e=1),this.PercentBar.fillRange=e,this.PercentBarPoint.x=Math.min(679,this.PercentBar.node.width*e),this.PercentBarPoint.active=this.PercentBarPoint.x>23)},t.instance=null,__decorate([b(cc.Sprite)],t.prototype,"PercentBar",void 0),__decorate([b(cc.Label)],t.prototype,"PercentLabel",void 0),__decorate([b(cc.RawAsset)],t.prototype,"manifestUrl",void 0),__decorate([b(cc.Node)],t.prototype,"Loading",void 0),__decorate([b(cc.Node)],t.prototype,"PercentBarPoint",void 0),__decorate([b(cc.Node)],t.prototype,"soundNode",void 0),__decorate([b(cc.Node)],t.prototype,"tipWinNode",void 0),__decorate([b(cc.Label)],t.prototype,"versions",void 0),__decorate([b(cc.Label)],t.prototype,"updateFile",void 0),__decorate([b(cc.Label)],t.prototype,"updateBytes",void 0),t=i=__decorate([_],t)}(cc.Component);i.default=T,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Controller":"Controller","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/WindowManager":"WindowManager","../../GlobalContext":"GlobalContext","../../NetConnect/NetConnet":"NetConnet","../../Util/InitUIPropertyUtils":"InitUIPropertyUtils","../../Util/ReportSdkUtils":"ReportSdkUtils","../../Util/SDKUtils":"SDKUtils","../../Util/Utils":"Utils","../Cmd/CmdUtils":"CmdUtils","../SDK/GameSDK":"GameSDK","../SDK/SDKPlatform":"SDKPlatform"}],IconBtn:[function(e,t,i){"use strict";cc._RF.push(t,"6e01fwrDRpBxp5vAAW2LfXZ","IconBtn"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=cc._decorator,a=o.ccclass,r=o.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sa=null,t._unlockFlag=!1,t._selectedCallback=null,t._selectedCallbackThisObj=null,t}var i;return __extends(t,e),i=t,t.prototype.setData=function(e,t,i,n){this._unlockFlag=t,this._selectedCallback=i,this._selectedCallbackThisObj=n,this.node.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=this.sa.getSpriteFrame("icon_"+e),this.node.getChildByName("name").getComponent(cc.Sprite).spriteFrame=this.sa.getSpriteFrame("i18n_"+e),this.node.getChildByName("lock").active=!t},t.prototype.setSelectedFlag=function(e){void 0===e&&(e=!1),this.node.getChildByName("bg2").active=e},t.prototype.onClickBtn=function(e){if(e.type==cc.Node.EventType.TOUCH_END&&this._unlockFlag){var t=e.currentTarget,i=t.getSiblingIndex();this.selectItem(t.parent,i),this._selectedCallback&&this._selectedCallback.call(this._selectedCallbackThisObj,i)}},t.prototype.selectItem=function(e,t){for(var n in e.children)e.children[n].getComponent(i).setSelectedFlag(t==parseInt(n))},__decorate([r(cc.SpriteAtlas)],t.prototype,"sa",void 0),t=i=__decorate([a],t)}(n.default);i.default=s,cc._RF.pop()},{"../../Core/Widget":"Widget"}],Image:[function(e,t,i){"use strict";cc._RF.push(t,"fbdcdeGkHtM45m52LYmHsAG","Image"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/LoadManager"),a=e("../../Core/CacheManager"),r=e("../../GlobalContext"),s=cc._decorator,l=s.ccclass,c=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.resourceUrl="",t.imageName="",t.sprite=null,t._url=null,t._resName=null,t._loadComplete=null,t._loadCompleteThisObj=null,t._loadCompleteParam=null,t._noCacheRess=["ui/main/Downpic"],t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.onCreateSprite()},t.prototype.onCreateSprite=function(){this.sprite||(this.sprite=this.node.getComponent(cc.Sprite)),this.sprite||(this.sprite=this.node.addComponent(cc.Sprite))},t.prototype.start=function(){e.prototype.start.call(this),this.setImage()},t.prototype.setImage=function(){""!=this.resourceUrl&&(this.resourceUrl.indexOf("http")>=0?this.loadImageByHttps(this.resourceUrl):""!=this.imageName?this.loadSpriteAtlas(this.resourceUrl,this.imageName):this.resourceUrl.indexOf("resources/")>=0?this.loadImageByHttps(r.GlobalContext.ResRoot+this.resourceUrl):this.loadSpriteFrame(this.resourceUrl))},t.prototype.updateBg=function(e,t){this.resourceUrl=e,this.imageName=t||"",this.setImage()},t.prototype.loadSpriteFrame=function(e,t,i,n){void 0===t&&(t=null),void 0===i&&(i=null),void 0===n&&(n=null),this._url!=e&&(this.clear(),this._url=e,this._loadComplete=t,this._loadCompleteThisObj=i,this._loadCompleteParam=n,o.default.instance.loadResByType(e,cc.SpriteFrame,this.loadSpriteFrameComplete,this,[e]),this.setUseRecord())},t.prototype.loadSpriteAtlas=function(e,t,i,n,a){void 0===i&&(i=null),void 0===n&&(n=null),void 0===a&&(a=null),this._url==e&&this._resName==t||(this.clear(),this._url=e,this._resName=t,this._loadComplete=i,this._loadCompleteThisObj=n,this._loadCompleteParam=a,o.default.instance.loadResByType(e,cc.SpriteAtlas,this.loadSpriteAtlasComplete,this,[e]),this.setUseRecord())},t.prototype.loadImageByHttps=function(e,t,i,n){if(void 0===t&&(t=null),void 0===i&&(i=null),void 0===n&&(n=null),this._url!=e){if(e.indexOf("resources/")>=0){var a=e.substring(e.indexOf("resources/"));window.resMD5&&window.resMD5[a]&&(e=r.GlobalContext.ResRoot+window.resMD5[a])}this.clear(),this._url=e,this._loadComplete=t,this._loadCompleteThisObj=i,this._loadCompleteParam=n,o.default.instance.load(e,this.loadImageByHttpsComplete,this,[e]),this.setUseRecord()}},t.prototype.loadSpriteFrameComplete=function(e,t){this._url==t&&0==this.isDestroyed&&(this.onCreateSprite(),this.sprite.spriteFrame=new cc.SpriteFrame(e.getTexture()),this._loadComplete&&(this._loadComplete.apply(this._loadCompleteThisObj,this._loadCompleteParam),this._loadComplete=null,this._loadCompleteThisObj=null,this._loadCompleteParam=null))},t.prototype.loadSpriteAtlasComplete=function(e,t){this._url==t&&0==this.isDestroyed&&(this.onCreateSprite(),this.sprite.spriteFrame=e.getSpriteFrame(this._resName),this._loadComplete&&(this._loadComplete.apply(this._loadCompleteThisObj,this._loadCompleteParam),this._loadComplete=null,this._loadCompleteThisObj=null,this._loadCompleteParam=null))},t.prototype.loadImageByHttpsComplete=function(e,t){this._url==t&&0==this.isDestroyed&&(this.onCreateSprite(),this.sprite.spriteFrame=new cc.SpriteFrame(e),this._loadComplete&&(this._loadComplete.apply(this._loadCompleteThisObj,this._loadCompleteParam),this._loadComplete=null,this._loadCompleteThisObj=null,this._loadCompleteParam=null))},t.prototype.clear=function(){this.clearUseRecord(),this.sprite&&this.sprite.isValid&&(this.sprite.spriteFrame=null),this._loadComplete=null,this._loadCompleteThisObj=null,this._loadCompleteParam=null,this._url=null,this._resName=null},t.prototype.dispose=function(){this.clear(),e.prototype.dispose.call(this)},t.prototype.onDestroy=function(){this.clear(),e.prototype.onDestroy.call(this)},t.prototype.clearUseRecord=function(){this._url&&""!=this._url&&-1==this._noCacheRess.indexOf(this._url)&&a.default.instance.clearUseRecord(this._url)},t.prototype.setUseRecord=function(){this._url&&""!=this._url&&-1==this._noCacheRess.indexOf(this._url)&&a.default.instance.setUseRecord(this._url)},__decorate([c(cc.String)],t.prototype,"resourceUrl",void 0),__decorate([c(cc.String)],t.prototype,"imageName",void 0),t=__decorate([l],t)}(n.default);i.default=d,cc._RF.pop()},{"../../Core/CacheManager":"CacheManager","../../Core/LoadManager":"LoadManager","../../Core/Widget":"Widget","../../GlobalContext":"GlobalContext"}],InitSubpackage:[function(e,t,i){"use strict";cc._RF.push(t,"dab7d/M7BNNyI6UHD/6VEki","InitSubpackage"),Object.defineProperty(i,"__esModule",{value:!0});var n=cc._decorator,o=n.ccclass,a=n.property,r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sprite=null,t.isDestroyed=!1,t}return __extends(t,e),t.prototype.start=function(){try{cc.loader.downloader.loadSubpackage("Script",function(e){if(e)return console.error(e);cc.director.loadScene("HotUpdate")})}catch(e){cc.director.loadScene("HotUpdate")}},t.prototype.onDestroy=function(){this.isDestroyed=!0},__decorate([a(cc.Sprite)],t.prototype,"sprite",void 0),t=__decorate([o],t)}(cc.Component);i.default=r,cc._RF.pop()},{}],InitUIPropertyUtils:[function(e,t,i){"use strict";cc._RF.push(t,"3bea2cU4VVGoaCXyn/Sm8Q4","InitUIPropertyUtils"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./Utils"),o=e("../Module/Sound/SoundController"),a=e("../Module/Guide/GuideNewController"),r=e("../Core/GameEventDispatcher"),s=e("../Core/Event"),l=function(){function e(){}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){switch(n.default.isHightVersion){case 2:Object.defineProperty(cc.Node.prototype,"rotation",Object.getOwnPropertyDescriptor(cc.Node.prototype,"angle"))}this.initButton()},e.prototype.initButton=function(){var e=function(){};(e.prototype=cc.Button.prototype)._onTouchEnded=function(e){this.interactable&&this.enabledInHierarchy&&(e.target.getComponent("StopClickEventComponent")||o.default.instance.PlayEffect(o.SoundType.comclick),a.default.instance.isGuide&&a.default.instance.curGuideNode&&!a.default.instance.isPause&&a.default.instance.vo.curstep&&!a.default.instance.vo.curstep.compel&&"SkipNode"!=e.currentTarget.name&&r.GameEventDispatcher.instance.emit(s.EventDefiner.GuideCheckSkipNode),this._pressed&&(cc.Component.EventHandler.emitEvents(this.clickEvents,e),this.node.emit("click",this)),this._pressed=!1,this._updateState(),e.stopPropagation())}},e}();i.InitUIPropertyUtils=l,cc._RF.pop()},{"../Core/Event":"Event","../Core/GameEventDispatcher":"GameEventDispatcher","../Module/Guide/GuideNewController":"GuideNewController","../Module/Sound/SoundController":"SoundController","./Utils":"Utils"}],InterfaceAnimation:[function(e,t,i){"use strict";cc._RF.push(t,"121e22tzOJL/pm3Zvth3GvK","InterfaceAnimation"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=cc._decorator,a=o.ccclass,r=(o.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.show=function(){e.prototype.show.call(this);var t=this.node.getComponent(cc.Animation).play();t.wrapMode=cc.WrapMode.Loop,t.repeatCount=1/0},t.prototype.hide=function(){e.prototype.hide.call(this),this.node.getComponent(cc.Animation).stop()},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t=__decorate([a],t)}(n.default));i.default=r,cc._RF.pop()},{"../../../Core/Widget":"Widget"}],InterfaceLayer:[function(e,t,i){"use strict";cc._RF.push(t,"aa953idJelIkYNl7nHMw9jx","InterfaceLayer"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Core/GameEventDispatcher"),a=e("../../../GlobalContext"),r=e("../../../Core/WindowType"),s=e("../../../Core/Event"),l=e("../GameLayer"),c=e("../../../Core/TimeController"),d=e("../../Functionicon/FunctionIconController"),p=e("../../Activity/ActivityController"),h=e("../../Tips/OpTipsController"),u=e("../../../Core/Language"),f=e("./EventInterface"),g=e("../../Guide/GuideNewController"),y=e("../../Commons/Image"),m=e("../../../Util/Utils"),C=e("../../../Core/LoadManager"),v=e("../../Chapter/ChapterController"),_=e("../../Sound/SoundController"),b=e("../../../Util/NumberUtil"),T=e("../../Commons/WindowOpenUtils"),S=cc._decorator,I=S.ccclass,w=S.property,D=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.middle=null,t.after=null,t.before=null,t.funcIcon=[],t.FuncopenList=[],t._cloudAnim=null,t._clickTime=0,t._haveMove=!1,t._inClick=!1,t._beforeX=null,t._middleX=null,t._afterX=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.node.setContentSize(a.GlobalContext.UIWidth,a.GlobalContext.UIHeight),this._beforeX=this.before.x,this._middleX=this.middle.x,this._afterX=this.after.x},t.prototype.show=function(){e.prototype.show.call(this),this.init(),this.addAnimation(),this.onAddEvent(),this.showRed(),this.setChapterName()},t.prototype.setChapterName=function(){var e=v.default.instance.checkGuanqiainfobyid(v.default.instance.readyPath),t=b.NumberUtil.unitsDigitToText(e.chapter.chapterId);cc.find("content/thread/title/label",this.middle).getComponent(cc.Label).string=u.default.getStr("chapterNumber",t)+" "+e.chapter.chapterName},t.prototype.onAddEvent=function(){o.GameEventDispatcher.instance.on(s.EventDefiner.OpenwindowFunc,this.openFunc,this),o.GameEventDispatcher.instance.on(f.EventInterface.ThreadRed,this.setChapterName,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.sceneMove,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.removeEffect,this);for(var e=0;e<this.funcIcon.length;e++)this.funcIcon[e].on(cc.Node.EventType.TOUCH_END,this.funcOnClickEnd,this);for(e=0;e<this.funcIcon.length;e++)this.funcIcon[e].on(cc.Node.EventType.TOUCH_START,this.funcOnClickStart,this,!0);o.GameEventDispatcher.instance.on(f.EventInterface.MineRed,this.mineRed,this),o.GameEventDispatcher.instance.on(f.EventInterface.ArtifactRed,this.artifactRed,this),o.GameEventDispatcher.instance.on(f.EventInterface.ActivityRed,this.activityRed,this),o.GameEventDispatcher.instance.on(f.EventInterface.CombatteamRed,this.combatteamRed,this),o.GameEventDispatcher.instance.on(f.EventInterface.AltarRed,this.altarRed,this),o.GameEventDispatcher.instance.on(f.EventInterface.ArenaRed,this.arenaRed,this),o.GameEventDispatcher.instance.on(f.EventInterface.TotemsRed,this.totemsRed,this),o.GameEventDispatcher.instance.on(f.EventInterface.ThreadRed,this.threadRed,this)},t.prototype.hide=function(){e.prototype.hide.call(this),o.GameEventDispatcher.instance.off(s.EventDefiner.OpenwindowFunc,this.openFunc,this),o.GameEventDispatcher.instance.off(f.EventInterface.ThreadRed,this.setChapterName,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.sceneMove,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.removeEffect,this);for(var t=0;t<this.funcIcon.length;t++)this.funcIcon[t].off(cc.Node.EventType.TOUCH_END,this.funcOnClickEnd,this);for(t=0;t<this.funcIcon.length;t++)this.funcIcon[t].off(cc.Node.EventType.TOUCH_START,this.funcOnClickStart,this,!0);o.GameEventDispatcher.instance.off(f.EventInterface.MineRed,this.mineRed,this),o.GameEventDispatcher.instance.off(f.EventInterface.ArtifactRed,this.artifactRed,this),o.GameEventDispatcher.instance.off(f.EventInterface.ActivityRed,this.activityRed,this),o.GameEventDispatcher.instance.off(f.EventInterface.CombatteamRed,this.combatteamRed,this),o.GameEventDispatcher.instance.off(f.EventInterface.AltarRed,this.altarRed,this),o.GameEventDispatcher.instance.off(f.EventInterface.ArenaRed,this.arenaRed,this),o.GameEventDispatcher.instance.off(f.EventInterface.TotemsRed,this.totemsRed,this),o.GameEventDispatcher.instance.off(f.EventInterface.ThreadRed,this.threadRed,this),this._clickTime=0,this._haveMove=!1,this._inClick=!1},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.init=function(){for(var e=0;e<this.funcIcon.length;e++)"thread"!=this.funcIcon[e].name&&(this.funcIcon[e].getChildByName("nodeName").active=!1);this.openFunc()},t.prototype.openFunc=function(){var e=p.default.instance.activityWindowTypeList,t=[r.WindowType.HighLadderWin,r.WindowType.Arena];this.FuncopenList=[r.WindowType.Mine,r.WindowType.Artifact,e,r.WindowType.WarTeam,r.WindowType.DrawCard,t,r.WindowType.FactionWin,r.WindowType.Totems];for(var i=0;i<this.FuncopenList.length;i++){var n=this.FuncopenList[i];if("number"!=typeof n)for(var o=0;o<n.length;o++){var a;if((a=d.default.instance.checkIsOpenbyWindowtype(n[o]))?(this.funcIcon[i].getChildByName("nodeName").active=!0,m.default.setGrayEffect(this.funcIcon[i],!0)):m.default.setGrayEffect(this.funcIcon[i],!1),a)break}else(a=d.default.instance.checkIsOpenbyWindowtype(n))?(this.funcIcon[i].getChildByName("nodeName").active=!0,m.default.setGrayEffect(this.funcIcon[i],!0)):m.default.setGrayEffect(this.funcIcon[i],!1);this.onSetEffect(this.funcIcon[i])}},t.prototype.onSetEffect=function(e){if(e.getChildByName("nodeName").active)switch(e.name){case"artifact":o.GameEventDispatcher.instance.emit(f.EventInterface.ShowArtifactEffect);break;case"activity":o.GameEventDispatcher.instance.emit(f.EventInterface.ShowActivityEffect);break;case"altar":this.animationEffect(this.funcIcon[4].getChildByName("Effect"),"Altar");break;case"combatteam":this.animationEffect(this.funcIcon[3].getChildByName("Effect"),"Combatteam")}},t.prototype.addAnimation=function(){var e=this.node.getChildByName("BG");this.animationEffect(e.getChildByName("cloudEffect"),"Beforecloud")},t.prototype.sceneMove=function(e){if(this._haveMove=!0,this.middle.x>=this._middleX){if(this.middle.x=this._middleX,this.after.x=this._afterX,this.before.x=this._beforeX,e.getDelta().x>0)return}else if(this.middle.x<=-(1946-this._middleX-a.GlobalContext.StageWidth)&&(this.before.x=this._beforeX-.15*(1946-a.GlobalContext.StageWidth),this.middle.x=this._middleX-(1946-a.GlobalContext.StageWidth),this.after.x=this._afterX-.3*(1946-a.GlobalContext.StageWidth),e.getDelta().x<0))return;this.middle.x+=1*e.getDelta().x,this.after.x+=.3*e.getDelta().x*1,this.before.x+=.15*e.getDelta().x*1},t.prototype.onSetX=function(e){e?(this.middle.x=this._middleX,this.after.x=this._afterX,this.before.x=this._beforeX):(this.before.x=this._beforeX-.15*(1946-a.GlobalContext.StageWidth),this.middle.x=this._middleX-(1946-a.GlobalContext.StageWidth),this.after.x=this._afterX-.3*(1946-a.GlobalContext.StageWidth))},t.prototype.onChangeX=function(e){switch(e){case r.WindowType.Artifact:case r.WindowType.TotemsCopy:case r.WindowType.FactionWin:this.onSetX(!1);break;default:this.onSetX(!0)}},t.prototype.removeEffect=function(){for(var e=0;e<this.funcIcon.length;e++)this.funcIcon[e].scale<1&&(this.funcIcon[e].scale=1)},t.prototype.funcOnClickStart=function(e){e.currentTarget.getChildByName("button").getComponent(cc.Button).interactable=g.default.instance.isGuide,this._clickTime=(new Date).getTime(),this._haveMove=!1,e.currentTarget.getChildByName("nodeName").active&&(e.currentTarget.scale=.95)},t.prototype.funcOnClickEnd=function(e){_.default.instance.PlayEffect(_.SoundType.comclick),e.currentTarget.scale=1;var t=(new Date).getTime();if(!(this._clickTime<=0||this._inClick)){if(this._haveMove){var i=t-this._clickTime;if(this._clickTime=0,i>500)return void(this._haveMove=!1)}var n=!0;e.currentTarget.getChildByName("nodeName").active||(n=!1),this.MiddleFunLock(),this.openWin(e.currentTarget.name,n)}},t.prototype.openWin=function(e,t){var i=this,n=c.default.instance.setTimeout(function(){c.default.instance.clearTimeout(n),i.openwinByName(e,t)},this,100)},t.prototype.onBtn=function(e,t){this.openwinByName(t,!0)},t.prototype.openwinByName=function(e,t){switch(e){case"mine":t?T.default.instance.openWindowType(r.WindowType.Mine):d.default.instance.checkIsOpenbyWindowtype(this.type(e),!0);break;case"artifact":t?l.default.instance.onClickOpenArtifact():d.default.instance.checkIsOpenbyWindowtype(this.type(e),!0);break;case"activity":t?l.default.instance.onClickOpenActivity():d.default.instance.checkIsOpenbyWindowtype(this.type(e),!0);break;case"combatteam":t?l.default.instance.onClickOpenWarTeam():d.default.instance.checkIsOpenbyWindowtype(this.type(e),!0);break;case"altar":t?l.default.instance.onClickOpenDrawCard():d.default.instance.checkIsOpenbyWindowtype(this.type(e),!0);break;case"arena":t?l.default.instance.onClickOpenSportsWin():d.default.instance.checkIsOpenbyWindowtype(this.type(e),!0);break;case"union":t?l.default.instance.onClickOpenUnion():h.default.instance.ShowMsg(u.default.getStr("function_finish_tips"));break;case"totems":t?l.default.instance.onClickOpenTotems():d.default.instance.checkIsOpenbyWindowtype(this.type(e),!0);break;case"thread":l.default.instance.MainlineLevelBtnClick()}},t.prototype.MiddleFunLock=function(){var e=this;this._inClick=!0;var t=c.default.instance.setTimeout(function(){e._inClick=!1,c.default.instance.clearTimeout(t)},this,1e3)},t.prototype.mineRed=function(e){this.funcIcon[0].getChildByName("nodeName").getChildByName("red").active=e.detail},t.prototype.artifactRed=function(e){this.funcIcon[1].getChildByName("nodeName").getChildByName("red").active=e.detail},t.prototype.activityRed=function(e){this.funcIcon[2].getChildByName("nodeName").getChildByName("red").active=e.detail},t.prototype.combatteamRed=function(e){this.funcIcon[3].getChildByName("nodeName").getChildByName("red").active=e.detail},t.prototype.altarRed=function(e){this.funcIcon[4].getChildByName("nodeName").getChildByName("red").active=e.detail},t.prototype.arenaRed=function(e){this.funcIcon[5].getChildByName("nodeName").getChildByName("red").active=e.detail},t.prototype.union=function(){},t.prototype.totemsRed=function(e){this.funcIcon[7].getChildByName("nodeName").getChildByName("red").active=e.detail},t.prototype.threadRed=function(e){this.funcIcon[8].getChildByName("nodeName").getChildByName("red").active=e.detail},t.prototype.showRed=function(){for(var e=0;e<this.funcIcon.length;e++){var t=this.type(this.funcIcon[e].name),i=d.default.instance.getSystemRedpoint(t);"thread"==this.funcIcon[e].name&&(i=v.default.instance.getGuanqiainfo()),this.funcIcon[e].getChildByName("nodeName").getChildByName("red").active=i}},t.prototype.type=function(e){var t=null;switch(e){case"mine":t=r.WindowType.Mine;break;case"artifact":t=r.WindowType.Artifact;break;case"activity":t=r.WindowType.TreasureMainView;break;case"combatteam":t=r.WindowType.WarTeam;break;case"altar":t=r.WindowType.DrawCard;break;case"arena":t=r.WindowType.HighLadderWin;break;case"union":t=null;break;case"totems":t=r.WindowType.Totems;break;case"thread":t=null}return t},t.prototype.animationEffect=function(e,t){var i=e;i.childrenCount<=0&&C.default.instance.loadResByType(a.GlobalContext.Root+"prefab/Interface/Effect/"+t,cc.Prefab,function(e){if(i.childrenCount<=0){var n=m.default.getNodeByUrl(e,a.GlobalContext.Root+"prefab/Interface/Effect/"+t);i.addChild(n),i.parent.getComponent(y.default)&&i.parent.getComponent(y.default).clear()}},this)},__decorate([w(cc.Node)],t.prototype,"middle",void 0),__decorate([w(cc.Node)],t.prototype,"after",void 0),__decorate([w(cc.Node)],t.prototype,"before",void 0),__decorate([w(cc.Node)],t.prototype,"funcIcon",void 0),t=__decorate([I],t)}(n.default);i.default=D,cc._RF.pop()},{"../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Core/LoadManager":"LoadManager","../../../Core/TimeController":"TimeController","../../../Core/Widget":"Widget","../../../Core/WindowType":"WindowType","../../../GlobalContext":"GlobalContext","../../../Util/NumberUtil":"NumberUtil","../../../Util/Utils":"Utils","../../Activity/ActivityController":"ActivityController","../../Chapter/ChapterController":"ChapterController","../../Commons/Image":"Image","../../Commons/WindowOpenUtils":"WindowOpenUtils","../../Functionicon/FunctionIconController":"FunctionIconController","../../Guide/GuideNewController":"GuideNewController","../../Sound/SoundController":"SoundController","../../Tips/OpTipsController":"OpTipsController","../GameLayer":"GameLayer","./EventInterface":"EventInterface"}],InternisfyContr:[function(e,t,i){"use strict";cc._RF.push(t,"af755PbBypKUbvI5CvuQmhh","InternisfyContr"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=cc._decorator,a=o.ccclass,r=o.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=null,t.prefab=null,t.cheak=null,t.Time=0,t.TimeOut=null,t}var i;return __extends(t,e),i=t,t.prototype.show=function(){e.prototype.show.call(this),i.instance=this,this.cheak.on("touchstart",this.IsClick,this)},t.prototype.hide=function(){e.prototype.hide.call(this),this.TimeOut&&clearInterval(this.TimeOut),this.TimeOut=null,this.cheak.off("touchstart",this.IsClick,this)},t.prototype.IsClick=function(){this.Time<=0||(this.Time-=1e4)},t.instance=null,__decorate([r(cc.Node)],t.prototype,"content",void 0),__decorate([r(cc.Prefab)],t.prototype,"prefab",void 0),__decorate([r(cc.Node)],t.prototype,"cheak",void 0),t=i=__decorate([a],t)}(n.default);i.default=s,cc._RF.pop()},{"../../Core/Widget":"Widget"}],InvestmentItem:[function(e,t,i){"use strict";cc._RF.push(t,"839c1E6A9RMRptn5npvYqP3","InvestmentItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=cc._decorator,a=o.ccclass,r=(o.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.statue=-1,t.index=-1,t.buyNumber=0,t}return __extends(t,e),t=__decorate([a],t)}(n.default));i.default=r,cc._RF.pop()},{"../../Core/Widget":"Widget"}],InvestmentPlanContrl:[function(e,t,i){"use strict";cc._RF.push(t,"00317GcL2dNYLOOWWWApkZX","InvestmentPlanContrl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../Core/GameEventDispatcher"),a=e("../welfarelobby/welfarelobbyUtils"),r=e("../../NetConnect/NetConnet"),s=cc._decorator,l=s.ccclass,c=(s.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fund=[],t.welfare=[],t.isBuy=!1,t.peopleBuy=0,t}var i;return __extends(t,e),i=t,t.prototype.listNotification=function(){i.instance=this,this.addProto("inplinfo",this.InvesTmentPlanInfo,this),this.SendInvest()},t.prototype.InvesTmentPlanInfo=function(e){this.peopleBuy=e.count,this.isBuy=e.bought,this.fund=e.fund,this.welfare=e.welfare,o.GameEventDispatcher.instance.emit("INVESTMENTPLAN",this),a.welfarelobbyUtils.setRed()},t.prototype.FunCheckIsRed=function(){for(var e=0;e<this.fund.length;e++)if(this.fund[e]&&1==this.fund[e])return!0},t.prototype.WelCheckIsRed=function(){for(var e=0;e<this.welfare.length;e++)if(this.welfare[e]&&1==this.welfare[e])return!0},t.prototype.SendInvest=function(){r.default.instance.sendProto({cmd:"inplinfo"})},t.instance=null,t=i=__decorate([l],t)}(n.default));i.default=c,cc._RF.pop()},{"../../Core/Controller":"Controller","../../Core/GameEventDispatcher":"GameEventDispatcher","../../NetConnect/NetConnet":"NetConnet","../welfarelobby/welfarelobbyUtils":"welfarelobbyUtils"}],InvestmentPlan:[function(e,t,i){"use strict";cc._RF.push(t,"67db05wodRPk4BEXUvfR3gI","InvestmentPlan"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../NetConnect/NetConnet"),a=e("../Commons/RewardUtils"),r=e("../Item/ItemData"),s=e("../Item/ItemIcon"),l=e("../Role/RoleInfo"),c=e("./InvestmentPlanContrl"),d=e("../../Core/Language"),p=e("../../Core/GameEventDispatcher"),h=e("../../Util/GrayEffect"),u=e("./InvestmentItem"),f=e("../../Core/ConfigsManager"),g=e("../welfarelobby/welfarelobby"),y=e("../../Global/GlobalValue"),m=e("../../Util/RechargeUtils"),C=e("../../Core/LoadManager"),v=e("../../Util/Utils"),_=e("../../Core/TimeController"),b=e("../../Util/RechargeConst"),T=e("../Tips/OpTipsController"),S=e("../Commons/Image"),I=e("../Tips/TipsWinController"),w=cc._decorator,D=w.ccclass,R=w.property,A=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.top=null,t.content=null,t.peopleBuy=null,t.vipLevel=null,t.investmentPlanAtlas=null,t.commAtlas=null,t.buyBtn=null,t.isBuy=null,t.toggle1=null,t.toggle2=null,t.buyLvel=null,t.config=null,t.Investmentarry=[],t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),this.config=f.ConfigsManager.instance.getConfigs("investplanconf"),this.buyLvel.string=d.default.getStr("6512",this.config.investplanConf[1].needVipLv),p.GameEventDispatcher.instance.on("INVESTMENTPLAN",this.ChangeStatue,this),c.default.instance.SendInvest()},t.prototype.hide=function(){e.prototype.hide.call(this),p.GameEventDispatcher.instance.off("INVESTMENTPLAN",this.ChangeStatue,this)},t.prototype.TabChange=function(){var e=this;this.vipLevel.string=l.MyRoleInfo.vipLevel+"";for(var t=[],i=0;i<this.peopleBuy.childrenCount;i++)c.default.instance.peopleBuy.toString().length<this.peopleBuy.childrenCount?c.default.instance.peopleBuy.toString().substr(i,1)&&t.push(c.default.instance.peopleBuy.toString().substr(i,1)):t.push(c.default.instance.peopleBuy.toString().substr(i,1));for(i=0;i<4;i++)4==t.length?this.peopleBuy.children[i].getComponent(cc.Label).string=t[i]+"":3==t.length?(this.peopleBuy.children[0].getComponent(cc.Label).string="0",this.peopleBuy.children[1].getComponent(cc.Label).string=t[0]+"",this.peopleBuy.children[2].getComponent(cc.Label).string=t[1]+"",this.peopleBuy.children[3].getComponent(cc.Label).string=t[2]+""):2==t.length?(this.peopleBuy.children[0].getComponent(cc.Label).string="0",this.peopleBuy.children[1].getComponent(cc.Label).string="0",this.peopleBuy.children[2].getComponent(cc.Label).string=t[0]+"",this.peopleBuy.children[3].getComponent(cc.Label).string=t[1]+""):1==t.length&&(this.peopleBuy.children[0].getComponent(cc.Label).string="0",this.peopleBuy.children[1].getComponent(cc.Label).string="0",this.peopleBuy.children[2].getComponent(cc.Label).string="0",this.peopleBuy.children[3].getComponent(cc.Label).string=t[0]+"");var n=this.toggle1.isChecked?this.config.fund[1]:this.config.welfare[1],o=this.toggle1.isChecked?c.default.instance.fund:c.default.instance.welfare;this.buyBtn.getComponentInChildren(cc.Sprite).spriteFrame=this.toggle1.isChecked?this.commAtlas.getSpriteFrame("btn3"):this.commAtlas.getSpriteFrame("btn4"),this.buyBtn.getComponentInChildren(cc.Label).string=this.toggle1.isChecked?d.default.getStr("common1"):d.default.getStr("6513");var p;p=this.toggle1.isChecked?"resources/welfarelobby/bg_banner2.png":"resources/welfarelobby/bg_banner1.png",this.top.getComponent(S.default).updateBg(p),c.default.instance.isBuy?(this.buyBtn.active=!1,this.isBuy.active=!0):(this.buyBtn.active=!0,this.isBuy.active=!1),v.default.setNodeChildDestoryByUrl(this.content,"prefab/InvestmentPlan/InvestmentPrefab"),C.default.instance.loadResByType("prefab/InvestmentPlan/InvestmentPrefab",cc.Prefab,function(t){var i=function(i){var l=v.default.getNodeByUrl(t,"prefab/InvestmentPlan/InvestmentPrefab"),c=a.default.instance.getItemId(n[i].awards[0].type,n[i].awards[0].id,n[i].awards[0].count),d=r.default.creatItem(c[0],c[1]);l.getChildByName("titleLabe").getComponent(cc.Label).string=n[i].describe,C.default.instance.loadResByType("prefab/Bag/ItemIcon",cc.Prefab,function(e){var t=v.default.getNodeByUrl(e,"prefab/Bag/ItemIcon");t.getComponent(s.default).ItemData(d,!0,d[1],!0),t.setScale(.8),l.getChildByName("Layout").addChild(t)},e),o&&o[i]&&(l.getComponent(u.default).statue=o[i],2==o[i]?(l.children[6].active=!0,l.children[4].active=!1):(l.children[6].active=!1,l.children[4].active=!0)),o&&o[i]&&2!=o[i]?(l.getComponent(u.default).index=Number(i),l.children[4].on(cc.Node.EventType.TOUCH_END,e.GetReward,e)):l.children[4].addComponent(h.default).setGray(!0),e.Investmentarry.push(l)};for(var l in n)i(l);e.sort()},this)},t.prototype.ChangeStatue=function(e,t){this.TabChange(),g.default.instance.IsRead(y.WelfareType.InvestmentPlan,c.default.instance.FunCheckIsRed()||c.default.instance.WelCheckIsRed())},t.prototype.sort=function(){for(var e=[],t=0;t<this.Investmentarry.length;t++)1==this.Investmentarry[t].getComponent(u.default).statue&&(e.push(this.Investmentarry[t]),this.Investmentarry.splice(t,1),t--);for(t=0;t<this.Investmentarry.length;t++)-1==this.Investmentarry[t].getComponent(u.default).statue&&(e.push(this.Investmentarry[t]),this.Investmentarry.splice(t,1),t--);for(t=0;t<this.Investmentarry.length;t++)2==this.Investmentarry[t].getComponent(u.default).statue&&(e.push(this.Investmentarry[t]),this.Investmentarry.splice(t,1),t--);for(var t in e)this.content.addChild(e[t])},t.prototype.BuyBtnClick=function(){var e=this;if(this.buyBtn.getComponentInChildren(cc.Label).string==d.default.getStr("6513"))return this.toggle1.isChecked=!0,this.TabChange(),void _.default.instance.setTimeout(this.sort,this,200);l.MyRoleInfo.vipLevel>=this.config.investplanConf[1].needVipLv?I.default.instance.ShowTips(d.default.getStr("6511",this.config.investplanConf[1].needCsm[0].count),function(){m.default.PurchaseItemOrRechage(b.RechargeTypeConst.Diamonds,e.config.investplanConf[1].needCsm[0].count,function(){o.default.instance.sendProto({cmd:"inplbuy"})})}):T.default.instance.ShowMsg(d.default.getStr("6005"))},t.prototype.GetReward=function(e){if(e.type==cc.Node.EventType.TOUCH_END){var t=e.currentTarget,i={cmd:this.toggle1.isChecked?"inplgetfndawd":"inplgetwlfawd",index:t.parent.getComponent(u.default).index};o.default.instance.sendProto(i)}},__decorate([R(cc.Sprite)],t.prototype,"top",void 0),__decorate([R(cc.Node)],t.prototype,"content",void 0),__decorate([R(cc.Node)],t.prototype,"peopleBuy",void 0),__decorate([R(cc.Label)],t.prototype,"vipLevel",void 0),__decorate([R(cc.SpriteAtlas)],t.prototype,"investmentPlanAtlas",void 0),__decorate([R(cc.SpriteAtlas)],t.prototype,"commAtlas",void 0),__decorate([R(cc.Node)],t.prototype,"buyBtn",void 0),__decorate([R(cc.Node)],t.prototype,"isBuy",void 0),__decorate([R(cc.Toggle)],t.prototype,"toggle1",void 0),__decorate([R(cc.Toggle)],t.prototype,"toggle2",void 0),__decorate([R(cc.Label)],t.prototype,"buyLvel",void 0),t=__decorate([D],t)}(n.default);i.default=A,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../../Global/GlobalValue":"GlobalValue","../../NetConnect/NetConnet":"NetConnet","../../Util/GrayEffect":"GrayEffect","../../Util/RechargeConst":"RechargeConst","../../Util/RechargeUtils":"RechargeUtils","../../Util/Utils":"Utils","../Commons/Image":"Image","../Commons/RewardUtils":"RewardUtils","../Item/ItemData":"ItemData","../Item/ItemIcon":"ItemIcon","../Role/RoleInfo":"RoleInfo","../Tips/OpTipsController":"OpTipsController","../Tips/TipsWinController":"TipsWinController","../welfarelobby/welfarelobby":"welfarelobby","./InvestmentItem":"InvestmentItem","./InvestmentPlanContrl":"InvestmentPlanContrl"}],ItemConst:[function(e,t,i){"use strict";cc._RF.push(t,"f8f49OzTaNFK7ntVLt46Y2Y","ItemConst"),Object.defineProperty(i,"__esModule",{value:!0}),function(e){e[e.CardChip=1]="CardChip",e[e.Scroll=2]="Scroll",e[e.Equip=3]="Equip",e[e.StrengthenStuff=4]="StrengthenStuff",e[e.Other=5]="Other"}(i.ItemTypeConst||(i.ItemTypeConst={})),function(e){e[e.Equip=1]="Equip",e[e.CardChip=2]="CardChip",e[e.FiveElementProps=3]="FiveElementProps",e[e.ArtifactStuff=4]="ArtifactStuff",e[e.Scroll=5]="Scroll",e[e.JigsawPuzzleStuff=6]="JigsawPuzzleStuff",e[e.GiftOrCurrency=7]="GiftOrCurrency",e[e.EquipStuff=8]="EquipStuff",e[e.TotemsStuff=9]="TotemsStuff",e[e.PayGiftPack=10]="PayGiftPack",e[e.FreeGiftPack=11]="FreeGiftPack",e[e.Title=12]="Title"}(i.ItemJumpTypeConst||(i.ItemJumpTypeConst={})),cc._RF.pop()},{}],ItemController:[function(e,t,i){"use strict";cc._RF.push(t,"ec8c6kRmG5D+aDXDuhp1TKl","ItemController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../Core/GameEventDispatcher"),a=e("../../Core/Event"),r=e("./ItemType"),s=e("../WarTeam/MonsterController"),l=e("../../Core/ConfigsManager"),c=e("../ItemUser/ItemUser"),d=e("./ItemData"),p=e("./ItemIcon"),h=e("../../GlobalContext"),u=e("../../Core/LoadManager"),f=e("../../Core/TimeController"),g=e("../OpenWin/OpenWinController"),y=e("../../Core/WindowType"),m=e("../Tips/RewardTips"),C=e("../Commons/RewardUtils"),v=e("../Role/RoleUtils"),_=e("./ItemModel"),b=e("../Totems/TotemsUtils"),T=e("../../Util/StringUtil"),S=e("../../Util/Utils"),I=e("../Ornament/OrnamentCtrl"),w=e("../Tips/EquipTips"),D=e("../Tips/ItemTips"),R=cc._decorator,A=R.ccclass,N=R.property,L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.itemisNew={},t._config=null,t.itemArray=[],t.itemTips=!1,t.tipsInfo=null,t.timeOut=null,t.openAddItemEffeict=!0,t.scorllConfig=null,t.scrollList=[],t.content=null,t.FlayContent=null,t.bagImage=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this,this._config=l.ConfigsManager.instance.getConfigs("Itemconf")},t.prototype.start=function(){},t.prototype.listNotification=function(){this.addProto("bagitems",this.getBackpackList,this),this.addProto("itemadd",this.BackPackAdd,this),this.addProto("itemdel",this.BackPackDel,this),this.addProto("itemchange",this.BackPackChange,this),this.addProto("additemnum",this.AddNum,this),this.addProto("paygiftrewards",this.GiftReward,this)},t.prototype.getBackpackList=function(e){r.MyBagItem.ItemList=e.items.concat(),o.GameEventDispatcher.instance.emit(a.EventDefiner.GetBackpackListinfo),this.scrollList=_.default.instance.getScroll()},t.prototype.OpenAddItemEffeict=function(e){this.openAddItemEffeict=e},t.prototype.AddNum=function(e){console.log("\u7269\u54c1",e.items)},t.prototype.BackPackAdd=function(e){console.log("\u80cc\u5305\u6dfb\u52a0\u7269\u54c1:",e.item.toString()),this.itemisNew[e.item.guid]=!0,r.MyBagItem.ItemList.push(e.item),s.default.instance.warTeamRed(),o.GameEventDispatcher.instance.emit(a.EventDefiner.AddBackpackItem,e.item),this.itemArray.push(e.item),this.scrollList=_.default.instance.getScroll(),v.RoleUtils.setRed(),b.TotemsUtils.setRed(),0==this.itemTips&&this.showItemTips(e.item),o.GameEventDispatcher.instance.emit("BagPackInfoChange",this)},t.prototype.BackPackDel=function(e){console.log("\u80cc\u5305\u5220\u9664\u4e00\u683c:"+JSON.stringify(e));for(var t=0;t<r.MyBagItem.ItemList.length;t++)if(r.MyBagItem.ItemList[t].guid==e.guid){var i=r.MyBagItem.ItemList[t];r.MyBagItem.ItemList.splice(t,1),o.GameEventDispatcher.instance.emit(a.EventDefiner.DelBackpackItem,i);break}this.scrollList=_.default.instance.getScroll(),o.GameEventDispatcher.instance.emit(a.EventDefiner.ReelCountInfo,this.scrollList)},t.prototype.BackPackChange=function(e){console.log("\u80cc\u5305\u53d8\u5316:"+JSON.stringify(e));for(var t=0;t<r.MyBagItem.ItemList.length;t++)if(console.log(r.MyBagItem.ItemList.guid,e.guid),r.MyBagItem.ItemList[t].guid==e.guid){console.log("\u80cc\u5305"+t+"\u683c\u53d8\u5316"),r.MyBagItem.ItemList[t].count<e.item.count&&(this.itemisNew[e.guid]=!0),r.MyBagItem.ItemList[t]=e.item,o.GameEventDispatcher.instance.emit(a.EventDefiner.BackpackItemChange,t);break}v.RoleUtils.setRed(),b.TotemsUtils.setRed(),s.default.instance.warTeamRed(),this.scrollList=_.default.instance.getScroll(),o.GameEventDispatcher.instance.emit(a.EventDefiner.ReelCountInfo,this.scrollList),o.GameEventDispatcher.instance.emit(a.EventDefiner.itemchangeUP),o.GameEventDispatcher.instance.emit("BagPackInfoChange",this)},t.prototype.showItemTips=function(e){var t=this,i=h.GlobalContext.Root+"prefab/ItemUserTips/ItemUserBg";u.default.instance.loadResByType(i,cc.Prefab,function(n){var o=S.default.getNodeByUrl(n,i);t.showItemTipss(e,o)},this)},t.prototype.showItemTipss=function(e,t){var i=this._config.ItemConf[e.id].UseTip,n=this._config.ItemConf[e.id].Type;if(0==i&&3==n)s.default.instance.isEquipUp(e.guid).isCan&&((o=t).getComponent(c.default).isEquip=!0,o.getComponent(c.default).itemID=e.id,o.getComponent(c.default).itemCount=e.count,o.getComponent(c.default).itemguid=e.guid,o.getComponent(c.default).itemNmae.string=this._config.ItemConf[e.id].ItemName,this.content.addChild(o),this.tipsInfo=s.default.instance.isEquipUp(e.guid));else if(0==i||2==i||3==i){var o;(o=t).getComponent(c.default).isEquip=!1,o.getComponent(c.default).itemID=e.id,o.getComponent(c.default).itemCount=e.count,o.getComponent(c.default).itemguid=e.guid,o.getComponent(c.default).itemNmae.string=T.default.substring(this._config.ItemConf[e.id].ItemName,7),this.content.addChild(o)}},t.prototype.ItemFlay=function(e){var t=this;this.bagImage.stopAllActions();u.default.instance.loadResByType(h.GlobalContext.Root+"prefab/Bag/Item",cc.Prefab,function(i){for(var n=0;n<e.length;n++){var o=d.default.creatItem(e[n].itemid,e[n].count),a=S.default.getNodeByUrl(i,h.GlobalContext.Root+"prefab/Bag/Item");a.getComponent(p.default).ItemData(o,!0),t.FlayContent.addChild(a),0==e.length-1&&t.ItemFlays(e)}},this)},t.prototype.ItemFlays=function(e){var t=this;this.bagImage.active=!0,this.bagImage.runAction(cc.fadeTo(0,255)),this.FlayContent.x=72,this.FlayContent.y=18,this.FlayContent.scale=1,f.default.instance.clearInterval(this.timeOut);var i=0;this.bagImage.y=-h.GlobalContext.UIHeight/2+60,this.timeOut=f.default.instance.setInterval(function(){if((i+=500)>=500){t.FlayContent.runAction(cc.spawn(cc.moveTo(1,550,-400),cc.scaleTo(1,0))),i=0,f.default.instance.clearInterval(t.timeOut);var e=f.default.instance.setTimeout(function(){t.bagImage.stopAllActions(),t.bagImage.runAction(cc.fadeTo(.5,0)),S.default.setNodeChildDestoryByUrl(t.FlayContent,h.GlobalContext.Root+"prefab/Bag/Item"),f.default.instance.clearTimeout(e)},t,1e3)}},this,500)},t.prototype.getItemNum=function(e,t){void 0===t&&(t=!0),"number"!=typeof e&&(e=parseInt(e));var i=0;for(var n in r.MyBagItem.ItemList)if(r.MyBagItem.ItemList[n].id==e)if(t){var o=d.default.creatItem(e,1);I.default.instance.data.ornamentFlag(e)||o.type==r.ItemType.equipment?!I.default.instance.data.ornamentFlag(e)&&r.MyBagItem.ItemList[n].ower<=0?i+=r.MyBagItem.ItemList[n].count:I.default.instance.data.ornamentFlag(e)&&(r.MyBagItem.ItemList[n].belongcardid<=0||!r.MyBagItem.ItemList[n].belongcardid)&&(i+=r.MyBagItem.ItemList[n].count):i+=r.MyBagItem.ItemList[n].count}else i+=r.MyBagItem.ItemList[n].count;return i},t.prototype.getItemByGuid=function(e){for(var t in r.MyBagItem.ItemList)if(r.MyBagItem.ItemList[t].guid==e)return r.MyBagItem.ItemList[t];return null},t.prototype.getItemListByid=function(e){var t=[];for(var i in r.MyBagItem.ItemList)r.MyBagItem.ItemList[i].id==e&&t.push(r.MyBagItem.ItemList[i]);return t.length>0?t:null},t.prototype.getItemByid=function(e){for(var t in r.MyBagItem.ItemList)if(r.MyBagItem.ItemList[t].id==e)return r.MyBagItem.ItemList[t]},Object.defineProperty(t.prototype,"getTitleList",{get:function(){for(var e=[],t=0;t<r.MyBagItem.ItemList.length;t++)12==_.default.instance.getBaseAttributebyId(r.MyBagItem.ItemList[t].id).ItemType&&e.push(r.MyBagItem.ItemList[t].id);return e},enumerable:!0,configurable:!0}),t.prototype.GiftReward=function(e){g.default.instance.openWindow(y.WindowType.RewardTips,function(){m.default.instance.setData(C.default.instance.getItemListByServerData(e.awards))})},t.prototype.clearArry=function(){var e=this,t=0;f.default.instance.setInterval(function(){1e4==(t+=1e4)&&(e.itemArray=[])},this,1e4)},t.prototype.openItemTips=function(e){I.default.instance.data.ornamentFlag(e.id)||e.type==r.ItemType.equipment?g.default.instance.openWindow(y.WindowType.EquipTips,function(){w.default.instance.setData(e)}):g.default.instance.openWindow(y.WindowType.ItemTipsWin,function(){D.default.instance.setData(e)})},t.instance=null,__decorate([N(cc.Node)],t.prototype,"content",void 0),__decorate([N(cc.Node)],t.prototype,"FlayContent",void 0),__decorate([N(cc.Node)],t.prototype,"bagImage",void 0),t=i=__decorate([A],t)}(n.default);i.default=L,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/StringUtil":"StringUtil","../../Util/Utils":"Utils","../Commons/RewardUtils":"RewardUtils","../ItemUser/ItemUser":"ItemUser","../OpenWin/OpenWinController":"OpenWinController","../Ornament/OrnamentCtrl":"OrnamentCtrl","../Role/RoleUtils":"RoleUtils","../Tips/EquipTips":"EquipTips","../Tips/ItemTips":"ItemTips","../Tips/RewardTips":"RewardTips","../Totems/TotemsUtils":"TotemsUtils","../WarTeam/MonsterController":"MonsterController","./ItemData":"ItemData","./ItemIcon":"ItemIcon","./ItemModel":"ItemModel","./ItemType":"ItemType"}],ItemData:[function(e,t,i){"use strict";cc._RF.push(t,"61e88EN64JPj6ljTzDpY/kT","ItemData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./ItemModel"),o=e("../../Util/ColorUtil"),a=e("../Role/RoleInfo"),r=cc._decorator,s=r.ccclass,l=(r.property,function(){function e(){this.guid="",this.exp=0,this.level=0,this.ower=-1,this.stage=0,this.randomIndex=[],this.gem=[],this.refineLevel=0,this.refineBless=0,this.gemLv=0,this.belongcardid=-1,this.intensifyexp=0,this.talent=!1,this.effect=[],this._config=null}var t;return t=e,e.prototype.initData=function(e){this.guid=e.guid,this.id=e.id,this.count=e.count,this.exp=e.exp?e.exp:0,this.level=e.level?e.level:0,this.ower=e.ower?e.ower:0,this.stage=e.stage?e.stage:0,this.gem=e.gem?e.gem:[],this.gemLv=e.gemLv?e.gemLv:0,this.refineLevel=e.refineLevel?e.refineLevel:-1,this.refineBless=e.refineBless?e.refineBless:0,this.randomIndex=e.randomIndex?e.randomIndex:[],this.belongcardid=e.belongcardid?e.belongcardid:-1,this.intensifyexp=e.intensifyexp?e.intensifyexp:0,this.effect=e.effect?e.effect:[],this.talent=!!e.talent&&e.talent},Object.defineProperty(e.prototype,"config",{get:function(){if(!this._config)try{this._config=n.default.instance.getBaseAttributebyId(this.id)}catch(e){console.error("\u9053\u5177\u672a\u914d\u7f6e:"+this.id+",\u9ed8\u8ba4\u4f7f\u7528\u9053\u51771\u66ff\u4ee3"),this._config=n.default.instance.getBaseAttributebyId(1)}return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baseid",{get:function(){return this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.config?this.config.ItemName:this.baseid+""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this.config.Type?this.config.Type:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ItemType",{get:function(){return this.config.ItemType?this.config.ItemType:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ClientType",{get:function(){return this.config.ClientType?this.config.ClientType:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"colorIndex",{get:function(){return this.config.ItemColor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){if(t.colordata[this.colorIndex]&&""!=t.colordata[this.colorIndex])return t.colordata[this.colorIndex];var e=new cc.Color,i=o.ColorUtil.colorStr(this.colorIndex)+"";return console.log("newColor:"+i+","+this.colorIndex),e.fromHEX(i),t.colordata[this.colorIndex]=e,t.colordata[this.colorIndex]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"overTime",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useLevel",{get:function(){return this.config.useLevel?this.config.useLevel:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"desc",{get:function(){return this.config.ItemDesc},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxNum",{get:function(){return this.config.maxNum},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dealPrice",{get:function(){return this.config.dealPrice},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AltsName",{get:function(){return this.config.AltsName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ItemIcon",{get:function(){var e=this.config.ItemIcon.split(",");return e.length>1&&a.MyRoleInfo.sex?e[1]:e[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isTrading",{get:function(){return this.config.isTrading},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Roads",{get:function(){return this.config.Roads?this.config.Roads:[]},enumerable:!0,configurable:!0}),e.creatItem=function(e,i){void 0===i&&(i=0),"number"!=typeof e&&(e=parseInt(e));var n=new t;return n.id=e,n.count=i,n},e.prototype.getItemdataById=function(e){return n.default.instance.getBaseAttributebyId(e).ItemAttribute},e.colordata=new Object,e=t=__decorate([s],e)}());i.default=l,cc._RF.pop()},{"../../Util/ColorUtil":"ColorUtil","../Role/RoleInfo":"RoleInfo","./ItemModel":"ItemModel"}],ItemIcon:[function(e,t,i){"use strict";cc._RF.push(t,"72825P7zvNIBJSOnuyLY2p6","ItemIcon"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("./ItemWidget"),a=e("./ItemController"),r=e("../../Core/LoadManager"),s=e("../../GlobalContext"),l=e("../../Util/Utils"),c=cc._decorator,d=c.ccclass,p=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ItemNew=null,t.ItemDebris=null,t.initItem=!1,t._itemData=null,t.comCall=null,t.comCallThis=null,t}return __extends(t,e),t.prototype.show=function(){this.node.on("touchend",this.touchendevent,this),this.node.width=116,this.node.height=116},t.prototype.hide=function(){this.comCall=null,this.comCallThis=null,this._itemData=null,this.node.off("touchend",this.touchendevent,this)},t.prototype.touchendevent=function(){this.node.index_td_click&&this.node.index_td_itemdata&&this.node.index_td_itemdata.id&&a.default.instance.openItemTips(this.node.index_td_itemdata)},t.prototype.ItemData=function(e,t,i,n,o,a){var c=this;void 0===t&&(t=!0),void 0===n&&(n=!1),void 0===o&&(o=!0),void 0===a&&(a=!1),this.initItem?this.setItemData(e,t,i,n,o,a):(l.default.setNodeChildDestoryByUrl(this.node,s.GlobalContext.Root+"prefab/Bag/Item"),r.default.instance.loadResByType(s.GlobalContext.Root+"prefab/Bag/Item",cc.Prefab,function(r){if(!c.isDestroyed){c.initItem=!0;var d=l.default.getNodeByUrl(r,s.GlobalContext.Root+"prefab/Bag/Item");c.ItemDatac(e,t,i,n,d,o,a)}},this),this._itemData=e)},t.prototype.setItemData=function(e,t,i,n,a,r){void 0===t&&(t=!0),void 0===n&&(n=!1),void 0===a&&(a=!0),void 0===r&&(r=!1),this.node.attr({index_td_itemdata:e,index_td_click:n}),this.node.getChildByName("ItemIcon").getComponent(o.default).ItemData(e,t),this.node&&(i&&this.node.getChildByName("ItemIcon").getComponent(o.default).setItemcountstring(i),a||(this.node.getChildByName("ItemIcon").getComponent(o.default).debris.active=!1),r&&l.default.setGrayEffect(this.node,!r),this.comCall&&this.comCall.call(this.comCallThis))},t.prototype.ItemDatac=function(e,t,i,n,o,a,r){void 0===t&&(t=!0),void 0===n&&(n=!1),void 0===o&&(o=null),void 0===a&&(a=!0),void 0===r&&(r=!1),this.node.childrenCount||this.node.insertChild(o,1),this.setItemData(e,t,i,n,a,r)},t.prototype.Clear=function(){l.default.setNodeChildDestoryByUrl(this.node,s.GlobalContext.Root+"prefab/Bag/Item"),this.initItem=!1},t.prototype.InitBagIcon=function(){this.node.getChildByName("ItemIcon")&&this.node.getChildByName("ItemIcon").getComponent("ItemWidget")&&this.node.getChildByName("ItemIcon").getComponent("ItemWidget").InitBagIcon(),this.node.getChildByName("iconNew")&&(this.node.getChildByName("iconNew").active=!1)},t.prototype.getItemData=function(){return this._itemData},__decorate([p(cc.Prefab)],t.prototype,"ItemNew",void 0),__decorate([p(cc.SpriteFrame)],t.prototype,"ItemDebris",void 0),t=__decorate([d],t)}(n.default);i.default=h,cc._RF.pop()},{"../../Core/LoadManager":"LoadManager","../../Core/Widget":"Widget","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","./ItemController":"ItemController","./ItemWidget":"ItemWidget"}],ItemInfo:[function(e,t,i){"use strict";cc._RF.push(t,"21943uQSu5JzJkSi0hBkEUv","ItemInfo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("./ShopController"),a=cc._decorator,r=a.ccclass,s=a.property,l=e("../Role/RoleController"),c=e("../../NetConnect/NetConnet"),d=e("../Tips/OpTipsController"),p=e("../Item/ItemData"),h=e("../Item/ItemType"),u=e("./ShopData"),f=e("../../Core/Language"),g=e("../../GlobalContext"),y=e("./ShopConst"),m=e("../Item/ItemController"),C=e("../../Global/GlobalValue"),v=e("../../Util/RechargeUtils"),_=e("../../Util/RechargeConst"),b=e("../Vip/VipCtrl"),T=e("../Role/RoleInfo"),S=function(e){function t(){var t=e.call(this)||this;return t.Limit=null,t.Icon=null,t.Name=null,t.ItemCount=null,t.ItemDescription=null,t.EditBox=null,t.Sum=null,t.BuyMore=null,t.MoneyIcon=null,t.Icons=null,t.lable1=null,t.lable2=null,t.lable3=null,t.lable4=null,t.lable5=null,t.btn_add=null,t.btn_Reduce=null,t.scrollView=null,t.id=0,t.countor=0,t.sum=0,t.isCanBuy=!1,t.canBuy=!1,t.islimit=!1,t.price=0,t.index=0,t.priceArray=[],t._vipItemList=[],i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this),this.lable1.string=f.default.getStr("ownNum"),this.lable2.string=f.default.getStr("ShopItemCount"),this.lable3.string=f.default.getStr("price"),this.lable4.string=f.default.getStr("ge"),this.lable5.string=f.default.getStr("common1")},t.prototype.show=function(){},t.prototype.hide=function(){this.setEditBoxPos(0),this.EditBox.string="0",this.Sum.string="0",this.Sum.node.color=cc.color(0,0,0),this._vipItemList=null},t.prototype.initInfo=function(e,t,i,n,a,r){if(void 0===a&&(a=0),void 0===r&&(r=1),this.shopdata=null,this.canBuy=!1,this.islimit=!1,this.isCanBuy=!1,e){this.id=e,null==t&&(t=0),this.countor=t;var s=void 0,c=void 0;if(o.default.instance.chooseTpye==y.ShopConst.SoulCard)this.Limit.active=!1,this.MoneyIcon.spriteFrame=this.Icons.getSpriteFrame("soulCard"),s=e.itemId,e.count,c=s,this.price=e.soulCnt,this.index=a,this.add();else{this._vipItemList=b.default.instance.data.getVipItemId,this.shopdata=new u.default,this.shopdata.initData(e),s=this.shopdata.itemid,this.shopdata.count;var d=o.default.instance.getIconNmae(this.shopdata.labelName);this.MoneyIcon.spriteFrame=this.Icons.getSpriteFrame(d),this.shopdata.limit>0?(this.Limit.active=!0,this.islimit=!0,this.Limit.getComponent(cc.Label).string=f.default.getStr("\u9650\u8d2d({0}/{1})",t,this.shopdata.limit)):this.Limit.active=!1,c=this.shopdata.itemid,this.shopdata.price.length>1?(this.btn_add.interactable=!1,this.btn_Reduce.interactable=!1,this.Sum.string=this.shopdata.price[i]+"",this.price=this.shopdata.price[i],this.setEditBoxPos(1),this.EditBox.string="1",this.sum=n,1==l.default.instance.CheckMyWealthIsEnough(this.shopdata.type,this.shopdata.price[i],!1)?(console.log("\u8d27\u5e01\u5145\u8db3"),this.isCanBuy=!0,this.Sum.node.color=cc.color(0,0,0)):(console.log("\u8d27\u5e01\u4e0d\u8db3"),this.isCanBuy=!1,this.Sum.node.color=cc.color(255,0,0))):(this.price=this.shopdata.price[0],this.LimitCalculater(n,!1),this.isCanBuy=!1),this.priceArray=this.shopdata.price.slice(0)}this.priceArray.splice(0,i),this.iteminfo=new p.default,this.iteminfo=p.default.creatItem(s,r),this.Icon.getComponent("ItemIcon").ItemData(this.iteminfo,!0),this.Name.string=this.iteminfo.name,this.ItemDescription.string=this.iteminfo.desc;var h=m.default.instance.getItemNum(c);this.ItemCount.string=h+"",this.btn_add.interactable=!0,this.btn_Reduce.interactable=!0,this.scrollView.scrollToTop()}},t.prototype.add=function(){var e=Number(this.EditBox.string),t=o.default.instance.chooseTpye==y.ShopConst.SoulCard?C.WealthType.SoulCard:this.shopdata.type,i=0;if(o.default.instance.chooseTpye==y.ShopConst.SoulCard)e=this.countor,i=this.price;else{if(this.shopdata&&this.shopdata.limit>0){var n=this.shopdata.limit;console.log("\u9650\u8d2d"),n-this.countor>=e+1&&n-this.countor>0&&n>e?(console.log("\u672a\u5230\u8fbe\u9650\u8d2d\u6b21\u6570"),e++,console.log(this.countor),console.log(n)):-1!=this._vipItemList.indexOf(this.shopdata.itemid)?d.default.instance.ShowMsg(f.default.getStr("\u63d0\u5347VIP\u7b49\u7ea7\u53ef\u589e\u52a0\u8d2d\u4e70\u6570\u91cf")):d.default.instance.ShowMsg(f.default.getStr("\u5df2\u8fbe\u5230\u8d2d\u4e70\u4e0a\u9650"))}else console.log("\u4e0d\u9650\u8d2d"),e++;i=this.getPrice(e)}1==l.default.instance.CheckMyWealthIsEnough(t,i,!1)?(this.Sum.node.color=cc.color(0,0,0),this.canBuy=!0):(this.Sum.node.color=cc.color(255,0,0),this.canBuy=!1),o.default.instance.chooseTpye==y.ShopConst.SoulCard?this.Sum.string=this.price+"":1==this.shopdata.id?this.Sum.string=i+"":this.Sum.string=e*this.price+"",this.setEditBoxPos(e),this.EditBox.string=e+"",this.sum=e},t.prototype.getPrice=function(e){var t=0;if(this.shopdata&&this.shopdata.price.length>1)for(var i=0;i<e;i++)t+=this.priceArray[i];else t=e*this.price;return t},t.prototype.reduce=function(){var e=Number(this.EditBox.string),t=o.default.instance.chooseTpye==y.ShopConst.SoulCard?C.WealthType.SoulCard:this.shopdata.type;if(o.default.instance.chooseTpye==y.ShopConst.SoulCard)e=this.countor,this.Sum.string=this.price+"";else if(e>1&&e--,this.shopdata&&this.shopdata.price.length>1){for(var i=0,n=0;n<e;n++)i+=this.priceArray[n];this.Sum.string=i+""}else this.Sum.string=e*this.price+"";this.setEditBoxPos(e),this.EditBox.string=e+"",this.sum=e,1==l.default.instance.CheckMyWealthIsEnough(t,Number(this.Sum.string),!1)?(this.Sum.node.color=cc.color(0,0,0),this.canBuy=!0):(this.Sum.node.color=cc.color(255,0,0),this.canBuy=!1)},t.prototype.puchasesBtnClick=function(){if(this.shopdata&&20023==this.shopdata.itemid&&(T.MyRoleInfo.maxEnergy<=T.MyRoleInfo.energy||T.MyRoleInfo.maxEnergy<T.MyRoleInfo.energy+this.shopdata.count*Number(this.EditBox.string)))d.default.instance.ShowMsg(f.default.getStr1(f.default.getStr("usetitem1"),[T.MyRoleInfo.maxEnergy]));else{if(1!=this.canBuy&&1!=this.isCanBuy){var e=void 0;return o.default.instance.chooseTpye==y.ShopConst.SoulCard?e=this.countor?"\u9b42\u5361":"\u53ef\u8d2d\u4e70\u6b21\u6570":(e=this.shopdata.labelName,o.default.instance.chooseTpye==y.ShopConst.Equip&&(e+="\u788e\u7247")),"\u94bb\u77f3"==e?v.default.PurchaseItemOrRechage(_.RechargeTypeConst.Diamonds,999,null,this):d.default.instance.ShowMsg(f.default.getStr("{0}\u4e0d\u8db3",e)),void console.log(e)}1!=this.islimit?(console.log("\u8d2d\u4e70\u591a\u6b21"),1==this.BagNumberCalculator(this.sum)?(this.sendptc(this.id,this.sum),this.node&&this.node.getComponent(n.default)&&this.node.getComponent(n.default).close()):d.default.instance.ShowMsg(f.default.getStr("\u80cc\u5305\u7a7a\u95f4\u4e0d\u8db3"))):this.buylimit()}},t.prototype.buylimit=function(){if(this.shopdata&&this.shopdata.limit>0){if(!(this.shopdata.limit>this.countor))return console.log("\u9650\u5236\u4e0a\u9650"),void(-1!=this._vipItemList.indexOf(this.shopdata.itemid)?d.default.instance.ShowMsg(f.default.getStr("\u63d0\u5347VIP\u7b49\u7ea7\u53ef\u589e\u52a0\u8d2d\u4e70\u6570\u91cf")):d.default.instance.ShowMsg(f.default.getStr("PurchaseUpperLimit")));if(console.log("\u5f53\u524d\u53ef\u8d2d"),1!=this.BagNumberCalculator(this.sum))return void d.default.instance.ShowMsg(f.default.getStr("\u80cc\u5305\u7a7a\u95f4\u4e0d\u8db3"));this.sendptc(this.id,this.sum)}else{if(console.log("\u65e0\u9650\u8d2d"),1!=this.BagNumberCalculator(this.sum))return void d.default.instance.ShowMsg(f.default.getStr("\u80cc\u5305\u7a7a\u95f4\u4e0d\u8db3"));this.sendptc(this.id,this.sum)}this.close()},t.prototype.sendptc=function(e,t){if(this.shopdata&&this.shopdata.type==y.ShopConst.Equip)o.default.instance.onSendBuyCmdEquip(e,t);else if(o.default.instance.chooseTpye==y.ShopConst.SoulCard)o.default.instance.SendBuySoulCard(this.index,t);else{var i={cmd:"shop",id:e,count:t};c.default.instance.sendProto(i),console.log("\u53d1\u9001\u8d2d\u7269\u534f\u8bae\uff1a"+JSON.stringify(i))}},t.prototype.LimitCalculater=function(e,t){void 0===t&&(t=!0);var i=this.price,n=this.shopdata.limit;if(n>0){var o=0;if((o=this.countor?n-this.countor-e:n-e)>=0)this.Sum.string=this.getPrice(e)+"",console.log("\u8d2d\u4e70\u6570\u91cf\u5c0f\u4e8e\u9650\u8d2d"),this.setEditBoxPos(e),this.EditBox.string=e+"",this.sum=e;else{o=this.countor?n-this.countor:n,console.log("\u8d2d\u4e70\u6570\u91cf\u5927\u4e8e\u9650\u8d2d"+o),t&&d.default.instance.ShowMsg(f.default.getStr("\u9650\u8d2d{0}\u6b21",o)),this.setEditBoxPos(o),this.EditBox.string=o>0?o+"":"1";var a=o*i;this.Sum.string=a<0?a+"":i+"",this.sum=o}}else this.setEditBoxPos(e),this.EditBox.string=e+"",this.Sum.string=e*i+"",this.sum=e;1==l.default.instance.CheckMyWealthIsEnough(this.shopdata.type,Number(this.Sum.string),!1)?(this.Sum.node.color=cc.color(0,0,0),this.canBuy=!0):(this.Sum.node.color=cc.color(255,0,0),this.canBuy=!1)},t.prototype.onEditChange=function(){if(o.default.instance.chooseTpye!=y.ShopConst.SoulCard){var e=Number(this.EditBox.string);0==(e=this.shopdata.limit>0&&this.shopdata.limit<e?this.shopdata.limit-this.countor:e)&&(this.EditBox.string="1",e=1),this.LimitCalculater(e)}else this.EditBox.string=this.countor+""},t.prototype.BagNumberCalculator=function(e){var t=e/Number(this.iteminfo.maxNum);t=t>Math.round(t)?Math.round(t)+1:Math.round(t),console.log(t);var i=h.MyBagItem.ItemList.length;return 200-i-t>=0?(console.log("\u53ef\u4ee5\u8d2d\u4e70"),console.log("\u5269\u4f59\u80cc\u5305\u6570"+(200-i-t)),!0):(console.log("\u4e0d\u80fd\u8d2d\u4e70"),!1)},t.prototype.close=function(){e.prototype.close.call(this),g.PlayerData.TopPanel.active=!1},t.prototype.setEditBoxPos=function(e){},t.instance=null,__decorate([s(cc.Node)],t.prototype,"Limit",void 0),__decorate([s(cc.Node)],t.prototype,"Icon",void 0),__decorate([s(cc.Label)],t.prototype,"Name",void 0),__decorate([s(cc.Label)],t.prototype,"ItemCount",void 0),__decorate([s(cc.RichText)],t.prototype,"ItemDescription",void 0),__decorate([s(cc.EditBox)],t.prototype,"EditBox",void 0),__decorate([s(cc.Label)],t.prototype,"Sum",void 0),__decorate([s(cc.Node)],t.prototype,"BuyMore",void 0),__decorate([s(cc.Sprite)],t.prototype,"MoneyIcon",void 0),__decorate([s(cc.SpriteAtlas)],t.prototype,"Icons",void 0),__decorate([s(cc.Label)],t.prototype,"lable1",void 0),__decorate([s(cc.Label)],t.prototype,"lable2",void 0),__decorate([s(cc.Label)],t.prototype,"lable3",void 0),__decorate([s(cc.Label)],t.prototype,"lable4",void 0),__decorate([s(cc.Label)],t.prototype,"lable5",void 0),__decorate([s(cc.Button)],t.prototype,"btn_add",void 0),__decorate([s(cc.Button)],t.prototype,"btn_Reduce",void 0),__decorate([s(cc.ScrollView)],t.prototype,"scrollView",void 0),t=i=__decorate([r],t)}(n.default);i.default=S,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/Window":"Window","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../NetConnect/NetConnet":"NetConnet","../../Util/RechargeConst":"RechargeConst","../../Util/RechargeUtils":"RechargeUtils","../Item/ItemController":"ItemController","../Item/ItemData":"ItemData","../Item/ItemType":"ItemType","../Role/RoleController":"RoleController","../Role/RoleInfo":"RoleInfo","../Tips/OpTipsController":"OpTipsController","../Vip/VipCtrl":"VipCtrl","./ShopConst":"ShopConst","./ShopController":"ShopController","./ShopData":"ShopData"}],ItemListcell:[function(e,t,i){"use strict";cc._RF.push(t,"9c995S7phFK07prH3XoiFZ7","ItemListcell"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./Listcell"),o=e("./ItemIcon"),a=e("./ItemController"),r=e("../../Core/Language"),s=e("../../Util/ColorUtil"),l=e("./ItemType"),c=cc._decorator,d=c.ccclass,p=(c.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ChooseIndex=0,t.BagDown=null,t.New=null,t.msk=null,t.equireItem=null,t.touchnode=null,t.choosestr="",t}return __extends(t,e),t.prototype.start=function(){},t.prototype.onEnable=function(){},t.prototype.onDisable=function(){this.node.getChildByName("iconNew")&&(this.node.getChildByName("iconNew").active=!1)},t.prototype._listcellinit=function(e,t){this.getresources(e,t)},t.prototype.getresources=function(e,t){this.initdata(t)},t.prototype.initdata=function(e){var t=parseInt(this.node.index_td_key);if(!this.node.getChildByName("BagDown")){var i=new cc.Node;i.addComponent(cc.Sprite),i.getComponent(cc.Sprite).spriteFrame=this.BagDown,i.name="BagDown",i.getComponent(cc.Sprite).sizeMode=1,this.node.insertChild(i,0)}if(!this.node.getChildByName("iconNew")){var n=cc.instantiate(this.New);n.active=!1,n.name="iconNew",this.node.addChild(n)}if(!this.node.getChildByName("msk")){var c=new cc.Node;c.name="msk",c.addComponent(cc.Sprite),c.getComponent(cc.Sprite).sizeMode=1,c.getComponent(cc.Sprite).spriteFrame=this.msk,c.active=!1,this.node.addChild(c)}if(!this.node.getChildByName("equireItem")){var d=new cc.Node;d.addChild(new cc.Node),d.name="equireItem",d.addComponent(cc.Sprite).spriteFrame=this.equireItem,d.children[0].addComponent(cc.Label).string=r.default.getStr("ItemUse"),d.children[0].getComponent(cc.Label).fontSize=22,d.children[0].getComponent(cc.Label).lineHeight=d.height,d.children[0].color.fromHEX(s.ColorUtil.MIAOSHU_4),d.y=48,d.x=-20,d.active=!1,this.node.addChild(d)}if(e[t]){var p=e[t];this.node.getComponent(o.default).ItemData(p,!0,p.type==l.ItemType.equipment?"Lv:"+(p.level+1):null);var h=void 0;this.node.getComponent(cc.Button)?(this.node.getComponent(cc.Button).interactable=!0,h=this.node.getComponent(cc.Button)):h=this.node.addComponent(cc.Button);var u=new cc.Component.EventHandler;u.target=this.touchnode,u.component=this.choosestr,u.handler="chooseGrid",u.customEventData=t+"",h.clickEvents[0]=u,this.node.getChildByName("iconNew").active=a.default.instance.itemisNew[p.guid],a.default.instance.itemisNew[p.guid]=!1}else this.node.getChildByName("iconNew").active=!1,this.node.getComponent(cc.Button)&&(this.node.getComponent(cc.Button).interactable=!1),this.node.getComponent(o.default).InitBagIcon();var f=!(this.ChooseIndex!=t||!e[t]);this.node.getChildByName("msk").active=f,this.node.getChildByName("equireItem").active=e[t]&&e[t].ower&&e[t].ower>-1},t=__decorate([d],t)}(n.default));i.default=p,cc._RF.pop()},{"../../Core/Language":"Language","../../Util/ColorUtil":"ColorUtil","./ItemController":"ItemController","./ItemIcon":"ItemIcon","./ItemType":"ItemType","./Listcell":"Listcell"}],ItemLoading:[function(e,t,i){"use strict";cc._RF.push(t,"aa1f3omeYhJGqXjf/R2OKgv","ItemLoading"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../WarTeam/MonsterController"),a=e("../../Util/Utils"),r=e("../../Core/WindowType"),s=e("../../Global/GlobalValue"),l=e("../Commons/MonsterPreview"),c=cc._decorator,d=c.ccclass,p=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.LoadingpanelLogo=null,t.Label=null,t.monsterPre=null,t.strNum=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),this.monsterPre||(this.monsterPre=a.default.getNodeByPool(r.PoolType.MonsterPreview,o.default.instance.MonsterPreview),this.LoadingpanelLogo.addChild(this.monsterPre)),this.monsterPre.scale=.4,this.monsterPre.getComponent(l.default).init("monster",1,1,s.DEFAULTS_SKIN+1,s.PRIORITY.MONSTER,!1,s.ACTION.WALK),null==this.strNum&&(this.strNum=0,this.schedule(this.loadZi,.4))},t.prototype.hide=function(){if(e.prototype.hide.call(this),this.monsterPre)this.monsterPre.getComponent(l.default).clear();null!=this.strNum&&(this.strNum=null,this.unschedule(this.loadZi))},t.prototype.loadZi=function(){var e="";e=0==this.strNum?".":1==this.strNum?"..":"...",this.Label.string="\u52a0\u8f7d\u4e2d"+e,this.strNum++,this.strNum>2&&(this.strNum=0)},__decorate([p(cc.Node)],t.prototype,"LoadingpanelLogo",void 0),__decorate([p(cc.Label)],t.prototype,"Label",void 0),t=__decorate([d],t)}(n.default);i.default=h,cc._RF.pop()},{"../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../Util/Utils":"Utils","../Commons/MonsterPreview":"MonsterPreview","../WarTeam/MonsterController":"MonsterController"}],ItemModel:[function(e,t,i){"use strict";cc._RF.push(t,"86f1biM7T9PrplA2uNjvHlz","ItemModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../NetConnect/NetConnet"),o=e("./ItemType"),a=e("./ItemData"),r=e("../../Core/ConfigsManager"),s=e("../Role/RoleInfo"),l=e("../Commons/RewardUtils"),c=e("../Equip/equip/EquipCtrl"),d=cc._decorator,p=d.ccclass,h=(d.property,function(){function e(){this._config=null}var t;return t=e,e.prototype.onDisable=function(){t._instance=null},Object.defineProperty(e,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"config",{get:function(){return this._config||(this._config=r.ConfigsManager.instance.getConfigs("Itemconf")),this._config},enumerable:!0,configurable:!0}),e.prototype.getBaseAttributebyId=function(e){if(t.iteminfo[e])return t.iteminfo[e];var i,n=function(e){if(null!==e&&"object"==typeof e){var t=e.constructor===Array?[]:{};for(var i in e)t[i]="object"==typeof e[i]?n(e[i]):e[i];return t}};if((i=n(this.config.ItemConf[e]))||alert("\u9053\u5177"+e+"\u672a\u914d\u7f6e"),this.config.ItemConf[e].ItemAttribute){var o=this.config.ItemAttribute[this.config.ItemConf[e].ItemAttribute];o&&(i.ItemAttribute=n(o))}return t.iteminfo[e]=i,i},e.prototype.getItemRoadType=function(e){return this.config.ItemConf[e]?this.config.ItemConf[e].Roads:0},e.prototype.getItemRoadOfInfo=function(){return this.config.RoadInfo},e.prototype.getItemTypebyId=function(e){return this.config.ItemConf[e]&&this.config.ItemConf[e].Type?this.config.ItemConf[e].Type:0},e.prototype.getItemResName=function(e){var t=this.getBagTypeListbyType(e);return t.IconResName.search(/[\u4e00-\u9fa5]/gm)>-1&&"",t.IconResName},e.UseItembyId=function(e,t){void 0===t&&(t=1);for(var i=t,a=o.MyBagItem.ItemList.length-1;a>=0;a--){var r=o.MyBagItem.ItemList[a];if(r.guid==e&&i>0&&r.count>=i){var s={cmd:"useitem",guid:e,count:t};n.default.instance.sendProto(s),console.log("\u53d1\u9001\u4f7f\u7528\u534f\u8bae"+JSON.stringify(s));break}}},e.SellItembyId=function(e,t){void 0===t&&(t=1);for(var i=t,a=o.MyBagItem.ItemList.length-1;a>=0;a--){var r=o.MyBagItem.ItemList[a];if(r.guid==e&&i>0&&r.count>=i){var s={cmd:"sellitem",guid:e,count:t};n.default.instance.sendProto(s);break}}},e.getCountByid=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null);var i=0,n=e||t,a=e?"id":"guid";if(e&&l.RewardType[e])switch(e){case l.RewardType.Diamond:i=s.MyRoleInfo.diamond;break;case l.RewardType.Energy:i=s.MyRoleInfo.energy;break;case l.RewardType.Exp:i=s.MyRoleInfo.exp;break;case l.RewardType.Honor:i=s.MyRoleInfo.honor;break;case l.RewardType.Coin:i=s.MyRoleInfo.money;break;case l.RewardType.Point:i=s.MyRoleInfo.point}else for(var r=0;r<o.MyBagItem.ItemList.length&&(o.MyBagItem.ItemList[r][a]!=n||(i+=o.MyBagItem.ItemList[r].count,e));r++);return i},e.prototype.getBagTypeListbyType=function(e,i){void 0===e&&(e=0),void 0===i&&(i=0);for(var n=[],r=0;r<o.MyBagItem.ItemList.length;r++){var s=o.MyBagItem.ItemList[r],l=t.instance.getBaseAttributebyId(s.id);if(!(l.Type!=e&&0!=e||0!=i&&l.ClientType!=i)){var d=new a.default;d.initData(o.MyBagItem.ItemList[r]),i==o.ItemType.gemstone&&(d.gemLv=c.default.instance.data.getGemstoneCfg(d.id).level),n.push(d)}}return n},e.prototype.getItembyGuidAndType=function(e,i){void 0===e&&(e=0),void 0===i&&(i="");for(var n=null,r=0;r<o.MyBagItem.ItemList.length;r++){var s=o.MyBagItem.ItemList[r];if((t.instance.getBaseAttributebyId(s.id).Type==e||0==e)&&s.guid==i){(n=new a.default).initData(o.MyBagItem.ItemList[r]);break}}return n},e.prototype.getScroll=function(){var e=[];for(var t in o.MyBagItem.ItemList){var i=new a.default;if(i.initData(o.MyBagItem.ItemList[t]),i.type==o.ItemType.scroll){var n={id:i.baseid,count:i.count};e.push(n)}}return e},e._instance=null,e.iteminfo={},e=t=__decorate([p],e)}());i.default=h,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../NetConnect/NetConnet":"NetConnet","../Commons/RewardUtils":"RewardUtils","../Equip/equip/EquipCtrl":"EquipCtrl","../Role/RoleInfo":"RoleInfo","./ItemData":"ItemData","./ItemType":"ItemType"}],ItemTips:[function(e,t,i){"use strict";cc._RF.push(t,"3dc3fzCB4xMcL3qBEUMchcZ","ItemTips"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../Item/ItemController"),a=e("../Commons/RewardUtils"),r=e("../../Core/Language"),s=e("./ItemConst"),l=e("../Item/ItemIcon"),c=e("../../Util/NumberUtil"),d=e("../../Core/CommonsResManager"),p=e("../WarTeam/MonsterController"),h=e("../../Core/WindowType"),u=e("../../Util/Utils"),f=e("../../Core/LoadManager"),g=e("./ChannelItem"),y=e("../../GlobalContext"),m=e("../Item/ItemModel"),C=e("../../Core/WindowManager"),v=e("../../Core/GameEventDispatcher"),_=e("../../Core/Event"),b=cc._decorator,T=b.ccclass,S=b.property,I=function(e){function t(){var t=e.call(this)||this;return t.qualityAtlas=null,t._item=null,t._rewardType=null,i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.node.getChildByName("MaskBg").getComponent("StopClickEventComponent").MaskClickIsClose=!0,v.GameEventDispatcher.instance.on(_.EventDefiner.showUpdate,this.showUpdate,this),v.GameEventDispatcher.instance.on(_.EventDefiner.ChannelItem_onClick,this.close,this)},t.prototype.showUpdate=function(){this.node.show=null},t.prototype.hide=function(){if(!this.node.show){this._item=null,this._rewardType=null;for(var e=this.node.getChildByName("ItemTips").getChildByName("node3").getChildByName("btnNode"),t=e.childrenCount-1;t>=0;t--)u.default.setNodeToPool(h.PoolType.ChannelItem,e.children[t])}},t.prototype.setData=function(e,t){void 0===t&&(t=a.RewardType.Item),this._item=e,this._rewardType=t,this.setBaseInfo(),this.setCardChipInfo(),this.setItemDesc(),this.setAccessWay()},t.prototype.setBaseInfo=function(){var e=this.node.getChildByName("ItemTips").getChildByName("node");e.getChildByName("ItemIcon").getComponent(l.default).ItemData(this._item);var t=this._item.name.length>7?this._item.name.substr(0,7)+"...":this._item.name,i=e.getChildByName("right");i.getChildByName("name").getComponent(cc.Label).string=t,i.getChildByName("typeNode").getChildByName("name").getComponent(cc.Label).string=r.default.getStr("220"+this._item.type);var n=0;n=a.RewardType.Diamond==this._item.id||a.RewardType.Energy==this._item.id||a.RewardType.Exp==this._item.id||this._item.id==a.RewardType.Honor||a.RewardType.Coin==this._item.id||a.RewardType.Point==this._item.id?m.default.getCountByid(this._item.id):o.default.instance.getItemNum(this._item.id),i.getChildByName("numNode").getChildByName("num").getComponent(cc.Label).string=c.NumberUtil.getNumber(n),e.getChildByName("bg").getComponent(cc.Sprite).spriteFrame=this.qualityAtlas.getSpriteFrame("base"+this._item.colorIndex)},t.prototype.setCardChipInfo=function(){var e=this.node.getChildByName("ItemTips").getChildByName("node2");if(this._item.type==s.ItemTypeConst.CardChip){e.active=!0;var t=p.default.instance.data.getCardIdByItemId(this._item.id);e.getChildByName("typeNode").getChildByName("img").getComponent(cc.Sprite).spriteFrame=d.default.instance.getSpriteFrameByName("stance_"+t.cardType),e.getChildByName("qualityNode").getChildByName("img").getComponent(cc.Sprite).spriteFrame=d.default.instance.getSpriteFrameByName("rarity_"+(this._item.colorIndex+1))}else e.active=!1},t.prototype.setItemDesc=function(){this.node.getChildByName("ItemTips").getChildByName("ItemDesc").getComponent(cc.RichText).string=this._item.desc},t.prototype.setAccessWay=function(){var e=this;if(C.default.instance.isOpenWindow(h.WindowType.TreasureMainView)||!this._item.Roads||this._item.Roads.length<=0)this.node.getChildByName("ItemTips").getChildByName("node3").active=!1;else{this.node.getChildByName("ItemTips").getChildByName("node3").active=!0;for(var t=this.node.getChildByName("ItemTips").getChildByName("node3").getChildByName("btnNode"),i=t.childrenCount-1;i>=0;i--)u.default.setNodeToPool(h.PoolType.ChannelItem,t.children[i]);f.default.instance.loadResByType(y.GlobalContext.Root+"prefab/Tips/channelItem",cc.Prefab,function(i){if(e._item){var n=e._item.Roads;for(var o in n){var a=u.default.getNodeByPool(h.PoolType.ChannelItem,i,y.GlobalContext.Root+"prefab/Tips/channelItem");n[o]&&(t.addChild(a),a.getComponent(g.default).initData(n[o]))}}},this)}},t.instance=null,__decorate([S(cc.SpriteAtlas)],t.prototype,"qualityAtlas",void 0),t=i=__decorate([T],t)}(n.default);i.default=I,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/Window":"Window","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/NumberUtil":"NumberUtil","../../Util/Utils":"Utils","../Commons/RewardUtils":"RewardUtils","../Item/ItemController":"ItemController","../Item/ItemIcon":"ItemIcon","../Item/ItemModel":"ItemModel","../WarTeam/MonsterController":"MonsterController","./ChannelItem":"ChannelItem","./ItemConst":"ItemConst"}],ItemType:[function(e,t,i){"use strict";cc._RF.push(t,"467eaBEdDpBXrMAFSA1xgh4","ItemType"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(){}return e.card=1,e.scroll=2,e.equipment=3,e.material=4,e.other=5,e.order=2,e.forging=1,e.gemstone=3,e.Refined=4,e}();i.ItemType=n;var o=function(){return function(){this.ItemList=[]}}();i.BagItem=o,i.MyBagItem={ItemList:[]},cc._RF.pop()},{}],ItemUseNumWin:[function(e,t,i){"use strict";cc._RF.push(t,"ff2d3mk0QBB7LmN/aa6yHPr","ItemUseNumWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/LoadManager"),o=e("../../Util/Utils"),a=e("../../GlobalContext"),r=e("../Item/ItemIcon"),s=e("../../Core/Window"),l=e("../Item/ItemController"),c=e("../OpenWin/OpenWinController"),d=e("../Item/GiftBagWin"),p=e("../../Core/WindowType"),h=e("../Commons/RewardUtils"),u=e("../../Core/ConfigsManager"),f=e("../../NetConnect/NetConnet"),g=e("../Ornament/OrnamentCtrl"),y=e("../WarTeam/MonsterController"),m=e("../Equip/ReplaceWin"),C=e("../Tips/OpTipsController"),v=e("../WarTeam/WarTeamMonsterInfo"),_=e("../../Util/StringUtil"),b=cc._decorator,T=b.ccclass,S=b.property,I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.itemContent=null,t.itemName=null,t.itemNum=null,t.progressBar=null,t.progressLabe=null,t.maxLabe=null,t.currNum=1,t.itemData=null,t.maxNum=0,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.Info=function(e){var t=this;this.currNum=1,this.itemData=e,n.default.instance.loadResByType(a.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(i){var n=o.default.getNodeByUrl(i,a.GlobalContext.Root+"prefab/Bag/ItemIcon");n.getComponent(r.default).ItemData(e,!0,null,!0),t.itemContent.addChild(n),t.itemName.string=_.default.substring(e.config.ItemName,6),t.maxNum=l.default.instance.getItemNum(e.baseid,!1),t.itemNum.string="\u62e5\u6709\uff1a"+t.maxNum,t.ProgressShow()},this)},t.prototype.hide=function(){e.prototype.hide.call(this),o.default.setNodeChildDestoryByUrl(this.itemContent,a.GlobalContext.Root+"prefab/Bag/ItemIcon")},t.prototype.ConfirmBtn=function(){var e=this;if(Number(this.progressLabe.string)>=1){if(10==this.itemData.ItemType)c.default.instance.openWindow(p.WindowType.GiftBagWin,function(){d.default.instance.OpenGift(!0,h.default.instance.getItemList(u.ConfigsManager.instance.getConfigs("Itemconf").ItemConf[e.itemData.baseid].reward),e.itemData,e.currNum,e.itemData.dealPrice)});else if(11==this.itemData.ItemType)c.default.instance.openWindow(p.WindowType.GiftBagWin,function(){d.default.instance.OpenGift(!1,h.default.instance.getItemList(u.ConfigsManager.instance.getConfigs("Itemconf").ItemConf[e.itemData.baseid].reward),e.itemData,e.currNum)});else if(13==this.itemData.ItemType)this.OpenRelpaceByOrnament();else{var t={cmd:"useitem",guid:this.itemData.guid,count:Number(this.progressLabe.string)};f.default.instance.sendProto(t)}this.close()}else C.default.instance.ShowMsg("\u8bf7\u81f3\u5c11\u4f7f\u7528\u4e00\u4e2a\u9053\u5177")},t.prototype.OpenRelpaceByOrnament=function(){var e=this,t=g.default.instance.data.getOrnamentType(this.itemData.baseid),i=y.default.instance.getCardIDByOrnamentType(t);c.default.instance.openWindow(p.WindowType.WarTeam,function(){y.default.instance.openMonsterInfoPrefab(i,v.CardTag.equip,function(){c.default.instance.openWindow(p.WindowType.EquipRelpace,function(e){e.getComponent(m.default).setData(i,t,!0)},e)})},this)},t.prototype.AddNum=function(){this.currNum<this.maxNum?(this.currNum++,this.ProgressShow()):C.default.instance.ShowMsg("\u5df2\u5230\u8fbe\u6700\u5927\u6570\u91cf")},t.prototype.SubtractNum=function(){this.currNum>1?(this.currNum--,this.ProgressShow()):C.default.instance.ShowMsg("\u5df2\u5230\u8fbe\u6700\u5c0f\u6570\u91cf")},t.prototype.ProgressShow=function(){this.progressBar.progress=this.currNum/this.maxNum,this.progressLabe.string=this.currNum+"",this.maxLabe.string="/"+this.maxNum},t.prototype.onMove=function(e){if(1!=this.maxNum)if(this.currNum/2==1)this.progressLabe.string=e.progress<.5?"1":Math.floor(e.progress*this.currNum)+"",this.currNum=Number(this.progressLabe.string);else{var t=e.progress*this.maxNum<1?0:Math.floor(e.progress*this.maxNum);this.progressLabe.string=t+"",this.currNum=t}},t.instance=null,__decorate([S(cc.Node)],t.prototype,"itemContent",void 0),__decorate([S(cc.Label)],t.prototype,"itemName",void 0),__decorate([S(cc.Label)],t.prototype,"itemNum",void 0),__decorate([S(cc.Slider)],t.prototype,"progressBar",void 0),__decorate([S(cc.Label)],t.prototype,"progressLabe",void 0),__decorate([S(cc.Label)],t.prototype,"maxLabe",void 0),t=i=__decorate([T],t)}(s.default);i.default=I,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/LoadManager":"LoadManager","../../Core/Window":"Window","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../NetConnect/NetConnet":"NetConnet","../../Util/StringUtil":"StringUtil","../../Util/Utils":"Utils","../Commons/RewardUtils":"RewardUtils","../Equip/ReplaceWin":"ReplaceWin","../Item/GiftBagWin":"GiftBagWin","../Item/ItemController":"ItemController","../Item/ItemIcon":"ItemIcon","../OpenWin/OpenWinController":"OpenWinController","../Ornament/OrnamentCtrl":"OrnamentCtrl","../Tips/OpTipsController":"OpTipsController","../WarTeam/MonsterController":"MonsterController","../WarTeam/WarTeamMonsterInfo":"WarTeamMonsterInfo"}],ItemUser:[function(e,t,i){"use strict";cc._RF.push(t,"47f925Ye+tO6ICLCdsW7v2s","ItemUser"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../Item/ItemIcon"),a=e("../Item/ItemData"),r=e("../Item/ItemController"),s=e("../Item/ItemType"),l=e("../Tips/OpTipsController"),c=e("../../Core/Language"),d=e("../../Core/WindowType"),p=e("../OpenWin/OpenWinController"),h=e("../WarTeam/MonsterController"),u=e("../../Core/TimeController"),f=e("../Guide/GuideNewController"),g=e("../Item/GiftBagWin"),y=e("../Commons/RewardUtils"),m=e("../../Core/ConfigsManager"),C=e("../../Core/LoadManager"),v=e("../../Util/Utils"),_=e("../WarTeam/WarTeamMonsterInfo"),b=e("./ItemUseNumWin"),T=e("../../Core/GameEventDispatcher"),S=e("../../Core/Event"),I=e("../../GlobalContext"),w=e("../Commons/WindowOpenUtils"),D=cc._decorator,R=D.ccclass,A=D.property,N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.creatItemPos=null,t.userBtn=null,t.goBtn=null,t.toggle=null,t.itemNmae=null,t.itemID=null,t.itemCount=null,t.itemguid=null,t.isEquip=!1,t.timeout=null,t.time=null,t.itemData=null,t.itemOrEquipment=!1,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.show=function(){var t=this;e.prototype.show.call(this),i.instance=this,this.isEquip?(this.userBtn.node.active=!1,this.goBtn.node.active=!0):(this.userBtn.node.active=!0,this.goBtn.node.active=!1),C.default.instance.loadResByType("prefab/Bag/ItemIcon",cc.Prefab,function(e){var i=v.default.getNodeByUrl(e,"prefab/Bag/ItemIcon"),n=a.default.creatItem(t.itemID,t.itemCount);i.getComponent(o.default).ItemData(n,!0),t.itemData=n,t.creatItemPos.addChild(i),t.toggle.getChildByName("checkmark").active=!1;var r=0;t.timeout=u.default.instance.setInterval(function(){if(2e4==(r+=1e3)){if(f.default.instance.isGuide)return;t.closeBtn(),t.timeout&&u.default.instance.clearInterval(t.timeout)}},t,1e3)},this),T.GameEventDispatcher.instance.on("BagPackInfoChange",this.IsPut,this)},t.prototype.hide=function(){e.prototype.hide.call(this),T.GameEventDispatcher.instance.off("BagPackInfoChange",this.IsPut,this),v.default.setNodeChildDestoryByUrl(this.creatItemPos,"prefab/Bag/ItemIcon"),this.timeout&&u.default.instance.clearInterval(this.timeout),this.timeout=null,this.time&&u.default.instance.clearInterval(this.time),this.time=null},t.prototype.useBtn=function(){var e=this;0==this.IsHave()?(this.closeBtn(),l.default.instance.ShowMsg(c.default.getStr("ItemUseTip1"))):2==this.itemData.config.UseTip?11==this.itemData.ItemType&&p.default.instance.openWindow(d.WindowType.GiftBagWin,function(){var t=y.default.instance.getItemList(m.ConfigsManager.instance.getConfigs("Itemconf").ItemConf[e.itemData.baseid].reward),i=r.default.instance.getItemNum(e.itemData.baseid);g.default.instance.OpenGift(!1,t,e.itemData,i),e.closeBtn()}):3==this.itemData.config.UseTip?(w.default.instance.openWindowType(this.itemData.ItemType),this.closeBtn()):p.default.instance.openWindow(d.WindowType.UseItemWin,function(){b.default.instance.Info(e.itemData),e.closeBtn()})},t.prototype.IsHave=function(){for(var e=0;e<s.MyBagItem.ItemList.length;e++)if(this.itemguid==s.MyBagItem.ItemList[e].guid)return this.itemData.guid=this.itemguid,!0;return!1},t.prototype.tipToggle=function(){this.toggle.getChildByName("checkmark").active?this.toggle.getChildByName("checkmark").active=!1:this.toggle.getChildByName("checkmark").active||(this.toggle.getChildByName("checkmark").active=!0)},t.prototype.goEquip=function(e){if(e.type==cc.Node.EventType.TOUCH_END){if(this.closeBtn(),r.default.instance.getItemByid(this.itemID).ower>0)return void l.default.instance.ShowMsg("\u8be5\u88c5\u5907\u5df2\u7a7f\u6234");var t=0;this.time=u.default.instance.setInterval(function(){500==(t+=500)&&p.default.instance.openWindow(d.WindowType.WarTeam,function(){h.default.instance.openMonsterInfoPrefab(r.default.instance.tipsInfo.cardId,_.CardTag.info,function(){})},this)},this,500)}},t.prototype.closeBtn=function(e){void 0===e&&(e=!0),e&&T.GameEventDispatcher.instance.emit(S.EventDefiner.GuideCheckSkipNode,{status:!1,windowType:-1}),u.default.instance.clearInterval(this.timeout),this.toggle.getChildByName("checkmark").active&&(r.default.instance.itemTips=!0);var t=I.GlobalContext.Root+"prefab/ItemUserTips/ItemUserBg";v.default.setNodeDestoryByUrl(this.node,t)},t.prototype.IsPut=function(){var e=r.default.instance.getItemByid(this.itemID);e&&e.ower>0&&this.closeBtn(!1)},t.instance=null,__decorate([A(cc.Node)],t.prototype,"creatItemPos",void 0),__decorate([A(cc.Button)],t.prototype,"userBtn",void 0),__decorate([A(cc.Button)],t.prototype,"goBtn",void 0),__decorate([A(cc.Node)],t.prototype,"toggle",void 0),__decorate([A(cc.Label)],t.prototype,"itemNmae",void 0),t=i=__decorate([R],t)}(n.default);i.default=N,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/RewardUtils":"RewardUtils","../Commons/WindowOpenUtils":"WindowOpenUtils","../Guide/GuideNewController":"GuideNewController","../Item/GiftBagWin":"GiftBagWin","../Item/ItemController":"ItemController","../Item/ItemData":"ItemData","../Item/ItemIcon":"ItemIcon","../Item/ItemType":"ItemType","../OpenWin/OpenWinController":"OpenWinController","../Tips/OpTipsController":"OpTipsController","../WarTeam/MonsterController":"MonsterController","../WarTeam/WarTeamMonsterInfo":"WarTeamMonsterInfo","./ItemUseNumWin":"ItemUseNumWin"}],ItemWidget:[function(e,t,i){"use strict";cc._RF.push(t,"4323faCEjJBkqqOl4jW7zOP","ItemWidget"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../Commons/Image"),a=e("../../Util/NumberUtil"),r=e("../../Core/CommonsResManager"),s=e("../../Core/ConfigsManager"),l=e("../../Core/LoadManager"),c=e("../../GlobalContext"),d=e("../../Util/Utils"),p=e("../Commons/MonsterPreview"),h=e("../../Core/WindowType"),u=e("../WarTeam/MonsterController"),f=e("../../Global/GlobalValue"),g=cc._decorator,y=g.ccclass,m=g.property,C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.model=null,t.Icon=null,t.img=null,t.ItemColor=null,t.ItemCount=null,t.CountBg=null,t.debris=null,t.InitIcon=null,t.icon=null,t.effect=null,t.Iteminfo=null,t.showcountbg=!0,t.scorllConfig=[],t.curplaycolorIndex=0,t.loading=!1,t}return __extends(t,e),t.prototype.onLoad=function(){this.scorllConfig=s.ConfigsManager.instance.getConfigs("scrollconf")},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.hide=function(){(e.prototype.hide.call(this),this.model&&this.model.childrenCount)&&(this.model.getComponentInChildren(p.default).clear(),d.default.setNodeToPool(h.PoolType.MonsterPreview,this.model.children[0]))},t.prototype.setModel=function(e){if(this.InitIcon.node.active=this.debris.active=!1,!this.model.childrenCount){var t=d.default.getNodeByPool(h.PoolType.MonsterPreview,u.default.instance.MonsterPreview);this.model.addChild(t)}this.model.getComponentInChildren(p.default).init("monster",e.cardId,e.grade,f.DEFAULTS_SKIN+e.grade,f.PRIORITY.MONSTER)},t.prototype.setEffect=function(){this.Iteminfo&&this.Iteminfo.colorIndex>=2?(this.effect.children[0].active=!0,this.effect.children[0].getComponent(cc.Animation).play(this.Iteminfo.colorIndex+"")):(this.effect.children[0].active=!1,this.effect.children[0].getComponent(cc.Animation).stop())},t.prototype.ItemData=function(e,t){var i=this;if(void 0===t&&(t=!0),this.Iteminfo=e,this.showcountbg=t,this.img.active=!1,this.Iteminfo)switch(this.img.active=!!e.gemLv,e.gemLv&&(this.img.getComponentInChildren(cc.Label).string=e.gemLv+""),this.Iteminfo.AltsName&&""!=this.Iteminfo.AltsName&&this.Iteminfo.ItemIcon&&""!=this.Iteminfo.ItemIcon&&this.setItemIcon(),e.count>0?this.setItemCount(e.count,t):this.setItemCount(0,!1),this.ItemColor&&(this.curplaycolorIndex=e.colorIndex,this.ItemColor.node.active=!0,this.ItemColor.spriteFrame=r.default.instance.getSpriteFrameByName("bag"+e.colorIndex),this.effect.childrenCount>0?this.setEffect():e.colorIndex>=2&&!this.loading&&(d.default.setNodeChildDestoryByUrl(this.effect,c.GlobalContext.Root+"effects/Item/effect2"),this.loading=!0,l.default.instance.loadResByType(c.GlobalContext.Root+"effects/Item/effect2",cc.Prefab,function(e){if(!i.isDestroyed&&i.effect){i.loading=!1;var t=d.default.getNodeByUrl(e,c.GlobalContext.Root+"effects/Item/effect2");i.effect.addChild(t),i.setEffect()}},this))),this.icon.active=!1,this.debris.active=!1,e.type){case 1:this.debris.active=!0,this.debris.getComponent(cc.Sprite).spriteFrame=r.default.instance.getSpriteFrameByName("debris1");break;case 2:if(this.debris.active=!0,this.debris.getComponent(cc.Sprite).spriteFrame=r.default.instance.getSpriteFrameByName("icon_jz"),this.scorllConfig.scroll&&this.scorllConfig.scroll[1])for(var n=0;n<this.scorllConfig.scroll[1].length;n++)this.scorllConfig.scroll[1][n].id==e.baseid&&(this.icon.active=!0,this.icon.getComponent(cc.Sprite).spriteFrame=r.default.instance.getSpriteFrameByName("form_"+this.scorllConfig.scroll[1][n].param2))}else this.InitBagIcon()},t.prototype.setItemIcon=function(){var e=c.GlobalContext.ResRoot+"resources/itemicon/"+this.Iteminfo.ItemIcon+".png";this.InitIcon.loadImageByHttps(e),this.InitIcon.node.active=!0},t.prototype.setItemcountstring=function(e,t){void 0===t&&(t=!1),this.ItemCount.node.active=!0,this.ItemCount.string=e+"",this.CountBg&&(this.CountBg.active=this.showcountbg)},t.prototype.setItemCount=function(e,t){e<=1||!t?(this.CountBg&&(this.CountBg.active=!1),this.ItemCount.node.active=!1):(this.CountBg&&(this.CountBg.active=!0),this.ItemCount.node.active=!0,this.ItemCount.string=a.NumberUtil.getNumber(e)+"")},t.prototype.InitBagIcon=function(){this.ItemCount.string="",this.CountBg.active=!1,this.InitIcon.node.active=!1,this.ItemColor&&(this.ItemColor.node.active=!1),this.debris.active=!1,this.icon.active=!1,d.default.setNodeChildDestoryByUrl(this.effect,c.GlobalContext.Root+"effects/Item/effect2")},__decorate([m(cc.Node)],t.prototype,"model",void 0),__decorate([m(cc.Sprite)],t.prototype,"Icon",void 0),__decorate([m(cc.Node)],t.prototype,"img",void 0),__decorate([m(cc.Sprite)],t.prototype,"ItemColor",void 0),__decorate([m(cc.Label)],t.prototype,"ItemCount",void 0),__decorate([m(cc.Node)],t.prototype,"CountBg",void 0),__decorate([m(cc.Node)],t.prototype,"debris",void 0),__decorate([m(o.default)],t.prototype,"InitIcon",void 0),__decorate([m(cc.Node)],t.prototype,"icon",void 0),__decorate([m(cc.Node)],t.prototype,"effect",void 0),t=__decorate([y],t)}(n.default);i.default=C,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/ConfigsManager":"ConfigsManager","../../Core/LoadManager":"LoadManager","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/NumberUtil":"NumberUtil","../../Util/Utils":"Utils","../Commons/Image":"Image","../Commons/MonsterPreview":"MonsterPreview","../WarTeam/MonsterController":"MonsterController"}],LabelWidget:[function(e,t,i){"use strict";cc._RF.push(t,"3651bFBYoRNkb+zmm3nyFGy","LabelWidget"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./Widget"),o=e("./Language"),a=cc._decorator,r=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.strkey="",t.strargskey=[],t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.strargskey.length>0?this.node.getComponent(cc.Label).string=o.default.getStr1(this.strkey,this.strargskey):this.node.getComponent(cc.Label).string=o.default.getStr(this.strkey)},__decorate([s(cc.String)],t.prototype,"strkey",void 0),__decorate([s([cc.String])],t.prototype,"strargskey",void 0),t=__decorate([r],t)}(n.default);i.default=l,cc._RF.pop()},{"./Language":"Language","./Widget":"Widget"}],LadderFighTips:[function(e,t,i){"use strict";cc._RF.push(t,"b87ferpxzFGF4LOYN7ym3O8","LadderFighTips"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Scene/Controller/SceneController"),o=e("../SandTable/SandTableController"),a=e("../SandTable/SandTableMain"),r=e("../Status/StatusController"),s=e("../Scene/Manager/SceneManager"),l=e("../../Core/GameEventDispatcher"),c=e("../Status/StatusType"),d=e("../Activity/ActivityController"),p=e("../Guide/GuideNewController"),h=e("../../Core/TimeController"),u=e("./HighLadderController"),f=e("../../Core/WindowType"),g=e("../OpenWin/OpenWinController"),y=e("../../Core/WindowManager"),m=e("../Commons/CommonPageBG"),C=e("../../Core/Language"),v=e("../Role/RoleInfo"),_=e("../LoardCrusadeWin/LoardCrusadeCtrl"),b=e("../../Core/CommonsResManager"),T=e("../../Util/NumberUtil"),S=cc._decorator,I=S.ccclass,w=(S.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.show=function(){var t,i=this;switch(e.prototype.show.call(this),this.onInit(524,408,C.default.getStr("\u6218\u529b\u66ff\u6362")),c.ActivityStatus.value){case c.ActivityStatus.WorldBoss:case c.ActivityStatus.EliteBoss:t=d.default.instance.getFight();break;case c.ActivityStatus.HighLadder:t=u.default.instance.MyFigh+v.MyRoleInfo.Fight;break;case c.ActivityStatus.LoardCrusade:t=_.default.instance.loardFightNum}var n=h.default.instance.setTimeout(function(){var e=i.node.getChildByName("Layout02").getChildByName("Number").getComponent(cc.Label),o=i.node.getChildByName("Layout01").getChildByName("OldNumber").getComponent(cc.Label),a=i.node.getChildByName("Layout01").getChildByName("Number_wang"),r=i.node.getChildByName("Layout01").getChildByName("Number_yi"),l=i.node.getChildByName("Layout02").getChildByName("Number_wang"),c=i.node.getChildByName("Layout02").getChildByName("Number_yi");a.active=!1,r.active=!1,l.active=!1,c.active=!1,s.default.instance.leftFight>=1e8?(e.string=T.NumberUtil.toFixed(s.default.instance.leftFight/1e8,0)+"",l.active=!1,c.active=!0):s.default.instance.leftFight>=1e4?(e.string=T.NumberUtil.toFixed(s.default.instance.leftFight/1e4,0)+"",c.active=!1,l.active=!0):e.string=s.default.instance.leftFight+"",t>=1e8?(o.string=T.NumberUtil.toFixed(t/1e8,0)+"",a.active=!1,r.active=!0):t>=1e4?(o.string=T.NumberUtil.toFixed(t/1e4,0)+"",r.active=!1,a.active=!0):o.string=t+"";var d=i.node.getChildByName("Layout02").getChildByName("arrows");d.active=!0,s.default.instance.leftFight>t?d.getComponent(cc.Sprite).spriteFrame=b.default.instance.getSpriteFrameByName("icon_shangcheng"):s.default.instance.leftFight<t?d.getComponent(cc.Sprite).spriteFrame=b.default.instance.getSpriteFrameByName("icon_xiajian"):s.default.instance.leftFight==t&&(d.active=!1),h.default.instance.clearTimeout(n)},this,500)},t.prototype.hide=function(){e.prototype.hide.call(this)},t.prototype.onOnceMore=function(){n.default.instance.clearAll(),o.default.instance.oneMoveTime(),a.default.instance.highLadder(!0),c.ActivityStatus.value==c.ActivityStatus.HighLadder?u.default.instance.sendCmdSetSquad():c.ActivityStatus.value==c.ActivityStatus.WorldBoss?d.default.instance.WorldBossSetSand():c.ActivityStatus.value==c.ActivityStatus.EliteBoss&&d.default.instance.EliteBossSetSand(),g.default.instance.openWindow(f.WindowType.SandTable),n.default.instance.addMyRole(!1),s.default.instance.fightstatus=s.FIGHTSTATUS.NONE,y.default.instance.closeWindow(this.node)},t.prototype.onConfirmBtn=function(){n.default.instance.clearAll(),a.default.instance.highLadder(!0),o.default.instance.sandtablefinish(),r.default.instance.activityStatusHandle(),y.default.instance.close(f.WindowType.HighLadderFighting),c.ActivityStatus.value==c.ActivityStatus.HighLadder?p.default.instance.checkCondition(16):c.ActivityStatus.value==c.ActivityStatus.WorldBoss||c.ActivityStatus.value==c.ActivityStatus.EliteBoss&&p.default.instance.checkCondition(12),y.default.instance.closeWindow(this.node)},t.prototype.onClose=function(){e.prototype.onClose.call(this),l.GameEventDispatcher.instance.emit("CloseSetSand",this)},t=__decorate([I],t)}(m.default));i.default=w,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/TimeController":"TimeController","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../Util/NumberUtil":"NumberUtil","../Activity/ActivityController":"ActivityController","../Commons/CommonPageBG":"CommonPageBG","../Guide/GuideNewController":"GuideNewController","../LoardCrusadeWin/LoardCrusadeCtrl":"LoardCrusadeCtrl","../OpenWin/OpenWinController":"OpenWinController","../Role/RoleInfo":"RoleInfo","../SandTable/SandTableController":"SandTableController","../SandTable/SandTableMain":"SandTableMain","../Scene/Controller/SceneController":"SceneController","../Scene/Manager/SceneManager":"SceneManager","../Status/StatusController":"StatusController","../Status/StatusType":"StatusType","./HighLadderController":"HighLadderController"}],Language:[function(e,t,i){"use strict";cc._RF.push(t,"2e05bCV2n5AHYUYTVKHyxJn","Language"),Object.defineProperty(i,"__esModule",{value:!0});var n=cc._decorator,o=n.ccclass,a=(n.property,function(){function e(){}var t;return t=e,e.getStr=function(e){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];var o=t.i18n[e];if(o||console.warn("\u6ca1\u6709\u8bed\u8a00\u5305 \uff1a "+e),o&&null!=i&&i.length>0)for(var a=void 0,r=0;r<i.length;r++)a="\\{"+r+"\\}",o=o.replace(new RegExp(a,"g"),i[r]);return o||""},e.getStr1=function(e,t){if(e&&null!=t&&t.length>0)for(var i=void 0,n=0;n<t.length;n++)i="\\{"+n+"\\}",e=e.replace(new RegExp(i,"g"),t[n]);return e||""},e.i18n={"\u4e2d\u6587key1":"\u4e2d\u6587\u5185\u5bb91","\u4e2d\u6587key2":"\u4e2d\u6587\u5185\u5bb92 {0}",common1:"\u8d2d\u4e70",common2:"\u5df2\u8d2d\u4e70",common3:"\u672c\u6b21\u767b\u5f55\u4e0d\u518d\u63d0\u793a",100:"\u524d\u671f\u5b9d\u7bb1\u4f5c\u4e3a\u6559\u5b66\u4f7f\u7528\uff0c\u4e0d\u53ef\u624b\u52a8\u62d6\u52a8\uff0c\u8bf7\u62d6\u52a8\u6218\u961f\u89d2\u8272\uff0c\u8fdb\u884c\u4e09\u6d88\u5408\u6210",101:"<outline color=block width=2>\u524d\u671f\u5b9d\u7bb1\u4f5c\u4e3a\u6559\u5b66\u4f7f\u7528\uff0c\u4e0d\u53ef\u624b\u52a8\u62d6\u52a8\uff0c\u8bf7\u62d6\u52a8<color=#f6ff00>\u6218\u961f\u89d2\u8272</color>\uff0c\u8fdb\u884c\u4e09\u6d88\u5408\u6210</outline>",version:"\u5f53\u524d\u7248\u672c\u53f7\uff1a",updateversion:"\u6b63\u5728\u66f4\u65b0\u7248\u672c\uff1a",fightinfomomsterdesc1:"\u5361\u724c\u5269\u4f59\u6570\u91cf\uff1a",fightinfomomsterdesc2:"\u4e0b\u4e00\u8f6e\u4fdd\u7559\u602a\u7269\uff1a",wave:"\u7b2c{0}\u6ce2",endwave:"\u6700\u540e\u4e00\u6ce2","\u9700\u8981 {0} \u7ea7\u5f00\u542f":"\u9700\u8981 {0} \u7ea7\u5f00\u542f","\u529f\u80fd\u672a\u5f00\u542f":"\u529f\u80fd\u672a\u5f00\u542f","\u8f93\u5165\u4e0d\u80fd\u4e3a\u7a7a":"\u8f93\u5165\u4e0d\u80fd\u4e3a\u7a7a","\u6027\u522b\u4e0d\u5bf9":"\u6027\u522b\u4e0d\u5bf9","\u540d\u5b57\u4e3a\u7a7a":"\u540d\u5b57\u4e3a\u7a7a","\u540d\u5b57\u91cd\u590d":"\u540d\u5b57\u91cd\u590d","\u540d\u5b57\u5305\u542b\u654f\u611f\u5b57":"\u540d\u5b57\u5305\u542b\u654f\u611f\u5b57","\u540d\u5b57\u5df2\u8fbe\u5230\u6700\u5927\u957f\u5ea6\u3002\u6700\u5927\u957f\u5ea6\u4e3a\u5fae\u4fe1\u540d\u5b57\u7684\u6700\u5927\u957f\u5ea6":"\u540d\u5b57\u5df2\u8fbe\u5230\u6700\u5927\u957f\u5ea6\u3002","\u6536\u96c6{0}\u628a\u94a5\u5319\u540e\u53ef\u6311\u6218":"\u6536\u96c6{0}\u628a\u94a5\u5319\u540e\u53ef\u6311\u6218","\u9700\u8981\u901a\u5173\u7ae0\u8282 {0} \u7684\u5173\u5361{1}\u5f00\u542f":"\u9700\u8981\u901a\u5173 {0} \u4e4b {1} \u5f00\u542f","\u5df2\u901a\u5173\uff0c\u4e0d\u53ef\u518d\u6b21\u6311\u6218":"\u5df2\u901a\u5173\uff0c\u4e0d\u53ef\u518d\u6b21\u6311\u6218","\u4f53\u529b\u4e0d\u8db3\uff0c\u9700\u8981\u6d88\u8017\u4f53\u529b {0}":"\u4f53\u529b\u4e0d\u8db3\uff0c\u9700\u8981\u6d88\u8017\u4f53\u529b {0}","\u6210\u529f":"\u6210\u529f","\u5931\u8d25":"\u5931\u8d25","\u8fdb\u5165\u5931\u8d25":"\u8fdb\u5165\u5931\u8d25","\u5df2\u7ecf\u5230\u9876\u4e86":"\u5df2\u7ecf\u5230\u9876\u4e86",grade_1:"\u666e\u901a\u5f62\u6001",grade_2:"\u9ad8\u7ea7\u5f62\u6001",grade_3:"\u7cbe\u82f1\u5f62\u6001",grade_4:"\u53f2\u8bd7\u5f62\u6001",grade_5:"\u4f20\u8bf4\u5f62\u6001","\u9650\u8d2d({0}/{1})":"\u9650\u8d2d({0}/{1})","\u672c\u6b21\u53ea\u80fd\u8d2d\u4e70\u4e00\u4e2a":"\u672c\u6b21\u53ea\u80fd\u8d2d\u4e70\u4e00\u4e2a","\u80cc\u5305\u7a7a\u95f4\u4e0d\u8db3":"\u80cc\u5305\u7a7a\u95f4\u4e0d\u8db3","\u4ed8\u8d39\u793c\u5305":"\u4ed8\u8d39\u793c\u5305","\u81ea\u9009\u793c\u5305":"\u81ea\u9009\u793c\u5305","\u8bf7\u5148\u9009\u62e9\u4e00\u79cd\u9053\u5177":"\u8bf7\u5148\u9009\u62e9\u4e00\u79cd\u9053\u5177","{0}\u4e0d\u8db3":"{0}\u4e0d\u8db3","\u9650\u8d2d{0}\u6b21":"\u9650\u8d2d{0}\u6b21",Dontpremit:"\u8be5\u9053\u5177\u4e0d\u5141\u8bb8\u51fa\u552e",ItemTips1:"\u6682\u65e0\u83b7\u53d6\u9014\u5f84",ItemCount:"\u6570\u91cf","\u5361\u724c\u5269\u4f59\u6218\u529b\u4e3a0":"\u5361\u724c\u5269\u4f59\u6218\u529b\u4e3a0","\u6682\u65e0\u6c99\u76d8\u6570\u636e":"\u6682\u65e0\u6c99\u76d8\u6570\u636e",function_open_tips:"\u9700\u8981\u901a\u5173 {0} \u7684 {1} \u5f00\u542f",function_finish_tips:"\u529f\u80fd\u5c1a\u672a\u63a8\u51fa\uff0c\u656c\u8bf7\u671f\u5f85",main_lin_name:"{0}\uff1a{1}",rule_error:"\u6b64\u7a97\u53e3id\uff1a{0} \u76f8\u5173\u89c4\u5219help\u8868\u672a\u914d\u7f6e",rule_title:"\u89c4\u5219",Role_1:"\u804c\u4e1a\u63cf\u8ff0",Role_2:"\u89d2\u8272\u5f62\u8c61",Role_3:"\u89d2\u8272\u4fe1\u606f",Role_4:"\u5f53\u524d\u7b49\u7ea7:",Role_5:"\u6b65\u6570:",Role_6:"\u57fa\u7840\u5c5e\u6027",Role_7:"\u4e94\u884c\u5c5e\u6027",Role_14:"(\u70b9\u51fb\u56fe\u6807\u5207\u6362)",Wuxing_notopen0:"\u901a\u5173\u7b2c\u4e03\u4e2a\u7ae0\u8282\u89e3\u9501",Step_shuoming:"\u9664\u4e3b\u7ebf\u526f\u672c\u4ee5\u5916\uff0c\u5176\u4ed6\u7684\u6d3b\u52a8\u73a9\u6cd5\u7684\u68cb\u76d8\u5747\u4f7f\u7528\u6b64\u6b65\u6570",SkinCardPower:"\u4e0a\u9635\u5361\u724c\u6218\u529b\u8fbe\u5230",RoleLevel:"\u7ea7",WindAttack:"\u98ce\u653b\u51fb",FireAttack:"\u706b\u653b\u51fb",WaterAttack:"\u6c34\u653b\u51fb",SoilAttack:"\u571f\u653b\u51fb",ThunderAttack:"\u96f7\u653b\u51fb",role_title:"\u79f0\u53f7",2000:"\u672a\u6fc0\u6d3b",2001:"<color=#fff600>{0}</color><color=#ffffff>/{1}</color>",2002:"Lv  {0}",2003:"{0}\u54c1\u8d28\u6fc0\u6d3b",2004:"{0}\u7ea7\u54c1\u8d28\u6fc0\u6d3b  <u>\u63d0\u54c1<u/>",2005:"\u91d1\u5e01\u4e0d\u8db3",2006:"\u6d17\u7ec3\u5c5e\u6027\u9ad8\u4e8e\u5f53\u524d\u503c\uff0c\u662f\u5426\u7ee7\u7eed\u6d17\u7ec3",2007:"\u8bf7\u5148\u6d17\u7ec3",2008:"\u51fa\u7ad9\u5361\u724c\u5c5e\u6027\u52a0\u6210:{0}%",2009:"\u6fc0\u6d3b",2010:"\u5e7b\u5316",2011:"\u66ff\u6362",2012:"\u6d17\u7ec3",2013:"{0}({1}/{2})",2014:"\u7c7b\u578b\uff1a<color=#f6ff00>\u88ab\u52a8\u6280\u80fd</color>",2015:"\u65f6\u88c5\u6548\u679c",2016:"{0}\u573a\u6218\u6597\u540e\u53ef\u4f7f\u7528",2017:"\u6218\u6597\u4e2d\u624d\u53ef\u91ca\u653e",role_title_none:"\u6682\u65e0\u79f0\u53f7",role_title_remaintime:"\u5269\u4f59\u65f6\u95f4\uff1a{0}",role_skin_title:"\u65f6\u88c5",2018:"\u63d0\u5347\u5230VIP{0}\u53ef\u589e\u52a0{1}\u6b21\u8d2d\u4e70\u6b21\u6570",2019:"\u8d2d\u4e70\u6b21\u6570\u5df2\u7528\u5b8c",2020:"\u5934\u50cf\u8bbe\u7f6e",2021:"\u53d6\u6d88",2022:"\u786e\u5b9a",2023:"\u89e3\u9501\u5bf9\u5e94\u65f6\u88c5\u5373\u53ef\u83b7\u5f97\u5934\u50cf",2024:"\u8bbe\u7f6e\u6210\u529f",2201:"\u5361\u724c\u788e\u7247",2202:"\u5377\u8f74",2203:"\u88c5\u5907",2204:"\u5f3a\u5316\u6750\u6599",2205:"\u5176\u4ed6",2206:"\u914d\u9970",2210:"\u4f4d\u7f6e\uff1a",2211:"\u524d\u6392",2212:"\u4e2d\u6392",2213:"\u540e\u6392",attr_type_0:"\u751f\u547d",attr_type_1:"\u653b\u51fb",attr_type_2:"\u9632\u5fa1",attr_type_3:"\u547d\u4e2d",attr_type_4:"\u95ea\u907f",attr_type_5:"\u66b4\u51fb",attr_type_6:"\u97e7\u6027",attr_type_7:"\u96f7\u653b",attr_type_8:"\u96f7\u9632",attr_type_9:"\u571f\u653b",attr_type_10:"\u571f\u9632",attr_type_11:"\u6c34\u653b",attr_type_12:"\u6c34\u9632",attr_type_13:"\u706b\u653b",attr_type_14:"\u706b\u9632",attr_type_15:"\u98ce\u653b",attr_type_16:"\u98ce\u9632",attr_type_0_blank:"\u751f       \u547d",attr_type_1_blank:"\u653b       \u51fb",attr_type_2_blank:"\u9632       \u5fa1",attr_type_3_blank:"\u547d       \u4e2d",attr_type_4_blank:"\u95ea       \u907f",attr_type_5_blank:"\u66b4       \u51fb",attr_type_6_blank:"\u97e7       \u6027",attr_type_7_blank:"\u96f7       \u653b",attr_type_8_blank:"\u96f7       \u9632",attr_type_9_blank:"\u571f       \u653b",attr_type_10_blank:"\u571f       \u9632",attr_type_11_blank:"\u6c34       \u653b",attr_type_12_blank:"\u6c34       \u9632",attr_type_13_blank:"\u706b       \u653b",attr_type_14_blank:"\u706b       \u9632",attr_type_15_blank:"\u98ce       \u653b",attr_type_16_blank:"\u98ce       \u9632",attr_type_300:"\u524d\u6392\u751f\u547d",attr_type_301:"\u524d\u6392\u653b\u51fb",attr_type_302:"\u524d\u6392\u9632\u5fa1",attr_type_303:"\u524d\u6392\u547d\u4e2d",attr_type_304:"\u524d\u6392\u95ea\u907f",attr_type_305:"\u524d\u6392\u66b4\u51fb",attr_type_306:"\u524d\u6392\u97e7\u6027",attr_type_307:"\u524d\u6392\u96f7\u653b",attr_type_308:"\u524d\u6392\u96f7\u9632",attr_type_309:"\u524d\u6392\u571f\u653b",attr_type_310:"\u524d\u6392\u571f\u9632",attr_type_311:"\u524d\u6392\u6c34\u653b",attr_type_312:"\u524d\u6392\u6c34\u9632",attr_type_313:"\u524d\u6392\u706b\u653b",attr_type_314:"\u524d\u6392\u706b\u9632",attr_type_315:"\u524d\u6392\u98ce\u653b",attr_type_316:"\u524d\u6392\u98ce\u9632",attr_type_400:"\u4e2d\u6392\u751f\u547d",attr_type_401:"\u4e2d\u6392\u653b\u51fb",attr_type_402:"\u4e2d\u6392\u9632\u5fa1",attr_type_403:"\u4e2d\u6392\u547d\u4e2d",attr_type_404:"\u4e2d\u6392\u95ea\u907f",attr_type_405:"\u4e2d\u6392\u66b4\u51fb",attr_type_406:"\u4e2d\u6392\u97e7\u6027",attr_type_407:"\u4e2d\u6392\u96f7\u653b",attr_type_408:"\u4e2d\u6392\u96f7\u9632",attr_type_409:"\u4e2d\u6392\u571f\u653b",attr_type_410:"\u4e2d\u6392\u571f\u9632",attr_type_411:"\u4e2d\u6392\u6c34\u653b",attr_type_412:"\u4e2d\u6392\u6c34\u9632",attr_type_413:"\u4e2d\u6392\u706b\u653b",attr_type_414:"\u4e2d\u6392\u706b\u9632",attr_type_415:"\u4e2d\u6392\u98ce\u653b",attr_type_416:"\u4e2d\u6392\u98ce\u9632",attr_type_500:"\u540e\u6392\u751f\u547d",attr_type_501:"\u540e\u6392\u653b\u51fb",attr_type_502:"\u540e\u6392\u9632\u5fa1",attr_type_503:"\u540e\u6392\u547d\u4e2d",attr_type_504:"\u540e\u6392\u95ea\u907f",attr_type_505:"\u540e\u6392\u66b4\u51fb",attr_type_506:"\u540e\u6392\u97e7\u6027",attr_type_507:"\u540e\u6392\u96f7\u653b",attr_type_508:"\u540e\u6392\u96f7\u9632",attr_type_509:"\u540e\u6392\u571f\u653b",attr_type_510:"\u540e\u6392\u571f\u9632",attr_type_511:"\u540e\u6392\u6c34\u653b",attr_type_512:"\u540e\u6392\u6c34\u9632",attr_type_513:"\u540e\u6392\u706b\u653b",attr_type_514:"\u540e\u6392\u706b\u9632",attr_type_515:"\u540e\u6392\u98ce\u653b",attr_type_516:"\u540e\u6392\u98ce\u9632",attr_type_600:"\u90e8\u961f\u4eba\u6570",attr_type_601:"\u6b65\u6570",attr_type_602:"\u5361\u724c\u7b49\u7ea7",attr_type_603:"\u6280\u80fd\u5929\u8d4b",attr_type_700:"\u5168\u5361\u724c\u5c5e\u6027",attr_type_701:"\u96f7\u5c5e\u6027",attr_type_702:"\u571f\u5c5e\u6027",attr_type_703:"\u6c34\u5c5e\u6027",attr_type_704:"\u706b\u5c5e\u6027",attr_type_705:"\u98ce\u5c5e\u6027",attr_type_706:"\u524d\u6392\u5168\u5361\u724c\u5c5e\u6027",attr_type_707:"\u4e2d\u6392\u5168\u5361\u724c\u5c5e\u6027",attr_type_708:"\u540e\u6392\u5168\u5361\u724c\u5c5e\u6027",attr_type_709:"\u989d\u5916\u4f24\u5bb3",attr_type_710:"\u4f24\u5bb3",attr_type_711:"\u514d\u4f24",attr_type_800:"\u96f7\u5361\u751f\u547d",attr_type_801:"\u96f7\u5361\u653b\u51fb",attr_type_802:"\u96f7\u5361\u9632\u5fa1",attr_type_803:"\u96f7\u5361\u547d\u4e2d",attr_type_804:"\u96f7\u5361\u95ea\u907f",attr_type_805:"\u96f7\u5361\u66b4\u51fb",attr_type_806:"\u96f7\u5361\u97e7\u6027",attr_type_900:"\u571f\u5361\u751f\u547d",attr_type_901:"\u571f\u5361\u653b\u51fb",attr_type_902:"\u571f\u5361\u9632\u5fa1",attr_type_903:"\u571f\u5361\u547d\u4e2d",attr_type_904:"\u571f\u5361\u95ea\u907f",attr_type_905:"\u571f\u5361\u66b4\u51fb",attr_type_906:"\u571f\u5361\u97e7\u6027",attr_type_1000:"\u6c34\u5361\u751f\u547d",attr_type_1001:"\u6c34\u5361\u653b\u51fb",attr_type_1002:"\u6c34\u5361\u9632\u5fa1",attr_type_1003:"\u6c34\u5361\u547d\u4e2d",attr_type_1004:"\u6c34\u5361\u95ea\u907f",attr_type_1005:"\u6c34\u5361\u66b4\u51fb",attr_type_1006:"\u6c34\u5361\u97e7\u6027",attr_type_1100:"\u706b\u5361\u751f\u547d",attr_type_1101:"\u706b\u5361\u653b\u51fb",attr_type_1102:"\u706b\u5361\u9632\u5fa1",attr_type_1103:"\u706b\u5361\u547d\u4e2d",attr_type_1104:"\u706b\u5361\u95ea\u907f",attr_type_1105:"\u706b\u5361\u66b4\u51fb",attr_type_1106:"\u706b\u5361\u97e7\u6027",attr_type_1200:"\u98ce\u5361\u751f\u547d",attr_type_1201:"\u98ce\u5361\u653b\u51fb",attr_type_1202:"\u98ce\u5361\u9632\u5fa1",attr_type_1203:"\u98ce\u5361\u547d\u4e2d",attr_type_1204:"\u98ce\u5361\u95ea\u907f",attr_type_1205:"\u98ce\u5361\u66b4\u51fb",attr_type_1206:"\u98ce\u5361\u97e7\u6027",strong_recommend:"\u63a8\u8350\u6218\u529b\uff1a{0}",strong_reward_tips:"\u6218\u529b\u8fbe\u5230<color=#fff000>{0}</color>\u53ef\u9886\u53d6",strong_item_combat:"<color=#301810>{0}\uff1a</color><color=#87361c>{1}/{2}</color>",strong_enter_error:"\u5f53\u5929\u6311\u6218\u6b21\u6570\u5df2\u7528\u5b8c\uff0c\u8bf7\u7b49\u5f85\u5237\u65b0","VIP{0}\u7279\u6743":"VIP{0}\u7279\u6743","\u5df2\u8d2d\u4e70":"\u5df2\u8d2d\u4e70","\u8d2d \u4e70":"\u8d2d \u4e70","\u8d2d\u4e70VIP{0}\u793c\u5305":"\u8d2d\u4e70VIP{0}\u793c\u5305",vip_01:"\u798f\u5229",vip_02:"VIP{0}\u793c\u5305",vip_03:"\u518d\u5145\u503c{0}","(\u518d\u5145\u503c{0}":"(\u518d\u5145\u503c{0}","\u5df2\u9886\u53d6":"\u5df2\u9886\u53d6","\u5145 \u503c":"\u5145 \u503c","\u9886 \u53d6":"\u9886 \u53d6","\u9996 \u5145":"\u9996 \u5145","\u9996\u5145\u56e2\u8d2d":"\u9996\u5145\u56e2\u8d2d",activity_return_status_desc:"\uff08<color=#c203f2>{0}</color>/{1}\uff09","\u6d3b\u52a8\u672a\u5f00\u542f":"\u6d3b\u52a8\u672a\u5f00\u542f",SingleRechargeRebate_01:"\u5145\u503c\u5df2\u8fbe\u5230",SingleRechargeRebate_02:"\u518d\u5145\u503c<color=#87361c>{0}\u5143</color>\u53ef\u9886\u53d6",activity_hall_ready:"\u5373\u5c06\u5f00\u59cb...",activity_hall_jinxing:"\u8fdb\u884c\u4e2d...",activity_hall_level_elite:"{0}\u7ea7\u7cbe\u82f1boss",activity_hall_elite_no_open:"\u7b49\u7ea7\u672a\u8fbe\u5230,\u5c1a\u4e0d\u53ef\u8fdb\u5165",activity_hall_enter_error:"\u5f53\u5929\u6311\u6218\u6b21\u6570\u5df2\u7528\u5b8c\uff0c\u8bf7\u7b49\u5f85\u660e\u5929\u5237\u65b0",activity_hall_nextOpen:"{0}\u5f00\u542f",not_enough_0:"\u91d1\u5e01",not_enough_1:"\u94bb\u77f3",not_enough_2:"\u8363\u8a89",not_enough_3:"\u79ef\u5206",not_enough_4:"\u6d3b\u8dc3\u5ea6",not_enough_200:"\u4f53\u529b",channel_1:"\u4e16\u754c",channel_2:"\u597d\u53cb",channel_3:"\u7cfb\u7edf",channel_4:"\u8be5\u9891\u9053\u4e0d\u80fd\u53d1\u8a00\uff0c\u8bf7\u5207\u6362\u5176\u4ed6\u9891\u9053",Chat_Tips1:"\u70b9\u51fb\u8fd9\u91cc\uff0c\u5f00\u59cb\u804a\u5929",Chat_Tips2:"\u70b9\u51fb\u8f93\u5165\uff0c\u4e0a\u965050\u5b57",Chat_Tips3:"\u8bf7\u52ff\u76f8\u4fe1\u4efb\u4f55\u4ee3\u7406\u5145\u503c\u5e7f\u544a\uff0c\u795d\u6e38\u620f\u6109\u5feb",Chat_Tips4:"\u4f60\u6709\u4e00\u6761\u65b0\u6d88\u606f",Chat_Tips5:"\u65b0\u6d88\u606f",Chat_Tips6:"\u53d1\u9001\u9891\u7e41\uff0c\u8bf7\u4f11\u606f\u4e00\u4f1a\u513f",Chat_Tips7:"\u9009\u4e2d\u4e00\u4f4d\u597d\u53cb\u8fdb\u884c\u804a\u5929",Chat_Tips8:"\u9700\u8981\u7b49\u7ea7{0}\u624d\u80fd\u53d1\u9001\u6d88\u606f",Chat_Tips9:"{0}\u79d2\u540e\u624d\u80fd\u53d1\u8a00",state_1:"\u5728\u7ebf",state_2:"\u79bb\u7ebf",state_3:"\u4e0e{0}\u804a\u5929",name:"\u59d3\u540d",Sex:"\u6027\u522b",Dan:"\u6bb5\u4f4d",sendBtn:"\u53d1 \u9001",Nohave:"\u65e0",1000:"\u3010{0}\u670d\u3011{1}",gender_0:"\u7537",gender_1:"\u5973",3000:"\u53d1\u8d77\u597d\u53cb\u804a\u5929",3001:"{0}\u524d",3002:"\u4e0d\u662f\u540c\u670d\u73a9\u5bb6\uff0c\u4e0d\u80fd\u6dfb\u52a0\u5bf9\u65b9\u4e3a\u597d\u53cb",3003:"\u4f60\u5df2\u88ab\u5bf9\u65b9\u5c4f\u853d",3004:"\u4f60\u5df2\u5c4f\u853d\u5bf9\u65b9",3005:"\u4e0d\u540c\u533a\u670d\u73a9\u5bb6\u65e0\u6cd5\u79c1\u804a",3006:"\u6b22\u8fce<color=#00ca47>{0}</color>\u6765\u5230\u53f2\u83b1\u59c6\u4e16\u754c",3007:"<color=#301810>{0}/<color=#87361c>{1}</color></color>",3008:"\u53ea\u6709\u5f00\u901a\u4e86vip4\u7684\u7528\u6237\u624d\u80fd\u4f7f\u7528\u7279\u6548\u8868\u60c5\u5305\u54e6",3009:"\u7b97\u4e86",3010:"\u5f00\u901a",3011:"\u5185\u5bb9\u8fc7\u957f",3012:"\u5185\u5bb9\u4e3a\u7a7a",3013:"{0}\u79d2\u540e\u624d\u80fd\u53d1\u8a00",3014:"\u88ab\u7981\u8a00",Last_Time1:"\u5929",Last_Time2:"\u5c11\u4e8e",Last_Time3:"\u6bb5\u4f4d\u8fbe\u5230{0}\u7ea7",Last_Time4:"\u6bb5\u4f4d\u8fbe\u5230\u4f20\u8bf4",arena_rewardinfo_title:"\u5956\u52b1\u4fe1\u606f",4000:"\u81f3\u5c11\u9700\u8981\u53c2\u52a0\u4e00\u573a\u7ade\u6280\u573a\u6218\u6597",FriendsAdd:"\u6dfb\u52a0\u597d\u53cb",Cancel:"\u53d6\u6d88",Agree:"\u901a\u8fc7",Blacklist:"\u9ed1\u540d\u5355",CancelBlack:"\u53d6\u6d88\u5c4f\u853d",AllCancel:"\u4e00\u952e\u53d6\u6d88",AllAgree:"\u4e00\u952e\u901a\u8fc7",Applicationlist:"\u7533\u8bf7\u5217\u8868",AddFriends:"\u6dfb\u52a0\u597d\u53cb",Search:"\u641c\u7d22",PrivateChat:"\u79c1\u804a",PullBlack:"\u5c4f\u853d\u597d\u53cb",DeleteFriends:"\u5220\u9664\u597d\u53cb",Wrestle:"\u7f81\u7eca",FriendReminder:"\u60a8\u8fd8\u6ca1\u6709\u597d\u53cb\u54e6\uff0c\u5feb\u53bb\u6dfb\u52a0\u597d\u53cb\u4e00\u8d77\u73a9\u5427!",FriendsNumber:"\u597d\u53cb: {0}/{1}  ",InviteFri:"\u9080\u8bf7\u597d\u53cb",NoBlackListText:"\u6682\u672a\u5c4f\u853d\u4efb\u4f55\u73a9\u5bb6",searchResult:"\u641c\u7d22\u7ed3\u679c",recommandfriend:"\u63a8\u8350\u597d\u53cb",FriendUpLimit:"\u597d\u53cb\u6570\u91cf\u5df2\u6ee1",BlacklistUpLimit:"\u9ed1\u540d\u5355\u6570\u91cf\u5df2\u6ee1",cancelSuccess:"\u53d6\u6d88\u6210\u529f",addSuccess:"\u5df2\u6dfb\u52a0\u597d\u53cb",addBlacklist:"\u6dfb\u52a0\u9ed1\u540d\u5355",RefusedToAdd:"\u62d2\u7edd\u6dfb\u52a0",day:"{0}\u5929",hours:"{0}\u5c0f\u65f6",minutes:"{0}\u5206\u949f",seconds:"{0}\u79d2",qian:"\u524d",oneMinute:"1\u5206\u949f",addedFriends:"\u5df2\u6dfb\u52a0","\u4e00\u952e\u6dfb\u52a0":"\u4e00\u952e\u6dfb\u52a0","\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u6635\u79f0":"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u6635\u79f0",3500:"\u5df2\u5c4f\u853d",3501:"\u6dfb\u52a0\u597d\u53cb",3502:"\u5220\u9664\u597d\u53cb",3503:"\u5c4f\u853d\u4fe1\u606f",3504:"\u53d6\u6d88\u5c4f\u853d",3505:"\u73a9\u5bb6\u4fe1\u606f",3506:"\u5f53\u524d\u6218\u961f",3507:"<color=#5c3c34>\u73a9\u5bb6\u540d\u5b57\uff1a<color=#301810>{0}</color></color>",3508:"<color=#5c3c34>\u73a9\u5bb6\u7b49\u7ea7\uff1a<color=#87361c>{0}\u7ea7</color></color>",3509:"<color=#5c3c34>\u542f\u7a0b\u65e5\u671f\uff1a<color=#07a044>{0}</color></color>",3510:"<color=#5c3c34>\u5173\u5361\u8fdb\u5ea6\uff1a<color=#87361c>{0}\u7ae0</color></color>",3511:"<color=#5c3c34>\u5361\u724c\u6536\u96c6\uff1a<color=#87361c>{0}\u5f20</color></color>",3601:"\u6bcf{0}\u83b7\u5f97\u4e00\u6b21\u5956\u52b1",3602:"\u9700\u8981\u8bbe\u7f6e\u9635\u5bb9\u624d\u53ef\u4ee5\u8fdb\u884c\u6218\u6597",3603:"\u662f\u5426\u653e\u5f03\u539f\u5148{0}\u77ff\u8109\u6765\u5360\u636e\u8be5\u77ff\u8109\uff1f",3604:"<outline color=block width=2>\u5269\u4f59\u5956\u52b1\u6b21\u6570<color=#42fe00>{0}</color>/{1}</outline>",3605:"\u6709\u6982\u7387\u83b7\u5f97",3606:"\u83b7\u5f97\u5956\u52b1",3607:"<color=#c203f2>{0}</c><color=#301810>\u88ad\u51fb\u4e86\u60a8\u7684\u77ff\u8109\uff0c\n\u60a8\u6210\u529f\u7684\u5b88\u62a4\u4e0b\u6765</color>",3608:"<color=#c203f2>{0}</c><color=#301810>\u88ad\u51fb\u4e86\u60a8\u7684\u77ff\u8109\u6210\u529f\uff0c\n\u5360\u9886\u4e86\u60a8\u7684\u77ff\u8109\uff01\u60a8\u672c\u6b21\u7684\u5360\u9886\u65f6\u957f\u4e3a<color=#00ca47>{1}</color></color>",3609:"\u67e5 \u770b",3610:"\u590d \u4ec7",3611:"\u5360 \u9886",3612:"\u5269\u4f59\u65f6\u95f4\uff1a<color=#00ca47>{0}</color>",3613:"{0}    \u83b7\u5f97{1}\u77ff\u5305\uff0c\n\u4ea7\u751f\u4e86{2}\u75b2\u52b3\u503c\uff0c\u6263\u9664{3}\u70b9\u6218\u6597\u529b",3614:"{0}\u77ff\u8109",3615:"\u9886\u53d6\u5956\u52b1",3616:"\u653e\u5f03\u5360\u9886",3617:"\u77ff\u8109\u54c1\u8d28\u8d8a\u9ad8\uff0c\u4ea7\u51fa\u7684\u94bb\u77f3\u77ff\u5305\u6982\u7387\u8d8a\u9ad8",3618:"\u5bf9\u65b9\u77ff\u8109\u5df2\u7ecf\u5931\u5b88",3619:"\u5956\u52b1\u6b21\u6570\u5df2\u7528\u5b8c\uff0c\u63d0\u5347VIP\u7b49\u7ea7\u53ef\u589e\u52a0\u5956\u52b1\u6b21\u6570",3620:"\u6311\u6218\u8bb0\u5f55",3621:"\u63a0 \u593a",3622:"{0}\u7ea7\u624d\u53ef\u4ee5\u5360\u636e{1}\u77ff\u8109",3623:"\u662f\u5426\u786e\u8ba4\u653e\u5f03\u5360\u9886\u8be5\u77ff\u8109",3624:"\u5956\u52b1\u6b21\u6570\u4e0d\u8db3\uff0c\u65e0\u6cd5\u5360\u9886",3625:"\u9700\u8981\u8bbe\u7f6e\u9635\u5bb9\u624d\u53ef\u4ee5\u8fdb\u5165\u6218\u6597",3626:"\u6682\u672a\u8bbe\u7f6e\u9635\u5bb9",3627:"\u77ff\u8109\u6b63\u5728\u53d1\u751f\u4e89\u593a\uff0c\u8bf7\u7a0d\u540e\u518d\u6765",3628:"{0}\u79d2\u540e\u81ea\u52a8\u5173\u95ed",3630:"\u94c1",3631:"\u94f6",3632:"\u91d1",3633:"\u94bb\u77f3",Liveness:"\u6d3b\u8dc3\u5ea6",Get:"\u9886\u53d6",Go:"\u524d\u5f80",FetterNumber:"\u7ed3\u4f34\u4eba\u6570",DailyTip:"\u9886\u53d6\u6210\u529f",FetterTip_:"\u7533\u8bf7\u6210\u529f",FetterTip_1:"\u5bf9\u65b9\u5df2\u7f81\u7eca",FetterTip_2:"\u7f81\u7eca\u5df2\u6ee1",FetterTip_3:"\u5df2\u7f81\u7eca",FettetTip_4:"\u7f81\u7eca\u5df2\u6ee1",FettetTip_5:"\u53cc\u65b9\u90fd\u6709\u7f81\u7eca",FettetTip_6:"\u52a0\u5165\u6210\u529f",MailTip_1:"\u6ca1\u6709\u90ae\u4ef6\u53ef\u4ee5\u9886\u53d6\u4e86",MailTip_2:"\u6ca1\u6709\u53ef\u5220\u9664\u7684\u90ae\u4ef6",MailTip_3:"\u9886\u53d6\u6210\u529f",MailTip_4:"\u5220\u9664\u6210\u529f",MailTip_5:"\u4e0d\u53ef\u5220\u9664\u672a\u8bfb\u90ae\u4ef6",MailTip_6:"\u6ca1\u6709\u90ae\u4ef6\u53ef\u4ee5\u5220\u9664",MailTip_7:"\u6ca1\u6709\u9644\u4ef6\u53ef\u4ee5\u9886\u53d6",Delete:"\u5220\u9664","\u90ae\u4ef6\u6570\u91cf\uff1a{0}/{1}":"\u90ae\u4ef6\u6570\u91cf\uff1a{0}/{1}","\u6709\u6548\u65f6\u95f4\uff1a":"\u6709\u6548\u65f6\u95f4\uff1a","{0}\u5929{1}\u5c0f\u65f6":"{0}\u5929{1}\u5c0f\u65f6",Purification:"\u597d\u53cb\u5df2\u7ecf\u51c0\u5316\u4e86{0}",Helpcount:"\u5269\u4f59\u6b21\u6570",TipsFont:"\u51c0\u5316\u4e94\u4e2a\u56fe\u817e\u624d\u80fd\u89e3\u6551\u795e\u50cf",TipsFont1:"\u5b8c\u6210\u540e\u5956\u52b1\u901a\u8fc7\u90ae\u4ef6\u53d1\u653e",Times:"{0}",Help:"\u52a9\u597d\u53cb",Seek:"\u6c42",A:"\u4e2a",FridbossTip1:"(\u4eca\u5929\u5269\u4f59{0}\u4e2a\u5c01\u5370\u9700\u8981\u89e3\u9664)",FridbossTip2:"\u6bcf\u4e2a\u597d\u53cb\u53ea\u80fd\u534f\u52a9\u60a8\u89e3\u9501\u4e00\u4e2a\u5c01\u5370",FridbossTip3:"\u5206\u4eab\u6e38\u620f\uff0c\u9080\u8bf7\u597d\u53cb\u534f\u52a9\u89e3\u9501\u5c01\u5370",FridbossTip4:"(\u9700\u8981\u5df2\u5f00\u542f\u73a9\u6cd5\u7684\u597d\u53cb\u901a\u8fc7\u5fae\u4fe1\u94fe\u63a5\u8fdb\u5165\u51fb\u6740\u602a\u7269)",FridbossRule1:"1.\u8fd9\u662f\u4e00\u4e2a\u5408\u4f5c\u73a9\u6cd5\uff0c\u73a9\u5bb6\u9664\u4e86\u8981\u81ea\u5df1\u51fb\u6740\u602a\u7269\uff0c\u8fd8\u9700\u8981\u534f\u540c\u5fae\u4fe1\u597d\u53cb\uff0c\u5e2e\u52a9\u81ea\u5df1\u51c0\u5316\u96d5\u50cf",FridbossRule2:"2.\u6bcf\u5929\u73a9\u5bb6\u80fd\u653b\u51fb\u602a\u72691\u6b21\uff0c\u9080\u8bf7\u597d\u53cb\u51c0\u5316\u5269\u4f59\u56fe\u817e",FridbossRule3:"3.\u597d\u53cb\u5fc5\u987b\u901a\u8fc7\u60a8\u7684\u5fae\u4fe1\u94fe\u63a5\uff0c\u70b9\u51fb\u8fdb\u5165\u6e38\u620f\uff0c\u624d\u80fd\u51c0\u5316\u56fe\u817e",FridbossRule4:"4.\u60a8\u6bcf\u5929\u4e5f\u6709\u82e5\u5e72\u6b21\u6570\uff0c\u53ef\u4ee5\u901a\u8fc7\u597d\u53cb\u7684\u5fae\u4fe1\u94fe\u63a5\u5e2e\u52a9\u4ed6\u4eec",FridbossRule5:"5.\u53ea\u67095\u6839\u56fe\u817e\u90fd\u88ab\u51c0\u5316\u4ee5\u540e\uff0c\u96d5\u50cf\u624d\u80fd\u89e3\u9664\u8bc5\u5492",FridbossRule6:"6.\u89e3\u9664\u8bc5\u5492\u540e\uff0c\u8fdc\u53e4\u4e4b\u795e\u7684\u6069\u8d50\u5c06\u4f1a\u53d1\u653e\u4e30\u5bcc\u7684\u5956\u52b1\u7ed9\u4e88\u73a9\u5bb6",FridbossRuletitle:"\u597d\u53cbboss\u89c4\u5219",WeChatFri:"\u5fae\u4fe1\u597d\u53cb",Sure:"\u786e\u5b9a",SharpAdd:"\u5206\u4eab\u52a0\u6b65\u6570",fightlimit:"\u6bcf\u65e5\u81ea\u5df1\u7684boss\u53ea\u53ef\u6218\u6597\u4e00\u6b21",fight:"\u6218\u6597",helpFriendBoss:"\u5e2e\u52a9",SharpFair:"\u5206\u4eab\u5931\u8d25",retry:"\u8bf7\u91cd\u8bd5",DontOpen:"\u73a9\u5bb6\u672a\u5f00\u542f",againChallenge:"\u540c\u4e00\u597d\u53cbboss\u6bcf\u65e5\u53ea\u53ef\u6311\u6218\u4e00\u6b21",ChallengeLiit:"\u8be5\u597d\u53cbboss\u5df2\u8fbe\u6bcf\u65e5\u6311\u6218\u4e0a\u9650",ThankFrid:"\u611f\u8c22",FindHelp:"\u6c42\u52a9",successkill:"\u6210\u529f\u5e2e\u52a9\u4f60\u51fb\u6740\u4e86",InviteTips:"\u51fb\u6740\u6240\u6709BOSS\u53ef\u89e3\u9501\u5b9d\u7bb1\u5c01\u5370",BossNum:"\u5269\u4f59Boss\uff1a{0}","\u6c42\u52a9\u6210\u529f":"\u6c42\u52a9\u6210\u529f","\u5df2\u5728\u8be5\u597d\u53cb\u573a\u666f":"\u5df2\u5728\u8be5\u597d\u53cb\u573a\u666f","\u4eca\u5929\u5df2\u7ecf\u5e2e\u52a9\u8fc7\u4ed6\u4e86\uff0c\u660e\u5929\u518d\u6765\u5427":"\u4eca\u5929\u5df2\u7ecf\u5e2e\u52a9\u8fc7\u4ed6\u4e86\uff0c\u660e\u5929\u518d\u6765\u5427","\u4f20\u8bf4{0}\u5206":"\u4f20\u8bf4{0}\u5206","{0}\u7ea7":"{0}\u7ea7","{0}\u661f":"{0}\u661f","\u672a\u4e0a\u699c":"\u672a\u4e0a\u699c","\u672a\u4e0a\u6bb5":"\u672a\u4e0a\u6bb5",rankList_0:"\u6211\u7684\u7b49\u7ea7:",rankList_1:"\u6211\u7684\u6218\u529b:",rankList_2:"\u9635\u5bb9\u6218\u529b:",rankList_3:"\u6211\u7684\u6bb5\u4f4d:",rankList_reward_0:"\u5360\u4f4d\u6587\u672c",rankList_reward_1:"\u5360\u4f4d\u6587\u672c",rankList_reward_2:"<color=#5c3c34>\u6bcf\u665a22\u70b9\u7ed3\u7b97,\u4ee5\u90ae\u4ef6\u7684\u5f62\u5f0f\u53d1\u653e</color><color=#87361c>\u5956\u52b1</color>",rankList_reward_3:"\u5360\u4f4d\u6587\u672c",nowOpen:"\u7acb\u5373\u6253\u5f00",nowOpenkey:"\u7acb\u5373\u5f00\u9501",nowActivit:"\u6fc0   \u6d3b",BoxTips1:"\u5206\u4eab\u8be5\u6e38\u620f\uff0c\u51cf\u5c11\u8be5\u5b9d\u7bb1\u51b7\u5374{0}\u79d2",BoxTips2:"\u5b8c\u6574\u770b\u5e7f\u544a\uff0c\u51cf\u5c11\u8be5\u5b9d\u7bb1\u51b7\u5374{0}\u79d2",BoxTips3:"\u5206\u4eab",BoxTips4:"\u770b\u5e7f\u544a",BoxTips5:"\u6700\u5927\u53ef\u540c\u65f6\u89e3\u9501\u5b9d\u7bb1\u6570:",BoxTips6:"\u6709\u6982\u7387\u83b7\u5f97:",BoxTips7:"\u662f\u5426\u6d88\u8017{0}\u94bb\u77f3\u89e3\u9501\u5b9d\u7bb1:",DiamondTip:"\u94bb\u77f3\u6570\u4e0d\u591f",SharpLimit:"\u4eca\u65e5\u5df2\u8fbe\u5230{0}\u4e0a\u9650\u4e86\uff0c\u8bf7\u660e\u65e5\u518d\u8bd5",equipcopy_box_title:"\u88c5\u5907\u5b9d\u7bb1",equipcopy_max_level:"\u5df2\u5230\u8fbe\u6700\u9ad8\u5c42\uff0c\u8bf7\u91cd\u7f6e\u540e\u518d\u8fdb\u884c\u6311\u6218",equipcopy_attr_add_title:"\u5c5e\u6027\u52a0\u6210",equipcopy_wipe_title:"\u626b\u8361",equipcopy_challenge_count:"\u6311\u6218\u6b21\u6570\uff1a{0}",equipcopy_level_condition:"\u901a\u5173\u6311\u6218\uff1a{0}",equipcopy_condition_error:"\u65f6\u95f4\u5185\u672a\u80fd\u51fb\u6740\u6240\u6709\u602a\u7269",equipcopy_condition_1:"\u51fb\u6740\u6240\u6709\u602a\u7269",equipcopy_condition_2:"\u5269\u4f59\u602a\u7269\u6570\u91cf\uff1a<color=#f6ff00>{0}</color>",equipcopy_condition_3:"<color=#f6ff00>{0}</color>\u79d2\u5185\u51fb\u6740\u6240\u6709\u602a\u7269",equipcopy_attr_buy_tips:"\u5f53\u524d\u5269\u4f59{0}\u661f\uff0c\u8fd8\u53ef\u4ee5\u7ee7\u7eed\u8d2d\u4e70\uff0c\u662f\u5426\u653e\u5f03\u9009\u62e9\u5c5e\u6027\u7ee7\u7eed\u95ef\u5173\uff1f",equipcopy_box_open_tips:"\u662f\u5426\u82b1\u8d39{0}\u94bb\u77f3\u518d\u6b21\u5f00\u542f\u5b9d\u7bb1\uff1f",equipcopy_box_open_tips_2:"\u662f\u5426\u82b1\u8d39{0}\u94bb\u77f3\u6253\u5f00\u5b9d\u7bb1{1}\u6b21\uff1f",equipcopy_attr_add_percent:"+{0}%",equipcopy_attr_add_value:"+{0}",equipcopy_enter_error:"\u8bf7\u5148\u901a\u8fc7{0}\uff0c\u518d\u6311\u6218\u6b64\u5173\u5361",equipcopy_enter_error_1:"\u60a8\u7684\u6311\u6218\u6b21\u6570\u5df2\u7528\u5b8c\uff0c\u8bf7\u8d2d\u4e70\u6311\u6218\u6b21\u6570\u6216\u660e\u5929\u518d\u6765\u6311\u6218",equipcopy_next_tips:"\u4e0b\u4e00\u5173\u63d0\u793a\uff1a{0}",equipcopy_box_remain_open_count:"\uff08\u5269\u4f59{0}\u6b21\uff09",equipcopy_wipe_box_open_value:"\u5df2\u5f00\u542f{0}/{1}\u6b21",equipcopy_addfightcount_error:"\u6bcf\u5929\u81f3\u591a\u53ea\u80fd\u8d2d\u4e702\u6b21\uff0c\u5f53\u524d\u5df2\u4f7f\u7528\u5b8c",equipcopy_addfightcount_desc:"\u662f\u5426\u82b1\u8d39{0}\u94bb\u77f3\u589e\u52a0\u6311\u6218\u6b21\u6570\uff1f",equipcopy_wipe_shop_error:"\u5f53\u524d\u672a\u8d2d\u4e70\u5c5e\u6027\uff0c\u662f\u5426\u8df3\u8fc7\u5c5e\u6027\u8d2d\u4e70\uff1f",equipcopy_reset_error:"\u91cd\u7f6e\u6b21\u6570\u5df2\u7528\u5b8c",equipcopy_reset_error_1:"\u9700\u8981Vip{0}\u624d\u53ef\u4ee5\u8fdb\u884c\u91cd\u7f6e",equipcopy_wipe_error:"\u5f53\u524d\u65e0\u53ef\u626b\u8361\u5173\u5361",equipcopy_buy_attr_error:"\u661f\u6570\u4e0d\u8db3\uff0c\u65e0\u6cd5\u8d2d\u4e70",equipcopy_buy_attr_error_1:"\u5269\u4f59\u661f\u6570\u4e0d\u8db3\u4ee5\u9009\u62e9\u8d2d\u4e70\u8be5\u5c5e\u6027",equipcopy_wipe_title_desc:"\u6210\u529f\u626b\u8361\u81f3{0}\u5173",equipcopy_reset_1:"\u672c\u6b21\u91cd\u7f6e\u514d\u8d39\uff0c\u662f\u5426\u9700\u8981\u91cd\u7f6e\uff1f",equipcopy_reset_2:"\u672c\u6b21\u91cd\u7f6e\u9700\u8981\u82b1\u8d39{0}\u94bb\u77f3\uff0c\u662f\u5426\u9700\u8981\u91cd\u7f6e\uff1f",equipcopy_reset_3:"\u672c\u6b21\u91cd\u7f6e\u9700\u8981Vip\u7b49\u7ea7\u8fbe\u5230Vip{0}\uff0c\u662f\u5426\u9700\u8981\u91cd\u7f6e\uff1f",equipcopy_reset_4:"\u672c\u6b21\u91cd\u7f6e\u9700\u8981Vip\u7b49\u7ea7\u8fbe\u5230Vip{0}\uff0c\u5e76\u4e14\u82b1\u8d39{1}\u94bb\u77f3\uff0c\u662f\u5426\u9700\u8981\u91cd\u7f6e\uff1f",Talent_Type1:"\u6c99\u76d8",Talent_Type2:"\u5bb6\u65cf",Talent_Type3:"\u4e3b\u89d2",Talent_Type4:"\u5929\u8d4b\u9875",Talent_Info1:"\u8fdb\u4e00\u6b65\u5f3a\u5316\u6c99\u76d8\u7684\u5f3a\u5ea6",Talent_Info2:"\u8fdb\u4e00\u6b65\u5f3a\u5316\u5bb6\u65cf\u7684\u5b9e\u529b",Talent_Info3:"\u8fdb\u4e00\u6b65\u5f3a\u5316\u4e3b\u89d2\u7684\u80fd\u529b",Talent_LockInfo:"\u73a9\u5bb6\u7b49\u7ea7\u8fbe\u5230{0}\u7ea7",Talent_LockInfoOne:"\u524d\u7f6e\u5929\u8d4b\u7b49\u7ea7\u8fbe\u5230{0}\u7ea7",Talent_BtnName1:"\u4f7f\u7528\u4e2d",Talent_BtnName2:"\u4f7f\u7528",Talent_BuyPage:"\u662f\u5426\u82b1\u8d39{0}\u94bb\u77f3\u8d2d\u4e70\u5929\u8d4b\u9875",free:"\u514d\u8d39",shareFree:"\u514d\u8d39","\u514d\u8d39\u4e00\u6b21":"\u514d\u8d39\u4e00\u6b21",star:"\u661f\u661f",boxLabel:"{0}\u661f\u9886\u53d6",ChapterTips1:"\u672c\u5173\u5956\u52b1 ",ChapterTips2:"(\u901a\u5173\u540e\u81ea\u52a8\u83b7\u5f97)",ChapterTips3:"\u672c\u7ae0\u5956\u52b1",ChapterTips4:"\u672c\u7ae0\u8981\u6c42\u6700\u4f4e\u7b49\u7ea7{0}\u53ef\u6311\u6218",ChapterTips5:"\u7ae0\u8282\u901a\u5173\u540e\u53ef\u9886\u53d6",ChapterTips6:"\u70b9\u51fb\u7ee7\u7eed",ChapterTips7:"\u7ae0\u8282\u626b\u8361",ChapterTips8:"\u7ae0\u8282\u5956\u52b1",ChapterTips9:"\u529f\u80fd\u5f00\u542f\u5956\u52b1",ChapterTips10:"\u626b\u8361",ChapterTips11:"{0}\u7ea7\u540e\u53ef\u7ee7\u7eed\u6311\u6218\u7ae0\u8282{1}",ChapterTips12:"\u63d0\u5347\u7b49\u7ea7",Ladder_1:"\u6211\u7684\u6392\u540d:",Ladder_2:"\u6311\u6218\u6b21\u6570:",Ladder_3:"\u5f53\u524d\u6392\u540d\u53d1\u751f\u53d8\u5316",Ladder_4:"\u82b1\u8d39{0}\u94bb\u77f3\u8d2d\u4e701\u6b21\u6311\u6218\u6b21\u6570",Ladder_5:"\u653e\u5f03\u672c\u6b21\u6c99\u76d8\u64cd\u4f5c",Ladder_6:"\u786e\u5b9a",Ladder_7:"\u53d6\u6d88",Ladder_8:"\u6392\u540d\uff1a",Ladder_9:"\u6311\u6218\u524d\u4e09\u540d\u73a9\u5bb6\u9700\u6392\u540d\u5230\u8fbe\u524d\u5341",Ladder_10:"\u4e0d\u80fd\u6311\u6218\u81ea\u5df1",Ladder_11:"\u5956\u52b1\u4fe1\u606f",Ladder_12:"\u6311\u6218\u8bb0\u5f55",Ladder_13:"\u6b64\u73a9\u5bb6\u6b63\u5728\u6311\u6218\u4e2d\uff0c\u65e0\u6cd5\u6311\u6218",Ladder_14:"\u4eca\u65e5\u8d2d\u4e70\u6311\u6218\u6b21\u6570\u5df2\u6ee1",Ladder_15:"\u8be5\u73a9\u5bb6\u6392\u540d\u53d1\u751f\u53d8\u5316",Ladder_16:"\u8bf7\u5148\u8bbe\u7f6e\u9635\u5bb9\u518d\u8fdb\u884c\u6311\u6218",Ladder_17:"\u5929\u68af\u6280\u80fd",GiftTips1:"{0}\u6b21",GiftTips2:"\u662f\u5426\u8981\u82b1\u8d39{0}\u94bb\u77f3\u8d2d\u4e70{1}",SinginTips1:"\u83b7\u5f97{0}  X{1}",SinginTips2:"{0}\u5929",SinginTips3:"\u4f60\u4eca\u5929\u5df2\u7ecf\u7b7e\u5230\u8fc7\u4e86",SinginTips4:"\u7b7e\u5230{0}\u6b21\u53ef\u9886\u53d6",SinginTips5:"\u4eca\u65e5\u53ef\u9886\uff1a",SinginTips6:"\u660e\u65e5\u53ef\u9886\uff1a",Preferential_1:"\u8bf7\u9009\u62e9\u793c\u5305\u7c7b\u578b",Preferential_2:"\u662f\u5426\u6d88\u8017{0}\u94bb\u77f3\u8d2d\u4e70\u94bb\u77f3\u793c\u5305",Preferential_3:"\u786e\u5b9a",Preferential_4:"\u53d6\u6d88",Preferential_5:"\u4eca\u65e5\u9650\u8d2d\u6b21\u6570\u5df2\u6ee1",Preferential_7:"\u4f20\u8bf4\u5f62\u6001",Preferential_8:"\u53f2\u8bf4\u5f62\u6001",Preferential_9:"\u7cbe\u82f1\u5f62\u6001",Preferential_10:"\u9650\u5b9a{0}\u6b21",reward_info_title:"\u5956\u52b1\u4fe1\u606f","\u6682\u65e0":"\u6682\u65e0","\u6b21\u6570\u4e0d\u8db3":"\u6b21\u6570\u4e0d\u8db3","\u4eca\u65e5\u53ef\u83b7\u5f97\u7cbe\u82f1boss\u5956\u52b1\u6b21\u6570\u5df2\u7528\u5b8c":"\u4eca\u65e5\u53ef\u83b7\u5f97\u7cbe\u82f1boss\u5956\u52b1\u6b21\u6570\u5df2\u7528\u5b8c","\u7b49\u7ea7\u672a\u8fbe\u5230":"\u7b49\u7ea7\u672a\u8fbe\u5230","Boss\u964d\u4e34\u5012\u8ba1\u65f6:":"Boss\u964d\u4e34\u5012\u8ba1\u65f6:","\u5956\u52b11":"\u7edd\u6740boss\u5956\u52b1\uff1a","\u5956\u52b12":"boss\u751f\u547d\u5956\u52b1\uff1a","\u540e\u53ef\u518d\u6b21\u6311\u6218":"\u518d\u6b21\u6311\u6218","\u4e16\u754cboss\u89c4\u5219":"\u4e16\u754cboss\u89c4\u5219","\u4e16\u754cboss\u89c4\u5219Str":"1.\u4e16\u754cboss\u6bcf\u65e514\u300121\u65f6\u5b9a\u65f6\u5f00\u542f\uff0c\u6bcf\u6b21\u5f00\u542f\u65f6\u95f430\u5206\u949f\n2.boss\u88ab\u51fb\u6740\u6216\u5f00\u542f\u65f6\u95f4\u8fbe\u523030\u5206\u949f\uff0c\u6d3b\u52a8\u7ed3\u675f\n3.boss\u964d\u4f4e\u5230\u7279\u751f\u547d\uff0c\u6240\u6709\u4eba\u53ef\u9886\u53d6\u5956\u52b1\uff1b\u6700\u540e\u51fb\u6740boss\u7684\u73a9\u5bb6\u53ef\u83b7\u5f97\u989d\u5916\u5956\u52b1\n4.\u6d3b\u52a8\u7ed3\u675f\u540e\uff0c\u53ef\u624b\u52a8\u9886\u53d6\u6392\u884c\u5956\u52b1","\u7cbe\u82f1boss\u89c4\u5219":"\u7cbe\u82f1boss\u89c4\u5219","\u7cbe\u82f1boss\u89c4\u5219Str":"1.\u7cbe\u82f1boss\u6d3b\u52a8\u5168\u5929\u5f00\u542f\n2.\u73a9\u5bb6\u6bcf\u5929\u670910\u6b21\u6311\u6218\u673a\u4f1a\uff0c\u673a\u4f1a\u6d88\u8017\u5b8c\u540e\uff0c\u5206\u4eab\u53ef\u83b7\u5f97\u989d\u5916\u6b21\u6570\n3.\u70b9\u51fb\u5bf9\u5e94boss\u8fdb\u5165\u623f\u95f4\uff0c\u8be5boss\u88ab\u51fb\u8d25\u524d\u73a9\u5bb6\u4e0d\u4f1a\u9000\u51fa\u623f\u95f4\uff1b\u91cd\u590d\u8fdb\u5165\u623f\u95f4\u4e0d\u4f1a\u6d88\u8017\u6b21\u6570\n4.boss\u88ab\u51fb\u8d25\u540e\uff0c\u6839\u636e\u73a9\u5bb6\u8868\u73b0\u901a\u8fc7\u90ae\u4ef6\u53d1\u9001\u5956\u52b1","\u8840\u91cf\u5956\u52b1":"%\u751f\u547d\u5956\u52b1","\u6682\u65e0\u73a9\u5bb6\u83b7\u5f97":"\uff08\u6682\u65e0\u73a9\u5bb6\u83b7\u5f97\uff09",0:"0","\u6d6a\u8d39\u65f6\u95f4":"\u6d6a\u8d39\u65f6\u95f4\uff1a","\u6700\u7ec8\u51fb\u6740\u8005":"\u6700\u7ec8\u51fb\u6740\u8005\uff1a","\u51fb\u6740":"\u51fb\u6740","\u5f53\u524d\u8fd8\u4e0d\u80fd\u53d1\u52a8\u653b\u51fb":"\u5f53\u524d\u8fd8\u4e0d\u80fd\u53d1\u52a8\u653b\u51fb","\u8bf7\u5148\u8bbe\u7f6e\u9635\u5bb9":"\u8bf7\u5148\u8bbe\u7f6e\u9635\u5bb9","\u5df2\u88ab\u51fb\u6740":"\u5df2\u88ab\u51fb\u6740","\u63d0\u5347VIP\u7b49\u7ea7\u53ef\u83b7\u53d6\u66f4\u591a\u6b21\u6570":"\u63d0\u5347VIP\u7b49\u7ea7\u53ef\u83b7\u53d6\u66f4\u591a\u6b21\u6570",error1:"\u6027\u522b\u4e0d\u5bf9",error2:"\u540d\u5b57\u4e3a\u7a7a",error3:"\u540d\u5b57\u91cd\u590d",error4:"\u540d\u5b57\u5305\u542b\u654f\u611f\u5b57",error5:"\u540d\u5b57\u592a\u957f\u4e86",MAX:"MAX","\u7b49\u7ea7{0}":"\u7b49\u7ea7{0}","\u7b49\u7ea7\uff1a{0}":"\u7b49\u7ea7:{0}","\u7b49\u7ea7 {0}/{0}":"\u7b49\u7ea7 {0}/{1}","\u524d\u6392":"\u524d\u6392 ","\u4e2d\u6392":"\u4e2d\u6392 ","\u540e\u6392":"\u540e\u6392 ",StatusName_1:"\u666e\u901a\u5f62\u6001",StatusName_2:"\u9ad8\u7ea7\u5f62\u6001",StatusName_3:"\u7cbe\u82f1\u5f62\u6001",StatusName_4:"\u53f2\u8bd7\u5f62\u6001",StatusName_5:"\u4f20\u8bf4\u5f62\u6001",Lv:"LV:{0}",getCard:"\u83b7\u53d6\u5361\u724c",upLevel:"\u5347\u7ea7",attribute:"\u5c5e\u6027","\u53ef\u6dfb\u52a0\u6750\u6599":"\u53ef\u6dfb\u52a0\u6750\u6599","\u8bf7\u63d0\u5347\u5361\u724c\u7b49\u7ea7":"\u8bf7\u63d0\u5347\u5361\u724c\u7b49\u7ea7","\u4f4d\u7f6e":"\u4f4d\u7f6e","\u5f3a\u5316\u7b49\u7ea7":"\u5f3a\u5316\u7b49\u7ea7\uff1a","\u5347\u9636\u7b49\u7ea7":"\u5347\u9636\u7b49\u7ea7\uff1a","\u66ff\u6362":"\u66ff\u6362","\u5206\u89e3":"\u5206\u89e3","\u5408\u6210":"\u5408\u6210","\u60c5\u7f18 +{0}":"\u60c5\u7f18 +{0}","LV\uff1a{0}/{1}":"LV\uff1a{0}/{1}","\u70b9\u51fb\u7ee7\u7eed":"\u70b9\u51fb\u7ee7\u7eed","\u70b9\u51fb\u5168\u90e8\u7ffb\u724c":"\u70b9\u51fb\u5168\u90e8\u7ffb\u724c","\u70b9\u51fb\u7ffb\u724c":"\u70b9\u51fb\u7ffb\u724c","\u7684\u5947\u7f18":"\u7684\u5947\u7f18","\u6280\u80fd\u672a\u89e3\u9501":"\u6280\u80fd\u672a\u89e3\u9501","\u6240\u9700\u4e3b\u89d2\u7b49\u7ea7:{0}":"\u6240\u9700\u4e3b\u89d2\u7b49\u7ea7:{0}","\u5347  \u9636":"\u5347  \u9636","\u6ee1  \u9636":"\u6ee1  \u9636","\u5347  \u7ea7":"\u5347  \u7ea7","\u6ee1  \u7ea7":"\u6ee1  \u7ea7","\u4eba\u7269\u7b49\u7ea7\u4e0d\u8db3":"\u4eba\u7269\u7b49\u7ea7\u4e0d\u8db3","\u91d1\u5e01\u4e0d\u8db3":"\u91d1\u5e01\u4e0d\u8db3","\u7ecf\u9a8c\u4e0d\u8db3":"\u7ecf\u9a8c\u4e0d\u8db3","{0}\u9636\u53ef\u89e3\u9501\u6f5c\u80fd:":"{0}\u9636\u53ef\u89e3\u9501\u6f5c\u80fd:","{0}\u7ea7\u53ef\u89e3\u9501\u6f5c\u80fd:":"{0}\u7ea7\u53ef\u89e3\u9501\u6f5c\u80fd:","\u89e3\u9501\u6f5c\u80fd:{0}":"\u89e3\u9501\u6f5c\u80fd:{0}","\u5347\u7ea7":"\u5347\u7ea7","\u89e3\u9501":"\u89e3\u9501","\u672a\u6fc0\u6d3b\u5361\u724c":"\u672a\u6fc0\u6d3b\u5361\u724c","\u5361\u724c\u9636\u6570\u8fc7\u4f4e\uff0c\u8bf7\u5148\u5347\u9636":"\u5361\u724c\u9636\u6570\u8fc7\u4f4e\uff0c\u8bf7\u5148\u5347\u9636","\u5361\u724c\u7b49\u7ea7\u8fc7\u4f4e\uff0c\u8bf7\u5148\u5347\u7ea7":"\u5361\u724c\u7b49\u7ea7\u8fc7\u4f4e\uff0c\u8bf7\u5148\u5347\u7ea7","{0}\u9636\u53ef\u89e3\u9501":"{0}\u9636\u53ef\u89e3\u9501","{0}\u7ea7\u53ef\u89e3\u9501":"{0}\u7ea7\u53ef\u89e3\u9501","Lv {0}":"Lv {0}",7500:"\u9635\u5bb9\u63a8\u8350",7501:"\u5b98\u65b9\u63a8\u8350",7502:"\u672a\u6709\u901a\u5173\u8bb0\u5f55",7503:"\u63a8\u8350\u9635\u5bb9",7504:"\u9ad8\u8f93\u51fa\u9635\u5bb9",7505:"<color=#c203f2>\u9996\u4e2a\u901a\u5173</c>\n<color=#301810>{0}</color>",7506:"<color=#c203f2>\u6700\u4f4e\u6218\u529b</c>\n<color=#301810>{0}</color>",breakEquip:"\u662f\u5426\u786e\u5b9a\u8981\u5206\u89e3{0}",noMoney:"\u91d1\u5e01\u4e0d\u8db3",noLevel:"\u8fbe\u5230\u4e0a\u9650\u7b49\u7ea7\u88c5\u5907\u624d\u53ef\u5347\u9636",noMaterial:"\u6750\u6599\u4e0d\u8db3",replaceEquip:"{0}({1}\u7ea7)\u6b63\u5728\u88c5\u5907\u4e2d\uff0c\n\u662f\u5426\u8981\u66ff\u6362\uff1f","\u8bf7\u9009\u62e9\u88c5\u5907":"\u8bf7\u9009\u62e9\u88c5\u5907","\u5f3a\u5316\u6750\u6599\u4e0d\u8db3":"\u5f3a\u5316\u6750\u6599\u4e0d\u8db3","\u8bf7\u6dfb\u52a0\u5f3a\u5316\u6750\u6599":"\u8bf7\u6dfb\u52a0\u5f3a\u5316\u6750\u6599","\u5347\u7ea7\u6750\u6599\u4e0d\u8db3":"\u5347\u7ea7\u6750\u6599\u4e0d\u8db3","\u5df2\u7a7f\u6234\u88c5\u5907":"\u5df2\u7a7f\u6234\u88c5\u5907","{0}\uff1a{1}":"{0}\uff1a{1}","{0}\u7ea7{1}\u5b9d\u77f3":" {0}\u7ea7{1}\u5b9d\u77f3 ","{0}+{1}":"{0}+{1}","\u666e\u901a":"\u666e\u901a","\u4f18\u826f":"\u4f18\u826f","\u7cbe\u826f":"\u7cbe\u826f","\u5b8c\u7f8e":"\u5b8c\u7f8e","\u81f3\u5c0a":"\u81f3\u5c0a","\u7cbe \u70bc":"\u7cbe \u70bc","{0}{1}\u661f":"{0}{1}\u661f","-1":"\u96f6",rank:"\u9636","\u7c7b\u578b\uff1a":"\u7c7b\u578b\uff1a","\u6b66\u5668":"\u6b66\u5668","\u5934\u90e8":"\u5934\u90e8","\u8863\u670d":"\u8863\u670d","\u978b\u5b50":"\u978b\u5b50","+{0}":"+{0}","\u88c5 \u5907":"\u88c5 \u5907","\u9576 \u5d4c":"\u9576 \u5d4c","\u5408 \u6210":"\u5408 \u6210","\u66ff \u6362":"\u66ff \u6362","\u5347 \u7ea7":"\u5347 \u7ea7","\u5df2\u8fbe\u6700\u5927\u7b49\u7ea7":"\u5df2\u8fbe\u6700\u5927\u7b49\u7ea7","\u8bf7\u9009\u62e9\u9576\u5d4c\u69fd":"\u8bf7\u9009\u62e9\u9576\u5d4c\u69fd","\u8bf7\u7a7f\u6234\u88c5\u5907":"\u8bf7\u7a7f\u6234\u88c5\u5907","\u7cbe\u70bc\u7b49\u7ea7:":"\u7cbe\u70bc\u7b49\u7ea7:","\u7cbe\u70bc\u5931\u8d25":"\u7cbe\u70bc\u5931\u8d25","\u91d1\u5e01\u4e0d\u8db3\u65e0\u6cd5\u5347\u9636":"\u91d1\u5e01\u4e0d\u8db3\u65e0\u6cd5\u5347\u9636","\u4eba\u7269\u7b49\u7ea7\u4e0d\u8db3\u65e0\u6cd5\u5347\u9636":"\u4eba\u7269\u7b49\u7ea7\u4e0d\u8db3\u65e0\u6cd5\u5347\u9636","\u6750\u6599\u4e0d\u8db3\u65e0\u6cd5\u5347\u9636":"\u6750\u6599\u4e0d\u8db3\u65e0\u6cd5\u5347\u9636","\u7b49\u7ea7\u4e0a\u9650, \u8bf7\u5148\u63d0\u5347\u88c5\u5907\u9636\u6570":"\u7b49\u7ea7\u4e0a\u9650, \u8bf7\u5148\u63d0\u5347\u88c5\u5907\u9636\u6570","\u7b49\u7ea7\u4e0a\u9650, \u8bf7\u5148\u63d0\u4eba\u7269\u7b49\u7ea7":"\u7b49\u7ea7\u4e0a\u9650, \u8bf7\u5148\u63d0\u4eba\u7269\u7b49\u7ea7","\u5347\u7ea7\u6210\u529f":"\u5347\u7ea7\u6210\u529f","\u662f\u5426\u6d88\u8017\u5f3a\u5316\u8fc7\u88c5\u5907\u4f5c\u4e3a\u5347\u9636\u6750\u6599":"\u662f\u5426\u6d88\u8017\u5f3a\u5316\u8fc7\u88c5\u5907\u4f5c\u4e3a\u5347\u9636\u6750\u6599","\u9636\u6570\u7b49\u7ea7\uff1a":"\u9636\u6570\u7b49\u7ea7\uff1a","\u5347\u9636":"\u5347\u9636","\u7cbe\u70bc":"\u7cbe\u70bc",equipTipsText:"\u5f3a\u5316\u7b49\u7ea7\u8fbe\u5230\u5f53\u524d\u9636\u6570\u4e0a\u9650\n\u5347\u9636\u53ef\u4ee5\u63d0\u5347\u5f3a\u5316\u7b49\u7ea7\u4e0a\u9650",equipTipsText2:"\u5f3a\u5316\u7b49\u7ea7\u672a\u8fbe\u5230\u5347\u9636\u8981\u6c42",equipEffectAttr_0:"\u51fa\u6218",equipEffectAttr_1:"{0}\u6280\u80fd\u7b49\u7ea7",equipEffectAttr_2:"\u589e\u52a0  ",equipEffectAttr_3:"\u526f\u672c\u6b65\u6570",equipEffectAttr_4:"\u9020\u6210",equipEffectAttr_5:"\u53d7\u5230\u4f24\u5bb3\u51cf\u5c11",equipEffectAttr_6:"\u526f\u672c\u4fdd\u7559\u4eba\u6570",equipTips_0:"\u57fa\u7840\u5c5e\u6027",equipTips_1:"\u5f3a\u5316\u7b49\u7ea7\uff1a+{0}",equipTips_2:"\u9636\u6570\u7b49\u7ea7\uff1a+{0}",equipTips_3:"\u7cbe\u70bc\u7b49\u7ea7\uff1a{0}",equipTips_4:"\u5b9d\u77f3\u9576\u5d4c",equipTips_5:"\u7279\u6b8a\u6548\u679c",decomposeText:"\u6709\u88c5\u5907{0}\u8fc7,\u662f\u5426\u5206\u89e3",decomposeText01:"\u6709\u73cd\u7a00\u5361\u724c\uff0c\u662f\u5426\u5206\u89e3",decomposeText02:"\u8bf7\u6dfb\u52a0\u6750\u6599",decomposeText03:"\u662f\u5426\u5206\u89e3\u672a\u6fc0\u6d3b\u5361\u724c\u788e\u7247",decomposeText04:"\u662f\u5426\u5206\u89e3\u5df2\u4e0a\u9635\u5361\u724c\u788e\u7247",decomposeText05:"\u5f53\u524d\u5361\u724c\u4e0d\u5efa\u8bae\u5206\u89e3",decomposeText06:"\u5f53\u524d\u88c5\u5907\u4e0d\u5efa\u8bae\u5206\u89e3",decomposeText07:"\u5f53\u524d\u914d\u9970\u4e0d\u5efa\u8bae\u5206\u89e3","\u53ef\u5408\u6210:{0}":"\u53ef\u5408\u6210:{0}","\u62e5\u6709\uff1a{0}":"\u62e5\u6709\uff1a{0}",Synthetic_01:"\u4eca\u65e5\u5269\u4f59\uff1a<color=#dd601c>{0}/{1}</color>",Synthetic_02:"\u968f\u673aB\u5361\u724c",Synthetic_03:"\u968f\u673aA\u5361\u724c",Synthetic_04:"\u968f\u673aS\u5361\u724c",Synthetic_05:"\u968f\u673aSS\u5361\u724c",Synthetic_06:"\u968f\u673aSSS\u5361\u724c",Synthetic_07:"\u788e\u7247",Synthetic_08:"\u4eca\u65e5\u5269\u4f59\uff1a<color=#dd601c>\u65e0\u9650</color>",Synthetic_09:"\u5df2\u8fbe\u5230\u4eca\u65e5\u5408\u6210\u4e0a\u9650",Synthetic_10:"\u662f\u5426\u5408\u6210{0}\u4e2a{1}",Synthetic_11:"\u662f\u5426\u8fdb\u884c{0}\u6b21\u5408\u6210",Synthetic_12:"\u662f\u5426\u8fdb\u884c\u5408\u6210?",Synthetic_13:"\u901a\u8fc7{0}\u7ae0{1}\u5173\u540e\u89e3\u9501","--":"--","\u7b49\u7ea7:--":"\u7b49\u7ea7:--","\u4e0a\u9635":"\u4e0a\u9635","\u52a9\u6218":"\u52a9\u6218","\u51fa\u6218\u4e2d":"\u51fa\u6218\u4e2d","\u4fe1\u606f":"\u4fe1\u606f",tishi1:"\u7b49\u7ea7\u5df2\u8fbe\u5230\u4e0a\u9650",tishi2:"\u788e\u7247\u4e0d\u8db3",tishi3:"\u91d1\u5e01\u4e0d\u8db3",noProp1:"\u521b\u4e16\u5929\u96f7\u9053\u5177\u4e0d\u8db3",noProp2:"\u6781\u5730\u51bb\u571f\u9053\u5177\u4e0d\u8db3",noProp3:"\u6c34\u4e4b\u7cbe\u534e\u9053\u5177\u4e0d\u8db3",noProp4:"\u5730\u72f1\u9ed1\u706b\u9053\u5177\u4e0d\u8db3",noProp5:"\u98d3\u98ce\u4e4b\u773c\u9053\u5177\u4e0d\u8db3",warteamcondition1:"\u767e\u500d\u8fd4\u5229\u6fc0\u6d3b",warteamcondition2:"\u4e03\u5929\u767b\u9646\u6fc0\u6d3b","\u662f\u5426\u628a {0} \u8eab\u4e0a\u7684\u88c5\u5907\u66ff\u6362\u5230 {1}":"\u662f\u5426\u628a {0} \u8eab\u4e0a\u7684\u88c5\u5907\u66ff\u6362\u5230 {1}","\u6362\u88c5\u6210\u529f":"\u6362\u88c5\u6210\u529f","\u4e34\u65f6\u5361\u724c\u65e0\u6cd5\u7a7f\u6234":"\u4e34\u65f6\u5361\u724c\u65e0\u6cd5\u7a7f\u6234","\u4e34\u65f6\u5361\u724c\u65e0\u6cd5\u63d0\u5347\u5361\u724c\u7b49\u7ea7":"\u4e34\u65f6\u5361\u724c\u65e0\u6cd5\u63d0\u5347\u5361\u724c\u7b49\u7ea7","\u4e34\u65f6\u5361\u724c\u65e0\u6cd5\u63d0\u5347\u5361\u724c\u9636\u6570":"\u4e34\u65f6\u5361\u724c\u65e0\u6cd5\u63d0\u5347\u5361\u724c\u9636\u6570","\u4e34\u65f6\u5361\u724c\u65e0\u6cd5\u63d0\u5347\u6280\u80fd\u7b49\u7ea7":"\u4e34\u65f6\u5361\u724c\u65e0\u6cd5\u63d0\u5347\u6280\u80fd\u7b49\u7ea7",cardGroup_text_01:"\u6700\u9ad8",cardGroup_text_02:"\u5df2\u83b7\u53d6",cardGroup_text_03:"\u60c5\u7f18\u7b49\u7ea7\u52a0\u6210",cardGroup_text_04:"\u526f\u672c\u901a\u5173{0}\u7ae0{1}\u5173\u53ef",cardGroup_text_05:"\u5f53\u524d\u60c5\u7f18",cardGroup_text_06:"\u6ee1\u8db3\u4ee5\u4e0a\u6761\u4ef6\u5373\u53ef",cardGroup_text_07:"\u4e0b\u7ea7\u60c5\u7f18",cardGroup_text_08:"\u5f53\u524d:{0}\u7ea7",cardGroup_text_09:"\u6fc0\u6d3b\u540e:<color=#f6ff00>{0}\u7ea7</color>",cardGroup_text_10:"\u89e6\u53d1\u60c5\u7f18\u7b49\u7ea7\u53ef<color=#d77843>\u63d0\u5347</color>\u60c5\u7f18\u5c5e\u6027<color=#07a044>\u52a0\u6210</color>",cardGroup_text_11:"\u4e94\u884c\u653b\u51fb",cardGroup_text_12:"\u4e94\u884c\u9632\u5fa1","\u5145\u503c\u6210\u529f":"\u5145\u503c\u6210\u529f","\u5145\u503c\u672a\u5f00\u542f":"\u5145\u503c\u672a\u5f00\u542f","\u5145\u503c\u5931\u8d25":"\u5145\u503c\u5931\u8d25",invite1:"\u9080\u8bf7",invite2:"\u9886\u53d6",bigskilltip1:"\u5c04\u7a0b\u5185\u65e0\u76ee\u6807",bigskilltip2:"\u6ca1\u6709\u53ef\u653b\u51fb\u7684\u76ee\u6807",bigskilltip3:"\u6c89\u9ed8\u4e2d",bigskilltip4:"\u65bd\u6cd5\u8005\u5df2\u6b7b\u4ea1",ItemUseTip1:"\u9053\u5177\u5df2\u4e0d\u5b58\u5728",ItemUse:"\u88c5\u5907\u4e2d",Intensify:"\u5f3a\u5316",Resolve:"\u5206\u89e3",Sell:"\u51fa\u552e",Use:"\u4f7f\u7528",Robfriend:"\u62a2\u52ab\u597d\u53cb",Helpfriends:"\u5e2e\u52a9\u597d\u53cb",AvctiveTime:"\u6d3b\u52a8\u65f6\u95f4\uff1a\u5269 ",ThemeshopTips1:"\u672a\u6d88\u8017\u7684\u79ef\u5206\u4f1a\u5728\u6bcf\u5929\u7ed3\u675f\u65f6\u5151\u6362\u6210\u91d1\u5e01\u901a\u8fc7\u90ae\u4ef6\u53d1\u653e",ThemeshopTips2:"\u5237\u65b0",ThemeshopTips4:"\u6d88\u9664\u6311\u6218",ThemeshopTips5:"\u5728\u6307\u5b9a\u6b65\u6570\u4e2d\uff0c\u4efb\u610f\u5408\u6210\u62d6\u51fa\u53f2\u83b1\u59c6\u53ef\u83b7\u5f97\u79ef\u5206",ThemeshopTips6:"\u5408\u6210\u7684\u53f2\u83b1\u59c6\u5f62\u6001\u8d8a\u9ad8\uff0c\u83b7\u5f97\u79ef\u5206\u8d8a\u591a",ThemeshopTips7:"\u5206\u6570\u89c4\u5219",ThemeshopTips8:"\u9650\u65f6\u89c4\u5219",ThemeshopTips9:"\u6e05\u9664\u77f3\u5757\u83b7\u5f97{0}\u5206\n\u8fde\u7eed{1}\u6b21{2}\u6d88\u79ef\u5206\u52a0\u500d",ThemeshopTips10:"\u524d\u5f80\u6311\u6218",ThemeshopTips11:"\u79ef\u5206\u4e0d\u591f",SharpLimit1:"\u4eca\u65e5\u5df2\u8fbe\u5230\u83b7\u53d6\u4e0a\u9650\u4e86\uff0c\u8bf7\u660e\u65e5\u518d\u8bd5",getMoney:"\u6536\u83b7\u91d1\u5e01",revenge:"\u590d\u4ec7",appreciate:"\u611f\u6069",getit:"\u77e5\u9053\u4e86",revenge1:"\u4ed6\u62a2\u4e86\u4f60{0}\u91d1\u5e01\u8dd1\u4e86",appreciate1:"\u4ed6\u8d60\u9001\u4f60{0}\u91d1\u5e01",getit1:"\u4ed6\u56de\u62a5\u4f60{0}\u91d1\u5e01",goldsend:"\u8d60\u9001\u91d1\u5e01",energydown:"\u4f53\u529b\u4e0d\u8db3",robbery_reward_progress:"{0}/{1}",robbery_house_Lv:"{0}\u7ea7\u57ce\u9547",robbery_house_desc:"\u901a\u5173\u4e3b\u7ebf\u7ae0\u8282\u53ef\u63d0\u5347\u5efa\u7b51\u7b49\u7ea7\uff0c\u5efa\u7b51\u7b49\u7ea7\u8d8a\u9ad8\uff0c\u91d1\u5e01\u6536\u76ca\u8d8a\u9ad8",robbery_house_Exp:"({0}/{1})",robbery_reward_tips_1:"\u6bcf{0}\u79d2\u83b7\u5f97",robbery_reward_tips_2:"{0}",robbery_reward_tips_3:"\u91d1\u5e01",robbery_troop_title:"\u90e8\u961f",robbery_friend_page_title:"\u597d\u53cb\u5bb6\u56ed",robbery_speed_title:"\u52a0\u901f",robbery_speed_desc:"\u52a0\u901f\u540e\u6bcf{0}\u79d2\u83b7\u5f97\u91d1\u5e01\u7ffb\u500d",robbery_speed_cd:"\u52a0\u901f{0}\u79d2",robbery_speed_error:"\u5f53\u524d\u5df2\u5904\u4e8e\u52a0\u901f\u72b6\u6001",robbery_match_title:"\u653b\u7565\u5bb6\u56ed",robbery_match_refresh:"\u5237\u65b0({0}s)",robbery_remain_double:"\u52a0\u901f\u5269\u4f59\uff1a{0}",robbery_match_refresh_complete:"\u5237\u65b0",robbery_match_desc:"\u63a0\u593a\u5956\u52b1\u5269\u4f59\u6b21\u6570\uff1a<color=#c203f2>{0}</color>/{1}",robbery_record_desc_1:"\u4ed6\u62a2\u4e86\u4f60<color=#ff0000>{0}</color>\u91d1\u5e01\u8dd1\u4e86\uff01",robbery_record_desc_2:"\u4ed6\u5e2e\u52a9\u4f60\u5411<color=#016e82>{0}</color>\u590d\u4ec7\u4e86~",robbery_box_title:"\u5b9d\u7bb1\u6570/\u6700\u591a\u53ef\u6fc0\u6d3b\u5b9d\u7bb1\u6570\uff1a<color=#00ca47>{0}/{1}</color>",robbery_box_desc_1:"\u5012\u8ba1\u65f6\u4e2d...",robbery_box_desc_2:"\u662f\u5426\u4f7f\u7528",robbery_box_desc_3:"\u6d88\u9664\u5012\u8ba1\u65f6\uff1f",robbery_box_error:"\u6682\u65e0\u5b9d\u7bb1\uff0c\u63a0\u593a\u4ed6\u4eba\u53ef\u83b7\u5f97\u5b9d\u7bb1\uff01",robbery_friend_error:"\u6682\u65e0\u597d\u53cb\u53ef\u67e5\u770b\u6216\u63a0\u593a\uff01",robbery_add_rob_count:"\u662f\u5426\u82b1\u8d39{0}\u94bb\u77f3\u589e\u52a0\u63a0\u593a\u6b21\u6570\uff1f",robbery_add_rob_count_error:"\u8d2d\u4e70\u6b21\u6570\u5df2\u7528\u5b8c\uff0c\u8bf7\u7b49\u5f85\u660e\u5929\u5237\u65b0",robbery_add_rob_count_error_2:"\u5f53\u524d\u5269\u4f59\u63a0\u593a\u6b21\u6570\u5df2\u6ee1",robbery_record_title:"\u5bb6\u56ed\u65e5\u5fd7",robbery_refresh_tips:"\u8bf7\u7a0d\u5019\u518d\u5237\u65b0",robbery_zhaohuan_tips:"\u5df2\u8d85\u51fa\u6bcf\u5929\u91cd\u65b0\u53ec\u5524\u6b21\u6570\uff08\u6bcf\u59295\u6b21\uff09",robbery_help_desc:"\u5269\u4f59\u6b21\u6570\uff1a<color=#00ca47>{0}</color>/{1}",robbery_rob_perday_desc:"\u5956\u52b1\u5269\u4f59\u6b21\u6570\uff1a<color=#00ca47>{0}</color>/{1}",robbery_fight_num:"<color=#F6FF00>{0}</color>/{1}",robbery_lock_tips_1:"\u5efa\u7b51\u7b49\u7ea7\u63d0\u5347\u540e\uff0c\u53ef\u540c\u65f6\u5f00\u542f<color=#00ca47>\u66f4\u591a</color>\u4e2a\u5b9d\u7bb1",robbery_lock_tips_2:"\u901a\u5173\u4e3b\u7ebf\u4efb\u52a1\u53ef\u63d0\u5347\u5efa\u7b51\u7b49\u7ea7",robbery_help_or_revenge_error:"\u5e2e\u52a9\u548c\u590d\u4ec7\u6b21\u6570\u5df2\u7528\u5b8c",robbery_error:"\u63a0\u593a\u6b21\u6570\u5df2\u7528\u5b8c",robbery_box_is_max_error:"\u5f53\u524d\u5b9d\u7bb1\u5df2\u6ee1\uff0c\u65e0\u6cd5\u63a0\u593a",robbery_box_is_max_error_2:"\u5f53\u524d\u5b9d\u7bb1\u5df2\u6ee1\uff0c\u65e0\u6cd5\u611f\u6069\u4ed6\u4eba",robbery_box_is_max_error_3:"\u5f53\u524d\u5b9d\u7bb1\u5df2\u6ee1\uff0c\u65e0\u6cd5\u9886\u53d6\u5b9d\u7bb1\u5956\u52b1",common_page_title:"\u63d0\u793a",windatt:"\u98ce\u653b\u51fb\uff1a",wateratt:"\u6c34\u653b\u51fb\uff1a",soilatt:"\u571f\u653b\u51fb\uff1a",fireatt:"\u706b\u653b\u51fb\uff1a",thunderatt:"\u96f7\u653b\u51fb\uff1a",arrt:"\u8bf7\u9009\u4e2d\u4efb\u610f\u5c5e\u6027",change:"\u662f\u5426\u8981\u5207\u6362\u4e3a{0}\u5c5e\u6027\uff0c\u6d88\u8017",wind:"\u98ce",water:"\u6c34",soil:"\u571f",fire:"\u706b",thunder:"\u96f7",expend:"{0}\u94bb\u77f3",grailtips:"\u4e0e\u539f\u6765\u5c5e\u6027\u4e00\u6837",notOpen:"\u901a\u5173\u4e3b\u7ebf\u5173\u5361\u83b7\u5f97\u5723\u676f",period:"\u6301\u7eed{0}\u5929",remine:"\u5269\u4f59{0}\u5929\uff0c\u70b9\u51fb\u63d0\u524d\u7eed\u8d39",title:"\u4e24\u79cd\u7279\u6743\u5361\u53ef\u540c\u65f6\u751f\u6548\uff0c\u6bcf\u65e5\u6700\u591a\u83b7\u5f97{0}\u94bb\u77f3",select:"\u9009\u62e9",canActive:"\u53ef\u6fc0\u6d3b",expedition_reset:"\u6bcf\u65e5\u51cc\u6668\u91cd\u7f6e",expedition_mirror_title:"\u9009\u62e9\u955c\u50cf",fightresult_troop_title:"\u90e8\u961f\u4fe1\u606f",expedition_title:"\u955c\u50cf\u4fe1\u606f",expedition_page_error_1:"\u8bf7\u9009\u62e9\u955c\u50cf\u518d\u8fdb\u884c\u91cd\u7f6e",expedition_page_error_2:"\u6682\u65e0\u955c\u50cf",expedition_page_mirror_tips_1:"\u63d0\u793a\uff1a\u9009\u62e9\u4e00\u4e2a\u955c\u50cf\uff0c\u91cd\u65b0\u5f00\u59cb\u6311\u6218",expedition_page_mirror_tips_2:"\u63d0\u793a\uff1a\u9009\u62e9\u4e00\u4e2a\u955c\u50cf\uff0c\u91cd\u65b0\u5f00\u59cb\u6311\u6218",expedition_page_max_bo_val:"{0}\u6ce2",expedition_reset_title:"\u5956\u52b1",expedition_page_bo_val:"{0}~{1}\u6ce2",expedition_reward_bo_val:"\u7b2c{0}\u6ce2\u5956\u52b1",expedition_vip:"VIP{0}",expedition_reset_num:"\u53ef\u624b\u52a8\u91cd\u7f6e{0}\u6b21",expedition_reset_none:"\u51cc\u666812\u70b9\u91cd\u7f6e\u6b21\u6570",expedition_reset_none2:"\u5f53\u524d\u5df2\u7ecf\u662f\u7b2c\u4e00\u6ce2",fight_result_delay_close:"\u70b9\u51fb\u5c4f\u5e55\u7ee7\u7eed\uff08{0}s\uff09",fight_result_close:"\u70b9\u51fb\u5c4f\u5e55\u7ee7\u7eed",fight_next:"\u81ea\u52a8\u8fdb\u5165\u4e0b\u4e00\u5173\uff08{0}s\uff09",treasure_out:"\u85cf\u5b9d\u56fe\u5df2\u5237\u65b0\uff0c\u8bf7\u5148\u9000\u51fa\u518d\u8fdb\u5165",treasure_buy:"\u6210\u529f\u8d2d\u4e70\u5546\u54c1",treasure_enter_1:"\u8fdb\u5165\u672a\u77e5\u5173\u5361\uff0c\u60ca\u9192\u602a\u7269",treasure_enter_2:"\u8fdb\u5165\u672a\u77e5\u5173\u5361\uff0c\u4f20\u9001\u5175\u8425",treasure_enter_3:"\u8fdb\u5165\u672a\u77e5\u5173\u5361\uff0c\u906d\u9047\u9677\u9631",treasure_enter_4:"\u8fdb\u5165\u672a\u77e5\u5173\u5361\uff0c\u5f97\u5230\u6cbb\u7597",treasure_enter_6:"\u8fdb\u5165\u672a\u77e5\u5173\u5361\uff0c\u9047\u5230\u5546\u5e97",treasure_enter_8:"\u8fdb\u5165\u672a\u77e5\u5173\u5361\uff0c\u60ca\u9192\u4e86\u5f3a\u5927\u7684\u602a\u7269",treasure_yl:"\u8fdb\u5165\u533b\u7597\u5173\u5361\uff0c\u53f2\u83b1\u59c6\u5f97\u5230\u6cbb\u7597",treasure_troop_title:"\u90e8\u961f\u4fe1\u606f",treasure_shop_title:"\u5546\u5e97",treasure_reward_title:"\u6536\u76ca",treasure_shop_tips1:"\u662f\u5426\u8981\u4f7f\u7528",treasure_shop_tips2:"\u8d2d\u4e70\uff1f",treasure_reward_none:"\u6682\u672a\u83b7\u5f97\u95ef\u5173\u5956\u52b1",treasure_progress_desc:"\u8fdb\u5ea6\uff1a{0}/{1}",treasure_error_1:"\u4e0d\u80fd\u8d8a\u7ea7\u6311\u6218\u5173\u5361",treasure_error_2:"\u60a8\u5df2\u901a\u5173\u6240\u9009\u5c42\u7ea7\uff0c\u8bf7\u9009\u62e9\u5f53\u524d\u5173\u5361\u7684\u4e0b\u4e00\u5173\u5361\u8fdb\u884c\u6311\u6218",treasure_error_3:"\u5f53\u524d\u7ebf\u8def\u4e0d\u901a",treasure_node_name1:"\u5c0f\u602a",treasure_node_name2:"\u5175\u8425",treasure_node_name3:"\u9677\u9631",treasure_node_name4:"\u533b\u7597",treasure_node_name5:"\u5b9d\u7bb1",treasure_node_name6:"\u5546\u5e97",treasure_node_name7:"\u672a\u77e5",treasure_node_name8:"\u7cbe\u82f1",treasure_node_name9:"boss",treasure_node_name20:"\u5f53\u524d",treasure_title_1:"\u666e\u901a\u5173\u5361",treasure_title_8:"\u7cbe\u82f1\u5173\u5361",treasure_title_9:"boss\u5173\u5361","{0}/{1} lv:{2}":"{0}/{1} lv:{2}","{0} lv:{1}":"{0} lv:{1}","{0}/{1}":"{0}/{1}","\u672a\u5f00\u542f":"\u672a\u5f00\u542f","\u5f00\u542f":"\u5f00\u542f","\u901a\u8fc7\u4e3b\u7ebf{0}\u7ae0{1}\u5173":"\u901a\u8fc7\u4e3b\u7ebf{0}\u7ae0{1}\u5173","{0}%":"{0}%","\u6ce8 \u7075":"\u6ce8 \u7075","\u7a81 \u7834":"\u7a81 \u7834","\u4e0a\u9650":"\u4e0a\u9650","\u5df2\u6ee1\u7ea7":"\u5df2\u6ee1\u7ea7","lv.{0}":"lv.{0}",artifact_progress:"<outline color=block width=2>\u8fdb\u5ea6(<color=#ff0000>{0}/{1}</color>)</outline>",artifact_progress1:"<outline color=block width=2>\u8fdb\u5ea6(<color=#00ca47>{0}/{1}</color>)</outline>","\u51fa\u6218\u6210\u529f":"\u51fa\u6218\u6210\u529f","\u6fc0\u6d3b\u526f\u795e\u5668,{0}":"\u6fc0\u6d3b\u526f\u795e\u5668,{0}",and:"\u548c",pass:"\u901a\u8fc7",HighLadder:"\u5929\u68af",Arena:"\u7ade\u6280\u573a",expedition:"\u8fdc\u5f81",available:"\u53ef\u83b7\u5f97",Honor:"\u8363\u8a89",Integral:"\u79ef\u5206",FriendsrechargeLink:"\u597d\u53cb\u5145\u503c\u94fe\u63a5",PurchaseUpperLimit:"\u4eca\u5929\u5df2\u8fbe\u5230\u8d2d\u4e70\u4e0a\u9650\uff0c\u660e\u5929\u518d\u6765\u5427","\u5df2\u8fbe\u5230\u8d2d\u4e70\u4e0a\u9650":"\u5df2\u8fbe\u5230\u8d2d\u4e70\u4e0a\u9650","\u63d0\u5347VIP\u7b49\u7ea7\u53ef\u589e\u52a0\u8d2d\u4e70\u6570\u91cf":"\u63d0\u5347VIP\u7b49\u7ea7\u53ef\u589e\u52a0\u8d2d\u4e70\u6570\u91cf",ownNum:"\u62e5\u6709\u6570\u91cf",ShopItemCount:"\u6570 \u91cf",price:"\u4ef7 \u683c",ge:"\u4e2a",discount:"{0}\u6298",buyRefrshTimes:"  \u662f\u5426\u6d88\u8017{0}\u94bb\u77f3\uff0c\u8d2d\u4e70\u5237\u65b0\u6b21\u6570   (\u53ef\u8d2d\u4e70\u6b21\u6570{1}/{2})",shop_01:"\u8d2d\u4e70\u6210\u529f","\u8be5\u5377\u8f74\u6570\u91cf\u4e0d\u8db3\uff0c\u65e0\u6cd5\u4e0a\u9635":"\u8be5\u5377\u8f74\u6570\u91cf\u4e0d\u8db3\uff0c\u65e0\u6cd5\u4e0a\u9635",arenastart:" {0}\u661f",arenaresetrule:"\u91cd\u7f6e\u89c4\u5219",arenarule:"\u89c4\u5219",arenasingles:"\u80dc\u5229\u65b9\u4fdd\u75592\u4e2a\u6218\u529b\u6700\u9ad8\u7684\u602a\u7269<br/><color=#fad247>{0}\u79d2</color>\u540e\u5f00\u59cb\u4e0b\u4e00\u5c40",arenasinglef:"\u5148\u83b7\u5f972\u80dc\u7684\u4e00\u65b9\u83b7\u5f97\u6700\u7ec8\u80dc\u5229<br/><color=#fad247>{0}\u79d2</color>\u540e\u5f00\u59cb\u4e0b\u4e00\u5c40",condition0:"\u524d\u5341\u573a\u80dc\u5229\u5956\u52b1\u79ef\u5206({0}/10)",condition1:"\u6218\u6597\u80dc\u5229\u5956\u52b1\u4e00\u9897\u661f",condition2:"\u8fde\u80dc\u989d\u5916\u5956\u52b1\u4e00\u9897\u661f",condition3:"\u6218\u6597\u5931\u8d25\u5931\u53bb\u4e00\u9897\u661f",condition4:"\u4eca\u65e5\u4e0d\u53ef\u518d\u83b7\u5f97\u6218\u5229\u54c1",arenaback:"\u662f\u5426\u9000\u51fa\u7ade\u6280\u573a\u5bf9\u6218\uff1f",4500:"<outline color=#000000 width=2><size=26>\u6d88\u8017:        x{0}</size></outline>",4501:"\u6311 \u6218",4502:"\u672a\u89e3\u9501",4503:"<outline color=#000000 width=2><size=26><color=#ffffff>\u7ae0\u8282<color=#ff0000>{0}</color>\u5173\u5361<color=#ff0000>{1}</color></color>\u5f00\u542f</size></outline>",4504:"\u8bf7\u901a\u5173\u4e0a\u4e00\u96be\u5ea6",4505:"vip{0}\u53ef\u626b\u8361",4506:"\u626b \u8361",4507:"\u7ae0\u8282{0} \u5173\u5361{1}\u5f00\u542f",4508:"<outline color=#000000 width=2><size =32><color=#ffffff>\u5468{0}\u6311\u6218\u53ef\u83b7\u5f97<color=#f6ff00>\u53cc\u500d\u6536\u76ca</color></color></size></outline>",4509:"<outline color=#000000 width=2><size =32><color=#f6ff00>\u5f53\u524d\u6311\u6218\u53ef\u83b7\u5f97\u53cc\u500d\u6536\u76ca</color></size></outline>",4510:"<outline color=#000000 width=2><size=26><color=#ffffff><color=#f6ff00>VIP{0}</color>\u53ef\u589e\u52a0<color=#00ca47>{1}</color>\u6b21\u6311\u6218\u6b21\u6570</color></size></outline>",4511:"<outline color=#000000 width=2><size=26><color=#ffffff>      \u5f53\u524d\u5269\u4f59<color=#00ca47>{0}</color>\u6b21\u6311\u6218\u6b21\u6570</color></size></outline>",4512:"<outline color=#000000 width=2><size=26>\u901a\u5173<color=#ff0000>{0}</color>\u96be\u5ea6\u89e3\u9501</size></outline>",4521:"\u7b80\u5355",4522:"\u666e\u901a",4523:"\u56f0\u96be",4524:"\u5669\u68a6",4525:"\u5730\u72f1",4526:"{0}",equipcopy1:"\u5f53\u524d\u5269\u4f59{0}\u661f\uff0c\u8fd8\u53ef\u4ee5\u7ee7\u7eed\u8d2d\u4e70\uff0c\u662f\u5426\u653e\u5f03\u9009\u62e9\u5c5e\u6027\u7ee7\u7eed\u95ef\u5173\uff1f",5001:"<color=#ffffff><outline color=#642a00 width=2>\u901a\u5173\u4e3b\u7ebf\u7b2c{0}\u7ae0\u540e\u89e3\u9501</outline></color>",arenafacecdtime:"\u51b7\u5374\u4e2d..","\u626b\u8361\u6b21\u6570\u5df2\u7528\u5b8c":"\u626b\u8361\u6b21\u6570\u5df2\u7528\u5b8c","\u662f\u5426\u6d88\u8017{0}\u94bb\u77f3\u91cd\u7f6e\u626b\u8361":"\u662f\u5426\u6d88\u8017{0}\u94bb\u77f3\u91cd\u7f6e\u626b\u8361","\u4f53\u529b\u4e0d\u8db3\uff0c\u626b\u8361\u5931\u8d25":"\u4f53\u529b\u4e0d\u8db3\uff0c\u626b\u8361\u5931\u8d25","\u626b\u8361\u6b21\u6570\u4e3a0":"\u626b\u8361\u6b21\u6570\u4e3a0",5500:"\u6d17\u7ec3",5501:"\u5c5e\u6027\u8bc4\u7ea7:",5502:"<color=#ffffff>\u5f53\u524d\u5c5e\u6027\u8bc4\u4ef7:</c><color=#f6ff00>{0}</color>",5503:"{0}+{1}({2}\u6ee1)",5504:"\u66ff\u6362",5505:"{0}/{1}",5506:"\u4fe1\u606f",5507:"\u5f3a\u5316",5508:"\u8fdb\u9636",5509:"\u5929\u8d4b",5510:"{0}\u9636",5511:"\u6240\u9700\u5f3a\u5316\u7b49\u7ea7\uff1a{0}",5512:"<color=#a06755>{0}\u9636\u53ef\u89e3\u9501</c><color=#bd4620>{1},{2}</color>",5513:"<color=#{0}>{1}</c><color=#ffffff>/{2}</color>",5514:"\u7ecf\u9a8c+{0}",5515:"\u56fe\u817e\u8fdb\u9636\u5230{0}\u9636\u5f00\u542f",5516:"\u91d1\u5e01\u4e0d\u8db3",5517:"\u9053\u5177\u4e0d\u8db3",5518:"{0}\u9636{1}\u661f",5519:"{0}\u9636\u2022{1}",5520:"Vip{0}\u5f00\u542f",5521:"\u8bf7\u5148\u6d17\u7ec3",5523:"\u5173\u95ed\u9700\u8981\u91cd\u65b0\u6d17\u7ec3\uff0c\u662f\u5426\u786e\u8ba4\uff01",5524:"\u56fe\u817e{0}\u9636\u5f00\u542f",5525:"\u5929\u8d4b-{0}",5526:"{0}\u9636\u5929\u8d4b\u5b54",5527:"\u5df2\u6ee1\u9636",5529:"\u89d2\u8272{0}\u7ea7\u5f00\u542f",5700:"{0}:PVE\u4e2d\u9020\u6210\u7684\u4f24\u5bb3\u589e\u52a0{1}%",5701:"{0}:PVE\u4e2d\u53d7\u5230\u7684\u4f24\u5bb3\u964d\u4f4e{1}%",5600:"{0}:PVP\u4e2d\u9020\u6210\u7684\u4f24\u5bb3\u589e\u52a0{1}%",5601:"{0}:PVP\u4e2d\u53d7\u5230\u7684\u4f24\u5bb3\u964d\u4f4e{1}%",5410:"{0}:\u9020\u6210\u7684\u4e94\u884c\u5c5e\u6027\u4f24\u5bb3\u589e\u52a0{1}%",5411:"{0}:\u53d7\u5230\u7684\u4e94\u884c\u5c5e\u6027\u4f24\u5bb3\u964d\u4f4e{1}%",52100:"{0}:\u5728PVE\u6218\u6597\u5f00\u59cb\u524d,\u6240\u6709\u53f2\u83b1\u59c6\u7684\u7b49\u7ea7+1",52101:"{0}:\u5728PVE\u6218\u6597\u5f00\u59cb\u524d\u968f\u673a\u6700\u9ad8\u9636(\u96645\u9636),\u4f7f\u5176\u5f62\u6001+1",5412:"{0}:\u6211\u65b9\u6240\u6709\u540f\u83b1\u59c6,\u5bf9\u654c\u65b9\u56db\u9636\u548c\u4e94\u9636\u5f62\u6001\u7684\u53f2\u83b1\u59c6,\u9020\u6210\u7684\u4f24\u5bb3\u589e\u52a0{1}%",5413:"{0}:\u6211\u65b9\u6240\u6709\u56db\u3001\u4e94\u9636\u5f62\u6001\u7684\u53f2\u83b1\u59c6\u53d7\u5230\u4f24\u5bb3\u964d\u4f4e{1}%",5540:"\u5df2\u6ee1\u7ea7",5551:"\u5929\u8d4b\u5df2\u6ee1",5552:"\u5347\u5230{0}\u9636\u540e\u53ef\u7ee7\u7eed\u5f3a\u5316",6001:"\u7b2c{0}\u5c42",6002:"\u865a\u4f4d\u5df2\u5f85",6003:"\u4e0d\u53ef\u91cd\u7f6e",6004:"X{0}",6005:"VIP\u7b49\u7ea7\u4e0d\u8db3",6006:"\u65e0\u53ef\u626b\u8361\u5173\u5361",6007:"\u65e0\u6c99\u76d8\u4fe1\u606f",6008:"\u8bf7\u9009\u62e9\u5173\u5361\u602a\u7269",6009:"\u662f\u5426\u6d88\u8017{0}\u94bb\u77f3\u91cd\u7f6e\u526f\u672c",6010:"\u524d\u6392",6011:"\u4e2d\u6392",6012:"\u540e\u6392",6013:"help\u8868\u672a\u914d\u7f6e",6014:"\u4eca\u65e5\u91cd\u7f6e\u6b21\u6570\u5df2\u7528\u5b8c",6016:"\u662f\u5426\u91cd\u7f6e\u56de\u5230\u7b2c1\u5c42",6017:"\u65e0\u5173\u5361\u53ef\u91cd\u7f6e",6018:"\u5468\u4e00\u51cc\u666812\u70b9\u91cd\u7f6e\u5173\u5361",6019:"<color=#f6ff00>VIP{0}</color>\u53ef\u624b\u52a8\u91cd\u7f6e{1}\u6b21",6020:"\u5269\u4f59<color=#f6ff00>{0}</color>\u6b21\u91cd\u7f6e\u6b21\u6570",6500:"\u4e0d\u5728\u6d3b\u52a8\u65f6\u95f4\u5185",6501:"\u662f\u5426\u6d88\u8017{0}\u94bb\u77f3\u8865\u9886{1}\u70b9\u4f53\u529b\uff01",6502:"\u9886\u53d6",6503:"\u672a\u8fbe\u6210",6504:"\u5728\u7ebf\u65f6\u95f4{0}",6505:"\u8fdb\u5ea6\uff1a{0}",6506:"\u5728\u7ebf\u5956\u52b1{0}",6507:"\u5f00\u9910\u65f6\u95f4:{0}-{1}",6508:"\u5df2\u5403\u5b8c\u5927\u9910",6509:"<color=#FFFFFF>\u4e0b\u6b21\u5403\u5927\u9910\u65f6\u95f4\uff1a</c><color=#FFed07>{0}</color>",6510:"\u6062\u590d{0}\u70b9\u4f53\u529b\u503c",6511:"\u662f\u5426\u8981\u6d88\u8017{0}\u94bb\u77f3\u8d2d\u4e70\u5f00\u670d\u57fa\u91d1",6512:"(VIP{0}\u53ca\u4ee5\u4e0a\u53ef\u8d2d\u4e70)",6513:"\u6211\u4e5f\u8981\u4e70",6514:"{0}\u65e5\u5361\u5230\u671f\u662f\u5426\u7eed\u8d39",6515:"\u5956\u52b1\u5df2\u7ecf\u9886\u53d6",6516:"\u6301\u7eed\u8d60\u9001{0}\u5929",6517:"\u5269\u4f59\u5929\u6570\uff1a{0}\u5929",6518:"{0}\u5143",6519:"\u7eed\u8d39",6520:"\u5956\u52b1\u5df2\u7ecf\u9886\u53d6\uff0c\u8bf7\u660e\u5929\u518d\u6765",6521:"7",6522:"30",6523:"\u5373\u5c06\u5230\u671f,\u5feb\u53bb\u8d2d\u4e70\u83b7\u53d6\u66f4\u591a\u94bb\u77f3\u5427",6524:"\u524d\u5f80\u8d2d\u4e70",6525:"\u4f53\u529b\u5145\u8db3,\u8bf7\u5148\u6d88\u8017\u4f53\u529b\u518d\u6765\u9886\u53d6",6526:"\u8d2d\u4e70\u9996\u5145\u540e\u624d\u80fd\u9886\u53d6\u5145\u503c\u5956\u52b1~",7000:"\u8d2d\u4e70",7001:"\u9886\u53d6",7002:"\u5df2\u9886\u53d6",7003:"\u8d2d\u4e70\u53ef\u8ba1\u5165\u5145\u503c\u6d3b\u52a8\u4e0eVIP",7100:"\u8d2d\u4e70",7101:"\u5df2\u8d2d\u4e70",7102:"\u662f\u5426\u8981\u6d88\u8017{0}\u94bb\u77f3\u8d2d\u4e70\u534a\u4ef7\u793c\u5305",7103:"\u9996\u6b21\u5145\u503c\u94bb\u77f3\u8fd4\u8fd8\u53cc\u500d\uff0c{0}\u5143\u5c31\u6709{1}\u94bb\u77f3",7104:"\u79ef\u5206",7105:"\u7b2c{0}\u5929",7106:"\u79ef\u5206\u6392\u884c\u699c",7107:"\u6d3b\u52a8\u5012\u8ba1\u65f6\uff1a<color=#D30000>{0}</color>",7108:"\u5f00\u670d\u7b2c{0}\u5929\u5f00\u542f",7109:"\u9886\u53d6",7110:"\u524d\u5f80",7111:"\u539f\u4ef7:",7112:"\u73b0\u4ef7:",7113:"\u7279\u60e0",7114:"\u6392\u540d",7115:"\u89d2\u8272",7116:"\u5956\u52b1",7117:"<color=#5c3c34>\u6d3b\u52a8\u7ed3\u675f\u540e\uff0c\u4ee5\u90ae\u4ef6\u7684\u5f62\u5f0f\u53d1\u653e<color=#84361c>\u5956\u52b1</color></color>",7198:"\u6311\u6218\u6b21\u6570\u4e0d\u8db3",7199:"\u5f53\u524d\u6311\u6218\u6b21\u6570\u4e3a0,\u8bf7\u8d2d\u4e70\u83b7\u5f97\u6311\u6218\u6b21\u6570",7200:"\u6311\u6218\u6b21\u6570\u5df2\u6ee1",7201:"\u7b2c{0}\u5c42",7202:"\u82b1\u8d39{0}\u94bb\u77f3\u8d2d\u4e701\u6b21\u6311\u6218\u6b21\u6570",7203:"\u6311\u6218",7204:"\u6311\u6218\u6b21\u6570\uff1a<color=#f6ff00>{0}</color>/{1}",7205:"\u63a8\u8350:",7206:"\u6d88\u8017:",7207:"\u5173\u5361{0}",7208:"x{0}",7209:"\u7ae0\u8282{0}\u5173\u5361{1}\u5f00\u542f",7210:"\u8bf7\u901a\u5173\u4e0a\u4e00\u5173\u5361",7211:"VIP{0}\u53ef\u589e\u52a0\u6b21\u6570",7212:"\u662f\u5426\u6d88\u8017{0}\u94bb\u77f3\u91cd\u7f6e\u5173\u5361",7213:"\u5df2\u901a\u5173",7214:"\u610f\u89c1\u53cd\u9988",7215:"\u53cd\u9988\u5df2\u6210\u529f\u63d0\u4ea4\uff0c\u8bf7\u60a8\u8010\u5fc3\u7b49\u5019\u7247\u523b",7216:"\u63d0\u4ea4",7217:"BUG",7218:"\u6295\u8bc9",7219:"\u5efa\u8bae",7220:"\u5176\u4ed6",7221:"\u8bf7\u8f93\u5165\u53cd\u9988\u5185\u5bb9",7222:"\u8bf7\u8f93\u5165\u60a8\u7684\u95ee\u9898(100\u5b57\u4ee5\u5185)",7223:"\u8bf7\u52ff\u91cd\u590d\u63d0\u4ea4\u610f\u89c1\u5185\u5bb9",7224:"\u5efa\u8bae\u4e00\u7ecf\u91c7\u7eb3\uff0c\u4f1a\u6709<color=#84361c>\u795e\u79d8\u5927\u5956</color>\u5594~\n\u5956\u52b1\u548c\u56de\u590d\u90fd\u4f1a\u4ee5\u90ae\u4ef6\u7684\u5f62\u5f0f\u53d1\u9001\u7ed9\u73a9\u5bb6\uff0c\u8bf7\u60a8\u8010\u5fc3\u7b49\u5019\u7247\u523b",7225:"\u610f\u89c1\u7c7b\u578b:",7226:"\u610f\u89c1\u5185\u5bb9:",7227:"\u6b22\u8fce\u52a0\u5165\u804a\u5929QQ\u7fa4\uff1a<color=#84361c>{0}</color>",7228:"\u7acb\u5373\u524d\u5f80",7229:"\u524d\u5f80\u53ef<color=#f6ff00>\u6c38\u4e45\u83b7\u5f97</color>",7230:"\u70b9\u51fb\u7a7a\u767d\u5904\u5173\u95ed",7231:"\u5269\u4f59:{0}",7232:"\u51cc\u66680\u70b9\u91cd\u7f6e\u514d\u8d39\u62bd\u5956\u6b21\u6570",7233:"\u7ae0\u8282{0}\u5f00\u542f",7234:"\u51b7\u5374cd\u4e2d",7235:"<outline color=#1d668b width=2>\u5012\u8ba1\u65f6:<color=#f6ff00>{0}</color></outline>",7236:"<outline color=#1d668b width=2>\u9ad8\u6982\u7387\u51fa<color=#00d5f5>SS</color></outline>",7237:"<outline color=#1d668b width=2>\u5fc5\u5b9a\u51fa<color=#f6ff00>SSS</color></outline>",7238:"<outline color=#1d668b width=2><color=#f6ff00>\u53ef\u514d\u8d39\u53ec\u5524</color></outline>",7239:"{0}\u540e\u53ef\u518d\u6b21\u8fdb\u884c\u514d\u8d39\u53ec\u559a",7240:"{0}\u540e\u53ef\u518d\u6b21\u8fdb\u884c\u7a76\u6781\u53ec\u559a",7241:"\u5355\u6b21\u53ec\u5524",7242:"\u5341\u8fde\u53ec\u5524","\u533a":"\u533a","\u6211\u7684\u670d\u52a1\u5668":"\u6211\u7684\u670d\u52a1\u5668","\u63a8\u8350\u670d":"\u63a8\u8350\u670d","\u670d":"\u670d","\u66f4\u65b0\u4e2d":"\u66f4\u65b0\u4e2d","\u68c0\u67e5\u66f4\u65b0":"\u68c0\u67e5\u66f4\u65b0","\u62a2\u8d2d\u5269\u4f59\u65f6\u95f4":"\u62a2\u8d2d\u5269\u4f59\u65f6\u95f4:","{0}\u5143":"{0}\u5143","\u6570\u91cf\uff1a{0}":"\u6570\u91cf\uff1a{0}","\u53ea\u9700\u8981{0}\u5143\u5c31\u80fd\u62e5\u6709\u4e09\u4e2a\u793c\u5305":"\u53ea\u9700\u8981{0}\u5143\u5c31\u80fd\u62e5\u6709\u4e09\u4e2a\u793c\u5305","\u914d\u9970":"\u914d\u9970","\u4f69\u6234\uff1a":"\u4f69\u6234\uff1a","\u7d2b\u3001\u6a59\u54c1\u8d28\u914d\u9970\u624d\u53ef\u4ee5\u5347\u9636":"\u7d2b\u3001\u6a59\u54c1\u8d28\u914d\u9970\u624d\u53ef\u4ee5\u5347\u9636",ornamen_MaxHp:"\u751f       \u547d\uff1a",ornamen_Attack:"\u653b       \u51fb\uff1a",ornamen_Defence:"\u9632       \u5fa1\uff1a",ornamen_MaxHp_P:"\u751f       \u547d\uff1a",ornamen_Attack_P:"\u653b       \u51fb\uff1a",ornamen_Defence_P:"\u9632       \u5fa1\uff1a",ornamen_info_desc:"\u4f69\u6234\u5728\u4e0d\u540c\u4f4d\u7f6e\u7684\u5361\u724c\u8eab\u4e0a\uff0c\u53ef\u6fc0\u6d3b\u4e0d\u540c\u7684<color=#1C5C64>\u5929\u8d4b</color>\u6548\u679c<br/><color=#87361C>(\u6a59\u8272\u54c1\u8d28\u624d\u53ef\u4ee5\u6fc0\u6d3b\u5929\u8d4b)</color>",TalentInfo_0:"\u524d\u6392\uff1a\u914d\u9970\u751f\u547d\u589e\u52a0<color=#1C5C64>{0}%</color>",TalentInfo_1:"\u4e2d\u6392\uff1a\u914d\u9970\u653b\u51fb\u589e\u52a0<color=#1C5C64>{0}%</color>\u3001\u751f\u547d\u589e\u52a0<color=#1C5C64>{1}%</color>",TalentInfo_2:"\u540e\u6392\uff1a\u914d\u9970\u653b\u51fb\u589e\u52a0<color=#1C5C64>{0}%</color>",equipTipsStr_01:"<color=#F6FF00> {0}</color>","\u4f4d\u7f6e{0}":"\u4f4d\u7f6e\uff1a<color=#F6FF00>{0}</color>","\u6b64\u88c5\u5907{0}\u88c5\u5907\u4e2d":"<color=#fff0b5>\xb7\u6b64\u88c5\u5907{0}\u88c5\u5907\u4e2d</color>",PotentialText:"\u5f53\u524d\u5df2\u6fc0\u6d3b\u6f5c\u80fd\u6570\uff1a<color=#87361c>{0}/{1}</color>",PotentialText2:"{0}\u6f5c\u80fd\uff1a","lv\uff1a{0}":"lv\uff1a{0}","\u4f20\u627f\u524d\uff1a{0}\u7ea7":"\u4f20\u627f\u524d\uff1a{0}\u7ea7","\u4f20\u627f\u540e\uff1a{0}\u7ea7":"\u4f20\u627f\u540e\uff1a{0}\u7ea7",CardInheritText5:"\u7ee7\u627f\u540e\uff1a<color=#00dff5>{0}\u7ea7</color><color=#f6ff00>({1}\u7ea7)</color>","\u8fd4\u8fd8\u603b\u7ecf\u9a8c\u7684<color=#{0}>{1}%</color>":"\u8fd4\u8fd8\u603b\u7ecf\u9a8c\u7684<color=#{0}>{1}%</color>",CardInheritText:"\u5361\u724c\u7b49\u7ea7\u4e0d\u80fd<color=#ff0000>\u8d85\u8fc7</color>\u73a9\u5bb6\u7b49\u7ea7\uff0c\u591a\u4f59\u7684\u7ecf\u9a8c\u4f1a\u4ee5\u7ecf\u9a8c\u4e39\u65b9\u5f0f\u8fd4\u8fd8\uff0c\u8bf7\u95ee\u8fd8\u9700\u8981\u7ee7\u7eed\u8fdb\u884c\u7ee7\u627f\u5417?",CardInheritText2:"\u4f20\u627f\u5361\u724c\u7b49\u7ea7\u8fc7\u4f4e,\u65e0\u6cd5\u7ee7\u627f",CardInheritText3:"\u4f20\u627f\u524d\uff1a",CardInheritText4:"\u4f20\u627f\u540e\uff1a",CardInheritText7:"\u7ee7\u627f\u524d\uff1a{0}\u7ea7",CardInheritText8:"\u7ee7\u627f\u524d\uff1a",CardInheritText9:"\u7ee7\u627f\u540e\uff1a",CardInheritText6:"<color=#00dff5>{0}</color><color=#f6ff00>({1})</color>",CardInheritText10:"\u662f\u5426\u6d88\u8017\u94bb\u77f3\u7ee7\u627f\uff1f",ac_0:"\u5251\u9b42",ac_1:"\u6212\u7075",ac_2:"\u67aa\u9b42",ac_3:"\u5723\u676f",ac_4:"\u6218\u65a7",ac_5:"\u6218\u65a7","\u6fc0\u6d3b{0}\u795e\u5668\u788e\u7247\u53ef\u6fc0\u6d3b:{1}":"\u6fc0\u6d3b{0}\u795e\u5668\u788e\u7247\u53ef\u6fc0\u6d3b:{1}","\u5b8c\u6210{0}\u4e2a\u6761\u4ef6\u53ef\u6fc0\u6d3b":"\u5b8c\u6210{0}\u4e2a\u6761\u4ef6\u53ef\u6fc0\u6d3b",type1:"C",type2:"B",type3:"A",type4:"S",type5:"SS",type6:"SSS","\u662f\u5426\u6253\u5f00\u5145\u503c\u754c\u9762":"\u662f\u5426\u6253\u5f00\u5145\u503c\u754c\u9762","\u94bb\u77f3\u4e0d\u8db3":"\u94bb\u77f3\u4e0d\u8db3","\u524d\u5f80\u83b7\u53d6":"\u524d\u5f80\u83b7\u53d6","\u8bf7\u62d6\u84dd\u8272\u5361\u724c\u8fdb\u5165\u673a\u5173":"\u8bf7\u62d6\u84dd\u8272\u5361\u724c\u8fdb\u5165\u673a\u5173","\u51cc\u66680\u70b9\u91cd\u7f6e\u62bd\u5956\u6b21\u6570":"\u51cc\u66680\u70b9\u91cd\u7f6e\u62bd\u5956\u6b21\u6570","\u83b7\u53d6\u9014\u5f84":"\u83b7 \u53d6 \u9014 \u5f84","\u5361\u724c\u63a8\u8350":"\u5361\u724c\u63a8\u8350","\u662f\u5426\u786e\u8ba4\u9000\u51fa\u6218\u6597\u6a21\u62df\u5668":"\u662f\u5426\u786e\u8ba4\u9000\u51fa\u6218\u6597\u6a21\u62df\u5668",sandtablerule1:"1\u3001\u76f4\u63a5\u53ec\u5524\u5361\u724c\u4f1a\u6d88\u8017\u6b65\u6570\uff1a1\n2\u3001\u5361\u724c\u4ea4\u6362\u4f4d\u7f6e\u4e5f\u4f1a\u6d88\u8017\u6b65\u6570\uff1a1\n3\u3001\u6709\u9650\u7684\u6b65\u6570\u53ec\u5524\u66f4\u591a\u7684\u5361\u724c\u4e0a\u573a",sandtablerule2:"1\u3001\u53ef\u968f\u610f\u62d6\u52a8\u6218\u961f\u89d2\u8272,\u6b65\u6570\u6d88\u8017\u5b8c\u540e\u8fdb\u5165\u6218\u6597\n2\u3001\u4e09\u4e2a\u6216\u4e09\u4e2a\u4ee5\u4e0a\u76f8\u540c\u7684\u8fde\u5728\u4e00\u8d77,\u5219\u53ef\u4ee5\u5408\u6210\u66f4\u9ad8\u9636\u7684\u6218\u961f\u89d2\u8272,\u6700\u9ad8\u4e3a\u4e94\u9636\n3\u3001\u5408\u6210\u9ad8\u9636\u6218\u961f\u89d2\u8272\u7684\u540c\u65f6,\u4f1a\u53ec\u5524\u5f53\u524d\u9636\u6570\u7684\u6218\u961f\u89d2\u8272\u51fa\u573a\u6218\u6597\n4\u3001\u53ef\u4ee5\u628a\u6218\u961f\u89d2\u8272\u76f4\u63a5\u62d6\u51fa\u53ec\u5524\n5\u3001\u5408\u62103\u4e2a\u4ee5\u4e0a\u6218\u961f\u89d2\u8272\u65f6,\u53ef\u83b7\u5f97\u53ec\u5524\u6570\u91cf\u4e0e\u7b49\u7ea7\u7684\u52a0\u6210",sandtablerule3:"\u6c99\u76d8\u89c4\u5219",sandtablerule4:"\u6e38\u620f\u89c4\u5219",sandtablerule5:"\u672c\u5173\u4efb\u52a1",sandtablerule6:"\u6c99\u76d8\u4fe1\u606f",sandtablerule7:"\u4e0a\u4e00\u5173\u6c99\u76d8\u7684\u6d88\u9664\u72b6\u6001\u4f1a\u7ee7\u627f\u5230\u4e0b\u4e00\u5173",sandtableFuntip1:"\u5173\u95ed\u63d0\u793a,\u5c31\u80fd\u53bb\u9664\u6c99\u76d8\u4e2d\u8ba8\u538c\u7684\u624b\u6307\u62c9!",sandtableFuntip2:"\u4f60\u53ef\u4ee5\u53c2\u8003\u6218\u6597\u529b\u6765\u51b3\u5b9a\u53ec\u5524\u7269!","\u656c\u8bf7\u671f\u5f85":"\u656c\u8bf7\u671f\u5f85",usetitem1:"\u4f53\u529b\u503c\u4e0d\u80fd\u8d85\u8fc7{0}",chapterNumber:"\u7b2c{0}\u7ae0","\u8bbe\u7f6e":"\u8bbe\u7f6e","\u6635\u79f0\u4fee\u6539":"\u6635\u79f0\u4fee\u6539","\u4fee\u6539\u6210\u529f":"\u4fee\u6539\u6210\u529f",7700:"\u4e3b\u7ebf\u7b2c{0}\u7ae0\u5f00\u542f",7701:"<color=#87361c>\u5f00\u91c7\u4e2d</color><color=#301810>: {0}</color>",7702:"\u52a0 \u901f",7703:"\u63d0\u5347\u4e3b\u7ebf\u8fdb\u5ea6\u53ef\u63d0\u5347\u6536\u76ca\u6548\u7387",7704:"<outline color=#000000 width=2>\u63d0\u5347\u4e3b\u7ebf\u8fdb\u5ea6\u53ef<color=#f6ff00>\u63d0\u5347</color>\u6536\u76ca\u6548\u7387\n<color=#f6ff00>{0}\u77ff\u6d1e</color>\u5e73\u5747\u6bcf\u5c0f\u65f6<color=#20f66b>\u6536\u76ca\u6548\u7387</color></outline>",7705:"<outline color=#000000 width=2><color=#f6ff00>+{0}</color>/\u5c0f\u65f6</outline>",7706:"\u901a\u5173\u4e3b\u7ebf\u7b2c{0}\u7ae0\u8282\u540e\u5f00\u542f",7708:"{0}\u77ff\u6d1e",7709:"\u9884\u671f\u6536\u76ca",7710:"\u9ed1\u94c1",7711:"\u767d\u94f6",7712:"\u9ec4\u91d1",7713:"\u94bb\u77f3",7714:"\u6d3e\u9063\u540d\u5355",7715:"\u5237\u65b0",7716:"\u5f00\u91c7",7717:"\u5f00\u91c7\u65f6\u957f {0}",7718:"{0}/{1}",7719:"\u597d\u53cb\u4e92\u52a9",7720:"\u88c5\u5907",7721:"\u5f3a\u5316",7722:"\u9b42\u5361",7723:"\u597d\u53cb\u52a0\u901f",7724:"\u597d\u53cb\u77ff\u6d1e",7725:"\u6c42\u52a9\u5217\u8868",7726:"\u4e00\u952e\u5ffd\u7565",7727:"\u5269\u4f59\u52a0\u901f\u6b21\u6570:{0}",7728:"\u524d \u5f80",7729:"\u4eca\u65e5\u5077\u53d6\u6b21\u6570\u5df2\u4f7f\u7528\u5b8c\uff0c\u660e\u5929\u518d\u6765\u5427",7730:"\u6b64\u77ff\u6d1e\u5df2\u7ecf\u4e0d\u80fd\u518d\u52a0\u901f\u4e86",7732:"\u4eca\u65e5\u6536\u53d6\u6b21\u6570\u5df2\u4f7f\u7528\u5b8c\uff0c\u660e\u5929\u518d\u6765\u5427",7733:"\u77ff\u6d1e\u65e5\u5fd7",7734:"\u67e5 \u770b",7735:"{0} <color=#ff0000>\u5077\u53d6</color>\u4f60\u7684{1}\u77ff\u6d1e\uff0c\u635f\u5931",7736:"{0} \u5e2e\u52a9\u4f60<color=#07a044>\u52a0\u5feb</color>\u4e86 {1}\u77ff\u6d1e \u5f00\u91c7\u65f6\u95f4",7737:"<color=#07a044>\u53ef\u83b7\u53d6</color>",7738:"\u9080\u8bf7\u5e2e\u52a9",7739:"\u5269\u4f59\u5e2e\u52a9\u52a0\u901f\u6b21\u6570\uff1a{0}",7740:"\u5f00\u91c7\u4e2d......\n{0}",7741:"\u6ca1\u6709\u53ef\u6d3e\u9063\u5361\u724c",7742:"<outline color=#000000 width=2>\u4e3b\u7ebf\u7b2c{0}\u7ae0\n<size =22><color=#ff0000>\u5f00\u542f</color></size></outline>",7743:"\u6bcf\u4e2a\u77ff\u6d1e\u4ec5\u80fd\u5e2e\u52a9\u4e00\u6b21",7744:"\u5e2e\u52a9\u597d\u53cb{0}\u51cf\u5c11\u4e86<color=#07a044>{1}\u5206\u949f</color>{2}\u77ff\u6d1e\u7684\u5f00\u91c7\u65f6\u95f4",7745:"\u786e\u5b9a",7746:"\u5269\u4f59\u52a0\u901f\u6b21\u6570:<color=#ff0000>{0}</color>",7747:"LV:{0}",7748:" <color=#682D09>LV{0} {1}/1</color>",7749:" <color=#682D09>LV{0} <color=#ff0000>{1}/1</color></color>",7750:"<color=#301810>\u79bb\u7ebf</color>",7751:"<color=#07A044>\u5728\u7ebf</color>",7752:"<color=#87361c>\u5f00\u91c7\u4e2d</color><color=#301810>: {0}</color>",7753:"\u6b64\u77ff\u6d1e\u8fbe\u5230\u52a0\u901f\u4e0a\u9650",7754:"\u77ff\u6d1e\u672a\u5f00\u91c7",7755:"\u7ed9\u4e3b\u4eba\u7559\u4e00\u70b9\u5427\uff01",7756:"<outline color=#c35129 width=1>{0}<color=#f8ff3c> \u77ff\u6d1e</color></outline>",7760:"\u6682\u65e0\u597d\u53cb\u4fe1\u606f",7761:"\u6682\u65e0\u53ef\u6536\u53d6\u7684\u597d\u53cb\u77ff\u6d1e",7762:"\u6682\u65e0\u6c42\u52a9\u597d\u53cb\u4fe1\u606f",7763:"\u6dfb\u52a0\u597d\u53cb",7764:"\u5269\u4f59\u5077\u53d6\u6b21\u6570\uff1a{0}","\u4f24\u5bb3\u91cf":"\u4f24\u5bb3\u91cf","\u70b9\u51fb\u67e5\u770b\u8be6\u7ec6":"\u70b9\u51fb\u67e5\u770b\u8be6\u7ec6","\u6cbb\u7597\u91cf":"\u6cbb\u7597\u91cf","\u627f\u53d7\u4f24\u5bb3\u91cf":"\u627f\u53d7\u4f24\u5bb3\u91cf","\u6218\u6597\u7ed3\u7b97":"\u6218\u6597\u7ed3\u7b97","\u9635\u5bb9\u6218\u529b":"\u9635\u5bb9\u6218\u529b:{0}","\u662f\u5426\u6d88\u8017\u94bb\u77f3\u7ee7\u7eed\u8fdb\u884c\u6311\u6218":"\u662f\u5426\u6d88\u8017{0}\u94bb\u77f3\u7ee7\u7eed\u8fdb\u884c\u6311\u6218","\u6392\u540d\u5956\u52b1":"\u6392\u540d\u5956\u52b1","\u6218\u529b\u66ff\u6362":"\u6218\u529b\u66ff\u6362","\u6392\u540d\u5956\u52b1\u662f\u6d3b\u52a8\u7ed3\u7b97\u540e\u4ee5\u90ae\u4ef6\u5f62\u5f0f\u53d1\u653e\u5230\u73a9\u5bb6\u90ae\u7bb1":"\u6392\u540d\u5956\u52b1\u662f\u6d3b\u52a8\u7ed3\u7b97\u540e\u4ee5\u90ae\u4ef6\u5f62\u5f0f\u53d1\u653e\u5230\u73a9\u5bb6\u90ae\u7bb1","\u6b21\u6570\u5956\u52b1\u662f\u73a9\u5bb6\u6311\u6218\u5b8c\u9b54\u738b\u540e\u76f4\u63a5\u53d1\u653e\u5230\u73a9\u5bb6\u80cc\u5305":"\u6b21\u6570\u5956\u52b1\u662f\u73a9\u5bb6\u6311\u6218\u5b8c\u9b54\u738b\u540e\u76f4\u63a5\u53d1\u653e\u5230\u73a9\u5bb6\u80cc\u5305",pay:"\u652f\u4ed8\u53c2\u6570\u51fa\u9519","\u6d3b\u52a8\u5df2\u7ed3\u675f":"\u6d3b\u52a8\u5df2\u7ed3\u675f"},e=t=__decorate([o],e)}());i.default=a,cc._RF.pop()},{}],LayerableCompent:[function(e,t,i){"use strict";cc._RF.push(t,"d83b9RVhD5E4LumZRqpu1v0","LayerableCompent"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=cc._decorator,a=o.ccclass,r=(o.property,function(e){function t(){var t=e.call(this)||this;return t.layerIndex=0,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.addChildAtLayer=function(e,t,n){if(void 0===n&&(n=!1),n&&this.node.childrenCount>0&&(t=this.node.children[this.node.childrenCount-1].getComponent(i).layerIndex+1),e.layerIndex=t,this.existInCompent(e))this.changeLayer(e,t);else{var o=this.searchInsertIndex(t);this.node.insertChild(e.node,o)}},t.prototype.changeChildLayer=function(e,t){this.existInCompent(e)?this.changeLayer(e,t):console.warn("the child not in LayerableCompent!")},t.prototype.changeSelfLayer=function(e){var t=this.node.parent.getComponent(i);t&&t.changeChildLayer(this,e)},t.prototype.removeChildLayer=function(e,t){this.node.removeChild(e,t)},t.prototype.changeLayer=function(e,t){e.layerIndex=t;var i=this.searchInsertIndex(t);e.node.setSiblingIndex(i)},t.prototype.changeByLayer=function(e,t){this.existInCompent(e)&&(e.layerIndex=t,e.node.setSiblingIndex(t))},t.prototype.existInCompent=function(e){var t=!1;return e.node.parent==this.node&&(t=!0),t},t.prototype.searchInsertIndex=function(e){var t=this.node.childrenCount;if(this.node.childrenCount>=1)for(var n=0;n<this.node.childrenCount;n++)if(this.node.children[n].getComponent(i)&&e>this.node.children[n].getComponent(i).layerIndex){t=n;break}return t},t=i=__decorate([a],t)}(n.default));i.default=r,cc._RF.pop()},{"../../Core/Widget":"Widget"}],ListControl:[function(e,t,i){"use strict";cc._RF.push(t,"0187er1/hhODJiaF5QgYkR5","ListControl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../../Core/Widget"),o=e("../../../../GlobalContext"),a=e("../../../../Util/Utils"),r=e("../../../Gamelayer/FunBottomList"),s=e("../../../../Core/LoadManager"),l=cc._decorator,c=l.ccclass,d=(l.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.OpenList=function(e,t){void 0===t&&(t=null),t.getChildByName("FunBottomList")&&a.default.setNodeDestoryByUrl(t.getChildByName("FunBottomList"),o.GlobalContext.Root+"prefab/FunList/FunBottomBtnList"),s.default.instance.loadResByType(o.GlobalContext.Root+"prefab/FunList/FunBottomBtnList",cc.Prefab,function(i){var n=a.default.getNodeByUrl(i,o.GlobalContext.Root+"prefab/FunList/FunBottomBtnList");n.getComponent(r.default).onInitData(e),n.name="FunBottomList",t.insertChild(n,999)},this)},t.prototype.CloseList=function(){},t.instance=null,t=i=__decorate([c],t)}(n.default));i.default=d,cc._RF.pop()},{"../../../../Core/LoadManager":"LoadManager","../../../../Core/Widget":"Widget","../../../../GlobalContext":"GlobalContext","../../../../Util/Utils":"Utils","../../../Gamelayer/FunBottomList":"FunBottomList"}],ListViewCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"8219ego8RdF1IIaApqPEUgy","ListViewCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var n,o=e("../../Core/Widget");(function(e){e[e.Vertical=0]="Vertical",e[e.Horizon=1]="Horizon"})(n=i.ScrollDirEnum||(i.ScrollDirEnum={}));var a=cc._decorator,r=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.item=null,t.scrollView=null,t.dir=n.Vertical,t.spawncountrow=1,t.spawncountcol=5,t.spacingx=0,t.spacingy=0,t._totalCount=0,t._items=[],t.spawnCount=0,t._lastContentPosY=0,t._lastContentPosX=0,t._dataLsit=[],t.refreshItem=null,t.refreshItemThis=null,t._viewWidth=0,t._viewHeight=0,t._itemPools=null,t._extraHeight=0,t._extraWidth=0,t._concentinitx=0,t}return __extends(t,e),t.prototype.onLoad=function(){this._items=[],this.spawnCount=0,this._lastContentPosY=0,this._lastContentPosX=0,this._concentinitx=this.content.x,this._itemPools=new cc.NodePool},Object.defineProperty(t.prototype,"content",{get:function(){return this.scrollView.content},enumerable:!0,configurable:!0}),t.prototype.resetContentSize=function(){this.dir==n.Vertical?(this.content.height=Math.ceil(this._totalCount/this.spawncountcol)*(this.item.height+this.spacingy)-this.spacingy+this._extraHeight,this.content.width=this.item.width*this.spawncountrow+(this.spawncountrow-1)*this.spacingx+this._extraWidth,this.spawnCount=(this.spawncountrow+1)*this.spawncountcol):(this.content.height=this.item.height*(this.spawncountrow-1),this.content.width=Math.ceil(this._totalCount/this.spawncountrow)*(this.item.width+this.spacingx)-this.spacingx,this.spawnCount=(this.spawncountcol+1)*this.spawncountrow)},t.prototype.initialize=function(e){var t=this;this._dataLsit=e||[],this._items.forEach(function(e){t._itemPools.put(e)}),this._items=[],this._totalCount=this._dataLsit.length,this.resetContentSize(),this._viewHeight=(this.item.height+this.spacingy)*this.spawncountrow-this.spacingy,this._viewWidth=(this.item.width+this.spacingx)*this.spawncountcol-this.spacingx,this.spawnCount=this._totalCount>this.spawnCount?this.spawnCount:this._totalCount;var i=0,n=0,o=null;if(this.scrollView.horizontal=1==this.dir,this.scrollView.vertical=0==this.dir,0==this.dir){n=-this.item.height/2;for(var a=0;a<Math.ceil(this.spawnCount/this.spawncountcol);++a){i=this.item.width/2;for(var r=0;r<this.spawncountcol;++r){o=this._itemPools.size()?this._itemPools.get():cc.instantiate(this.item),this.content.addChild(o),o.setPosition(i,n);var s=this.getItemIndex(i,n);o.active=s<=this._totalCount-1,this.onRefreshItem(o),this._items.push(o),i+=this.item.width+this.spacingx}n+=-(this.item.height+this.spacingy)}}else{i=this.item.width/2;for(a=0;a<Math.ceil(this.spawnCount/this.spawncountrow);++a){n=-this.item.height/2;for(r=0;r<this.spawncountrow;++r){o=this._itemPools.size()?this._itemPools.get():cc.instantiate(this.item),this.content.addChild(o),o.setPosition(i,n);s=this.getItemIndex(i,n);o.active=s<=this._totalCount-1,this.onRefreshItem(o),this._items.push(o),n+=-(this.item.height+this.spacingy)}i+=this.item.width+this.spacingx}}this.aupdate(!0)},t.prototype.onRefreshItem=function(e){var t=this.getItemIndex(e.x,e.y);e.active=t<=this._totalCount-1,this.refreshItem&&e.active&&this.refreshItem.apply(this.refreshItemThis,[e,t])},t.prototype.getItemIndex=function(e,t){var i=Math.floor(Math.floor(e/(this.item.width+this.spacingx))),o=Math.floor(Math.floor(Math.abs(t)/(this.item.height+this.spacingy)));return this.dir==n.Vertical?i+o*this.spawncountcol:i*this.spawncountrow+o},t.prototype.getPositionInView=function(e){var t=e.parent.convertToWorldSpaceAR(e.position);return this.scrollView.node.convertToNodeSpaceAR(t)},t.prototype.aupdate=function(e){void 0===e&&(e=!1);var t=this._items;if(this.dir==n.Vertical){if(this._lastContentPosY>=this.content.height-this._viewHeight&&!e)return void(this._lastContentPosY=this.scrollView.content.y);var i;i=this.scrollView.content.y<=this._lastContentPosY,(this.item.height+this.spacingy)*(Math.ceil(t.length/this.spawncountrow)+1);for(var o=0,a=0;a<t.length;++a){var r=this.getPositionInView(t[a]);i?(o=this._viewHeight+this.item.height+2*this.spacingy,r.y-this.item.height/2<-o&&t[a].y+o<0&&(t[a].y=t[a].y+o,this.onRefreshItem(t[a]))):(o=this.item.height/2,r.y>o&&t[a].y-(this._viewHeight+this.item.height+this.spacingy)>-this.content.height&&(t[a].y=t[a].y-(this._viewHeight+this.item.height+2*this.spacingy),this.onRefreshItem(t[a])))}this._lastContentPosY=this.scrollView.content.y}else{if(this._lastContentPosX>=this.content.width-this._viewWidth&&e)return void(this._lastContentPosX=this.scrollView.content.x);var s;s=this.scrollView.content.x<=this._lastContentPosX,(this.item.width+this.spacingx)*Math.ceil(t.length/this.spawncountcol);var l=0;for(a=0;a<t.length;++a){r=this.getPositionInView(t[a]);s?(l=-this.item.width/2,r.x<l&&t[a].x-(this._viewWidth+this.item.width+this.spacingx)<this.content.width&&(t[a].x=t[a].x+(this._viewWidth+this.item.width+2*this.spacingx),this.onRefreshItem(t[a]))):(l=this._viewWidth+this.item.width/2+2*this.spacingx,r.x>l&&t[a].x-(this._viewWidth+this.item.width+2*this.spacingx)>=this.item.width/2&&(t[a].x=t[a].x-(this._viewWidth+this.item.width+2*this.spacingx),this.onRefreshItem(t[a])))}this._lastContentPosX=this.scrollView.content.x}},t.prototype.addItem=function(){this._totalCount=this._totalCount+1,this.resetContentSize(),this.aupdate(!0)},t.prototype.removeItem=function(){this._totalCount-1?cc.error("can't remove item less than 30!"):(this._totalCount=this._totalCount-1,this.resetContentSize(),this.aupdate(!0))},t.prototype.scrollEvent=function(e,t){this.aupdate()},Object.defineProperty(t.prototype,"items",{get:function(){return this._items},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataLsit",{get:function(){return this._dataLsit},enumerable:!0,configurable:!0}),t.prototype.scrollToTop=function(e){void 0===e&&(e=.1),this.scrollView.scrollToTop(e)},t.prototype.scrollToLeft=function(e){void 0===e&&(e=.1),this.scrollView.scrollToLeft(e)},t.prototype.extraHeight=function(e){this._extraHeight=e},t.prototype.extraWidth=function(e){this._extraWidth=e},__decorate([s(cc.Node)],t.prototype,"item",void 0),__decorate([s(cc.ScrollView)],t.prototype,"scrollView",void 0),__decorate([s(cc.Integer)],t.prototype,"dir",void 0),__decorate([s(cc.Integer)],t.prototype,"spawncountrow",void 0),__decorate([s(cc.Integer)],t.prototype,"spawncountcol",void 0),__decorate([s(cc.Integer)],t.prototype,"spacingx",void 0),__decorate([s(cc.Integer)],t.prototype,"spacingy",void 0),t=__decorate([r],t)}(o.default);i.default=l,cc._RF.pop()},{"../../Core/Widget":"Widget"}],Listcell:[function(e,t,i){"use strict";cc._RF.push(t,"c28dbdzo1NJk4GBGmhCSLBX","Listcell"),Object.defineProperty(i,"__esModule",{value:!0});var n=cc._decorator,o=n.ccclass,a=(n.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var i;return __extends(t,e),i=t,t.prototype.onEnable=function(){},t.prototype.onDisable=function(){},Object.defineProperty(t.prototype,"setIndex",{get:function(){return i._setIndex},set:function(e){i._setIndex=e},enumerable:!0,configurable:!0}),t.prototype.listcellinit=function(e,t){this._listcellinit(e,t)},t.prototype._listcellinit=function(e,t){},t._setIndex=0,t=i=__decorate([o],t)}(cc.Component));i.default=a,cc._RF.pop()},{}],LoadManager:[function(e,t,i){"use strict";cc._RF.push(t,"9884f3OtkxE2a+XvJeuA/3D","LoadManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./TimeController"),o=cc._decorator,a=o.ccclass,r=(o.property,function(){function e(){this._loadingDic={},this._loadedDic={},this._loadFailDic={},this._loadHTTPFailDic={},this._loadResByTypeCount=0,this._loadResByTypeWaitLoadList=[],this._loadCount=0,this._loadHttpWaitLoadList=[]}var t;return t=e,Object.defineProperty(e,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this._loadingDic={},this._loadedDic={}},e.prototype.loadResByType=function(e,t,i,o,a,r,s,l){var c=this;if(void 0===a&&(a=null),void 0===r&&(r=null),void 0===s&&(s=null),void 0===l&&(l=null),this._loadedDic[e]){if(i){var d=[this._loadedDic[e]];a&&(d=d.concat(a)),i.apply(o,d)}}else if(this._loadingDic[e])this.AddCallbackToList(this._loadingDic[e],e,i,o,a);else if(this._loadResByTypeCount>=600){for(var p=!1,h=null,u=0;u<this._loadResByTypeWaitLoadList.length;u++)if((h=this._loadResByTypeWaitLoadList[u]).url==e){this.AddCallbackToList(h.list,e,i,o,a),p=!0;break}0==p&&(h={url:e,type:t,list:[[i,o,a]]},this._loadResByTypeWaitLoadList.push(h))}else this._loadingDic[e]=[[i,o,a]],this._loadResByTypeCount++,cc.loader.loadRes(e,t,function(e,t,i){if(r){var n=[e,t,i];l&&(n=n.concat(l)),r.apply(s,n)}},function(i,o){if(i){var a=c._loadingDic[e];if(c._loadingDic[e]=null,delete c._loadingDic[e],c._loadResByTypeCount--,c.loadWaitList(),console.log(e,JSON.stringify(i)),console.log(e,i.name),console.log(e,i.message),console.log(e,i.stack),c._loadFailDic[e]||(c._loadFailDic[e]={},c._loadFailDic[e].num=0),c._loadFailDic[e].num<=15){c._loadFailDic[e].num++,console.log("\u52a0\u8f7d\u5931\u8d25\uff0c\u91cd\u65b0\u5c1d\u8bd5\u52a0\u8f7d, num: "+c._loadFailDic[e].num+", url:"+e);var r=n.default.instance.setTimeout(function(){for(var i=0;i<a.length;i++){var o=a[i][0],s=a[i][1],l=a[i][2],d=a[i][3];console.log("\u52a0\u8f7d\u91cd\u65b0\u5c1d\u8bd5\u52a0\u8f7d, "+e,d||t,o,s,l),c.loadResByType(e,d||t,o,s,l)}n.default.instance.clearTimeout(r)},c,500)}else console.error("\u52a0\u8f7d\u5931\u8d25, url: "+e+", error: "+i.name+", "+i.message+", "+i.stack,i)}else{c._loadedDic[e]=o;var s=c._loadingDic[e];if(c._loadingDic[e]=null,delete c._loadingDic[e],c._loadResByTypeCount--,c.loadWaitList(),s)for(var l=0;l<s.length;l++){var d=s[l][0],p=s[l][1],h=s[l][2];if(d){var u=[o];h&&(u=u.concat(h)),d.apply(p,u)}}}})},e.prototype.loadHttpWaitList=function(){if(this._loadHttpWaitLoadList&&this._loadHttpWaitLoadList.length>0)for(var e=this._loadHttpWaitLoadList.shift(),t=e.url,i=e.list,n=0;n<i.length;n++)this.load(t,i[n][0],i[n][1],i[n][2])},e.prototype.loadWaitList=function(){if(this._loadResByTypeWaitLoadList&&this._loadResByTypeWaitLoadList.length>0)for(var e=this._loadResByTypeWaitLoadList.shift(),t=e.url,i=e.type,n=e.list,o=0;o<n.length;o++)this.loadResByType(t,i,n[o][0],n[o][1],n[o][2])},e.prototype.AddCallbackToList=function(e,t,i,n,o){void 0===o&&(o=null);for(var a=0;a<e.length;a++)if(e[a][0]==i&&e[a][1]==n&&1==this.IsSameList(e[a][2],o))return;e.push([i,n,o])},e.prototype.IsSameList=function(e,t){if(e==t)return!0;if(!e||!t)return!1;for(var i=0;i<e.length;i++)if(e[i]!=t[i])return!1;return!0},e.prototype.loadResArray=function(e,t,i,n,o,a,r,s){void 0===o&&(o=null),void 0===a&&(a=null),void 0===r&&(r=null),void 0===s&&(s=null),e&&e.length>0&&this.loadResArrayItemHandle(null,t,e,[],i,n,o,a,r,s)},e.prototype.loadResArrayItemHandle=function(e,i,n,o,a,r,s,l,c,d){if(void 0===s&&(s=null),void 0===l&&(l=null),void 0===c&&(c=null),void 0===d&&(d=null),e&&(o.push(e),l)){var p=[o.length,n.length,e];d&&(p=p.concat(d)),l.apply(c,p)}if(n&&n.length>0){var h=void 0,u=n.shift();h="[object Array]"===Object.prototype.toString.call(i)?h.shift():i,t.instance.loadResByType(u,h,this.loadResArrayItemHandle,this,[i,n,o,a,r,s,l,c,d])}else if(a){p=[o];s&&(p=p.concat(s)),a.apply(r,p)}},e.prototype.loadResArray2=function(e,t,i,n,o,a,r){void 0===n&&(n=null),void 0===o&&(o=null),void 0===a&&(a=null),void 0===r&&(r=null),cc.loader.loadResArray(e,function(e,t,i){if(o){var n=[e,t,i];r&&(n=n.concat(r)),o.apply(a,n)}},function(o,a){if(o)return console.log(e,JSON.stringify(o)),console.log(e,o.name),console.log(e,o.message),void console.log(e,o.stack);if(t){var r=[a];n&&(r=r.concat(n)),t.apply(i,r)}})},e.prototype.loadResDir=function(e,t,i,n,o,a,r,s){var l=this;if(void 0===o&&(o=null),void 0===a&&(a=null),void 0===r&&(r=null),void 0===s&&(s=null),this._loadedDic[e]){if(i){var c=[this._loadedDic[e].resource,this._loadedDic[e].urls];o&&(c=c.concat(o)),i.apply(n,c)}}else this._loadingDic[e]?this.AddCallbackToList(this._loadingDic[e],e,i,n,o):(this._loadingDic[e]=[[i,n,o]],cc.loader.loadResDir(e,t,function(e,t,i){if(a){var n=[e,t,i];s&&(n=n.concat(s)),a.apply(r,n)}},function(t,i,n){if(t)return console.log(e,JSON.stringify(t)),console.log(e,t.name),console.log(e,t.message),void console.log(e,t.stack);l._loadedDic[e]={},l._loadedDic[e].type="dir",l._loadedDic[e].resource=i,l._loadedDic[e].urls=n;var o=l._loadingDic[e];l._loadingDic[e]=null,delete l._loadingDic[e];for(var a=0;a<o.length;a++){var r=o[a][0],s=o[a][1],c=o[a][2];if(r){var d=[i,n];c&&(d=d.concat(c)),r.apply(s,d)}}}))},e.prototype.load=function(e,t,i,o,a,r,s,l){var c=this;if(void 0===o&&(o=null),void 0===a&&(a=null),void 0===r&&(r=null),void 0===s&&(s=null),void 0===l&&(l="png"),this._loadedDic[e]){if(t){var d=[this._loadedDic[e]];o&&(d=d.concat(o)),t.apply(i,d)}}else if(this._loadingDic[e])this.AddCallbackToList(this._loadingDic[e],e,t,i,o);else if(this._loadCount>=8){for(var p=!1,h=null,u=0;u<this._loadHttpWaitLoadList.length;u++)if((h=this._loadHttpWaitLoadList[u]).url==e){this.AddCallbackToList(h.list,e,t,i,o),p=!0;break}0==p&&(h={url:e,list:[[t,i,o]]},this._loadHttpWaitLoadList.push(h))}else this._loadingDic[e]=[[t,i,o]],this._loadCount++,e.indexOf(".jpg")>=0&&(l="jpg"),cc.loader.load({url:e,type:l},function(e,t,i){if(a){var n=[e,t,i];s&&(n=n.concat(s)),a.apply(r,n)}},function(t,i){if(t){var o=c._loadingDic[e];if(c._loadingDic[e]=null,delete c._loadingDic[e],c._loadCount--,c.loadHttpWaitList(),console.log(e,JSON.stringify(t)),console.log(e,t.name),console.log(e,t.message),console.log(e,t.stack),c._loadHTTPFailDic[e]||(c._loadHTTPFailDic[e]={},c._loadHTTPFailDic[e].num=0),c._loadHTTPFailDic[e].num<=15){c._loadHTTPFailDic[e].num++,console.log("\u52a0\u8f7d\u7f51\u7edc\u8d44\u6e90\u5931\u8d25\uff0c\u91cd\u65b0\u5c1d\u8bd5\u52a0\u8f7d, num: "+c._loadHTTPFailDic[e].num+", url:"+e);var a=n.default.instance.setTimeout(function(){for(var t=0;t<o.length;t++){var i=o[t][0],r=o[t][1],s=o[t][2];console.log("\u52a0\u8f7d\u91cd\u65b0\u5c1d\u8bd5\u52a0\u8f7d\u7f51\u7edc\u8d44\u6e90, "+e,i,r,s),c.load(e,i,r,s)}n.default.instance.clearTimeout(a)},c,500)}else console.error("\u7f51\u7edc\u8d44\u6e90\u52a0\u8f7d\u5931\u8d25, url: "+e+", error: "+t.name+", "+t.message+", "+t.stack,t)}else{c._loadedDic[e]=i;var r=c._loadingDic[e];if(c._loadingDic[e]=null,delete c._loadingDic[e],c._loadCount--,c.loadHttpWaitList(),r)for(var s=0;s<r.length;s++){var l=r[s][0],d=r[s][1],p=r[s][2];if(l){var h=[i];p&&(h=h.concat(p)),l.apply(d,h)}}}})},e.prototype.isLoading=function(e){return console.log("\u68c0\u6d4b\u52a0\u8f7d\u72b6\u6001\uff1a  "+e),console.log("_loadingDic   "+this._loadingDic[e]),console.log("_loadedDic   "+this._loadedDic[e]),void 0!==this._loadingDic[e]||void 0!==this._loadedDic[e]},e=t=__decorate([a],e)}());i.default=r,cc._RF.pop()},{"./TimeController":"TimeController"}],LoadingController:[function(e,t,i){"use strict";cc._RF.push(t,"a8903NiolRLGIR5YqQr4FGc","LoadingController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../Core/ConfigsManager"),a=cc._decorator,r=a.ccclass,s=(a.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tipIndex=0,t.conf={},t}var i;return __extends(t,e),i=t,Object.defineProperty(t,"instance",{get:function(){return i._instance||(i._instance=new i,i.instance.init()),i._instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){this.conf=o.ConfigsManager.instance.getConfigs("loadingtipconf").loadingtip[1]},t.prototype.getCurShowTip=function(e){void 0===e&&(e=1);var t=this.conf[this.tipIndex].desc;return this.tipIndex++,this.tipIndex>=this.conf.length&&(this.tipIndex=Math.max(e,0)),t},t=i=__decorate([r],t)}(n.default));i.default=s,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Controller":"Controller"}],LoadingPanel:[function(e,t,i){"use strict";cc._RF.push(t,"c4484cs5K1OfIkPch7h4lDW","LoadingPanel"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/TimeController"),a=e("../Scene/Controller/SceneController"),r=e("../../Global/GlobalValue"),s=e("../Status/StatusType"),l=e("../Gamelayer/GameLayer"),c=e("../../Core/GameEventDispatcher"),d=e("../../Core/Event"),p=e("./LoadingController"),h=e("../Login/LoginController"),u=e("../../Core/CacheManager"),f=e("../Sound/SoundController"),g=e("../Scene/UIAnim/VariousAnim"),y=cc._decorator,m=y.ccclass,C=y.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.SceneLoading=null,t.LoadingBG=null,t.LoadingProgress=null,t.ProgressLabel=null,t.LoadingProgressPoint=null,t.descLabel=null,t._currentPercent=0,t._addPercent=0,t._maxPercent=0,t._setSceneLoadingProgressTime=0,t.completeCallback=null,t.completeCallbackThisObj=null,t.completeCallbackParam=null,t.hideCompleteCallback=null,t.hideCompleteCallbackThisObj=null,t.hideCompleteCallbackParam=null,t.isLoadingFinish=!0,t.intervalTime=0,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this),this.LoadingProgressPoint.active=!1,c.GameEventDispatcher.instance.on(d.EventDefiner.SocketConnectSuccess,this.socketConnectSuccess,this)},t.prototype.hide=function(){e.prototype.hide.call(this),o.default.instance.clearInterval(this._setSceneLoadingProgressTime),c.GameEventDispatcher.instance.off(d.EventDefiner.SocketConnectSuccess,this.socketConnectSuccess,this)},t.prototype.socketConnectSuccess=function(){console.log("\u5207\u6362\u573a\u666f\u4e2d\uff0c\u65ad\u7ebf\u91cd\u8fde\u9700\u91cd\u65b0\u5237\u65b0"),c.GameEventDispatcher.instance.emit(d.EventDefiner.SocketConnectFail)},t.prototype.showSceneLoadingFinish=function(e,t){void 0===e&&(e=-1),void 0===t&&(t=-1),e<=0&&(e=500),console.log("\u52a0\u8f7d\u9875\u51c6\u5907\u5173\u95ed"),this.showSceneLoading(100,e,t)},t.prototype.showSceneLoading=function(e,t,i){var n=this;void 0===i&&(i=-1),0==this.intervalTime&&(this.descLabel.string=p.default.instance.getCurShowTip(),this.intervalTime=o.default.instance.setInterval(function(){n.descLabel.string=p.default.instance.getCurShowTip()},this,p.default.instance.conf[0].intervalTime)),this.isLoadingFinish=!1,console.log("LoadingPanel.showSceneLoading, toPercent:"+e+", time:"+t),this.SceneLoading.setPosition(0,0),l.default.instance&&l.default.instance.begainanim.length>0&&s.ActivityStatus.value==s.ActivityStatus.Chapter||(this.SceneLoading.active=!0);i>=0&&(this._currentPercent=i),this._maxPercent=e,e<=this._currentPercent?this._addPercent=0:this._addPercent=(e-this._currentPercent)/(t/30),this.setSceneLoadingProgressShow(),o.default.instance.clearInterval(this._setSceneLoadingProgressTime),this._setSceneLoadingProgressTime=o.default.instance.setInterval(this.setSceneLoadingProgress,this,30)},t.prototype.hideSceneLoading=function(){var e=this;0!=this.intervalTime&&(o.default.instance.clearInterval(this.intervalTime),this.intervalTime=0),a.default.instance.scenestatus==r.GameScene.Scene?(this.hideCompleteCallback&&(this.hideCompleteCallback.apply(this.hideCompleteCallbackThisObj,this.hideCompleteCallbackParam),this.hideCompleteCallback=null,this.hideCompleteCallbackThisObj=null,this.hideCompleteCallbackParam=null),console.log("hideSceneLoading1",s.ActivityStatus.value,a.default.instance.scenestatus),this.isLoadingFinish=!0,s.ActivityStatus.value==s.ActivityStatus.Chapter&&c.GameEventDispatcher.instance.emit(d.EventDefiner.ChapterLoadComplete),cc.find("content",this.SceneLoading).active=!1,this.SceneLoading.active=!1,this.PreviewLayerclear(),this.scheduleOnce(function(){cc.find("content",e.SceneLoading).active=!0},.1)):(console.log("hideSceneLoading2",a.default.instance.scenestatus),a.default.instance.scenestatus==r.GameScene.Main?s.ActivityStatus.value==s.ActivityStatus.TreasureMap?(this.SceneLoading.active=!1,this.isLoadingFinish=!0,this.PreviewLayerclear()):(cc.find("content",this.SceneLoading).active=!1,this.SceneLoading.active=!1,this.isLoadingFinish=!0,this.scheduleOnce(function(){cc.find("content",e.SceneLoading).active=!0},.1),this.PreviewLayerclear()):(this.SceneLoading.active=!1,this.isLoadingFinish=!0,this.PreviewLayerclear())),o.default.instance.clearInterval(this._setSceneLoadingProgressTime),this.completeCallback&&(this.completeCallback.apply(this.completeCallbackThisObj,this.completeCallbackParam),this.completeCallback=null,this.completeCallbackThisObj=null,this.completeCallbackParam=null)},t.prototype.PreviewLayerclear=function(){switch(a.default.instance.scenestatus){case r.GameScene.Main:case r.GameScene.Scene:f.default.instance.PlayBGM(f.SoundType.mainBG);break;case r.GameScene.Fight:}},t.prototype.setSceneLoadingProgress=function(){if(1==this.SceneLoading.active){if(this._currentPercent<this._maxPercent&&(this._currentPercent+=this._addPercent),this._currentPercent>=this._maxPercent&&this._maxPercent<90){var e=this._maxPercent+10;return e>90&&(e=90),void this.showSceneLoading(e,5e3)}this._currentPercent==5*this._addPercent&&g.default.instance.oldStatus==r.GameScene.Fight&&u.default.instance.invUseRecord(),this._currentPercent>this._maxPercent&&(this._currentPercent=this._maxPercent),this.setSceneLoadingProgressShow(),this._currentPercent>=100&&(console.log("\u52a0\u8f7d\u5b8c\u6210"),this.hideSceneLoading())}else o.default.instance.clearInterval(this._setSceneLoadingProgressTime)},t.prototype.setSceneLoadingProgressShow=function(){this.LoadingProgress.getComponent(cc.Sprite).fillRange=this._currentPercent/100,this.ProgressLabel.string=Math.floor(this._currentPercent)+"",this.LoadingProgressPoint.x=Math.min(679,this.LoadingProgress.width*this._currentPercent/100),this.LoadingProgressPoint.active=this.LoadingProgressPoint.x>23},t.prototype.onResetGame=function(){h.default.instance.resetGame()},t.instance=null,__decorate([C(cc.Node)],t.prototype,"SceneLoading",void 0),__decorate([C(cc.Node)],t.prototype,"LoadingBG",void 0),__decorate([C(cc.Node)],t.prototype,"LoadingProgress",void 0),__decorate([C(cc.Label)],t.prototype,"ProgressLabel",void 0),__decorate([C(cc.Node)],t.prototype,"LoadingProgressPoint",void 0),__decorate([C(cc.Label)],t.prototype,"descLabel",void 0),t=i=__decorate([m],t)}(n.default);i.default=v,cc._RF.pop()},{"../../Core/CacheManager":"CacheManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../../Global/GlobalValue":"GlobalValue","../Gamelayer/GameLayer":"GameLayer","../Login/LoginController":"LoginController","../Scene/Controller/SceneController":"SceneController","../Scene/UIAnim/VariousAnim":"VariousAnim","../Sound/SoundController":"SoundController","../Status/StatusType":"StatusType","./LoadingController":"LoadingController"}],Loading:[function(e,t,i){"use strict";cc._RF.push(t,"21c9dqSmXNCVoChitwh/d4a","Loading"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../LoadingPanel/LoadingController"),o=e("../../Core/TimeController"),a=e("../../Core/ConfigsManager"),r=e("../Role/RoleInfo"),s=e("./LoginController"),l=e("../Sound/SoundController"),c=cc._decorator,d=c.ccclass,p=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.PercentBar=null,t.PercentBarPoint=null,t.PercentLabel=null,t.GameEnter=null,t.descLabel=null,t.sceneName="",t.intervalTime=0,t.progreeIntervalTime=0,t.progreeIntervalPercent=0,t}return __extends(t,e),t.prototype.onDestroy=function(){console.log("\u88ab\u9500\u6bc1")},t.prototype.start=function(){var e=this;this.PercentBarPoint.active=!1,this.descLabel.string=n.default.instance.getCurShowTip(0),this.intervalTime=o.default.instance.setInterval(function(){e.descLabel.string=n.default.instance.getCurShowTip(0)},this,n.default.instance.conf[0].intervalTime),l.default.instance.PlayBGM(l.SoundType.mainBG)},t.prototype.onDisable=function(){o.default.instance.clearInterval(this.intervalTime),this.clearProgreeIntervalTime(),l.default.instance.StopBGM()},t.prototype.clearProgreeIntervalTime=function(){this.progreeIntervalTime&&(o.default.instance.clearInterval(this.progreeIntervalTime),this.progreeIntervalTime=0)},t.prototype.setLoadPregress=function(e){if(this.isValid){var t=e<this.PercentBar.fillRange?this.PercentBar.fillRange:e;this.PercentLabel.string=(100*t).toFixed(0),this.PercentBar.fillRange=t,this.PercentBarPoint.x=Math.min(679,this.PercentBar.node.width*t),this.PercentBarPoint.active=this.PercentBarPoint.x>23}},t.prototype.gameStart=function(e){var t=this;this.PercentBar.fillRange=0,this.GameEnter.active=!1,this.node.active=!0,this.sceneName=e,0==this.progreeIntervalTime&&(this.progreeIntervalTime=o.default.instance.setInterval(function(){t.progreeIntervalPercent+=.02*Math.random(),t.progreeIntervalPercent>=1?t.clearProgreeIntervalTime():t.setLoadPregress(t.progreeIntervalPercent)},this,100)),cc.director.preloadScene(e,function(i,n,l){if("Main"==e)1!=n&&t.clearProgreeIntervalTime(),0==n?t.setLoadPregress(.5):t.setLoadPregress(i/n*.8),i==n&&(t.clearProgreeIntervalTime(),a.ConfigsManager.instance.init(function(e,i,n){console.log("\u52a0\u8f7d\u8868 \u8fdb\u5ea6"+e,a.ConfigsManager.instance.loadConfigsName.length),t.setLoadPregress(.8+.19*e/a.ConfigsManager.instance.loadConfigsName.length)},t,function(){var i=0,n=o.default.instance.setInterval(function(){t.isValid&&(console.log("\u68c0\u6d4b\u5f00\u573a\u52a8\u753b\u662f\u5426\u52a0\u8f7d\u5b8c\u6210"),r.MyRoleInfo.firstgame?(i++,(s.default.instance.beginAniCom||i>150)&&(t.setLoadPregress(1),console.log("\u5207\u6362\u573a\u666f2",e),cc.director.loadScene(e),o.default.instance.clearInterval(n))):(t.setLoadPregress(1),console.log("\u5207\u6362\u573a\u666f1",e),cc.director.loadScene(e),o.default.instance.clearInterval(n)))},t,200)},t));else{if(t.setLoadPregress(i/n),!t.isValid)return;console.log("---------\u52a0\u8f7d\u8868 \u8fdb\u5ea6"+i,n),i==n&&(cc.director.loadScene(e),console.log("\u5207\u6362\u573a\u666f3",e))}},function(e,t){if(e)return console.log(e.name),console.log(e.message),console.log(e.stack),void console.log(t)})},t.prototype.clickResetBtn=function(){s.default.instance.resetGame()},__decorate([p(cc.Sprite)],t.prototype,"PercentBar",void 0),__decorate([p(cc.Node)],t.prototype,"PercentBarPoint",void 0),__decorate([p(cc.Label)],t.prototype,"PercentLabel",void 0),__decorate([p(cc.Node)],t.prototype,"GameEnter",void 0),__decorate([p(cc.Label)],t.prototype,"descLabel",void 0),t=__decorate([d],t)}(cc.Component);i.default=h,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/TimeController":"TimeController","../LoadingPanel/LoadingController":"LoadingController","../Role/RoleInfo":"RoleInfo","../Sound/SoundController":"SoundController","./LoginController":"LoginController"}],LoardCrusadeCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"7cae5VZc0hG+Z4cxTi7wZ8D","LoardCrusadeCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../NetConnect/NetConnet"),a=e("../../Core/ConfigsManager"),r=e("../../Core/GameEventDispatcher"),s=e("../WarTeam/MonsterController"),l=e("../Role/RoleInfo"),c=cc._decorator,d=c.ccclass,p=(c.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.devilConf=null,t.monsterIndex=null,t.bossID=null,t.myDevilRankData=null,t.times=0,t.loardCrusadeImage=null,t.loardRank=null,t.loardFightNum=0,t.isFrist=!1,t}var i;return __extends(t,e),i=t,t.prototype.listNotification=function(){i.instance=this,this.addProto("devilinfo",this.devilInfo,this),this.devilConf=a.ConfigsManager.instance.getConfigs("devilconf")},t.prototype.devilInfo=function(e){this.monsterIndex=e.index,this.loardCrusadeImage=e.data.image,this.times=e.data.times,this.isFrist=e.first,this.bossID=this.devilConf.boss[1][this.monsterIndex].id,this.loardFight(),r.GameEventDispatcher.instance.emit("LoardCrusade",this)},t.prototype.myDevilRank=function(e){this.myDevilRankData=e,r.GameEventDispatcher.instance.emit("MyDevilRank",this)},t.prototype.sendDevilInfo=function(){o.default.instance.sendProto({cmd:"devilinfo",actId:3})},t.prototype.sendDevilDamage=function(e){var t={cmd:"devildamage",damage:e,actId:3};o.default.instance.sendProto(t)},t.prototype.sendEnterDevil=function(){o.default.instance.sendProto({cmd:"devilenter",actId:3})},t.prototype.sendSetDevilSandTable=function(){o.default.instance.sendProto({cmd:"devilsetsandtable",actId:3})},t.prototype.sendDevilRank=function(e){var t={cmd:"rankdata",type:e};o.default.instance.sendProto(t)},t.prototype.loardFight=function(){var e=s.default.instance.getServerListChangeBattleList(this.loardCrusadeImage);for(var t in this.loardFightNum=0,this.loardFightNum+=l.MyRoleInfo.Fight,e)this.loardFightNum+=s.default.instance.getCarFight(e[t].cardid,e[t].level,e[t].grade)*e[t].count},t.instance=null,t=i=__decorate([d],t)}(n.default));i.default=p,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Controller":"Controller","../../Core/GameEventDispatcher":"GameEventDispatcher","../../NetConnect/NetConnet":"NetConnet","../Role/RoleInfo":"RoleInfo","../WarTeam/MonsterController":"MonsterController"}],LoardCrusadeWin:[function(e,t,i){"use strict";cc._RF.push(t,"a18b62zjR5H6aQwAO+yzz6P","LoardCrusadeWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("./LoardCrusadeCtrl"),a=e("../../GlobalContext"),r=e("../../Core/WindowManager"),s=e("../../Core/GameEventDispatcher"),l=e("../Activity/ActivityController"),c=e("../Commons/MonsterPreview"),d=e("../../Core/WindowType"),p=e("../../Util/Utils"),h=e("../WarTeam/MonsterController"),u=e("../../Core/TimeController"),f=e("../../Global/GlobalValue"),g=e("../RankingList/RankingConst"),y=e("../Tips/OpTipsController"),m=e("../../Core/Language"),C=e("../SandTable/SandTableController"),v=e("../../Core/Event"),_=e("../OpenWin/OpenWinController"),b=e("../Commons/ListViewCtrl"),T=e("../Gamelayer/RoleHead"),S=e("../Role/RoleInfo"),I=e("../../Core/CommonsResManager"),w=e("../../Util/CommonUtil"),D=e("../Tips/TipsWinController"),R=e("./DevilResult"),A=e("../../Util/NumberUtil"),N=e("../Commons/Image"),L=e("../Scene/Controller/SkillController"),E=e("./DevilRankItem"),B=cc._decorator,M=B.ccclass,x=B.property,k=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.btnSetLineup=null,t.btnNewLineup=null,t.GrayNode=null,t.bossLayout=null,t.listViewCtrl=null,t.bossNode=null,t.rankNode=null,t.commAtlas=null,t.loardCursadeAtlas=null,t.fightLabe=null,t.outTimeLabe=null,t.bossStatueAnim=null,t.worldBossAlat=null,t.timesLabel=null,t.timer=null,t.devilCtrl=null,t.countDown=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),this.devilCtrl=o.default.instance,o.default.instance.sendDevilInfo(),this.NodeSetPosition(),this.listViewCtrl.refreshItem=this.ScrollInfo,this.listViewCtrl.refreshItemThis=this,s.GameEventDispatcher.instance.on("LoardCrusade",this.actchange,this),s.GameEventDispatcher.instance.on("LoardRank",this.rankInfo,this),s.GameEventDispatcher.instance.on("MyDevilRank",this.myRank,this),s.GameEventDispatcher.instance.on("SetCard",function(){o.default.instance.sendDevilInfo()},this)},t.prototype.hide=function(){e.prototype.hide.call(this),this.closeUpdateRank(),this.countDown&&u.default.instance.clearInterval(this.countDown),s.GameEventDispatcher.instance.off("LoardCrusade",this.actchange,this),s.GameEventDispatcher.instance.off("SetCard",function(){o.default.instance.sendDevilInfo()},this)},t.prototype.NodeSetPosition=function(){var e=cc.find("BossInfo/Info",this.node);e.y=-a.GlobalContext.UIHeight/2+e.height/2-2,e.x=-a.GlobalContext.UIWidth/2+e.width/2+110,cc.find("btnClose",this.node).y=a.GlobalContext.UIHeight/2-cc.find("btnClose",this.node).height/2+2,cc.find("btnClose",this.node).x=-a.GlobalContext.UIWidth/2+cc.find("btnClose",this.node).width/2+2,cc.find("Title",this.node).y=a.GlobalContext.UIHeight/2-cc.find("Title",this.node).height/2+2,cc.find("Title",this.node).x=-a.GlobalContext.UIWidth/2+cc.find("Title",this.node).width/2+2},t.prototype.actchange=function(){var e=l.default.instance.actstatusArr[3];this.lineUpFight(),this.monsterInfo(),this.bossInfo(),this.countDownInfo(e)},t.prototype.openUpdateRank=function(){var e=this;this.timer=u.default.instance.setInterval(function(){e.devilCtrl.sendDevilRank(g.RankingType.Devil)},this,5e3)},t.prototype.closeUpdateRank=function(){this.timer&&u.default.instance.clearInterval(this.timer)},t.prototype.monsterInfo=function(){for(var e=cc.find("BossLayer/playLayer",this.node),t=cc.find("BossLayer",this.node),i=e.childrenCount-1;i>=0;i--){e.children[i].getComponent(c.default).clear(),p.default.setNodeToPool(d.PoolType.MonsterPreview,e.children[i])}var n=this.devilCtrl.devilConf.boss[1][this.devilCtrl.monsterIndex];n&&(h.default.instance.infoPreview(e,cc.v2(0,0),n.id,n.grade,.75,1),t.getChildByName("bg_mzk").getChildByName("i18n_mz_dystq").getComponent(cc.Sprite).spriteFrame=this.loardCursadeAtlas.getSpriteFrame("i18n_"+n.id),t.getChildByName("label_zhannlidi").getChildByName("Label").getComponent(cc.Label).string=n.characterDec2)},t.prototype.btnInfo=function(e,t,i){this.btnSetLineup.active=e,this.btnNewLineup.active=t,this.GrayNode.active=i},t.prototype.btn_close=function(){r.default.instance.closeAll()},t.prototype.challengeDevil=function(){var e=l.default.instance,t=(w.CommonUtil.getTimes(f.VipPrivilegeType.LoardCrusadNum),this.devilCtrl.devilConf.devilConf[1].challengeTimes,this.devilCtrl.devilConf.devilConf[1].times[this.devilCtrl.times]);1!=e.actstatusArr[3].status?this.devilCtrl.loardCrusadeImage.length?t?D.default.instance.ShowTips(m.default.getStr("\u662f\u5426\u6d88\u8017\u94bb\u77f3\u7ee7\u7eed\u8fdb\u884c\u6311\u6218",t),function(){l.default.instance.isSetSandTab=!1,o.default.instance.sendEnterDevil()},this):(l.default.instance.isSetSandTab=!1,o.default.instance.sendEnterDevil()):y.default.instance.ShowMsg(m.default.getStr("\u8bf7\u5148\u8bbe\u7f6e\u9635\u5bb9")):y.default.instance.ShowMsg(m.default.getStr("\u5f53\u524d\u8fd8\u4e0d\u80fd\u53d1\u52a8\u653b\u51fb"))},t.prototype.setLinup=function(){l.default.instance.isSetSandTab=!0,o.default.instance.sendSetDevilSandTable(),C.default.instance.clearData(),s.GameEventDispatcher.instance.emit(v.EventDefiner.ChangeGameScene,{status:f.GameScene.Fight,guanqiaId:f.GQIdType.LoardCrusad}),_.default.instance.openWindow(d.WindowType.HighLadderFighting),_.default.instance.openWindow(d.WindowType.SandTable)},t.prototype.openReward=function(){_.default.instance.openWindow(d.WindowType.LoardCrusadeReward)},t.prototype.bossInfo=function(){var e=this.devilCtrl.devilConf.boss[1][this.devilCtrl.monsterIndex];this.bossLayout.children[0].getComponentInChildren(cc.RichText).string=e.characterDec,this.bossLayout.children[1].getComponentInChildren(cc.RichText).string=e.bigSkillDec,this.bossLayout.children[2].getComponentInChildren(cc.RichText).string=e.backstory,this.timesLabel.string=this.devilCtrl.devilConf.devilConf[1].challengeTimes-this.devilCtrl.times+" / "+this.devilCtrl.devilConf.devilConf[1].challengeTimes;var t=L.default.instance.getSmallSkillList(e.id,e.grade),i=L.default.instance.getBigSkillList(e.id,e.grade);h.default.instance.setSkillPic(t[0].skillid,this.bossLayout.children[1].getChildByName("skill_btn").getChildByName("sp").getChildByName("pic").getComponent(cc.Sprite)),h.default.instance.setSkillPic(i[0].skillid,this.bossLayout.children[0].getChildByName("skill_btn").getChildByName("sp").getChildByName("pic").getComponent(cc.Sprite))},t.prototype.boss=function(e,t){"1"==t?(this.bossNode.active=!0,this.rankNode.active=!1,this.closeUpdateRank()):(this.bossNode.active=!1,this.rankNode.active=!0,this.devilCtrl.sendDevilRank(g.RankingType.Devil),this.openUpdateRank())},t.prototype.rankInfo=function(){this.listViewCtrl.initialize(this.devilCtrl.loardRank),this.devilCtrl.loardRank.length?this.rankNode.getChildByName("rankLayer").getChildByName("Label").active=!1:this.rankNode.getChildByName("rankLayer").getChildByName("Label").active=!0},t.prototype.myRank=function(){var e=this.rankNode.getChildByName("myRank");e.getChildByName("checkButton").active=!1,e.getChildByName("RoleHead").getComponent(T.default).SetHead(S.MyRoleInfo.icon),e.getChildByName("name").getComponent(cc.Label).string=S.MyRoleInfo.name,e.getChildByName("damage").getComponent(cc.Label).string=this.devilCtrl.myDevilRankData.point?this.devilCtrl.myDevilRankData.point+"":m.default.getStr("\u6682\u65e0"),this.devilCtrl.myDevilRankData.rank&&this.devilCtrl.myDevilRankData.rank<=3?(e.getChildByName("rankNum").active=!1,e.getChildByName("crown").active=!0,e.getChildByName("crown").getComponent(cc.Sprite).spriteFrame=I.default.instance.getSpriteFrameByName("crown"+this.devilCtrl.myDevilRankData.rank)):(e.getChildByName("rankNum").active=!0,e.getChildByName("crown").active=!1,e.getChildByName("rankNum").getComponent(cc.Label).string=this.devilCtrl.myDevilRankData.rank?this.devilCtrl.myDevilRankData.rank+"":m.default.getStr("\u6682\u65e0"))},t.prototype.ScrollInfo=function(e,t){e.getChildByName("checkButton").active=!0,e.getComponent(cc.Sprite).spriteFrame=this.commAtlas.getSpriteFrame("bg_k1hong"),e.x=0;var i=this.devilCtrl.loardRank[t];e.getChildByName("damage").getComponent(cc.Label).string=A.NumberUtil.getNumber(i.point),e.getChildByName("name").getComponent(cc.Label).string=i.info.name,e.getChildByName("RoleHead").getComponent(T.default).SetHead(i.info.icon),e.getComponent(E.default).setInfo(i.info),t<3?(e.getChildByName("crown").getComponent(cc.Sprite).spriteFrame=I.default.instance.getSpriteFrameByName("crown"+(t+1)),e.getChildByName("rankNum").active=!1,e.getChildByName("crown").active=!0):(e.getChildByName("rankNum").getComponent(cc.Label).string=t+1+"",e.getChildByName("rankNum").active=!0,e.getChildByName("crown").active=!1)},t.prototype.lineUpFight=function(){this.devilCtrl.loardCrusadeImage&&this.devilCtrl.loardCrusadeImage.length?this.fightLabe.string=m.default.getStr("\u9635\u5bb9\u6218\u529b",this.devilCtrl.loardFightNum):this.fightLabe.string=m.default.getStr("3626")},t.prototype.countDownInfo=function(e){var t=this,i=u.default.instance.ServerTimeMins,n=cc.find("countDown",this.node).getComponent(cc.Sprite),o=cc.find("countDown/startFight",this.node).getComponent(cc.Sprite);i<e.etime?(this.countDown&&u.default.instance.clearInterval(this.countDown),this.countDown=u.default.instance.setInterval(function(){i+=1e3;var a=e.etime-i;if(i<e.etime){var r=parseInt(""+a/1e3/60/60%24),s=parseInt(""+a/1e3/60%60),l=parseInt(""+a/1e3%60);switch(t.timeLabeShow(r,s,l),e.status){case 1:t.GrayNode.active=!0,t.btnNewLineup.getComponent(cc.Button).interactable=!1,n.node.getChildByName("around").active=!1,n.spriteFrame=t.worldBossAlat.getSpriteFrame("boss_02_1"),o.spriteFrame=t.loardCursadeAtlas.getSpriteFrame("i18n_mwlxz"),n.node.active=!0,o.node.active=!0,0==Number(r)&&0==Number(s)&&1==Number(l)&&(n.node.getChildByName("around").active=!0,o.spriteFrame=t.worldBossAlat.getSpriteFrame("i18n_zhandoukai"),n.getComponent(N.default).resourceUrl="resources/BossComming/bg_changtiao.png",cc.find("countDown",t.node).runAction(cc.fadeTo(1.5,0)));break;case 2:t.devilCtrl.isFrist&&Number(r)>0&&(cc.find("countDown",t.node).runAction(cc.fadeTo(0,255)),o.node.active=!0,n.node.active=!0,n.node.getChildByName("around").active=!0,o.spriteFrame=t.worldBossAlat.getSpriteFrame("i18n_zhandoukai"),n.getComponent(N.default).resourceUrl="resources/BossComming/bg_changtiao.png",cc.find("countDown",t.node).runAction(cc.fadeOut(2))),t.btnNewLineup.getComponent(cc.Button).interactable=!0,t.devilCtrl.devilConf.devilConf[1].challengeTimes-t.devilCtrl.times<=0&&(t.btnNewLineup.getComponent(cc.Button).interactable=!1),Number(r)<=0&&Number(s)&&(o.node.active=!0,n.node.active=!0,n.node.getChildByName("around").active=!1,o.spriteFrame=t.loardCursadeAtlas.getSpriteFrame("i18n_zdjsz"),n.spriteFrame=t.worldBossAlat.getSpriteFrame("boss_03_1"),t.btnNewLineup.getComponent(cc.Button).interactable=!1);break;case 3:t.devilCtrl.myDevilRankData&&t.devilCtrl.myDevilRankData.rank&&_.default.instance.openWindow(d.WindowType.DevilResult,function(){R.default.instance.inIt(!0)},t),t.closeUpdateRank(),t.GrayNode.active=!0,cc.find("BossInfo/BossEtime",t.node).active=!1,n.node.active=!1}}},this,1e3)):cc.find("countDown",this.node).active=!1},t.prototype.timeLabeShow=function(e,t,i){if(Number(t)<10)Number(i)<10?(n=e+":0"+t+":0"+i)&&(this.outTimeLabe.string=""+n):(n=e+":0"+t+":"+i)&&(this.outTimeLabe.string=""+n);else if(Number(i)<10){if(Number(t)<10)(n=e+":0"+t+":0"+i)&&(this.outTimeLabe.string=""+n);else(n=e+":"+t+":0"+i)&&(this.outTimeLabe.string=""+n)}else{var n;(n=e+":"+t+":"+i)&&(this.outTimeLabe.string=""+n)}},t.prototype.teamBtn=function(){_.default.instance.openWindow(d.WindowType.WarTeam)},__decorate([x(cc.Node)],t.prototype,"btnSetLineup",void 0),__decorate([x(cc.Node)],t.prototype,"btnNewLineup",void 0),__decorate([x(cc.Node)],t.prototype,"GrayNode",void 0),__decorate([x(cc.Node)],t.prototype,"bossLayout",void 0),__decorate([x(b.default)],t.prototype,"listViewCtrl",void 0),__decorate([x(cc.Node)],t.prototype,"bossNode",void 0),__decorate([x(cc.Node)],t.prototype,"rankNode",void 0),__decorate([x(cc.SpriteAtlas)],t.prototype,"commAtlas",void 0),__decorate([x(cc.SpriteAtlas)],t.prototype,"loardCursadeAtlas",void 0),__decorate([x(cc.Label)],t.prototype,"fightLabe",void 0),__decorate([x(cc.Label)],t.prototype,"outTimeLabe",void 0),__decorate([x(cc.Node)],t.prototype,"bossStatueAnim",void 0),__decorate([x(cc.SpriteAtlas)],t.prototype,"worldBossAlat",void 0),__decorate([x(cc.Label)],t.prototype,"timesLabel",void 0),t=__decorate([M],t)}(n.default);i.default=k,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/TimeController":"TimeController","../../Core/Window":"Window","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/CommonUtil":"CommonUtil","../../Util/NumberUtil":"NumberUtil","../../Util/Utils":"Utils","../Activity/ActivityController":"ActivityController","../Commons/Image":"Image","../Commons/ListViewCtrl":"ListViewCtrl","../Commons/MonsterPreview":"MonsterPreview","../Gamelayer/RoleHead":"RoleHead","../OpenWin/OpenWinController":"OpenWinController","../RankingList/RankingConst":"RankingConst","../Role/RoleInfo":"RoleInfo","../SandTable/SandTableController":"SandTableController","../Scene/Controller/SkillController":"SkillController","../Tips/OpTipsController":"OpTipsController","../Tips/TipsWinController":"TipsWinController","../WarTeam/MonsterController":"MonsterController","./DevilRankItem":"DevilRankItem","./DevilResult":"DevilResult","./LoardCrusadeCtrl":"LoardCrusadeCtrl"}],LoardRewardWin:[function(e,t,i){"use strict";cc._RF.push(t,"be872h1rY9MjpfzvCismjFe","LoardRewardWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Commons/CommonPageBG"),o=e("../../Core/Language"),a=e("./LoardCrusadeCtrl"),r=e("../../Core/LoadManager"),s=e("../../GlobalContext"),l=e("../../Util/Utils"),c=e("../../Core/CommonsResManager"),d=e("../Commons/RewardUtils"),p=e("../Item/ItemData"),h=e("../Item/ItemIcon"),u=cc._decorator,f=u.ccclass,g=u.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=null,t.toggle=null,t.decLabel=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),this.onInit(756,608,o.default.getStr("\u6218\u6597\u7ed3\u7b97"),!0),this.rewardInit()},t.prototype.rewardInit=function(){var e=this,t=[];t=this.toggle.isChecked?a.default.instance.devilConf.rank[1]:a.default.instance.devilConf.devilConf[1].timesReward,r.default.instance.loadResByType(s.GlobalContext.Root+"prefab/LoardCrusade/rewardItem",cc.Prefab,function(i){l.default.setNodeChildDestoryByUrl(e.content,s.GlobalContext.Root+"prefab/LoardCrusade/rewardItem");for(var n=function(n){var a,u;if(e.toggle.isChecked)e.decLabel.string=o.default.getStr("\u6392\u540d\u5956\u52b1\u662f\u6d3b\u52a8\u7ed3\u7b97\u540e\u4ee5\u90ae\u4ef6\u5f62\u5f0f\u53d1\u653e\u5230\u73a9\u5bb6\u90ae\u7bb1"),a=l.default.getNodeByUrl(i,s.GlobalContext.Root+"prefab/LoardCrusade/rewardItem"),e.content.addChild(a),n<3?(a.getChildByName("rank").getChildByName("rankLabel").active=!1,a.getChildByName("rank").getChildByName("crown1").getComponent(cc.Sprite).spriteFrame=c.default.instance.getSpriteFrameByName("crown"+t[n].min)):(a.getChildByName("rank").getChildByName("crown1").active=!1,a.getChildByName("rank").getChildByName("rankLabel").getComponent(cc.Label).string=t[n].min+"-"+t[n].max),u=t[n].rewardId;else{if(e.decLabel.string=o.default.getStr("\u6b21\u6570\u5956\u52b1\u662f\u73a9\u5bb6\u6311\u6218\u5b8c\u9b54\u738b\u540e\u76f4\u63a5\u53d1\u653e\u5230\u73a9\u5bb6\u80cc\u5305"),n%2!=0)return"continue";a=l.default.getNodeByUrl(i,s.GlobalContext.Root+"prefab/LoardCrusade/rewardItem"),e.content.addChild(a),a.getChildByName("rank").getChildByName("rankLabel").getComponent(cc.Label).string=t[n]+"\u6b21",a.getChildByName("rank").getChildByName("crown1").active=!1,u=t[n+1]}r.default.instance.loadResByType(s.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(e){for(var t=d.default.instance.getItemList(u),i=0;i<t.length;i++){var n=l.default.getNodeByUrl(e,s.GlobalContext.Root+"prefab/Bag/ItemIcon");n.setScale(.7),a.getChildByName("rank").getChildByName("Layout").addChild(n);var o=p.default.creatItem(t[i].id,t[i].count);n.getComponent(h.default).ItemData(o,!0,null,!0)}},e)},a=0;a<t.length;a++)n(a)},this)},__decorate([g(cc.Node)],t.prototype,"content",void 0),__decorate([g(cc.Toggle)],t.prototype,"toggle",void 0),__decorate([g(cc.Label)],t.prototype,"decLabel",void 0),t=__decorate([f],t)}(n.default);i.default=y,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/CommonPageBG":"CommonPageBG","../Commons/RewardUtils":"RewardUtils","../Item/ItemData":"ItemData","../Item/ItemIcon":"ItemIcon","./LoardCrusadeCtrl":"LoardCrusadeCtrl"}],LocalStorageUtils:[function(e,t,i){"use strict";cc._RF.push(t,"1cfb3l4RuBMAbxKFBBskvG3","LocalStorageUtils"),Object.defineProperty(i,"__esModule",{value:!0});var n=cc._decorator,o=n.ccclass,a=(n.property,function(){function e(){}var t;return t=e,Object.defineProperty(e,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),e.prototype.setItem=function(e,t){cc.sys.localStorage.setItem(e,JSON.stringify(t))},e.prototype.getItem=function(e){var t=cc.sys.localStorage.getItem(e);return t&&(t=JSON.parse(t)),t},e.prototype.removeItem=function(e){cc.sys.localStorage.removeItem(e)},e=t=__decorate([o],e)}());i.default=a,cc._RF.pop()},{}],LoginController:[function(e,t,i){"use strict";cc._RF.push(t,"090e5vQaqBIf4nXrMOTQqrI","LoginController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../Core/GameEventDispatcher"),a=e("../../Core/Event"),r=e("../Role/RoleInfo"),s=e("../../NetConnect/NetConnet"),l=e("../../Core/TimeController"),c=e("../../Util/ReportSdkUtils"),d=e("../../Core/LoadManager"),p=e("../../Util/SDKUtils"),h=cc._decorator,u=h.ccclass,f=(h.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gameStart=null,t.loadSceneName=null,t.roleSex=null,t.beginAniCom=!0,t}var i;return __extends(t,e),i=t,Object.defineProperty(t,"instance",{get:function(){return i._instance||(i._instance=new i),i._instance},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){},t.prototype.listNotification=function(){this.addProto("role",this.onrole,this),this.addProto("new",this.onnew,this),this.addProto("reconnkey",this.reconnkey,this),this.addProto("reconnret",this.reconnret,this)},t.prototype.onrole=function(e){this.roleSex=e.gender,e.name&&""!=e.name?(this.loadSceneName="Main",r.MyRoleInfo.firstgame=!1):(this.loadSceneName="CreateRole",r.MyRoleInfo.firstgame=!0),this.checkLoadToScene()},t.prototype.checkLoadToScene=function(){this.loadSceneName&&this.gameStart&&(this.gameStart(this.loadSceneName),this.gameStart=null)},t.prototype.onnew=function(e){r.MyRoleInfo.result=e.errno,0==e.errno?(this.loadSceneName="Main",p.default.instance.platformSdk.isCreateRole=!0,c.default.instance.loginPointOut(c.default.LoginPointKingdom_5),cc.director.loadScene("Enter")):o.GameEventDispatcher.instance.emit(a.EventDefiner.CreateResult)},t.prototype.reconnkey=function(e){console.log("\u534f\u8bae\u83b7\u5f97\u9a8c\u8bc1key, reconnkey: "+e.key),s.default.instance.reconnkey=e.key},t.prototype.reconnret=function(e){console.log("\u534f\u8bae\u83b7\u5f97\u9a8c\u8bc1key\u7ed3\u679c, ret: "+e.ret),0==e.ret&&(s.default.instance.reconnkey=null,o.GameEventDispatcher.instance.emit(a.EventDefiner.SocketConnectFail))},t.prototype.resetGame=function(){n.default.ProtoCallbackDic={},s.default.instance.clear(),i._instance=null,l.default.instance.clear();var e=l.default.instance.setTimeout(function(){l.default.instance.clearTimeout(e),d.default.instance.clear(),p.default.instance.restart()},this,100)},t=i=__decorate([u],t)}(n.default));i.default=f,cc._RF.pop()},{"../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../NetConnect/NetConnet":"NetConnet","../../Util/ReportSdkUtils":"ReportSdkUtils","../../Util/SDKUtils":"SDKUtils","../Role/RoleInfo":"RoleInfo"}],LoginRequest:[function(e,t,i){"use strict";cc._RF.push(t,"4cd21vZidxPgLcqoFkT+Vpo","LoginRequest"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/TimeController"),o=e("../ActivityView/ActivityCtrl"),a=e("../Vip/VipCtrl"),r=e("../Expedition/ExpeditionController"),s=function(){function e(){}return e.longinReq=function(){var e=this;this.intervalTime=n.default.instance.setInterval(function(){e.reqData()},this,100),console.log(" \u767b\u5f55\u540e\u534f\u8bae\u8bf7\u6c42\u5b8c\u6210\uff01 ")},e.reqData=function(){switch(this.index){case 0:o.default.instance.reqYunying(),o.default.instance.reqOpenserverday(),a.default.instance.reqVipInfo();break;case 1:r.default.instance.sendyzInfo()}if(this.comIndex==this.index)return n.default.instance.clearInterval(this.intervalTime),this.index=0,void(this.intervalTime=0);this.index++},e.index=0,e.comIndex=1,e.intervalTime=0,e}();i.default=s,cc._RF.pop()},{"../../Core/TimeController":"TimeController","../ActivityView/ActivityCtrl":"ActivityCtrl","../Expedition/ExpeditionController":"ExpeditionController","../Vip/VipCtrl":"VipCtrl"}],MailCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"32a5dEb71BK/50SxCNSkZMN","MailCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../NetConnect/NetConnet"),a=e("./MailData"),r=e("../../Core/Event"),s=e("../../Core/GameEventDispatcher"),l=e("../OpenWin/OpenWinController"),c=e("../../Core/WindowType"),d=e("../Tips/RewardTips"),p=e("../Commons/RewardUtils"),h=cc._decorator,u=h.ccclass,f=(h.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._data=null,t}var i;return __extends(t,e),i=t,t.prototype.listNotification=function(){i.instance=this,this.addProto(r.EventDefiner.AddMail,this.MailsAdd,this),this.addProto(r.EventDefiner.MailChange,this.MailsChange,this),this.addProto(r.EventDefiner.Mail_ALL,this.MailsAll,this),this.addProto(r.EventDefiner.DellMail,this.MailsDel,this),this.addProto("mailreward",this.reqMailRewardInfo,this)},Object.defineProperty(t.prototype,"data",{get:function(){return this._data||(this._data=new a.default),this._data},enumerable:!0,configurable:!0}),t.prototype.MailsAdd=function(e){this.data.MailsAdd(e.mail),s.GameEventDispatcher.instance.emit(r.EventDefiner.Mail_UP_DATA)},t.prototype.MailsChange=function(e){this.data.MailsChange(e.mail),s.GameEventDispatcher.instance.emit(r.EventDefiner.Mail_UP_DATA)},t.prototype.MailsDel=function(e){this.data.delData(e.guid),s.GameEventDispatcher.instance.emit(r.EventDefiner.Mail_UP_DATA)},t.prototype.MailsAll=function(e){this.data.setData(e.mail),s.GameEventDispatcher.instance.emit(r.EventDefiner.Mail_UP_DATA)},t.prototype.reqDeleteMail=function(e){var t={cmd:"maildel",guid:e};o.default.instance.sendProto(t)},t.prototype.reqReadMial=function(e){var t={cmd:"mailread",guid:e};o.default.instance.sendProto(t)},t.prototype.reqOnekeyDeleteMail=function(){o.default.instance.sendProto({cmd:"maildel"})},t.prototype.reqMailReward=function(e){var t={cmd:"mailreward",guid:e};o.default.instance.sendProto(t)},t.prototype.reqOnekeyMailReWard=function(){o.default.instance.sendProto({cmd:"mailreward"})},t.prototype.reqMailRewardInfo=function(e){var t=p.default.instance.getItemListByServerData(e.reward);l.default.instance.openWindow(c.WindowType.RewardTips,function(){d.default.instance.setData(t)})},t.instance=null,t=i=__decorate([u],t)}(n.default));i.default=f,cc._RF.pop()},{"../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/WindowType":"WindowType","../../NetConnect/NetConnet":"NetConnet","../Commons/RewardUtils":"RewardUtils","../OpenWin/OpenWinController":"OpenWinController","../Tips/RewardTips":"RewardTips","./MailData":"MailData"}],MailData:[function(e,t,i){"use strict";cc._RF.push(t,"b2a43AmmLlE6rQtEEo6Iafn","MailData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Functionicon/FunctionIconController"),o=e("../../Core/WindowType"),a=function(){function e(){this._mailData=[],this._flag=null}return e.prototype.setData=function(e){this._mailData=this.MailSort(e)},e.prototype.delData=function(e){for(var t=0;t<e.length;t++)for(var i=0;i<this._mailData.length;i++)this._mailData[i].guid==e[t]&&(this._mailData.splice(i,1),i--);this._mailData=this.MailSort(this._mailData)},e.prototype.MailsChange=function(e){for(var t in this._mailData)for(var i=0;i<e.length;i++)this._mailData[t].guid==e[i].guid&&(this._mailData[t]=e[i]);this._mailData=this.MailSort(this._mailData)},e.prototype.MailsAdd=function(e){this._mailData.push(e),this._mailData=this.MailSort(this._mailData)},e.prototype.getDataLength=function(){this._mailData.length},e.prototype.getMailData=function(){return this._mailData},e.prototype.getMailDataByGuid=function(e){for(var t in this._mailData)if(this._mailData[t].guid==e)return this._mailData[t];return null},e.prototype.MailSort=function(e){this._flag=!1;for(var t,i=[],a=[],r=[],s=0;s<e.length;s++){var l=e[s];0==l.status?(i.push(e[s]),this._flag=!0):1==l.status?a.push(e[s]):r.push(e[s])}return i.sort(this.sortList),a.sort(this.sortList),e.sort(function(e,t){return e.sendTime-t.sendTime}),a.sort(function(e,t){return e.sendTime-t.sendTime}),t=i.concat(a,r),n.default.instance.FuncIconRedDeal(o.WindowType.Mail,this._flag),t},e.prototype.sortList=function(e,t){return!e.reward&&t.reward?-1:e.reward&&!t.reward?1:e.reward||t.reward?e.reward.length-t.reward.length:0},e}();i.default=a,cc._RF.pop()},{"../../Core/WindowType":"WindowType","../Functionicon/FunctionIconController":"FunctionIconController"}],MailItem:[function(e,t,i){"use strict";cc._RF.push(t,"3a848gHJo1F67PQfkqcU57Y","MailItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Util/DateUtil"),a=e("../../Core/GameEventDispatcher"),r=e("../../Core/CommonsResManager"),s=e("../../Core/Event"),l=e("./MailCtrl"),c=e("./MailView"),d=cc._decorator,p=d.ccclass,h=d.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.headIcon=null,t.title=null,t.time=null,t.mailShade=null,t.mail_spritAtlas=null,t._mailData=null,t._index=null,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.setData=function(e,t){this._index=t,this._mailData=e,this.setHeadIocn(e),this.title.getComponent(cc.Label).string=e.title.length>5?e.title.slice(0,5)+"...":e.title,this.time.getComponent(cc.Label).string=o.DateUtil.secondsToMonthDay(e.sendTime)},t.prototype.setHeadIocn=function(e){var t="";t=2==e.status?"ReadMail":null!=e.reward?"AwardMail":"UnReadMial",this.headIcon.getComponent(cc.Sprite).spriteFrame=this.mail_spritAtlas.getSpriteFrame(t),this.setBG()},t.prototype.onClickMail=function(e){a.GameEventDispatcher.instance.emit(s.EventDefiner.OpenMaill,{guid:this._mailData.guid,index:this._index})},t.prototype.setBG=function(){var e="base01";(c.default.instance.onClickIndex?c.default.instance.onClickIndex:0)==this._index&&(l.default.instance.reqReadMial(this._mailData.guid),e="base02"),this.mailShade.getComponent(cc.Sprite).spriteFrame=r.default.instance.getSpriteFrameByName(e)},__decorate([h(cc.Node)],t.prototype,"headIcon",void 0),__decorate([h(cc.Node)],t.prototype,"title",void 0),__decorate([h(cc.Node)],t.prototype,"time",void 0),__decorate([h(cc.Node)],t.prototype,"mailShade",void 0),__decorate([h(cc.SpriteAtlas)],t.prototype,"mail_spritAtlas",void 0),t=__decorate([p],t)}(n.default);i.default=u,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Widget":"Widget","../../Util/DateUtil":"DateUtil","./MailCtrl":"MailCtrl","./MailView":"MailView"}],MailView:[function(e,t,i){"use strict";cc._RF.push(t,"36e1e/2eFpJMo65SqyYmAzl","MailView"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../../Core/Language"),a=e("../../Global/GlobalValue"),r=e("../Commons/ListViewCtrl"),s=e("./MailItem"),l=e("./MailCtrl"),c=e("../../Core/TimeController"),d=e("../Item/ItemIcon"),p=e("../Item/ItemData"),h=e("../Commons/RewardUtils"),u=e("../Tips/OpTipsController"),f=e("../../Core/Event"),g=e("../../Core/GameEventDispatcher"),y=e("../../Util/GrayEffect"),m=e("../../Core/LoadManager"),C=e("../../Util/Utils"),v=e("../../GlobalContext"),_=e("../../Core/ConfigsManager"),b=cc._decorator,T=b.ccclass,S=(b.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onClickGuid=null,t.onClickIndex=null,t._isOpenMail=!1,t.config=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.start=function(){e.prototype.start.call(this),this.upShow(500)},t.prototype.show=function(){e.prototype.show.call(this),this.upShow(),g.GameEventDispatcher.instance.on(f.EventDefiner.Mail_UP_DATA,this.upShow,this),g.GameEventDispatcher.instance.on(f.EventDefiner.OpenMaill,this.openmail,this),this.config=_.ConfigsManager.instance.getConfigs("rechargeconf")},t.prototype.hide=function(){e.prototype.hide.call(this),this._onClickGuid=null,this.onClickIndex=null,this._isOpenMail=!1,g.GameEventDispatcher.instance.off(f.EventDefiner.Mail_UP_DATA,this.upShow,this),g.GameEventDispatcher.instance.on(f.EventDefiner.OpenMaill,this.upShow,this)},t.prototype.upShow=function(e){void 0===e&&(e=0),this.leftShow(),this.rigthShow(e)},t.prototype.openmail=function(e){var t=e.getUserData();this._onClickGuid=t.guid,this.onClickIndex=t.index,this._isOpenMail=!0,this.setOnclickBg(),this.rigthShow()},t.prototype.leftShow=function(){var e=l.default.instance.data.getMailData();this.setMailNumStr(e.length),this.setList(e),this.setBtnShow(e.length>0),!this._onClickGuid&&e.length>0&&(this._onClickGuid=e[0].guid,this.onClickIndex=0)},t.prototype.setMailNumStr=function(e){var t=this.node.getChildByName("left").getChildByName("mailNum").getChildByName("node").getChildByName("label");t.getComponent(cc.Label).string=o.default.getStr("{0}/{1}",e,a.MaxMailNum),t.color=e>=a.MaxMailNum?new cc.Color(255,0,0):new cc.Color(90,60,52)},t.prototype.setList=function(e){var t=this.node.getChildByName("left").getChildByName("ListViewCtrl");t.getComponent(r.default).refreshItem=this.updateitem,t.getComponent(r.default).refreshItemThis=this,t.getComponent(r.default).initialize(e),t.getComponent(r.default).scrollToTop()},t.prototype.updateitem=function(e,t){var i=this.node.getChildByName("left").getChildByName("ListViewCtrl").getComponent(r.default).dataLsit[t];e.getComponent(s.default).setData(i,t)},t.prototype.setOnclickBg=function(){var e=this.node.getChildByName("left").getChildByName("ListViewCtrl").getComponent(r.default).items;for(var t in e)e[t].getComponent(s.default).setBG()},t.prototype.setBtnShow=function(e){this.node.getChildByName("left").getChildByName("DeleteBtn").active=e,this.node.getChildByName("left").getChildByName("KeyToGetBtn").active=e},t.prototype.rigthShow=function(e){var t=this;void 0===e&&(e=0);var i=this.node.getChildByName("rigth"),n=i.getChildByName("contentSBG");if(n.getChildByName("IsNull").active=!this._onClickGuid,this._onClickGuid){var a=l.default.instance.data.getMailDataByGuid(this._onClickGuid);if(n.getChildByName("time").active=!!a,a){this.setRigthActive(!0),n.getChildByName("TitleLable").getComponent(cc.Label).string=a.title.length>5?a.title.slice(0,5)+"...":a.title,this.setTime(n.getChildByName("time").getChildByName("timeStr"),a.sendTime),n.getChildByName("ContentLable").getComponent(cc.Label).string=a.context;var r=n.getChildByName("compensation").getChildByName("Rewards");m.default.instance.loadResByType(v.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(s){if(a.reward||a.rechargeId){C.default.setNodeChildDestoryByUrl(r.getComponent(cc.ScrollView).content,v.GlobalContext.Root+"prefab/Bag/ItemIcon");var l=[];if(a.reward&&(l=a.reward.slice(0)),a.rechargeId){var u={count:t.config.RechargeConf[a.rechargeId].diamondVal,id:0,type:9};l.push(u)}var f=function(i){var n=C.default.getNodeByUrl(s,v.GlobalContext.Root+"prefab/Bag/ItemIcon");n.active=!0;var o=h.default.instance.getItemId(l[i].type,l[i].id,l[i].count),u=p.default.creatItem(o[0],o[1]);n.getComponent(d.default).ItemData(u,!0,u.count+"",!0);var f=function(){2==a.status&&n.addComponent(y.default).setGray(!0)};if(e)var g=c.default.instance.setTimeout(function(){f(),c.default.instance.clearTimeout(g)},t,e);else f();r.getComponent(cc.ScrollView).content.addChild(n),r.getComponent(cc.ScrollView).scrollToLeft()};for(var g in l)f(g)}var m=i.getChildByName("GetBtn");n.getChildByName("compensation").active=!(!a.reward&&!a.rechargeId),m.active=!0,!a.reward&&!a.rechargeId&&1==a.status||(a.reward||a.rechargeId)&&2==a.status?m.getChildByName("Label").getComponent(cc.Label).string=o.default.getStr("Delete"):m.getChildByName("Label").getComponent(cc.Label).string=o.default.getStr("Get")},this)}}else this.setRigthActive(!1)},t.prototype.setRigthActive=function(e){var t=this.node.getChildByName("rigth"),i=t.getChildByName("contentSBG");t.getChildByName("GetBtn").active=e,i.getChildByName("TitleLable").active=e,i.getChildByName("ContentLable").active=e,i.getChildByName("time").active=e,i.getChildByName("compensation").active=e},t.prototype.setTime=function(e,t){var i=a.validTime+t-c.default.instance.ServerTimeMins;e.getComponent(cc.Label).string=o.default.getStr("\u6709\u6548\u65f6\u95f4\uff1a")+this.formatDate(i)},t.prototype.formatDate=function(e){var t=Math.floor(e/864e5),i=Math.floor(e/36e5%24);return o.default.getStr("{0}\u5929{1}\u5c0f\u65f6",t,i)},t.prototype.oncliCKDeleteBtn=function(){l.default.instance.data.getMailData().length<=0?u.default.instance.ShowMsg(o.default.getStr("MailTip_6")):(l.default.instance.reqOnekeyDeleteMail(),this._onClickGuid=null,this.onClickIndex=0)},t.prototype.oncliCKKeyToGetBtn=function(){l.default.instance.data.getMailData().length<=0&&u.default.instance.ShowMsg(o.default.getStr("MailTip_7")),l.default.instance.reqOnekeyMailReWard(),this._onClickGuid=null,this.onClickIndex=0},t.prototype.onClickBtn=function(){var e=l.default.instance.data.getMailDataByGuid(this._onClickGuid);e&&((e.reward||e.rechargeId)&&2!=e.status?l.default.instance.reqMailReward(this._onClickGuid):l.default.instance.reqDeleteMail(this._onClickGuid),this._onClickGuid=null,this.onClickIndex=0)},t.instance=null,t=i=__decorate([T],t)}(n.default));i.default=S,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/Window":"Window","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/GrayEffect":"GrayEffect","../../Util/Utils":"Utils","../Commons/ListViewCtrl":"ListViewCtrl","../Commons/RewardUtils":"RewardUtils","../Item/ItemData":"ItemData","../Item/ItemIcon":"ItemIcon","../Tips/OpTipsController":"OpTipsController","./MailCtrl":"MailCtrl","./MailItem":"MailItem"}],Main:[function(e,t,i){"use strict";cc._RF.push(t,"71573MSa6VMzIcvr4JYM7RQ","Main"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./Core/LoadManager"),o=e("./Core/GameEventDispatcher"),a=e("./Core/WindowManager"),r=e("./Core/WindowType"),s=e("./GlobalContext"),l=e("./Core/Window"),c=e("./Core/Event"),d=e("./Util/SDKUtils"),p=e("./Module/Scene/UIAnim/VariousAnim"),h=e("./Module/OpenWin/OpenWinController"),u=e("./Module/Shop/DiamondInfo"),f=e("./Module/Chat/ChatController"),g=e("./Core/TimeController"),y=e("./Util/Utils"),m=e("./Module/RankingList/RankListCtrl"),C=e("./Global/GlobalValue"),v=e("./Module/Tips/TipsWinController"),_=e("./Module/Login/LoginController"),b=cc._decorator,T=b.ccclass,S=b.property,I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.WindowLayer=null,t.SceneLayer=null,t.TopLayer=null,t.TipsLayer=null,t.GameLayer=null,t.TopPanel=null,t.Game=null,t.MaskBgPrefab=null,t.chat=null,t.ItemLoading=null,t._isDestroy=!1,t}return __extends(t,e),t.prototype.onLoad=function(){cc.game.setFrameRate(30),l.default.MaskBgPrefab=this.MaskBgPrefab,s.GlobalContext.ItemLoading=this.ItemLoading,s.PlayerData.WindowLayer=this.WindowLayer,s.PlayerData.SceneLayer=this.SceneLayer,s.PlayerData.TopLayer=this.TopLayer,s.PlayerData.TipsLayer=this.TipsLayer,s.PlayerData.GameLayer=this.GameLayer,s.PlayerData.TopPanel=this.TopPanel,s.GlobalContext.StageWidth=this.node.width,s.GlobalContext.StageHeight=this.node.height,s.GlobalContext.UIWidth=Math.min(s.GlobalContext.StageWidth,1624),s.GlobalContext.UIHeight=Math.min(s.GlobalContext.StageHeight,750),this.Game.width=s.GlobalContext.UIWidth,this.Game.height=s.GlobalContext.UIHeight,console.log("\u821e\u53f0\u5927\u5c0f:"+s.GlobalContext.StageWidth+", "+s.GlobalContext.StageHeight),console.log("\u821e\u53f0UI\u5927\u5c0f:"+s.GlobalContext.UIWidth+", "+s.GlobalContext.UIHeight),p.default.instance.initInfo()},t.prototype.onDestroy=function(){this._isDestroy=!0},t.prototype.onEnable=function(){1==d.default.instance.isInitWX&&(o.GameEventDispatcher.instance.on(c.EventDefiner.ShareTicket,this.groupRankEnter,this),o.GameEventDispatcher.instance.on(c.EventDefiner.DiamondShop,this.topUp,this)),o.GameEventDispatcher.instance.on(c.EventDefiner.SocketConnectFail,this.SocketConnectFail,this)},t.prototype.onDisable=function(){1==d.default.instance.isInitWX&&(o.GameEventDispatcher.instance.off(c.EventDefiner.ShareTicket,this.groupRankEnter,this),o.GameEventDispatcher.instance.off(c.EventDefiner.DiamondShop,this.topUp,this)),o.GameEventDispatcher.instance.off(c.EventDefiner.SocketConnectFail,this.SocketConnectFail,this)},t.prototype.SocketConnectFail=function(e){v.default.instance.ShowTips("\u5df2\u65ad\u5f00\u94fe\u63a5",function(){_.default.instance.resetGame()},this,null,2,null,null,null,this,null,!0)},t.prototype.start=function(){var e=this;if(""!=d.default.instance.help&&""!=d.default.instance.topupinfo){var t=d.default.instance.help,i=JSON.parse(d.default.instance.topupinfo),o=d.default.instance.helpname;"ios"==qq.getSystemInfoSync().platform?a.default.instance.open(r.WindowType.DiamondInfo,function(){u.default.instance.initDiamondInfo(i,"4",t,null,o)},this):a.default.instance.open(r.WindowType.DiamondInfo,function(){u.default.instance.initDiamondInfo(i,"3",t,qq.getLaunchOptionsSync().query.userId,o)},this),d.default.instance.help="",d.default.instance.topupinfo=""}if(window.gm=f.default.instance.gmCall,!this.chat.childrenCount)var l=g.default.instance.setTimeout(function(){n.default.instance.loadResByType(s.GlobalContext.Root+"prefab/Chat/chatBox",cc.Prefab,function(t){var i=y.default.getNodeByUrl(t,s.GlobalContext.Root+"prefab/Chat/chatBox");e.chat.addChild(i)},e),g.default.instance.clearTimeout(l)},this,5e3);this.node.addComponent("SevenDayTargetCtrl"),this.node.addComponent("DailyCopyCtrl"),this.node.addComponent("SyntheticCtrl"),this.node.addComponent("MineCtrl")},t.prototype.topUp=function(e){var t=e.getUserData();console.log("textting",t),t.help&&t.topupinfo&&("ios"==qq.getSystemInfoSync().platform?a.default.instance.open(r.WindowType.DiamondInfo,function(){u.default.instance.initDiamondInfo(JSON.parse(t.topupinfo),"4",t.help,null,t.name)},this):a.default.instance.open(r.WindowType.DiamondInfo,function(){u.default.instance.initDiamondInfo(JSON.parse(t.topupinfo),"3",t.help,t.userId,t.name)},this))},t.prototype.groupRankEnter=function(e){var t=e.getUserData(),i=d.default.instance.gameID+"subdomai";console.log("ticket"+t.ticket+"send"+t.query.send),null!=t.ticket&&1==t.query.send&&(m.default.instance.openRankList(C.RankType.ARENA),d.default.instance.postMessageToSubDomain({cmd:"shareTicket",value:t.ticket}),d.default.instance.postMessageToSubDomain({cmd:"preload",key:i,type:1}))},t.prototype.BtnClickToOpenWin=function(e,t){var i=Number(t);this.onOpenWindow(i)},t.prototype.onOpenWindow=function(e){h.default.instance.openWindow(e)},__decorate([S(cc.Node)],t.prototype,"WindowLayer",void 0),__decorate([S(cc.Node)],t.prototype,"SceneLayer",void 0),__decorate([S(cc.Node)],t.prototype,"TopLayer",void 0),__decorate([S(cc.Node)],t.prototype,"TipsLayer",void 0),__decorate([S(cc.Node)],t.prototype,"GameLayer",void 0),__decorate([S(cc.Node)],t.prototype,"TopPanel",void 0),__decorate([S(cc.Node)],t.prototype,"Game",void 0),__decorate([S(cc.Prefab)],t.prototype,"MaskBgPrefab",void 0),__decorate([S(cc.Node)],t.prototype,"chat",void 0),__decorate([S(cc.Node)],t.prototype,"ItemLoading",void 0),t=__decorate([T],t)}(cc.Component);i.default=I,cc._RF.pop()},{"./Core/Event":"Event","./Core/GameEventDispatcher":"GameEventDispatcher","./Core/LoadManager":"LoadManager","./Core/TimeController":"TimeController","./Core/Window":"Window","./Core/WindowManager":"WindowManager","./Core/WindowType":"WindowType","./Global/GlobalValue":"GlobalValue","./GlobalContext":"GlobalContext","./Module/Chat/ChatController":"ChatController","./Module/Login/LoginController":"LoginController","./Module/OpenWin/OpenWinController":"OpenWinController","./Module/RankingList/RankListCtrl":"RankListCtrl","./Module/Scene/UIAnim/VariousAnim":"VariousAnim","./Module/Shop/DiamondInfo":"DiamondInfo","./Module/Tips/TipsWinController":"TipsWinController","./Util/SDKUtils":"SDKUtils","./Util/Utils":"Utils"}],Managet:[function(e,t,i){"use strict";cc._RF.push(t,"417a4K2SyVDFop8X0U6tB3N","Managet"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./Widget"),o=cc._decorator,a=o.ccclass,r=(o.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){this.listNotification()},t.prototype.listNotification=function(){},t.ProtoCallbackDic={},t=__decorate([a],t)}(n.default));i.default=r,cc._RF.pop()},{"./Widget":"Widget"}],MapEdit:[function(e,t,i){"use strict";cc._RF.push(t,"866acYhRYJLj7Z7jEMKbEMd","MapEdit"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/GameEventDispatcher"),o=cc._decorator,a=o.ccclass,r=o.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.map=null,t.TouchNode=null,t.mapNode=null,t.bg=null,t.heightL=null,t.widthL=null,t.infoL=null,t.Spoint=cc.v2(0,0),t.symbolArr=[],t._delete=!1,t._nowSymbol=null,t._arrWidth=0,t._height=0,t._width=0,t.infoText="",t}return __extends(t,e),t.prototype.start=function(){n.GameEventDispatcher.instance.on("CESHIKAISHI",this._starMore,this)},t.prototype.generate=function(){var e=this.infoL.string;e||(this.infoL.string="");var t=[];if(e){var i=(t=e.split(";")).splice(0,1)[0].split(",");this._height=parseInt(i[0]),this._width=parseInt(i[1]),t.splice(t.length-1,1),this.heightL.string=this._height+"",this.widthL.string=this._width+"",this.infoL.string=""}else this._height=parseInt(this.heightL.string),this._width=parseInt(this.widthL.string);var n=735/this._height,o=735/this._width;this._arrWidth=this._width,n<o?o=n:n=o;for(var a=0;a<this._height;a++){this.symbolArr[a]=[];for(var r=0;r<this._width;r++){var s=(this._height-1)/2,l=(this._width-1)/2,c=this.Spoint.y+(a-s)*n,d=this.Spoint.x+(r-l)*o,p=cc.instantiate(this.map);if(this.TouchNode.addChild(p,1),p.setPosition(d,c),p.getComponent("map").setSymbolSize(n,o),p.getComponent("map").setSymbolPo(a*this._arrWidth+r),e){var h=t[a*this._arrWidth+r].split(",")[1];1==h.length?parseInt(h)?1!=parseInt(h)&&p.getComponent("map").setString(h):p.getComponent("map").setVisible(!1):p.getComponent("map").setString(h)}this.symbolArr[a][r]=p}}},t.prototype.setInfo=function(){this.infoText="",this.infoText+=this._height+","+this._width+";";for(var e=0;e<this._height;e++)for(var t=0;t<this._width;t++){var i=this.symbolArr[e][t].getComponent("map").getSpoint();if(this.symbolArr[e][t].getComponent("map").getType()){var n=this.symbolArr[e][t].getComponent("map").getString();this.infoText+=n?i+","+n:i+",1"}else this.infoText+=i+",0";this.infoText+=";"}this.infoL.string=this.infoText},t.prototype._starMore=function(e){var t=e.getUserData().spoint;this._nowSymbol=this.symbolArr[Math.floor(t/this._arrWidth)][t%this._arrWidth],this._nowSymbol.getComponent("map").setVisible(!this._delete)},t.prototype.deleteSymbol=function(){this._delete=!this._delete},t.prototype.eliminate=function(){for(var e in this.symbolArr)for(var t in this.symbolArr[e])this.symbolArr[e][t].destroy(),this.symbolArr[e][t]=null;this.symbolArr=[],this._delete=!1,this._arrWidth=0,this._height=0,this._width=0,this.infoText="",this.infoL.string="",this.heightL.string="",this.widthL.string=""},__decorate([r(cc.Prefab)],t.prototype,"map",void 0),__decorate([r(cc.Node)],t.prototype,"TouchNode",void 0),__decorate([r(cc.Node)],t.prototype,"mapNode",void 0),__decorate([r(cc.Sprite)],t.prototype,"bg",void 0),__decorate([r(cc.EditBox)],t.prototype,"heightL",void 0),__decorate([r(cc.EditBox)],t.prototype,"widthL",void 0),__decorate([r(cc.EditBox)],t.prototype,"infoL",void 0),t=__decorate([a],t)}(cc.Component);i.default=s,cc._RF.pop()},{"../../Core/GameEventDispatcher":"GameEventDispatcher"}],MapUnitMoveCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"7e119BqZGtDe564W2b1KVZj","MapUnitMoveCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../../Core/Widget"),o=e("../../../../Util/AStar/AStarUtil"),a=e("../../../../Util/Utils"),r=e("../../../Commons/MonsterPreview"),s=e("../../../Role/RoleInfo"),l=e("../../../../Global/GlobalValue"),c=cc._decorator,d=c.ccclass,p=(c.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.MovePath=[],t.Moving=!1,t.MovingSpeed=0,t.UpdateCount=0,t.MoveCompleteCallback=null,t.MoveCompleteCallbackThisObj=null,t.MoveCompleteCallbackParam=null,t.rolearrow=l.DIR.RIGHT,t}return __extends(t,e),t.prototype.update=function(e){var t=this;if(this.UpdateCount++,this.UpdateCount>1e3&&(this.UpdateCount=0),this.MovePath&&this.MovePath.length>0&&!this.Moving){var i=this.MovePath.shift(),n=o.AStarUtil.getFlatByIndexX(i.x),c=o.AStarUtil.getFlatByIndexY(i.y);this.Moving=!0;var d=a.default.distance(this.node.position.x,this.node.position.y,n,c)/this.MovingSpeed;this.node.x>n?this.rolearrow=l.DIR.LEFT:this.node.x<n&&(this.rolearrow=l.DIR.RIGHT),this.node.runAction(cc.sequence(cc.callFunc(function(){t.node.getComponent(r.default)&&t.node.getComponent(r.default).init("role",s.MyRoleInfo.currentsurface,1,null,l.PRIORITY.MONSTER,!1,l.ACTION.WALK,t.rolearrow)},this),cc.moveTo(d,n,c),cc.callFunc(function(){t.Moving=!1,(!t.MovePath||t.MovePath.length<=0)&&(console.log("MapUnitMoveCtrl  \u79fb\u52a8\u5b8c\u6210"),t.node.getComponent(r.default)&&t.node.getComponent(r.default).init("role",s.MyRoleInfo.currentsurface,1,null,l.PRIORITY.MONSTER,!1,l.ACTION.STAND,t.rolearrow),t.MoveCompleteCallback&&(t.MoveCompleteCallback.apply(t.MoveCompleteCallbackThisObj,t.MoveCompleteCallbackParam),t.MoveCompleteCallback=null,t.MoveCompleteCallbackThisObj=null,t.MoveCompleteCallbackParam=null))})))}},t.prototype.clearMovePath=function(){this.MovePath.length=0,this.Moving=!1,this.node.stopAllActions(),this.MoveCompleteCallback=null,this.MoveCompleteCallbackThisObj=null,this.MoveCompleteCallbackParam=null},t=__decorate([d],t)}(n.default));i.default=p,cc._RF.pop()},{"../../../../Core/Widget":"Widget","../../../../Global/GlobalValue":"GlobalValue","../../../../Util/AStar/AStarUtil":"AStarUtil","../../../../Util/Utils":"Utils","../../../Commons/MonsterPreview":"MonsterPreview","../../../Role/RoleInfo":"RoleInfo"}],MapViewOne:[function(e,t,i){"use strict";cc._RF.push(t,"efe3aFIsLdEgr1/dmlMll1h","MapViewOne"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Core/TimeController"),a=e("../../Commons/Image"),r=cc._decorator,s=r.ccclass,l=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._url=null,t._intervalTime=0,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),this.clearInterval(),this._intervalTime=o.default.instance.setInterval(this.checkShow,this,1e3)},t.prototype.hide=function(){e.prototype.hide.call(this),this.clearInterval()},t.prototype.setUrl=function(e){this._url=e},t.prototype.clearInterval=function(){o.default.instance.clearInterval(this._intervalTime),this._intervalTime=0},t.prototype.checkShow=function(){if(this._url){var e=this.node.parent.parent.parent,t=e.width,i=e.height,n=this.node.convertToWorldSpaceAR(cc.v2(0,0));n=e.convertToNodeSpaceAR(n);var o=t/2+this.node.width/2,r=-this.node.height/2,s=i+this.node.height/2;-o<=n.x&&n.x<=o&&r<=n.y&&n.y<=s&&(this.clearInterval(),this.node.getComponent(a.default).loadSpriteFrame(this._url))}},t=__decorate([s],t)}(n.default));i.default=l,cc._RF.pop()},{"../../../Core/TimeController":"TimeController","../../../Core/Widget":"Widget","../../Commons/Image":"Image"}],MapView:[function(e,t,i){"use strict";cc._RF.push(t,"4fa7ce91RlPJIh9jd4grlk3","MapView"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Core/LoadManager"),a=e("../../../GlobalContext"),r=e("../../LoadingPanel/LoadingPanel"),s=e("../../../Util/AStar/AStarUtil"),l=e("../../../Util/AStar/AStar"),c=e("../../../Util/Utils"),d=e("../../../Core/WindowType"),p=e("../../../Core/CacheManager"),h=e("../../../Core/TimeController"),u=e("./MapViewOne"),f=e("../../Status/StatusType"),g=e("../../Guide/GuideNewController"),y=cc._decorator,m=y.ccclass,C=y.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.DragNode=null,t.BgContainer=null,t.Container=null,t.maxX=0,t.maxY=0,t._moveToX=0,t._moveToY=0,t._moveAddCount=0,t.minScale=.6,t.mapConfigData=null,t.aStarUtil=null,t.sceneId=0,t.bgUrl=null,t.delayClearTime=0,t.mapCellSize=1024,t.loadedMapUrls=[],t.waitLoadMapUrls=[],t.startPosX=-1,t.startPosY=0,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this),this.node.width=a.GlobalContext.UIWidth,this.node.height=a.GlobalContext.UIHeight},t.prototype.loadConfig=function(e){this.sceneId!=e?(this.clear(),this.sceneId=e,o.default.instance.loadResByType(a.GlobalContext.Root+"ui/scene/map/"+e,cc.JsonAsset,this.loadMapJsonComplete,this)):this.checkIsReady()},t.prototype.show=function(){e.prototype.show.call(this),h.default.instance.clearTimeout(this.delayClearTime),this.checkIsReady()},t.prototype.hide=function(){e.prototype.hide.call(this),this.DragNode.off(cc.Node.EventType.TOUCH_MOVE,this.DragNodeTouchMove,this),h.default.instance.clearTimeout(this.delayClearTime),this.delayClearTime=h.default.instance.setTimeout(this.clear,this,6e4)},t.prototype.onDestroy=function(){h.default.instance.clearTimeout(this.delayClearTime),this.clear(),e.prototype.onDestroy.call(this)},t.prototype.realyShow=function(){},t.prototype.clear=function(){for(this.clearUseRecord(this.bgUrl),this.bgUrl=null,this.waitLoadMapUrls.length=0;this.loadedMapUrls.length>0;)this.clearUseRecord(this.loadedMapUrls.shift());this.sceneId=0,this.mapConfigData=null,this.BgContainer&&this.BgContainer.isValid&&c.default.setNodeChildDestoryByUrl(this.BgContainer,a.GlobalContext.Root+"prefab/Map/MapSpriteItem")},t.prototype.moveDragNodeByLocalPosition=function(e,t,i){void 0===i&&(i=10),this._moveToX=e,this._moveToY=t;var n=this.node.convertToNodeSpaceAR(this.Container.convertToWorldSpaceAR(cc.v2(e,t))),o=-n.x,a=this.node.height/2-n.y;i<=0&&(i=this._moveAddCount);var r=o/i,s=a/i;this.checkDragNodePosition(this.DragNode.position.x+r,this.DragNode.position.y+s),this._moveAddCount=i-1},t.prototype.loadMapJsonComplete=function(e){var t;if(t=e.json,1!=this.isDestroyed){this.mapConfigData=t,this.aStarUtil=new s.AStarUtil,this.aStarUtil.Grid=new l.Grid(t.column,t.row);for(var i=String(t.cellData),n=i.length,r=0;r<n;r++)if(Number(i.charAt(r))>0){var c=Math.floor(r/t.column),d=Math.floor(r%t.column);this.aStarUtil.Grid.setWalkable(d,c,!0)}var p=this.mapConfigData.mapwidth,h=this.mapConfigData.mapheight;this.BgContainer.width=p,this.BgContainer.height=h,this.DragNode.width=p,this.DragNode.height=h,this.BgContainer.setPosition(0,this.BgContainer.height/2),this.Container.setPosition(-this.BgContainer.width/2,this.BgContainer.height),this.initDragNode();var u=a.GlobalContext.Root+"ui/scene/map/smallmap"+this.sceneId;this.bgUrl=u,o.default.instance.loadResByType(u,cc.SpriteFrame,this.loadSmallMapBgComplete,this,[u]),this.setUseRecord(this.bgUrl)}},t.prototype.loadSmallMapBgComplete=function(e,t){var i=this;1!=this.isDestroyed&&this.bgUrl==t&&(e.getTexture().setFilters(cc.Texture2D.Filter.NEAREST,cc.Texture2D.Filter.NEAREST),p.default.instance.setUseRecord(a.GlobalContext.Root+"prefab/Map/MapSpriteItem"),o.default.instance.loadResByType(a.GlobalContext.Root+"prefab/Map/MapSpriteItem",cc.Prefab,function(t){p.default.instance.clearUseRecord(a.GlobalContext.Root+"prefab/Map/MapSpriteItem");var n=c.default.getNodeByPool(d.PoolType.SpriteItem,t);n.getComponent(cc.Sprite).sizeMode=cc.Sprite.SizeMode.CUSTOM,n.width=i.BgContainer.width,n.height=i.BgContainer.height,n.getComponent(cc.Sprite).spriteFrame=e,i.BgContainer.addChild(n),i.checkIsReady(),i.addMapOnes()},this))},t.prototype.addMapOnes=function(){for(var e=this,t=a.GlobalContext.Root+"ui/scene/map/"+this.sceneId,i=Math.ceil(this.BgContainer.width/this.mapCellSize),n=Math.ceil(this.BgContainer.height/this.mapCellSize),r=1;r<=n;r++)for(var s=function(s){var h=(r-1)*i+s,f={url:t+"/bg_"+(h>=10?h:"0"+h),row:r,column:s},g=s==i?Math.ceil(l.BgContainer.width%l.mapCellSize):l.mapCellSize,y=r==n?Math.ceil(l.BgContainer.height%l.mapCellSize):l.mapCellSize;p.default.instance.setUseRecord(a.GlobalContext.Root+"prefab/Map/MapSpriteItem"),o.default.instance.loadResByType(a.GlobalContext.Root+"prefab/Map/MapSpriteItem",cc.Prefab,function(t){p.default.instance.clearUseRecord(a.GlobalContext.Root+"prefab/Map/MapSpriteItem");var i=c.default.getNodeByPool(d.PoolType.SpriteItem,t);i.getComponent(cc.Sprite).sizeMode=cc.Sprite.SizeMode.TRIMMED,i.width=g,i.height=y,i.getComponent(u.default).setUrl(f.url),e.BgContainer.addChild(i);var n=-e.BgContainer.width/2,o=e.BgContainer.height/2;n+=(f.column-1)*e.mapCellSize,o-=(f.row-1)*e.mapCellSize,i.setPosition(n+g/2,o-y/2)},l)},l=this,h=1;h<=i;h++)s(h)},t.prototype.loadMapPic=function(){this.loadedMapUrls.length=0,this.waitLoadMapUrls.length=0;for(var e=a.GlobalContext.Root+"ui/scene/map/"+this.sceneId,t=Math.ceil(this.BgContainer.width/this.mapCellSize),i=Math.ceil(this.BgContainer.height/this.mapCellSize),n=1;n<=i;n++)for(var r=1;r<=t;r++){var s=(n-1)*t+r,l=e+"/bg_"+(s>=10?s:"0"+s);this.waitLoadMapUrls.push({url:l,row:n,column:r})}if(this.setMapShowPostion(this.startPosX,this.startPosY),this.waitLoadMapUrls.length>0){var c=this.waitLoadMapUrls.shift();o.default.instance.loadResByType(c.url,cc.SpriteFrame,this.loadMapPicComplete,this,[this.sceneId,c])}},t.prototype.loadMapPicComplete=function(e,t,i){var n=this;if(1!=this.isDestroyed&&this.sceneId==t&&(p.default.instance.setUseRecord(a.GlobalContext.Root+"prefab/Map/MapSpriteItem"),o.default.instance.loadResByType(a.GlobalContext.Root+"prefab/Map/MapSpriteItem",cc.Prefab,function(t){p.default.instance.clearUseRecord(a.GlobalContext.Root+"prefab/Map/MapSpriteItem");var o=e,r=o.getRect().width,s=o.getRect().height,l=c.default.getNodeByPool(d.PoolType.SpriteItem,t);l.getComponent(cc.Sprite).sizeMode=cc.Sprite.SizeMode.TRIMMED,l.width=r,l.height=s,l.getComponent(cc.Sprite).spriteFrame=o,n.BgContainer.addChild(l);var h=-n.BgContainer.width/2,u=n.BgContainer.height/2;h+=(i.column-1)*n.mapCellSize,u-=(i.row-1)*n.mapCellSize,l.setPosition(h+r/2,u-s/2)},this),this.loadedMapUrls.push(i.url),this.setUseRecord(i.url),this.waitLoadMapUrls.length>0)){var r=this.waitLoadMapUrls.shift();o.default.instance.loadResByType(r.url,cc.SpriteFrame,this.loadMapPicComplete,this,[this.sceneId,r])}},t.prototype.setMapShowPostion=function(e,t){if(this.startPosX=e,this.startPosY=t,-1!=this.startPosX||0!=this.startPosY){t=Math.abs(t);var i=Math.ceil(e/this.mapCellSize),n=Math.ceil(t/this.mapCellSize);this.waitLoadMapUrls.sort(function(e,t){var o=Math.abs(e.column-i)+Math.abs(e.row-n),a=Math.abs(t.column-i)+Math.abs(t.row-n);return o<a?-1:o>a?1:0})}},t.prototype.loadBgDirComplete=function(e,t,i){var n=this;if(1!=this.isDestroyed&&this.bgUrl==i){var r=-this.BgContainer.width/2,s=this.BgContainer.height/2;p.default.instance.setUseRecord(a.GlobalContext.Root+"prefab/Map/MapSpriteItem"),o.default.instance.loadResByType(a.GlobalContext.Root+"prefab/Map/MapSpriteItem",cc.Prefab,function(o){p.default.instance.clearUseRecord(a.GlobalContext.Root+"prefab/Map/MapSpriteItem");for(var l=1;l<=t.length;l++){var h=i+"/bg_"+(l>=10?l:"0"+l),u=t.indexOf(h);if(u>=0){var f=e[u],g=f.getRect().width,y=f.getRect().height,m=c.default.getNodeByPool(d.PoolType.SpriteItem,o);m.getComponent(cc.Sprite).sizeMode=cc.Sprite.SizeMode.TRIMMED,m.width=g,m.height=y,m.getComponent(cc.Sprite).spriteFrame=f,n.BgContainer.addChild(m),m.setPosition(r+g/2,s-y/2),(r+=g)>=n.BgContainer.width/2&&(r=-n.BgContainer.width/2,s-=y)}}n.checkIsReady()},this)}},t.prototype.clearUseRecord=function(e){e&&""!=e&&p.default.instance.clearUseRecord(e)},t.prototype.setUseRecord=function(e){e&&""!=e&&p.default.instance.setUseRecord(e)},t.prototype.initDragNode=function(){this.maxX=this.DragNode.width/2,this.maxY=this.node.height-this.DragNode.height,this.DragNode.off(cc.Node.EventType.TOUCH_MOVE,this.DragNodeTouchMove,this),this.DragNode.on(cc.Node.EventType.TOUCH_MOVE,this.DragNodeTouchMove,this),this.checkIsReady()},t.prototype.checkIsReady=function(){this.BgContainer.childrenCount>0&&this.mapConfigData&&(r.default.instance.showSceneLoadingFinish(),this.realyShow())},t.prototype.DragNodeTouchMove=function(e){if(!g.default.instance.isGuide){var t=e.getPreviousLocation(),i=e.getLocation(),n=this.DragNode.position.x+(i.x-t.x),o=this.DragNode.position.y+(i.y-t.y);this.checkDragNodePosition(n,o)}},t.prototype.checkDragNodePosition=function(e,t){t>0&&(t=0);var i=this.maxY*this.DragNode.scaleY+this.node.height*(1-this.DragNode.scaleY);t<i&&(t=i);var n=this.maxX*this.DragNode.scaleX-this.node.width/2;e<-n&&(e=-n),e>n&&(e=n),this.DragNode.setPosition(e,t)},t.prototype.getScaleByY=function(e){var t=Math.abs(e),i=this.minScale,n=(1-i)/-this.maxY*t;return n=i+n},t.prototype.update=function(){this._moveAddCount>0&&this.moveDragNodeByLocalPosition(this._moveToX,this._moveToY,-1);var e=this.getScaleByY(this.DragNode.position.y);if(e&&0==isNaN(e)&&((e*=.5)!=this.DragNode.scaleX&&this.DragNode.setScale(e,e),this.Container.childrenCount>0)){var t=1/e;if(t!=this.Container.children[0].scaleX)for(var i=0;i<this.Container.childrenCount;i++)this.Container.children[i].setScale(1.5),f.ActivityStatus.value==f.ActivityStatus.Chapter&&"MoveRole"==this.Container.children[i].name&&this.Container.children[i].setScale(cc.v2(t,t).mul(.7))}},__decorate([C(cc.Node)],t.prototype,"DragNode",void 0),__decorate([C(cc.Node)],t.prototype,"BgContainer",void 0),__decorate([C(cc.Node)],t.prototype,"Container",void 0),t=__decorate([m],t)}(n.default);i.default=v,cc._RF.pop()},{"../../../Core/CacheManager":"CacheManager","../../../Core/LoadManager":"LoadManager","../../../Core/TimeController":"TimeController","../../../Core/Widget":"Widget","../../../Core/WindowType":"WindowType","../../../GlobalContext":"GlobalContext","../../../Util/AStar/AStar":"AStar","../../../Util/AStar/AStarUtil":"AStarUtil","../../../Util/Utils":"Utils","../../Guide/GuideNewController":"GuideNewController","../../LoadingPanel/LoadingPanel":"LoadingPanel","../../Status/StatusType":"StatusType","./MapViewOne":"MapViewOne"}],MaskBg:[function(e,t,i){"use strict";cc._RF.push(t,"3c25d9tldRHs44SBs55ovi8","MaskBg"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../GlobalContext"),a=cc._decorator,r=a.ccclass,s=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this),this.node.width=o.GlobalContext.StageWidth,this.node.height=o.GlobalContext.StageHeight},t=__decorate([r],t)}(n.default));i.default=s,cc._RF.pop()},{"../../Core/Widget":"Widget","../../GlobalContext":"GlobalContext"}],MineAwardsVo:[function(e,t,i){"use strict";cc._RF.push(t,"9c973nlUs1FpZUdY2TKFhJd","MineAwardsVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e){for(var t in e)this[t]=e[t]}return Object.defineProperty(e.prototype,"itemId",{get:function(){return this.id?this.id:this.type},enumerable:!0,configurable:!0}),e}();i.MineAwardsVo=n,cc._RF.pop()},{}],MineCondVo:[function(e,t,i){"use strict";cc._RF.push(t,"3eb53CMHsZP8YBQhL3tcDJv","MineCondVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){return function(){}}();i.MineCondVo=n,cc._RF.pop()},{}],MineConst:[function(e,t,i){"use strict";cc._RF.push(t,"86185S8iKJBZJXJ/THT2s9D","MineConst"),Object.defineProperty(i,"__esModule",{value:!0}),function(e){e[e.Journal=0]="Journal",e[e.Interactive=1]="Interactive",e[e.Return=2]="Return"}(i.MineBtnConst||(i.MineBtnConst={})),function(e){e[e.Git=0]="Git",e[e.News=1]="News",e[e.SpeedUp=2]="SpeedUp"}(i.MineItemBtnConst||(i.MineItemBtnConst={})),function(e){e[e.Help=0]="Help",e[e.Steal=1]="Steal",e[e.Go=2]="Go"}(i.MineHelpConst||(i.MineHelpConst={})),cc._RF.pop()},{}],MineCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"c6cd3gjL4tEDIa5+5kKUeFz","MineCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../Core/ConfigsManager"),a=e("../../Core/GameEventDispatcher"),r=e("../../Core/Event"),s=e("../../NetConnect/NetConnet"),l=e("./vo/MineVo"),c=e("../../Core/Language"),d=e("./vo/MineAwardsVo"),p=e("./MineUtils"),h=e("../Gamelayer/Interface/EventInterface"),u=e("./vo/MineSerDataVo"),f=e("./vo/MineSerFriendVo"),g=e("../Tips/OpTipsController"),y=e("../../Core/TimeController"),m=e("../PartnerPanel/FriendsController"),C=e("../Status/StatusType"),v=cc._decorator,_=v.ccclass,b=(v.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rewards={},t.mineConfigAny=[],t.chooseIndex=2,t.oreBag=[],t.isMyMap=!0,t.qualityIndex=1,t.serFriends=[],t.seekHelps=[],t.openTimes=1e3,t.isNewLog=!1,t.helpCds={},t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){var t;e.prototype.onLoad.call(this),this.oreBag=[];for(var i=0;i<4;i++)this.oreBag.push(c.default.getStr("771"+i));var n=o.ConfigsManager.instance.getConfigs("mineConf"),a=n.mineConf[1];for(var r in t=[a.helpTimes,a.stealTimes,n.mineCondition[1],n.cond,n.fixReward[1]],this.helpTimes=t[0],this.stealTimes=t[1],this.mineCondition=t[2],this.cond=t[3],this.fixReward=t[4],a=n.mine[1])this.mineConfigAny.push(new l.MineVo(a[r]));for(var r in a=n.awards){var s=a[r];for(var p in this.rewards[r]=[],s)this.rewards[r].push(new d.MineAwardsVo(s[p]))}},t.prototype.listNotification=function(){i.instance=this,this.addProto("mineinfo",this.setMineInfo,this),this.addProto("minedata",this.setMineData,this),this.addProto("minechange",this.setMineChange,this),this.addProto("minefriend",this.setMineFriend,this),this.addProto("minefriendchange",this.setMineFriendChange,this),this.getMineFriendReq(),a.GameEventDispatcher.instance.on(r.EventDefiner.FriDel,this.getMineFriendReq,this),a.GameEventDispatcher.instance.on(r.EventDefiner.FRIENDS_ADDONE,this.getMineFriendReq,this)},t.prototype.clearTime=function(){this.timeOut&&(y.default.instance.clearTimeout(this.timeOut),this.timeOut=null)},t.prototype.openTime=function(){var e=this;C.ActivityStatus.value==C.ActivityStatus.Mine?1e3!=this.openTimes&&(this.openTimes=1e3,this.clearTime()):1e3==this.openTimes&&(this.openTimes=6e4,this.clearTime()),this.timeOut||(this.timeOut=y.default.instance.setInterval(function(){var t=m.default.instance.getFriendLen()||e.seekHelps.length||e.serData.seekHelp.length;1e3!=e.openTimes&&e.getMineInfoReq(),t&&e.getMineFriendReq()},this,this.openTimes))},t.prototype.getMineInfoReq=function(){s.default.instance.sendProto({cmd:"mineinfo"})},t.prototype.getMineFriendReq=function(){s.default.instance.sendProto({cmd:"minefriend"})},t.prototype.getMineHelpSpeedReq=function(){if(this.serData.ovarHelpTimes){var e={cmd:"minehelpspeed",friId:this.fid,id:this.clickId};s.default.instance.sendProto(e)}else g.default.instance.ShowMsg(c.default.getStr("7729"))},t.prototype.getMineInviteHelpReq=function(e){var t={cmd:"mineinvitehelp",friId:e};s.default.instance.sendProto(t)},t.prototype.getMineGetRewardReq=function(e){var t={cmd:"minegetreward",id:e};s.default.instance.sendProto(t)},t.prototype.getMineStealRewardReq=function(e){if(this.serData.ovarStealTimes){var t={cmd:"minestealreward",friId:this.fid,id:e};s.default.instance.sendProto(t)}else g.default.instance.ShowMsg(c.default.getStr("7729"))},t.prototype.getMinestartReq=function(){var e={cmd:"minestart",id:this.index};s.default.instance.sendProto(e)},t.prototype.getMinereFreshReq=function(){var e={cmd:"minerefresh",id:this.index};s.default.instance.sendProto(e)},t.prototype.getMineIgnoreHelpReq=function(e){var t={cmd:"mineignorehelp",friId:e};s.default.instance.sendProto(t)},t.prototype.getMineDispatchCardReq=function(e,t){if(1!=e||p.MineUtils.getSerMineData().cond.grid!=p.MineUtils.getMineCardData().length){var i={cmd:"minedispatchcard",type:e,id:this.index,cId:t};s.default.instance.sendProto(i)}},t.prototype.getMineDelLogReq=function(e){var t={cmd:"minedellog",time:e};s.default.instance.sendProto(t)},t.prototype.setMineInfo=function(e){this.serData||(this.serData=new u.MineSerDataVo),this.serData.updateData(e.data),a.GameEventDispatcher.instance.emit(h.EventInterface.MineRed,p.MineUtils.getRed())},t.prototype.setMineData=function(e){this.serData&&(this.serData.mine[e.id].updateData(e.mine),a.GameEventDispatcher.instance.emit(r.EventDefiner.MineUpdate),a.GameEventDispatcher.instance.emit(h.EventInterface.MineRed,p.MineUtils.getRed()))},t.prototype.setMineChange=function(e){"log"==e.key&&(this.isNewLog=e.value.length>this.serData.log.length),this.serData[e.key]=e.value,"log"==e.key&&this.serData.sortLog(),this.serData.updateData(null),a.GameEventDispatcher.instance.emit(r.EventDefiner.MineUpdate),a.GameEventDispatcher.instance.emit(h.EventInterface.MineRed,p.MineUtils.getRed())},t.prototype.setMineFriend=function(e){var t=JSON.stringify(e);if(!this.proto||this.proto!=t){this.proto=t;var i=e.friends,n=this.serFriends.length-i.length;for(var o in n>0&&this.serFriends.splice(this.serFriends.length-n,this.serFriends.length),i)this.serFriends[o]||(this.serFriends[o]=new f.MineSerFriendVo),this.serFriends[o].updateData(i[o]);var s=e.seekHelp;for(var o in(n=this.seekHelps.length-s.length)>0&&this.seekHelps.splice(this.seekHelps.length-n,this.seekHelps.length),s)this.seekHelps[o]||(this.seekHelps[o]=new f.MineSerFriendVo),this.seekHelps[o].updateData(s[o]);a.GameEventDispatcher.instance.emit(r.EventDefiner.MineFriendsUpdate),a.GameEventDispatcher.instance.emit(h.EventInterface.MineRed,p.MineUtils.getRed())}},t.prototype.setMineFriendChange=function(e){for(var t in this.serFriends)if(this.serFriends[t].aid==e.friId){this.serFriends[t].mine[e.id].updateData(e.friMine),!1;break}for(var t in this.seekHelps)if(this.seekHelps[t].aid==e.friId){this.seekHelps[t].mine[e.id].updateData(e.friMine),!1;break}a.GameEventDispatcher.instance.emit(r.EventDefiner.MineUpdate)},t.instance=null,t=i=__decorate([_],t)}(n.default));i.default=b,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/TimeController":"TimeController","../../NetConnect/NetConnet":"NetConnet","../Gamelayer/Interface/EventInterface":"EventInterface","../PartnerPanel/FriendsController":"FriendsController","../Status/StatusType":"StatusType","../Tips/OpTipsController":"OpTipsController","./MineUtils":"MineUtils","./vo/MineAwardsVo":"MineAwardsVo","./vo/MineSerDataVo":"MineSerDataVo","./vo/MineSerFriendVo":"MineSerFriendVo","./vo/MineVo":"MineVo"}],MineDispatchtem:[function(e,t,i){"use strict";cc._RF.push(t,"acf841H1MpJ5bTTCq8GuzXr","MineDispatchtem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Core/Language"),a=e("../../../Core/CommonsResManager"),r=e("../../Commons/Image"),s=e("../../Tips/OpTipsController"),l=e("./../MineUtils"),c=e("../../../Core/GameEventDispatcher"),d=e("../../../Core/Event"),p=e("../MineCtrl"),h=e("../../WarTeam/MonsterController"),u=e("../../Item/ItemData"),f=e("../../../GlobalContext"),g=cc._decorator,y=g.ccclass,m=g.property,C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.icon=null,t.group=null,t.quailty=null,t.lv=null,t}return __extends(t,e),t.prototype.updateData=function(e){if(this.group.active=!!e,this.serData=e,e){var t=h.default.instance.GetMonsterInfo(e.id);this.lv.string=o.default.getStr("7747",e.level);var i=u.default.creatItem(t.pieceId);this.group.getComponent(cc.Sprite).spriteFrame=a.default.instance.getSpriteFrameByName("bag"+i.colorIndex);var n=f.GlobalContext.ResRoot+"resources/itemicon/"+i.ItemIcon+".png";this.icon.loadImageByHttps(n),this.quailty.getComponent(cc.Sprite).spriteFrame=a.default.instance.getSpriteFrameByName("fiveLine_"+t.fiveLineAttributes)}},t.prototype.onClickSend=function(){if(!l.MineUtils.isMine()){if(this.serData){var e=p.default.instance.serData.card[this.serData.id];p.default.instance.getMineDispatchCardReq(null!=e?2:1,this.serData.id)}else if(!l.MineUtils.getAllCardData().length)return void s.default.instance.ShowMsg(o.default.getStr("7741"));c.GameEventDispatcher.instance.emit(d.EventDefiner.MineShowCardBg,!!this.serData)}},__decorate([m(r.default)],t.prototype,"icon",void 0),__decorate([m(cc.Node)],t.prototype,"group",void 0),__decorate([m(cc.Node)],t.prototype,"quailty",void 0),__decorate([m(cc.Label)],t.prototype,"lv",void 0),t=__decorate([y],t)}(n.default);i.default=C,cc._RF.pop()},{"../../../Core/CommonsResManager":"CommonsResManager","../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Core/Widget":"Widget","../../../GlobalContext":"GlobalContext","../../Commons/Image":"Image","../../Item/ItemData":"ItemData","../../Tips/OpTipsController":"OpTipsController","../../WarTeam/MonsterController":"MonsterController","../MineCtrl":"MineCtrl","./../MineUtils":"MineUtils"}],MineHelpWin:[function(e,t,i){"use strict";cc._RF.push(t,"c7747x/M5BGbYU68bxvOBGb","MineHelpWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Commons/CommonPageBG"),o=e("../../Core/Language"),a=e("./MineCtrl"),r=e("./MineUtils"),s=e("../Tips/OpTipsController"),l=e("../../Core/GameEventDispatcher"),c=e("../../Core/Event"),d=cc._decorator,p=d.ccclass,h=d.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.str1=null,t.str2=null,t.btn=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.onInit(524,328,o.default.getStr("7702"),!0),this.btn.getComponentInChildren(cc.Label).string=o.default.getStr("7745")},t.prototype.show=function(){e.prototype.show.call(this);var t=a.default.instance,i=r.MineUtils.getFriendData(),n=Math.floor(i.mine[t.clickId].type),s=t.mineConfigAny[n];this.str1.string=o.default.getStr("7744",i.info.name,Math.floor(s.speedTime/60),s.mineName),this.str2.string=o.default.getStr("7739",t.serData.ovarHelpTimes)},t.prototype.onClickSend=function(){var e=a.default.instance,t=r.MineUtils.getFriendData(),i=t.mine[e.clickId].speedCnt,n=Math.floor(t.mine[e.clickId].type);i==e.mineConfigAny[n].speedCnt?s.default.instance.ShowMsg(o.default.getStr("7753")):(a.default.instance.getMineHelpSpeedReq(),l.GameEventDispatcher.instance.emit(c.EventDefiner.MineSpeedAni)),this.onClose()},__decorate([h(cc.RichText)],t.prototype,"str1",void 0),__decorate([h(cc.Label)],t.prototype,"str2",void 0),__decorate([h(cc.Node)],t.prototype,"btn",void 0),t=__decorate([p],t)}(n.default);i.default=u,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../Commons/CommonPageBG":"CommonPageBG","../Tips/OpTipsController":"OpTipsController","./MineCtrl":"MineCtrl","./MineUtils":"MineUtils"}],MineInteractiveItem:[function(e,t,i){"use strict";cc._RF.push(t,"06dfeijNdlBn6O2qaXr/e+7","MineInteractiveItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../Gamelayer/RoleHead"),a=e("../MineConst"),r=e("../MineCtrl"),s=e("../../../Core/CommonsResManager"),l=e("../../../Core/Language"),c=e("../MineUtils"),d=e("../../../Util/Utils"),p=e("../../../Core/TimeController"),h=cc._decorator,u=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.portraitImage=null,t.lv=null,t.sexImage=null,t.nameLabel=null,t.onLine=null,t.timeStr=null,t.stealBtn=null,t.helpBtn=null,t.goBtn=null,t.stateStr=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.helpBtn.getComponentInChildren(cc.Label).string=l.default.getStr("7738"),this.stealBtn.getComponentInChildren(cc.Label).string=l.default.getStr("7728"),this.goBtn.getComponentInChildren(cc.Label).string=l.default.getStr("7728")},t.prototype.hide=function(){e.prototype.hide.call(this),this.closeTime(),this.serData=null},t.prototype.updateData=function(e){this.serData=e,this.helpBtn.active=r.default.instance.chooseIndex==a.MineHelpConst.Help,this.stealBtn.active=r.default.instance.chooseIndex==a.MineHelpConst.Steal,this.goBtn.active=r.default.instance.chooseIndex==a.MineHelpConst.Go,this.stateStr.getComponent(cc.RichText).string="";var t=!!e.mine?e.info:e;switch(this.portraitImage.SetHead(t.icon),this.lv.string=""+t.level,this.onLine.active=!1,d.default.setGrayEffect(this.node,!0),this.closeTime(),r.default.instance.chooseIndex){case a.MineHelpConst.Help:this.onLine.active=!0,this.onLine.getComponent(cc.RichText).string=l.default.getStr("775"+e.online),d.default.setGrayEffect(this.node,!!e.online),this.setTime(),this.stateStr.getComponent(cc.RichText).string=l.default.getStr("77"+(e.overHelpTimes?"27":"46"),e.overHelpTimes);break;case a.MineHelpConst.Steal:this.stateStr.getComponent(cc.RichText).string=l.default.getStr("7737");break;case a.MineHelpConst.Go:}this.nameLabel.string=t.name,this.sexImage.spriteFrame=s.default.instance.getSpriteFrameByName("gender_"+t.gender)},t.prototype.closeTime=function(){this.timeStr.getComponent(cc.RichText).string="",this.time&&(p.default.instance.clearInterval(this.time),this.time=null)},t.prototype.setState=function(e,t){this.timeStr.active=e,this.helpBtn.getComponent(cc.Button).interactable=!e&&this.serData.online,this.timeStr.getComponent(cc.RichText).string=e?""+t:"",e||this.closeTime()},t.prototype.setTimeData=function(){var e=this.serData.getOverTime();this.setState(e>0,e)},t.prototype.setTime=function(){var e=this;this.setTimeData(),this.serData.getOverTime()>0&&!this.time&&(this.time=p.default.instance.setInterval(function(){e.setTimeData()},this,1e3))},t.prototype.onClickSend=function(e,t){var i=parseInt(t);switch(r.default.instance.interactiveType=i,i){case a.MineHelpConst.Help:r.default.instance.getMineInviteHelpReq(this.serData.aid),this.serData.setHisToryTIme(),this.setTime();break;case a.MineHelpConst.Steal:case a.MineHelpConst.Go:c.MineUtils.setMapState(!1,this.serData.aid)}},__decorate([f(o.default)],t.prototype,"portraitImage",void 0),__decorate([f(cc.Label)],t.prototype,"lv",void 0),__decorate([f(cc.Sprite)],t.prototype,"sexImage",void 0),__decorate([f(cc.Label)],t.prototype,"nameLabel",void 0),__decorate([f(cc.Node)],t.prototype,"onLine",void 0),__decorate([f(cc.Node)],t.prototype,"timeStr",void 0),__decorate([f(cc.Node)],t.prototype,"stealBtn",void 0),__decorate([f(cc.Node)],t.prototype,"helpBtn",void 0),__decorate([f(cc.Node)],t.prototype,"goBtn",void 0),__decorate([f(cc.Node)],t.prototype,"stateStr",void 0),t=__decorate([u],t)}(n.default);i.default=g,cc._RF.pop()},{"../../../Core/CommonsResManager":"CommonsResManager","../../../Core/Language":"Language","../../../Core/TimeController":"TimeController","../../../Core/Widget":"Widget","../../../Util/Utils":"Utils","../../Gamelayer/RoleHead":"RoleHead","../MineConst":"MineConst","../MineCtrl":"MineCtrl","../MineUtils":"MineUtils"}],MineInteractiveWin:[function(e,t,i){"use strict";cc._RF.push(t,"422d3il+85IYpPY4gGL0ItE","MineInteractiveWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Commons/CommonPageBG"),o=e("../../Core/Language"),a=e("../../Core/WindowType"),r=e("../../Core/GameEventDispatcher"),s=e("../../Core/Event"),l=e("../../GlobalContext"),c=e("./MineCtrl"),d=e("../../Core/LoadManager"),p=e("./item/MineInteractiveItem"),h=e("./MineConst"),u=e("./MineUtils"),f=e("../Commons/WindowOpenUtils"),g=e("../Commons/ListViewCtrl"),y=cc._decorator,m=y.ccclass,C=y.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=null,t.noStr=null,t.surplusStr=null,t.toggle=null,t.ignoreBtn=null,t.addFriendBtn=null,t.listViewCtrl=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.onInit(740,600,o.default.getStr("7719"),!0),this.ignoreBtn.getComponentInChildren(cc.Label).string=o.default.getStr("7726"),this.addFriendBtn.getComponentInChildren(cc.Label).string=o.default.getStr("7763");for(var t=this.toggle.node.children,i=0;i<t.length;i++)t[i].getComponentInChildren(cc.Label).string=o.default.getStr(""+(7723+i))},t.prototype.show=function(){e.prototype.show.call(this),r.GameEventDispatcher.instance.on(s.EventDefiner.MineUpdate,this.updateData,this),r.GameEventDispatcher.instance.on(s.EventDefiner.MineClose,this.onClose,this),r.GameEventDispatcher.instance.on(s.EventDefiner.MineFriendsUpdate,this.setFriendData,this),c.default.instance.chooseIndex=h.MineHelpConst.Help,u.MineUtils.getFriendMineRed()?c.default.instance.chooseIndex=h.MineHelpConst.Steal:u.MineUtils.getHelpRed()&&(c.default.instance.chooseIndex=h.MineHelpConst.Go),this.toggle.toggleItems[c.default.instance.chooseIndex].isChecked=!0,this.updateData(),this.listViewCtrl.scrollToTop()},t.prototype.hide=function(){r.GameEventDispatcher.instance.off(s.EventDefiner.MineUpdate,this.updateData,this),r.GameEventDispatcher.instance.off(s.EventDefiner.MineClose,this.onClose,this),r.GameEventDispatcher.instance.off(s.EventDefiner.MineFriendsUpdate,this.setFriendData,this),this.len=null},t.prototype.setData=function(e){this.listViewCtrl.refreshItem=this.updateitem,this.listViewCtrl.refreshItemThis=this,this.listViewCtrl.initialize(e)},t.prototype.updateitem=function(e,t){var i=this.listViewCtrl.dataLsit[t];e.getComponent(p.default).updateData(i)},t.prototype.setFriendData=function(){var e=u.MineUtils.getFriendsData();null!=this.len&&e.length!=this.len&&this.updateData()},t.prototype.onClickToggle=function(e){var t=parseInt(e.target.name);null!=t&&t==c.default.instance.chooseIndex||(c.default.instance.chooseIndex=t,this.updateData(),this.listViewCtrl.scrollToTop())},t.prototype.updateData=function(){var e=this;switch(this.surplusStr.active=c.default.instance.chooseIndex!=h.MineHelpConst.Help,this.ignoreBtn.active=c.default.instance.chooseIndex==h.MineHelpConst.Go,this.addFriendBtn.active=c.default.instance.chooseIndex!=h.MineHelpConst.Go,cc.find("1/flag",this.toggle.node).active=u.MineUtils.getFriendMineRed(),cc.find("2/flag",this.toggle.node).active=u.MineUtils.getHelpRed(),c.default.instance.chooseIndex){case h.MineHelpConst.Steal:this.surplusStr.getComponent(cc.RichText).string=o.default.getStr("7764",c.default.instance.serData.ovarStealTimes);break;case h.MineHelpConst.Go:this.surplusStr.getComponent(cc.RichText).string=o.default.getStr("7739",c.default.instance.serData.ovarHelpTimes)}d.default.instance.loadResByType(l.GlobalContext.Root+"prefab/Mine/MineInteractiveItem",cc.Prefab,function(t){var i=u.MineUtils.getFriendsData();e.len=i.length,e.setData(i),e.noStr.active=!e.content.children.length,e.noStr.active&&(e.noStr.getComponent(cc.Label).string=o.default.getStr("776"+c.default.instance.chooseIndex))},this)},t.prototype.onClickSend=function(e,t){switch(parseInt(t)){case 1:c.default.instance.getMineIgnoreHelpReq();break;case 2:f.default.instance.openWindowType(a.WindowType.FriendSearchPage)}},__decorate([C(cc.Node)],t.prototype,"content",void 0),__decorate([C(cc.Node)],t.prototype,"noStr",void 0),__decorate([C(cc.Node)],t.prototype,"surplusStr",void 0),__decorate([C(cc.ToggleContainer)],t.prototype,"toggle",void 0),__decorate([C(cc.Node)],t.prototype,"ignoreBtn",void 0),__decorate([C(cc.Node)],t.prototype,"addFriendBtn",void 0),__decorate([C(g.default)],t.prototype,"listViewCtrl",void 0),t=__decorate([m],t)}(n.default);i.default=v,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../Commons/CommonPageBG":"CommonPageBG","../Commons/ListViewCtrl":"ListViewCtrl","../Commons/WindowOpenUtils":"WindowOpenUtils","./MineConst":"MineConst","./MineCtrl":"MineCtrl","./MineUtils":"MineUtils","./item/MineInteractiveItem":"MineInteractiveItem"}],MineItem:[function(e,t,i){"use strict";cc._RF.push(t,"5b779DugeRLsrXIuiuu1zWk","MineItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../Commons/Image"),a=e("../../../Core/CommonsResManager"),r=e("./../MineCtrl"),s=e("./../MineConst"),l=e("../../Commons/WindowOpenUtils"),c=e("../../../Core/WindowType"),d=e("../../Tips/OpTipsController"),p=e("../../../Core/Language"),h=e("../../../Util/NumberUtil"),u=e("../MineUtils"),f=e("../../../Core/TimeController"),g=e("../../../Util/DateUtil"),y=e("../../../Core/GameEventDispatcher"),m=e("../../../Core/Event"),C=cc._decorator,v=C.ccclass,_=C.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.empty=null,t.unlock=null,t.bottom=null,t.speed=null,t.state=null,t.gift=null,t.bg=null,t.stateStr=null,t.bottomIcon=null,t.bottomName=null,t.axe=null,t.index=null,t.isPlay=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),y.GameEventDispatcher.instance.on(m.EventDefiner.MineSpeedAni,this.playSpeedAni,this)},t.prototype.hide=function(){e.prototype.hide.call(this),y.GameEventDispatcher.instance.off(m.EventDefiner.MineSpeedAni,this.playSpeedAni,this),this.gift.stopAllActions(),this.closeTime(),this.axe.stop()},t.prototype.initData=function(e){this.index=e},t.prototype.closeTime=function(){f.default.instance.clearInterval(this.time),this.time=null},t.prototype.updateData=function(e,t){var i=this;e?(this.serData=e,this.configData=u.MineUtils.getMineData(e.type)):(this.serData=this.configData=null,this.closeTime());var n=u.MineUtils.getIsUnlock(this.index);this.bottom.active=this.bg.node.active=this.state.active=this.speed.active=this.unlock.active=this.empty.active=this.gift.active=!1;var s=r.default.instance;if(this.serData){switch(this.serData.state){case 1:this.axe.stop(),this.empty.active=!0,this.isPlay=null;break;case 2:this.speed.active=this.bottom.active=this.bg.node.active=this.state.active=!0,null==this.isPlay&&(this.isPlay=!1,this.axe.node.getChildByName("Particle").active=!1,this.axe.play());var l=this.speed.getChildByName("img2");l.active=!0,s.isMyMap||this.serData.isCanspeeds()||(l.active=!1),l.active&&l.getComponent(o.default).updateBg("resources/Mine/i18n_"+(s.isMyMap?"yqjs":"djjs")+".png"),this.time||(this.setTimeData(),this.time=f.default.instance.setInterval(function(){i.setTimeData()},this,1e3));break;case 3:this.axe.stop(),this.isPlay=null,this.bottom.active=this.bg.node.active=!0}this.gift.active=this.serData.isCanReceive();var c="resources/itemicon/ItemIcon_box"+(this.configData.type+1)+".png";this.gift.getComponent(o.default).updateBg(c)}else this.unlock.active=!0,cc.find("unlockGroup/str",this.unlock).getComponent(cc.RichText).string=p.default.getStr("7742",n);if(this.gift.active){this.gift.position=new cc.Vec2(0,0),this.gift.stopAllActions();var d=cc.repeatForever(cc.sequence(cc.moveBy(.5,cc.v2(0,10)),cc.moveBy(.5,cc.v2(0,-10))));this.gift.runAction(d)}null!=this.serData&&(this.bottomIcon.spriteFrame=a.default.instance.getSpriteFrameByName("icon_war"+this.configData.type),this.bottomName.spriteFrame=a.default.instance.getSpriteFrameByName("i18n_war"+this.configData.type),this.bg.updateBg("resources/Mine/bg_"+this.configData.type+".png"))},t.prototype.onClickSend=function(e,t){var i=parseInt(t),n=r.default.instance;switch(i){case s.MineItemBtnConst.Git:n.isMyMap?r.default.instance.getMineGetRewardReq(this.index):this.serData.isCanSteal()?r.default.instance.getMineStealRewardReq(this.index):d.default.instance.ShowMsg(p.default.getStr("7755"));break;case s.MineItemBtnConst.News:if(n.isMyMap){var o=n.serData.mine[this.index]?n.serData.mine[this.index].state:null;this.serData?3==o?r.default.instance.getMineGetRewardReq(this.index):0!=o&&(r.default.instance.index=this.index,l.default.instance.openWindowType(c.WindowType.MineNews)):d.default.instance.ShowMsg(p.default.getStr("7706",h.NumberUtil.unitsDigitToText(u.MineUtils.getIsUnlock(this.index))))}else this.serData&&!this.serData.isCanSteal()&&3==this.serData.state?d.default.instance.ShowMsg(p.default.getStr("7755")):this.serData&&this.serData.isCanSteal()&&3==this.serData.state?r.default.instance.getMineStealRewardReq(this.index):this.serData&&3!=this.serData.state&&(1==this.serData.state?d.default.instance.ShowMsg(p.default.getStr("7754")):this.serData.isCanspeeds()?(r.default.instance.clickId=this.index,l.default.instance.openWindowType(c.WindowType.MineHelp)):d.default.instance.ShowMsg(p.default.getStr("7743")));break;case s.MineItemBtnConst.SpeedUp:n.isMyMap?(r.default.instance.chooseIndex=0,l.default.instance.openWindowType(c.WindowType.MineInteractive)):this.serData.isCanspeeds()?(r.default.instance.clickId=this.index,l.default.instance.openWindowType(c.WindowType.MineHelp)):d.default.instance.ShowMsg(p.default.getStr("7743"))}},t.prototype.playSpeedAni=function(){var e=this;if(r.default.instance.clickId==this.index){this.isPlay=!0,r.default.instance.clickId=null,this.axe.node.getChildByName("Particle").active=!0;var t=this.axe.getClips();this.axe.play("axe2");f.default.instance.setTimeout(function(){e.isPlay=!1,e.axe.play(),e.axe.node.getChildByName("Particle").active=!1},this,2e3*t[1].duration*4)}},t.prototype.setTimeData=function(){if(this.serData){var e=this.serData.getOverTime();e<=0?(this.closeTime(),r.default.instance.isMyMap?r.default.instance.getMineInfoReq():r.default.instance.getMineFriendReq()):this.stateStr.getComponent(cc.RichText).string=p.default.getStr("7752",g.DateUtil.timeSecondsToChineseHour(e))}},__decorate([_(cc.Node)],t.prototype,"empty",void 0),__decorate([_(cc.Node)],t.prototype,"unlock",void 0),__decorate([_(cc.Node)],t.prototype,"bottom",void 0),__decorate([_(cc.Node)],t.prototype,"speed",void 0),__decorate([_(cc.Node)],t.prototype,"state",void 0),__decorate([_(cc.Node)],t.prototype,"gift",void 0),__decorate([_(o.default)],t.prototype,"bg",void 0),__decorate([_(cc.RichText)],t.prototype,"stateStr",void 0),__decorate([_(cc.Sprite)],t.prototype,"bottomIcon",void 0),__decorate([_(cc.Sprite)],t.prototype,"bottomName",void 0),__decorate([_(cc.Animation)],t.prototype,"axe",void 0),t=__decorate([v],t)}(n.default);i.default=b,cc._RF.pop()},{"../../../Core/CommonsResManager":"CommonsResManager","../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Core/TimeController":"TimeController","../../../Core/Widget":"Widget","../../../Core/WindowType":"WindowType","../../../Util/DateUtil":"DateUtil","../../../Util/NumberUtil":"NumberUtil","../../Commons/Image":"Image","../../Commons/WindowOpenUtils":"WindowOpenUtils","../../Tips/OpTipsController":"OpTipsController","../MineUtils":"MineUtils","./../MineConst":"MineConst","./../MineCtrl":"MineCtrl"}],MineJournalItem:[function(e,t,i){"use strict";cc._RF.push(t,"a89baGW745Cyr3YflXF51nm","MineJournalItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Core/Language"),a=e("../../../Util/DateUtil"),r=e("./../MineUtils"),s=e("../../../Core/LoadManager"),l=e("../../../Util/Utils"),c=e("../../Item/ItemIcon"),d=e("../../../GlobalContext"),p=e("../../Commons/RewardUtils"),h=e("../MineCtrl"),u=cc._decorator,f=u.ccclass,g=u.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.str=null,t.str1=null,t.lookBtn=null,t.content=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.lookBtn.getComponentInChildren(cc.Label).string=o.default.getStr("7734")},t.prototype.hide=function(){e.prototype.hide.call(this),l.default.setNodeChildDestoryByUrl(this.content,d.GlobalContext.Root+"prefab/Bag/ItemIcon")},t.prototype.updateData=function(e){var t=this;this.serData=e;var i=1==e.logType;this.str.string=o.default.getStr("773"+(i?5:6),e.name,h.default.instance.mineConfigAny[e.mineType].mineName),this.str1.string=a.DateUtil.secondsToMonthDay(e.time,1),l.default.setNodeChildDestoryByUrl(this.content,d.GlobalContext.Root+"prefab/Bag/ItemIcon"),!this.content.children.length&&i&&s.default.instance.loadResByType(d.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(i){var n=p.default.instance.getItemListByServerData(e.reward);for(var o in n){var a=l.default.getNodeByUrl(i,d.GlobalContext.Root+"prefab/Bag/ItemIcon");a.getComponent(c.default).ItemData(n[o],!0,""+n[o].count,!0),a.setScale(1),t.content.addChild(a)}},this)},t.prototype.onClickSend=function(){h.default.instance.getMineDelLogReq(this.serData.time),r.MineUtils.setMapState(!1,this.serData.aid)},__decorate([g(cc.RichText)],t.prototype,"str",void 0),__decorate([g(cc.Label)],t.prototype,"str1",void 0),__decorate([g(cc.Node)],t.prototype,"lookBtn",void 0),__decorate([g(cc.Node)],t.prototype,"content",void 0),t=__decorate([f],t)}(n.default);i.default=y,cc._RF.pop()},{"../../../Core/Language":"Language","../../../Core/LoadManager":"LoadManager","../../../Core/Widget":"Widget","../../../GlobalContext":"GlobalContext","../../../Util/DateUtil":"DateUtil","../../../Util/Utils":"Utils","../../Commons/RewardUtils":"RewardUtils","../../Item/ItemIcon":"ItemIcon","../MineCtrl":"MineCtrl","./../MineUtils":"MineUtils"}],MineJournalWin:[function(e,t,i){"use strict";cc._RF.push(t,"c31a2pBQcJCSJeoR5TwWuT2","MineJournalWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Commons/CommonPageBG"),o=e("../../Core/Language"),a=e("../../Core/GameEventDispatcher"),r=e("../../Core/Event"),s=e("../../Util/Utils"),l=e("../../GlobalContext"),c=e("./MineCtrl"),d=e("../../Core/LoadManager"),p=e("./item/MineJournalItem"),h=cc._decorator,u=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.onInit(740,600,o.default.getStr("7733"),!0)},t.prototype.show=function(){e.prototype.show.call(this),a.GameEventDispatcher.instance.on(r.EventDefiner.MineClose,this.onClose,this),this.updateData()},t.prototype.hide=function(){a.GameEventDispatcher.instance.off(r.EventDefiner.MineClose,this.onClose,this),s.default.setNodeChildDestoryByUrl(this.content,l.GlobalContext.Root+"prefab/Mine/MineJournalItem")},t.prototype.updateData=function(){var e=this;this.content.parent.parent.getComponent(cc.ScrollView).scrollToTop(),d.default.instance.loadResByType(l.GlobalContext.Root+"prefab/Mine/MineJournalItem",cc.Prefab,function(t){var i=c.default.instance.serData.log;for(var n in i){var o=s.default.getNodeByUrl(t,l.GlobalContext.Root+"prefab/Mine/MineJournalItem");o.getComponent(p.default).updateData(i[n]),e.content.addChild(o)}},this)},__decorate([f(cc.Node)],t.prototype,"content",void 0),t=__decorate([u],t)}(n.default);i.default=g,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/CommonPageBG":"CommonPageBG","./MineCtrl":"MineCtrl","./item/MineJournalItem":"MineJournalItem"}],MineLogVo:[function(e,t,i){"use strict";cc._RF.push(t,"c357cAYoBhJ6rxsz7YENy18","MineLogVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){return function(){}}();i.MineLogVo=n,cc._RF.pop()},{}],MineNewsWin:[function(e,t,i){"use strict";cc._RF.push(t,"d3302N6P55L5Z8GhfRacQy7","MineNewsWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Commons/CommonPageBG"),o=e("../../Core/Language"),a=e("../../Core/WindowType"),r=e("../../Core/GameEventDispatcher"),s=e("../../Core/Event"),l=e("../../Util/Utils"),c=e("../../GlobalContext"),d=e("./MineCtrl"),p=e("../../Util/CommonUtil"),h=e("../Commons/RewardUtils"),u=e("../../Core/TimeController"),f=e("../../Util/DateUtil"),g=e("../../Core/LoadManager"),y=e("../Item/ItemIcon"),m=e("./MineUtils"),C=e("./item/MineDispatchtem"),v=e("../../Util/RechargeUtils"),_=e("../../Util/RechargeConst"),b=e("../Commons/Image"),T=e("../../Core/CommonsResManager"),S=e("../Commons/ListViewCtrl"),I=cc._decorator,w=I.ccclass,D=I.property,R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bg1=null,t.bottomIcon=null,t.bottomName=null,t.content=null,t.bg=null,t.str=null,t.str1=null,t.str2=null,t.refreshBtn=null,t.mineBtn=null,t.item=null,t.group=null,t.dispatchContent=null,t.haveContent=null,t.cardQuality=null,t.attrGroup=null,t.lv=null,t.strTime=null,t.listViewCtrl=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.serData=m.MineUtils.getSerMineData(),this.configData=m.MineUtils.getMineData(this.serData.type),this.onInit(740,590,this.configData.mineName,!0),this.str1.string=o.default.getStr("7709"),this.str2.string=o.default.getStr("7714"),this.refreshBtn.getComponentInChildren(cc.Label).string=o.default.getStr("7715"),this.mineBtn.getComponentInChildren(cc.Label).string=o.default.getStr("7716"),p.CommonUtil.setClickEvent(this.node,this.item.getChildByName("icon"),h.RewardType.Diamond,.5)},t.prototype.show=function(){e.prototype.show.call(this),r.GameEventDispatcher.instance.on(s.EventDefiner.MineShowCardBg,this.showCardBg,this),r.GameEventDispatcher.instance.on(s.EventDefiner.MineUpdate,this.updateData,this),this.bg.active=!1,this.updateData()},t.prototype.hide=function(){r.GameEventDispatcher.instance.off(s.EventDefiner.MineShowCardBg,this.showCardBg,this),r.GameEventDispatcher.instance.off(s.EventDefiner.MineUpdate,this.updateData,this),this.closeTime(),l.default.setNodeChildDestoryByUrl(this.content,c.GlobalContext.Root+"prefab/Bag/ItemIcon"),l.default.setNodeChildDestoryByUrl(this.dispatchContent,c.GlobalContext.Root+"prefab/Mine/MineDispatchtem")},t.prototype.showCardBg=function(e){var t=e&&e.getUserData();this.bg.active=!t,this.bg.active&&this.updateCardData()},t.prototype.updateCardData=function(){var e=this;g.default.instance.loadResByType(c.GlobalContext.Root+"prefab/Mine/MineDispatchtem",cc.Prefab,function(t){e.setData(m.MineUtils.getAllCardData())},this)},t.prototype.setData=function(e){this.listViewCtrl.refreshItem=this.updateitem,this.listViewCtrl.refreshItemThis=this,this.listViewCtrl.initialize(e),this.listViewCtrl.scrollToLeft()},t.prototype.updateitem=function(e,t){var i=this.listViewCtrl.dataLsit[t];e.getComponent(C.default).updateData(i)},t.prototype.setTimeData=function(){var e=m.MineUtils.getOverTime();e<=0?this.onClose():this.strTime.getComponent(cc.RichText).string=o.default.getStr("7740",f.DateUtil.secondsToDate(Math.floor(e/1e3)))},t.prototype.updateData=function(){var e=this;this.serData=m.MineUtils.getSerMineData(),this.configData=m.MineUtils.getMineData(this.serData.type),this.onResetTitle(this.configData.mineName),this.bottomIcon.spriteFrame=T.default.instance.getSpriteFrameByName("icon_war"+this.configData.type),this.bottomName.spriteFrame=T.default.instance.getSpriteFrameByName("i18n_war"+this.configData.type),this.bg1.updateBg("resources/Mine/bg_"+this.configData.type+".png");var t=this.serData.isMine();t?this.time||(this.setTimeData(),this.time=u.default.instance.setInterval(this.setTimeData,this,1e3)):(this.str.string=o.default.getStr("7717",f.DateUtil.secondsToDate(this.configData.time)),this.item.active=!!this.serData.refreshCnt,this.item.getComponentInChildren(cc.Label).string=""+this.configData.getConsumeNum(this.serData.refreshCnt),this.closeTime()),this.group.active=!t,this.strTime.active=t,l.default.setNodeChildDestoryByUrl(this.content,c.GlobalContext.Root+"prefab/Bag/ItemIcon"),g.default.instance.loadResByType(c.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(t){var i=m.MineUtils.getRewards(e.serData);for(var n in i){var o=l.default.getNodeByUrl(t,c.GlobalContext.Root+"prefab/Bag/ItemIcon");o.setScale(1),e.content.addChild(o),o.getComponent(y.default).ItemData(i[n],!0,i[n].count+"",!0)}},this),l.default.setNodeChildDestoryByUrl(this.dispatchContent,c.GlobalContext.Root+"prefab/Mine/MineDispatchtem"),g.default.instance.loadResByType(c.GlobalContext.Root+"prefab/Mine/MineDispatchtem",cc.Prefab,function(t){for(var i=m.MineUtils.getMineCardData(),n=0;n<e.serData.cond.grid;n++){var o=l.default.getNodeByUrl(t,c.GlobalContext.Root+"prefab/Mine/MineDispatchtem");e.dispatchContent.addChild(o),o.getComponent(C.default).updateData(i[n])}},this),this.bg.active&&this.updateCardData();var i=this.serData.cond;this.lv.active=i.level>=0,this.cardQuality.active=i.quality>=0,this.attrGroup.active=i.race.length>0;var n=m.MineUtils.getNowCond();if(this.mineBtn.getComponent(cc.Button).interactable=i.grid==m.MineUtils.getMineCardData().length,i.level>=0&&(this.lv.getComponent(cc.RichText).string=o.default.getStr("774"+(n[1]>0?"8":"9"),i.level,n[1])),i.quality>=0&&(this.cardQuality.getComponentInChildren(cc.Sprite).spriteFrame=T.default.instance.getSpriteFrameByName("rarity_"+i.quality),this.cardQuality.getComponentInChildren(cc.Label).string=n[0]+"/1",this.cardQuality.getComponentInChildren(cc.Label).node.color=n[0]>=1?cc.color(104,45,9):cc.color(255,0,0),l.default.setGrayEffect(this.cardQuality,n[0]>=1)),i.race.length){var a=void 0,r=void 0,s=void 0,d=[];for(var h in this.attrGroup.children)if(a=this.attrGroup.children[h],null!=i.race[h]&&-1==d.indexOf(i.race[h])){r=i.race[h],d.push(r),s=n[2][r]?n[2][r]:0;var v=p.CommonUtil.getShowNum(i.race,r);a.active=!0,a.name=""+r,a.getComponentInChildren(cc.Sprite).spriteFrame=T.default.instance.getSpriteFrameByName("fiveLine_"+r),a.getComponentInChildren(cc.Label).string=s+"/"+v,a.getComponentInChildren(cc.Label).node.color=s>=v?cc.color(104,45,9):cc.color(255,0,0),l.default.setGrayEffect(a,s>=v)}else a.active=!1,a.name="0"}},t.prototype.closeTime=function(){u.default.instance.clearInterval(this.time),this.time=null},t.prototype.onClickSendBtn=function(e,t){switch(parseInt(t)){case 0:v.default.PurchaseItemOrRechage(_.RechargeTypeConst.Diamonds,this.configData.getConsumeNum(this.serData.refreshCnt),function(){d.default.instance.getMinereFreshReq()},this);break;case 1:this.bg.active=!1,d.default.instance.getMinestartReq();break;case 2:this.bg.active=!1;break;case 3:r.GameEventDispatcher.instance.emit(s.EventDefiner.OpenRulePage,a.WindowType.MineNews)}},__decorate([D(b.default)],t.prototype,"bg1",void 0),__decorate([D(cc.Sprite)],t.prototype,"bottomIcon",void 0),__decorate([D(cc.Sprite)],t.prototype,"bottomName",void 0),__decorate([D(cc.Node)],t.prototype,"content",void 0),__decorate([D(cc.Node)],t.prototype,"bg",void 0),__decorate([D(cc.RichText)],t.prototype,"str",void 0),__decorate([D(cc.Label)],t.prototype,"str1",void 0),__decorate([D(cc.Label)],t.prototype,"str2",void 0),__decorate([D(cc.Node)],t.prototype,"refreshBtn",void 0),__decorate([D(cc.Node)],t.prototype,"mineBtn",void 0),__decorate([D(cc.Node)],t.prototype,"item",void 0),__decorate([D(cc.Node)],t.prototype,"group",void 0),__decorate([D(cc.Node)],t.prototype,"dispatchContent",void 0),__decorate([D(cc.Node)],t.prototype,"haveContent",void 0),__decorate([D(cc.Node)],t.prototype,"cardQuality",void 0),__decorate([D(cc.Node)],t.prototype,"attrGroup",void 0),__decorate([D(cc.Node)],t.prototype,"lv",void 0),__decorate([D(cc.Node)],t.prototype,"strTime",void 0),__decorate([D(S.default)],t.prototype,"listViewCtrl",void 0),t=__decorate([w],t)}(n.default);i.default=R,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/CommonUtil":"CommonUtil","../../Util/DateUtil":"DateUtil","../../Util/RechargeConst":"RechargeConst","../../Util/RechargeUtils":"RechargeUtils","../../Util/Utils":"Utils","../Commons/CommonPageBG":"CommonPageBG","../Commons/Image":"Image","../Commons/ListViewCtrl":"ListViewCtrl","../Commons/RewardUtils":"RewardUtils","../Item/ItemIcon":"ItemIcon","./MineCtrl":"MineCtrl","./MineUtils":"MineUtils","./item/MineDispatchtem":"MineDispatchtem"}],MineSerDataVo:[function(e,t,i){"use strict";cc._RF.push(t,"86143uWx9tBCJkdzQkWkHQX","MineSerDataVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./MineSerVo"),o=e("../MineCtrl"),a=function(){function e(){this.card={},this.mine={}}return e.prototype.updateData=function(e){for(var t in e)if("mine"==t)for(var i in e.mine)this.mine[i]||(this.mine[i]=new n.MineSerVo),this.mine[i].updateData(e.mine[i]);else this[t]=e[t];var a=o.default.instance;this.ovarHelpTimes=a.helpTimes-this.helpTimes,this.ovarStealTimes=a.stealTimes-this.stealTimes,this.sortLog()},e.prototype.sortLog=function(){this.log.sort(function(e,t){return t.time-e.time})},e}();i.MineSerDataVo=a,cc._RF.pop()},{"../MineCtrl":"MineCtrl","./MineSerVo":"MineSerVo"}],MineSerFriendVo:[function(e,t,i){"use strict";cc._RF.push(t,"770b4mHyC5HZZCBZ3zV6jda","MineSerFriendVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./MineSerVo"),o=e("../MineCtrl"),a=e("../../../Core/TimeController"),r=function(){function e(){this.mine={}}return e.prototype.updateData=function(e){for(var t in e)if("mine"==t)for(var i in e.mine)this.mine[i]||(this.mine[i]=new n.MineSerVo),this.mine[i].updateData(e.mine[i]);else this[t]=e[t];this.overHelpTimes=o.default.instance.helpTimes-this.helpTimes},e.prototype.setHisToryTIme=function(){o.default.instance.helpCds[this.aid]=a.default.instance.ServerTimeMins+1e4},e.prototype.getOverTime=function(){var e=o.default.instance.helpCds[this.aid];if(!e)return 0;var t=Math.floor((e-a.default.instance.ServerTimeMins)/1e3);return t>0?t:0},e}();i.MineSerFriendVo=r,cc._RF.pop()},{"../../../Core/TimeController":"TimeController","../MineCtrl":"MineCtrl","./MineSerVo":"MineSerVo"}],MineSerVo:[function(e,t,i){"use strict";cc._RF.push(t,"aac88CkgcdF2Ij9K+HDrdCa","MineSerVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/TimeController"),o=e("../MineCtrl"),a=e("../../Role/RoleInfo"),r=function(){function e(){}return e.prototype.updateData=function(e){for(var t in e)this[t]=e[t];var i=o.default.instance;this.canSteal=this.stealCnt!=i.mineConfigAny[this.type].loss.length,this.overSpeedCnt=i.helpTimes-this.speedCnt,2==this.state?this.createTime():this.clearTime(),this.speeds||(this.speeds={})},e.prototype.createTime=function(){this.timeOut||(this.timeOut=n.default.instance.setTimeout(this.send,this,this.getOverTime()))},e.prototype.clearTime=function(){this.timeOut&&(n.default.instance.clearTimeout(this.timeOut),this.timeOut=null)},e.prototype.isCanReceive=function(){return 3==this.state},e.prototype.isMine=function(){return 2==this.state},e.prototype.getOverTime=function(){var e=this.time-n.default.instance.ServerTimeMins;return e<0?0:e},e.prototype.send=function(){o.default.instance.getMineInfoReq()},e.prototype.isCanSteal=function(){return this.canSteal&&3==this.state&&!this.steals[a.MyRoleInfo.id]},e.prototype.isCanspeeds=function(){return 2==this.state&&!this.speeds[a.MyRoleInfo.id]},e}();i.MineSerVo=r,cc._RF.pop()},{"../../../Core/TimeController":"TimeController","../../Role/RoleInfo":"RoleInfo","../MineCtrl":"MineCtrl"}],MineUtils:[function(e,t,i){"use strict";cc._RF.push(t,"2b32e6t+axEb7tiTN1h+4Rh","MineUtils"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/WindowType"),o=e("../../Core/GameEventDispatcher"),a=e("../../Core/Event"),r=e("../Functionicon/FunctionIconController"),s=e("./MineCtrl"),l=e("../Commons/RewardUtils"),c=e("../Chapter/ChapterController"),d=e("./MineConst"),p=e("./vo/MineSerFriendVo"),h=e("../WarTeam/MonsterController"),u=e("../../Util/CommonUtil"),f=function(){function e(){}return Object.defineProperty(e,"ctrl",{get:function(){return s.default.instance},enumerable:!0,configurable:!0}),e.getRed=function(){var e=this.ctrl;return!!r.default.instance.checkIsOpenbyWindowtype(n.WindowType.Mine)&&(e.openTime(),!!this.getHelpRed()||(!!this.getFriendMineRed()||(!!this.getGiftRed()||!!e.isNewLog)))},e.getHelpRed=function(){var e=this.ctrl,t=!1;for(var i in e.serData.seekHelp){t=!0;break}return t},e.getGiftRed=function(){var e=this.ctrl,t=!1;for(var i in e.serData.mine)if(e.serData.mine[i].isCanReceive()){t=!0;break}return t},e.getFriendMineRed=function(){var e,t=this.ctrl,i=t.serFriends,n=!1;if(t.serData.ovarStealTimes)for(var o in i)for(var a in e=i[o].mine)if(e[a].isCanSteal()){n=!0;break}return n},e.getRewards=function(e){var t=this.ctrl,i=c.default.instance.currentChapterId,n=this.getMineCardData(),o=this.getConfigMineData(),a=Math.floor(o.type),r=t.fixReward[a][i].awards,s=l.default.instance.getItemListByServerData(t.rewards[r]),d=t.mineConfigAny[e.type],p=l.default.instance.getItemList(d.rwId),h=100;if(1==e.state){var f=d.time/3600;f>1&&(h+=100*(f-1));var g=e.cond,y=this.getNowCond(),m=t.cond[d.type];n.length==g.grid&&(h+=m[0].percent?m[0].percent:0),g.level>=0&&y[1]>=g.level&&(h+=m[3].percent),g.quality>=0&&y[0]>=1&&(h+=m[2].percent);if(g.race.length){var C=!0;for(var v in g.race){var _=u.CommonUtil.getShowNum(g.race,g.race[v]);if(null==y[2][g.race[v]]||y[2][g.race[v]]<_){C=!1;break}}C&&(h+=m[1].percent)}h+=e.stealCnt>0?d.loss[e.stealCnt-1]/100:0}else h=e.percent;var b=h/100;return s.forEach(function(e){e.count=Math.floor(e.count*b)}),u.CommonUtil.mergeReward(s,p)},e.setMapState=function(e,t){var i=this.ctrl;i.isMyMap=e,e||(o.GameEventDispatcher.instance.emit(a.EventDefiner.MineClose),i.fid=t),o.GameEventDispatcher.instance.emit(a.EventDefiner.MineMapEntryUpdate)},e.getEarningRewards=function(e){var t=this.ctrl,i=c.default.instance.currentChapterId,n=t.rewards[t.fixReward[e][i].awards];return l.default.instance.getItemListByServerData(n)},e.getIsUnlock=function(e){var t,i=this.ctrl,n=c.default.instance.currentChapterId,o=s.default.instance.mineCondition[e].chapter;i.isMyMap?o>n&&(t=o):this.getFriendData().mine[e]||(t=o);return t},e.getFriendData=function(){var e,t=this.ctrl;for(var i in t.serFriends)if(t.serFriends[i].aid==t.fid){e=t.serFriends[i];break}if(!e)for(var i in t.seekHelps)if(t.seekHelps[i].aid==t.fid){e=t.seekHelps[i];break}return e},e.getFriendsData=function(){var e=this.ctrl,t=[];switch(e.chooseIndex){case d.MineHelpConst.Help:var i;for(var n in i=JSON.parse(JSON.stringify(e.serFriends)).sort(function(e,t){return e.online&&t.online?t.overHelpTimes-e.overHelpTimes:e.online&&e.overHelpTimes?-1:t.online&&t.overHelpTimes?1:void 0})){var o=new p.MineSerFriendVo;o.updateData(i[n]),t.push(o)}break;case d.MineHelpConst.Go:t=e.serData.seekHelp;break;case d.MineHelpConst.Steal:var a=e.serFriends,r=void 0;for(var n in a)for(var s in r=a[n].mine)if(r[s].isCanSteal()){t.push(a[n]);break}}return t},e.getMineData=function(e){return this.ctrl.mineConfigAny[e]},e.getConfigMineData=function(){this.ctrl;return this.getMineData(this.getSerMineData().type)},e.getSerMineData=function(){var e=this.ctrl;return e.serData.mine[e.index]},e.getMineCardData=function(){var e=this.ctrl,t=[];for(var i in e.serData.card)e.serData.card[i]==e.index&&t.push(h.default.instance.GetMonsterData(parseInt(i)));return t},e.isMine=function(){var e=this.ctrl;return 2==e.serData.mine[e.index].state},e.getAllCardData=function(){var e=this.ctrl,t=[],i=h.MonsterType.MonsterCardArr;for(var n in i)null==e.serData.card[i[n].id]&&t.push(this.getCardCond(i[n]));return t=t.sort(function(e,t){return e.condNum&&t.condNum&&e.condNum==t.condNum?h.default.instance.GetMonsterInfo(t.id).rarity-h.default.instance.GetMonsterInfo(e.id).rarity:e.condNum&&t.condNum?t.condNum-e.condNum:e.condNum&&!t.condNum?-1:!e.condNum&&t.condNum?1:h.default.instance.GetMonsterInfo(t.id).rarity-h.default.instance.GetMonsterInfo(e.id).rarity})},e.getOverTime=function(){var e=this.ctrl;return e.serData.mine[e.index].getOverTime()},e.getCardCond=function(t){this.ctrl;var i,n,o,a=e.getSerMineData().cond,r={};i=[0,0,{}],r[0]=i[0],r[1]=i[1],r[2]=i[2],n=h.default.instance.GetMonsterInfo(t.id),a.level>=0&&t.level>=a.level&&r[1]++,a.quality<=n.rarity&&r[0]++,-1!==(o=a.race.indexOf(n.fiveLineAttributes))&&(r[2][a.race[o]]||(r[2][a.race[o]]=0),r[2][a.race[o]]++);var s=0,l=[r[0]>=1,r[1]>=1,"{}"!=JSON.stringify(r[2])];for(var c in l)l[c]&&s++;return t.condNum=s,t},e.getNowCond=function(){this.ctrl;var t,i,n,o=e.getSerMineData().cond,a=this.getMineCardData(),r={};for(var s in t=[0,0,{}],r[0]=t[0],r[1]=t[1],r[2]=t[2],a)i=h.default.instance.GetMonsterInfo(a[s].id),o.level>=0&&a[s].level>=o.level&&(r[1]||(r[1]=0),r[1]++),o.quality<=i.rarity&&(r[0]||(r[0]=0),r[0]++),-1!==(n=o.race.indexOf(i.fiveLineAttributes))&&(r[2]||(r[2]={}),r[2][o.race[n]]||(r[2][o.race[n]]=0),r[2][o.race[n]]++);return r},e.getMapData=function(){var e=this.ctrl;return e.isMyMap?e.serData.mine:this.getFriendData().mine},e}();i.MineUtils=f,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/WindowType":"WindowType","../../Util/CommonUtil":"CommonUtil","../Chapter/ChapterController":"ChapterController","../Commons/RewardUtils":"RewardUtils","../Functionicon/FunctionIconController":"FunctionIconController","../WarTeam/MonsterController":"MonsterController","./MineConst":"MineConst","./MineCtrl":"MineCtrl","./vo/MineSerFriendVo":"MineSerFriendVo"}],MineVo:[function(e,t,i){"use strict";cc._RF.push(t,"f6e2cV+qoVMRKxRTQedl246","MineVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e){for(var t in e)this[t]=e[t]}return e.prototype.getConsumeNum=function(e){return this.refresh.length>e?this.refresh[e]:this.refresh[this.refresh.length-1]},e}();i.MineVo=n,cc._RF.pop()},{}],MineWin:[function(e,t,i){"use strict";cc._RF.push(t,"47ac71zwZJLBL91QLb6C0w1","MineWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../../Core/Language"),a=e("../../Core/GameEventDispatcher"),r=e("../../Core/Event"),s=e("../OpenWin/OpenWinController"),l=e("../../Core/WindowType"),c=e("../../GlobalContext"),d=e("../../Util/Utils"),p=e("./MineCtrl"),h=e("./MineUtils"),u=e("./MineConst"),f=e("../../Util/CommonUtil"),g=e("../../Core/LoadManager"),y=e("./item/MineItem"),m=e("../Gamelayer/Interface/EventInterface"),C=e("../Chat/ChatController"),v=e("../Status/StatusType"),_=cc._decorator,b=_.ccclass,T=_.property,S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.friendBg=null,t.friendStr=null,t.btn=null,t.bottomLeft=null,t.journalBtn=null,t.interactiveBtn=null,t.benefit=null,t.warContent=null,t.toggle=null,t.str1=null,t.pos=[cc.v2(-335.8,-7.3),cc.v2(-171.4,-109.1),cc.v2(-10.7,-197.9),cc.v2(-148,93.6),cc.v2(13.6,1.1),cc.v2(173.4,-97),cc.v2(22.1,190.8),cc.v2(182.8,95.5),cc.v2(344.4,-2.6)],t}return __extends(t,e),t.prototype.onLoad=function(){this.node.width=c.GlobalContext.StageWidth,this.node.height=c.GlobalContext.StageHeight,this.onInit(l.WindowType.Mine,!0);var t=h.MineUtils.getEarningRewards(p.default.instance.qualityIndex);for(var i in this.benefit.children)f.CommonUtil.setClickEvent(this.node,this.benefit.children[i].getChildByName("icon"),t[i].id,.5);e.prototype.onLoad.call(this)},t.prototype.show=function(){var t=this;e.prototype.show.call(this),a.GameEventDispatcher.instance.on(r.EventDefiner.MineUpdate,this.updateData,this),a.GameEventDispatcher.instance.on(r.EventDefiner.MineMapEntryUpdate,this.updateMap,this),a.GameEventDispatcher.instance.on(r.EventDefiner.MineFriendsUpdate,this.updateData,this),p.default.instance.isMyMap=!0,this.warContent.childrenCount||g.default.instance.loadResByType(c.GlobalContext.Root+"prefab/Mine/MineItem",cc.Prefab,function(e){for(var i=0;i<9;i++){var n=d.default.getNodeByUrl(e,c.GlobalContext.Root+"prefab/Mine/MineItem");n.getComponent(y.default).initData(i),n.position=t.pos[i],t.warContent.addChild(n)}t.updateData()},this),this.toggle.toggleItems[p.default.instance.qualityIndex-1].isChecked=!0,this.updateMap(),this.updateBottomLeft(),p.default.instance.getMineInfoReq()},t.prototype.updateMap=function(){var e=p.default.instance.isMyMap;this.btn.active=this.bottomLeft.active=e,this.friendBg.active=!e,this.setWindowTitle("i18n_"+(e?"":"my")+"mine"),e||(this.friendStr.string=o.default.getStr("7756",h.MineUtils.getFriendData().info.name)),this.updateData()},t.prototype.updateData=function(){if(this.warContent.children.length)for(var e=h.MineUtils.getMapData(),t=0;t<9;t++)this.warContent.children[t].getComponent(y.default).updateData(e[t]);this.interactiveBtn.getComponentInChildren(cc.Sprite).node.active=h.MineUtils.getHelpRed()||h.MineUtils.getFriendMineRed(),this.journalBtn.getComponentInChildren(cc.Sprite).node.active=p.default.instance.isNewLog},t.prototype.hide=function(){e.prototype.hide.call(this),a.GameEventDispatcher.instance.off(r.EventDefiner.MineUpdate,this.updateData,this),a.GameEventDispatcher.instance.off(r.EventDefiner.MineMapEntryUpdate,this.updateMap,this),a.GameEventDispatcher.instance.off(r.EventDefiner.MineFriendsUpdate,this.updateData,this),d.default.setNodeChildDestoryByUrl(this.warContent,c.GlobalContext.Root+"prefab/Mine/MineItem")},t.prototype.onClickSendBtn=function(e,t){switch(parseInt(t)){case u.MineBtnConst.Journal:p.default.instance.isNewLog&&(p.default.instance.isNewLog=!1,this.journalBtn.getComponentInChildren(cc.Sprite).node.active=!1,a.GameEventDispatcher.instance.emit(m.EventInterface.MineRed,h.MineUtils.getRed())),s.default.instance.openWindow(l.WindowType.MineJournal);break;case u.MineBtnConst.Interactive:s.default.instance.openWindow(l.WindowType.MineInteractive);break;case u.MineBtnConst.Return:h.MineUtils.setMapState(!0)}},t.prototype.updateBottomLeft=function(){var e=p.default.instance.qualityIndex,t=p.default.instance.oreBag[p.default.instance.qualityIndex-1];this.str1.string=o.default.getStr("7704",t);var i=h.MineUtils.getEarningRewards(e);for(var n in this.benefit.children)this.benefit.children[n].getComponentInChildren(cc.RichText).string=o.default.getStr("7705",i[n].count)},t.prototype.onClickToggle=function(e){var t=parseInt(e.target.name);null!=t&&t==p.default.instance.qualityIndex||(p.default.instance.qualityIndex=t,this.updateBottomLeft())},t.prototype.close=function(){if(p.default.instance.isMyMap)a.GameEventDispatcher.instance.emit(r.EventDefiner.ChangeActivityStatus,v.ActivityStatus.NoActivity),p.default.instance.openTime(),e.prototype.close.call(this);else{if(p.default.instance.interactiveType==u.MineHelpConst.Go){C.default.instance.getFridinfobyId(p.default.instance.fid);p.default.instance.getMineIgnoreHelpReq(p.default.instance.fid)}this.onClickSendBtn(null,"2")}},__decorate([T(cc.Node)],t.prototype,"friendBg",void 0),__decorate([T(cc.RichText)],t.prototype,"friendStr",void 0),__decorate([T(cc.Node)],t.prototype,"btn",void 0),__decorate([T(cc.Node)],t.prototype,"bottomLeft",void 0),__decorate([T(cc.Node)],t.prototype,"journalBtn",void 0),__decorate([T(cc.Node)],t.prototype,"interactiveBtn",void 0),__decorate([T(cc.Node)],t.prototype,"benefit",void 0),__decorate([T(cc.Node)],t.prototype,"warContent",void 0),__decorate([T(cc.ToggleContainer)],t.prototype,"toggle",void 0),__decorate([T(cc.RichText)],t.prototype,"str1",void 0),t=__decorate([b],t)}(n.default);i.default=S,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/Window":"Window","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/CommonUtil":"CommonUtil","../../Util/Utils":"Utils","../Chat/ChatController":"ChatController","../Gamelayer/Interface/EventInterface":"EventInterface","../OpenWin/OpenWinController":"OpenWinController","../Status/StatusType":"StatusType","./MineConst":"MineConst","./MineCtrl":"MineCtrl","./MineUtils":"MineUtils","./item/MineItem":"MineItem"}],MoneyEffect:[function(e,t,i){"use strict";cc._RF.push(t,"f87e1WGzo5JQJIOZFyN5FuQ","MoneyEffect"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../Util/Utils"),a=e("../../Core/WindowType"),r=e("../../Util/Parabola"),s=cc._decorator,l=s.ccclass,c=s.property,d=function(e){function t(){var t=e.call(this)||this;return t.Container=null,t.CoinItem=null,t.GoldItem=null,t.GuardItem=null,t.PowerItem=null,t._ConfirmBtnClickCallback=null,t._ConfirmBtnClickCallbackThisObj=null,t._ConfirmBtnClickCallbackParam=null,t._CurrentItemType=0,i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.PlayEffect=function(e,t){void 0===t&&(t=null),this.ClearItemAll(),1==e?(this._CurrentItemType=a.PoolType.MoneyEffectCoinItem,this.AddItemList(20,this.CoinItem)):2==e?(this._CurrentItemType=a.PoolType.MoneyEffectGoldItem,this.AddItemList(20,this.GoldItem)):3==e?(this._CurrentItemType=a.PoolType.MoneyEffectGuardItem,this.AddItemList(1,this.GuardItem,new cc.Vec2(-130,380),t)):4==e&&(this._CurrentItemType=a.PoolType.MoneyEffectPowerItem,this.AddItemList(20,this.PowerItem))},t.prototype.AddItemList=function(e,t,i,n){var a=this;void 0===i&&(i=null),void 0===n&&(n=null);for(var s=function(e){var s=o.default.getNodeByPool(l._CurrentItemType,t);if(l.Container.addChild(s),n||(n=new cc.Vec2(0,100)),s.setPosition(n),i)s.runAction(cc.sequence(cc.delayTime(.5),cc.spawn(cc.moveTo(.5,i),cc.scaleTo(.5,.7)),cc.callFunc(function(){o.default.setNodeToPool(a._CurrentItemType,s)},l)));else{var c=s.getComponent(r.default);c.onCompleteCallback=l.ClearItem,c.onCompleteCallbackThisObj=l,c.onCompleteCallbackParam=[s];var d=new cc.Vec2,p=new cc.Vec2;p.x=e%2==0?-o.default.RandomBy(20,200):o.default.RandomBy(20,200),d.x=p.x/2,d.y=o.default.RandomBy(20,2e3),p.y=-o.default.RandomBy(20,2e3),c.MoveByCount(d,p,60,!0)}},l=this,c=0;c<e;c++)s(c)},t.prototype.ClearItem=function(e){e.getComponent(r.default).clear(),o.default.setNodeToPool(this._CurrentItemType,e)},t.prototype.ClearItemAll=function(){for(var e=this.Container.childrenCount-1;e>=0;e--){var t=this.Container.children[e];t.getComponent(r.default).clear(),o.default.setNodeToPool(this._CurrentItemType,t)}},t.instance=null,__decorate([c(cc.Node)],t.prototype,"Container",void 0),__decorate([c(cc.Node)],t.prototype,"CoinItem",void 0),__decorate([c(cc.Node)],t.prototype,"GoldItem",void 0),__decorate([c(cc.Node)],t.prototype,"GuardItem",void 0),__decorate([c(cc.Node)],t.prototype,"PowerItem",void 0),t=i=__decorate([l],t)}(n.default);i.default=d,cc._RF.pop()},{"../../Core/Controller":"Controller","../../Core/WindowType":"WindowType","../../Util/Parabola":"Parabola","../../Util/Utils":"Utils"}],MonsterCard:[function(e,t,i){"use strict";cc._RF.push(t,"298de9NRudF748Iqzk3No/w","MonsterCard"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./WarTeam"),o=e("../../Core/Widget"),a=e("./MonsterController"),r=e("../Item/ItemModel"),s=e("../Commons/MonsterPreview"),l=e("../../Core/WindowType"),c=e("../../Util/Utils"),d=e("../../Core/ConfigsManager"),p=e("../../Core/Language"),h=e("../../Core/GameEventDispatcher"),u=e("../../Core/CommonsResManager"),f=e("../Functionicon/FunctionIconController"),g=e("../Equip/equip/EquipCtrl"),y=e("../../Core/Event"),m=e("../Ornament/OrnamentCtrl"),C=e("../Gamelayer/Interface/EventInterface"),v=e("../Totems/TotemsUtils"),_=e("../../Global/GlobalValue"),b=cc._decorator,T=b.ccclass,S=b.property,I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.stance=null,t.isCard=null,t.isLineup=null,t.cardId=null,t.cardData=null,t.read=null,t.info=null,t.upgrades=null,t.fight=null,t.fightBg=null,t.bool=!1,t.choice=!1,t._cardConfigs=null,t.etimeLick=!1,t.touchPos=null,t.touchTime=1,t.touchLick=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this._cardConfigs=d.ConfigsManager.instance.getConfigs("cardConf")},t.prototype.show=function(){e.prototype.show.call(this),h.GameEventDispatcher.instance.on(y.EventDefiner.Card_updataCardInfo,this.updataCardInfo,this),h.GameEventDispatcher.instance.on(y.EventDefiner.itemchangeUP,this.upRed,this)},t.prototype.hide=function(){e.prototype.hide.call(this),h.GameEventDispatcher.instance.off(y.EventDefiner.Card_updataCardInfo,this.updataCardInfo,this),h.GameEventDispatcher.instance.off(y.EventDefiner.itemchangeUP,this.upRed,this)},t.prototype.isCollision=function(e,t,i,n,o,a){return e>=i&&e<=i+o&&t>=n&&t<=n+a},t.prototype.setTouchTime=function(){this.touchTime-=.2,this.touchTime<=0&&(cc.find("CardLayer",n.default.instance.node).children[0]||(cc.find("MonsterCardLayer/ScrollView",n.default.instance.node).getComponent(cc.ScrollView).vertical=!1,n.default.instance.openMonsterCardPrefab(cc.find("CardLayer",n.default.instance.node),this.cardId),cc.find("CardLayer",n.default.instance.node).children[0].setPosition(this.touchPos),cc.find("CardLayer",n.default.instance.node).children[0].opacity=155,n.default.instance.cancelLineup(!0),this.etimeLick&&(this.etimeLick=!1,this.unschedule(this.setTouchTime))))},t.prototype.setZindex=function(e){this.node.zIndex=e},t.prototype.initInfo=function(e){this.node.name="MonsterCard"+e,this.cardId=e;var t=this._cardConfigs.Card[this.cardId].rarity,i=this._cardConfigs.Card[this.cardId].fiveLineAttributes,o=a.default.instance,r=o.getIsMonsterCard(this.cardId);this.node.getChildByName("SwitchNode").getChildByName("di9").active=!r,r?this.Infomantion():(this.info.active=!1,this.hideFight());for(var d=cc.find("SwitchNode/OneLayer/maskNode/Monsterpic",this.node).childrenCount-1;d>=0;d--){cc.find("SwitchNode/OneLayer/maskNode/Monsterpic",this.node).children[d].getComponent(s.default).clear(),c.default.setNodeToPool(l.PoolType.MonsterPreview,cc.find("SwitchNode/OneLayer/maskNode/Monsterpic",this.node).children[d])}cc.find("SwitchNode/OneLayer/MonsterBg",this.node).getComponent(cc.Sprite).spriteFrame=n.default.instance.cardAtlas.getSpriteFrame("di_"+t),cc.find("SwitchNode/OneLayer/bg",this.node).getComponent(cc.Sprite).spriteFrame=n.default.instance.cardAtlas.getSpriteFrame("di_0"+t),cc.find("SwitchNode/OneLayer/MonsterRarity",this.node).getComponent(cc.Sprite).spriteFrame=u.default.instance.getSpriteFrameByName("rarity_"+t),cc.find("SwitchNode/OneLayer/MonsterFiveLine",this.node).getComponent(cc.Sprite).spriteFrame=u.default.instance.getSpriteFrameByName("series"+i),this.setToUpdateInfo();var p=o.getIsMonsterCard(this.cardId);o.infoPreview(cc.find("SwitchNode/OneLayer/maskNode/Monsterpic",this.node),cc.v2(0,0),this.cardId,5,.4,-1,p),this.upShow()},t.prototype.setUpgradesSp=function(e){for(var t=1;t<=3;t++)t<3?(cc.find("SwitchNode/OneLayer/Upgrades/di/sp"+t,this.node).active=e==t,cc.find("SwitchNode/OneLayer/Upgrades/tu/sp"+t,this.node).active=e==t):cc.find("SwitchNode/OneLayer/Upgrades/di/sp"+t,this.node).active=e==t},t.prototype.setToUpdateInfo=function(){var e=a.default.instance,t=e.getIsLineupArr(this.cardId);this.isLineup=e.getIsArrLineup(this.cardId),this.isCard=e.getIsMonsterCard(this.cardId),this.stance=this._cardConfigs.Card[this.cardId].cardType,n.default.instance.clickRightChane&&(n.default.instance.LineupCardId==this.cardId?this.hideMask():this.showMask()),h.GameEventDispatcher.instance.emit("CARDRED",this);var i=e.GetMonsterData(this.cardId),o=r.default.getCountByid(this._cardConfigs.Card[this.cardId].pieceId);if(i&&i.level){cc.find("SwitchNode/OneLayer/btnCompound",this.node).active=!1,cc.find("SwitchNode/OneLayer/Upgrades",this.node).active=!0;var s=e.cardStageData.getCardMaxLevel(this.cardId),l=i.level?i.level:0;if(l>0){var c=g.default.instance.data.getEquipEffectAddAttr(this.cardId);l=s<(l+=c[_.AttrType.CardLevel]?c[_.AttrType.CardLevel]:0)?s:l}cc.find("SwitchNode/OneLayer/MonsterLevel",this.node).getComponent(cc.Label).string=l+"";var d=e.data.getFiveLineAttributes(this.cardId),u=e.cardStageData.getlineFive(d,i.level);if(u){var f=o>=(y=u.pieceNum);cc.find("SwitchNode/OneLayer/Upgrades/value",this.node).getComponent(cc.Label).string=o+"/"+y,f?(cc.find("SwitchNode/OneLayer/Upgrades/di/sp2",this.node).width=cc.find("SwitchNode/OneLayer/Upgrades/di",this.node).width*(o/y>=1?1:o/y),this.setUpgradesSp(2)):(cc.find("SwitchNode/OneLayer/Upgrades/di/sp1",this.node).width=cc.find("SwitchNode/OneLayer/Upgrades/di",this.node).width*(o/y>=1?1:o/y),this.setUpgradesSp(1))}else cc.find("SwitchNode/OneLayer/Upgrades/value",this.node).getComponent(cc.Label).string=p.default.getStr("MAX"),this.setUpgradesSp(3)}else{f=o>=(y=this._cardConfigs.Card[this.cardId].pieceNum);var y,m=cc.find("SwitchNode/OneLayer/Upgrades/value",this.node).getComponent(cc.Label);y>0?m.string=o+"/"+y:(m.string=p.default.getStr("warteamcondition"+-y),f=!1),cc.find("SwitchNode/OneLayer/MonsterLevel",this.node).getComponent(cc.Label).string="0",f?(cc.find("SwitchNode/OneLayer/btnCompound",this.node).active=!0,cc.find("SwitchNode/OneLayer/Upgrades",this.node).active=!1):(cc.find("SwitchNode/OneLayer/Upgrades/di/sp1",this.node).width=cc.find("SwitchNode/OneLayer/Upgrades/di",this.node).width*o/this._cardConfigs.Card[this.cardId].pieceNum,this.setUpgradesSp(4))}for(var C=this.node.getChildByName("SwitchNode").getChildByName("OneLayer"),v=0;v<3;v++){var b=this.stance-1==v;cc.find("SwitchNode/OneLayer/MonsterType",this.node).children[v].active=b}C.getChildByName("MonsterFight").active=t[a.MonsterType.MonsterBattle],this.bool=0==this.read.active,this.fight.getChildByName("fit").getComponent(cc.Label).string=i?e.getCarFight(this.cardId,i.level,e.data.defaultGrade,!0,null,!1)+"":"0",this.read.active=this.redPointFlag()},t.prototype.btn_Compound=function(){a.default.instance.SendCardUpgrade(this.cardId)},t.prototype.updataCardInfo=function(){console.log("\u5237\u65b0\u754c\u9762"),cc.find("SwitchNode/OneLayer/btnCompound",this.node).active=!1,cc.find("SwitchNode/OneLayer/Upgrades",this.node).active=!0,this.upRed()},t.prototype.Infomantion=function(){a.default.instance.getIsMonsterCard(this.cardId)&&(n.default.instance.cheakInfo()?n.default.instance.inChange?this.choice?(this.info.active=!0,this.showFight()):n.default.instance.inLeftChoice?(this.info.active=!0,this.showFight()):(this.info.active=!1,this.hideFight()):(this.info.active=!0,this.showFight()):n.default.instance.inChange?this.choice?(this.info.active=!1,this.showFight()):n.default.instance.inLeftChoice?(this.info.active=!1,this.showFight()):(this.info.active=!1,this.hideFight()):(this.info.active=!1,this.hideFight()))},t.prototype.showFight=function(){this.upgrades.active=!1,this.fight.active=!0,this.fightBg.active=!0},t.prototype.hideFight=function(){this.upgrades.active=!0,this.fight.active=!1,this.fightBg.active=!1},t.prototype.showEffect=function(){var e=this.node.getChildByName("effect");e.active=!0,e.stopAllActions(),e.runAction(cc.repeatForever(cc.sequence(cc.fadeOut(1),cc.fadeIn(1))))},t.prototype.stopEffect=function(){var e=this.node.getChildByName("effect");e.active=!1,e.stopAllActions()},t.prototype.showMask=function(){cc.find("mask",this.node).active=!0},t.prototype.hideMask=function(){cc.find("mask",this.node).active=!1},t.prototype.btn_infoTwoLayer=function(){if(!n.default.instance.clickRightChane)if(a.default.instance.getIsMonsterCard(this.cardId)){if(n.default.instance.inLeftChoice){var e=n.default.instance.changeConfig;return n.default.instance.changeConfig=null,n.default.instance.LineupCardId=this.cardId,n.default.instance.newLineup(e),void n.default.instance.setSelectChange()}cc.find("SwitchNode/OneLayer/Upgrades",this.node).active=!0,n.default.instance.Bagscorllview(null),n.default.instance.ContentTop.active=!0,n.default.instance.ContentTop.zIndex=n.default.instance.ContentTop.childrenCount+1,n.default.instance.ContentTop.setSiblingIndex(n.default.instance.ContentTop.childrenCount+1),n.default.instance.ContentTop.children[0].setPosition(this.node.x,this.node.y-145),n.default.instance.ContentTop.children[0].getChildByName("btnLayer").active=!0,n.default.instance.ContentTop.children[0].active=!0,n.default.instance.ContentTop.children[0].getComponent("CardInfo").initInfo(this.cardId);for(var t=0;t<n.default.instance.ContentTop.parent.children.length;t++){var i=n.default.instance.ContentTop.parent.children[t];i&&i.getComponent("MonsterCard")&&i.getComponent("MonsterCard").cardId!=this.cardId&&i.getComponent("MonsterCard").cancelInfo()}1==n.default.instance.clickRed()?(f.default.instance.FuncIconRedDeal(l.WindowType.WarTeam,!0),h.GameEventDispatcher.instance.emit(C.EventInterface.CombatteamRed,!0)):(f.default.instance.FuncIconRedDeal(l.WindowType.WarTeam,!1),h.GameEventDispatcher.instance.emit(C.EventInterface.CombatteamRed,!1))}else a.default.instance.openMonsterInfoPrefab(this.cardId,this.stance)},t.prototype.close=function(){this.node.destroy(),h.GameEventDispatcher.instance.on(y.EventDefiner.Card_updataCardInfo,this.updataCardInfo,this)},t.prototype.cancelInfo=function(){cc.find("SwitchNode/OneLayer/Upgrades",this.node).active=!0},t.prototype.redPointFlag=function(){var e=a.default.instance;return!(!e.getIsLineup(this.cardId)||!(e.data.getCardUPlevFlag(this.cardId)||e.data.getCardUpSkillFlag(this.cardId)||g.default.instance.data.getEquipFlag(this.cardId)||g.default.instance.data.getEquipWearFlag(this.cardId)||m.default.instance.data.getCardOrnamentFlag(this.cardId)))},t.prototype.upRed=function(){this.read.active=this.redPointFlag()},t.prototype.update=function(){},t.prototype.upShow=function(){var e=a.default.instance;this.cardData||(this.cardData=e.data);var t=e.GetMonsterData(this.cardId),i=e.getIsMonsterCard(this.cardId),n=e.getAttrPrecentByGradeAndType(e.data.defaultGrade,this.equipData(this.cardId)),o=i?e.getAttrPrecentByGradeAndType(e.data.defaultGrade,e.cardGroupData.getAllCardGroupAttr()):null,r=e.getCardConfCardType(this.cardId),s=i?e.getAttrPrecentByGradeAndType(e.data.defaultGrade,v.TotemsUtils.getCardIdAttr(r)):null,l=i?e.getAttrPrecentByGradeAndType(e.data.defaultGrade,c.default.getCardBaseAttr(this.cardId,t.level)):null,d=i?e.cardStageData.getCardPotentialAttr(this.cardId,t.level):null;d=e.getAttrPrecentByGradeAndType(e.data.defaultGrade,d);for(var p=i?e.getAttrPrecentByGradeAndType(e.data.defaultGrade,m.default.instance.data.getWearOrnamentAttr(this.cardId,r)):null,h=e.getIsArrLineup(this.cardId),u=i?e.getAttrPrecentByGradeAndType(e.data.defaultGrade,e.cardStageData.getCardPotential(this.cardId)):null,f=this.info.children,g=0;g<3;g++){var y=c.default.getVal(d,g);h&&(y+=c.default.getVal(u,g)),f[g].children[0].getComponent(cc.Label).string=c.default.getVal(l,g)+c.default.getVal(n,g)+c.default.getVal(o,g)+c.default.getVal(s,g)+c.default.getVal(p,g)+y+""}},t.prototype.equipData=function(e){var t=a.default.instance.GetMonsterData(e),i=[0,0,0,0,0,0,0];if(t&&t.equip&&0!=t.equip.length){var n=g.default.instance.data.getEquipList(e),o=g.default.instance.data.getEequipWearAttr(n);for(var r in i)o[r]&&(i[r]=i[r]+o[r]);return i}return i},__decorate([S(cc.Node)],t.prototype,"read",void 0),__decorate([S(cc.Node)],t.prototype,"info",void 0),__decorate([S(cc.Node)],t.prototype,"upgrades",void 0),__decorate([S(cc.Node)],t.prototype,"fight",void 0),__decorate([S(cc.Node)],t.prototype,"fightBg",void 0),t=__decorate([T],t)}(o.default);i.default=I,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/ConfigsManager":"ConfigsManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../Util/Utils":"Utils","../Commons/MonsterPreview":"MonsterPreview","../Equip/equip/EquipCtrl":"EquipCtrl","../Functionicon/FunctionIconController":"FunctionIconController","../Gamelayer/Interface/EventInterface":"EventInterface","../Item/ItemModel":"ItemModel","../Ornament/OrnamentCtrl":"OrnamentCtrl","../Totems/TotemsUtils":"TotemsUtils","./MonsterController":"MonsterController","./WarTeam":"WarTeam"}],MonsterController:[function(e,t,i){"use strict";cc._RF.push(t,"49327smKqJL3rGx27qaRC6g","MonsterController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../Fight/staticattr"),a=e("./CardData"),r=e("../../Core/ConfigsManager"),s=e("../../Core/GameEventDispatcher"),l=e("../../Core/Event"),c=e("../Scene/Prop/EntityProperty"),d=e("../Scene/Controller/SkillController"),p=e("../Status/StatusType"),h=e("../../Util/UtilsFight"),u=e("./vo/ServerMonsterVo"),f=e("../../NetConnect/NetConnet"),g=e("../../Global/GlobalValue"),y=e("../../Core/LoadManager"),m=e("../Chapter/ChapterController"),C=e("../OpenWin/OpenWinController"),v=e("../../Core/WindowType"),_=e("../Commons/WindowOpenUtils"),b=e("../../Core/WindowManager"),T=e("../Scene/Upgrading/CardSynthesis"),S=e("../Scene/Upgrading/CardSynthesisEnd"),I=e("../Scene/Controller/SceneController"),w=e("../PlotWin/PlotController"),D=e("../Guide/GuideNewController"),R=e("../Equip/equip/EquipCtrl"),A=e("../Item/ItemController"),N=e("./WarTeamMonsterInfo"),L=e("../../Util/Utils"),E=e("../Commons/MonsterPreview"),B=e("../Functionicon/FunctionIconController"),M=e("../Gamelayer/Interface/EventInterface"),x=e("../Ornament/OrnamentCtrl"),k=e("../../Core/Const/EntityType"),P=e("./CardStage/CardStageData"),G=e("./CardSkill/CardSkillData"),F=e("../../GlobalContext"),W=e("./CardGroup/CardGroupData"),U=e("../Status/StatusController"),O=cc._decorator,V=O.ccclass,q=O.property,H=function(e){function t(){var t=e.call(this)||this;return t.MonsterPreview=null,t._cardSortByFight=[],t._carindividualityDic=null,t.infoList=[],t.staticattr=null,t._cardData=null,t._cardStageData=null,t._cardSkillData=null,t._cardGroupData=null,t._attributeconf=null,t.ForingAutoAddFlag=!0,t.experienceConfig={},t.deleteCardId=null,t.startCardId=null,t.baseNews={},t.chapterNews={},t._cardConfigs=null,t.cardInfoId=null,t.isShowInfo=!1,i.instance=t,t.infoList=[],t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this._cardData=new a.default,this._cardData.initCfg(),this.staticattr=new o.StaticAttr,this._cardConfigs=this._cardData.getCardCfg(),this._attributeconf=r.ConfigsManager.instance.getConfigs("attributeconf");var t,i=this._cardConfigs.Card;for(var n in i)(t=i[n].experience)&&(this.experienceConfig[t[1]]={},this.experienceConfig[t[1]][t[2]]={id:i[n].id,guideId:t[0]});console.log("this.experienceConfig",this.experienceConfig);var s=r.ConfigsManager.instance.getConfigs("cardRemmendconf");this.baseNews=s.baseNews,this.chapterNews=s.chapter},t.prototype.start=function(){s.GameEventDispatcher.instance.on("CARDRED",this.warTeamRed,this),s.GameEventDispatcher.instance.on(l.EventDefiner.CardActive,this.checkShowActiveCar,this),s.GameEventDispatcher.instance.on(l.EventDefiner.itemchangeUP,this.warTeamRed,this),s.GameEventDispatcher.instance.on(l.EventDefiner.LevelChange,this.warTeamRed,this),s.GameEventDispatcher.instance.on(l.EventDefiner.Card_updataCardInfo,this.isCardRemmcondHide,this)},t.prototype.listNotification=function(){this.addProto("card",this.SetMonsterData,this),this.addProto("cardinfo",this.SetCardInfo,this),this.addProto("delcards",this.delcardsEnd,this),this.addProto("chapterfirstpass",this.setChapterfirstpassData,this),this.addProto(l.EventDefiner.onekeyreplace,this.resOnekeyreplace,this),this.addProto(l.EventDefiner.cardinherit,this.resCardInherit,this)},t.prototype.setChapterfirstpassData=function(e){var t=e.data,i=m.default.instance.currentChapterId,n=m.default.instance.currentGuanqiaId;this.firstPass=t.firstPass[i]?t.firstPass[i][n]:null,this.lowestFight=t.lowestFight[i]?t.lowestFight[i][n]:null,_.default.instance.openWindowType(v.WindowType.CardRecommendOfficial)},t.prototype.chapterfirstpassReq=function(){f.default.instance.sendProto({cmd:"chapterfirstpass"})},t.prototype.delcardsEnd=function(e){var t=e.cards;for(var i in this.deleteCardId=t[0],j.MonsterWarTeam=e.config,t)delete j.MonsterCardArr[t[i]];this.setMaxSkillLevel(),this.setMaxLevel(),this.warTeamRed(),this.cardGroupData.cardGroupAttrCptFlag=!1},Object.defineProperty(t.prototype,"data",{get:function(){return this._cardData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cardStageData",{get:function(){return this._cardStageData||(this._cardStageData=new P.default),this._cardStageData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CardSkillData",{get:function(){return this._cardSkillData||(this._cardSkillData=new G.default),this._cardSkillData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cardGroupData",{get:function(){return this._cardGroupData||(this._cardGroupData=new W.default),this._cardGroupData},enumerable:!0,configurable:!0}),t.prototype.getCarFight=function(e,t,i,n,o,a){return void 0===n&&(n=!0),void 0===a&&(a=!0),this.getCardAttr(e,t,i,n,o,null,a).GetFight()},t.prototype.getCardAttr=function(e,t,i,n,o,a,r){void 0===n&&(n=!0),void 0===a&&(a=null),void 0===r&&(r=!1),this.staticattr.Reset();var s=new c.EntityProperty;s.cardid=e,s.grade=i,s.cultivateLv=t,s.selfMonster=n;var l,u=[];if(l=d.default.instance.getSkills(s),n&&U.default.instance.isSingle){var f=R.default.instance.data.getEquipEffectAddAttr(e);for(var y in t=(f[g.AttrType.CardLevel]?f[g.AttrType.CardLevel]:0)+t,s.cultivateLv=t,l)l[y].skilllv+=f[100*l[y].skillId]?f[100*l[y].skillId]:0;for(var m=0,C=g.AttrType.SkillOne;C<=g.AttrType.SkillThree;++C)f[C]&&(l[m].skilllv+=f[C]?f[C]:0),m+=1}return a?(a.PushCard(e,t,i,1,l,u),s.attr=a):(s.attr=this.staticattr,this.staticattr.PushCard(e,t,i,1,l,u)),n&&p.ActivityStatus.value!=p.ActivityStatus.Arena&&h.default.addPropAttr(s,r),s.attr},t.prototype.getCarHp=function(e,t,n){this.staticattr.Reset(),this.staticattr.PushCard(e,t,n);var o=i.instance.cardGroupData.getAllCardGroupAttr();for(var a in o)this.staticattr.Push(parseInt(a),o[a]);return this.staticattr.hp},t.prototype.GetMonsterData=function(e){for(var t in j.MonsterCardArr)if(j.MonsterCardArr[t].id==e)return j.MonsterCardArr[t];return null},t.prototype.getCurBattleInfo=function(e){return j.MonsterCardArr[e]&&j.MonsterCardArr[e].level?j.MonsterCardArr[e].level:0},t.prototype.getServerListChangeBattleList=function(e){for(var t=[],n=0;n<e.length;n++){var o=j.MonsterWarTeam[j.MonsterBattle][e[n].index],a=i.instance.getCurBattleInfo(o),r=new u.ServerMonsterVo;r.cardid=o,r.level=a,r.grade=e[n].grade,r.count=e[n].count,t.push(r)}return t},t.prototype.GetMonsterInfo=function(e){return this._cardConfigs&&this._cardConfigs.Card?this._cardConfigs.Card[e]?this._cardConfigs.Card[e]:(console.warn("\u4e0d\u5b58\u5728\u5361\u724cId\u4e3a"+e+"\u7684\u5361\u724c"),null):(console.warn("\u5361\u724c\u914d\u7f6e\u8868\u672a\u52a0\u8f7d\u6210\u529f"),null)},t.prototype.GetCardAttr=function(e,t,i){var n,o=[];if(!this._cardConfigs.Card[e])return console.warn("\u4e0d\u5b58\u5728\u5361\u724cId\u4e3a"+e+"\u7684\u5361\u724c"),o;if(!(n=this._cardConfigs.Card[e]))return o;if(o.length<=0){var a=n.grade,r=this._cardConfigs.grade[a][t-1];if(!r)return;if(e>=9e4){var s=this._cardConfigs.level[r.level][i-1];if(!s)return;o=s.prop}else{o=r.prop.concat();for(var l=0;l<o.length;l++)o[l]=Math.floor(o[l]+.1*o[l]*(i-1))}}return o},t.prototype.Getnormalskillids=function(e,t,i){return this._cardConfigs&&this._cardConfigs.Card?this._cardConfigs.Card[e]?{skillid:this._cardConfigs.monster[this._cardConfigs.level[this._cardConfigs.grade[this._cardConfigs.Card[e].grade][t].level][i].monster].normalskillids,skilllv:1}:(console.warn("\u4e0d\u5b58\u5728\u5361\u724cId\u4e3a"+e+"\u7684\u5361\u724c"),null):(console.warn("\u5361\u724c\u914d\u7f6e\u8868\u672a\u52a0\u8f7d\u6210\u529f"),null)},t.prototype.SendCardUpgrade=function(e,t){void 0===t&&(t=-1);var i={cmd:"addcard",id:e,type:t};f.default.instance.sendProto(i)},t.prototype.getCardGradeBySpine=function(e,t){if(!this._cardConfigs||!this._cardConfigs.Card)return console.warn("\u5361\u724c\u914d\u7f6e\u8868\u672a\u52a0\u8f7d\u6210\u529f"),null;if(!this._cardConfigs.Card[e])return console.warn("\u4e0d\u5b58\u5728\u5361\u724cId\u4e3a"+e+"\u7684\u5361\u724c"),null;var i=this._cardConfigs.Card[e].grade;return this._cardConfigs.grade[i][t-1]?this._cardConfigs.grade[i][t-1].modelId:(console.warn("\u4e0d\u5b58\u5728\u5361\u724cId\u4e3a"+e+"\u7684\u5361\u724c grade"+(t-1)),null)},t.prototype.getCardGradeBySpineName=function(e,t){if(!this._cardConfigs||!this._cardConfigs.Card)return console.warn("\u5361\u724c\u914d\u7f6e\u8868\u672a\u52a0\u8f7d\u6210\u529f"),null;if(!this._cardConfigs.Card[e])return console.warn("\u4e0d\u5b58\u5728\u5361\u724cId\u4e3a"+e+"\u7684\u5361\u724c"),null;var i=this._cardConfigs.Card[e].grade;return this._cardConfigs.grade[i][t-1].spineName},t.prototype.getCardGradeByGradeConf=function(e,t){if(!this._cardConfigs||!this._cardConfigs.Card)return console.warn("\u5361\u724c\u914d\u7f6e\u8868\u672a\u52a0\u8f7d\u6210\u529f"),null;if(!this._cardConfigs.Card[e])return console.warn("\u4e0d\u5b58\u5728\u5361\u724cId\u4e3a"+e+"\u7684\u5361\u724c"),null;var i=this._cardConfigs.Card[e].grade;return this._cardConfigs.grade[i][t-1]},t.prototype.getCardConfCardType=function(e){return 0==e?g.CardType.Back:this._cardConfigs&&this._cardConfigs.Card?this._cardConfigs.Card[e]?this._cardConfigs.Card[e].cardType:(console.warn("\u4e0d\u5b58\u5728\u5361\u724cId\u4e3a"+e+"\u7684\u5361\u724c"),null):(console.warn("\u5361\u724c\u914d\u7f6e\u8868\u672a\u52a0\u8f7d\u6210\u529f"),null)},t.prototype.getMonsterConf=function(e,t,i){if(!this._cardConfigs||!this._cardConfigs.Card)return null;var n,o=this._cardConfigs.Card[e].grade,a=this._cardConfigs.grade[o][t-1].level;if(e>=9e4){i=10*Math.floor(i/10);for(var r=0,s=this._cardConfigs.level[a];r<s.length;r++){var l=s[r];if(l.lv==i){n=l.monster;break}}}else n=this._cardConfigs.grade[o][t-1].monster;return this._cardConfigs.monster[n]},t.prototype.SendCardSkillUpgrade=function(e,t){var i={cmd:"learnskill",id:e,skillId:t};f.default.instance.sendProto(i)},t.prototype.setSkillPic=function(e,t){var i=F.GlobalContext.ResRoot+"resources/skill/skill_"+d.default.instance.getSkillBySkillId(e).picUrl+".png";L.default.setImage(t.node,i)},t.prototype.setMonsterPic=function(e,t,i,n,o){void 0===n&&(n=null),void 0===o&&(o=null);var a=n,r=n,s=F.GlobalContext.ResRoot+"resources/monster/Lineup/Lineup"+e+"-"+t;y.default.instance.load(s,function(n){n||console.warn("\u6ca1\u6709\u56fe\u7247\u8d44\u6e90:","Lineup"+e+"-"+t),i.spriteFrame=new cc.SpriteFrame(n),a&&a.apply(r)},this)},t.prototype.SetMonsterData=function(e){j.MonsterBattle=e.data.battle,j.MonsterCardArr=e.data.cards,j.MonsterWarTeam=e.data.config,this.setMaxSkillLevel(),this.setMaxLevel(),this.warTeamRed(),this.isCardRemmcondHide(),this.cardGroupData.cardGroupAttrCptFlag=!1},t.prototype.getExperienceId=function(){var e=m.default.instance.currentChapterId+1,t=m.default.instance.currentGuanqiaId+1;return this.experienceConfig[e]?this.experienceConfig[e][t]:null},t.prototype.sendCardData=function(){this.SendCardUpgrade(this.getExperienceId().id,1),C.default.instance.openWindow(v.WindowType.FightInfo)},t.prototype.jumpFristCharge=function(){_.default.instance.openWindowType(v.WindowType.FristCharge)},t.prototype.activeCar=function(){var e=this,t=this.getExperienceId();return!(!t||j.MonsterCardArr[t.id])&&(this.startCardId=t.id,b.default.instance.open(v.WindowType.CardSynthesis,function(){T.default.instance.initInfo(t.id,1),T.default.instance.setCallFunc(e.sendCardData.bind(e))},this),!0)},t.prototype.checkShowActiveCar=function(){var e=this;if(this.deleteCardId&&b.default.instance.open(v.WindowType.CardSynthesisEnd,function(){S.default.instance.initInfo(e.deleteCardId),S.default.instance.setCallFunc(e.jumpFristCharge.bind(e)),e.deleteCardId=null},this),this.cardInfoId=null,this.infoList.length>0){var t=this.infoList[0];T.default.instance&&!T.default.instance.isShow&&!this.isShowInfo&&I.default.instance.scenestatus!=g.GameScene.Fight&&w.default.instance.iscomplete&&(this.isShowInfo=!0,b.default.instance.open(v.WindowType.CardSynthesis,function(){T.default.instance.initInfo(t),T.default.instance.setCallFunc(e.updateInfoList.bind(e))},this))}else D.default.instance.checkCondition(9)},t.prototype.nowIsHaveExperience=function(){var e,t,i=[12,13,14],n=j.MonsterWarTeam[j.MonsterBattle];for(var o in n)if((t=j.MonsterCardArr[n[o]])&&1==t.flag){e=i[parseInt(o)],D.default.instance.checkCondition(27,e)||(e=null);break}return e},t.prototype.SetCardInfo=function(e){var t=this;if(this.startCardId&&this.startCardId==e.info.id){var n=this.GetMonsterInfo(this.startCardId).cardType-1;for(var o in j.MonsterWarTeam)j.MonsterWarTeam[o][n]=this.startCardId;this.startCardId=null;var a={cmd:"cardconf",battle:Number(j.MonsterBattle),config:j.MonsterWarTeam};this.sendProto(a)}var r=!1;for(var c in j.MonsterCardArr)if(j.MonsterCardArr[c].id==e.info.id){j.MonsterCardArr[c]=e.info,s.GameEventDispatcher.instance.emit(l.EventDefiner.Card_updataCardInfo),r=!0;break}if(1==e.info.flag&&(j.MonsterCardArr[e.info.id]=e.info,r=!0),!r){if(j.MonsterCardArr[e.info.id]=e.info,!this.cardInfoId){if(this.cardInfoId=e.info.id,2==this.cardInfoId)return void(this.cardInfoId=null);if(this.cardInfoId<=3&&i.instance.setWarTeam(this.cardInfoId),this.infoList.push(this.cardInfoId),I.default.instance.scenestatus!=g.GameScene.Fight&&w.default.instance.iscomplete){if(!T.default.instance||T.default.instance.isShow||this.isShowInfo)this.cardInfoId=null;else if(this.infoList.length>0&&!b.default.instance.haveWindow(v.WindowType.RewardTips)){this.isShowInfo=!0,this.cardInfoId=null;var d=this.infoList[0];b.default.instance.open(v.WindowType.CardSynthesis,function(){T.default.instance.initInfo(d),T.default.instance.setCallFunc(t.updateInfoList.bind(t))},this)}}else;}s.GameEventDispatcher.instance.emit(l.EventDefiner.Card_updataCardInfo)}this.setMaxSkillLevel(),this.setMaxLevel(),this.warTeamRed(),this.cardGroupData.cardGroupAttrCptFlag=!1},t.prototype.updateInfoList=function(){var e=this;if(this.cardInfoId=null,this.isShowInfo=!1,this.infoList.shift(),this.infoList.length>0){this.cardInfoId=this.infoList[0],console.log("updateInfoList",this.isShowInfo);var t=this.infoList[0];!T.default.instance||T.default.instance.isShow||this.isShowInfo?this.cardInfoId=null:(this.isShowInfo=!0,b.default.instance.open(v.WindowType.CardSynthesis,function(){T.default.instance.initInfo(t),T.default.instance.setCallFunc(e.updateInfoList.bind(e)),e.cardInfoId=null},this)),s.GameEventDispatcher.instance.emit(l.EventDefiner.Card_updataCardInfo)}else D.default.instance.checkCondition(9)},t.prototype.setIsUpdateInfo=function(){var e=this;if(this.cardInfoId=null,this.isShowInfo=!1,this.infoList.length>0){this.cardInfoId=this.infoList[0],console.log("setIsUpdateInfo",this.isShowInfo);var t=this.infoList[0];!T.default.instance||T.default.instance.isShow||this.isShowInfo?this.cardInfoId=null:(this.isShowInfo=!0,b.default.instance.open(v.WindowType.CardSynthesis,function(){T.default.instance.initInfo(t),T.default.instance.setCallFunc(e.updateInfoList.bind(e))},this)),s.GameEventDispatcher.instance.emit(l.EventDefiner.Card_updataCardInfo)}},t.prototype.setCardSynthesisFlag=function(e){this.isShowInfo=!e,console.log("setCardSynthesisFlag",this.isShowInfo),this.isShowInfo||this.setIsUpdateInfo()},t.prototype.setMaxSkillLevel=function(){var e=1;for(var t in j.MonsterCardArr)for(var i in j.MonsterCardArr[t].skill)j.MonsterCardArr[t].skill[i].level>e&&(e=j.MonsterCardArr[t].skill[i].level);j.MaxSkillLevel=e},t.prototype.setMaxLevel=function(){var e=1;for(var t in j.MonsterCardArr)j.MonsterCardArr[t].level>e&&(e=j.MonsterCardArr[t].level);j.MaxLevel=e},t.prototype.getSpineIdByCarid=function(e){return this._cardConfigs.Card[e]?this._cardConfigs.Card[e].spine:(console.error("get spine error carid not exist conf:",e),0)},t.prototype.GetAllCardArr=function(){var e=[];for(var t in j.MonsterCardArr)e.push(j.MonsterCardArr[t]);return e},t.prototype.GetLeveMean=function(){var e=this.GetAllCardArr(),t=0,i=0;if(e.length<=5){for(var n=0;n<e.length;n++)t+=e[n].level;i=t/e.length}else{for(n=0;n<e.length;n++)for(var o=n+1;o<e.length;o++)if(e[o].level>e[n].level){var a=e[n].level,r=e[o].level;e[n].level=r,e[o].level=a}for(var s=0;s<5;s++)t+=e[s].level;i=t/5}return i},t.prototype.getCardAverageLv=function(e,t,i){void 0===t&&(t=2),void 0===i&&(i=0);for(var n,o=0,a=this.GetAllCardArr().sort(function(e,t){return t.level-e.level}),r=0;r<e;r++)a[r]&&(o+=a[r].level);return(n=Math.floor(o/e))<t?t:n>i&&i>0?i:n},t.prototype.getHigherCardLV=function(){var e=0;return this.GetAllCardArr().sort(function(e,t){return t.level-e.level}).forEach(function(t){e+=t}),(!(e=Math.max(Math.ceil(e/3),1))||e<11)&&(e=11),e},t.prototype.GetWarTeamConfig=function(){if(0==j.MonsterWarTeam.length)return null;for(var e={},t=0;t<j.MonsterWarTeam[j.MonsterBattle].length;t++)j.MonsterWarTeam[j.MonsterBattle]&&j.MonsterCardArr[j.MonsterWarTeam[j.MonsterBattle][t]]&&(e[t]=j.MonsterCardArr[j.MonsterWarTeam[j.MonsterBattle][t]]);return e},t.prototype.getCardListByFightSort=function(){if(this._cardSortByFight&&this._cardSortByFight.length>0)return this._cardSortByFight;this._cardSortByFight=this.GetAllCardArr().concat();for(var e=0;e<this._cardSortByFight.length;e++){var t=this.getCardConfCardType(this._cardSortByFight[e].id),n=i.instance.getCarFight(this._cardSortByFight[e].id,this._cardSortByFight[e].level,this._cardSortByFight[e].grade),o=h.default.cptFight(t,R.default.instance.data.getEequipWearAttr(R.default.instance.data.getEquipList(this._cardSortByFight[e].id)));this._cardSortByFight[e].sunFight=n+o}for(e=0;e<this._cardSortByFight.length;e++)for(var a=e+1;a<this._cardSortByFight.length;a++)if(this._cardSortByFight[a].sunFight>this._cardSortByFight[e].sunFight){var r=this._cardSortByFight[e];this._cardSortByFight[e]=this._cardSortByFight[a],this._cardSortByFight[a]=r}},t.prototype.getMonsterMaxAttrByType=function(e,t,i){if((!this._cardSortByFight||this._cardSortByFight.length<1)&&(this.getCardListByFightSort(),!this._cardSortByFight||this._cardSortByFight.length<1))return null;for(var n=this.getCardConfCardType(e),a=null,r=0;r<this._cardSortByFight.length;r++)if(this.getCardConfCardType(this._cardSortByFight[r].id)==n){a=this._cardSortByFight[r];break}a||(a=this._cardSortByFight[0]);var s=new o.StaticAttr;s.PushCard(a.id,t,i,1);var l=this.getEquipInfoByCardId(a.id);for(r=0;r<l.length;r++)s.ChangeAtt(r,Number(s.GetAttrVale(r))+l[r]);return s},t.prototype.getWarTeamList=function(){var e=[];if(0==j.MonsterWarTeam.length)return e;for(var t=0;t<j.MonsterWarTeam[j.MonsterBattle].length;t++)j.MonsterWarTeam[j.MonsterBattle]&&j.MonsterCardArr[j.MonsterWarTeam[j.MonsterBattle][t]]&&e.push(j.MonsterCardArr[j.MonsterWarTeam[j.MonsterBattle][t]]);return e},t.prototype.getWarTeamMinLevel=function(){var e=0,t=this.getWarTeamList().concat();if(t.length>0)for(var i=t[0].level,n=1;n<t.length;n++)t[n].level<i&&(i=t[n].level,e=n);return e},t.prototype.getWarTeamMinStage=function(){var e=0,t=this.getWarTeamList().concat();if(t.length>0)for(var i=t[0].stage,n=1;n<t.length;n++)t[n].stage<i&&(i=t[n].stage,e=n);return e},t.prototype.getWarTeamMinEquipLevel=function(e){var t=[0,0],i=this.getWarTeamList().concat();if(i.length>0)for(var n=-1,o=-1,a=-1,r=-1,s=0;s<i.length;s++)if(i[s].equip)for(var l=0;l<i[s].equip.length;l++){var c=A.default.instance.getItemByGuid(i[s].equip[l]);if(c)if(1==e&&(-1==n||n>c.level))t[0]=s,t[1]=l,n=c.level;else if(2==e&&(-1==o||o>c.stage))t[0]=s,t[1]=l,o=c.stage;else if(3==e){if(c.gem&&c.gem.length>0){for(var d=0,p=0;p<c.gem.length;p++){var h=R.default.instance.data.getGemstoneCfg(c.gem[p]);h&&(d+=h.level)}(a>d||-1==a)&&(a=d,t[0]=s,t[1]=l)}}else 4==e&&(-1==r||r>c.refineLevel)&&(t[0]=s,t[1]=l,r=c.refineLevel)}return t},t.prototype.GetWarTeamArrConfig=function(){var e;if(0==j.MonsterWarTeam.length)return null;for(var t=((e={})[0]=[],e[1]=[],e[2]=[],e),i=0;i<3;i++)for(var n=0;n<j.MonsterWarTeam[i].length;n++)t[i][n]=j.MonsterCardArr[j.MonsterWarTeam[i][n]];return t},t.prototype.openMonsterInfoPrefab=function(e,t,i,n,o,a,r,s){void 0===i&&(i=null),void 0===n&&(n=null),void 0===o&&(o=null),void 0===a&&(a=!1),void 0===r&&(r=null),void 0===s&&(s=0);var l=t;C.default.instance.openWindow(v.WindowType.CardInfo,function(t){t.getComponent(N.default).initInfo(e,l,n,o,a,r,s),i&&i.apply(o)},this)},t.prototype.infoPreview=function(e,t,i,n,o,a,r,s,l,c){void 0===o&&(o=1),void 0===a&&(a=-1),void 0===r&&(r=!0),void 0===s&&(s=null),void 0===l&&(l=null),void 0===c&&(c=g.ACTION.STAND);var d=L.default.getNodeByPool(v.PoolType.MonsterPreview,this.MonsterPreview);e.addChild(d),d.scale=o,d.setPosition(t);var p=d.getComponent(E.default);return i&&i>0&&(p.playing=r,p.init("monster",i,n,g.DEFAULTS_SKIN+n,g.PRIORITY.MONSTER,!1,c,a,1,null,s,l)),d},t.prototype.infoPreview2=function(e,t,i,n,o,a,r,s,l,c){void 0===a&&(a=1),void 0===r&&(r=-1),void 0===s&&(s=!0),void 0===l&&(l=null),void 0===c&&(c=null);var d=L.default.getNodeByPool(v.PoolType.MonsterPreview,this.MonsterPreview);e.addChild(d),d.scale=a,d.setPosition(t);var p=d.getComponent("MonsterPreview");return i&&i>0&&(p.playing=s,p.init("monster",i,n,g.DEFAULTS_SKIN+n,g.PRIORITY.MONSTER,!1,o,r,1,null,l,c)),d},t.prototype.carindividualityDic=function(e,t){if(null==this._carindividualityDic)for(var i in this._carindividualityDic={},this._cardConfigs.Card){var n=this._cardConfigs.Card[i],o=this._cardConfigs.individuality[n.individuality];if(o)for(var a=0,r=o;a<r.length;a++){var s=r[a],l=s.param[0];null==this._carindividualityDic[i+"_"+l.type]&&(this._carindividualityDic[i+"_"+l.type]=[]),this._carindividualityDic[i+"_"+l.type].push(s)}}return this._carindividualityDic[e+"_"+t]},t.prototype.infoRolePreview=function(e,t,i,n,o,a,r){void 0===o&&(o=1),void 0===a&&(a=g.ACTION.STAND),void 0===r&&(r=-1);var s=L.default.getNodeByPool(v.PoolType.MonsterPreview,this.MonsterPreview);e.addChild(s),s.scale=o,s.setPosition(t);var l=s.getComponent(E.default);return i&&i>0&&l.init("role",i,n,g.DEFAULTS_SKIN+n,g.PRIORITY.MONSTER,!1,a,r),s},t.prototype.getIsMonsterCard=function(e){for(var t in j.MonsterCardArr)if(e==j.MonsterCardArr[t].id)return!0;return!1},t.prototype.getIsLineup=function(e){if(0==j.MonsterWarTeam.length)return!1;for(var t in j.MonsterWarTeam[j.MonsterBattle])if(j.MonsterCardArr[j.MonsterWarTeam[j.MonsterBattle][t]]&&e==j.MonsterCardArr[j.MonsterWarTeam[j.MonsterBattle][t]].id)return!0;return!1},t.prototype.getIsArrLineup=function(e){if(0==j.MonsterWarTeam.length)return!1;for(var t=0;t<3;t++)for(var i in j.MonsterWarTeam[t])if(j.MonsterCardArr[j.MonsterWarTeam[t][i]]&&e==j.MonsterCardArr[j.MonsterWarTeam[t][i]].id)return!0;return!1},t.prototype.getIsLineupArr=function(e){if(0==j.MonsterWarTeam.length)return null;for(var t=[!1,!1,!1],i=0;i<3;i++)for(var n in j.MonsterWarTeam[i])if(j.MonsterCardArr[j.MonsterWarTeam[i][n]]&&e==j.MonsterCardArr[j.MonsterWarTeam[i][n]].id){t[i]=!0;break}return t},t.prototype.infoMoney=function(e){var t=String(e);return e>1e5&&(t=Math.floor(e/1e4)+"\u4e07"),t},t.prototype.warTeamRed=function(){B.default.instance.FuncIconRedDeal(v.WindowType.WarTeam,this.warTeamRedPoint()),s.GameEventDispatcher.instance.emit(M.EventInterface.CombatteamRed,this.warTeamRedPoint())},t.prototype.warTeamRedPoint=function(){var e=B.default.instance.checkIsOpenbyWindowtype(v.WindowType.WarTeam);if(e)for(var t in j.MonsterWarTeam[j.MonsterBattle]){var i=Number(j.MonsterWarTeam[j.MonsterBattle][t]),n=this.getIsLineup(i),o=this.GetMonsterData(i);if(e=!(!o||!o.flag||1!=o.flag),n&&!e&&(this.data.getCardUPlevFlag(i)||this.data.getCardUpSkillFlag(i)||R.default.instance.data.getEquipFlag(i)||R.default.instance.data.getEquipWearFlag(i)||x.default.instance.data.getCardOrnamentFlag(i)))return!0}return!1},t.prototype.isEquipUp=function(e){var t=R.default.instance.data.getItemByGuid(e),i=R.default.instance.data.getEquipInfoById(t.id),n=i.buwei,o={isCan:!1,cardId:0,buwei:0,list:[],equipList:[]};for(var a in j.MonsterWarTeam[j.MonsterBattle]){var r=j.MonsterWarTeam[j.MonsterBattle][a];if(!(r<=0)){var s=j.MonsterCardArr[r].equip,l=this.getCardConfCardType(r),c=this.judgeRange(i.range,l),d=R.default.instance.data.getIconList(i.range,n);if(c){if(!s[n])return o.isCan=!0,o.cardId=r,o.buwei=n,o.list=d,o.equipList=R.default.instance.data.getEquipList(r),o;if(t.config.ItemColor>R.default.instance.data.getItemByGuid(s[n]).config.ItemColor)return o.isCan=!0,o.cardId=r,o.buwei=n,o.list=d,o.equipList=R.default.instance.data.getEquipList(r),o}}}return o.isCan=!1,o},t.prototype.judgeRange=function(e,t){for(var i in e)if(e[i]==t)return!0;return!1},t.prototype.getEquipInfoByCardId=function(e){var t=this.GetMonsterData(e),i=[0,0,0,0,0,0,0];if(t&&t.equip&&0!=t.equip.length){var n=R.default.instance.data.getEquipList(e),o=R.default.instance.data.getEequipWearAttr(n);for(var a in i)o[a]&&(i[a]=i[a]+o[a]);return i}return i},t.prototype.setWarTeam=function(e){for(var t=0;t<j.MonsterWarTeam.length;t++){var n=i.instance.getCardConfCardType(e);if(j.MonsterWarTeam[t][n-1]){for(var o=0;o<j.MonsterWarTeam[t].length;o++)if(!j.MonsterWarTeam[t][o]){j.MonsterWarTeam[t][o]=e;break}}else j.MonsterWarTeam[t][n-1]=e}var a={cmd:"cardconf",battle:Number(j.MonsterBattle),config:j.MonsterWarTeam};this.sendProto(a)},t.prototype.getAttrPrecentByGradeAndType=function(e,t,i){void 0===i&&(i=1);var n={};if(this._attributeconf.attributeConf[e]){var o=this._attributeconf.attributeConf[e].attr,a=this._attributeconf.attr[o];if(-1!==Object.prototype.toString.call(t).indexOf("Array"))for(var r=0;r<t.length;r++)a[r]&&t[r]>0&&(n[r]=Math.ceil(t[r]*(a[r].param/100)));else for(var s in t)n[s]=a[s]?Math.ceil(t[s]*(a[s].param/100)):t[s];return n}console.warn("\u6ca1\u6709\u627e\u5230\u7c7b\u578b\u5c5e\u6027\u52a0\u6210\u8868  "+i)},t.prototype.reqOnekeyreplace=function(e,t){var i={cmd:"onekeyreplace",oldId:e,newId:t};f.default.instance.sendProto(i)},t.prototype.resOnekeyreplace=function(e){s.GameEventDispatcher.instance.emit(l.EventDefiner.onekeyreplace_Status,{flag:e.isSuc})},t.prototype.reqCardstageup=function(e,t){var i={cmd:"cardlevelup",id:e,isAutoBuy:t};f.default.instance.sendProto(i)},t.prototype.getCardIDByOrnamentType=function(e){var t=x.default.instance.data.conversio(e),i=null,n=j.MonsterWarTeam[j.MonsterBattle];for(var o in n){if(n[o]>0)this.GetMonsterData(parseInt(n[o])).peishi[t]||(i=parseInt(n[o]))}return i||(i=j.MonsterWarTeam[j.MonsterBattle][0]),i},t.prototype.getIdxByCardId=function(e){var t=j.MonsterWarTeam[j.MonsterBattle];for(var i in t)if(e==parseInt(t[i]))return parseInt(i);return-1},t.prototype.GetMyTeamAttar=function(e,t,i,n){void 0===n&&(n=.85);var o=this.getMonsterMaxAttrByType(e,t,i);for(var a in o.attr_)o.attr_[a]=o.attr_[a]*n;var r=new c.EntityProperty;r.cardid=e,r.grade=i,r.type=k.EntityType.enMonster,r.selfMonster=!0;var s=d.default.instance.getSkills(r);return o.skills=s,o},t.prototype.GetMyCardRarity=function(){var e=[],t=[],i=[],n=[];for(var o in j.MonsterCardArr){var a=this._cardConfigs.Card[j.MonsterCardArr[o].id].cardType;1==a?e.push(this._cardConfigs.Card[j.MonsterCardArr[o].id]):2==a?t.push(this._cardConfigs.Card[j.MonsterCardArr[o].id]):3==a&&i.push(this._cardConfigs.Card[j.MonsterCardArr[o].id])}return e.sort(function(e,t){return t.rarity-e.rarity}),t.sort(function(e,t){return t.rarity-e.rarity}),i.sort(function(e,t){return t.rarity-e.rarity}),n.push(e[0],t[0],i[0]),n},t.prototype.getRecommendCards=function(){var e=m.default.instance.currentChapterId+1,t=m.default.instance.currentGuanqiaId+1,i=this.chapterNews[e]?this.chapterNews[e][t]:null;return i||(i=this.chapterNews[e]?this.chapterNews[e][t-1]:null),i||(i=this.chapterNews[999][999]),i},t.prototype.resCardInherit=function(e){s.GameEventDispatcher.instance.emit(l.EventDefiner.CardInherit_effect,{isSuc:e.isSuc,reward:e.reward})},t.prototype.reqCardInherit=function(e,t,i){var n={cmd:"cardinherit",type:e,srcId:t,destId:i};f.default.instance.sendProto(n)},t.prototype.isUltimateTeam=function(){var e=this.GetMyCardRarity();for(var t in e)if(e[t]&&6!=e[t].rarity)return!1;return!0},t.prototype.isCardRemmcondHide=function(){B.default.instance.FuncIconHideDeal(v.WindowType.CardRecommend,this.isUltimateTeam())},t.instance=null,__decorate([q(cc.Prefab)],t.prototype,"MonsterPreview",void 0),t=i=__decorate([V],t)}(n.default);i.default=H;var j=function(){function e(){}return e.MonsterWarTeam=[],e.AssistFightData=[],e.MonsterBattle=null,e.MonsterCardArr={},e.IsLast=[null,null],e.oldRoleInfo=null,e.MaxSkillLevel=null,e.MaxLevel=null,e}();i.MonsterType=j,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Const/EntityType":"EntityType","../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/LoadManager":"LoadManager","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../NetConnect/NetConnet":"NetConnet","../../Util/Utils":"Utils","../../Util/UtilsFight":"UtilsFight","../Chapter/ChapterController":"ChapterController","../Commons/MonsterPreview":"MonsterPreview","../Commons/WindowOpenUtils":"WindowOpenUtils","../Equip/equip/EquipCtrl":"EquipCtrl","../Fight/staticattr":"staticattr","../Functionicon/FunctionIconController":"FunctionIconController","../Gamelayer/Interface/EventInterface":"EventInterface","../Guide/GuideNewController":"GuideNewController","../Item/ItemController":"ItemController","../OpenWin/OpenWinController":"OpenWinController","../Ornament/OrnamentCtrl":"OrnamentCtrl","../PlotWin/PlotController":"PlotController","../Scene/Controller/SceneController":"SceneController","../Scene/Controller/SkillController":"SkillController","../Scene/Prop/EntityProperty":"EntityProperty","../Scene/Upgrading/CardSynthesis":"CardSynthesis","../Scene/Upgrading/CardSynthesisEnd":"CardSynthesisEnd","../Status/StatusController":"StatusController","../Status/StatusType":"StatusType","./CardData":"CardData","./CardGroup/CardGroupData":"CardGroupData","./CardSkill/CardSkillData":"CardSkillData","./CardStage/CardStageData":"CardStageData","./WarTeamMonsterInfo":"WarTeamMonsterInfo","./vo/ServerMonsterVo":"ServerMonsterVo"}],MonsterDeadTipManager:[function(e,t,i){"use strict";cc._RF.push(t,"24558ODGfRAJK01uFYkR5m2","MonsterDeadTipManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Managet"),o=e("./SceneManager"),a=e("../../../Core/LoadManager"),r=e("../../../GlobalContext"),s=e("../../../Util/Utils"),l=e("../../Commons/Image"),c=e("../../../Core/Const/EntityType"),d=cc._decorator,p=d.ccclass,h=(d.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tipnodeList=[],t}var i;return __extends(t,e),i=t,Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new i),this._instance},enumerable:!0,configurable:!0}),t.prototype.showMonsterDeadTip=function(e){var t=this;if(e.type!=c.EntityType.enActor){var i="i18n_df",n=[];e.selfMonster?(n=o.default.instance.leftlives,i="i18n_wf"):n=o.default.instance.rightlives;for(var d=0;d<n.length;d++){var p=n[d];if(p.CardType==e.CardType&&p.type==c.EntityType.enMonster)return}if(this.tipnodeList.length>4){var h=this.tipnodeList.shift();h.getChildByName("image").getComponent(l.default).loadSpriteAtlas(r.GlobalContext.Root+"ui/monsterdeadtip/monsterdeadtip",i+e.CardType),this.playAction(h)}else a.default.instance.loadResByType(r.GlobalContext.Root+"prefab/fightinfopanel/MonsterDeadTip",cc.Prefab,function(n){var o=s.default.getNodeByUrl(n,r.GlobalContext.Root+"prefab/fightinfopanel/MonsterDeadTip");o.getChildByName("image").getComponent(l.default).loadSpriteAtlas(r.GlobalContext.Root+"ui/monsterdeadtip/monsterdeadtip",i+e.CardType),t.playAction(o)},this)}},t.prototype.playAction=function(e){var t=this;e.setPosition(-350,0),r.PlayerData.TipsLayer.addChild(e),e.runAction(cc.sequence(cc.spawn(cc.fadeIn(.5),cc.moveBy(1,0,160)),cc.delayTime(1),cc.callFunc(function(){e.removeFromParent(),t.tipnodeList.push(e)},this)))},t.prototype.clearAll=function(){for(;this.tipnodeList.length>0;){var e=this.tipnodeList.shift();s.default.setNodeDestoryByUrl(e,r.GlobalContext.Root+"prefab/fightinfopanel/MonsterDeadTip")}},t._instance=null,t=i=__decorate([p],t)}(n.default));i.default=h,cc._RF.pop()},{"../../../Core/Const/EntityType":"EntityType","../../../Core/LoadManager":"LoadManager","../../../Core/Managet":"Managet","../../../GlobalContext":"GlobalContext","../../../Util/Utils":"Utils","../../Commons/Image":"Image","./SceneManager":"SceneManager"}],MonsterGroupUtils:[function(e,t,i){"use strict";cc._RF.push(t,"97fec9fP0tCoa/du4gv9vKq","MonsterGroupUtils"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Module/Status/StatusType"),o=function(){function e(){}return e.getMonsterGroup=function(e,t,i){void 0===i&&(i=!1);var o=[],a=null;for(var r in e)a=e[r],n.ActivityStatus.value!=n.ActivityStatus.Chapter&&a.type&&0!=a.type||(a.id>=0&&(a.id=a.id),a.cardid>=0&&(a.id=a.cardid),a.id>=0&&(o[a.id]||(o[a.id]={},o[a.id].id=e[r].cardid||e[r].id,o[a.id].cardid=i?e[r].cardid||e[r].id:e[r].cardid,o[a.id].list=[]),a.level=a.cultivateLv||a.level,o[a.id].list.push(a)));return o},e.getMonsterGroupByList=function(e){for(var t=[],i=0;i<e.length;i++){for(var n=!0,o=0;o<t.length;o++)if(t[o].id==e[i].id||t[o].id==e[i].cardid){n=!1;break}if(n)e[i].id=e[i].id||e[i].cardid,t.push(e[i])}return t},e.getMonsterIndex=function(e,t,i){void 0===i&&(i=-1);var n=null;for(var o in e)if(e[o].cardid>0){if(t.id==e[o].cardid){n=o;break}}else if(e[o].id==i){n=o;break}return n},e}();i.default=o,cc._RF.pop()},{"../Module/Status/StatusType":"StatusType"}],MonsterIndividualityUtils:[function(e,t,i){"use strict";cc._RF.push(t,"8ffa9/KtO1DmaHOl4Ou6fQt","MonsterIndividualityUtils"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../WarTeam/MonsterController"),o=e("../View/ActorsBigSkillLayer"),a=e("../../../Util/Utils"),r=e("../../../Core/WindowType"),s=e("../../../Global/GlobalValue"),l=(e("../Controller/ServerFightController"),e("../Controller/FightTimeController")),c=e("../View/ActorsLayer"),d=e("../Manager/SceneManager"),p=(e("../../../Core/Const/EntityType"),e("../Unit/FightLog")),h=cc._decorator,u=h.ccclass,f=(h.property,function(){function e(){this._cardidAndSelfHandle={}}var t;return t=e,Object.defineProperty(e,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),e.prototype.checkIndividualityType=function(e,t,i){},e.prototype.showQiPao=function(e,t){var i=this,n={type:s.INDIVIDUALITYSHOW.TYPE1,entity:e};c.default.instance.changeByLayer(e,e.node.parent.childrenCount+1),e.showQiPao(t),this._cardidAndSelfHandle[e.prop.cardid]=n,l.default.instance.setTimeout("MonsterIndividualityUtils"+e.prop.cardid,function(e){i.clearByCardid(e.entity)},this,3e3,n)},e.prototype.clearAll=function(){for(var e in this._cardidAndSelfHandle){var t=this._cardidAndSelfHandle[e];this.clearByCardid(t.entity)}this._cardidAndSelfHandle={}},e.prototype.clearByCardid=function(e){if(null!=this._cardidAndSelfHandle[e.prop.cardid])for(var t in this._cardidAndSelfHandle){var i=this._cardidAndSelfHandle[t];if(i.entity.prop.cardid==e.prop.cardid&&e.prop.handle==i.entity.prop.handle){i.type==s.INDIVIDUALITYSHOW.TYPE2?a.default.setNodeToPool(r.PoolType.MonsterPreview,i.node):i.type==s.INDIVIDUALITYSHOW.TYPE1&&i.entity.hideQiPao(),this._cardidAndSelfHandle[i.entity.prop.cardid]=null,delete this._cardidAndSelfHandle[t],l.default.instance.clearTimeout("MonsterIndividualityUtils"+i.entity.prop.cardid),p.default.log("\u6e05\u7406"+t+"\u4e2a\u6027",this._cardidAndSelfHandle);break}}},e.prototype.showMonster=function(e,t){var i=this,a=n.default.instance.GetMonsterInfo(e.prop.cardid).scenescale,r={node:n.default.instance.infoPreview(o.default.instance.node,new cc.Vec2(e.prop.x,e.prop.y),e.prop.cardid,e.prop.grade,a,e.prop.dir,!0,null,null,t),entity:e,type:s.INDIVIDUALITYSHOW.TYPE2};this._cardidAndSelfHandle[e.prop.cardid]=r,l.default.instance.setTimeout("MonsterIndividualityUtils"+e.prop.cardid,function(e){i.clearByCardid(e.entity)},this,3e3,r)},e.prototype.updatePlayRate=function(){for(var e in this._cardidAndSelfHandle){var t=this._cardidAndSelfHandle[e];t.type==s.INDIVIDUALITYSHOW.TYPE2&&t.node.getComponent("MonsterPreview").avatar.setPlayRate(d.default.instance.fightViewPlayRate)}},e=t=__decorate([u],e)}());i.default=f,cc._RF.pop()},{"../../../Core/Const/EntityType":"EntityType","../../../Core/WindowType":"WindowType","../../../Global/GlobalValue":"GlobalValue","../../../Util/Utils":"Utils","../../WarTeam/MonsterController":"MonsterController","../Controller/FightTimeController":"FightTimeController","../Controller/ServerFightController":"ServerFightController","../Manager/SceneManager":"SceneManager","../Unit/FightLog":"FightLog","../View/ActorsBigSkillLayer":"ActorsBigSkillLayer","../View/ActorsLayer":"ActorsLayer"}],MonsterInfoBox:[function(e,t,i){"use strict";cc._RF.push(t,"d92d8SvdDdNWrVluX/wYdSO","MonsterInfoBox"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=cc._decorator,a=o.ccclass,r=(o.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t=__decorate([a],t)}(n.default));i.default=r,cc._RF.pop()},{"../../Core/Widget":"Widget"}],MonsterInfofight_cell:[function(e,t,i){"use strict";cc._RF.push(t,"d90d5G0lHZG+b/+XKu9Ump8","MonsterInfofight_cell"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../../Core/Widget"),o=e("../../../../Core/ConfigsManager"),a=e("../../../../Util/ColorUtil"),r=e("../../../WarTeam/MonsterController"),s=e("../../../Commons/MonsterPreview"),l=e("../../../../Core/CommonsResManager"),c=e("../../../../Util/Utils"),d=e("../../../../Core/WindowType"),p=cc._decorator,h=p.ccclass,u=p.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Level=null,t.formIcon=null,t.MonsterIcon=null,t.rarity=null,t.Posi=null,t.cardAtlas=null,t}return __extends(t,e),t.prototype.initData=function(e,t,i,n,s,c){void 0===i&&(i=1),void 0===n&&(n=1),void 0===s&&(s=!0);var d=o.ConfigsManager.instance.getConfigs("cardConf").Card;if(e>=9e4)this.Posi.node.active=!1,this.rarity.node.active=!1;else{this.Posi.node.active=!0,this.rarity.node.active=!0,this.rarity.spriteFrame=l.default.instance.getSpriteFrameByName("rarity_"+d[e].rarity);var p=r.default.instance.GetMonsterInfo(e);p&&(p=r.default.instance.GetMonsterInfo(e).cardType,this.Posi.spriteFrame=l.default.instance.getSpriteFrameByName("stance_"+p))}this.Level.string=t+"",this.node.x=0,(new cc.Color).fromHEX(a.ColorUtil.colorStr(i)),this.formIcon.spriteFrame=l.default.instance.getSpriteFrameByName("series"+d[e].fiveLineAttributes),this.node.getComponent(cc.Sprite).spriteFrame=this.cardAtlas.getSpriteFrame("di_"+d[e].rarity),this.node.getChildByName("baseSprite").getComponent(cc.Sprite).spriteFrame=this.cardAtlas.getSpriteFrame("di_0"+d[e].rarity);c?c.GetFight():r.default.instance.getCarFight(e,t,i,s),this.onClear();var h=s?-1:1;r.default.instance.infoPreview(this.MonsterIcon,cc.v2(0,0),e,i,1,h)},t.prototype.getMonstern=function(e){o.ConfigsManager.instance.getConfigs("guanqiaconf").guanqiaconf},t.prototype.onClear=function(){for(var e=this.MonsterIcon.childrenCount-1;e>=0;e--){this.MonsterIcon.children[e].getComponent(s.default).clear(),c.default.setNodeToPool(d.PoolType.MonsterPreview,this.MonsterIcon.children[e])}},t.prototype.hide=function(){e.prototype.hide.call(this),this.onClear()},__decorate([u(cc.Label)],t.prototype,"Level",void 0),__decorate([u(cc.Sprite)],t.prototype,"formIcon",void 0),__decorate([u(cc.Node)],t.prototype,"MonsterIcon",void 0),__decorate([u(cc.Sprite)],t.prototype,"rarity",void 0),__decorate([u(cc.Sprite)],t.prototype,"Posi",void 0),__decorate([u(cc.SpriteAtlas)],t.prototype,"cardAtlas",void 0),t=__decorate([h],t)}(n.default);i.default=f,cc._RF.pop()},{"../../../../Core/CommonsResManager":"CommonsResManager","../../../../Core/ConfigsManager":"ConfigsManager","../../../../Core/Widget":"Widget","../../../../Core/WindowType":"WindowType","../../../../Util/ColorUtil":"ColorUtil","../../../../Util/Utils":"Utils","../../../Commons/MonsterPreview":"MonsterPreview","../../../WarTeam/MonsterController":"MonsterController"}],MonsterInitPointController:[function(e,t,i){"use strict";cc._RF.push(t,"81c297v2+lHyYtTnrUyk3gw","MonsterInitPointController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Controller"),o=e("../../../Core/ConfigsManager"),a=e("./ServerFightController"),r=cc._decorator,s=r.ccclass,l=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.monsterinitpoint=null,t.gradeDic=null,t}var i;return __extends(t,e),i=t,Object.defineProperty(t,"instance",{get:function(){return i._instance||(i._instance=new i,i.instance.init()),i._instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){this.monsterinitpoint=o.ConfigsManager.instance.getConfigs("monsterinitpoint")},t.prototype.getResetMonsterY=function(e){var t=this.monsterinitpoint.monsterinitpoint[1].length;e>t&&(e=Math.max(1,e-Math.floor(e/t)*t));var i=this.monsterinitpoint.monsterinitpoint[1][e-1];return i.miny+a.default.instance.Random()*(i.maxy-i.miny)},t.prototype.getMonsterY=function(e,t){var i=0,n=t?0:1;if(null==this.gradeDic){this.gradeDic={};for(var o=0,r=this.monsterinitpoint.monsterinitpoint[1];o<r.length;o++){var s=r[o];if(this.gradeDic[s.grade+"_0"])this.gradeDic[s.grade+"_0"].arr.push(s),this.gradeDic[s.grade+"_1"].arr.push(s);else{var l={count:0,index:0,arr:[s]};this.gradeDic[s.grade+"_0"]=l,this.gradeDic[s.grade+"_1"]=l}}}var c=this.gradeDic[e+"_"+n],d=c.arr[c.index];if(d.limit>c.count)i=d.miny+a.default.instance.Random()*(d.maxy-d.miny),c.count++,c.index=c.index>=c.arr.length-1?0:c.index++;else for(var p=0;p<c.arr.length;p++){(s=c.arr[p]).limit>c.count&&(i=s.miny+a.default.instance.Random()*(s.maxy-s.miny),c.index=p)}return i},t.prototype.clear=function(){this.gradeDic=null},t._instance=null,t=i=__decorate([s],t)}(n.default));i.default=l,cc._RF.pop()},{"../../../Core/ConfigsManager":"ConfigsManager","../../../Core/Controller":"Controller","./ServerFightController":"ServerFightController"}],MonsterLayout:[function(e,t,i){"use strict";cc._RF.push(t,"dd6a7aKyeBNFLJHwGHkoNgl","MonsterLayout"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./MonsterController"),o=e("../../Global/GlobalValue"),a=e("../../Core/Widget"),r=e("./MonsterLineup"),s=e("../../Core/TimeController"),l=cc._decorator,c=l.ccclass,d=l.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.nodeList=[],t.monsterLineup=null,t.cardId=null,t.posList=[new cc.Vec2(0,0),new cc.Vec2(0,0),new cc.Vec2(0,0),new cc.Vec2(0,0),new cc.Vec2(0,0)],t.skinGradeList={1:[3,4,5,1,2]},t.zIndexList={1:[1,2,5,4,3],2:[2,5,4,3,1],3:[5,4,3,1,2],4:[4,3,1,2,5],5:[3,1,2,5,4]},t.zIndex=1,t.scaleNumList=[.2,.3,.4,.3,.2],t.scaleNumList2=[.6,.7,.8,.7,.6],t.scaleFlag=!1,t.skinGradeIndex=5,t.skinGradeColor=2,t.monsterArr=[],t.isCanMove=!0,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.show=function(){this.skinGradeIndex=5,this.zIndex=1,this.skinGradeColor=2},t.prototype.hide=function(){this.skinGradeIndex=5,this.zIndex=1,this.skinGradeColor=2,this.monsterArr=[]},t.prototype.setData=function(e,t){void 0===t&&(t=!1),this.scaleFlag=t,this.cardId=e,this.skinGradeIndex=5,this.zIndex=1,this.skinGradeColor=2,this.resetListPosition(),this.setMonster(),this.updateZOrder(),this.setIndex()},t.prototype.resetListPosition=function(){for(var e in this.nodeList)this.nodeList[e].stopAllActions();this.nodeList[0].position=cc.v2(-105,-15),this.nodeList[1].position=cc.v2(-69,-39),this.nodeList[2].position=cc.v2(6,-52),this.nodeList[3].position=cc.v2(70,-39),this.nodeList[4].position=cc.v2(110,-15)},t.prototype.setIndex=function(){var e=this.zIndexList[this.zIndex];this.nodeList[0].setSiblingIndex(e[0]),this.nodeList[1].setSiblingIndex(e[1]),this.nodeList[2].setSiblingIndex(e[2]),this.nodeList[3].setSiblingIndex(e[3]),this.nodeList[4].setSiblingIndex(e[4])},t.prototype.setMonster=function(){this.monsterArr=[];for(var e=this.scaleFlag?this.scaleNumList2:this.scaleNumList,t=0;t<this.nodeList.length;++t)this.nodeList[t].destroyAllChildren(),this.nodeList[t].scale=e[t],this.monsterArr[t]=n.default.instance.infoPreview(this.nodeList[t],this.posList[t],this.cardId,this.skinGradeList[1][t],1,-1,!0,null,null,o.ACTION.STAND)},t.prototype.updateZOrder=function(){if(!(this.monsterArr.length<=0))for(var e=0;e<this.monsterArr.length;++e)this.monsterArr[e].childrenCount<=0||(e==this.skinGradeColor?this.monsterArr[e].children[0].color=new cc.Color(255,255,255):this.monsterArr[e].children[0].color=new cc.Color(80,80,80))},t.prototype.setAllBlack=function(){if(!(this.monsterArr.length<=0))for(var e=0;e<this.monsterArr.length;++e)this.monsterArr[e].childrenCount<=0||(this.monsterArr[e].children[0].color=new cc.Color(80,80,80))},t.prototype.getIndex=function(){return this.skinGradeIndex},t.prototype.clickChangeMonsterRight=function(){var e=this;if(this.isCanMove){this.isCanMove=!1,5==this.skinGradeIndex?this.skinGradeIndex=1:this.skinGradeIndex++,1==this.zIndex?this.zIndex=5:this.zIndex--,4==this.skinGradeColor?this.skinGradeColor=0:this.skinGradeColor++,this.updateZOrder(),this.setIndex();for(var t=4;t>=0;t--)0==t?this.changeR(this.nodeList[t],this.nodeList[4]):this.changeR(this.nodeList[t],this.nodeList[t-1]);var i=s.default.instance.setTimeout(function(){e.monsterLineup.changeStage(e.skinGradeIndex),e.isCanMove=!0,s.default.instance.clearTimeout(i)},this,1e3)}},t.prototype.clickChangeMonsterLeft=function(){var e=this;if(this.isCanMove){this.isCanMove=!1,1==this.skinGradeIndex?this.skinGradeIndex=5:this.skinGradeIndex--,5==this.zIndex?this.zIndex=1:this.zIndex++,0==this.skinGradeColor?this.skinGradeColor=4:this.skinGradeColor--,this.updateZOrder(),this.setIndex();for(var t=0;t<this.nodeList.length;t++)t==this.nodeList.length-1?this.changeR(this.nodeList[t],this.nodeList[0]):this.changeR(this.nodeList[t],this.nodeList[t+1]);var i=s.default.instance.setTimeout(function(){e.monsterLineup.changeStage(e.skinGradeIndex),e.isCanMove=!0,s.default.instance.clearTimeout(i)},this,1e3)}},t.prototype.changeR=function(e,t){var i=t.scaleX,n=t.scaleY,o=t.x,a=t.y;e.runAction(cc.spawn(cc.moveTo(1,cc.v2(o,a)),cc.scaleTo(1,i,n)))},t.prototype.changeL=function(e,t){var i=e.scaleX,n=e.scaleY,o=e.x,a=e.y;t.runAction(cc.spawn(cc.moveTo(1,cc.v2(o,a)),cc.scaleTo(1,i,n)))},__decorate([d([cc.Node])],t.prototype,"nodeList",void 0),__decorate([d(r.default)],t.prototype,"monsterLineup",void 0),t=__decorate([c],t)}(a.default);i.default=p,cc._RF.pop()},{"../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../../Global/GlobalValue":"GlobalValue","./MonsterController":"MonsterController","./MonsterLineup":"MonsterLineup"}],MonsterLineup:[function(e,t,i){"use strict";cc._RF.push(t,"bfe5bteIX5HKYSZ3ZCfo2rb","MonsterLineup"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("./WarTeam"),a=e("./MonsterController"),r=e("../Commons/MonsterPreview"),s=e("../../Core/WindowType"),l=e("../../Util/Utils"),c=e("../../Core/ConfigsManager"),d=e("../../Core/CommonsResManager"),p=e("../Equip/equip/EquipCtrl"),h=e("../Ornament/OrnamentCtrl"),u=e("../../GlobalContext"),f=e("../Commons/Image"),g=e("../Totems/TotemsUtils"),y=cc._decorator,m=y.ccclass,C=y.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.btnLineup=null,t.stance=null,t.config=null,t.cardId=null,t.cardName=null,t.hp=null,t.att=null,t.armor=null,t.range=null,t.hit=null,t.dodge=null,t.doubleAtt=null,t.tenacity=null,t.genus=null,t.cardData=null,t.choice=!1,t.allChoice=!1,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.initInfo=function(e,t){this.cardId=e,this.config=t,this.btnLineup.active=!1,this.setToUpdateInfo()},t.prototype.setToUpdateInfo=function(){if(!this.cardId)return this.node.getChildByName("teaminfo").active=!1,this.node.getChildByName("noteam").active=!0,void(this.node.getComponent(cc.Button).interactable=!1);this.node.getComponent(cc.Button).interactable=!0,this.node.getChildByName("noteam").active=!1,this.node.getChildByName("teaminfo").active=!0;for(var e=c.ConfigsManager.instance.getConfigs("cardConf"),t=cc.find("teaminfo/MonsterLayer",this.node).childrenCount-1;t>=0;t--){cc.find("teaminfo/MonsterLayer",this.node).children[t].getComponent(r.default).clear(),l.default.setNodeToPool(s.PoolType.MonsterPreview,cc.find("teaminfo/MonsterLayer",this.node).children[t])}var i=a.default.instance,n=i.GetMonsterData(this.cardId),p=e.Card[this.cardId].rarity,h=(e.Card[this.cardId].fiveLineAttributes,u.GlobalContext.ResRoot+"resources/warTeam/bg_pinzhi"+(p-1)+".png");cc.find("pinzhi",this.node).getComponent(f.default).loadImageByHttps(h),cc.find("teaminfo/bg",this.node).getComponent(cc.Sprite).spriteFrame=o.default.instance.warteamAtlas2.getSpriteFrame("fightbg"+p),this.stance=e.Card[this.cardId].cardType,n&&n.level&&(cc.find("teaminfo/InfoLayer/Layout/CombatPower/value",this.node).getComponent(cc.Label).string=""+i.getCarFight(this.cardId,n.level,5,!0,null,!1)),cc.find("teaminfo/InfoLayer/Layout/Occupation/stance",this.node).getComponent(cc.Sprite).spriteFrame=d.default.instance.getSpriteFrameByName("stance_"+this.stance),cc.find("teaminfo/TouchNode",this.node).getComponent("MonsterLayout").setData(this.cardId),this.upShow()},t.prototype.setModelBlack=function(){cc.find("teaminfo/TouchNode",this.node).getComponent("MonsterLayout").setAllBlack(this.cardId),cc.find("pinzhi",this.node).active=!1},t.prototype.setOneModel=function(){cc.find("teaminfo/TouchNode",this.node).getComponent("MonsterLayout").updateZOrder(),cc.find("pinzhi",this.node).active=!0},t.prototype.hideChangeStage=function(){cc.find("teaminfo/TouchNode/left",this.node).active=!1,cc.find("teaminfo/TouchNode/right",this.node).active=!1},t.prototype.showChangeStage=function(){cc.find("teaminfo/TouchNode/left",this.node).active=!0,cc.find("teaminfo/TouchNode/right",this.node).active=!0},t.prototype.showInfo=function(){o.default.instance.cheakInfo()&&(o.default.instance.btnCloseLineup.active?this.choice&&(cc.find("info",this.node).active=!0):cc.find("info",this.node).active=!0)},t.prototype.hideInfo=function(){cc.find("info",this.node).active=!1},t.prototype.btn_Info=function(e){o.default.instance.cheakInit()&&o.default.instance.clickShowCard(),o.default.instance.effectRight.active=!0,o.default.instance.changeConfig=this.config,o.default.instance.selectCardType(this.stance),o.default.instance.cancelLineup(!0),this.effect()},t.prototype.changeStage=function(e){var t=a.default.instance,i=t.GetMonsterData(this.cardId);if(i&&i.level){var n=t.getCarFight(this.cardId,i.level,e,!0,null,!1);cc.find("teaminfo/InfoLayer/Layout/CombatPower/value",this.node).getComponent(cc.Label).string=""+n}this.upShow(e)},t.prototype.btn_Lineup=function(e){o.default.instance.changeConfig=null,o.default.instance.clickRightChane?(o.default.instance.newCardChange=!1,o.default.instance.clickRightChane=!1,o.default.instance.newCardId=null,o.default.instance.newLineup(this.config)):o.default.instance.btn_closeLineup(),o.default.instance.setSelectChange(),this.btnLineup.active=!1},t.prototype.cheackChioce=function(e,t){return e==this.stance?t.push(!0):t.push(!1),t},t.prototype.effect=function(){if(!o.default.instance.inChange||this.allChoice){o.default.instance.inChange=!0,o.default.instance.inLeftChoice=!0,this.choice=!0;var e=cc.find("effect",this.node);e.active=!0;var t=e.children[0],i=e.children[1];t.stopAllActions(),t.runAction(cc.repeatForever(cc.sequence(cc.moveTo(.5,-120,0),cc.moveTo(.5,-170,0)))),i.stopAllActions(),i.runAction(cc.repeatForever(cc.sequence(cc.moveTo(.5,120,0),cc.moveTo(.5,170,0)))),this.allChoice?(e.getChildByName("skin2").active=!0,this.hideChangeStage()):(o.default.instance.btnChangeCard(),o.default.instance.cheakInfo()&&(cc.find("info",this.node).active=!0),this.setOneModel())}else o.default.instance.btn_closeLineup()},t.prototype.stopEfffect=function(){var e=cc.find("effect",this.node);e.active=!1,e.getChildByName("skin2").active=!1;var t=e.children[0],i=e.children[1];t.stopAllActions(),i.stopAllActions()},t.prototype.upShow=function(e){void 0===e&&(e=5);var t=a.default.instance;this.cardData||(this.cardData=t.data);var i=t.GetMonsterData(this.cardId),n=t.getIsMonsterCard(this.cardId),o=t.getAttrPrecentByGradeAndType(e,this.equipData(this.cardId)),r=n?t.getAttrPrecentByGradeAndType(e,t.cardGroupData.getAllCardGroupAttr()):null,s=t.getCardConfCardType(this.cardId),c=n?t.getAttrPrecentByGradeAndType(e,g.TotemsUtils.getCardIdAttr(s)):null,d=n?t.getAttrPrecentByGradeAndType(e,l.default.getCardBaseAttr(this.cardId,i.level)):null,p=n?t.cardStageData.getCardPotentialAttr(this.cardId,i.level):null;p=t.getAttrPrecentByGradeAndType(e,p);for(var u=n?t.getAttrPrecentByGradeAndType(e,h.default.instance.data.getWearOrnamentAttr(this.cardId,s)):null,f=t.getIsArrLineup(this.cardId),y=n?t.getAttrPrecentByGradeAndType(e,t.cardStageData.getCardPotential(this.cardId)):null,m=cc.find("info",this.node).children,C=0;C<3;C++){var v=l.default.getVal(p,C);f&&(v+=l.default.getVal(y,C)),m[C].children[0].getComponent(cc.Label).string=l.default.getVal(d,C)+l.default.getVal(o,C)+l.default.getVal(r,C)+l.default.getVal(c,C)+l.default.getVal(u,C)+v+""}},t.prototype.equipData=function(e){var t=a.default.instance.GetMonsterData(e),i=[0,0,0,0,0,0,0];if(t&&t.equip&&0!=t.equip.length){var n=p.default.instance.data.getEquipList(e),o=p.default.instance.data.getEequipWearAttr(n);for(var r in i)o[r]&&(i[r]=i[r]+o[r]);return i}return i},__decorate([C(cc.Node)],t.prototype,"btnLineup",void 0),t=__decorate([m],t)}(n.default);i.default=v,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/ConfigsManager":"ConfigsManager","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/Image":"Image","../Commons/MonsterPreview":"MonsterPreview","../Equip/equip/EquipCtrl":"EquipCtrl","../Ornament/OrnamentCtrl":"OrnamentCtrl","../Totems/TotemsUtils":"TotemsUtils","./MonsterController":"MonsterController","./WarTeam":"WarTeam"}],MonsterPreview:[function(e,t,i){"use strict";cc._RF.push(t,"6bbdcO+HjpP+Z9l14wzfCfs","MonsterPreview"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../Scene/Avater/AvatarBase"),a=e("../../Global/GlobalValue"),r=e("../../Core/TimeController"),s=e("../WarTeam/MonsterController"),l=e("./SpineShotView"),c=e("./Image"),d=e("../Role/RoleController"),p=e("../../Core/LoadManager"),h=e("../../GlobalContext"),u=e("../../Core/ConfigsManager"),f=e("../../Util/Utils"),g=cc._decorator,y=g.ccclass,m=g.property,C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.PreviewBody=null,t.SpineShotView=null,t.RoleTitle=null,t.type="monster",t.cardid=0,t.skin="skin1",t.scaName="",t.grade=1,t.level=1,t.playing=!0,t.stopUseImage=!1,t.useShot=!1,t._qipaitime=0,t.avatar=null,t.image=null,t._qipaonde=null,t._roleTitle=null,t._body=null,t._priority=0,t._hasShade=!1,t._anim=a.ACTION.STAND,t._dir=a.DIR.RIGHT,t.isConf=null,t.readlySpineCallFunc=null,t.readlySpineCallThisObj=null,t.animOneEndCall=null,t.animOneEndThisObj=null,t}return __extends(t,e),t.prototype.onLoad=function(){if(e.prototype.onLoad.call(this),this.stopUseImage){var t=new cc.Node;this.node.addChild(t),t.setPosition(0,0),this.image=t.addComponent(c.default)}0==this.useShot?(this._body=cc.instantiate(this.PreviewBody),this.node.addChild(this._body),this._body.setPosition(0,0),this.avatar=this._body.getComponent(o.default),this.avatar.body.readlySpineCall=this.readlySpineCall,this.avatar.body.readlySpineCallThisObj=this):(this._body=cc.instantiate(this.SpineShotView),this.node.addChild(this._body),this._body.setPosition(0,0),this.avatar=this._body.getComponent(l.default).Avatar)},t.prototype.start=function(){e.prototype.start.call(this),this.cardid&&this.cardid>0&&(this.skin=a.DEFAULTS_SKIN+this.grade,this.init(this.type,this.cardid,this.grade,this.skin,a.PRIORITY.MONSTER,this._hasShade,this._anim,this._dir))},t.prototype.init=function(e,t,i,n,o,r,c,d,p,f,g,y,m){var C,v;if(void 0===n&&(n="skin1"),void 0===o&&(o=a.PRIORITY.MONSTER),void 0===r&&(r=!1),void 0===c&&(c=a.ACTION.STAND),void 0===d&&(d=a.DIR.RIGHT),void 0===p&&(p=1),void 0===g&&(g=null),void 0===y&&(y=null),void 0===m&&(m=null),this.onClearTitle(),this.type=e,this.cardid=t,this.grade=i,this.skin=n,this._priority=o,this._hasShade=r,this._anim=c,this._dir=d,this.level=p,this.scaName=f,null!=m&&(this.isConf=m),g&&(this.readlySpineCallFunc=g,this.readlySpineCallThisObj=y),"role"==e?(C=t,v="skin",n=null,this.skin=null):(C=s.default.instance.getCardGradeBySpine(t,i),v=s.default.instance.getCardGradeBySpineName(t,i),C||(C=u.ConfigsManager.instance.getConfigs("loadmonsterconf").monsterconf[1][this.isConf].modelid,v=u.ConfigsManager.instance.getConfigs("loadmonsterconf").monsterconf[1][this.isConf].spineName)),this.avatar)if(0==this.useShot){if(this.stopUseImage)if(this.avatar.node.active=this.playing,this.image.node.active=!this.playing,1==this.playing)this.avatar.init(e,C,v,n,o,r,c,d);else{var _=h.GlobalContext.ResRoot+"resources/monster/Lineup/Lineup1-1.png";this.image.loadImageByHttps(_),this.image.node.setPosition(-4,63)}else this.avatar.init(e,C,v,n,o,r,c,d);if(this.level&&this.scaName&&""!=this.scaName&&this.node.getComponentInChildren(sp.Skeleton)&&t&&t>0){var b=this.node,T=cc.v2(b.scaleX,b.scaleY),S=s.default.instance.getMonsterConf(t,this.grade,this.level);S&&Math.abs(b.scaleX)!=S[this.scaName]&&Math.abs(b.scaleY)!=S[this.scaName]&&this.node.setScale(T.mul(S[this.scaName]))}}else this._body.getComponent(l.default).init(e,t,i,n,o,r,c,d)},Object.defineProperty(t.prototype,"height",{get:function(){var e=null;return(e="monster"==this.type?s.default.instance.getCardGradeByGradeConf(this.cardid,this.grade):d.default.instance.getModelConfByModelId(this.cardid))?e.height:this._body.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){var e=null;return(e="monster"==this.type?s.default.instance.getCardGradeByGradeConf(this.cardid,this.grade):d.default.instance.getModelConfByModelId(this.cardid))?e.width:this._body.width},enumerable:!0,configurable:!0}),t.prototype.setAnimOneEnd=function(e,t){this.animOneEndCall=e,this.animOneEndThisObj=t,this.avatar.body&&(this.avatar.body.animEndCall=this.animEndCall,this.avatar.body.animEndCallThisObj=this)},t.prototype.animEndCall=function(){this.animOneEndCall&&this.animOneEndCall.apply(this.animOneEndThisObj)},t.prototype.clearAnimEndCall=function(){this.animOneEndCall&&(this.animOneEndCall=null,this.animOneEndThisObj=null,this.avatar.body&&(this.avatar.body.animEndCall=null,this.avatar.body.animEndCallThisObj=null))},t.prototype.onClearTitle=function(){this._roleTitle&&this._roleTitle.parent&&(this._roleTitle.parent.removeChild(this._roleTitle),this._roleTitle=null)},t.prototype.onShowRoleTitle=function(e){},t.prototype.play=function(e,t){this._anim=e,this._dir=t,this.avatar&&this.avatar.play(e,null,t)},t.prototype.stopAnim=function(){this.avatar&&this.avatar.body.stopAnim()},t.prototype.clear=function(){this.avatar&&this.avatar.clear(),this.image&&this.image.clear(),this.isConf&&(this.isConf=null),this.cardid=0,this.grade=0,this._priority=0,this.level=0,this.clearAnimEndCall(),this.hideQiPao()},t.prototype.dispose=function(){this.avatar&&(this.avatar.dispose(),this.avatar=null),this.image&&(this.image.dispose(),this.image=null),e.prototype.dispose.call(this)},t.prototype.readlySpineCall=function(){var e=this;this.readlySpineCallFunc&&this.readlySpineCallFunc.call(this.readlySpineCallThisObj);var t=r.default.instance.setTimeout(function(){0==e.playing&&e.stopAnim(),r.default.instance.clearTimeout(t)},this,100)},t.prototype.hide=function(){e.prototype.hide.call(this),this.hideQiPao()},t.prototype.hideQiPao=function(){this._qipaonde&&(this._qipaonde.active=!1),this._qipaitime&&(r.default.instance.clearTimeout(this._qipaitime),this._qipaitime=0)},t.prototype.showQiPao=function(e,t){var i=this;this._qipaonde?this.setQipao(e,t):p.default.instance.loadResByType(h.GlobalContext.Root+"prefab/scene/QiPao",cc.Prefab,function(n){i._qipaonde=f.default.getNodeByUrl(n,h.GlobalContext.Root+"prefab/scene/QiPao"),i.node.addChild(i._qipaonde),i.setQipao(e,t)},this)},t.prototype.setQipao=function(e,t){this._qipaonde.getChildByName("QiPaoLabel").getComponent(cc.Label).string=e,this._qipaonde.active=!0;var i=1/this.node.scale;this._qipaonde.scaleY=i,this._body.scaleX<0?(this._qipaonde.scaleX=-i,this._qipaonde.getChildByName("QiPaoLabel").scaleX=-1):(this._qipaonde.scaleX=i,this._qipaonde.getChildByName("QiPaoLabel").scaleX=1),this.avatar&&this._qipaonde.setPosition(this.width/2*this.node.scale,this.height+this._qipaonde.height/2),t&&(this._qipaitime=r.default.instance.setTimeout(this.hide,this,t))},__decorate([m(cc.Prefab)],t.prototype,"PreviewBody",void 0),__decorate([m(cc.Prefab)],t.prototype,"SpineShotView",void 0),__decorate([m(cc.Prefab)],t.prototype,"RoleTitle",void 0),__decorate([m(cc.String)],t.prototype,"type",void 0),__decorate([m(cc.Integer)],t.prototype,"cardid",void 0),__decorate([m(cc.String)],t.prototype,"skin",void 0),__decorate([m(cc.String)],t.prototype,"scaName",void 0),__decorate([m(cc.Integer)],t.prototype,"grade",void 0),__decorate([m(cc.Integer)],t.prototype,"level",void 0),__decorate([m(cc.Boolean)],t.prototype,"playing",void 0),__decorate([m(cc.Boolean)],t.prototype,"stopUseImage",void 0),t=__decorate([y],t)}(n.default);i.default=C,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Role/RoleController":"RoleController","../Scene/Avater/AvatarBase":"AvatarBase","../WarTeam/MonsterController":"MonsterController","./Image":"Image","./SpineShotView":"SpineShotView"}],Monster:[function(e,t,i){"use strict";cc._RF.push(t,"c817dDlwmpJpJtw0nlBtqMK","Monster"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./ActiveActor"),o=e("../../Global/GlobalValue"),a=e("./Pool/ActorPools"),r=e("../../Core/TimeController"),s=e("./Manager/SceneManager"),l=cc._decorator,c=l.ccclass,d=(l.property,function(e){function t(){var t=e.call(this)||this;return t._usingTag=!1,t.name="Monster",t}return __extends(t,e),Object.defineProperty(t.prototype,"using",{get:function(){return this._usingTag},set:function(e){this._usingTag=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBoss",{get:function(){return!1},enumerable:!0,configurable:!0}),t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this),this.init2()},t.prototype.init2=function(){if(this.isLive){this.isDraging=!1,e.prototype.initWithXY.call(this,"monster",this.prop.spineId,this.prop.spineName,o.DEFAULTS_SKIN+this.prop.grade,this.prop.x,this.prop.y,o.PRIORITY.MONSTER,!1,o.ACTION.STAND,this.prop.dir),this.setNameVisible(!0),this.updateBloodBarHp()}},t.prototype.recovery=function(){this.movingTag=!1,this.clearParabola(),this.atkTarget=[],a.ActorPools.recoverMonster(this.node)},t.prototype.clear=function(){this.removeBloodAndBuff(),this.using=!1,e.prototype.clear.call(this)},t.prototype.disappear=function(){this.removeBloodAndBuff(),e.prototype.disappear.call(this)},t.prototype.updateBloodBarHp=function(){e.prototype.updateBloodBarHp.call(this)},t.prototype.damage=function(){var e=this;this.avatar.node.color=new cc.Color(255,127,127,255);r.default.instance.setTimeout(function(){e.setColor()},this,200/s.default.instance.fightViewPlayRate)},t.prototype.addHp=function(){var e=this;this.avatar.node.color=new cc.Color(127,255,127,255);r.default.instance.setTimeout(function(){e.setColor()},this,200/s.default.instance.fightViewPlayRate)},t.prototype.updateData=function(t,i){e.prototype.updateData.call(this,t,i)},t.prototype.moveTowardTarget=function(t,i){e.prototype.moveTowardTarget.call(this,t,i)},t.prototype.hpOverDead=function(){e.prototype.hpOverDead.call(this)},t.prototype.removeBloodAndBuff=function(){this.isBoss||this.setBloodVisible(!1)},t.prototype.playPrewarSkill=function(){e.prototype.playPrewarSkill.call(this)},t.prototype.useInitiativeSkill=function(t,i,n){void 0===n&&(n=!1),e.prototype.useInitiativeSkill.call(this,t,i,n)},t=__decorate([c],t)}(n.default));i.default=d,cc._RF.pop()},{"../../Core/TimeController":"TimeController","../../Global/GlobalValue":"GlobalValue","./ActiveActor":"ActiveActor","./Manager/SceneManager":"SceneManager","./Pool/ActorPools":"ActorPools"}],MorphologicalTags:[function(e,t,i){"use strict";cc._RF.push(t,"55424mDwI5E35KqgFMYnbvl","MorphologicalTags"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/GameEventDispatcher"),a=e("../../Core/Event"),r=e("../../NetConnect/NetConnet"),s=cc._decorator,l=s.ccclass,c=(s.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.defalutIndex=1,t._tabIndex=-1,t}return __extends(t,e),t.prototype.setShow=function(e){this._tabIndex>=0&&(this.node.children[this._tabIndex-1].getComponent(cc.Toggle).isChecked=!1),this._tabIndex=e,this.node.children[this._tabIndex-1].getComponent(cc.Toggle).isChecked=!0,this.sendproto(this._tabIndex)},t.prototype.hide=function(){e.prototype.hide.call(this),this.sendproto(1)},t.prototype.onClickTab=function(e){e&&this._tabIndex!=parseInt(e.target.name)&&(this._tabIndex=parseInt(e.target.name),o.GameEventDispatcher.instance.emit(a.EventDefiner.MorphologicalTags_onClick,{tabIndex:this._tabIndex?this._tabIndex:5}),this.sendproto(this._tabIndex))},t.prototype.sendproto=function(e){var t={cmd:"setcalcgrade",grade:e};r.default.instance.sendProto(t)},t=__decorate([l],t)}(n.default));i.default=c,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Widget":"Widget","../../NetConnect/NetConnet":"NetConnet"}],MotionStreakWidget:[function(e,t,i){"use strict";cc._RF.push(t,"fcd97w/zRhOvJiyFeSf2Dz5","MotionStreakWidget"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Util/Utils"),a=e("../../Core/WindowType"),r=e("../../Core/TimeController"),s=cc._decorator,l=s.ccclass,c=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.EffectItem=null,t.MoveView=null,t.EffectContainer=null,t._lastPos=null,t._moveLength=50,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this),this.EffectItem.removeFromParent(!1)},t.prototype.show=function(){e.prototype.show.call(this),this.MoveView.on(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this)},t.prototype.hide=function(){e.prototype.hide.call(this),this.clear(),this.MoveView.off(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),this._lastPos=null},t.prototype.clear=function(){for(var e=this.EffectContainer.childrenCount-1;e>=0;e--){var t=this.EffectContainer.children[e];this.removeEffectOne(t)}},t.prototype.touchMove=function(e){var t=this.MoveView.convertToNodeSpaceAR(e.getLocation());if(this._lastPos){var i=this._lastPos;o.default.distance(i.x,i.y,t.x,t.y)>this._moveLength&&(this.addEffectOne(t),this._lastPos=t)}else this.addEffectOne(t),this._lastPos=t},t.prototype.addEffectOne=function(e){var t=this,i=o.default.getNodeByPool(a.PoolType.MotionStreakEffectItem,this.EffectItem);this.EffectContainer.addChild(i),i.setPosition(e);var n=r.default.instance.setTimeout(function(){t.removeEffectOne(i),r.default.instance.clearTimeout(n)},this,1e3)},t.prototype.removeEffectOne=function(e){o.default.setNodeToPool(a.PoolType.MotionStreakEffectItem,e)},__decorate([c(cc.Node)],t.prototype,"EffectItem",void 0),__decorate([c(cc.Node)],t.prototype,"MoveView",void 0),__decorate([c(cc.Node)],t.prototype,"EffectContainer",void 0),t=__decorate([l],t)}(n.default);i.default=d,cc._RF.pop()},{"../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../Util/Utils":"Utils"}],MoveUtil:[function(e,t,i){"use strict";cc._RF.push(t,"8fd44ttRL1GpLpYXBX7vEn1","MoveUtil"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(){}return e.getRealSpeed=function(t,i){return 0==i||4==i?t*e.V_COEFFICIENT:2==i||6==i?t*e.H_COEFFICIENT:t},e.getSpeedByMoveTime=function(t,i,n){return t*e.getRealSpeed(i,n)/1e3},e.getDiretion=function(e,t,i,n){var o,a=i-e,r=n-t,s=180*Math.atan2(r,a)/Math.PI;return s>=-15&&s<15?o=2:s>=15&&s<75?o=3:s>=75&&s<105?o=4:s>=105&&s<170?o=5:s>=170||s<-170?o=6:s>=-75&&s<-15?o=1:s>=-105&&s<-75?o=0:s>=-170&&s<-105&&(o=7),o},e.getDisMePos=function(e,t,i,n,o){var a=i-e,r=n-t,s=o/Math.sqrt((n-t)*(n-t)+(i-e)*(i-e));return this.p.x=s*a+e,this.p.y=s*r+t,this.p},e.getDisTargetPos=function(e,t,i,n,o){var a=i-e,r=n-t,s=o/Math.sqrt((n-t)*(n-t)+(i-e)*(i-e));return this.p.x=s*a+i,this.p.y=s*r+n,this.p},e.getNearRunCell=function(e,t,i,n,o,a){return void 0===o&&(o=32),void 0===a&&(a=!0),null},e.getRandomNearPt=function(e,t,i){return void 0===i&&(i=200),this.p},e.getClockwiseNearPt=function(e,t){return this.p},e.getPixelDis=function(e,t,i,n){return Math.sqrt((e-i)*(e-i)+(t-n)*(t-n))},e.getTileDis=function(e,t){var i=Math.abs(e.x-t.x),n=Math.abs(e.y-t.y);return i>=n?i:n},e.getRotation=function(e){return 180*this.getAngleByDir(e)/Math.PI},e.getAngleByDir=function(e){var t=0;switch(e){case 0:t=Math.PI/2;break;case 1:t=Math.PI/4;break;case 2:t=0;break;case 3:t=-Math.PI/4;break;case 4:t=-Math.PI/2;break;case 5:t=3*-Math.PI/4;break;case 6:t=Math.PI;break;case 7:t=3*Math.PI/4;break;default:t=0}return t},e.V_COEFFICIENT=.6324,e.H_COEFFICIENT=1.265,e.tileAng=.4625,e.p=new cc.Vec2,e}();i.MoveUtil=n,cc._RF.pop()},{}],MyServersListItem:[function(e,t,i){"use strict";cc._RF.push(t,"69e8cRQD5tKSZLQc2RJoWYK","MyServersListItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("./SelectServersPanel"),a=e("../../Core/Language"),r=e("../Gamelayer/RoleHead"),s=cc._decorator,l=s.ccclass,c=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.curserverstatus=null,t.serverNumLabel=null,t.serverNameLabel=null,t.fightLb=null,t.sex=null,t.playerName=null,t.roleHead=null,t.serverNum=50,t.index=0,t.data=null,t}return __extends(t,e),t.prototype.start=function(){this.node.on(cc.Node.EventType.TOUCH_END,this.onSelect,this)},t.prototype.setData=function(e,t){if(this.data=e,this.index=t,this.curserverstatus.spriteFrame=o.default.instance.getStatusSprite(e.status),this.serverNumLabel.string=e.server_id+a.default.getStr("\u533a"),this.serverNumLabel.string=decodeURIComponent(e.name+""),o.default.instance.serverInfo.role_info&&o.default.instance.serverInfo.role_info.length>0)for(var i=o.default.instance.serverInfo.role_info,n=0;n<i.length;n++)i[n].srvid==this.data.server_id&&(this.sex.spriteFrame=o.default.instance.getStatusSprite("sex"+i[n].gender),this.playerName.string=decodeURIComponent(i[n].name),this.fightLb.string=i[n].fight,this.roleHead.SetHead(i[n].icon))},t.prototype.onSelect=function(){o.default.instance.setMyServertListItem(this.data)},t.prototype.hide=function(){this.node.off(cc.Node.EventType.TOUCH_END,this.onSelect)},__decorate([c(cc.Sprite)],t.prototype,"curserverstatus",void 0),__decorate([c(cc.Label)],t.prototype,"serverNumLabel",void 0),__decorate([c(cc.Label)],t.prototype,"serverNameLabel",void 0),__decorate([c(cc.Label)],t.prototype,"fightLb",void 0),__decorate([c(cc.Sprite)],t.prototype,"sex",void 0),__decorate([c(cc.Label)],t.prototype,"playerName",void 0),__decorate([c(r.default)],t.prototype,"roleHead",void 0),t=__decorate([l],t)}(n.default);i.default=d,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/Widget":"Widget","../Gamelayer/RoleHead":"RoleHead","./SelectServersPanel":"SelectServersPanel"}],NetConnet:[function(e,t,i){"use strict";cc._RF.push(t,"7cfd8qzvbdKDqqsBGkUz0Dv","NetConnet"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Core/Controller"),o=e("../Core/GameEventDispatcher"),a=e("../Core/Event"),r=e("../Util/SDKUtils"),s=e("../GlobalContext"),l=e("../Core/TimeController"),c=cc._decorator,d=c.ccclass,p=(c.property,function(){function e(){this.ws=null,this.IsConnecting=!1,this.waitSendList=[],this.isTryReConnecting=!1,this.tryReConnectCount=0,this.tryReConnectMax=3,this.reconnkey=""}var t;return t=e,Object.defineProperty(e,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this.ws&&(this.IsConnecting=!1,this.ws.onopen=null,this.ws.onclose=null,this.ws.onmessage=null,this.ws.close(),this.ws=null,console.log("\u6e05\u7406\u94fe\u63a5socket, url:"+this.ws))},e.prototype.connect=function(e){var t=this;void 0===e&&(e=!1),this.clear();var i=r.default.instance.wsUrl;e&&(i=r.default.instance.wsUrl+"&reconnect="+this.reconnkey+"&actorid="+s.PlayerData.actorid);var n=cc.url.raw("resources/cacert.pem");cc.loader.md5Pipe&&(n=cc.loader.md5Pipe.transformURL(n));var l=null;l=cc.sys.isNative?new WebSocket(i,null,n):new WebSocket(i),this.ws=l,l.onopen=function(){for(console.log("\u8fde\u63a5\u6210\u529f"),t.IsConnecting=!0,1==t.isTryReConnecting&&(console.log("\u65ad\u7ebf\u91cd\u8fde\u6210\u529f"),s.PlayerData.tipWinNode.active=!1),t.isTryReConnecting=!1,t.tryReConnectCount=0,o.GameEventDispatcher.instance.emit(a.EventDefiner.SocketConnectSuccess);t.waitSendList.length>0;){var e=t.waitSendList.shift();t.sendProto(e)}},l.onclose=function(){console.log("socket.onclose\u65ad\u5f00\u8fde\u63a5"),t.reConnect()},l.onmessage=function(e){var i=Object.prototype.toString.call(e.data);if("[object String]"===i){var n=JSON.parse(e.data);t.getData(n)}else if("[object Blob]"===i){var o=new FileReader;o.onload=function(){var e=JSON.parse(o.result);t.getData(e)},o.readAsText(e.data)}else if("[object ArrayBuffer]"===i){n=JSON.parse(t.decodeUTF8(e.data));t.getData(n)}}},e.prototype.decodeUTF8=function(e){for(var t="",i=new Uint8Array(e),n=i.byteLength,o=0;o<n;o++)t+=String.fromCharCode(i[o]);return decodeURIComponent(escape(t))},e.prototype.reConnect=function(){this.IsConnecting=!1,this.isTryReConnecting=!1,this.tryReConnectCount<this.tryReConnectMax?this.tryReConnect():o.GameEventDispatcher.instance.emit(a.EventDefiner.SocketConnectFail)},e.prototype.sendProto=function(e){if(1==this.IsConnecting){var t=e;navigator.userAgent.match(/(iPhone|iPod|Android|ios)/i)&&(t=JSON.stringify(e)),console.log("\u8bf7\u6c42\u6570\u636e:",t),this.ws.send(JSON.stringify(e))}else{for(var i=!1,n=0;n<this.waitSendList.length;n++)if(this.waitSendList[n].cmd==e.cmd&&1==this.checkIsSameData(this.waitSendList[n],e)){this.waitSendList[n]=e,i=!0;break}0==i&&this.waitSendList.push(e),0==this.isTryReConnecting&&this.tryReConnectCount>=this.tryReConnectMax&&(console.log("\u5f53\u524d\u5df2\u7ecf\u6ca1\u6709\u5728\u5c1d\u8bd5\u91cd\u8fde\u4e86\uff0c\u7136\u540e\u73b0\u5728\u8fd8\u662f\u9700\u8981\u5c1d\u8bd5\u91cd\u8fdewebSocket"),this.tryReConnectCount=0,this.tryReConnect())}},e.prototype.checkIsSameData=function(e,t){if(e==t)return!0;if(!e||!t)return!1;var i=Object.prototype.toString.call(e);if(i!=Object.prototype.toString.call(t))return!1;if("[object Array]"===i||"[object Object]"===i){for(var n in e)if(0==this.checkIsSameData(e[n],t[n]))return!1}else if(e!=t)return!1;return!0},e.prototype.tryReConnect=function(){var e=this;if(0==this.isTryReConnecting&&this.tryReConnectCount<this.tryReConnectMax&&null!=this.reconnkey){this.isTryReConnecting=!0,this.tryReConnectCount++;var t=l.default.instance.setTimeout(function(){console.log("\u7b2c"+e.tryReConnectCount+"\u6b21\u5c1d\u8bd5\u91cd\u8fdewebSocket"),e.connect(!0),l.default.instance.clearTimeout(t)},this,2e3)}},e.prototype.getData=function(e){if("heart"!=e.cmd){var t=e;navigator.userAgent.match(/(iPhone|iPod|Android|ios)/i)&&(t=JSON.stringify(e)),console.log("\u6536\u5230\u6570\u636e, data:",t)}var i=e.cmd+"",o=n.default.ProtoCallbackDic[i];if(o&&o.length>0)for(var a=0;a<o.length;a++){var r=o[a];if(r){var s=r[0],l=r[1];s.call(l,e)}}},e.prototype.getWebSocketUrl=function(){var e=this.getQueryString("websocketdomain"),t=this.getQueryString("port"),i=this.getQueryString("sign"),n=this.getQueryString("timestamp"),o=this.getQueryString("nonstr"),a=null!==this.getQueryString("isi"),l=this.getQueryString("post_data"),c=JSON.parse(l),d=(c.gameid,c.roomid,r.default.instance.openId),p="ws://";return a||(p="wss://"),p+e+":"+t+"/?nonstr="+o+"&sign="+i+"&userid="+d+"&timestamp="+n+"&post_data="+encodeURI(JSON.stringify(s.PlayerData.userInfo))},e.prototype.getQueryString2=function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),i=window.location.search.substr(1).match(t);return null!==i?i[2]:null},e.prototype.getQueryString=function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),i=window.location.search.substr(1).match(t);return null!==i?unescape(i[2]):null},e=t=__decorate([d],e)}());i.default=p,cc._RF.pop()},{"../Core/Controller":"Controller","../Core/Event":"Event","../Core/GameEventDispatcher":"GameEventDispatcher","../Core/TimeController":"TimeController","../GlobalContext":"GlobalContext","../Util/SDKUtils":"SDKUtils"}],NewFunction:[function(e,t,i){"use strict";cc._RF.push(t,"6ff6cAvjxZJeKGXFjR/4B0U","NewFunction"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../Functionicon/FunctionIconController"),a=e("./FunctionType"),r=e("../../Core/TimeController"),s=cc._decorator,l=s.ccclass,c=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.FuncId=0,t.FuncType=0,t.New=null,t.id=null,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this),0!=this.FuncType?this.checkNew():this.ActiveNewFunc()},t.prototype.onEnable=function(){this.scalling(this.New)},t.prototype.onDisable=function(){this.New.stopAllActions()},t.prototype.ActiveNewFunc=function(){for(var e in o.default.instance.NewFunc)o.default.instance.NewFunc[e]==this.FuncId&&(this.id=e,this.New.active=!0,this.scalling(this.New))},t.prototype.closeNewFunc=function(e){e.getUserData()==this.FuncId&&(o.default.instance.NewFunc[this.id]=0,this.node.active=!1)},t.prototype.scalling=function(e){e.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.25,1),cc.scaleTo(.6,1.4))))},t.prototype.checkNew=function(){var e=this,t=function(t){if(o.default.instance.NewFunc[t]==a.FunctionType.EliteBoss||o.default.instance.NewFunc[t]==a.FunctionType.Expedition||o.default.instance.NewFunc[t]==a.FunctionType.FridBoss||o.default.instance.NewFunc[t]==a.FunctionType.TreasureMap||o.default.instance.NewFunc[t]==a.FunctionType.WorldBoss||o.default.instance.NewFunc[t]==a.FunctionType.Mine){if(1==i.FuncType){i.New.active=!0,i.scalling(i.New);var n=r.default.instance.setTimeout(function(){e.checkNew(),r.default.instance.clearTimeout(n)},i,1e3);return{value:void 0}}}else if((o.default.instance.NewFunc[t]==a.FunctionType.Arena||o.default.instance.NewFunc[t]==a.FunctionType.Ladder)&&2==i.FuncType){i.New.active=!0,i.scalling(i.New);var s=r.default.instance.setTimeout(function(){e.checkNew(),r.default.instance.clearTimeout(s)},i,1e3);return{value:void 0}}},i=this;for(var n in o.default.instance.NewFunc){var s=t(n);if("object"==typeof s)return s.value}this.New.active=!1,this.New.stopAllActions()},__decorate([c(cc.Integer)],t.prototype,"FuncId",void 0),__decorate([c(cc.Integer)],t.prototype,"FuncType",void 0),__decorate([c(cc.Node)],t.prototype,"New",void 0),t=__decorate([l],t)}(n.default);i.default=d,cc._RF.pop()},{"../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../Functionicon/FunctionIconController":"FunctionIconController","./FunctionType":"FunctionType"}],NicknameChange:[function(e,t,i){"use strict";cc._RF.push(t,"668a08jz+tLYYZ7END5sbDL","NicknameChange"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Commons/CommonPageBG"),o=e("../../Core/Language"),a=e("../Role/RoleInfo"),r=e("../../Core/ConfigsManager"),s=e("../../NetConnect/NetConnet"),l=e("../Tips/OpTipsController"),c=e("../../Core/GameEventDispatcher"),d=cc._decorator,p=d.ccclass,h=d.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.editBox=null,t.diamondLabe=null,t._configs=null,t}return __extends(t,e),t.prototype.onLoad=function(){this._configs=r.ConfigsManager.instance.getConfigs("rolenameconf")},t.prototype.show=function(){e.prototype.show.call(this),this.editBox.string="",this.onInit(622,352,o.default.getStr("\u6635\u79f0\u4fee\u6539"),!0);var t=this._configs.RoleConf[0].ChangeNameNeedCsm,i=t[0]+a.MyRoleInfo.nameChangeCnt*t[1]<t[2]?t[0]+a.MyRoleInfo.nameChangeCnt*t[1]:t[2];this.diamondLabe.string=i,c.GameEventDispatcher.instance.on("CloseNameChange",this.onClose,this)},t.prototype.hide=function(){e.prototype.hide.call(this),c.GameEventDispatcher.instance.off("CloseNameChange",this.onClose,this)},t.prototype.onRandomClick=function(){var e=this._configs.Randomname[1].Names,t=this._configs.Randomname[2].Names,i=this._configs.Randomname[3].Names,n=this._configs.Randomname[4].Names,o=this._configs.Randomname[5].Names,r=this._configs.Randomname[6].Names,s=Math.floor(Math.random()*this._configs.Names[e].length),l=Math.floor(Math.random()*this._configs.Names[t].length),c=Math.floor(Math.random()*this._configs.Names[i].length),d=Math.floor(Math.random()*this._configs.Names[n].length),p=Math.floor(Math.random()*this._configs.Names[o].length),h=Math.floor(Math.random()*this._configs.Names[r].length);0==a.MyRoleInfo.sex?s>this._configs.Names[e].length/2?this.editBox.string=this.RandomName(e,s)+this.RandomName(t,l):s<=this._configs.Names[e].length/2&&(this.editBox.string=this.RandomName(e,s)+this.RandomName(t,l)+this.RandomName(i,c)):1==a.MyRoleInfo.sex&&(d>this._configs.Names[n].length/2?this.editBox.string=this.RandomName(n,d)+this.RandomName(o,p):d<=this._configs.Names[n].length/2&&(this.editBox.string=this.RandomName(n,d)+this.RandomName(o,p)+this.RandomName(r,h)))},t.prototype.RandomName=function(e,t){return this._configs.Names[e][t].name},t.prototype.confirmBtn=function(){if(this.editBox.string&&""!=this.editBox.string){var e={cmd:"changename",name:this.editBox.string};s.default.instance.sendProto(e)}else l.default.instance.ShowMsg(o.default.getStr("\u8f93\u5165\u4e0d\u80fd\u4e3a\u7a7a"))},__decorate([h(cc.EditBox)],t.prototype,"editBox",void 0),__decorate([h(cc.Label)],t.prototype,"diamondLabe",void 0),t=__decorate([p],t)}(n.default);i.default=u,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../NetConnect/NetConnet":"NetConnet","../Commons/CommonPageBG":"CommonPageBG","../Role/RoleInfo":"RoleInfo","../Tips/OpTipsController":"OpTipsController"}],NumberUtil:[function(e,t,i){"use strict";cc._RF.push(t,"ae76eNIOl9JR7uDris1pzSQ","NumberUtil"),Object.defineProperty(i,"__esModule",{value:!0});var n,o=function(){function e(){}return e.unitsDigitToText=function(e){if(e<0)return"";var t=function(e){return n[e]},i="",o=1,a=0,r=!1;if(0==e)i=t("digitTxt_"+parseInt(e+""));else for(;e>0;)0==(a=parseInt(e%10+""))&&0==r&&(o>1&&(i=t("digitTxt_0")+i),r=!0),0!=a||1!=r?(0!=a&&1==r&&(r=!1),o>1&&0!=a&&(i=t("digitTxt_"+parseInt(o+""))+i),0!=a&&(10==o&&1==e||(i=t("digitTxt_"+parseInt(a+""))+i)),e=parseInt(e/10+""),o=parseInt(10*o+"")):(e=parseInt(e/10+""),o=parseInt(10*o+""));return i},e.toFixed=function(e,t){if(void 0===t&&(t=2),0==t)return Math.floor(e)+"";var i=e.toString().split(".");if(i.length<=1)return e.toString();if(i[1].length<=t)return e.toString();for(var n=Math.pow(10,t),o=(Math.floor(e*n)/n).toString(),a=o.charAt(o.length-1);"."!=a&&"0"==a;)a=(o=o.substring(0,o.length-1)).charAt(o.length-1);return o},e.getNumber=function(t){return t>=1e8?e.toFixed(t/1e8,0)+"\u4ebf":t>=1e4?e.toFixed(t/1e4,0)+"\u4e07":t.toString()},e.getDiamondNum=function(t){return t>=1e7?e.toFixed(t/1e4,0)+"\u4e07":t.toString()},e.getNumberW=function(t){return t>=1e4?e.toFixed(t/1e4,0):t.toString()},e}();i.NumberUtil=o,function(e){e.digitTxt_0="\u96f6",e.digitTxt_1="\u4e00",e.digitTxt_2="\u4e8c",e.digitTxt_3="\u4e09",e.digitTxt_4="\u56db",e.digitTxt_5="\u4e94",e.digitTxt_6="\u516d",e.digitTxt_7="\u4e03",e.digitTxt_8="\u516b",e.digitTxt_9="\u4e5d",e.digitTxt_10="\u5341",e.digitTxt_100="\u767e",e.digitTxt_1000="\u5343",e.digitTxt_10000="\u4e07"}(n=i.DigitTxtDefiner||(i.DigitTxtDefiner={})),cc._RF.pop()},{}],OhterPlayer:[function(e,t,i){"use strict";cc._RF.push(t,"1f8d9AIamtGm4OZpHvJZHtu","OhterPlayer"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./Role"),o=e("../../Global/GlobalValue"),a=e("./Pool/ActorPools"),r=function(e){function t(){var t=e.call(this)||this;return t.name="OtherPlayer",t}return __extends(t,e),t.prototype.recovery=function(){a.ActorPools.recoverOtherPlayer(this.node)},t.prototype.updateData=function(t,i){e.prototype.updateData.call(this,t,i),this.moving(t),this.showingSmear(t)},t.prototype.stopMove=function(){this.movingTag=!1,this.status!=o.ACTION.STAND&&this.idle()},t.prototype.incHp=function(e,t){var i;if(t)i=t;else{var n=Math.floor(this.prop.maxHP*e);i=this.prop.maxHP+n<this.prop.maxHP?this.prop.maxHP+n:this.prop.maxHP}this.updateHp(i)},t.prototype.decHp=function(e,t){if(!(this.prop.hp<=0)){var i=t||this.prop.hp-e;this.updateHp(i)}},t.prototype.hpOverDead=function(){this.setBloodVisible(!1),this.dead()},t}(n.default);i.OtherPlayer=r,cc._RF.pop()},{"../../Global/GlobalValue":"GlobalValue","./Pool/ActorPools":"ActorPools","./Role":"Role"}],OneSeckillWin:[function(e,t,i){"use strict";cc._RF.push(t,"75d4c2meFZOo6ili5VV+lew","OneSeckillWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../../Core/ConfigsManager"),a=e("../../Core/TimeController"),r=e("../../Core/Language"),s=e("../../NetConnect/NetConnet"),l=e("../ActivityView/ActivityCtrl"),c=e("../../Core/WindowType"),d=e("../ActivityView/GroupPurchase/GroupPurchaseContrl"),p=e("../../Core/GameEventDispatcher"),h=e("../Commons/RewardUtils"),u=e("../../Util/Utils"),f=e("../Item/ItemIcon"),g=e("../../Util/SDKUtils"),y=e("../Tips/OpTipsController"),m=e("../../Core/LoadManager"),C=e("../../GlobalContext"),v=cc._decorator,_=v.ccclass,b=v.property,T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.timeOutLabe=null,t.content=null,t.discountBtn=null,t.bubbling=null,t.conf=null,t.timeOut=null,t.giftbag=null,t}var i;return __extends(t,e),i=t,t.prototype.show=function(){e.prototype.show.call(this),i.instance=this,u.default.setNodeChildDestoryByUrl(this.content,C.GlobalContext.Root+"prefab/OneSeckill/SeckillItem");s.default.instance.sendProto({cmd:"seckillopenUI",actid:16}),this.TimeOut(),p.GameEventDispatcher.instance.on("SECKILL",this.Init,this),p.GameEventDispatcher.instance.on("ChangeNum",this.GiftNumChange,this)},t.prototype.hide=function(){e.prototype.hide.call(this),p.GameEventDispatcher.instance.off("SECKILL",this.Init,this),this.timeOut&&(a.default.instance.clearInterval(this.timeOut),this.timeOut=null)},t.prototype.Init=function(){var e=this;this.conf=o.ConfigsManager.instance.getConfigs("cheapseckillConf");var t=l.default.instance.data.getYunyingData(c.WindowType.OneSeckill).idx,i=d.default.instance.OneSeckill;this.giftbag=this.conf.day[t][d.default.instance.SeckillDay].giftbag,this.discountBtn.getComponent(cc.Button).interactable=!i.length,this.discountBtn.getChildByName("Discount").active=!i.length,this.bubbling.active=!i.length,m.default.instance.loadResByType(C.GlobalContext.Root+"prefab/OneSeckill/SeckillItem",cc.Prefab,function(t){u.default.setNodeChildDestoryByUrl(e.content,C.GlobalContext.Root+"prefab/OneSeckill/SeckillItem");var i=function(i){var n=u.default.getNodeByUrl(t,C.GlobalContext.Root+"prefab/OneSeckill/SeckillItem");e.content.addChild(n),n.y=-13,n.name=e.conf.giftbag[e.giftbag][i].id+"";var o=h.default.instance.getItemList(e.conf.giftbag[e.giftbag][i].reward);n.getChildByName("BuyBtn").getComponentInChildren(cc.Label).string=r.default.getStr("{0}\u5143",e.conf.giftbag[e.giftbag][i].money);m.default.instance.loadResByType(C.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(e){for(var t in o){var i=u.default.getNodeByPool(c.PoolType.ItemIcon,e);i.setScale(.8,.8),i.getComponent(f.default).ItemData(o[t],!0,null,!0),n.getChildByName("ScrollView").getChildByName("view").getChildByName("content").addChild(i)}},e)};for(var n in e.conf.giftbag[e.giftbag])i(n)},this),this.scheduleOnce(function(){for(var t in e.content.children)i&&i[t]&&(cc.find(i[t].id+"/NumberLabe",e.content).active=!1,i[t].flag?(cc.find(i[t].id+"/GetBtn",e.content).active=!0,cc.find(i[t].id+"/GetBtn",e.content).getComponent(cc.Button).interactable=!1,cc.find(i[t].id+"/BuyBtn",e.content).active=!1):(cc.find(i[t].id+"/GetBtn",e.content).active=!0,cc.find(i[t].id+"/BuyBtn",e.content).active=!1,cc.find(i[t].id+"/GetBtn",e.content).getComponent(cc.Button).interactable=!0))})},t.prototype.TimeOut=function(){var e=this,t=a.default.instance.ServerTimeMins,i=Date.parse(new Date(new Date(new Date(a.default.instance.ServerTimeMins).toLocaleDateString()).getTime()+864e5-1).toString());this.timeOut=a.default.instance.setInterval(function(){var n=i-(t+=1e3),o=parseInt(""+n/1e3/60/60%24)+"\u65f6"+parseInt(""+n/1e3/60%60)+"\u5206"+parseInt(""+n/1e3%60)+"\u79d2";e.timeOutLabe.string=r.default.getStr("\u62a2\u8d2d\u5269\u4f59\u65f6\u95f4")+o},this,1e3)},t.prototype.GiftNumChange=function(e){var t=this;a.default.instance.setTimeout(function(){cc.find(e.getUserData().data.id+"/NumberLabe",t.content)&&(cc.find(e.getUserData().data.id+"/NumberLabe",t.content).getComponent(cc.Label).string=r.default.getStr("\u6570\u91cf\uff1a{0}",e.getUserData().data.giftbagnum))},this,500)},t.prototype.BuyBtnEvent=function(e,t){var i=Number(t);if(g.default.instance.isInitWX)g.default.instance.rechargeByIndex(i,function(e){e&&y.default.instance.ShowMsg(r.default.getStr("\u5145\u503c\u6210\u529f"))},this);else{var n={cmd:"gm",type:"diamondshop",param:[i]};s.default.instance.sendProto(n),y.default.instance.ShowMsg(r.default.getStr("\u5145\u503c\u6210\u529f"))}},t.prototype.GetRewardBtnEvent=function(e,t){var i;if(t)i=Number(t);else{var n=e.currentTarget.parent.getSiblingIndex();i=this.conf.giftbag[this.giftbag][n].id}var o={cmd:"seckillreward",id:i,actid:16};s.default.instance.sendProto(o)},t.instance=null,__decorate([b(cc.Label)],t.prototype,"timeOutLabe",void 0),__decorate([b(cc.Node)],t.prototype,"content",void 0),__decorate([b(cc.Node)],t.prototype,"discountBtn",void 0),__decorate([b(cc.Node)],t.prototype,"bubbling",void 0),t=i=__decorate([_],t)}(n.default);i.default=T,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/Window":"Window","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../NetConnect/NetConnet":"NetConnet","../../Util/SDKUtils":"SDKUtils","../../Util/Utils":"Utils","../ActivityView/ActivityCtrl":"ActivityCtrl","../ActivityView/GroupPurchase/GroupPurchaseContrl":"GroupPurchaseContrl","../Commons/RewardUtils":"RewardUtils","../Item/ItemIcon":"ItemIcon","../Tips/OpTipsController":"OpTipsController"}],OpTipsController:[function(e,t,i){"use strict";cc._RF.push(t,"fa6cbOHhsNAl7hA/nH37fdD","OpTipsController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../Util/Utils"),a=e("../../Core/WindowType"),r=e("../../Core/TimeController"),s=cc._decorator,l=s.ccclass,c=s.property,d=function(e){function t(){var t=e.call(this)||this;return t.Item=null,t._MsgList=[],t._MsgListPos={},t._Showing=!1,t._Time=null,i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.Clear=function(){for(var e=this.node.childrenCount-1;e>=0;e--){var t=this.node.children[e];t.stopAllActions(),o.default.setNodeToPool(a.PoolType.OpTipsItem,t)}this._Showing=!1,this._MsgList.length=0},t.prototype.ShowMsg=function(e,t){this._MsgList.indexOf(e)>=0||(this._MsgList.push(e),t&&(this._MsgListPos[e]=t),this.ShowMsgHandle())},t.prototype.ShowMsgHandle=function(){var e=this;if(1!=this._Showing){if(this._MsgList.length<=0)return this._Time&&r.default.instance.clearTimeout(this._Time),void(0!=this.node.x&&0!=this.node.y&&(this._Time=r.default.instance.setTimeout(function(){e.node.setPosition(0,0),r.default.instance.clearTimeout(e._Time)},this,1e3)));this._Time&&(r.default.instance.clearTimeout(this._Time),this._Time=null),this._Showing=!0;var t=this._MsgList.shift(),i=o.default.getNodeByPool(a.PoolType.OpTipsItem,this.Item);this.node.addChild(i);var n=i.getChildByName("Label").getComponent(cc.RichText);n.string=t;var s=i.getChildByName("BG"),l=r.default.instance.setTimeout(function(){s.width=n.node.width+150,r.default.instance.clearTimeout(l)},this,30),c=this._MsgListPos[t];c&&(this.node.setPosition(c),delete this._MsgListPos[t]),i.setPosition(0,50),i.opacity=255,i.runAction(cc.sequence(cc.delayTime(1),cc.callFunc(function(){i.runAction(cc.sequence(cc.spawn(cc.moveBy(1,0,80),cc.fadeOut(1)),cc.callFunc(function(){o.default.setNodeToPool(a.PoolType.OpTipsItem,i)},e))),e._Showing=!1,e.ShowMsgHandle()},this)))}},t.instance=null,__decorate([c(cc.Node)],t.prototype,"Item",void 0),t=i=__decorate([l],t)}(n.default);i.default=d,cc._RF.pop()},{"../../Core/Controller":"Controller","../../Core/TimeController":"TimeController","../../Core/WindowType":"WindowType","../../Util/Utils":"Utils"}],OpenFuncTips:[function(e,t,i){"use strict";cc._RF.push(t,"3008dJARBdBNomqLBUoQvS4","OpenFuncTips"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Functionicon/FunctionIconController"),o=e("../../Core/WindowManager"),a=e("../../Core/WindowType"),r=e("../../Core/Widget"),s=e("../../Core/GameEventDispatcher"),l=e("../../Core/Event"),c=e("../Guide/GuideNewController"),d=e("../../GlobalContext"),p=e("../Commons/WindowOpenUtils"),h=cc._decorator,u=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layerContent=null,t.nodeBgLight=[],t.spriteIcon=null,t.btnNodeArr=[],t.attrIcons=null,t._baseUrl=d.GlobalContext.ResRoot+"resources/OpenFun/",t.isFightExit=!1,t.openFunData=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.show=function(){e.prototype.show.call(this),this.node.opacity=1,this.onShowEffect()},t.prototype.onShowEffect=function(){this.node.opacity=255,this.layerContent.opacity=1,this.layerContent.scale=.1,this.spriteIcon.opacity=1,this.nodeBgLight[2].opacity=1,this.nodeBgLight[0].opacity=1,this.nodeBgLight[1].opacity=1,this.layerContent.runAction(cc.spawn(cc.scaleTo(.5,1),cc.fadeTo(.5,255))),this.nodeBgLight[2].runAction(cc.fadeTo(1,255)),this.onShowEffectBG()},t.prototype.onShowEffectBG=function(){var e=cc.callFunc(function(e){this.nodeBgLight[0].runAction(cc.repeatForever(cc.rotateBy(1,120)))},this);this.nodeBgLight[0].setScale(.1),this.nodeBgLight[0].runAction(cc.sequence(cc.spawn(cc.fadeTo(1,180),cc.rotateBy(1,720),cc.scaleTo(1,1.2)),cc.spawn(cc.fadeTo(1,255),cc.rotateBy(1,360),cc.scaleTo(1,1)),e));var t=cc.callFunc(function(e){this.nodeBgLight[1].runAction(cc.repeatForever(cc.rotateBy(1,-180)))},this);this.nodeBgLight[1].setScale(.1),this.nodeBgLight[1].runAction(cc.sequence(cc.spawn(cc.fadeTo(1,180),cc.rotateBy(1,-720),cc.scaleTo(1,1.2)),cc.spawn(cc.fadeTo(1,255),cc.rotateBy(1,-360),cc.scaleTo(1,1)),t))},t.prototype.onShowIconAct=function(){var e=this.openFunData&&this.openFunData.config?this.openFunData.config.iconScale:1;this.spriteIcon.setScale(.1),this.spriteIcon.runAction(cc.spawn(cc.fadeTo(.5,255),cc.scaleTo(.5,e)))},t.prototype.onShowPage=function(e,t){void 0===e&&(e=0),void 0===t&&(t=!1),this.openFunData=e>0?n.default.instance.getsysInfo(e):n.default.instance.OpenserverList.shift(),this.isFightExit=t,this.onInitData(),this.onShowIconAct()},t.prototype.onInitData=function(){this.openFunData&&this.openFunData.config&&this.openFunData.config.openIcon&&(this.spriteIcon.getComponent(cc.Sprite).spriteFrame=this.attrIcons.getSpriteFrame(this.openFunData.config.openIcon),c.default.instance.checkCondition(8))},t.prototype.onClickClose=function(){this.isFightExit&&s.GameEventDispatcher.instance.emit(l.EventDefiner.CardActive),o.default.instance.close(a.WindowType.OpenFuncTips)},t.prototype.onClickCheck=function(){this.onClickClose(),this.openFunData&&this.openFunData.config&&this.openFunData.config.windowType&&p.default.instance.openWindowType(this.openFunData.config.windowType)},t.instance=null,__decorate([f(cc.Node)],t.prototype,"layerContent",void 0),__decorate([f(cc.Node)],t.prototype,"nodeBgLight",void 0),__decorate([f(cc.Node)],t.prototype,"spriteIcon",void 0),__decorate([f(cc.Node)],t.prototype,"btnNodeArr",void 0),__decorate([f(cc.SpriteAtlas)],t.prototype,"attrIcons",void 0),t=i=__decorate([u],t)}(r.default);i.default=g,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Widget":"Widget","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../Commons/WindowOpenUtils":"WindowOpenUtils","../Functionicon/FunctionIconController":"FunctionIconController","../Guide/GuideNewController":"GuideNewController"}],OpenWinController:[function(e,t,i){"use strict";cc._RF.push(t,"b72f4beBmBJKaylMNVOzz3r","OpenWinController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../Tips/OpTipsController"),a=e("../../Core/Language"),r=e("../../Core/WindowManager"),s=e("../Functionicon/FunctionIconController"),l=e("../../Core/WindowType"),c=e("../../Core/Window"),d=e("../Status/StatusType"),p=e("../ActivityView/ActivityCtrl"),h=e("../ActivityView/ActivityView"),u=e("../Activity/ActivityController"),f=e("../Sports/SportController"),g=e("../ActivityView/SevenDayTarget/SevenDayTargetUtils"),y=cc._decorator,m=y.ccclass,C=(y.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._shieldWindow=[l.WindowType.Ornament,l.WindowType.Totems,l.WindowType.Refine,l.WindowType.EquipCopyMain],t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this),i.instance=this},t.prototype.onReturnOpenWindowType=function(e){for(var t=0,i=0,n=0,o=0;o<e.length;o++){var a=s.default.instance.getWindowtype(e[o]);if(a.config){if(s.default.instance.checkIsOpenbyWindowtype(e[o])){t=e[o];break}(0==i&&0==n||a.config.openChapter<i||a.config.openGuanqia<n&&a.config.openChapter<=i)&&(i=a.config.openChapter,n=a.config.openGuanqia,t=e[o])}}return t},t.prototype.openWindow=function(e,t,i,n){if(void 0===t&&(t=null),void 0===i&&(i=null),void 0===n&&(n=null),-1==this._shieldWindow.indexOf(e)){console.log("openWindow:"+e);var y=e,m=null;e==l.WindowType.ActivityWin&&(m="i18n_Activity",e=this.onReturnOpenWindowType(u.default.instance.activityWindowTypeList)),e==l.WindowType.SportsWin&&(m="i18n_SportsWin",e=this.onReturnOpenWindowType(f.default.instance.sportWindowTypeList)),e==l.WindowType.EliteBoss&&(d.ActivityStatus.value=d.ActivityStatus.EliteBoss),e==l.WindowType.WorldBoss&&(d.ActivityStatus.value=d.ActivityStatus.WorldBoss);var C=p.default.instance.data.getActivityType();switch(e){case l.WindowType.FristCharge:e=C==p.ActivityType.OpenServe?e:l.WindowType.Loop_FristCharge;break;case l.WindowType.HalfPrice:y=e=l.WindowType.SevenDayTarget,g.SevenDayTargetUtils.setSelectState()}var v=p.default.instance.data.activityWindow,_=v[e]?v[e].winType:null;if(_){if(!p.default.instance.data.getActivityState(e))return void o.default.instance.ShowMsg("\u6d3b\u52a8\u672a\u5f00\u542f");_!=p.WinType.Merge&&_!=p.WinType.Loop||r.default.instance.open(l.WindowType.ActivityView,function(){h.default.instance.setTabBtnByWindowID(e),t&&t.call(i)},this)}var b=s.default.instance.getWindowtype(e);null!=b?(c.default.windowtitlename=m||b.config.iconNameRes,s.default.instance.checkIsOpenbyWindowtype(e,!0)&&r.default.instance.open(y,t,i,n)):(c.default.windowtitlename=null,console.log("\u914d\u7f6e\u8868\u672a\u914d\u7f6e:"+e),r.default.instance.open(y,t,i,n))}else o.default.instance.ShowMsg(a.default.getStr("\u656c\u8bf7\u671f\u5f85"))},t.instance=null,t=i=__decorate([m],t)}(n.default));i.default=C,cc._RF.pop()},{"../../Core/Controller":"Controller","../../Core/Language":"Language","../../Core/Window":"Window","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../Activity/ActivityController":"ActivityController","../ActivityView/ActivityCtrl":"ActivityCtrl","../ActivityView/ActivityView":"ActivityView","../ActivityView/SevenDayTarget/SevenDayTargetUtils":"SevenDayTargetUtils","../Functionicon/FunctionIconController":"FunctionIconController","../Sports/SportController":"SportController","../Status/StatusType":"StatusType","../Tips/OpTipsController":"OpTipsController"}],OrnamentCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"51cf4rRaPFIP4Vn2QZ/SrQt","OrnamentCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("./OrnamentData"),a=e("../../NetConnect/NetConnet"),r=cc._decorator,s=r.ccclass,l=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._data=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.listNotification=function(){},Object.defineProperty(t.prototype,"data",{get:function(){return this._data||(this._data=new o.default),this._data},enumerable:!0,configurable:!0}),t.prototype.reqPeiShiIntensify=function(e,t,i){var n={cmd:"PeiShiIntensify",psguid:e,material:t,isAutoBuy:i};a.default.instance.sendProto(n)},t.prototype.reqPeiShiUpStage=function(e,t){var i={cmd:"PeiShiUpStage",psguid:e,isAutoBuy:t};a.default.instance.sendProto(i)},t.prototype.reqPeiShiTakeOn=function(e,t){var i={cmd:"PeiShiTakeOn",cardid:e,psguid:t};a.default.instance.sendProto(i)},t.prototype.reqPeiShiTakeOff=function(e,t){var i={cmd:"PeiShiTakeOff",cardid:e,position:t};a.default.instance.sendProto(i)},t.instance=null,t=i=__decorate([s],t)}(n.default));i.default=l,cc._RF.pop()},{"../../Core/Controller":"Controller","../../NetConnect/NetConnet":"NetConnet","./OrnamentData":"OrnamentData"}],OrnamentData:[function(e,t,i){"use strict";cc._RF.push(t,"2f50b2nNbhCg7GuiFv/ET6/","OrnamentData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/ConfigsManager"),o=e("../../Global/GlobalValue"),a=e("../../Util/UtilsFight"),r=e("../Item/ItemModel"),s=e("../WarTeam/MonsterController"),l=e("../Item/ItemType"),c=e("../Role/RoleInfo"),d=e("../../Core/WindowType"),p=e("../Functionicon/FunctionIconController"),h=e("../Item/ItemController"),u=function(){function e(){this._tabIndex=5,this._cfg=null,this._cfg=n.ConfigsManager.instance.getConfigs("accessoriesconf")}return Object.defineProperty(e.prototype,"cfg",{get:function(){return this._cfg},enumerable:!0,configurable:!0}),e.prototype.ornamentFlag=function(e){return!!this._cfg.psid[e]},e.prototype.getOrnamentItemId=function(e){var t=this._cfg.psid,i=[];for(var n in t)e==t[n].position&&i.push(parseInt(n));return i},e.prototype.getAllOrnamentItemId=function(){var e=this._cfg.psid,t=[];for(var i in e)t.push(parseInt(i));return t},e.prototype.getOrnamentType=function(e){if(this._cfg.psid[e])return this._cfg.psid[e].position},e.prototype.getAccessories=function(e){if(this._cfg.accessories[e])return this._cfg.accessories[e]},e.prototype.getIntensify=function(e,t){if(this._cfg.intensify[e]&&this._cfg.intensify[e][t])return this._cfg.intensify[e][t]},e.prototype.getintensifyConsume=function(e,t){if(this._cfg.intensifyConsume[e]&&this._cfg.intensifyConsume[e][t-1])return this._cfg.intensifyConsume[e][t-1]},e.prototype.getMaxlevel=function(e){if(this._cfg.intensifyConsume[e])return this._cfg.intensifyConsume[e].length},e.prototype.getUpStage=function(e,t){if(this._cfg.upStage[e]&&this._cfg.upStage[e][t])return this._cfg.upStage[e][t]},e.prototype.getupStageConsume=function(e,t){if(this._cfg.upStageConsume[e]&&this._cfg.upStageConsume[e][t])return this._cfg.upStageConsume[e][t]},e.prototype.getMaxStage=function(e){if(this._cfg.upStageConsume[e])return this._cfg.upStageConsume[e].length},e.prototype.getIntensifyMaterial=function(){return this._cfg.intensifyMaterial[1]},e.prototype.getItemListById=function(e){var t=r.default.instance.getBagTypeListbyType(l.ItemType.other),i=[];for(var n in t)t[n].id==e&&i.push(t[n]);return i},e.prototype.getOrnamentItem=function(e){var t=this.getOrnamentItemId(e);if(t.length<=0)return null;var i=[];for(var n in t){var o=this.getItemListById(t[n]);if(o.length>0)for(var a in o)o[a].belongcardid<=0&&i.push(o[a])}return i},e.prototype.getAllOrnamentItem=function(){var e=[],t=this.getAllOrnamentItemId();if(t.length<=0)return null;for(var i in t){var n=this.getItemListById(t[i]);if(n.length>0)for(var o in n)n[o].belongcardid<=0&&e.push(n[o])}return e},e.prototype.getMaxTypeItem=function(e,t){var i=null;for(var n in e)e[n].colorIndex>t.colorIndex&&(i=e[n]);return i},e.prototype.getOrnamentAttr=function(e,t){var i={};for(var n in this.getLevelAttr(i,e),this.getStageAttr(i,e),this.getTalentAttr(i,e,t),i){var o=0;i[parseInt(n)+1100]&&(o=i[parseInt(n)+1100],i[parseInt(n)+1100]=null,delete i[parseInt(n)+1100]),i[n]*=1+o}return i},e.prototype.getOrnamentAttrTwo=function(e,t){var i={};return this.getLevelAttr(i,e),this.getStageAttr(i,e),this.getTalentAttr(i,e,t),i},e.prototype.getWearOrnamentAttr=function(e,t){var i=s.default.instance.GetMonsterData(e);if(i){var n={};for(var o in i.peishi){var a=this.getOrnamentGuid(i.peishi[o]);a&&this.getOrnamentItemAttr(n,a,t)}for(var o in n){var r=0;n[parseInt(o)+1100]&&(r=n[parseInt(o)+1100],n[parseInt(o)+1100]=null,delete n[parseInt(o)+1100]),n[o]=n[o]*(1+r)}return n}},e.prototype.getOrnamentItemAttr=function(e,t,i){var n=this.getOrnamentAttrTwo(t,i);for(var o in n)this.setAttr(e,parseInt(o),n[o])},e.prototype.getLevelAttr=function(e,t){var i=this.getOrnamentType(t.id),n=this.getAccessories(t.colorIndex);if(n.intensify){var o=this.getIntensify(n.intensify,i);if(this._cfg.intensifyAttr[o.intensifyAttr][t.level-1]){var a=this._cfg.intensifyAttr[o.intensifyAttr][t.level-1];this.getAttr(a,e)}}},e.prototype.getLevelAttrTwo=function(e,t,i,n){var o=this.getOrnamentType(t),a=this.getAccessories(i);if(a.intensify){var r=this.getIntensify(a.intensify,o);if(this._cfg.intensifyAttr[r.intensifyAttr][n]){var s=this._cfg.intensifyAttr[r.intensifyAttr][n];this.getAttr(s,e)}}},e.prototype.getStageAttr=function(e,t){var i=this.getOrnamentType(t.id),n=this.getAccessories(t.colorIndex);if(n.upStage){var o=this.getUpStage(n.upStage,i);if(this._cfg.upStageAttr[o.upStageAttr][t.stage]){var a=this._cfg.upStageAttr[o.upStageAttr][t.stage];this.getAttr(a,e)}}},e.prototype.getStageAttrTwo=function(e,t,i,n){var o=this.getOrnamentType(t),a=this.getAccessories(i);if(a.upStage){var r=this.getUpStage(a.upStage,o);if(this._cfg.upStageAttr[r.upStageAttr][n]){var s=this._cfg.upStageAttr[r.upStageAttr][n];this.getAttr(s,e)}}},e.prototype.getTalentAttr=function(e,t,i){var n=this.getAccessories(t.colorIndex);if(n.talent){var o=this._cfg.talent[n.talent][i-1];this.getAttr(o,e)}},e.prototype.getAttr=function(e,t){e&&(e.Attack&&this.setAttr(t,o.AttrType.Attack,e.Attack),e.AttackPercent&&this.setAttr(t,o.AttrType.Attack_P,e.AttackPercent/100),e.HP&&this.setAttr(t,o.AttrType.MaxHp,e.HP),e.HPPercent&&this.setAttr(t,o.AttrType.MaxHp_P,e.HPPercent/100))},e.prototype.setAttr=function(e,t,i){e[t]?e[t]+=i:e[t]=i},e.prototype.cptOrnamentFight=function(e,t){return void 0===t&&(t=2),a.default.cptFight(t,this.getOrnamentAttr(e,t))},e.prototype.cptOrnamentFightTwo=function(e,t){void 0===t&&(t=2);var i={};if(this.getLevelAttr(i,e),this.getStageAttr(i,e),this.getTalentAttr(i,e,t),e.belongcardid>0){var n=s.default.instance.GetMonsterData(e.belongcardid);for(var o in n.peishi)if(n.peishi[o]&&n.peishi[o]!=e.guid){var r=this.getOrnamentGuid(n.peishi[1==t?0:1]);this.getTalentAttr(i,r,t)}}for(var o in i){var l=0;i[parseInt(o)+1100]&&(l=i[parseInt(o)+1100],i[parseInt(o)+1100]=null,delete i[parseInt(o)+1100]),i[o]*=1+l}return a.default.cptFight(t,i)},e.prototype.getLevelExpendData=function(e){var t=this.getIntensifyMaterial(),i=this.getOrnamentType(e.id),n=this.getAccessories(e.colorIndex),o=this.getIntensify(n.intensify,i),a=this.getintensifyConsume(o.intensifyConsume,e.level),r=a?a.exp:1,s={},l=0,c=0;for(var d in r-=e.intensifyexp,t){var p=h.default.instance.getItemNum(t[d].id),u=t[d].exp*p;if(s[t[d].id]=0,r>0){if(r>=u)r-=u,c+=p*t[d].money,s[t[d].id]+=p;else{var f=Math.ceil(r/t[d].exp);r-=t[d].exp*f,c+=f*t[d].money,s[t[d].id]+=f}l+=u}}return{expFlag:r<=0,exp:l,gold:c,itemMap:s}},e.prototype.getOrnamentLevelExpendData=function(e){var t=this.getIntensifyMaterial(),i=this.getOrnamentType(e.id),n=this.getAccessories(e.colorIndex),o=this.getIntensify(n.intensify,i),a=this.getintensifyConsume(o.intensifyConsume,e.level),r=a?a.exp:1,s={},l=0,c=0;r-=e.intensifyexp;for(var d=0;d<t.length-3;d++){var p=9999999*t[d].exp;if(s[t[d].id]=0,r>0){if(r>=p)r-=p,c+=9999999*t[d].money,s[t[d].id]+=9999999;else{var h=Math.ceil(r/t[d].exp);r-=t[d].exp*h,c+=h*t[d].money,s[t[d].id]+=h}l+=p}}return{expFlag:r<=0,exp:l,gold:c,itemMap:s}},e.prototype.conversio=function(e){return 0==e?1:0},e.prototype.getTalentInAttrList=function(e){var t=this.getAccessories(e.colorIndex),i=[];if(t.talent){var n=this._cfg.talent[t.talent];for(var o in n){var a={},r=n[o];this.getAttr(r,a),i.push(a)}}return i},e.prototype.getOrnamentGuid=function(e){var t=r.default.instance.getBagTypeListbyType(l.ItemType.other);for(var i in t)if(t[i].guid==e)return t[i]},e.prototype.getCardOrnamentFlag=function(e,t){if(!p.default.instance.checkIsOpenbyWindowtype(d.WindowType.Ornament,!1))return!1;if(t>=0){if(this.OrnamentRedFlag(e,t))return!0}else for(var i=0;i<2;++i)if(this.OrnamentRedFlag(e,this.conversio(i)))return!0;return!1},e.prototype.OrnamentRedFlag=function(e,t){var i=s.default.instance.GetMonsterData(e);if(!i)return!1;if(this.getOrnamentFlag(e,t))return!0;var n=this.getOrnamentGuid(i.peishi[t]);return!!n&&(!!this.getOrnamentUpgradeFlag(n)||(!!this.getOrnamentUpStageFlag(n)||void 0))},e.prototype.getOrnamentFlag=function(e,t){if(!p.default.instance.checkIsOpenbyWindowtype(d.WindowType.Ornament,!1))return!1;var i=s.default.instance.GetMonsterData(e);if(!i)return!1;var n=!1,o=this.getOrnamentItem(t);if(i.peishi[t]){var a=this.getOrnamentGuid(i.peishi[t]);if(o.length>0&&a)n=!!this.getMaxTypeItem(o,a)}else n=o.length>0;return n},e.prototype.getOrnamentUpgradeFlag=function(e){if(!e)return!1;if(!p.default.instance.checkIsOpenbyWindowtype(d.WindowType.OrnamentUpgrade,!1))return!1;var t=this.getOrnamentType(e.id),i=this.getAccessories(e.colorIndex);if(!i||!i.intensify)return!1;var n=this.getIntensify(i.intensify,t),o=this.getintensifyConsume(n.intensifyConsume,e.level);if(!!!(o&&o.exp>0))return!1;var a=this.getLevelExpendData(e);return!!a.expFlag&&!(a.gold>c.MyRoleInfo.money)},e.prototype.getOrnamentUpStageFlag=function(e){if(!e)return!1;if(!p.default.instance.checkIsOpenbyWindowtype(d.WindowType.OrnamentUpStage,!1))return!1;var t=this.getOrnamentType(e.id),i=this.getAccessories(e.colorIndex);if(!i||!i.upStage)return!1;var n=this.getUpStage(i.upStage,t),a=this.getupStageConsume(n.upStageConsume,e.stage);return!!a&&(!!((e.stage+1)*o.OrnamentLev<=c.MyRoleInfo.level)&&(!(r.default.getCountByid(a.stepStoneid)<a.stepStoneCount)&&(!(a.sameNameCount>0&&h.default.instance.getItemNum(e.id)<a.sameNameCount)&&!(a.money>c.MyRoleInfo.money))))},Object.defineProperty(e.prototype,"MorphologicalTag",{get:function(){return this._tabIndex},set:function(e){this._tabIndex!=e&&(this._tabIndex=e)},enumerable:!0,configurable:!0}),e}();i.default=u,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../Util/UtilsFight":"UtilsFight","../Functionicon/FunctionIconController":"FunctionIconController","../Item/ItemController":"ItemController","../Item/ItemModel":"ItemModel","../Item/ItemType":"ItemType","../Role/RoleInfo":"RoleInfo","../WarTeam/MonsterController":"MonsterController"}],OrnamentInfo:[function(e,t,i){"use strict";cc._RF.push(t,"17d12PtpJpAH5kEdU1hwow9","OrnamentInfo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("./OrnamentCtrl"),a=e("../../Util/AttrUtil"),r=e("../../Core/Language"),s=e("../../Global/GlobalValue"),l=e("../WarTeam/MonsterController"),c=cc._decorator,d=c.ccclass,p=(c.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._cardId=null,t._guid=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.hide=function(){e.prototype.hide.call(this),this._cardId=null,this._guid=null},t.prototype.setData=function(e,t){this._cardId=e,this._guid=t,this.upShow()},t.prototype.upShow=function(){this.setUpgradeAttr(),this.setUpStageAttr(),this.setTalentInfo()},t.prototype.resetData=function(){this.node.getChildByName("titleNode").getChildByName("title").active=!1,this.node.getChildByName("attrInfo").active=!1,this.node.getChildByName("attrInfo2").active=!1,this.node.getChildByName("attrInfo3").active=!1},t.prototype.setUpgradeAttr=function(){var e=o.default.instance.data.getOrnamentGuid(this._guid),t=this.node.getChildByName("attrInfo");if(t.active=!0,e){this.node.getChildByName("titleNode").getChildByName("title").active=!0,this.node.getChildByName("titleNode").getChildByName("title").getComponent(cc.Label).string=e.name;var i=o.default.instance.data,n={};i.getLevelAttr(n,e);var r=i.getOrnamentType(e.id),s=i.getAccessories(e.colorIndex),c=i.getIntensify(s.intensify,r),d=i.getMaxlevel(c.intensifyConsume);t.children[0].active=!0,t.children[0].getChildByName("Label2").getComponent(cc.Label).string=e.level+"/"+d;var p=1;for(var h in n=l.default.instance.getAttrPrecentByGradeAndType(o.default.instance.data.MorphologicalTag,n))t.children[p].active=!0,t.children[p].getChildByName("Label").getComponent(cc.Label).string=a.default.getAttrNameTwo(parseInt(h)),t.children[p].getChildByName("Label2").getComponent(cc.Label).string=n[h]+"",p+=1;t.children[p]&&(t.children[p].active=!1)}else for(var h in this.node.getChildByName("titleNode").getChildByName("title").getComponent(cc.Label).string="",t.children)t.children[h].active=!1},t.prototype.setUpStageAttr=function(){var e=this.node.getChildByName("attrInfo2");e.active=!0;var t=o.default.instance.data.getOrnamentGuid(this._guid);if(e.active=t&&t.stage>0,t&&t.stage>0){var i=o.default.instance.data,n=i.getOrnamentType(t.id),r=i.getAccessories(t.colorIndex),c=i.getUpStage(r.upStage,n),d=i.getMaxStage(c.upStageConsume),p={};i.getStageAttr(p,t),e.children[0].getChildByName("Label2").getComponent(cc.Label).string=t.stage+"/"+d;var h=1;for(var u in p=l.default.instance.getAttrPrecentByGradeAndType(o.default.instance.data.MorphologicalTag,p))e.children[h].getChildByName("Label").getComponent(cc.Label).string=a.default.getAttrNameTwo(parseInt(u)),e.children[h].getChildByName("Label2").getComponent(cc.Label).string=parseInt(u)>=s.AttrType.MaxHp_P?Math.floor(100*p[u])+"%":p[u]+"",h+=1}},t.prototype.setTalentInfo=function(){var e=this.node.getChildByName("attrInfo3");e.getChildByName("RichText").getComponent(cc.RichText).string=r.default.getStr("ornamen_info_desc");var t=e.getChildByName("arrNode"),i=o.default.instance.data.getOrnamentGuid(this._guid),n=[];if(i)for(var a in n=o.default.instance.data.getTalentInAttrList(i))n[a]=this.getData(n[a]),n[a]=l.default.instance.getAttrPrecentByGradeAndType(o.default.instance.data.MorphologicalTag,n[a]);for(var a in e.active=n.length>0,t.active=n.length>0,t.children)if(n[a]){var s=this.getVal(n[a]);s.length>=2?t.children[a].getComponent(cc.RichText).string=r.default.getStr("TalentInfo_"+parseInt(a),s[1]?s[1]:0,s[0]?s[0]:0):t.children[a].getComponent(cc.RichText).string=r.default.getStr("TalentInfo_"+parseInt(a),s[0]?s[0]:0)}},t.prototype.getVal=function(e){var t=[];for(var i in e)t.push(Math.floor(e[i]));return t},t.prototype.getData=function(e){for(var t in e)e[t]=100*e[t];return e},t=__decorate([d],t)}(n.default));i.default=p,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/Widget":"Widget","../../Global/GlobalValue":"GlobalValue","../../Util/AttrUtil":"AttrUtil","../WarTeam/MonsterController":"MonsterController","./OrnamentCtrl":"OrnamentCtrl"}],OrnamentUpStage:[function(e,t,i){"use strict";cc._RF.push(t,"a9a90HXYk5ICZ7gOuo14Bpk","OrnamentUpStage"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/GameEventDispatcher"),a=e("../../Core/Event"),r=e("../Item/ItemData"),s=e("../../Core/Language"),l=e("./OrnamentCtrl"),c=e("../Item/ItemModel"),d=e("../Item/ItemIcon"),p=e("../../Util/AttrUtil"),h=e("../../Global/GlobalValue"),u=e("../Role/RoleInfo"),f=e("../Tips/OpTipsController"),g=e("../../Util/RechargeUtils"),y=e("../../Util/RechargeConst"),m=e("../Commons/RewardUtils"),C=e("../Item/ItemController"),v=e("../../Core/TimeController"),_=e("../../Util/Utils"),b=e("../WarTeam/MonsterController"),T=e("../../Util/NumberUtil"),S=e("../Tips/TipsWinController"),I=cc._decorator,w=I.ccclass,D=I.property,R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.attrNode=null,t.itemPre=null,t.attrIcons=null,t.toggle=null,t.isFrist=!1,t._guid=null,t._itemFlag=!1,t._goldFlag=!1,t._colorList=[new cc.Color(255,0,0),new cc.Color(48,24,16)],t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),o.GameEventDispatcher.instance.on("HideInfo",this.hideInfo,this)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this),o.GameEventDispatcher.instance.off("HideInfo",this.hideInfo,this)},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this),this.isEffect=!1,o.GameEventDispatcher.instance.on(a.EventDefiner.itemchangeUP,this.upShowData,this)},t.prototype.hide=function(){e.prototype.hide.call(this),this._itemFlag=!1,this.isFrist=!1,o.GameEventDispatcher.instance.on(a.EventDefiner.itemchangeUP,this.upShowData,this)},t.prototype.hideInfo=function(){this.toggle.isChecked=!1},t.prototype.setData=function(e){this._guid=e,this.upShowData()},t.prototype.upShowData=function(){var e=l.default.instance.data.getOrnamentGuid(this._guid);e?l.default.instance.data.getAccessories(e.colorIndex).upStage?this.upShow():this.initShow():this.initShow()},t.prototype.initShow=function(){this.node.getChildByName("titleNode").getChildByName("title").getComponent(cc.Label).string="",this.node.getChildByName("Label2").getComponent(cc.Label).string="",this.node.getChildByName("Label3").getComponent(cc.Label).string="";var e=this.node.getChildByName("btn");e.getChildByName("Label").getComponent(cc.Label).string=s.default.getStr("5508"),e.getComponent(cc.Button).interactable=!1,this.node.getChildByName("gold").getChildByName("Label").getComponent(cc.Label).string="",this.node.getChildByName("itemList").removeAllChildren(),this.node.getChildByName("attrList").removeAllChildren()},t.prototype.upShow=function(){this.setAttr(),this.setItem(),this.setDesc()},t.prototype.setDesc=function(){var e=l.default.instance.data.getOrnamentGuid(this._guid);this.node.getChildByName("titleNode").getChildByName("title").getComponent(cc.Label).string=e.name;var t=T.NumberUtil.unitsDigitToText(e.stage)+s.default.getStr("rank");this.node.getChildByName("Label2").getComponent(cc.Label).string=t,t=T.NumberUtil.unitsDigitToText(e.stage+1)+s.default.getStr("rank"),this.node.getChildByName("Label3").getComponent(cc.Label).string=t;var i=l.default.instance.data,n=i.getOrnamentType(e.id),o=i.getAccessories(e.colorIndex),a=i.getUpStage(o.upStage,n),r=i.getupStageConsume(a.upStageConsume,e.stage),c=!!r,d=this.node.getChildByName("btn");d.getChildByName("Label").getComponent(cc.Label).string=c?s.default.getStr("5508"):s.default.getStr("5527"),d.getComponent(cc.Button).interactable=c,this.node.getChildByName("gold").getChildByName("Label").getComponent(cc.Label).string=r?r.money+"":"",this.node.getChildByName("gold").getChildByName("Label").color=this._goldFlag?this._colorList[1]:this._colorList[0]},t.prototype.setItem=function(){var e=l.default.instance.data.getOrnamentGuid(this._guid),t=l.default.instance.data,i=t.getOrnamentType(e.id),n=t.getAccessories(e.colorIndex),o=null;if(n.upStage){var a=t.getUpStage(n.upStage,i);o=t.getupStageConsume(a.upStageConsume,e.stage)}var s=this.node.getChildByName("itemList");if(s.removeAllChildren(),this._goldFlag=!!(o&&o.money<=u.MyRoleInfo.money),o&&(this.setItemNode(s,r.default.creatItem(o.stepStoneid,C.default.instance.getItemNum(o.stepStoneid)),o.stepStoneCount),this._itemFlag=C.default.instance.getItemNum(o.stepStoneid)>=o.stepStoneCount,o.sameNameCount>0)){var c=C.default.instance.getItemNum(e.id);this.setItemNode(s,r.default.creatItem(e.id,c),o.sameNameCount),this._itemFlag&&(this._itemFlag=c>=o.sameNameCount)}},t.prototype.setItemNode=function(e,t,i){var n=cc.instantiate(this.itemPre);n.setScale(.8),n.getComponent(d.default).ItemData(t,!0,t.count+"/"+i,!0),e.addChild(n)},t.prototype.setAttr=function(){var e=l.default.instance.data.getOrnamentGuid(this._guid);if(e){var t={};l.default.instance.data.getStageAttr(t,e);_.default.MapAttrToAttrList(t);t=b.default.instance.getAttrPrecentByGradeAndType(l.default.instance.data.MorphologicalTag,t);var i={};l.default.instance.data.getStageAttrTwo(i,e.id,e.colorIndex,e.stage+1),i=b.default.instance.getAttrPrecentByGradeAndType(l.default.instance.data.MorphologicalTag,i),this.isEffect&&(this.playEffect(),this.isClick=!1,this.isEffect=!1);var n=this.node.getChildByName("attrList");if(n.removeAllChildren(),Object.keys(t).length>0)for(var o in t)this.setAttrNode(n,parseInt(o),t,i);else for(var o in i)this.setAttrNode(n,parseInt(o),t,i)}},t.prototype.setAttrNode=function(e,t,i,n,o){void 0===o&&(o=!1);var a=cc.instantiate(this.attrNode);a.active=!0;var r=t<h.AttrType.MaxHp_P?t:this.getIconType(t);a.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=this.attrIcons.getSpriteFrame("attrIcon_"+r),a.getChildByName("name").getComponent(cc.Label).string=t<h.AttrType.MaxHp_P?p.default.getAttrName(t):this.getNmae(t);a.getChildByName("value").getComponent(cc.Label).string=this.getAttrStr(i,t);o&&(a.getChildByName("value").color=new cc.Color(255,255,255)),a.getChildByName("value2").getComponent(cc.Label).string=this.getAttrStr(n,t),o&&(a.getChildByName("value2").color=new cc.Color(0,202,71)),e.addChild(a)},t.prototype.onClickBtn=function(){var e=this,t=l.default.instance.data.getOrnamentGuid(this._guid),i=(t.stage+1)*h.OrnamentLev<=u.MyRoleInfo.level,n=l.default.instance.data,o=n.getOrnamentType(t.id),a=n.getAccessories(t.colorIndex),r=null;if(a.upStage){var c=n.getUpStage(a.upStage,o);r=n.getupStageConsume(c.upStageConsume,t.stage)}if(i){if(r){var d=C.default.instance.getItemNum(t.id);if(r.sameNameCount>0&&d<r.sameNameCount)return void g.default.PurchaseItemOrRechage(y.RechargeTypeConst.Ornament,r.sameNameCount,null,this,t.id)}if(this._itemFlag||this.isFrist||this.toggle.isChecked)this._itemFlag||this.toggle.isChecked?this._goldFlag?(this.isEffect=!0,l.default.instance.reqPeiShiUpStage(this._guid,this.toggle.isChecked)):g.default.PurchaseItemOrRechage(y.RechargeTypeConst.Prop,1e6,null,this,m.RewardType.Coin):this.materialTisp();else{this.isFrist=!0;S.default.instance.ShowTips("\u662f\u5426\u5f00\u542f\u81ea\u52a8\u8d2d\u4e70",function(){e.toggle.isChecked=!0},null,null,1,null,null,function(){e.materialTisp()})}}else f.default.instance.ShowMsg(s.default.getStr("\u4eba\u7269\u7b49\u7ea7\u4e0d\u8db3"))},t.prototype.getNmae=function(e){switch(e){case h.AttrType.MaxHp_P:return p.default.getAttrName(h.AttrType.MaxHp);case h.AttrType.Attack_P:return p.default.getAttrName(h.AttrType.Attack);case h.AttrType.Defence_P:return p.default.getAttrName(h.AttrType.Defence)}},t.prototype.getIconType=function(e){switch(e){case h.AttrType.MaxHp_P:return h.AttrType.MaxHp;case h.AttrType.Attack_P:return h.AttrType.Attack;case h.AttrType.Defence_P:return h.AttrType.Defence}},t.prototype.getAttrStr=function(e,t){var i="";return e&&e[t]?(i+=e[t],t>=h.AttrType.MaxHp_P&&(i=Math.floor(100*e[t])+"%")):i="0",i},t.prototype.materialTisp=function(){var e=l.default.instance.data.getOrnamentGuid(this._guid),t=l.default.instance.data,i=t.getOrnamentType(e.id),n=t.getAccessories(e.colorIndex),o=null;if(n.upStage){var a=t.getUpStage(n.upStage,i);o=t.getupStageConsume(a.upStageConsume,e.stage)}if(o){this._itemFlag=C.default.instance.getItemNum(o.stepStoneid)>=o.stepStoneCount;var r=C.default.instance.getItemNum(e.id);if(o.sameNameCount>0&&r<o.sameNameCount)return void g.default.PurchaseItemOrRechage(y.RechargeTypeConst.Ornament,o.sameNameCount,null,this,e.id);if(c.default.getCountByid(o.stepStoneid)<o.stepStoneCount)return void g.default.PurchaseItemOrRechage(y.RechargeTypeConst.Prop,o.stepStoneCount,null,this,o.stepStoneid)}},t.prototype.playEffect=function(){var e=this,t=this.node.getChildByName("effectNode");t.active=!0,this.setEffectAttr();var i=t.getChildByName("tishen2").getComponent(cc.Animation);t.getChildByName("tishen2").stopAllActions(),i&&i.on("finished",function(){v.default.instance.setTimeout(function(){e.isClick=!0},e,1e3)},this),i.pause("tishen2_ani1"),i.play("tishen2_ani1")},t.prototype.setActive=function(){this.isClick&&(this.node.getChildByName("effectNode").active=!1)},t.prototype.setEffectAttr=function(){var e=l.default.instance.data.getOrnamentGuid(this._guid),t=this.node.getChildByName("effectNode").getChildByName("attr"),i=this.node.getChildByName("attrList"),n=cc.instantiate(i);for(var o in n.setPosition(cc.v2(0,60)),n.children)n.children[o].getChildByName("value").color=new cc.Color(255,255,255),n.children[o].getChildByName("value2").color=new cc.Color(0,202,71),n.children[o].getChildByName("value").color=new cc.Color(255,255,255),n.children[o].getChildByName("name").color=new cc.Color(255,255,255);var a=t.getChildByName("initInfo");a.destroyAllChildren(),a.addChild(n);var r=e.stage,c=T.NumberUtil.unitsDigitToText(r)+s.default.getStr("rank");t.getChildByName("img").getChildByName("Label").getComponent(cc.Label).string=c,c=T.NumberUtil.unitsDigitToText(r+1)+s.default.getStr("rank"),t.getChildByName("img2").getChildByName("Label").getComponent(cc.Label).string=c},__decorate([D(cc.Node)],t.prototype,"attrNode",void 0),__decorate([D(cc.Prefab)],t.prototype,"itemPre",void 0),__decorate([D(cc.SpriteAtlas)],t.prototype,"attrIcons",void 0),__decorate([D(cc.Toggle)],t.prototype,"toggle",void 0),t=__decorate([w],t)}(n.default);i.default=R,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../../Global/GlobalValue":"GlobalValue","../../Util/AttrUtil":"AttrUtil","../../Util/NumberUtil":"NumberUtil","../../Util/RechargeConst":"RechargeConst","../../Util/RechargeUtils":"RechargeUtils","../../Util/Utils":"Utils","../Commons/RewardUtils":"RewardUtils","../Item/ItemController":"ItemController","../Item/ItemData":"ItemData","../Item/ItemIcon":"ItemIcon","../Item/ItemModel":"ItemModel","../Role/RoleInfo":"RoleInfo","../Tips/OpTipsController":"OpTipsController","../Tips/TipsWinController":"TipsWinController","../WarTeam/MonsterController":"MonsterController","./OrnamentCtrl":"OrnamentCtrl"}],OrnamentUpgrade:[function(e,t,i){"use strict";cc._RF.push(t,"f9931Cy3p1IqK9oroFPI3ze","OrnamentUpgrade"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/GameEventDispatcher"),a=e("../../Core/Event"),r=e("../Item/ItemData"),s=e("./OrnamentCtrl"),l=e("../WarTeam/MonsterController"),c=e("../../Util/UtilsFight"),d=e("../../Util/AttrUtil"),p=e("../Item/ItemIcon"),h=e("../../Core/Language"),u=e("../Role/RoleInfo"),f=e("../Tips/OpTipsController"),g=e("../Item/ItemController"),y=e("../../Global/GlobalValue"),m=e("../../Util/RechargeUtils"),C=e("../../Util/RechargeConst"),v=e("../Commons/RewardUtils"),_=e("../Role/RoleStrengthen/RoleStrengthenController"),b=e("../Role/RoleStrengthen/RoleStrengthenEvent"),T=e("../../Util/Utils"),S=e("../Tips/TipsWinController"),I=cc._decorator,w=I.ccclass,D=I.property,R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.attrNode=null,t.attrIcons=null,t.toggle=null,t.isFrist=!1,t._cardid=null,t._guid=null,t._gold=null,t._itemMap={},t._expFlag=!1,t._flag=null,t._colorList=[new cc.Color(255,0,0),new cc.Color(48,24,16)],t.item=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),o.GameEventDispatcher.instance.on("HideInfo",this.hideInfo,this)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this),o.GameEventDispatcher.instance.off("HideInfo",this.hideInfo,this)},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this),o.GameEventDispatcher.instance.on(a.EventDefiner.itemchangeUP,this.upShow,this)},t.prototype.hide=function(){e.prototype.hide.call(this),this.isFrist=!1,o.GameEventDispatcher.instance.off(a.EventDefiner.itemchangeUP,this.upShow,this)},t.prototype.hideInfo=function(){this.toggle.isChecked=!1},t.prototype.setData=function(e,t){this._cardid=e,this._guid=t,this.upShow()},t.prototype.upShow=function(){var e=s.default.instance.data.getOrnamentGuid(this._guid);e?this.upShowData(e):this.resetData()},t.prototype.resetData=function(){this.node.getChildByName("titleNode").getChildByName("title").getComponent(cc.Label).string="";var e=this.node.getChildByName("fightNode");e.getChildByName("value").getComponent(cc.Label).string="",e.getChildByName("value2").getComponent(cc.Label).string="",this.node.getChildByName("level").getChildByName("Label").getComponent(cc.Label).string="";var t=this.node.getChildByName("ProgressBar");t.getComponent(cc.ProgressBar).progress=0,t.getChildByName("Label").getComponent(cc.Label).string="",this.node.getChildByName("attrList").removeAllChildren(),this.node.getChildByName("itemList").active=!1,this.node.getChildByName("btn").getComponent(cc.Button).interactable=!1,this.node.getChildByName("gold").getChildByName("Label").getComponent(cc.Label).string=""},t.prototype.upShowData=function(e){this.setProgressBar(e),this.setFight(e),this.setItem(e),this.setAttr(e),this.setOther(e),this.item=e},t.prototype.setProgressBar=function(e){this.node.getChildByName("level").getChildByName("Label").getComponent(cc.Label).string=e.level+"";var t=this.node.getChildByName("ProgressBar"),i=s.default.instance.data,n=i.getOrnamentType(e.id),o=i.getAccessories(e.colorIndex),a=i.getIntensify(o.intensify,n),r=i.getintensifyConsume(a.intensifyConsume,e.level);this._flag=!!(r&&r.exp>0);var l=r?r.exp:0;t.getComponent(cc.ProgressBar).progress=e.intensifyexp>l?1:e.intensifyexp/l,t.getChildByName("Label").getComponent(cc.Label).string=e.intensifyexp+"/"+l},t.prototype.setFight=function(e){var t=this.node.getChildByName("fightNode"),i=s.default.instance.data,n=l.default.instance.data.getCardCfg().Card[this._cardid].cardType,o={};i.getLevelAttr(o,e),o=l.default.instance.getAttrPrecentByGradeAndType(s.default.instance.data.MorphologicalTag,o),t.getChildByName("value").getComponent(cc.Label).string=c.default.cptFight(n,o)+"",o={},i.getLevelAttrTwo(o,e.id,e.colorIndex,e.level),o=l.default.instance.getAttrPrecentByGradeAndType(s.default.instance.data.MorphologicalTag,o),t.getChildByName("value2").getComponent(cc.Label).string=c.default.cptFight(n,o)+""},t.prototype.setAttr=function(e){var t=s.default.instance.data,i={};t.getLevelAttr(i,e);T.default.MapAttrToAttrList(i);i=l.default.instance.getAttrPrecentByGradeAndType(s.default.instance.data.MorphologicalTag,i);var n={};t.getLevelAttrTwo(n,e.id,e.colorIndex,e.level),n=l.default.instance.getAttrPrecentByGradeAndType(s.default.instance.data.MorphologicalTag,n);var o=this.node.getChildByName("attrList");for(var a in o.removeAllChildren(),i)if(i[a]){var r=cc.instantiate(this.attrNode);r.active=!0,r.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=this.attrIcons.getSpriteFrame("attrIcon_"+parseInt(a)),r.getChildByName("name").getComponent(cc.Label).string=d.default.getAttrName(parseInt(a)),r.getChildByName("value").getComponent(cc.Label).string=this.getAttrStr(i,parseInt(a)),r.getChildByName("value2").getComponent(cc.Label).string=this.getAttrStr(n,parseInt(a)),o.addChild(r)}},t.prototype.setItem=function(e){var t=s.default.instance.data.getIntensifyMaterial(),i=this.node.getChildByName("itemList");i.active=!0;var n=0;for(var o in t){var a=g.default.instance.getItemNum(t[o].id),l=r.default.creatItem(t[o].id,a);i.children[n].getChildByName("ItemIcon").getComponent(p.default).ItemData(l,!0,a+"",!0),i.children[n].getChildByName("Label").getComponent(cc.Label).string=h.default.getStr("5514",t[o].exp),n+=1}var c=s.default.instance.data.getLevelExpendData(e);this._gold=c.gold,this._itemMap=c.itemMap,this._expFlag=c.expFlag},t.prototype.setOther=function(e){var t=this.node.getChildByName("gold");t.getChildByName("Label").getComponent(cc.Label).string=this._gold+"",t.getChildByName("Label").color=this._gold>u.MyRoleInfo.money?this._colorList[0]:this._colorList[1],this.node.getChildByName("btn").getComponent(cc.Button).interactable=this._flag,this.node.getChildByName("btn").getChildByName("Label").getComponent(cc.Label).string=this._flag?h.default.getStr("\u5347  \u7ea7"):h.default.getStr("\u6ee1  \u7ea7"),this.node.getChildByName("titleNode").getChildByName("title").getComponent(cc.Label).string=e.name},t.prototype.onClickBtn=function(){var e=this;if(s.default.instance.data.getOrnamentGuid(this._guid).level>=u.MyRoleInfo.level)f.default.instance.ShowMsg(h.default.getStr("\u4eba\u7269\u7b49\u7ea7\u4e0d\u8db3"));else if(this._gold>u.MyRoleInfo.money)m.default.PurchaseItemOrRechage(C.RechargeTypeConst.Prop,this._gold,null,this,v.RewardType.Coin);else if(this._expFlag||this.isFrist||this.toggle.isChecked)if(this._expFlag||this.toggle.isChecked){this.toggle.isChecked&&(this._itemMap=s.default.instance.data.getOrnamentLevelExpendData(this.item).itemMap);var t=[];for(var i in this._itemMap)this._itemMap[i]&&t.push({id:Number(i),count:this._itemMap[i]});_.default.instence.setImgState(b.RoleImgType.Upgrade),s.default.instance.reqPeiShiIntensify(this._guid,t,this.toggle.isChecked)}else{var n=s.default.instance.data.getIntensifyMaterial();m.default.PurchaseItemOrRechage(C.RechargeTypeConst.Prop,1e5,null,this,n[0].id)}else{this.isFrist=!0;S.default.instance.ShowTips("\u662f\u5426\u5f00\u542f\u81ea\u52a8\u8d2d\u4e70",function(){e.toggle.isChecked=!0},null,null,1,null,null,function(){var t=s.default.instance.data.getIntensifyMaterial();m.default.PurchaseItemOrRechage(C.RechargeTypeConst.Prop,1e5,null,e,t[0].id)})}},t.prototype.getAttrStr=function(e,t){var i="";return e&&e[t]?(i+=e[t],t>=y.AttrType.MaxHp_P&&(i=100*e[t]+"%")):i="0",i},__decorate([D(cc.Node)],t.prototype,"attrNode",void 0),__decorate([D(cc.SpriteAtlas)],t.prototype,"attrIcons",void 0),__decorate([D(cc.Toggle)],t.prototype,"toggle",void 0),t=__decorate([w],t)}(n.default);i.default=R,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/Widget":"Widget","../../Global/GlobalValue":"GlobalValue","../../Util/AttrUtil":"AttrUtil","../../Util/RechargeConst":"RechargeConst","../../Util/RechargeUtils":"RechargeUtils","../../Util/Utils":"Utils","../../Util/UtilsFight":"UtilsFight","../Commons/RewardUtils":"RewardUtils","../Item/ItemController":"ItemController","../Item/ItemData":"ItemData","../Item/ItemIcon":"ItemIcon","../Role/RoleInfo":"RoleInfo","../Role/RoleStrengthen/RoleStrengthenController":"RoleStrengthenController","../Role/RoleStrengthen/RoleStrengthenEvent":"RoleStrengthenEvent","../Tips/OpTipsController":"OpTipsController","../Tips/TipsWinController":"TipsWinController","../WarTeam/MonsterController":"MonsterController","./OrnamentCtrl":"OrnamentCtrl"}],OrnamentUtils:[function(e,t,i){"use strict";cc._RF.push(t,"3ba0fLiNLVBv7dozf6lot9M","OrnamentUtils"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./OrnamentCtrl"),o=e("../WarTeam/MonsterController"),a=function(){function e(){}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.prototype.setOrnametProp=function(e){var t=o.default.instance.data.getCardCfg().Card[e.cardid].cardType;return n.default.instance.data.getWearOrnamentAttr(e.cardid,t)},e}();i.default=a,cc._RF.pop()},{"../WarTeam/MonsterController":"MonsterController","./OrnamentCtrl":"OrnamentCtrl"}],OrnamentView:[function(e,t,i){"use strict";cc._RF.push(t,"517d2yoLENK66XhfBC+jRfN","OrnamentView"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../../Core/Language"),a=e("../../Core/GameEventDispatcher"),r=e("../../Core/Event"),s=e("../WarTeam/MonsterController"),l=e("../Equip/equip/EquipCtrl"),c=e("../Item/ItemIcon"),d=e("../../Global/GlobalValue"),p=e("./OrnamentInfo"),h=e("./OrnamentUpgrade"),u=e("./OrnamentUpStage"),f=e("./OrnamentCtrl"),g=e("../../GlobalContext"),y=e("../../Core/LoadManager"),m=e("../Tips/OpTipsController"),C=e("../Commons/Spine"),v=e("../Commons/WindowBg1"),_=e("../../Util/Utils"),b=e("../Commons/MorphologicalTags"),T=cc._decorator,S=T.ccclass,I=T.property,w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tagNode=[],t._cardID=null,t._tag=null,t._clickType=null,t._viewNodeMap=[],t._prefabName=["OrnamentInfo","OrnamentUpgrade","OrnamentUpStage"],t._effectName={10301:"haojiao01",10305:"baoshi01",10302:"haojiao02",10306:"baoshi02",10303:"haojiao03",10307:"baoshi03",10304:"haojiao04",10308:"baoshi04"},t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this);var t=this.node.getChildByName("left").getChildByName("MorphologicalNode");if(t.childrenCount<=0){var i=g.GlobalContext.Root+"prefab/Common/morphologicalTags";y.default.instance.loadResByType(i,cc.Prefab,function(e){var n=_.default.getNodeByUrl(e,i);t.addChild(n);var o=n.getComponent(b.default);f.default.instance.data.MorphologicalTag=o.defalutIndex,o.setShow(o.defalutIndex)},this)}_.default.setImage(this.node.getChildByName("left").getChildByName("bg"),"resources/Card/bg_01.png"),a.GameEventDispatcher.instance.on(r.EventDefiner.Card_updataCardInfo,this.upShow,this),a.GameEventDispatcher.instance.on("BagPackInfoChange",this.upShow,this),a.GameEventDispatcher.instance.on(r.EventDefiner.MorphologicalTags_onClick,this.MorphologicalTag,this)},t.prototype.hide=function(){e.prototype.hide.call(this),a.GameEventDispatcher.instance.off(r.EventDefiner.Card_updataCardInfo,this.upShow,this),a.GameEventDispatcher.instance.off("BagPackInfoChange",this.upShow,this),a.GameEventDispatcher.instance.off(r.EventDefiner.MorphologicalTags_onClick,this.MorphologicalTag,this),a.GameEventDispatcher.instance.emit("HideInfo",this)},t.prototype.setCardId=function(e,t){this._cardID=e,this._clickType=t,this.onclickItem(null,t)},t.prototype.onclickItem=function(e,t){void 0===t&&(t=1),e&&(t=f.default.instance.data.conversio(parseInt(t)));var i=s.default.instance.GetMonsterData(this._cardID);i&&i.peishi[t]?(this._clickType=t,this.upShow()):l.default.instance.onpenWearEquip(this._cardID,t,!0)},t.prototype.upShow=function(){this.setLeftData(),this.setItemData(),this.tabBtnSelectedChange(this._tag?this._tag:0),this.upTabRedPoit()},t.prototype.setLeftData=function(){var e=s.default.instance.GetMonsterData(this._cardID).peishi,t=this.node.getChildByName("left"),i=s.default.instance.data.getCardCfg();t.getChildByName("title").getChildByName("Label").getComponent(cc.Label).string=o.default.getStr("\u4f69\u6234\uff1a")+i.Card[this._cardID].cardName;var n=f.default.instance.data.getOrnamentGuid(e[this._clickType]);t.getChildByName("ornamentName").getComponent(cc.Label).string=n?n.name:"",n?(t.getChildByName("img").active=!0,this.setSpine(t.getChildByName("img"),n.id)):t.getChildByName("img").active=!1},t.prototype.setItemData=function(){var e=s.default.instance.GetMonsterData(this._cardID).peishi,t=s.default.instance.getIsLineup(this._cardID),i=this.node.getChildByName("left").getChildByName("itemNode");for(var n in i.children){var o=f.default.instance.data.conversio(parseInt(n));if(e[o]){var a=f.default.instance.data.getOrnamentGuid(e[o]);i.children[n].getChildByName("ItemIcon").active=!0,i.children[n].getChildByName("ItemIcon").getComponent(c.default).ItemData(a,!1)}else i.children[n].getChildByName("ItemIcon").active=!1;i.children[n].getChildByName("Choose").active=o==this._clickType&&e[o],i.children[n].getChildByName("red").active=t&&f.default.instance.data.getCardOrnamentFlag(this._cardID,f.default.instance.data.conversio(parseInt(n)))}},t.prototype.setSpine=function(e,t){var i=this._effectName[t];e.getComponent(C.default).changeAction("default",i,!0)},t.prototype.tabBtnSelectedChange=function(e){this.setRightShow(e)},t.prototype.setTabShow=function(e){var t=s.default.instance.GetMonsterData(this._cardID).peishi;switch(e){case d.OrnamentTagType.info:this._viewNodeMap[d.OrnamentTagType.info].getComponent(p.default).setData(this._cardID,t[this._clickType]);break;case d.OrnamentTagType.upgrade:this._viewNodeMap[d.OrnamentTagType.upgrade].getComponent(h.default).setData(this._cardID,t[this._clickType]);break;case d.OrnamentTagType.upStage:this.getStageFlag(t[this._clickType])||m.default.instance.ShowMsg(o.default.getStr("\u7d2b\u3001\u6a59\u54c1\u8d28\u914d\u9970\u624d\u53ef\u4ee5\u5347\u9636")),this._viewNodeMap[d.OrnamentTagType.upStage].getComponent(u.default).setData(t[this._clickType])}},t.prototype.setRightShow=function(e){var t=this,i=Number(e);if(this._viewNodeMap[this._tag]&&(this._viewNodeMap[this._tag].active=!1),this._viewNodeMap[e])this._viewNodeMap[e].active=!0,this.setTabShow(i);else{var n=g.GlobalContext.Root+"prefab/Ornament/"+this._prefabName[e];y.default.instance.loadResByType(n,cc.Prefab,function(o){if(!t._viewNodeMap[e]){var a=_.default.getNodeByUrl(o,n);t.node.getChildByName("right").addChild(a),t._viewNodeMap[e]=a,t._tag||(t._tag=e);var r=t._tag==e;t._viewNodeMap[e].active=r,t.setTabShow(i)}},this)}this._tag=e,this._viewNodeMap[this._tag]&&(this._viewNodeMap[this._tag].active=!0)},t.prototype.onClickBtn=function(){var e=s.default.instance.GetMonsterData(this._cardID);e&&e.peishi[this._clickType]&&f.default.instance.reqPeiShiTakeOff(this._cardID,this._clickType)},t.prototype.onClickBtnTwo=function(){l.default.instance.onpenWearEquip(this._cardID,this._clickType,!0)},t.prototype.btnShowChange=function(e,t){var i=parseInt(t),n=s.default.instance.getIdxByCardId(this._cardID),o=s.MonsterType.MonsterWarTeam[s.MonsterType.MonsterBattle];i>0?n+1>o.length-1?n=0:n+=1:n-1<0?n=o.length-1:n-=1,this._cardID=parseInt(o[n]),this.upShow()},t.prototype.getStageFlag=function(e){var t=f.default.instance.data.getOrnamentGuid(e);return!!t&&!!f.default.instance.data.getAccessories(t.colorIndex).upStage},t.prototype.upTabRedPoit=function(){if(this.windowBg){var e=this.windowBg.getComponent(v.default),t=f.default.instance.data,i=s.default.instance.GetMonsterData(this._cardID),n=f.default.instance.data.getOrnamentGuid(i.peishi[this._clickType]),o=s.default.instance.getIsLineup(this._cardID);e.TabBtnList.selectItemSetRed(1,o&&t.getOrnamentUpgradeFlag(n)),e.TabBtnList.selectItemSetRed(2,o&&t.getOrnamentUpStageFlag(n))}},t.prototype.MorphologicalTag=function(e){var t=e.getUserData().tabIndex;f.default.instance.data.MorphologicalTag=t,this.tabBtnSelectedChange(this._tag?this._tag:0)},t.instance=null,__decorate([I([cc.Node])],t.prototype,"tagNode",void 0),t=__decorate([S],t)}(n.default);i.default=w,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/Window":"Window","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/MorphologicalTags":"MorphologicalTags","../Commons/Spine":"Spine","../Commons/WindowBg1":"WindowBg1","../Equip/equip/EquipCtrl":"EquipCtrl","../Item/ItemIcon":"ItemIcon","../Tips/OpTipsController":"OpTipsController","../WarTeam/MonsterController":"MonsterController","./OrnamentCtrl":"OrnamentCtrl","./OrnamentInfo":"OrnamentInfo","./OrnamentUpStage":"OrnamentUpStage","./OrnamentUpgrade":"OrnamentUpgrade"}],Parabola:[function(e,t,i){"use strict";cc._RF.push(t,"85f7apT8ZpPdJkWTvX5jQ1B","Parabola"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./Utils"),o=cc._decorator,a=o.ccclass,r=(o.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._paths=[],t.onCompleteCallback=null,t.onCompleteCallbackThisObj=null,t.onCompleteCallbackParam=null,t.isMoveing=!1,t.targetNode=null,t.nodex=0,t.nodey=0,t}return __extends(t,e),t.prototype.start=function(){this.targetNode=this.node},t.prototype.onDestroy=function(){this.targetNode=null,this.clear()},t.prototype.clear=function(){this._paths.length=0,this.isMoveing=!1,this.nodex=0,this.nodey=0,this.onCompleteCallback=null,this.onCompleteCallbackThisObj=null,this.onCompleteCallbackParam=null},t.prototype.MoveByTime=function(e,t,i,n){void 0===n&&(n=!1);var o=1/cc.game.config.frameRate,a=Math.ceil(i/o);this.MoveByCount(e,t,a,n)},t.prototype.MoveByCount=function(e,t,i,o){void 0===o&&(o=!1),this.isMoveing=!1,this._paths=n.default.getBezierCurvePaths(this.targetNode.position,e,t,i,o),this._paths&&this._paths.length>0&&(this.isMoveing=!0)},t.prototype.MoveBySpeed=function(e,t,i,o,a){void 0===o&&(o=!1);var r=n.default.distance(this.targetNode.x,this.targetNode.y,t.x,t.y)/i;a&&(r=a),this.MoveByTime(e,t,r,o)},t.prototype.updataData=function(){if(this._paths&&this._paths.length>0){var e=this._paths.shift();this.targetNode.setPosition(e),this.nodex=e.x,this.nodey=e.y}1==this.isMoveing&&(!this._paths||this._paths.length<=0)&&(this.isMoveing=!1,this.onCompleteCallback&&this.onCompleteCallback.apply(this.onCompleteCallbackThisObj,this.onCompleteCallbackParam))},t=__decorate([a],t)}(cc.Component));i.default=r,cc._RF.pop()},{"./Utils":"Utils"}],PartnerMain:[function(e,t,i){"use strict";cc._RF.push(t,"97629BUQD1KsZN9WGoGccnA","PartnerMain"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../../Core/GameEventDispatcher"),a=e("./FriendsController"),r=e("../../Core/Language"),s=e("../../Core/Event"),l=e("../Tips/OpTipsController"),c=e("../OpenWin/OpenWinController"),d=e("../../Core/WindowType"),p=e("./FriendBlackList"),h=e("../../Core/LoadManager"),u=e("../../GlobalContext"),f=e("../../Util/Utils"),g=e("../../Util/CommonUtil"),y=cc._decorator,m=y.ccclass,C=y.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.showNode=null,t.blackBtn=null,t.addBtn=null,t.listNode=null,t.listSearchNode=null,t.FriendsNumLabel=null,t.onListview=null,t.btnArrLabel=[],t.btnRed=null,t.searchContent=null,t.symbolArr=[],t.friData=null,t._nowClickActorId=null,t._searchStr=null,t._friendHomeData=null,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this),i.instance=this,this.btnArrLabel[0].string=r.default.getStr("FriendReminder"),this.btnArrLabel[1].string=r.default.getStr("Blacklist"),this.btnArrLabel[2].string=r.default.getStr("Applicationlist"),this.btnArrLabel[3].string=r.default.getStr("AddFriends")},t.prototype.show=function(){e.prototype.show.call(this),this.setOnLineNum(0),this.node.active=!0,this.blackBtn.enabled=!1,this.addBtn.enabled=!1,a.default.instance.friendList(),a.default.instance.reqRecommandfriend(),this.addEvent(),a.default.instance.bool?this.btnRed.active=!0:this.btnRed.active=!1},t.prototype.addEvent=function(){o.GameEventDispatcher.instance.on(s.EventDefiner.FRIENDS_CHAT,this._callYou,this),o.GameEventDispatcher.instance.on(s.EventDefiner.FRIENDS_APPLICATION,this._oneOperation,this),o.GameEventDispatcher.instance.on(s.EventDefiner.FRIENDS_ONCLICK,this._setOnCLICK,this),o.GameEventDispatcher.instance.on(s.EventDefiner.FRIENDS_COME,this._friendCome,this),o.GameEventDispatcher.instance.on(s.EventDefiner.FRIENDS_ADDONE,this._friendAdd,this),o.GameEventDispatcher.instance.on(s.EventDefiner.FriDel,this._friendDelete,this),o.GameEventDispatcher.instance.on(s.EventDefiner.FriOnline,this._friendOnLine,this)},t.prototype.removeEvent=function(){o.GameEventDispatcher.instance.off(s.EventDefiner.FRIENDS_CHAT,this._callYou,this),o.GameEventDispatcher.instance.off(s.EventDefiner.FRIENDS_APPLICATION,this._oneOperation,this),o.GameEventDispatcher.instance.off(s.EventDefiner.FRIENDS_ONCLICK,this._setOnCLICK,this),o.GameEventDispatcher.instance.off(s.EventDefiner.FRIENDS_ADDONE,this._friendAdd,this),o.GameEventDispatcher.instance.off(s.EventDefiner.FriDel,this._friendDelete,this),o.GameEventDispatcher.instance.off(s.EventDefiner.FriOnline,this._friendOnLine,this)},t.prototype.hide=function(){e.prototype.hide.call(this),this.node.active=!1,f.default.setNodeChildDestoryByUrl(this.listNode,u.GlobalContext.Root+"prefab/Friend/Friends"),this.symbolArr=[],this._nowClickActorId=null,this._searchStr=null,this.friData=null,this.removeEvent(),e.prototype.close.call(this)},t.prototype._friendCome=function(){o.GameEventDispatcher.instance.off(s.EventDefiner.FRIENDS_COME,this._friendCome,this),this.friData||(this.friData=a.default.instance.data),this.dataList()},t.prototype.dataList=function(){var e=this;this.showNode.active=!0,h.default.instance.loadResByType(u.GlobalContext.Root+"prefab/Friend/Friends",cc.Prefab,function(t){if(e._nowClickActorId=null,f.default.setNodeChildDestoryByUrl(e.listNode,u.GlobalContext.Root+"prefab/Friend/Friends"),e.symbolArr=[],e.friData.friendArr.length){for(var i=0;i<e.friData.friendArr.length;i++){var n=f.default.getNodeByUrl(t,u.GlobalContext.Root+"prefab/Friend/Friends");n.getComponent("FriendsInfo").setIndex(i,1),n.getComponent("FriendsInfo").setInfo(e.friData.friendArr[i]),e.listNode.addChild(n),e.symbolArr.push(n)}e.showNode.active=!1}e.setSearchShow(!e.showNode.active),e.setOnLineNum(e.friData.friendArr.length),e.blackBtn.enabled=!0,e.addBtn.enabled=!0,e.node.active=!0},this)},t.prototype._callYou=function(e){var t=e.getUserData().actorId;this.hide(),g.CommonUtil.OpenChatWin("2",t)},t.prototype.blackList=function(){var e=this;c.default.instance.openWindow(d.WindowType.FriendBlackList,function(){p.default.instance.setType(!0,e.friData.blackArr)},this)},t.prototype.applyList=function(){c.default.instance.openWindow(d.WindowType.FriendBlackList,function(){p.default.instance.setType(!1,a.default.instance.data.applyArr)},this)},t.prototype.Makefriends=function(){c.default.instance.openWindow(d.WindowType.FriendSearchPage,function(){},this)},t.prototype._friendAdd=function(e){2!=e.getUserData().type&&this.dataList()},t.prototype._friendDelete=function(e){var t=e.getUserData();if(0==t.type){for(var i=0;i<this.symbolArr.length;i++)if(this.symbolArr[i]&&this.symbolArr[i].getComponent("FriendsInfo").getActorId()==t.info.actorId){this.listNode.removeChild(this.symbolArr[i]),this.symbolArr[i].destroy(),this.symbolArr[i]=null,this.symbolArr.splice(i,1);break}this.setOnLineNum(this.friData.friendArr.length),this.showNode.active=!1,this.friData.friendArr.length<=0&&(this.showNode.active=!0),this.setSearchShow(!this.showNode.active)}},t.prototype._friendOnLine=function(e){for(var t=e.getUserData(),i=0;i<this.symbolArr.length;i++)this.symbolArr[i].getComponent("FriendsInfo").getActorId()==t.actorId&&this.symbolArr[i].getComponent("FriendsInfo").setOnLineState(t.online)},t.prototype._oneOperation=function(e){for(var t=e.getUserData(),i=0;i<this.symbolArr.length;i++)this.friData.applyArr[i]&&this.friData.applyArr[i].actorId==t.actorId&&this.friData.applyArr.splice(i,1)},t.prototype.setOnLineNum=function(e){var t=0;this.friData&&(t=this.friData.getFriendOnLineNum()),this.FriendsNumLabel.string=r.default.getStr("FriendsNumber",t,e)},t.prototype._setOnCLICK=function(e){var t=e.getUserData().actorId;t!=this._nowClickActorId&&(this.setOnClick(this._nowClickActorId,!1),this.setOnClick(t,!0),this._nowClickActorId=t)},t.prototype.setOnClick=function(e,t){for(var i in this.symbolArr)this.symbolArr[i].getComponent("FriendsInfo").data.actorId==e&&this.symbolArr[i].getComponent("FriendsInfo").setOnClick(t)},t.prototype.setSearchShow=function(e){this.listSearchNode.active=e},t.prototype.searchStar=function(){var e=this.searchContent.string;if(this._searchStr!=e){var t=[];if(this._searchStr=e,""!=this._searchStr){if(!/^[\u4E00-\u9FA5A-Za-z0-9]+$/.test(e))return void l.default.instance.ShowMsg(r.default.getStr("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u6635\u79f0"));console.log("\u641c\u7d22\u7684\u540d\u5b57\u662f\uff1a",e),t=this.friData.searchDataByName(e)}else t=this.friData.friendArr;this.setSearch(t)}},t.prototype.setSearch=function(e){f.default.setNodeChildDestoryByUrl(this.listNode,u.GlobalContext.Root+"prefab/Friend/Friends"),this.symbolArr=[],this.setFriendData(e)},t.prototype.setFriendData=function(e){var t=this;e.length<=0?l.default.instance.ShowMsg(r.default.getStr("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u6635\u79f0")):h.default.instance.loadResByType(u.GlobalContext.Root+"prefab/Friend/Friends",cc.Prefab,function(i){for(var n=0;n<e.length;n++){var o=f.default.getNodeByUrl(i,u.GlobalContext.Root+"prefab/Friend/Friends");o.getComponent("FriendsInfo").setIndex(n,1),o.getComponent("FriendsInfo").setInfo(e[n]),t.listNode.addChild(o),t.symbolArr.push(o)}},this)},t.instance=null,__decorate([C(cc.Node)],t.prototype,"showNode",void 0),__decorate([C(cc.Button)],t.prototype,"blackBtn",void 0),__decorate([C(cc.Button)],t.prototype,"addBtn",void 0),__decorate([C(cc.Node)],t.prototype,"listNode",void 0),__decorate([C(cc.Node)],t.prototype,"listSearchNode",void 0),__decorate([C(cc.Label)],t.prototype,"FriendsNumLabel",void 0),__decorate([C(cc.Node)],t.prototype,"onListview",void 0),__decorate([C([cc.Label])],t.prototype,"btnArrLabel",void 0),__decorate([C(cc.Node)],t.prototype,"btnRed",void 0),__decorate([C(cc.EditBox)],t.prototype,"searchContent",void 0),t=i=__decorate([m],t)}(n.default);i.default=v,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/Window":"Window","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/CommonUtil":"CommonUtil","../../Util/Utils":"Utils","../OpenWin/OpenWinController":"OpenWinController","../Tips/OpTipsController":"OpTipsController","./FriendBlackList":"FriendBlackList","./FriendsController":"FriendsController"}],PathItem:[function(e,t,i){"use strict";cc._RF.push(t,"244a743xUVJf7xRRdjfvTsK","PathItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/WindowManager"),a=e("../../Core/WindowType"),r=e("../Gamelayer/GameLayer"),s=e("../Shop/ShopController"),l=e("../Shop/ShopConst"),c=e("../TreasureMap/TreasureMapController"),d=e("../../Core/ConfigsManager"),p=e("../DailyCopy/DailyCopyCtrl"),h=e("../DailyCopy/DailyCopyConst"),u=e("../EquipCopy/EquipCopyController"),f=e("../Commons/WindowOpenUtils"),g=e("../Functionicon/FunctionIconController"),y=e("../../Util/CommonUtil"),m=e("../../Global/GlobalValue"),C=cc._decorator,v=C.ccclass,_=C.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.nameLabe=null,t.itemNameLabe=null,t.describeLabe=null,t.iconSprite=null,t.iconAtlas=null,t.windType=0,t.roads=0,t.childIndex=0,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.hide=function(){e.prototype.hide.call(this)},t.prototype.Init=function(e,t,i,n,o,a,r,s,l){if(this.itemNameLabe.string=o,this.describeLabe.string=s,this.windType=n,this.iconSprite.spriteFrame=this.iconAtlas.getSpriteFrame("icon_"+a),this.iconSprite.node.scale=2,this.roads=r,this.childIndex=l||0,r>=109&&r<=114){var f=d.ConfigsManager.instance.getConfigs("DailyCopyConf");switch(r){case 109:i=c.default.instance.getTreasureMainConfig().enterCount,t=c.default.instance.getTreasureMainConfig().enterCount-c.default.instance.getInNum;break;case 110:i=y.CommonUtil.getTimes(m.VipPrivilegeType.DailyCopyArtifactNum)+u.default.instance.getEquipCopyConfig.dailyFreeChallenge,t=u.default.instance.remainChallengeCount;break;case 111:i=y.CommonUtil.getTimes(m.VipPrivilegeType.DailyCopyGemNum)+f.Gem[1].battleNum,t=p.default.instance.serDailydata[h.DailyCopyType.Gem].num;break;case 112:i=y.CommonUtil.getTimes(m.VipPrivilegeType.DailyCopyArtifactNum)+f.Refine[1].battleNum,t=p.default.instance.serDailydata[h.DailyCopyType.Refine].num;break;case 113:i=y.CommonUtil.getTimes(m.VipPrivilegeType.DailyCopyEquipNum)+f.Artifact[1].battleNum,t=p.default.instance.serDailydata[h.DailyCopyType.Artifact].num;break;case 114:i=y.CommonUtil.getTimes(m.VipPrivilegeType.DailyCopyMoneyNum)+f.Money[1].battleNum,t=p.default.instance.serDailydata[h.DailyCopyType.Money].num}this.nameLabe.string=e+"("+t+" / "+i+")"}else this.nameLabe.string=e},t.prototype.SkipBtnEvent=function(){if(g.default.instance.checkIsOpenbyWindowtype(this.windType,!0)){if(this.roads>=118&&this.roads<=122){var e=void 0;switch(this.roads){case 118:e=s.default.instance.nowSortIndex[l.ShopConst.Diamonds];break;case 119:break;case 120:e=s.default.instance.nowSortIndex[l.ShopConst.Equip];break;case 121:e=s.default.instance.nowSortIndex[l.ShopConst.Honor];break;case 122:e=s.default.instance.nowSortIndex[l.ShopConst.integral]}f.default.instance.openWindowType(this.windType,e)}else 101==this.roads?r.default.instance.MainlineLevelBtnClick():f.default.instance.openWindowType(this.windType,this.childIndex);o.default.instance.close(a.WindowType.AcquistionPathWin)}},__decorate([_(cc.Label)],t.prototype,"nameLabe",void 0),__decorate([_(cc.Label)],t.prototype,"itemNameLabe",void 0),__decorate([_(cc.Label)],t.prototype,"describeLabe",void 0),__decorate([_(cc.Sprite)],t.prototype,"iconSprite",void 0),__decorate([_(cc.SpriteAtlas)],t.prototype,"iconAtlas",void 0),t=__decorate([v],t)}(n.default);i.default=b,function(e){e[e.WelfareLobby_ZX=0]="WelfareLobby_ZX",e[e.WelfareLobby_QD=1]="WelfareLobby_QD",e[e.WelfareLobby_DC=2]="WelfareLobby_DC",e[e.WelfareLobby_TZ=3]="WelfareLobby_TZ",e[e.WelfareLobby_TQ=4]="WelfareLobby_TQ",e[e.WelfareLobby_FL=5]="WelfareLobby_FL",e[e.WelfareLobby_LB=6]="WelfareLobby_LB"}(i.Welfarelobby||(i.Welfarelobby={})),cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Widget":"Widget","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../Util/CommonUtil":"CommonUtil","../Commons/WindowOpenUtils":"WindowOpenUtils","../DailyCopy/DailyCopyConst":"DailyCopyConst","../DailyCopy/DailyCopyCtrl":"DailyCopyCtrl","../EquipCopy/EquipCopyController":"EquipCopyController","../Functionicon/FunctionIconController":"FunctionIconController","../Gamelayer/GameLayer":"GameLayer","../Shop/ShopConst":"ShopConst","../Shop/ShopController":"ShopController","../TreasureMap/TreasureMapController":"TreasureMapController"}],PhysicalWin:[function(e,t,i){"use strict";cc._RF.push(t,"52c3dFPlKZL0oc3I1QNxw5i","PhysicalWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../NetConnect/NetConnet"),a=e("../../Core/ConfigsManager"),r=e("../../Core/TimeController"),s=e("../../Util/GrayEffect"),l=e("./PowerContr"),c=e("../Tips/OpTipsController"),d=cc._decorator,p=d.ccclass,h=d.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getBtnOne=null,t.getBtnTwo=null,t.grayBtnOne=null,t.grayBtnTwo=null,t.labeOne=null,t.LabeTwo=null,t.configItem=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),this.grayBtnOne.addComponent(s.default).setGray(!0),this.grayBtnTwo.addComponent(s.default).setGray(!0),this.labeOne.string=this.config[0].startTime+"~"+this.config[0].endTime,this.LabeTwo.string=this.config[1].startTime+"~"+this.config[1].endTime,this.timeToString()},t.prototype.hide=function(){},t.prototype.getfreeenengy=function(){o.default.instance.sendProto({cmd:"getfreeenengy"})},Object.defineProperty(t.prototype,"config",{get:function(){return this.configItem=a.ConfigsManager.instance.getConfigs("freeenergy").FreeEnergyConf,this.configItem},enumerable:!0,configurable:!0}),t.prototype.timeToString=function(){r.default.instance.ServerTimeMins,this.config[0].startmsec,this.config.endmsec;(new Date).getHours()>=parseInt(this.config[0].startTime)&&(new Date).getHours()<parseInt(this.config[0].endTime)&&(console.log(l.default.instance.energyList[0],"sevendaygoalsinfo--------"),this.getBtnOne.active=!1,this.grayBtnOne.active=!0,1==l.default.instance.energyList[0]?(this.grayBtnOne.active=!0,this.getBtnOne.active=!1):(this.getBtnOne.active=!0,this.grayBtnOne.active=!1)),(new Date).getHours()>=parseInt(this.config[1].startTime)&&(new Date).getHours()<parseInt(this.config[1].endTime)&&(this.getBtnTwo.active=!1,this.grayBtnTwo.active=!0,1==l.default.instance.energyList[1]?(this.grayBtnTwo.active=!0,this.getBtnTwo.active=!1):(this.getBtnTwo.active=!0,this.grayBtnTwo.active=!1))},t.prototype.GetBtn=function(e,t){1==Number(t)&&(this.getBtnOne.active=!1,this.grayBtnOne.active=!0),2==Number(t)&&(this.getBtnTwo.active=!1,this.grayBtnTwo.active=!0),this.getfreeenengy(),c.default.instance.ShowMsg("\u9886\u53d6\u6210\u529f")},__decorate([h(cc.Node)],t.prototype,"getBtnOne",void 0),__decorate([h(cc.Node)],t.prototype,"getBtnTwo",void 0),__decorate([h(cc.Node)],t.prototype,"grayBtnOne",void 0),__decorate([h(cc.Node)],t.prototype,"grayBtnTwo",void 0),__decorate([h(cc.Label)],t.prototype,"labeOne",void 0),__decorate([h(cc.Label)],t.prototype,"LabeTwo",void 0),t=__decorate([p],t)}(n.default);i.default=u,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../../NetConnect/NetConnet":"NetConnet","../../Util/GrayEffect":"GrayEffect","../Tips/OpTipsController":"OpTipsController","./PowerContr":"PowerContr"}],PlayerWealthControl:[function(e,t,i){"use strict";cc._RF.push(t,"31918Pc+DlHKrXPpWMGORWR","PlayerWealthControl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../../Core/Widget"),o=e("../../../../Core/GameEventDispatcher"),a=e("../../../../Core/Event"),r=e("../../../../Core/WindowType"),s=e("../../../../GlobalContext"),l=e("../../../../Global/GlobalValue"),c=e("../../Controller/SceneController"),d=e("../../../../Util/NumberUtil"),p=e("../../../Role/RoleInfo"),h=e("../../../../Core/WindowManager"),u=cc._decorator,f=u.ccclass,g=u.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.energyValue=null,t.moneyValue=null,t.diamondValue=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this,o.GameEventDispatcher.instance.on(a.EventDefiner.WindowOpenlink,this.openWealth,this),o.GameEventDispatcher.instance.on(a.EventDefiner.WindowCloselink,this.closeWealth,this),o.GameEventDispatcher.instance.on(a.EventDefiner.PlayerWealthBG,this.setBGActive,this)},t.prototype.show=function(){e.prototype.show.call(this),this.PlayerInfoInit(),o.GameEventDispatcher.instance.on(a.EventDefiner.PlayerMoneyChange,this.PlayerInfoInit,this)},t.prototype.hide=function(){e.prototype.hide.call(this),o.GameEventDispatcher.instance.off(a.EventDefiner.PlayerMoneyChange,this.PlayerInfoInit,this)},t.prototype.PlayerInfoInit=function(){this.diamondValue.getChildByName("count").getComponent(cc.Label).string=d.NumberUtil.getDiamondNum(p.MyRoleInfo.diamond),this.moneyValue.getChildByName("count").getComponent(cc.Label).string=d.NumberUtil.getNumber(p.MyRoleInfo.money),this.energyValue.getChildByName("count").getComponent(cc.Label).string=d.NumberUtil.getNumber(p.MyRoleInfo.energy)+"/"+p.MyRoleInfo.showEnergy},t.prototype.openWealth=function(e){e&&(e.detail==r.WindowType.WorldBoss?this.setActive(e.detail!=r.WindowType.WorldBoss):this.setActive(e.detail!=r.WindowType.Expedition))},t.prototype.closeWealth=function(e){var t=!0;if(s.PlayerData.WindowLayer.childrenCount>0){var i=s.PlayerData.WindowLayer.children[s.PlayerData.WindowLayer.childrenCount-1];"Expedition"==i.name?t=!1:"WorldBoss"==i.name?t=!1:"Expedition"==i.name?t=!1:"RobberyCity"==i.name&&(t=!1)}this.setActive(t)},t.prototype.setActive=function(e){this.energyValue.active=e,this.moneyValue.active=e,this.diamondValue.active=e,e&&this.checkEnergyValue()},t.prototype.onSetBGActive=function(e){void 0===e&&(e=!1),this.energyValue.getChildByName("spriteBG").active=e,this.moneyValue.getChildByName("spriteBG").active=e,this.diamondValue.getChildByName("spriteBG").active=e,e?(this.energyValue.getChildByName("count").color=new cc.Color(104,45,9),this.moneyValue.getChildByName("count").color=new cc.Color(104,45,9),this.diamondValue.getChildByName("count").color=new cc.Color(104,45,9)):(this.energyValue.getChildByName("count").color=new cc.Color(255,255,255),this.moneyValue.getChildByName("count").color=new cc.Color(255,255,255),this.diamondValue.getChildByName("count").color=new cc.Color(255,255,255))},t.prototype.setBGActive=function(e){var t=e.detail;c.default.instance.scenestatus!=l.GameScene.Fight&&c.default.instance.scenestatus!=l.GameScene.Scene||(t=!0),this.checkEnergyValue(),this.onSetBGActive(t)},t.prototype.checkEnergyValue=function(){if(c.default.instance.scenestatus==l.GameScene.Scene){var e=s.PlayerData.WindowLayer.childrenCount-1,t=!1;e>=0&&(t=h.default.instance.isWindowTopShow(s.PlayerData.WindowLayer.children[e].name)),s.PlayerData.WindowLayer.childrenCount<=0||!t?(this.energyValue.active=!0,this.energyValue.x=s.GlobalContext.UIWidth/2-150,this.moneyValue.active=!1,this.diamondValue.active=!1):this.energyValue.x=-95}else c.default.instance.scenestatus==l.GameScene.Main&&(this.moneyValue.active=!0,this.diamondValue.active=!0),this.energyValue.x=-95},t.instance=null,__decorate([g(cc.Node)],t.prototype,"energyValue",void 0),__decorate([g(cc.Node)],t.prototype,"moneyValue",void 0),__decorate([g(cc.Node)],t.prototype,"diamondValue",void 0),t=i=__decorate([f],t)}(n.default);i.default=y,cc._RF.pop()},{"../../../../Core/Event":"Event","../../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../../Core/Widget":"Widget","../../../../Core/WindowManager":"WindowManager","../../../../Core/WindowType":"WindowType","../../../../Global/GlobalValue":"GlobalValue","../../../../GlobalContext":"GlobalContext","../../../../Util/NumberUtil":"NumberUtil","../../../Role/RoleInfo":"RoleInfo","../../Controller/SceneController":"SceneController"}],Player:[function(e,t,i){"use strict";cc._RF.push(t,"fbd07Oz789OAa/GFbwmF6Wf","Player"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./Role"),o=e("../../Global/GlobalValue"),a=e("./Pool/ActorPools"),r=e("../../Core/CommonsResManager"),s=e("../Role/RoleTitle/RoleTitle"),l=cc._decorator,c=l.ccclass,d=l.property,p=function(e){function t(){var t=e.call(this)||this;return t.qiPaoFace=null,t.qiPaoFaceSp=null,t.roleTitle=null,t._titlePosY=290,t.name="Player",t}return __extends(t,e),Object.defineProperty(t.prototype,"isExist",{get:function(){return null!=this.avatar&&void 0!=this.avatar},enumerable:!0,configurable:!0}),t.prototype.show=function(){e.prototype.show.call(this),this.init2()},t.prototype.init2=function(){this.node.opacity=255,this.isDraging=!1,this.avatar.init("role",this.prop.spineId,"skin","default",o.PRIORITY.ROLE_SELF,!1,o.ACTION.STAND,this.prop.dir),this.worldX=this.prop.x,this.worldY=this.prop.y,this.updateSit(this.worldX,this.worldY),this.setNameVisible(!0),this.atkTarget=[]},t.prototype.recovery=function(){this.movingTag=!1,a.ActorPools.recoverPlayer(this.node)},t.prototype.updateData=function(t,i){e.prototype.updateData.call(this,t,i)},t.prototype.moveTowardTarget=function(t,i){e.prototype.moveTowardTarget.call(this,t,i)},t.prototype.movingLine=function(e){},t.prototype.stopMove=function(){this.movingTag=!1,this.status!=o.ACTION.STAND&&this.idle()},t.prototype.stopMoveAndIdle=function(){this.movingTag=!1,this.status!=o.ACTION.STAND&&this.idle()},t.prototype.incHp=function(e,t){var i;if(t)i=t;else{var n=Math.floor(this.prop.maxHP*e);i=this.prop.maxHP+n<this.prop.maxHP?this.prop.maxHP+n:this.prop.maxHP}this.updateHp(i)},t.prototype.decHp=function(e,t){if(!(this.prop.hp<=0)){var i=t||this.prop.hp-e;this.updateHp(i)}},t.prototype.updateHp=function(t){e.prototype.updateHp.call(this,t)},t.prototype.hpOverDead=function(){this.dead()},t.prototype.updateBloodBarHp=function(){e.prototype.updateBloodBarHp.call(this)},t.prototype.updateSit=function(t,i){e.prototype.updateSit.call(this,t,i)},t.prototype.showQiPaoFace=function(e){this.qiPaoFaceSp.spriteFrame=r.default.instance.getSpriteFrameByName(e),this.qiPaoFace.y=this.height/2,this.qiPaoFace.active=!0,this.qiPaoFace&&(this.qiPaoFace.scaleX=this.prop.dir,this.qiPaoFaceSp.node.scaleX=this.prop.dir)},t.prototype.hideQiPaoFace=function(){this.qiPaoFace.active=!1,this.qiPaoFaceSp.spriteFrame=null},t.prototype.setBloodVisible=function(t){e.prototype.setBloodVisible.call(this,t),this.onChangeTitlePos()},t.prototype.onShowRoleTitle=function(e){this.roleTitle.getComponent(s.default).onInitData(e),this.onChangeTitlePos()},t.prototype.onChangeTitlePos=function(e){void 0===e&&(e=!1),this.bloodBar&&this.bloodBar.node.active?this.roleTitle.y=this.bloodBar.node.y+this.bloodBar.node.height+this.roleTitle.height/2:this.roleTitle.y=this._titlePosY},__decorate([d(cc.Node)],t.prototype,"qiPaoFace",void 0),__decorate([d(cc.Sprite)],t.prototype,"qiPaoFaceSp",void 0),__decorate([d(cc.Node)],t.prototype,"roleTitle",void 0),t=__decorate([c],t)}(n.default);i.Player=p,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Global/GlobalValue":"GlobalValue","../Role/RoleTitle/RoleTitle":"RoleTitle","./Pool/ActorPools":"ActorPools","./Role":"Role"}],PlotController:[function(e,t,i){"use strict";cc._RF.push(t,"d42010SqmBA8a0cqRlvqhon","PlotController"),Object.defineProperty(i,"__esModule",{value:!0});var n,o=e("../../Core/Controller"),a=e("../Chapter/ChapterController"),r=e("../Role/RoleInfo"),s=e("../WarTeam/MonsterController"),l=e("../Role/RoleController"),c=e("../../Util/LocalStorageUtils"),d=e("../../Core/Const/EntityType"),p=e("./PlotWin"),h=e("../../GlobalContext"),u=e("../Fight/fightlogic"),f=e("../../Core/TimeController"),g=e("../Commons/MonsterPreview"),y=e("../../Global/GlobalValue"),m=e("../../Util/Utils"),C=e("../../Core/WindowType"),v=e("../Scene/Manager/SceneManager"),_=e("../../Core/SimpleActionEffect"),b=e("../OpenWin/OpenWinController"),T=e("../Fight/staticattr"),S=e("../Scene/Prop/EntityProperty"),I=e("../Scene/Controller/FightController"),w=e("../Scene/Controller/SkillController"),D=e("../Scene/View/ActorsLayer"),R=e("../Scene/Controller/EntityQiPaoController"),A=e("../Commons/Spine"),N=e("../Guide/GuideNewController"),L=e("../Scene/Pool/SpinePools"),E=e("../../Core/SpineBase"),B=e("../Scene/Effect/FntSwingUtils"),M=e("../../Core/LoadManager"),x=e("../Scene/Controller/SceneController"),k=e("../Scene/View/Chapter/ChapterMapView"),P=e("../Sound/SoundController"),G=e("../Scene/View/Chapter/PlayerWealthControl"),F=e("../Gamelayer/GameLayer"),W=e("../Chapter/ChapterRewardTips"),U=e("../../Core/GameEventDispatcher"),O=e("../../Core/Event"),V=e("../Scene/View/ActorsBigSkillLayer");(function(e){e[e.EnterMap=0]="EnterMap",e[e.EnterChapterBefore=1]="EnterChapterBefore",e[e.ExitChapter=2]="ExitChapter",e[e.FightBefore=3]="FightBefore",e[e.SlowTroops=4]="SlowTroops",e[e.FightEnd=5]="FightEnd"})(n=i.PlotType||(i.PlotType={}));var q=cc._decorator,H=q.ccclass,j=(q.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.stepTypeDic={},t.curPlots=[],t.iscomplete=!0,t.pathlevel=-1,t.setindex=0,t.isFightExitToCheck=!1,t.nextStepTime=0,t.moveHandle={},t.skillbgeffect=null,t.plotsStop={},t.step=-1,t.handelDic={},t.effectDic={},t.skillDic={},t.initMapPositionX=0,t.initMapPositionY=0,t.yuneffect=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){var e;i.instance=this,this.initStepTypeDic(),e=[65,66],this.plotsStop[4]=e[0],this.plotsStop[15]=e[1]},t.prototype.start=function(){e.prototype.start.call(this),U.GameEventDispatcher.instance.on(O.EventDefiner.C_SetBigSkill,this.setBigSkill,this)},t.prototype.setBigSkill=function(){var e=this;if(console.log("\u89e6\u53d1\u5927\u62db\u5f15\u5bfc==",this.plotsStop,this.plotid),this.plotsStop[this.plotid]){V.default.instance.isShow=!1;var t=f.default.instance.setTimeout(function(){V.default.instance.isShow=!0,N.default.instance.checkCondition(1,e.plotsStop[e.plotid]),f.default.instance.clearTimeout(t)},this,1e3)}},t.prototype.initStepTypeDic=function(){this.stepTypeDic={};for(var e=0;e<=n.FightEnd;)this.stepTypeDic[e]=[],e++},t.prototype.getPlotInfo=function(e){this.initStepTypeDic(),this.pathlevel=a.default.instance.readyPath;var t=a.default.instance.readyPath;!e||e!=n.ExitChapter&&e!=n.FightEnd||(t=a.default.instance.readyPath-1);var i=a.default.instance.checkGuanqiainfobyid(t);if(i&&i.guanqia&&i.guanqia.plot){var o=i.guanqia.plot;if(o){this.plotid=o;var s=a.default.instance.getPlotconfig(o);if(!s)return;for(var l=0;l<s.length;l++){var d=c.default.instance.getItem(r.MyRoleInfo.id+"chapterplot");d&&d[this.pathlevel+"_"+s[l].enterMap]&&2!=s[l].enterMap||e==s[l].enterMap&&(this.stepTypeDic[s[l].enterMap]||(this.stepTypeDic[s[l].enterMap]=[]),this.stepTypeDic[s[l].enterMap].push(s[l]))}}}},t.prototype.getPremerPlot=function(e,t){return!0},t.prototype.checkPlot=function(e,t,o,a){var r=this;if(void 0===t&&(t=null),void 0===o&&(o=null),void 0===a&&(a=null),this.getPlotInfo(e),this.isFightExitToCheck=e==n.ExitChapter,i.instance.stepTypeDic[e].length>0)this.setindex=e,this.iscomplete=!1,N.default.instance.pause(),this.setOtherUIOpacity(0),this.setindex==n.EnterMap?(M.default.instance.loadResByType(y.SPINE_RES_DIR+"scene/yun/effect",sp.SkeletonData,function(){r.yuneffect=L.SpinePools.addSpineNoder(h.PlayerData.TipsLayer,new cc.Vec2(0,0)),r.yuneffect.getComponent(E.default).initSpineData(y.SPINE_RES_DIR+"scene/yun/effect",null,"stand",!0);var e=f.default.instance.setTimeout(function(){r.clearYunEffect(),f.default.instance.clearTimeout(e)},r,2e3)},this),b.default.instance.openWindow(C.WindowType.PlotWin,function(){r.thiscallback=t,r.thiscallbackThisObj=o,r.thiscallbackParam=a,r.clearYunEffect()},this)):b.default.instance.openWindow(C.WindowType.PlotWin,function(){r.thiscallback=t,r.thiscallbackThisObj=o,r.thiscallbackParam=a},this);else{if(-1!=this.step&&!this.iscomplete)return;this.iscomplete=!0,this.curPlotsConf=null,t&&e!=n.FightBefore&&t.apply(o,[a]),this.onCheckUpGrade()}},t.prototype.playYunEffect=function(){},t.prototype.clearYunEffect=function(){var e=this;if(this.yuneffect){L.SpinePools.recoverSpineNoder(this.yuneffect),this.yuneffect=null,this.yuneffect=L.SpinePools.addSpineNoder(h.PlayerData.TipsLayer,new cc.Vec2(0,0));var t=this.yuneffect.getComponent(E.default);t.initSpineData(y.SPINE_RES_DIR+"scene/yun/effect",null,"effect",!1),t.completeCallbackThisObj=this,t.completeCallback=function(){L.SpinePools.recoverSpineNoder(e.yuneffect),e.yuneffect=null}}},t.prototype.setOtherUIOpacity=function(e){k.default.instance.Container.opacity=e,k.default.instance.RewardBox.opacity=e,k.default.instance.ResetBtn.opacity=e,k.default.instance.layerBottomBtn.opacity=e,G.default.instance.node.opacity=e,F.default.instance.node.getChildByName("systemOpen")&&F.default.instance.checkSysteamOpenNodeActive();var t=x.default.instance.SceneView.getChildByName("BackBtn");t&&(t.opacity=e),x.default.instance.SceneView.getChildByName("ChapterRewardTips")&&W.default.instance&&W.default.instance.node.parent&&(W.default.instance.node.parent.active=e);var i=k.default.instance.node.getChildByName("ChapterDown");i&&(i.opacity=e)},t.prototype.startPlot=function(){this.setindex<=n.ExitChapter?P.default.instance.PlayBGM(P.SoundType.mainBG):P.default.instance.PlayBGM(P.SoundType.sandtableWindowBG),this.clearYunEffect(),-1==this.step&&void 0!==i.instance.stepTypeDic[this.setindex]&&(this.iscomplete=!1,this.step=0,this.curPlots=[],this.setindex<0||(this.curPlots=this.stepTypeDic[this.setindex].slice(0),this.setindex==n.ExitChapter&&this.stepTypeDic[this.setindex].length<=0||(this.curPlots.length>0?this.updateStep():this.completePlot())))},t.prototype.getPos=function(e,t,i){var o=0,a=0;return this.curPlotsConf.enterMap<n.FightBefore?(o=this.curPlotsConf.param[1]==u.CampEnum.Self?-k.default.instance.DragNode.x-h.GlobalContext.UIWidth/2+t:-k.default.instance.DragNode.x+h.GlobalContext.UIWidth/2-t,a=Math.abs(k.default.instance.DragNode.y)+i):(o=e==u.CampEnum.Self?-h.GlobalContext.UIWidth/2+t:h.GlobalContext.UIWidth/2-t,a=i-h.GlobalContext.UIHeight/2),new cc.Vec2(o,a)},t.prototype.updateStep=function(){var e=this;if(this.curPlotsConf=this.curPlots[this.step],this.nextStepTime&&f.default.instance.clearTimeout(this.nextStepTime),this.curPlotsConf&&!this.iscomplete)switch(this.curPlotsConf.enterMap!=n.FightBefore&&this.curPlotsConf.enterMap!=n.FightEnd||D.default.instance.setEntitysOpacity(0),this.curPlotsConf.type){case 1:case 2:var t=this.curPlotsConf.param[4],i=this.curPlotsConf.param[1]==u.CampEnum.Self?-1:1,o=p.default.instance.Pic,a=1;this.curPlotsConf.enterMap<n.FightBefore&&(o=k.default.instance.DragNode,a=.5),void 0!==this.curPlotsConf.scale&&(a=this.curPlotsConf.scale/100);var l=2==this.curPlotsConf.type?y.ACTION.WALK:y.ACTION.STAND,c=2==this.curPlotsConf.type?0:t,h=this.getPos(this.curPlotsConf.param[1],c,this.curPlotsConf.param[5]);if(this.curPlotsConf.param[0]==d.EntityType.enActor)this.curPlotsConf.param[3]?this.handelDic[this.curPlotsConf.param[3]]=s.default.instance.infoRolePreview(o,h,this.curPlotsConf.param[2],1,a,l,i):this.handelDic[this.curPlotsConf.param[3]]=s.default.instance.infoRolePreview(o,h,r.MyRoleInfo.currentsurface,1,a,l,i);else{var m=void 0===this.curPlotsConf.param[7]?5:this.curPlotsConf.param[7];this.handelDic[this.curPlotsConf.param[3]]=s.default.instance.infoPreview(o,h,this.curPlotsConf.param[2],m,a,i,!0,null,null,l)}2==this.curPlotsConf.type&&(t=this.curPlotsConf.param[1]==u.CampEnum.Self?-t:t),2==this.curPlotsConf.type&&(this.addMoveHandle(this.curPlotsConf.param[3],this.handelDic[this.curPlotsConf.param[3]],h.x-t,h.y),this.handelDic[this.curPlotsConf.param[3]].runAction(cc.sequence(cc.moveTo(this.curPlotsConf.param[6]/1e3,new cc.Vec2(h.x-t,h.y)),cc.callFunc(function(t,i){e.clearMoveHanle(e.curPlotsConf.param[3]),t.getComponent(g.default).play(y.ACTION.STAND)},this,this.curPlotsConf)))),this.checkStep();break;case 3:case 4:if(this.handelDic[this.curPlotsConf.param[3]])if(3==this.curPlotsConf.type)this.recoveryPreview(this.curPlotsConf.param[3]),delete this.handelDic[this.curPlotsConf.param[3]],this.checkStep();else{this.addMoveHandle(this.curPlotsConf.param[3],this.handelDic[this.curPlotsConf.param[3]],this.handelDic[this.curPlotsConf.param[3]].x+this.curPlotsConf.param[4],this.handelDic[this.curPlotsConf.param[3]].y+this.curPlotsConf.param[5]);var C=this.curPlotsConf.param[4]>0?-1:1;this.handelDic[this.curPlotsConf.param[3]].getComponent(g.default).play(y.ACTION.WALK,C),this.handelDic[this.curPlotsConf.param[3]].runAction(cc.sequence(cc.moveBy(this.curPlotsConf.param[6]/1e3,new cc.Vec2(this.curPlotsConf.param[4],this.curPlotsConf.param[5])),cc.callFunc(function(t,i){e.clearMoveHanle(e.curPlotsConf.param[3]),t.getComponent(g.default).play(y.ACTION.STAND)},this,this.curPlotsConf))),this.checkStep()}else this.checkStep();break;case 5:if(this.curPlotsConf.param[0]){var _=null;(_=0==this.curPlotsConf.param[1]?D.default.instance.getSceneEntity(v.default.instance.myRoleHandle):D.default.instance.getSceneEntity(this.curPlotsConf.param[1]))&&R.default.instance.showQiPao(_,this.curPlotsConf.str,this.curPlotsConf.param[2])}else this.handelDic[this.curPlotsConf.param[1]].setSiblingIndex(this.handelDic[this.curPlotsConf.param[1]].parent.childrenCount+1),this.handelDic[this.curPlotsConf.param[1]].getComponent(g.default).showQiPao(this.curPlotsConf.str,this.curPlotsConf.param[2]);this.checkStep();break;case 6:p.default.instance.selfTalkDeal(this.curPlotsConf);break;case 7:0==this.curPlotsConf.param[0]&&0==this.curPlotsConf.param[1]?this.initMapPositionX&&this.initMapPositionY&&k.default.instance.DragNode.runAction(cc.sequence(cc.moveBy(this.curPlotsConf.param[2]/1e3,new cc.Vec2(this.curPlotsConf.param[0],0)),cc.callFunc(function(){e.checkStep()}))):(this.initMapPositionX=k.default.instance.DragNode.x,this.initMapPositionY=k.default.instance.DragNode.y,k.default.instance.DragNode.runAction(cc.sequence(cc.moveBy(this.curPlotsConf.param[2]/1e3,new cc.Vec2(this.curPlotsConf.param[0],0)),cc.callFunc(function(){e.checkStep()}))));break;case 8:this.addEffect();break;case 9:this.fightMapAddMonster();break;case 10:this.addSpine();break;case 11:this.useBigSkill()}else this.completePlot()},t.prototype.useBigSkill=function(){this.handelDic[this.curPlotsConf.param[0]]&&(this.setSkillbgeffect(),this.handelDic[this.curPlotsConf.param[0]].getComponent(g.default).avatar.body.setAnimEventCall("skill",this.playHurt,this,null),this.handelDic[this.curPlotsConf.param[0]].getComponent(g.default).play(y.ACTION.FIGHT2),this.handelDic[this.curPlotsConf.param[0]].getComponent(g.default).setAnimOneEnd(this.clearBigSkill,this))},t.prototype.playHurt=function(){var e=this;this.handelDic[this.curPlotsConf.param[0]].getComponent(g.default).avatar.body.setAnimEventCall("skill",null,null,null);var t=function(t){var n=i.curPlotsConf.points[t],o=i.handelDic[n].getComponent(g.default),a=s.default.instance.getCardGradeByGradeConf(o.cardid,o.grade).height,r=p.default.instance.Pic,l=i.handelDic[i.curPlotsConf.param[0]].getComponent(g.default),c=s.default.instance.getCardGradeByGradeConf(3,5),d=l.x,h=l.y+c.height*l.node.scale;l.avatar.body.spine.findBone("zidan")&&(h+=l.avatar.body.spine.findBone("zidan").y*l.node.scale,d+=-1*l.avatar.body.spine.findBone("zidan").x*l.node.scale);var u=L.SpinePools.addSpineNoder(r,new cc.Vec2(d,h)),f=Math.atan2(u.y-o.y,o.x-u.x),m=f*(180/Math.PI);o.y<u.y&&(m=-(f=Math.atan2(o.y-u.y,o.x-u.x))*(180/Math.PI)),u.rotation=m,i.skillDic[t]=u;var C=u.getComponent(E.default);C.initSpineData(y.SPINE_RES_DIR+"monster/"+c.modelId+"/effect",null,"skin5_fight1_a",!0),u.scale=l.node.scale,u.scaleX=-1*u.scale,u.runAction(cc.sequence(cc.moveTo(.3,o.node.position),cc.callFunc(function(){B.default.instance.showSingleHurtValue(e.handelDic[n].x,e.handelDic[n].y+a*e.handelDic[n].scale,2,Math.ceil(9999999*Math.random()),p.default.instance.node.getChildByName("maskButton")),C.play("skin5_fight2_b"),C.loop=!1,C.completeCallbackThisObj=e,C.completeCallback=function(){L.SpinePools.recoverSpineNoder(u),e.recoveryPreview(n),delete e.handelDic[n],delete e.skillDic[t]}})))},i=this;for(var n in this.curPlotsConf.points)t(n)},t.prototype.clearBigSkill=function(){var e=this;this.handelDic[this.curPlotsConf.param[0]].getComponent(g.default).play(y.ACTION.STAND),this.handelDic[this.curPlotsConf.param[0]].getComponent(g.default).clearAnimEndCall(),this.skillbgeffect&&L.SpinePools.recoverSpineNoder(this.skillbgeffect);f.default.instance.setTimeout(function(){e.checkStep()},this,1e3)},t.prototype.setSkillbgeffect=function(){var e=w.default.instance.getSkillBySkillId(this.curPlotsConf.param[1]);if(e.skillBgEffect){var t=p.default.instance.Pic;this.skillbgeffect=L.SpinePools.addSpineNoder(t,new cc.Vec2(0,0)),this.skillbgeffect.setSiblingIndex(0);var i=this.skillbgeffect.getComponent(E.default);i.playRate=1,i.initSpineData(y.SPINE_RES_DIR+"fightskillbg/fight_bg",null,"fight_bg"+e.skillBgEffect,!0)}},t.prototype.enterNextStep=function(){this.clearEffect(),this.hidehandelDicQiPao(),this.clearNextStepTime(),this.skipMoveHandle(),this.nextStep()},t.prototype.hidehandelDicQiPao=function(){for(var e in this.handelDic){(t=this.handelDic[e]).getComponent(g.default).hideQiPao()}for(var e in D.default.instance.entities){var t=D.default.instance.entities[e];R.default.instance.hideQiPao(t)}},t.prototype.fightMapAddMonster=function(){this.addMonsters(a.default.instance.getPlotMonsters(this.curPlotsConf.monsters)),this.checkStep()},t.prototype.addMonsters=function(e){for(var t=0,i=e;t<i.length;t++){var n=i[t],o=h.GlobalContext.UIWidth/2,a=-h.GlobalContext.UIHeight/2,r=this.getMonsterAttr(n),s={cardid:n.cardId,grade:n.grade,level:n.level,num:n.num,self:!n.camp,x:n.camp?o-n.x:n.x-o,y:a+n.y,attr:r,autoUseSkill:!!n.autousebigskill&&n.autousebigskill,skills:r.skills,reinforcement:!0,handle:n.handle};I.default.instance.fightingAddActor(s,y.ADD_ACTOR_TYPE.REINFORCEMENTS,null,null,!1)}},t.prototype.getMonsterAttr=function(e){var t=new T.StaticAttr,i=(s.default.instance.getCardConfCardType(e.cardId),new S.EntityProperty);i.cardid=e.cardId,i.grade=e.grade,i.type=d.EntityType.enMonster,i.selfMonster=!1;for(var n=w.default.instance.getSkills(i,e.skilllevel),o=0;o<e.prop.length;o++){var a=e.prop[o];t.Push(o,a)}return t.skills=n,t},t.prototype.clearNextStepTime=function(){this.nextStepTime||(f.default.instance.clearTimeout(this.nextStepTime),this.nextStepTime=0)},t.prototype.nextStep=function(){i.instance.stepTypeDic[this.setindex]&&i.instance.stepTypeDic[this.setindex].length>0&&(this.step++,this.updateStep())},t.prototype.checkStep=function(){var e=this;this.curPlotsConf&&(this.curPlotsConf.nexttime?this.nextStepTime=f.default.instance.setTimeout(function(){e.nextStep(),e.clearNextStepTime()},this,this.curPlotsConf.nexttime):this.nextStep())},t.prototype.addEffect=function(){var e=this,t=new cc.Node;t.setScale(1,1);p.default.instance.Pic;this.curPlotsConf.enterMap<n.FightBefore&&k.default.instance.DragNode;var i=this.getPos(this.curPlotsConf.param[2],this.curPlotsConf.param[0],this.curPlotsConf.param[1]);t.setPosition(i),p.default.instance.node.addChild(t),t.addComponent(_.default),t.getComponent(_.default).playById(3,this.curPlotsConf.str,!0),t.getComponent(_.default).endframe=0;var o=f.default.instance.setTimeout(function(t){f.default.instance.clearTimeout(o),e.effectDic[t][1].removeFromParent();f.default.instance.setTimeout(function(){e.effectDic[t][1].destroy(),delete e.effectDic[t],e.checkStep()},e,500)},this,this.curPlotsConf.param[2],[this.step]);this.effectDic[this.step]=[o,t]},t.prototype.addSpine=function(){var e=this,t=new cc.Node;t.setScale(1,1);var i=p.default.instance.Pic;this.curPlotsConf.enterMap<n.FightBefore&&(i=k.default.instance.DragNode);var o=this.getPos(this.curPlotsConf.param[2],this.curPlotsConf.param[0],this.curPlotsConf.param[1]);t.setPosition(o);var a=t.addComponent(A.default);i.addChild(t),a.updateBg(this.curPlotsConf.str,this.curPlotsConf.skin,this.curPlotsConf.ani,!0);var r=f.default.instance.setTimeout(function(t){f.default.instance.clearTimeout(r),e.effectDic[t][1].removeFromParent(),e.effectDic[t][1].destroy(),delete e.effectDic[t]},this,this.curPlotsConf.param[2],[this.step]);this.effectDic[this.step]=[r,t],this.checkStep()},t.prototype.clearEffect=function(){for(var e in this.effectDic)f.default.instance.clearTimeout(this.effectDic[e][0]),this.effectDic[e][1].removeFromParent(),this.effectDic[e][1].destroy();for(var e in this.effectDic={},this.skillDic)L.SpinePools.recoverSpineNoder(this.skillDic[e]);this.skillDic={}},t.prototype.completePlot=function(){var e=this;for(var t in x.default.instance.scenestatus!=y.GameScene.Fight&&P.default.instance.PlayBGM(P.SoundType.mainBG),k.default.instance.DragNode.stopAllActions(),k.default.instance.plotComResetDragNodex(),this.setOtherUIOpacity(255),this.clearEffect(),this.iscomplete=!0,this.curPlotsConf=null,this.handelDic)this.recoveryPreview(t);this.handelDic={},this.initMapPositionX=0,this.initMapPositionY=0;var i=f.default.instance.setTimeout(function(){e.thiscallback&&(e.thiscallback.apply(e.thiscallbackThisObj,[e.thiscallbackParam]),e.thiscallback=null,e.thiscallbackThisObj=null,e.thiscallbackParam=null),f.default.instance.clearTimeout(i)},this,100);for(var t in p.default.instance.closewindow(),this.onCheckUpGrade(),this.moveHandle){var n=parseInt(t);this.clearMoveHanle(n)}this.step=-1,N.default.instance.resume()},t.prototype.onCheckUpGrade=function(){this.isFightExitToCheck&&(this.isFightExitToCheck=!1,l.default.instance.RoleUpgrading(!0))},t.prototype.recoveryPreview=function(e){var t=this.handelDic[e];if(t){t.stopAllActions();var i=t.getComponent(g.default);t.scale=1,i.clear(),m.default.setNodeToPool(C.PoolType.MonsterPreview,t)}},t.prototype.addMoveHandle=function(e,t,i,n){this.moveHandle[e]={x:i,y:n,node:t}},t.prototype.skipMoveHandle=function(){for(var e in this.moveHandle){var t=this.moveHandle[e].node,i=parseInt(e);t.stopAllActions(),t.setPosition(this.moveHandle[i].x,this.moveHandle[i].y),t.getComponent(g.default).play(y.ACTION.STAND),this.clearMoveHanle(i)}},t.prototype.clearMoveHanle=function(e){this.moveHandle[e]&&delete this.moveHandle[e]},t.instance=null,t=i=__decorate([H],t)}(o.default));i.default=j,cc._RF.pop()},{"../../Core/Const/EntityType":"EntityType","../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/LoadManager":"LoadManager","../../Core/SimpleActionEffect":"SimpleActionEffect","../../Core/SpineBase":"SpineBase","../../Core/TimeController":"TimeController","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/LocalStorageUtils":"LocalStorageUtils","../../Util/Utils":"Utils","../Chapter/ChapterController":"ChapterController","../Chapter/ChapterRewardTips":"ChapterRewardTips","../Commons/MonsterPreview":"MonsterPreview","../Commons/Spine":"Spine","../Fight/fightlogic":"fightlogic","../Fight/staticattr":"staticattr","../Gamelayer/GameLayer":"GameLayer","../Guide/GuideNewController":"GuideNewController","../OpenWin/OpenWinController":"OpenWinController","../Role/RoleController":"RoleController","../Role/RoleInfo":"RoleInfo","../Scene/Controller/EntityQiPaoController":"EntityQiPaoController","../Scene/Controller/FightController":"FightController","../Scene/Controller/SceneController":"SceneController","../Scene/Controller/SkillController":"SkillController","../Scene/Effect/FntSwingUtils":"FntSwingUtils","../Scene/Manager/SceneManager":"SceneManager","../Scene/Pool/SpinePools":"SpinePools","../Scene/Prop/EntityProperty":"EntityProperty","../Scene/View/ActorsBigSkillLayer":"ActorsBigSkillLayer","../Scene/View/ActorsLayer":"ActorsLayer","../Scene/View/Chapter/ChapterMapView":"ChapterMapView","../Scene/View/Chapter/PlayerWealthControl":"PlayerWealthControl","../Sound/SoundController":"SoundController","../WarTeam/MonsterController":"MonsterController","./PlotWin":"PlotWin"}],PlotWin:[function(e,t,i){"use strict";cc._RF.push(t,"c35efHVZ55LN7PrRlSDn+5M","PlotWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../../Core/LoadManager"),a=e("./PlotController"),r=e("../../GlobalContext"),s=e("../../Core/WindowManager"),l=e("../../Core/CacheManager"),c=e("../../Core/GameEventDispatcher"),d=e("../../Core/Event"),p=e("../../Util/LocalStorageUtils"),h=e("../../Core/TimeController"),u=e("../Role/RoleInfo"),f=e("../Chapter/ChapterController"),g=e("../../NetConnect/NetConnet"),y=e("../../Core/Const/EntityType"),m=e("../WarTeam/MonsterController"),C=e("../Scene/View/ActorsLayer"),v=cc._decorator,_=v.ccclass,b=v.property,T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Spr1=null,t.SelfTalk=null,t.Pic=null,t.Talk=null,t.skipBtn=null,t.maskBg=null,t.maskBtn=null,t.spritfamArr=[],t.thiscallback=null,t.thiscallbackThisObj=null,t.thiscallbackParam=null,t._url="",t.startPlotTime=0,t.atime=0,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this),i.instance=this,this.node.getChildByName("singleColor").setContentSize(r.GlobalContext.UIWidth,r.GlobalContext.UIHeight),this.node.getChildByName("singleColor1").setContentSize(r.GlobalContext.UIWidth,r.GlobalContext.UIHeight),this.Talk.y=-r.GlobalContext.UIHeight/2+this.Talk.height/2-125,this.skipBtn.x=-(r.GlobalContext.UIWidth/2-this.skipBtn.width/2),r.PlayerData.TopLayer.active=!1},t.prototype.show=function(){e.prototype.show.call(this),this.node.zIndex=999,this.skipBtn.active=a.default.instance.setindex!=a.PlotType.SlowTroops,this.maskBtn.node.on(cc.Node.EventType.TOUCH_END,this.clickToggle,this),c.GameEventDispatcher.instance.emit(d.EventDefiner.SetSceneBackState,!1)},t.prototype.hide=function(){e.prototype.hide.call(this),this.clearStartPlotTime(),this.node.getChildByName("singleColor1").getChildByName("mainspine").getComponent(sp.Skeleton).clearTracks(),this.node.getChildByName("singleColor1").active=!1;var t=p.default.instance.getItem(u.MyRoleInfo.id+"chapterplot");t||(t={}),clearInterval(this.atime),t[a.default.instance.pathlevel+"_"+a.default.instance.setindex]=h.default.instance.ServerTime,a.default.instance.setindex!=a.PlotType.FightBefore&&a.default.instance.setindex!=a.PlotType.SlowTroops&&p.default.instance.setItem(u.MyRoleInfo.id+"chapterplot",t),a.default.instance.getPlotInfo(a.PlotType.EnterMap),this.spritfamArr=[],a.default.instance.setindex=-1,this.Pic.destroyAllChildren(),this.Talk.destroyAllChildren(),this.setMaskBgActive(!1),r.PlayerData.TopLayer.active=!0,this._url&&""!=this._url&&(l.default.instance.clearUseRecord(this._url),this._url=""),C.default.instance.setEntitysOpacity(255),this.maskBtn.node.off(cc.Node.EventType.TOUCH_END,this.clickToggle,this),c.GameEventDispatcher.instance.emit(d.EventDefiner.SetSceneBackState)},t.prototype.clickToggle=function(e){if(e.stopPropagation(),a.default.instance.curPlotsConf)switch(console.log("\u4e3b\u7ebf\u5267\u60c5\u70b9\u51fb\u4e8b\u4ef6\u5f53\u524d\u5267\u60c5\u7c7b\u578b \uff1a "+a.default.instance.curPlotsConf.type),a.default.instance.curPlotsConf.type){case 6:this.Mainpictoggle(null);break;case 1:case 2:case 3:case 4:case 5:case 8:case 10:a.default.instance.enterNextStep();break;default:console.log("\u4e0d\u80fd\u8df3\u8f6c")}},t.prototype.skip=function(){a.default.instance.completePlot()},t.prototype.closewindow=function(e){void 0===e&&(e=null),s.default.instance.closeWindow(this.node)},t.prototype.enterMainPlot=function(e){this.spritfamArr=e;var t=this.spritfamArr.length;this.Spr1.setContentSize(r.GlobalContext.UIWidth,r.GlobalContext.UIHeight);for(var i=0;i<t;i++){var n=cc.instantiate(this.Spr1);n.active=!0,n.getComponent(cc.Sprite).spriteFrame=this.spritfamArr.pop(),this.Pic.addChild(n)}},t.prototype.selfTalkDeal=function(e){var t=this;this.Talk.destroyAllChildren();var i=0==e.param[1]?1:-1,n="role",o=u.MyRoleInfo.name,a=u.MyRoleInfo.currentsurface,s=1;e.param[0]==y.EntityType.enMonster&&(i=-1,n="monster",o=m.default.instance.GetMonsterInfo(e.param[2]).cardName,a=e.param[2],s=e.param[3]);var l=cc.instantiate(this.SelfTalk);l.scaleX=i,l.getChildByName("info").getChildByName("name").scaleX=i,l.getChildByName("info").getChildByName("name").getComponent(cc.Label).string=o,l.getChildByName("info").getChildByName("content").scaleX=i,"monster"==n?m.default.instance.infoPreview(l.getChildByName("info"),new cc.Vec2(-654,27),a,s):m.default.instance.infoRolePreview(l.getChildByName("info"),new cc.Vec2(-654,27),a,s);var c=l.getChildByName("info").getChildByName("content").getComponent(cc.RichText);c.string="";var d=0;h.default.instance.clearInterval(this.atime),this.atime=0,this.atime=h.default.instance.setInterval(function(){e.str.length>d?c.string+=e.str.substr(d++,1)+"":(h.default.instance.clearInterval(t.atime),t.atime)},this,50),l.active=!0,l.y=-r.GlobalContext.UIHeight/2+l.width/2,this.setMaskBgActive(!0),this.Talk.addChild(l)},t.prototype.setMaskBgActive=function(e){this.maskBg.active=e},t.prototype.Mainpictoggle=function(e){var t=this.Talk.children[this.Talk.childrenCount-1];if(!t)return this.setMaskBgActive(!1),void a.default.instance.checkStep();t.runAction(cc.sequence(cc.fadeOut(.5),cc.callFunc(function(){0==t.getSiblingIndex()&&a.default.instance.checkStep(),t.destroy()},this)))},t.prototype.loadMainchapter=function(e,t,i){var n=this;void 0===e&&(e=null),void 0===t&&(t=null),void 0===i&&(i=null),this.node.getChildByName("singleColor1").active=!0,this.thiscallbackThisObj=t,this.thiscallbackParam=t,this.thiscallback=e,l.default.instance.setUseRecord("ui/scene/Plot/Chapteranim"),o.default.instance.loadResDir("ui/scene/Plot/Chapteranim",null,function(e){for(var t=0;t<e.length;t++)if(e[t]instanceof sp.SkeletonData)if("zhong"==e[t].name){n.node.getChildByName("singleColor1").getChildByName("mainspine").getComponent(sp.Skeleton).skeletonData=e[t];var i=Math.round(e[t].getRuntimeData(!1).animations[f.default.instance.currentChapterId].duration);n.scheduleOnce(n.chapteranimend,i),n.node.getChildByName("singleColor1").getChildByName("mainspine").getComponent(sp.Skeleton).paused=!1,n.node.getChildByName("singleColor1").getChildByName("mainspine").getComponent(sp.Skeleton).setAnimation(0,f.default.instance.currentChapterId+1+"",!1)}else"huo"==e[t].name&&(n.node.getChildByName("singleColor1").getChildByName("huo").getComponent(sp.Skeleton).skeletonData=e[t],n.node.getChildByName("singleColor1").getChildByName("huo1").getComponent(sp.Skeleton).skeletonData=e[t],n.node.getChildByName("singleColor1").getChildByName("huo").getComponent(sp.Skeleton).paused=!1,n.node.getChildByName("singleColor1").getChildByName("huo").getComponent(sp.Skeleton).animation="1",n.node.getChildByName("singleColor1").getChildByName("huo1").getComponent(sp.Skeleton).paused=!1,n.node.getChildByName("singleColor1").getChildByName("huo1").getComponent(sp.Skeleton).animation="1");else e[t]instanceof cc.SpriteFrame&&"di"==e[t].name&&(n.node.getChildByName("singleColor1").getComponent(cc.Sprite).spriteFrame=e[t])},this)},t.prototype.chapteranimend=function(){a.default.instance.setindex=0,f.default.instance.isPlayChapteranim=!1;var e={cmd:"chaptervideo",chapter:f.default.instance.currentChapterId+1};a.default.instance.thiscallbackThisObj=this.thiscallbackThisObj,a.default.instance.thiscallbackParam=this.thiscallbackParam,a.default.instance.thiscallback=this.thiscallback,a.default.instance.startPlot(),g.default.instance.sendProto(e)},t.prototype.initWidget=function(){e.prototype.initWidget.call(this),this.setStartPlotTime()},t.prototype.moveDragNodeByLocalPosition=function(e){var t=f.default.instance.readyPath,i=f.default.instance.checkGuanqiainfobyid(t).guanqia.guanqiaId;e.guanqia[i].x,e.guanqia[i].y;this.setStartPlotTime()},t.prototype.setStartPlotTime=function(){var e=this;this.startPlotTime||(this.startPlotTime=h.default.instance.setTimeout(function(){a.default.instance.startPlot(),e.clearStartPlotTime()},this,1e3))},t.prototype.clearStartPlotTime=function(){this.startPlotTime&&(h.default.instance.clearTimeout(this.startPlotTime),this.startPlotTime=0)},t.instance=null,__decorate([b(cc.Node)],t.prototype,"Spr1",void 0),__decorate([b(cc.Node)],t.prototype,"SelfTalk",void 0),__decorate([b(cc.Node)],t.prototype,"Pic",void 0),__decorate([b(cc.Node)],t.prototype,"Talk",void 0),__decorate([b(cc.Node)],t.prototype,"skipBtn",void 0),__decorate([b(cc.Node)],t.prototype,"maskBg",void 0),__decorate([b(cc.Button)],t.prototype,"maskBtn",void 0),t=i=__decorate([_],t)}(n.default);i.default=T,cc._RF.pop()},{"../../Core/CacheManager":"CacheManager","../../Core/Const/EntityType":"EntityType","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/Window":"Window","../../Core/WindowManager":"WindowManager","../../GlobalContext":"GlobalContext","../../NetConnect/NetConnet":"NetConnet","../../Util/LocalStorageUtils":"LocalStorageUtils","../Chapter/ChapterController":"ChapterController","../Role/RoleInfo":"RoleInfo","../Scene/View/ActorsLayer":"ActorsLayer","../WarTeam/MonsterController":"MonsterController","./PlotController":"PlotController"}],PotentialTips:[function(e,t,i){"use strict";cc._RF.push(t,"ef0b9oSRb9E95UlObUQHmVb","PotentialTips"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../WarTeam/MonsterController"),a=e("../../Core/Language"),r=e("../../Core/CommonsResManager"),s=cc._decorator,l=s.ccclass,c=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.richText=null,t.content=null,t.scrollView=null,t.prefabNode=null,t.spriteAtlas=null,t._cardID=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.hide=function(){},t.prototype.setData=function(e){this._cardID=e,this.upSHow()},t.prototype.upSHow=function(){var e=o.default.instance.cardStageData.getAllPotentialByCardId(this._cardID),t=o.default.instance.GetMonsterData(this._cardID);if(t){var i=o.default.instance.cardStageData.getPotentialNum(this._cardID,t.level);this.richText.string=a.default.getStr("PotentialText",i,e.length);var n=null;for(var s in this.content.destroyAllChildren(),e){var l=o.default.instance.cardStageData.getPotentialDesc(parseInt(s)),c=cc.instantiate(this.prefabNode),d=a.default.getStr(""+e[s].needLv)+a.default.getStr("RoleLevel");d=" "+a.default.getStr("PotentialText2",d),c.getChildByName("titleNode").getChildByName("left").getChildByName("Label").getComponent(cc.Label).string=d,c.getChildByName("titleNode").getChildByName("left").getChildByName("icon").getComponent(cc.Sprite).spriteFrame=this.spriteAtlas.getSpriteFrame(l.icon),c.getChildByName("titleNode").getChildByName("left").getChildByName("name").getComponent(cc.Label).string=l.name,c.getChildByName("titleNode").getChildByName("Label").active=e[s].needLv>t.level,c.name="node"+s,this.content.addChild(c),e[s].needLv<=t.level?(c.getComponent(cc.Sprite).spriteFrame=r.default.instance.getSpriteFrameByName("base02"),n=c):c.getComponent(cc.Sprite).spriteFrame=r.default.instance.getSpriteFrameByName("base01");var p=l.desc,h=o.default.instance.cardStageData.getPotentialAttr(e[s].attr);for(var u in h)h[u]>0&&(p=a.default.getStr1(p,[h[u]]));c.getChildByName("descNode").getChildByName("ScrollView").getComponent(cc.ScrollView).content.getChildByName("RichText").getComponent(cc.RichText).string=p,c.active=!0}this.scrollView.scrollToTop(),n&&this.scrollView.scrollToOffset(cc.v2(0,Math.abs(n.position.y)))}},t.instance=null,__decorate([c(cc.RichText)],t.prototype,"richText",void 0),__decorate([c(cc.Node)],t.prototype,"content",void 0),__decorate([c(cc.ScrollView)],t.prototype,"scrollView",void 0),__decorate([c(cc.Node)],t.prototype,"prefabNode",void 0),__decorate([c(cc.SpriteAtlas)],t.prototype,"spriteAtlas",void 0),t=i=__decorate([l],t)}(n.default);i.default=d,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Language":"Language","../../Core/Window":"Window","../WarTeam/MonsterController":"MonsterController"}],PowerContr:[function(e,t,i){"use strict";cc._RF.push(t,"d6151xhqZNNbJC5wlWSF3d5","PowerContr"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=cc._decorator,a=o.ccclass,r=(o.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.energyList=[],t}var i;return __extends(t,e),i=t,t.prototype.listNotification=function(){i.instance=this,this.addProto("freeenergy",this.freeenergy,this)},t.prototype.freeenergy=function(e){this.energyList=e.data.states},t.instance=null,t=i=__decorate([a],t)}(n.default));i.default=r,cc._RF.pop()},{"../../Core/Controller":"Controller"}],PrefabCache:[function(e,t,i){"use strict";cc._RF.push(t,"70939HgOGdK9bxDAvVGyaaF","PrefabCache"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./Widget"),o=e("./CacheManager"),a=e("./CommonsResManager"),r=cc._decorator,s=r.ccclass,l=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.init=function(e){this._resUrl=e;for(var t=cc.loader.getDependsRecursively(this._resUrl),i=t.length-1;i>=0;i--){var n=t[i];a.default.instance.commonDependsDic[n]||o.default.instance.setDeopsRecord(n,this._resUrl)}},t.prototype.dispose=function(){if(this._resUrl&&""!=this._resUrl){o.default.instance.clearUseRecord(this._resUrl);for(var e=cc.loader.getDependsRecursively(this._resUrl),t=e.length-1;t>=0;t--){var i=e[t];a.default.instance.commonDependsDic[i]||o.default.instance.clearDeopsRecord(i,this._resUrl)}this._resUrl=null}},t=__decorate([s],t)}(n.default));i.default=l,cc._RF.pop()},{"./CacheManager":"CacheManager","./CommonsResManager":"CommonsResManager","./Widget":"Widget"}],PrivilegeCardConst:[function(e,t,i){"use strict";cc._RF.push(t,"1c2c5mGiQRLGppQLbyYXWKG","PrivilegeCardConst"),Object.defineProperty(i,"__esModule",{value:!0}),function(e){e[e.WeekCard=0]="WeekCard",e[e.MonthCard=1]="MonthCard"}(i.PrivilegeCardType||(i.PrivilegeCardType={})),cc._RF.pop()},{}],PrivilegeCardCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"2d181WQZhJGx7JF961gRFem","PrivilegeCardCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Controller"),o=e("../../../Core/ConfigsManager"),a=e("../../../NetConnect/NetConnet"),r=e("../../../Core/GameEventDispatcher"),s=e("../../../Core/Event"),l=e("../../Tips/OpTipsController"),c=e("../../../Core/Language"),d=e("../welfarelobby"),p=e("../../../Global/GlobalValue"),h=e("../welfarelobbyUtils"),u=e("../../../Core/WindowType"),f=e("./PrivilegeCardVo"),g=e("../../../Util/SDKUtils"),y=e("../../Commons/RewardUtils"),m=e("../../OpenWin/OpenWinController"),C=e("../../Tips/RewardTips"),v=cc._decorator,_=v.ccclass,b=(v.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.serData={},t.redState=!1,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this;var t,n=o.ConfigsManager.instance.getConfigs("PrivilegeCardConf").PrivilegeCardConf;for(var a in n)t=parseInt(a),this.serData[t]=new f.PrivilegeCardVo(n[a]);for(var a in n=o.ConfigsManager.instance.getConfigs("welfarelobbyconf").welfarelobby[1])if(n[a].prefabname==p.WelfareType.PrivilegeCard){this.windowId=n[a].windowid;break}},t.prototype.listNotification=function(){this.addProto("privilegecard",this.setSerData,this)},t.prototype.setSerData=function(e){var t,i=e.cards;for(var n in i)t=this.serData[i[n].type],this.isInit&&!t.flag&&i[n].today_flag&&this.rewardPanel(t.everyDayGet),this.isInit&&Math.abs(t.overDays-i[n].days)>2&&this.rewardPanel(t.diamond),t.setSerData(i[n]);this.isInit||(this.isInit=!0);var o=this.getReddot();r.GameEventDispatcher.instance.emit(s.EventDefiner.welfarePrivilegeCardUpdate),o!==this.redState&&(this.redState=o,h.welfarelobbyUtils.isOpenWindow()&&d.default.instance.IsRead(p.WelfareType.PrivilegeCard,o),h.welfarelobbyUtils.setRed())},t.prototype.rewardPanel=function(e){var t=y.default.instance.getItemListByServerData([{type:9,id:0,count:e}]);m.default.instance.openWindow(u.WindowType.RewardTips,function(){C.default.instance.setData(t)},this)},t.prototype.getReddot=function(){var e=!1;for(var t in this.serData)if(this.serData[t].overDays&&!this.serData[t].flag){e=!0;break}return e},t.prototype.buyPrivilegeCard=function(e){g.default.instance.rechargeByIndex(this.serData[e].rechargeid,function(e){e&&l.default.instance.ShowMsg(c.default.getStr("\u5145\u503c\u6210\u529f"))},this)},t.prototype.getDayDiamond=function(e){var t={cmd:"getdaydiamond",type:e};a.default.instance.sendProto(t)},t.instance=null,t=i=__decorate([_],t)}(n.default));i.default=b,cc._RF.pop()},{"../../../Core/ConfigsManager":"ConfigsManager","../../../Core/Controller":"Controller","../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Core/WindowType":"WindowType","../../../Global/GlobalValue":"GlobalValue","../../../NetConnect/NetConnet":"NetConnet","../../../Util/SDKUtils":"SDKUtils","../../Commons/RewardUtils":"RewardUtils","../../OpenWin/OpenWinController":"OpenWinController","../../Tips/OpTipsController":"OpTipsController","../../Tips/RewardTips":"RewardTips","../welfarelobby":"welfarelobby","../welfarelobbyUtils":"welfarelobbyUtils","./PrivilegeCardVo":"PrivilegeCardVo"}],PrivilegeCardVo:[function(e,t,i){"use strict";cc._RF.push(t,"22706BZFxNL1Z5qT81S3lGp","PrivilegeCardVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e){for(var t in e)this[t]=e[t];this.overDays=0,this.flag=!1}return e.prototype.setSerData=function(e){this.overDays=null!=e.days?e.days:this.overDays,this.flag=null!=e.today_flag?e.today_flag:this.flag},e}();i.PrivilegeCardVo=n,cc._RF.pop()},{}],PrivilegeCard:[function(e,t,i){"use strict";cc._RF.push(t,"fa8dethAhtFi6YJmzA66xYE","PrivilegeCard"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Language"),o=e("../../../Core/Widget"),a=e("../../Tips/OpTipsController"),r=e("../../../Core/GameEventDispatcher"),s=e("../../../Core/Event"),l=e("./PrivilegeCardCtrl"),c=e("../../Tips/TipsWinController"),d=cc._decorator,p=d.ccclass,h=d.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.nodes=null,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this),i.instance=this},t.prototype.show=function(){e.prototype.show.call(this),this.initData(),this.updateData(),r.GameEventDispatcher.instance.on(s.EventDefiner.welfarePrivilegeCardUpdate,this.updateData,this)},t.prototype.hide=function(){e.prototype.hide.call(this),r.GameEventDispatcher.instance.on(s.EventDefiner.welfarePrivilegeCardUpdate,this.updateData,this)},t.prototype.initData=function(){var e,t=l.default.instance.serData;for(var i in t)(e=this.nodes.getChildByName(i)).getChildByName("label").getComponent(cc.Label).string=t[i].diamond+"",e.getChildByName("getNum").getComponent(cc.Label).string=t[i].everyDayGet+"",cc.find("btn/receive/label",e).getComponent(cc.Label).string=n.default.getStr("6502")},t.prototype.updateData=function(){var e,t,i,o,a,r,s,c=l.default.instance.serData;for(var d in c)e=this.nodes.getChildByName(d),t=cc.find("btn/receive",e),i=cc.find("btn/buy",e),s=c[d],r=n.default.getStr("6502"),s.overDays?(t.active=!0,o=n.default.getStr("6517",s.overDays),a=n.default.getStr("6519"),t.getChildByName("flag").active=!s.flag):(t.active=s.flag,t.getChildByName("flag").active=!1,s.flag?(o=n.default.getStr("6523"),a=n.default.getStr("6519"),r=n.default.getStr("6524")):(o=n.default.getStr("6516",s.days),a=n.default.getStr("6518",s.recharge))),e.getChildByName("str").getComponent(cc.Label).string=o,i.getChildByName("label").getComponent(cc.Label).string=a,t.getChildByName("label").getComponent(cc.Label).string=r},t.prototype.onClickBuy=function(e,t){var i=parseInt(t);l.default.instance.buyPrivilegeCard(i)},t.prototype.onClickSend=function(e,t){var i=parseInt(t),o=l.default.instance.serData[i];if(o.flag)if(o.overDays)a.default.instance.ShowMsg(n.default.getStr("6520"));else{var r=n.default.getStr("652"+i);c.default.instance.ShowTips(n.default.getStr("6514",r),function(){l.default.instance.buyPrivilegeCard(i)},this)}else l.default.instance.getDayDiamond(i)},t.instance=null,__decorate([h(cc.Node)],t.prototype,"nodes",void 0),t=i=__decorate([p],t)}(o.default);i.default=u,cc._RF.pop()},{"../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Core/Widget":"Widget","../../Tips/OpTipsController":"OpTipsController","../../Tips/TipsWinController":"TipsWinController","./PrivilegeCardCtrl":"PrivilegeCardCtrl"}],ProBarTween:[function(e,t,i){"use strict";cc._RF.push(t,"4f3aa5usANJk4ZM0+J8Gnpk","ProBarTween"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(e){function t(t,i,n,o){var a=e.call(this)||this;return a.decTime=0,a._max=0,a._last=0,a._new=0,a.curHp=0,a.maxHp=0,a.grayDx=1,a._enableTween=!0,a._lossWithTime=!0,a.barBd=new cc.Sprite,a.barBd.spriteFrame.setTexture(t),a.barBd.node.width=o,a.node.addChild(a.barBd.node),a.higBarTexture=i,a.barGray=new cc.Sprite,a.barGray.spriteFrame.setTexture(n),a.barGray.node.width=o,a.node.addChild(a.barGray.node),a.barImg.spriteFrame.setTexture(i),a.barImg.node.width=o,a.node.addChild(a.barImg.node),a._last=a._max=o,a.rectGray=new cc.Rect(0,0,o,a.barGray.node.height),a.rect=new cc.Rect(0,0,o,a.barImg.node.height),a}return __extends(t,e),t.prototype.dispose=function(){this.barBd=null,this.barImg=null,this.barGray=null,this.rect=null,this.rectGray=null,this.higBarTexture=null,this.midBarTexture=null,this.lowBarTexture=null,e.prototype.dispose.call(this)},t.prototype.setMidAndLowTexture=function(e,t){this.midBarTexture=e,this.lowBarTexture=t},t.prototype.setEnableTween=function(e){this._enableTween=e},Object.defineProperty(t.prototype,"hpValue",{set:function(e){this.curHp=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxHpValue",{set:function(e){this.maxHp=e},enumerable:!0,configurable:!0}),t.prototype.decreaceHp=function(e){return this.updateHp(this.curHp-e)},t.prototype.updateHp=function(e){this.curHp=e,this.curHp<0&&(this.curHp=0);var t=this.curHp/this.maxHp;return this.value=t,this.curHp},t.prototype.reSetValue=function(e){this._last=this._max,this.value=e},Object.defineProperty(t.prototype,"value",{set:function(e){},enumerable:!0,configurable:!0}),t.prototype.update=function(e){},t.MAX_DEC_TIME=500,t}(e("../../../Core/Widget").default);i.ProBarTween=n,cc._RF.pop()},{"../../../Core/Widget":"Widget"}],QQSDK:[function(e,t,i){"use strict";cc._RF.push(t,"b56c0g8/jFB/Kwygp1g3YJc","QQSDK"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Role/RoleInfo"),o=e("../../Util/SDKUtils"),a=e("../../GlobalContext"),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.login=function(){e.prototype.login.call(this),this.loginBack()},t.prototype.exit=function(){e.prototype.exit.call(this),cc.game.end()},t.prototype.pay=function(t,i,a,r){void 0===i&&(i=null),void 0===a&&(a=null),void 0===r&&(r=null),e.prototype.pay.call(this,t,i,a,r),tdgamesdk&&tdgamesdk.mysdk.getDyb().submitOrder({goods_count:1,goods_identifier:t.item_id,goods_name:t.name,pay_amount:t.amt,extra_info:n.MyRoleInfo.id+"|"+n.MyRoleInfo.serverid+"|"+t.index,order_sn:t.orderid,redirect_uri:o.default.instance.BackstageUrl+"/"+o.default.instance.plat_id+"-"+o.default.instance.ditch_id+"/payment/index/"},function(e){console.log("\u8c03\u7528\u5145\u503c\u63a5\u53e3\u8fd4\u56de",e)})},t.prototype.createRole=function(){if(e.prototype.createRole.call(this),tdgamesdk){var t={role_id:n.MyRoleInfo.id,create_time:Date.now(),type:1,nickname:n.MyRoleInfo.name,server_id:n.MyRoleInfo.serverid,server_name:a.GlobalContext.currentServerData.server_name};tdgamesdk.mysdk.getDyb().roleData(t,function(e){console.log("\u624bq\u4e0a\u62a5\u521b\u89d2\u6210\u529f",e)})}},t.prototype.notifyroleInfo=function(){if(e.prototype.notifyroleInfo.call(this),tdgamesdk){var t={role_id:n.MyRoleInfo.id,create_time:Date.now(),nickname:n.MyRoleInfo.name,server_id:n.MyRoleInfo.serverid,server_name:a.GlobalContext.currentServerData.server_name};tdgamesdk.mysdk.getDyb().uploginData(t,function(e){console.log("\u624bq\u4e0a\u62a5\u89d2\u8272\u767b\u5f55",e)})}},t.prototype.onlineTime=function(t){if(e.prototype.onlineTime.call(this,t),tdgamesdk){var i={timing:t};tdgamesdk.mysdk.getDyb().timing(i,function(e){console.log("\u624bq\u4e0a\u62a5\u5728\u7ebf\u65f6\u957f",e)})}},t}(e("./GameBaseSDK").GameBaseSDK);i.QQSDK=r,cc._RF.pop()},{"../../GlobalContext":"GlobalContext","../../Util/SDKUtils":"SDKUtils","../Role/RoleInfo":"RoleInfo","./GameBaseSDK":"GameBaseSDK"}],RangeNode:[function(e,t,i){"use strict";cc._RF.push(t,"be321AHXqVG36tMMIzTRQrC","RangeNode"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=cc._decorator,a=o.ccclass,r=o.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.typeList=[],t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.hide=function(){e.prototype.hide.call(this)},t.prototype.initEventNode=function(e){this.node.getChildByName("sprType").getComponent(cc.Sprite).spriteFrame=this.typeList[e-1]},__decorate([r([cc.SpriteFrame])],t.prototype,"typeList",void 0),t=__decorate([a],t)}(n.default);i.default=s,cc._RF.pop()},{"../../Core/Widget":"Widget"}],RankDataOne:[function(e,t,i){"use strict";cc._RF.push(t,"cf55bFo00pPt6VzT2w8T7gA","RankDataOne"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("./RankItmeOne"),a=e("./RankListCtrl"),r=e("../Commons/ListViewCtrl"),s=cc._decorator,l=s.ccclass,c=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollView=null,t.listViewNode=null,t}return __extends(t,e),t.prototype.show=function(){var e=a.default.instance.data.getLevelRankdData();this.listViewNode.getComponent(r.default).refreshItem=this.updateitem,this.listViewNode.getComponent(r.default).refreshItemThis=this,this.listViewNode.getComponent(r.default).initialize(e),this.listViewNode.getComponent(r.default).scrollToTop()},t.prototype.updateitem=function(e,t){var i=this.listViewNode.getComponent(r.default).dataLsit[t];e.getComponent(o.default).setData(i)},__decorate([c(cc.ScrollView)],t.prototype,"scrollView",void 0),__decorate([c(cc.Node)],t.prototype,"listViewNode",void 0),t=__decorate([l],t)}(n.default);i.default=d,cc._RF.pop()},{"../../Core/Widget":"Widget","../Commons/ListViewCtrl":"ListViewCtrl","./RankItmeOne":"RankItmeOne","./RankListCtrl":"RankListCtrl"}],RankDataThree:[function(e,t,i){"use strict";cc._RF.push(t,"aae72bTquNAELvBm/9P8XwG","RankDataThree"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("./RankItemThree"),a=e("../Commons/ListViewCtrl"),r=e("./RankListCtrl"),s=e("../../Core/GameEventDispatcher"),l=e("../../Core/Event"),c=cc._decorator,d=c.ccclass,p=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollView=null,t.listViewNode=null,t.btnListNode=null,t}return __extends(t,e),t.prototype.show=function(){this.onClickBtn(null)},t.prototype.setData=function(e){var t=r.default.instance.data,i=e?t.getMyArenaLastRankData():t.getMyArenaThisRankdData();this.listViewNode.getComponent(a.default).refreshItem=this.updateitem,this.listViewNode.getComponent(a.default).refreshItemThis=this,this.listViewNode.getComponent(a.default).initialize(i),this.listViewNode.getComponent(a.default).scrollToTop()},t.prototype.updateitem=function(e,t){var i=this.listViewNode.getComponent(a.default).dataLsit[t];e.getComponent(o.default).setData(i)},t.prototype.onClickBtn=function(e){var t=0;e&&e.type==cc.Node.EventType.TOUCH_END&&(t=e.currentTarget.getSiblingIndex());for(var i in this.btnListNode.children)this.btnListNode.children[i].getChildByName("img2").active=parseInt(i)==t;r.default.instance.data.arenaIndex=t,s.GameEventDispatcher.instance.emit(l.EventDefiner.RankList_up_model),this.setData(t)},__decorate([p(cc.ScrollView)],t.prototype,"scrollView",void 0),__decorate([p(cc.Node)],t.prototype,"listViewNode",void 0),__decorate([p(cc.Node)],t.prototype,"btnListNode",void 0),t=__decorate([d],t)}(n.default);i.default=h,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Widget":"Widget","../Commons/ListViewCtrl":"ListViewCtrl","./RankItemThree":"RankItemThree","./RankListCtrl":"RankListCtrl"}],RankDataTwo:[function(e,t,i){"use strict";cc._RF.push(t,"a38b9TXcF5P+IF8JMfFzL7W","RankDataTwo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("./RankItemTwo"),a=e("./RankListCtrl"),r=e("../Commons/ListViewCtrl"),s=e("../../Global/GlobalValue"),l=cc._decorator,c=l.ccclass,d=l.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollView=null,t.listViewNode=null,t}return __extends(t,e),t.prototype.show=function(){var e=a.default.instance.data,t=e.rankType==s.RankType.FIGHT?e.getFightRankData():e.getHightLadderRankData();this.listViewNode.getComponent(r.default).refreshItem=this.updateitem,this.listViewNode.getComponent(r.default).refreshItemThis=this,this.listViewNode.getComponent(r.default).initialize(t),this.listViewNode.getComponent(r.default).scrollToTop()},t.prototype.updateitem=function(e,t){var i=this.listViewNode.getComponent(r.default).dataLsit[t];e.getComponent(o.default).setData(i)},__decorate([d(cc.ScrollView)],t.prototype,"scrollView",void 0),__decorate([d(cc.Node)],t.prototype,"listViewNode",void 0),t=__decorate([c],t)}(n.default);i.default=p,cc._RF.pop()},{"../../Core/Widget":"Widget","../../Global/GlobalValue":"GlobalValue","../Commons/ListViewCtrl":"ListViewCtrl","./RankItemTwo":"RankItemTwo","./RankListCtrl":"RankListCtrl"}],RankItemThree:[function(e,t,i){"use strict";cc._RF.push(t,"99bdbexKaBJtorWG+upfLjf","RankItemThree"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../Gamelayer/RoleHead"),a=e("../Arena/ArenaController"),r=e("../../Core/Language"),s=e("../PartnerPanel/FriendUtils"),l=cc._decorator,c=l.ccclass,d=l.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.portraitImage=null,t.rankImage=null,t.rank=null,t.playerName=null,t.vipLev=null,t.levelImg=null,t.levStr=null,t.Imgs=[],t.levImgs=[],t._playerId=null,t}return __extends(t,e),t.prototype.setData=function(e){this._playerId=e.id,this.portraitImage.SetHead(e.icon);var t=e.rankNum>=4?4:e.rankNum;this.rankImage.spriteFrame=this.Imgs[t-1],this.rank.string=e.rankNum.toString(),this.playerName.string=e.playerName,this.vipLev.string=e.vipLevel.toString(),this.levelImg.spriteFrame=this.levImgs[Math.floor((25-e.grade)/5)],this.levStr.string=a.default.instance.arenaConfigs.level[e.grade].gradeName+r.default.getStr("arenastart",e.star)},t.prototype.onClickFriend=function(){this._playerId&&s.FriendUtils.onClickFriend(this._playerId)},__decorate([d(o.default)],t.prototype,"portraitImage",void 0),__decorate([d(cc.Sprite)],t.prototype,"rankImage",void 0),__decorate([d(cc.Label)],t.prototype,"rank",void 0),__decorate([d(cc.Label)],t.prototype,"playerName",void 0),__decorate([d(cc.Label)],t.prototype,"vipLev",void 0),__decorate([d(cc.Sprite)],t.prototype,"levelImg",void 0),__decorate([d(cc.Label)],t.prototype,"levStr",void 0),__decorate([d([cc.SpriteFrame])],t.prototype,"Imgs",void 0),__decorate([d([cc.SpriteFrame])],t.prototype,"levImgs",void 0),t=__decorate([c],t)}(n.default);i.default=p,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/Widget":"Widget","../Arena/ArenaController":"ArenaController","../Gamelayer/RoleHead":"RoleHead","../PartnerPanel/FriendUtils":"FriendUtils"}],RankItemTwo:[function(e,t,i){"use strict";cc._RF.push(t,"e0931HMx7RAJ4W+Aw5EZxzp","RankItemTwo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../Gamelayer/RoleHead"),a=e("../../Util/NumberUtil"),r=e("../PartnerPanel/FriendUtils"),s=cc._decorator,l=s.ccclass,c=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.portraitImage=null,t.rankImage=null,t.rank=null,t.playerName=null,t.vipLev=null,t.fightVal=null,t.Imgs=[],t._playerId=null,t}return __extends(t,e),t.prototype.setData=function(e){this._playerId=e.id,this.portraitImage.SetHead(e.icon);var t=e.rankNum>=4?4:e.rankNum;this.rankImage.spriteFrame=this.Imgs[t-1],this.rank.string=e.rankNum.toString(),this.playerName.string=e.playerName,this.vipLev.string=e.vipLevel.toString();var i=e.fight>1e4;this.fightVal.string=i?a.NumberUtil.getNumberW(e.fight):e.fight.toString(),this.fightVal.node.parent.children[2].active=i},t.prototype.onClickFriend=function(){this._playerId&&r.FriendUtils.onClickFriend(this._playerId)},__decorate([c(o.default)],t.prototype,"portraitImage",void 0),__decorate([c(cc.Sprite)],t.prototype,"rankImage",void 0),__decorate([c(cc.Label)],t.prototype,"rank",void 0),__decorate([c(cc.Label)],t.prototype,"playerName",void 0),__decorate([c(cc.Label)],t.prototype,"vipLev",void 0),__decorate([c(cc.Label)],t.prototype,"fightVal",void 0),__decorate([c([cc.SpriteFrame])],t.prototype,"Imgs",void 0),t=__decorate([l],t)}(n.default);i.default=d,cc._RF.pop()},{"../../Core/Widget":"Widget","../../Util/NumberUtil":"NumberUtil","../Gamelayer/RoleHead":"RoleHead","../PartnerPanel/FriendUtils":"FriendUtils"}],RankItmeOne:[function(e,t,i){"use strict";cc._RF.push(t,"2e02d8tsedIaI+hWGz2TzHm","RankItmeOne"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../Gamelayer/RoleHead"),a=e("../PartnerPanel/FriendUtils"),r=cc._decorator,s=r.ccclass,l=r.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.portraitImage=null,t.rankImage=null,t.rank=null,t.playerName=null,t.vipLev=null,t.playerLev=null,t.Imgs=[],t._playerId=null,t}return __extends(t,e),t.prototype.setData=function(e){this._playerId=e.id,this.portraitImage.SetHead(e.icon);var t=e.rankNum>=4?4:e.rankNum;this.rankImage.spriteFrame=this.Imgs[t-1],this.rank.string=e.rankNum.toString(),this.playerName.string=e.playerName,this.vipLev.string=e.vipLevel.toString(),this.playerLev.string=e.playerLevel.toString()},t.prototype.onClickFriend=function(){this._playerId&&a.FriendUtils.onClickFriend(this._playerId)},__decorate([l(o.default)],t.prototype,"portraitImage",void 0),__decorate([l(cc.Sprite)],t.prototype,"rankImage",void 0),__decorate([l(cc.Label)],t.prototype,"rank",void 0),__decorate([l(cc.Label)],t.prototype,"playerName",void 0),__decorate([l(cc.Label)],t.prototype,"vipLev",void 0),__decorate([l(cc.Label)],t.prototype,"playerLev",void 0),__decorate([l([cc.SpriteFrame])],t.prototype,"Imgs",void 0),t=__decorate([s],t)}(n.default);i.default=c,cc._RF.pop()},{"../../Core/Widget":"Widget","../Gamelayer/RoleHead":"RoleHead","../PartnerPanel/FriendUtils":"FriendUtils"}],RankListCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"a3babuDXERM0pEM/IE463Qe","RankListCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("./RankListData"),a=e("../../NetConnect/NetConnet"),r=e("./RankingConst"),s=e("../../Global/GlobalValue"),l=e("../../Core/GameEventDispatcher"),c=e("../../Core/Event"),d=e("./RankListView"),p=e("../../Core/WindowType"),h=e("../OpenWin/OpenWinController"),u=cc._decorator,f=u.ccclass,g=(u.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._data=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},Object.defineProperty(t.prototype,"data",{get:function(){return this._data||(this._data=new o.default),this._data},enumerable:!0,configurable:!0}),t.prototype.openRankList=function(e){void 0===e&&(e=s.RankType.LEVEL),h.default.instance.openWindow(p.WindowType.RankList,function(t){t.getComponent(d.default).setSelectedBtn(e)},this)},t.prototype.reqRankData=function(e){var t={cmd:"rankdata",type:e};a.default.instance.sendProto(t)},t.prototype.reqRankListData=function(e){switch(e){case s.RankType.LEVEL:this.reqLevelrank();break;case s.RankType.FIGHT:this.reqFightRank();break;case s.RankType.TIAN_TI:this.reqHightLadderRank();break;case s.RankType.ARENA:this.reqArenaRank()}},t.prototype.reqLevelrank=function(){this.reqRankData(r.RankingType.Grade)},t.prototype.reqFightRank=function(){this.reqRankData(r.RankingType.Combat)},t.prototype.reqHightLadderRank=function(){this.reqRankData(r.RankingType.HightLadder)},t.prototype.reqArenaRank=function(){this.reqRankData(r.RankingType.MyArenaThis),this.reqRankData(r.RankingType.MyArenaLast)},t.prototype.resRankData=function(e){this.data.setRankData(e),l.GameEventDispatcher.instance.emit(c.EventDefiner.RankList_up_show)},t.prototype.resSelfRank=function(e){this.data.setSelfRankData(e),l.GameEventDispatcher.instance.emit(c.EventDefiner.RankList_up_show)},t.instance=null,t=i=__decorate([f],t)}(n.default));i.default=g,cc._RF.pop()},{"../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../NetConnect/NetConnet":"NetConnet","../OpenWin/OpenWinController":"OpenWinController","./RankListData":"RankListData","./RankListView":"RankListView","./RankingConst":"RankingConst"}],RankListData:[function(e,t,i){"use strict";cc._RF.push(t,"5d3c9L215ZN27/ie1NPDq3e","RankListData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./RankingConst"),o=e("../../Global/GlobalValue"),a=e("../../Core/ConfigsManager"),r=e("../Commons/RewardUtils"),s=e("../Arena/ArenaController"),l=e("../../Core/Language"),c=function(){function e(){this._rankType=o.RankType.LEVEL,this._arenaIndex=0,this._levelRankdData=[],this._fightRankData=[],this._hightLadderRankData=[],this._MyArenaThisRankdData=[],this._MyArenaLastRankData=[],this._myRankData=new Map,this._hightLadderReward={}}return e.prototype.resetData=function(){this._rankType=o.RankType.LEVEL,this._arenaIndex=0,this._levelRankdData=[],this._fightRankData=[],this._hightLadderRankData=[],this._MyArenaThisRankdData=[],this._MyArenaLastRankData=[],this._myRankData=new Map,this._hightLadderReward={}},Object.defineProperty(e.prototype,"rankType",{get:function(){return this._rankType},set:function(e){this._rankType=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showViewID",{get:function(){var e=null;switch(this._rankType){case o.RankType.LEVEL:e=0;break;case o.RankType.ARENA:e=2;break;default:e=1}return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"arenaIndex",{set:function(e){this._arenaIndex=e},enumerable:!0,configurable:!0}),e.prototype.setRankData=function(e){switch(e.type){case n.RankingType.Grade:this.setLevelRankdData(e);break;case n.RankingType.Combat:this.setFightRankData(e);break;case n.RankingType.MyArenaThis:this.setMyArenaThisRankdData(e);break;case n.RankingType.MyArenaLast:this.setMyArenaLastRankData(e);break;case n.RankingType.HightLadder:this.setHightLadderRankData(e)}},e.prototype.setSelfRankData=function(e){var t=l.default.getStr("\u672a\u4e0a\u6bb5");switch(e.type){case n.RankingType.Grade:this._myRankData.set(n.RankingType.Grade,{rank:e.rank,val:e.info?e.info.level:""});break;case n.RankingType.Combat:this._myRankData.set(n.RankingType.Combat,{rank:e.rank,val:e.fight});break;case n.RankingType.MyArenaThis:e.info&&(t=s.default.instance.arenaConfigs.level[e.info.grade].gradeName+l.default.getStr("arenastart",e.info.star)),this._myRankData.set(n.RankingType.MyArenaThis,{rank:e.rank,val:t});break;case n.RankingType.MyArenaLast:e.info&&(t=s.default.instance.arenaConfigs.level[e.info.grade].gradeName+l.default.getStr("arenastart",e.info.star)),this._myRankData.set(n.RankingType.MyArenaLast,{rank:e.rank,val:t});break;case n.RankingType.HightLadder:this._myRankData.set(n.RankingType.HightLadder,{rank:e.rank,val:e.info?e.info.fight:"\u672a\u53c2\u6218"})}},e.prototype.getSelfRankData=function(){var e=null;switch(this.rankType){case o.RankType.LEVEL:e=this._myRankData.get(n.RankingType.Grade);break;case o.RankType.FIGHT:e=this._myRankData.get(n.RankingType.Combat);break;case o.RankType.TIAN_TI:e=this._myRankData.get(n.RankingType.HightLadder);break;case o.RankType.ARENA:e=this._arenaIndex?this._myRankData.get(n.RankingType.MyArenaLast):this._myRankData.get(n.RankingType.MyArenaThis)}return e},e.prototype.getLevelRankdData=function(){return this._levelRankdData},e.prototype.getFightRankData=function(){return this._fightRankData},e.prototype.getHightLadderRankData=function(){return this._hightLadderRankData},e.prototype.getMyArenaThisRankdData=function(){return this._MyArenaThisRankdData},e.prototype.getMyArenaLastRankData=function(){return this._MyArenaLastRankData},e.prototype.getModelData=function(){var e=[];switch(this._rankType){case o.RankType.LEVEL:e=this.getLevelRankdData();break;case o.RankType.FIGHT:e=this.getFightRankData();break;case o.RankType.TIAN_TI:e=this.getHightLadderRankData();break;case o.RankType.ARENA:e=this._arenaIndex?this.getMyArenaLastRankData():this.getMyArenaThisRankdData()}return e},e.prototype.getRankRewardData=function(){var e={};switch(this._rankType){case o.RankType.TIAN_TI:e=this.getHightLadderReward()}return e},e.prototype.setLevelRankdData=function(e){this.setData(this._levelRankdData,e.data)},e.prototype.setFightRankData=function(e){this.setData(this._fightRankData,e.data)},e.prototype.setHightLadderRankData=function(e){this.setData(this._hightLadderRankData,e.data)},e.prototype.setMyArenaThisRankdData=function(e){this.setData(this._MyArenaThisRankdData,e.data)},e.prototype.setMyArenaLastRankData=function(e){this.setData(this._MyArenaLastRankData,e.data)},e.prototype.setData=function(e,t){for(var i in t){e[i]||(e[i]=new d);var n=t[i].info;e[i].id=t[i]._id,e[i].gender=n.gender,e[i].rankNum=parseInt(i)+1,e[i].vipLevel=n.viplv,e[i].model=n.model,e[i].playerLevel=n.level,n.icon&&(e[i].icon=n.icon),n.name&&(e[i].playerName=n.name),n.fight&&(e[i].fight=n.fight),e[i].grade=n.grade,e[i].star=n.star,e[i].srvid=n.srvid}},e.prototype.getHightLadderReward=function(){if(Object.keys(this._hightLadderReward).length<=0){var e=a.ConfigsManager.instance.getConfigs("highladderconf").Ranking[1];for(var t in e){var i=parseInt(e[t].minRank),n=parseInt(e[t].rank),o=i==n?i+"":i+"~"+n;this._hightLadderReward[parseInt(t)]={rankNum:parseInt(t)+1,title:o,rewardData:r.default.instance.getItemList(e[t].reward)}}}return this._hightLadderReward},e}();i.default=c;var d=function(){return function(){this.id=null,this.rankNum=null,this.icon=null,this.vipLevel=null,this.playerName=null,this.playerLevel=null,this.gender=null,this.model=null,this.grade=null,this.star=null,this.srvid=null,this.fight=null}}();i.RankData=d,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Language":"Language","../../Global/GlobalValue":"GlobalValue","../Arena/ArenaController":"ArenaController","../Commons/RewardUtils":"RewardUtils","./RankingConst":"RankingConst"}],RankListView:[function(e,t,i){"use strict";cc._RF.push(t,"5c2f51XZGFHOY46Do98Oabu","RankListView"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../../Global/GlobalValue"),a=e("../../GlobalContext"),r=e("../../Util/Utils"),s=e("../../Core/LoadManager"),l=e("./RankTypeBtn"),c=e("./RankListCtrl"),d=e("../../Core/GameEventDispatcher"),p=e("../../Core/Event"),h=e("../../Core/Language"),u=e("./RankPlayerInfo"),f=e("../Commons/WindowOpenUtils"),g=e("../../Core/WindowType"),y=cc._decorator,m=y.ccclass,C=y.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Content=null,t.btnListNode=null,t.rewardBtnNode=null,t.rankListDataNode=null,t.rankDataView=null,t.rankDataBtn=null,t.myRank=null,t.str=null,t.activeValue=null,t.modelDisplay=null,t._showViewID=null,t._viewNodeMap={},t._PrefabUrl=["prefab/RankingList/RankData_One","prefab/RankingList/RankData_Two","prefab/RankingList/RankData_Three"],t}return __extends(t,e),t.prototype.onLoad=function(){this.onInit(g.WindowType.RankList,!1),e.prototype.onLoad.call(this)},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this),this.node.getChildByName("node").width=a.GlobalContext.StageWidth,this.node.getChildByName("node").height=a.GlobalContext.StageHeight,this.modelDisplay.node.width=a.GlobalContext.StageWidth,this.modelDisplay.node.getChildByName("view").width=a.GlobalContext.StageWidth,this.initRankTypeBtn(),d.GameEventDispatcher.instance.on(p.EventDefiner.RankList_up_show,this.upSHow,this),d.GameEventDispatcher.instance.on(p.EventDefiner.RankList_up_model,this.upModel,this)},t.prototype.hide=function(){e.prototype.hide.call(this),d.GameEventDispatcher.instance.off(p.EventDefiner.RankList_up_show,this.upSHow,this),d.GameEventDispatcher.instance.off(p.EventDefiner.RankList_up_model,this.upModel,this),this._showViewID=null,this._viewNodeMap={};var t=[];for(var i in this.rankListDataNode.children)t.push(this.rankListDataNode.children[i]);for(var i in this.rankListDataNode.removeAllChildren(),t)t[i].destroy(),t[i]=null;t=null,c.default.instance.data.resetData()},t.prototype.setSelectedBtn=function(e){for(var t in void 0===e&&(e=o.RankType.LEVEL),this.btnListNode.children)this.btnListNode.children[t].getComponent(l.default).setSelectedFlag(parseInt(t)==e);this.onClickRankTypeBtn(e)},t.prototype.initRankTypeBtn=function(){var e=this;s.default.instance.loadResByType(a.GlobalContext.Root+"prefab/RankingList/RankTypeBtn",cc.Prefab,function(t){for(var i in r.default.setNodeChildDestoryByUrl(e.btnListNode,a.GlobalContext.Root+"prefab/RankingList/RankTypeBtn"),o.RankType){if(isNaN(i)){var n=o.RankType[i],s=r.default.getNodeByUrl(t,a.GlobalContext.Root+"prefab/RankingList/RankTypeBtn");s.getComponent(l.default).steType(Number(n),e.onClickRankTypeBtn,e),e.btnListNode.addChild(s)}}e.setSelectedBtn()},this)},t.prototype.setRewardBtnShow=function(){this.rewardBtnNode.active=c.default.instance.data.rankType==o.RankType.TIAN_TI},t.prototype.setRankListDataShow=function(e){var t=this;this._viewNodeMap[this._showViewID]&&(this._viewNodeMap[this._showViewID].active=!1),this._viewNodeMap[e]||s.default.instance.loadResByType(this._PrefabUrl[e],cc.Prefab,function(i){if(!t._viewNodeMap[e]){var n=r.default.getNodeByUrl(i,t._PrefabUrl[t._showViewID]);t.rankListDataNode.addChild(n),t._viewNodeMap[e]=n,t._showViewID||(t._showViewID=e);var o=t._showViewID==e;t._viewNodeMap[t._showViewID].active=o}},this),this._showViewID=e,this._viewNodeMap[this._showViewID]&&(this._viewNodeMap[this._showViewID].active=!0)},t.prototype.setModel=function(){var e=this,t=c.default.instance.data.getModelData();s.default.instance.loadResByType(a.GlobalContext.Root+"prefab/RankingList/RankPlayerInfo",cc.Prefab,function(i){r.default.setNodeChildDestoryByUrl(e.modelDisplay.content,a.GlobalContext.Root+"prefab/RankingList/RankPlayerInfo");for(var n=0;n<10;++n){var o=r.default.getNodeByUrl(i,a.GlobalContext.Root+"prefab/RankingList/RankPlayerInfo");o.getComponent(u.default).setData(t[n],n+1),e.modelDisplay.content.addChild(o)}e.modelDisplay.scrollToRight()},this)},t.prototype.myRankData=function(){var e=c.default.instance.data.getSelfRankData();e&&(this.myRank.string=e.rank?""+e.rank:h.default.getStr("\u672a\u4e0a\u699c"),this.str.string=h.default.getStr("rankList_"+c.default.instance.data.rankType),this.activeValue.string=e.val+"")},t.prototype.openRankReward=function(){f.default.instance.openWindowType(g.WindowType.RankListReward)},t.prototype.onClickRankTypeBtn=function(e){c.default.instance.data.rankType=e,c.default.instance.reqRankListData(e)},t.prototype.upSHow=function(){this.setRankListDataShow(c.default.instance.data.showViewID),this.setRewardBtnShow(),this.myRankData(),this.setModel()},t.prototype.upModel=function(){this.setModel(),this.myRankData()},t.prototype.rankDataeffect=function(){var e=this,t=this.rankDataBtn.children[0].active,i=t?-600:600;this.rankDataView.stopAllActions();var n=cc.moveBy(1,cc.v2(i,0)),o=cc.callFunc(function(){e.rankDataBtn.children[0].active=!t,e.rankDataBtn.children[1].active=t}),a=cc.sequence([n,o]);this.rankDataView.runAction(a)},__decorate([C(cc.Node)],t.prototype,"Content",void 0),__decorate([C(cc.Node)],t.prototype,"btnListNode",void 0),__decorate([C(cc.Node)],t.prototype,"rewardBtnNode",void 0),__decorate([C(cc.Node)],t.prototype,"rankListDataNode",void 0),__decorate([C(cc.Node)],t.prototype,"rankDataView",void 0),__decorate([C(cc.Node)],t.prototype,"rankDataBtn",void 0),__decorate([C(cc.Label)],t.prototype,"myRank",void 0),__decorate([C(cc.Label)],t.prototype,"str",void 0),__decorate([C(cc.Label)],t.prototype,"activeValue",void 0),__decorate([C(cc.ScrollView)],t.prototype,"modelDisplay",void 0),t=__decorate([m],t)}(n.default);i.default=v,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/Window":"Window","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/WindowOpenUtils":"WindowOpenUtils","./RankListCtrl":"RankListCtrl","./RankPlayerInfo":"RankPlayerInfo","./RankTypeBtn":"RankTypeBtn"}],RankPlayerInfo:[function(e,t,i){"use strict";cc._RF.push(t,"70e63RatyZKQKI1RWPLD2d6","RankPlayerInfo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../Commons/MonsterPreview"),a=e("../../Global/GlobalValue"),r=e("./RankListCtrl"),s=e("../../Core/Language"),l=e("../Arena/ArenaController"),c=e("../../Util/NumberUtil"),d=e("../PartnerPanel/FriendUtils"),p=cc._decorator,h=p.ccclass,u=p.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Bg=null,t.rankImg=null,t.rankNum=null,t.playerName=null,t.model=null,t.UpNode=null,t.rankDataNode=null,t.highAtlas=null,t.rankAtlas=null,t.levelImg=[],t._playerId=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.hide=function(){e.prototype.hide.call(this),this._playerId=null},t.prototype.setData=function(e,t){switch(this.UpNode.active=!!e,this.Bg.spriteFrame=this.rankAtlas.getSpriteFrame("bg_tianti5"),e?e.rankNum:t){case 1:this.Bg.spriteFrame=this.rankAtlas.getSpriteFrame("bg_tianti2"),this.rankImg.spriteFrame=this.highAtlas.getSpriteFrame("bg_tianti6"),this.UpNode.y=315;break;case 2:this.Bg.spriteFrame=this.rankAtlas.getSpriteFrame("bg_tianti3"),this.rankImg.spriteFrame=this.highAtlas.getSpriteFrame("bg_tianti7"),this.UpNode.y=275;break;case 3:this.Bg.spriteFrame=this.rankAtlas.getSpriteFrame("bg_tianti4"),this.rankImg.spriteFrame=this.highAtlas.getSpriteFrame("bg_tianti8"),this.UpNode.y=240}e&&(this._playerId=e.id,this.rankImg.spriteFrame=this.highAtlas.getSpriteFrame("bg_tianti12"),this.rankNum.string=e.rankNum.toString(),this.playerName.string=e.playerName,this.model.getComponent(o.default).init("role",e.model,1,a.DEFAULTS_SKIN+1,a.PRIORITY.MONSTER),this.setRankData(e))},t.prototype.setRankData=function(e){var t=r.default.instance.data.showViewID;for(var i in this.rankDataNode.children)if(parseInt(i)==t){var n=this.rankDataNode.children[i];switch(t){case 0:n.getChildByName("Label").getComponent(cc.Label).string=e.playerLevel.toString();break;case 1:var o=n.getChildByName("Fight"),a=e.fight>1e4;o.getChildByName("Number").getComponent(cc.Label).string=a?c.NumberUtil.getNumberW(e.fight):e.fight.toString(),o.getChildByName("img1").active=a;break;case 2:n.getChildByName("img").getComponent(cc.Sprite).spriteFrame=this.levelImg[Math.floor((25-e.grade)/5)];var d=l.default.instance.arenaConfigs.level[e.grade].gradeName+s.default.getStr("arenastart",e.star);n.getChildByName("Label").getComponent(cc.Label).string=d}this.rankDataNode.children[i].active=!0}else this.rankDataNode.children[i].active=!1},t.prototype.onClickModel=function(){this._playerId&&d.FriendUtils.onClickFriend(this._playerId)},__decorate([u(cc.Sprite)],t.prototype,"Bg",void 0),__decorate([u(cc.Sprite)],t.prototype,"rankImg",void 0),__decorate([u(cc.Label)],t.prototype,"rankNum",void 0),__decorate([u(cc.Label)],t.prototype,"playerName",void 0),__decorate([u(cc.Node)],t.prototype,"model",void 0),__decorate([u(cc.Node)],t.prototype,"UpNode",void 0),__decorate([u(cc.Node)],t.prototype,"rankDataNode",void 0),__decorate([u(cc.SpriteAtlas)],t.prototype,"highAtlas",void 0),__decorate([u(cc.SpriteAtlas)],t.prototype,"rankAtlas",void 0),__decorate([u([cc.SpriteFrame])],t.prototype,"levelImg",void 0),t=__decorate([h],t)}(n.default);i.default=f,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/Widget":"Widget","../../Global/GlobalValue":"GlobalValue","../../Util/NumberUtil":"NumberUtil","../Arena/ArenaController":"ArenaController","../Commons/MonsterPreview":"MonsterPreview","../PartnerPanel/FriendUtils":"FriendUtils","./RankListCtrl":"RankListCtrl"}],RankRewardItem:[function(e,t,i){"use strict";cc._RF.push(t,"a97f7czKfdPN7MjglhIyXUd","RankRewardItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Util/Utils"),a=e("../../GlobalContext"),r=e("../../Core/LoadManager"),s=e("../../Core/WindowType"),l=e("../Item/ItemIcon"),c=cc._decorator,d=c.ccclass,p=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rankImage=null,t.rank=null,t.itemListNode=null,t.title=null,t.Imgs=[],t}return __extends(t,e),t.prototype.setData=function(e){var t=this;e.rankNum<=3&&(this.rankImage.spriteFrame=this.Imgs[e.rankNum-1],this.rank.string=e.title),this.rankImage.node.active=e.rankNum<=3,this.title.string=e.title,this.title.node.active=!this.rankImage.node.active,o.default.setNodeChildDestoryByUrl(this.itemListNode,a.GlobalContext.Root+"prefab/Bag/ItemIcon"),r.default.instance.loadResByType(a.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(i){for(var n in e.rewardData){var r=o.default.getNodeByPool(s.PoolType.ItemIcon,i,a.GlobalContext.Root+"prefab/Bag/ItemIcon");r.getComponent(l.default).ItemData(e.rewardData[n],!0,null,!0),r.scale=.75,t.itemListNode.addChild(r)}},this)},__decorate([p(cc.Sprite)],t.prototype,"rankImage",void 0),__decorate([p(cc.Label)],t.prototype,"rank",void 0),__decorate([p(cc.Node)],t.prototype,"itemListNode",void 0),__decorate([p(cc.Label)],t.prototype,"title",void 0),__decorate([p([cc.SpriteFrame])],t.prototype,"Imgs",void 0),t=__decorate([d],t)}(n.default);i.default=h,cc._RF.pop()},{"../../Core/LoadManager":"LoadManager","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Item/ItemIcon":"ItemIcon"}],RankRewardView:[function(e,t,i){"use strict";cc._RF.push(t,"45692k237BDHJNNcAvX3boX","RankRewardView"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../GlobalContext"),o=e("../../Util/Utils"),a=e("../../Core/LoadManager"),r=e("./RankRewardItem"),s=e("./RankListCtrl"),l=e("../../Core/Window"),c=e("../../Core/Language"),d=cc._decorator,p=d.ccclass,h=d.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollView=null,t.richText=null,t}return __extends(t,e),t.prototype.show=function(){var e=this,t=s.default.instance.data.getRankRewardData();o.default.setNodeChildDestoryByUrl(this.scrollView.content,n.GlobalContext.Root+"prefab/RankingList/RankRewardItem"),a.default.instance.loadResByType(n.GlobalContext.Root+"prefab/RankingList/RankRewardItem",cc.Prefab,function(i){for(var a in t){var s=o.default.getNodeByUrl(i,n.GlobalContext.Root+"prefab/RankingList/RankRewardItem");s.getComponent(r.default).setData(t[a]),e.scrollView.content.addChild(s)}},this),this.richText.string=c.default.getStr("rankList_reward_"+s.default.instance.data.rankType)},__decorate([h(cc.ScrollView)],t.prototype,"scrollView",void 0),__decorate([h(cc.RichText)],t.prototype,"richText",void 0),t=__decorate([p],t)}(l.default);i.default=u,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/Window":"Window","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","./RankListCtrl":"RankListCtrl","./RankRewardItem":"RankRewardItem"}],RankTypeBtn:[function(e,t,i){"use strict";cc._RF.push(t,"8fdb5FKeZpA66O6K78kqSPI","RankTypeBtn"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Util/Utils"),a=cc._decorator,r=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bg=null,t.icon=null,t.nameImg=null,t.rankAtlas=null,t._type=null,t._selectedCallback=null,t._selectedCallbackObj=null,t.bgImgUrl=["resources/Activity/OpenService/SevenDayTarget/btn_01.png","resources/Activity/OpenService/SevenDayTarget/btn_02.png"],t}var i;return __extends(t,e),i=t,t.prototype.steType=function(e,t,i){this._type=e,this._selectedCallback=t,this._selectedCallbackObj=i,o.default.setImage(this.bg.node,this.bgImgUrl[0]),this.icon.spriteFrame=this.rankAtlas.getSpriteFrame("icon_"+e),this.nameImg.spriteFrame=this.rankAtlas.getSpriteFrame("i18n_"+e)},Object.defineProperty(t.prototype,"RankType",{get:function(){return this._type?this._type:0},enumerable:!0,configurable:!0}),t.prototype.setSelectedFlag=function(e){void 0===e&&(e=!1),o.default.setImage(this.bg.node,e?this.bgImgUrl[1]:this.bgImgUrl[0])},t.prototype.selectItem=function(e,t){for(var n in e.children){var o=t==e.children[n].getComponent(i).RankType;e.children[n].getComponent(i).setSelectedFlag(o)}},t.prototype.onClickBtn=function(e){if(e.type==cc.Node.EventType.TOUCH_END){var t=e.currentTarget,n=t.getComponent(i).RankType;this.selectItem(t.parent,n),this._selectedCallback&&this._selectedCallback.call(this._selectedCallbackObj,n)}},__decorate([s(cc.Sprite)],t.prototype,"bg",void 0),__decorate([s(cc.Sprite)],t.prototype,"icon",void 0),__decorate([s(cc.Sprite)],t.prototype,"nameImg",void 0),__decorate([s(cc.SpriteAtlas)],t.prototype,"rankAtlas",void 0),t=i=__decorate([r],t)}(n.default);i.default=l,cc._RF.pop()},{"../../Core/Widget":"Widget","../../Util/Utils":"Utils"}],RankingConst:[function(e,t,i){"use strict";cc._RF.push(t,"17224Gk10NHvIg19WyZznO7","RankingConst"),Object.defineProperty(i,"__esModule",{value:!0}),function(e){e[e.ArenaThis=0]="ArenaThis",e[e.ArenaLast=1]="ArenaLast",e[e.HightLadder=2]="HightLadder",e[e.WorldBoss=3]="WorldBoss",e[e.EliteBoss=4]="EliteBoss",e[e.Grade=5]="Grade",e[e.Combat=6]="Combat",e[e.MyArenaThis=7]="MyArenaThis",e[e.MyArenaLast=8]="MyArenaLast",e[e.Devil=9]="Devil"}(i.RankingType||(i.RankingType={})),cc._RF.pop()},{}],RechargeConst:[function(e,t,i){"use strict";cc._RF.push(t,"4d228nq1XhLmpTyiegukjRH","RechargeConst"),Object.defineProperty(i,"__esModule",{value:!0}),function(e){e[e.Money=0]="Money",e[e.Diamonds=1]="Diamonds",e[e.Honor=2]="Honor",e[e.Integral=3]="Integral",e[e.Prop=4]="Prop",e[e.Ornament=5]="Ornament"}(i.RechargeTypeConst||(i.RechargeTypeConst={})),cc._RF.pop()},{}],RechargeUtils:[function(e,t,i){"use strict";cc._RF.push(t,"9a6d2AidCBIToOD1GuIwAUe","RechargeUtils"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Module/Role/RoleInfo"),o=e("../Module/OpenWin/OpenWinController"),a=e("../Core/WindowType"),r=e("../Module/Shop/ShopController"),s=e("../Module/Shop/ShopConst"),l=e("../Module/Shop/Shop"),c=e("../Core/Language"),d=e("./RechargeConst"),p=e("../Module/Item/ItemModel"),h=e("../Module/Chat/ChatController"),u=e("../Core/WindowManager"),f=e("../Module/Item/ItemController"),g=e("../Module/BaiBeiFanLi/BaiBeiFanLiCtrl"),y=e("../Module/Commons/WindowOpenUtils"),m=e("../Module/Tips/TipsWinController"),C=function(){function e(){}return e.PurchaseItemOrRechage=function(e,t,i,C,v){var _=this;void 0===i&&(i=null),void 0===C&&(C=null);var b=!0,T=function(){i&&i.call(C,!1)};switch(e){case d.RechargeTypeConst.Diamonds:n.MyRoleInfo.diamond>=t?T():(m.default.instance.ShowTips(c.default.getStr("\u94bb\u77f3\u4e0d\u8db3"),function(){u.default.instance.closeAll(),g.default.instance.isCanOpen()?y.default.instance.openWindowType(a.WindowType.BaiBeiFanLi):o.default.instance.openWindow(a.WindowType.Shop,function(){var e=r.default.instance.nowSortIndex[s.ShopConst.Recharge];l.default.instance.TabBtnList2.selectItem(e)},_)},this,null,2,c.default.getStr("\u524d\u5f80\u83b7\u53d6")),b=!1);break;case d.RechargeTypeConst.Prop:p.default.getCountByid(v)>=t?T():(h.default.instance.OpenAcquistionPathWin(v),b=!1);break;case d.RechargeTypeConst.Ornament:f.default.instance.getItemNum(v)>=t?T():(h.default.instance.OpenAcquistionPathWin(v),b=!1);break;default:console.log("\u7c7b\u578b=="+e+"RechargeUtils \u672a\u914d\u7f6e")}return b},e}();i.default=C,cc._RF.pop()},{"../Core/Language":"Language","../Core/WindowManager":"WindowManager","../Core/WindowType":"WindowType","../Module/BaiBeiFanLi/BaiBeiFanLiCtrl":"BaiBeiFanLiCtrl","../Module/Chat/ChatController":"ChatController","../Module/Commons/WindowOpenUtils":"WindowOpenUtils","../Module/Item/ItemController":"ItemController","../Module/Item/ItemModel":"ItemModel","../Module/OpenWin/OpenWinController":"OpenWinController","../Module/Role/RoleInfo":"RoleInfo","../Module/Shop/Shop":"Shop","../Module/Shop/ShopConst":"ShopConst","../Module/Shop/ShopController":"ShopController","../Module/Tips/TipsWinController":"TipsWinController","./RechargeConst":"RechargeConst"}],RecommendFriends:[function(e,t,i){"use strict";cc._RF.push(t,"a1fdfgbS2NMo7FrX6TO8syQ","RecommendFriends"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Gamelayer/RoleHead"),o=e("../../Core/Widget"),a=e("../../Core/GameEventDispatcher"),r=e("./FriendsController"),s=e("../Tips/OpTipsController"),l=e("../../Core/Language"),c=e("../../Core/Event"),d=cc._decorator,p=d.ccclass,h=d.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.portraitImage=null,t.sexImage=null,t.level=null,t.playerName=null,t.images=null,t.addFriendNode=null,t.bgImage=null,t.comImages=null,t._isOnClick=!1,t.data=null,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this),a.GameEventDispatcher.instance.on(c.EventDefiner.RECOMMEND_ONCLICK,this.setBGImg,this),this.bgImage.spriteFrame=this.comImages.getSpriteFrame("base01")},t.prototype.hide=function(){e.prototype.hide.call(this),a.GameEventDispatcher.instance.on(c.EventDefiner.RECOMMEND_ONCLICK,this.setBGImg,this)},t.prototype.setData=function(e){this.data=e,this.portraitImage.SetHead(e.icon),this.sexImage.spriteFrame=this.images.getSpriteFrame("gender_"+e.gender),this.level.string=e.level?e.level+"":"0",this.playerName.string=e.name,this.node.on(cc.Node.EventType.TOUCH_END,this.OnSceenTouchEnd,this)},t.prototype.addFriend=function(){var e=r.default.instance;e.data.friendArr.length+1>e.cfg[1].maxFriendNum?s.default.instance.ShowMsg(l.default.getStr("FriendUpLimit")):(a.GameEventDispatcher.instance.emit(c.EventDefiner.FRIENDS_ADD,{actorId:this.data.actorId}),a.GameEventDispatcher.instance.emit(c.EventDefiner.RECOMMEND_Add,{actorId:this.data.actorId}))},t.prototype.getActorId=function(){return this.data.actorId},t.prototype.setBGImg=function(e){var t=e.getUserData().actorId,i=this.data.actorId==t?"base02":"base01";this.bgImage.spriteFrame=this.comImages.getSpriteFrame(i)},t.prototype.OnSceenTouchEnd=function(){a.GameEventDispatcher.instance.emit(c.EventDefiner.RECOMMEND_ONCLICK,{actorId:this.data.actorId})},__decorate([h(n.default)],t.prototype,"portraitImage",void 0),__decorate([h(cc.Sprite)],t.prototype,"sexImage",void 0),__decorate([h(cc.Label)],t.prototype,"level",void 0),__decorate([h(cc.Label)],t.prototype,"playerName",void 0),__decorate([h(cc.SpriteAtlas)],t.prototype,"images",void 0),__decorate([h(cc.Node)],t.prototype,"addFriendNode",void 0),__decorate([h(cc.Sprite)],t.prototype,"bgImage",void 0),__decorate([h(cc.SpriteAtlas)],t.prototype,"comImages",void 0),t=__decorate([p],t)}(o.default);i.default=u,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/Widget":"Widget","../Gamelayer/RoleHead":"RoleHead","../Tips/OpTipsController":"OpTipsController","./FriendsController":"FriendsController"}],RecommendItem:[function(e,t,i){"use strict";cc._RF.push(t,"88379M6XOJNM7lTNN85eTMg","RecommendItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../Commons/WindowOpenUtils"),a=e("../../Core/CommonsResManager"),r=e("../../Util/Utils"),s=e("../../GlobalContext"),l=e("../../Core/LoadManager"),c=e("../Item/ItemData"),d=e("../Item/ItemIcon"),p=e("../../Core/WindowManager"),h=e("../../Core/WindowType"),u=cc._decorator,f=u.ccclass,g=u.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rarity=null,t.pos=null,t.nameLabe=null,t.pathLabe=null,t.describeRichText=null,t.itemContent=null,t.winType=null,t}return __extends(t,e),t.prototype.Init=function(e,t,i,n,o,p,h){var u=this;this.rarity.spriteFrame=a.default.instance.getSpriteFrameByName("rarity_"+e),this.pos.spriteFrame=a.default.instance.getSpriteFrameByName("stance_"+t),this.nameLabe.string=i,this.pathLabe.string=n,this.describeRichText.string=o,this.winType=h,r.default.setNodeChildDestoryByUrl(this.itemContent,s.GlobalContext.Root+"prefab/Bag/ItemIcon"),l.default.instance.loadResByType(s.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(e){var t=r.default.getNodeByUrl(e,s.GlobalContext.Root+"prefab/Bag/ItemIcon"),i=c.default.creatItem(p,1);t.getComponent(d.default).ItemData(i,!0,null,!0),u.itemContent.addChild(t)},this)},t.prototype.SkipBtnClick=function(){p.default.instance.close(h.WindowType.CardRecommend),this.winType[1]?o.default.instance.openWindowType(this.winType[0],this.winType[1]):o.default.instance.openWindowType(this.winType[0])},__decorate([g(cc.Sprite)],t.prototype,"rarity",void 0),__decorate([g(cc.Sprite)],t.prototype,"pos",void 0),__decorate([g(cc.Label)],t.prototype,"nameLabe",void 0),__decorate([g(cc.RichText)],t.prototype,"pathLabe",void 0),__decorate([g(cc.RichText)],t.prototype,"describeRichText",void 0),__decorate([g(cc.Node)],t.prototype,"itemContent",void 0),t=__decorate([f],t)}(n.default);i.default=y,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/LoadManager":"LoadManager","../../Core/Widget":"Widget","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/WindowOpenUtils":"WindowOpenUtils","../Item/ItemData":"ItemData","../Item/ItemIcon":"ItemIcon"}],ReelCardInfo:[function(e,t,i){"use strict";cc._RF.push(t,"463edS5ceJPF6bP+K/y4Oui","ReelCardInfo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../WarTeam/MonsterController"),a=e("../../Core/ConfigsManager"),r=e("../../Core/GameEventDispatcher"),s=e("../Commons/MonsterPreview"),l=e("../../Util/Utils"),c=e("../../Core/WindowType"),d=e("../../Global/GlobalValue"),p=e("../../Core/CommonsResManager"),h=e("../Tips/OpTipsController"),u=e("../../Core/Language"),f=e("../../Core/TimeController"),g=e("./ReelController"),y=cc._decorator,m=y.ccclass,C=y.property,v=function(e){function t(){var t=e.call(this)||this;return t.Type1=null,t.Type2=null,t.HaveCount=null,t.FighNumber=null,t.ZhiImge=null,t.Di=null,t.Model=null,t.Bg=null,t.Bg1=null,t.Bg2=null,t.XiImge=null,t.scrollNameLabe=null,t.cardId=0,t.grade=0,t.level=0,t.count=0,t.ScrollId=0,t.ScrollName=1,t.Data=[],t.Type=0,t.index=0,t._configs=null,t.time=0,t.itemConfig=null,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this),i.instance=this},t.prototype.initInfo=function(e,t,i,n,o,r,s){this.Data=[],this._configs=a.ConfigsManager.instance.getConfigs("cardConf"),this.itemConfig=a.ConfigsManager.instance.getConfigs("Itemconf"),this.cardId=e,this.grade=t,this.Is_Work=o,this.level=i,this.count=n,this.scrolltype=r,this.ScrollId=s,this.Data[0]=e,this.Data[1]=t,this.Data[2]=i,this.Data[3]=n,this.Data[4]=o,this.Data[5]=r,this.Data[6]=this.ScrollId,this.setToUpdateInfo(r)},t.prototype.setIndex=function(e){this.index=e},t.prototype.setToUpdateInfo=function(e){var t=this._configs.Card[this.cardId].rarity;if(this.Di.getComponent(cc.Sprite).spriteFrame=p.default.instance.getSpriteFrameByName("bg_juanzhou"+t),0==e){this.Type1.active=!0,this.XiImge.spriteFrame=p.default.instance.getSpriteFrameByName("rarity_"+t),cc.find("Type/Type1/InfoLayer/bg6",this.node).active=1==this.Is_Work;this._configs.Card[this.cardId].cardType;this.ZhiImge.spriteFrame=p.default.instance.getSpriteFrameByName("form_"+this.grade);var i=g.default.instance.getReelAttr(this.cardId,this.grade);this.FighNumber.string=i.GetFight()+"",this.HaveCount.string=""+this.count,this.scrollNameLabe.string=this.itemConfig.ItemConf[this.ScrollId].ItemName,this.Type=1;var n=l.default.getNodeByPool(c.PoolType.MonsterPreview,o.default.instance.MonsterPreview);n.setScale(.2),this.Model.removeAllChildren(),this.Model.addChild(n);var a=n.getComponent(s.default);a.init("monster",this.Data[0],this.Data[1],d.DEFAULTS_SKIN+this.Data[1]+"",d.PRIORITY.MONSTER),this.count<=0&&this.scheduleOnce(function(){a.node.children[0]&&(a.node.children[0].color=cc.color(100,100,100))},0)}else if(1==e){this.Type2.active=!0,cc.find("Type/Type2/InfoLayer/SkillPower/Name",this.node).getComponent(cc.Label).string,cc.find("Type/Type2/InfoLayer/SkillPower/Des",this.node).getComponent(cc.Label).string,cc.find("Type/Type2/InfoLayer/SkillPower/HaveNumber",this.node).getComponent(cc.Label).string=""+this.Data[3],cc.find("Type/Type2/bg6",this.node).active=1==this.Is_Work,this.Type=2}},t.prototype.touchCancel=function(){this.time&&clearTimeout(this.time),this.time=null},t.prototype.touchStart=function(e){var t=this;this.time=f.default.instance.setTimeout(function(){t.setEvent(),f.default.instance.clearTimeout(t.time),t.time=0},this,300)},t.prototype.touchEnd=function(e){this.count<=0?h.default.instance.ShowMsg(u.default.getStr("\u8be5\u5377\u8f74\u6570\u91cf\u4e0d\u8db3\uff0c\u65e0\u6cd5\u4e0a\u9635")):this.Bg.active?(this.setOut(),r.GameEventDispatcher.instance.emit("ChangeReel",{data:this.Data,index:this.Data,type:1})):(this.Bg.active=!0,r.GameEventDispatcher.instance.emit("ChangeReel",{data:this.Data,index:this.Data,type:2}))},t.prototype.setOut=function(){this.Bg.active=!1,this.Bg1.active=!1},t.prototype.setEvent=function(){this.time=0,console.log(this.Data[2],333),r.GameEventDispatcher.instance.emit("OpenMonsterPanl",this.Data)},t.prototype.onHide=function(e){1==e?this.Bg.active=!1:2==e&&(this.Bg1.active=!1)},t.instance=null,__decorate([C(cc.Node)],t.prototype,"Type1",void 0),__decorate([C(cc.Node)],t.prototype,"Type2",void 0),__decorate([C(cc.Label)],t.prototype,"HaveCount",void 0),__decorate([C(cc.Label)],t.prototype,"FighNumber",void 0),__decorate([C(cc.Sprite)],t.prototype,"ZhiImge",void 0),__decorate([C(cc.Node)],t.prototype,"Di",void 0),__decorate([C(cc.Node)],t.prototype,"Model",void 0),__decorate([C(cc.Node)],t.prototype,"Bg",void 0),__decorate([C(cc.Node)],t.prototype,"Bg1",void 0),__decorate([C(cc.Node)],t.prototype,"Bg2",void 0),__decorate([C(cc.Sprite)],t.prototype,"XiImge",void 0),__decorate([C(cc.Label)],t.prototype,"scrollNameLabe",void 0),t=i=__decorate([m],t)}(n.default);i.default=v,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/ConfigsManager":"ConfigsManager","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../Util/Utils":"Utils","../Commons/MonsterPreview":"MonsterPreview","../Tips/OpTipsController":"OpTipsController","../WarTeam/MonsterController":"MonsterController","./ReelController":"ReelController"}],ReelClick:[function(e,t,i){"use strict";cc._RF.push(t,"6ff2f3p3lRKbLreiGEzxvfC","ReelClick"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("./ReelController"),a=e("../Scene/Controller/FightController"),r=e("../../NetConnect/NetConnet"),s=e("../../Core/ConfigsManager"),l=e("../Guide/GuideNewController"),c=cc._decorator,d=c.ccclass,p=(c.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._configs1=null,t.data=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),this._configs1=s.ConfigsManager.instance.getConfigs("scrollconf")},t.prototype.onClick=function(){for(var e in o.default.instance.scrolldata)if(o.default.instance.scrolldata[e].scrollid==this.data.scrollid&&0!=o.default.instance.scrolldata[e].count){if(l.default.instance.isGuide&&15==l.default.instance.vo.id)return void o.default.instance.addClientMonster(Number(e));var t={cmd:"scrollconsume",index:e,count:1};r.default.instance.sendProto(t),a.default.instance.UserScrollNumber++;break}},t=__decorate([d],t)}(n.default));i.default=p,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Widget":"Widget","../../NetConnect/NetConnet":"NetConnet","../Guide/GuideNewController":"GuideNewController","../Scene/Controller/FightController":"FightController","./ReelController":"ReelController"}],ReelController:[function(e,t,i){"use strict";cc._RF.push(t,"64bf8i1F2FB+I+e5Aep6xAi","ReelController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../Core/GameEventDispatcher"),a=e("../../Core/Event"),r=e("./ReelMode"),s=e("../../Core/ConfigsManager"),l=e("../../Util/Utils"),c=e("../../Global/GlobalValue"),d=e("../Item/ItemController"),p=e("../WarTeam/MonsterController"),h=e("../Fight/staticattr"),u=e("../Scene/Controller/SceneController"),f=e("../Scene/Controller/FightController"),g=e("../Scene/Prop/EntityProperty"),y=e("../Scene/Controller/SkillController"),m=e("../FightInfoPanel/FightInfoPanel"),C=e("../../Core/LoadManager"),v=e("../../GlobalContext"),_=e("../Guide/GuideNewController"),b=e("../Role/RoleInfo"),T=cc._decorator,S=T.ccclass,I=(T.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._configs1=null,t._configs=null,t.scroll={},t.data={},t.scrolldata={},t.list=[],t.data1=[],t.havenum=[],t.Index=[],t.BattleScroll=[],t.Num=0,t.battleArry=[],t.addProp={},t.idDic={},t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this._configs1=s.ConfigsManager.instance.getConfigs("scrollconf"),this._configs=s.ConfigsManager.instance.getConfigs("cardConf");for(var t=0;t<this._configs1.scroll[1].length;t++)this.idDic[this._configs1.scroll[1][t].id]=this._configs1.scroll[1][t]},t.prototype.start=function(){i.instance=this},t.prototype.listNotification=function(){this.addProto("scrollslot",this.InitWearScrollInfo,this),this.addProto("scrolluseconfirm",this.UseReelBack,this)},t.prototype.InitWearScrollInfo=function(e){this.havenum=[],r.MyReelData.curreellist=[],this.Index=[],this.havenum=e.slot;for(var t=d.default.instance.scrollList,i=0;i<this.havenum.length;i++)if(0!=this.havenum[i]){for(var n in t)if(this.havenum[i]==t[n].id){r.MyReelData.curreellist.push(Number(this.havenum[i]));break}for(var n in t)if(this.havenum[i]==t[n].id){var s={index:i,scrollid:this.havenum[i]};this.Index.push(s);break}}if(0==t.length){console.log("\u65b0\u53f7\u521a\u4e0a\u7ebf\uff0c\u589e\u52a0\u4e86\u5377\u8f74");for(i=0;i<this.havenum.length;i++)r.MyReelData.curreellist.push(this.havenum[i]);if(0==this.Index.length)for(var l=0;l<r.MyReelData.curreellist.length;l++){s={index:l,scrollid:r.MyReelData.curreellist[l]};this.Index.push(s)}}this.ScrollReelInfo(),o.GameEventDispatcher.instance.emit(a.EventDefiner.CurScrollInfo)},t.prototype.getReelAttr=function(e,t){for(var i=new h.StaticAttr,n=p.default.instance.getCardGradeByGradeConf(e,t),o=s.ConfigsManager.instance.getConfigs("cardstageConf"),a=b.MyRoleInfo.level>0?b.MyRoleInfo.level-1:0,r=o.cardAttr[p.default.instance.getCardConfCardType(e)][a].base,l=0;l<n.prop.length;l++){var c=o.base[r][l].param&&r?o.base[r][l].param:1;i.ChangeAtt(l,Math.ceil(n.prop[l]*c/1e4*.5))}return console.log("\u5377\u8f74\u5c5e\u6027",n.prop,i),console.log("\u5f62\u6001\u52a0\u6210",o.base[r]),i},t.prototype.UseReelBack=function(e){var t,i=null;t=this.getSkills(this.scrolldata[e.index]);var n=this.onGetCardInfoParam1(this.scrolldata[e.index].scrollid);for(var o in _.default.instance.reelMonsterId=n,_.default.instance.reelMonsterGrade=this.scrolldata[e.index].grade,i=this.getReelAttr(n,this.scrolldata[e.index].grade),this.addProp)i.ChangeAtt(parseInt(o),this.addProp[o]);this.addProp={},console.log("\u5377\u8f74\u5c5e\u6027",i);var a=-c.FightSceneWidth/2+u.default.instance.getActorRandX(p.default.instance.getCardConfCardType(n)),r={cardid:n,grade:this.scrolldata[e.index].grade,level:1,num:1,self:!0,x:a,attr:i,autoUseSkill:!1,skills:t};f.default.instance.fightingAddActor(r,c.ADD_ACTOR_TYPE.REEL),l.default.setNodeChildDestoryByUrl(m.default.instance.FightNumUp,v.GlobalContext.Root+"prefab/fightinfopanel/ScrollFightNum"),C.default.instance.loadResByType(v.GlobalContext.Root+"prefab/fightinfopanel/ScrollFightNum",cc.Prefab,function(e){var t=l.default.getNodeByUrl(e,v.GlobalContext.Root+"prefab/fightinfopanel/ScrollFightNum");m.default.instance.FightNumUp.addChild(t),t.stopAllActions(),t.getChildByName("Layout").getChildByName("FightNumLabe").getComponent(cc.Label).string=i.GetFight()+"",t.runAction(cc.sequence(cc.fadeTo(1,255),cc.fadeTo(3,0)))},this)},t.prototype.ScrollReelInfo=function(){var e=0,t=0;this.scrolldata={};var i=d.default.instance.scrollList;if(0==r.MyReelData.curreellist.length)this.data={cardid:0,count:0,grade:0,type:1};else for(var n=0;n<i.length;n++)for(var o=0;o<r.MyReelData.curreellist.length;o++)0==r.MyReelData.curreellist[o]?this.data[o]={cardid:0,count:0,grade:0,type:2}:0!=r.MyReelData.curreellist[o]&&r.MyReelData.curreellist[o]==i[n].id&&(e=this.onGetCardInfoParam2(r.MyReelData.curreellist[o]),t=this.onGetCardInfoParam1(r.MyReelData.curreellist[o]),this.data[o]={cardid:t,count:i[n].count,grade:e,type:3},this.scrolldata[o]={scrollid:r.MyReelData.curreellist[o],count:i[n].count,grade:e,type:3});console.log("\u5f53\u524d\u4e0a\u9635\u5377\u8f74scroll",r.MyReelData.curreellist,this.scrolldata)},t.prototype.getNewScroll=function(){var e=[],t=[];if(null!=d.default.instance.scrollList){for(var i=0;i<d.default.instance.scrollList.length;i++)t.push(d.default.instance.scrollList[i].id);for(var n=0;n<r.MyReelData.curreellist.length;n++)if(0!=r.MyReelData.curreellist[n]){for(var o in t)if(t[o]==r.MyReelData.curreellist[n]){var a=o,s=t.splice(Number(a),1);t.splice(n,0,s[0])}}else n;for(var l=0;l<t.length;l++)for(var c=0;c<d.default.instance.scrollList.length;c++)if(d.default.instance.scrollList[c].id==t[l]&&d.default.instance.scrollList[c].count>0){var p={id:t[l],count:d.default.instance.scrollList[c].count};e.push(p)}}return e},t.prototype.sortReelList=function(e){var t=this._configs1.scroll[1].slice(0),i=[],n=[],o=[],a=[],s=[],l=function(c){if(c.length>0){if(0==t[0].type){for(var d=!1,p=0;p<r.MyReelData.curreellist.length;p++)d||r.MyReelData.curreellist[p]!=t[0].id||(i.push(t.splice(0,1)[0]),d=!0);if(!d)for(p=0;p<e.length;p++)d||e[p].id!=t[0].id||(n.push(t.splice(0,1)[0]),d=!0);d||5!=t[0].param2||(o.push(t.splice(0,1)[0]),d=!0),d||4!=t[0].param2||(a.push(t.splice(0,1)[0]),d=!0),d||3!=t[0].param2||(s.push(t.splice(0,1)[0]),d=!0)}l(t)}};return l(t),n.sort(function(e,t){if(t.param2==e.param2){var i=p.default.instance.GetMonsterInfo(e.param1),n=p.default.instance.GetMonsterInfo(t.param1);return i.rarity==n.rarity?e.param1-t.param1:n.rarity-i.rarity}return t.param2-e.param2}),i.concat(n.concat(o.concat(a.concat(s.concat()))))},t.prototype.onGetCardInfoParam2=function(e){if(this.idDic[e])return this.idDic[e].param2;console.log("\u6ca1\u6709\u627e\u5230\u5361\u724c"+e+"\u5377\u8f74")},t.prototype.onGetCardInfoParam1=function(e){if(this.idDic[e])return this.idDic[e].param1;console.log("\u6ca1\u6709\u627e\u5230\u5361\u724c"+e+"\u5377\u8f74")},t.prototype.getSkills=function(e){var t=[],i=this.onGetCardInfoParam1(e.scrollid),n=p.default.instance.GetMonsterInfo(i),o=new g.EntityProperty;o.cardid=i,o.grade=e.grade-1,o.cultivateLv=p.MonsterType.MaxSkillLevel,o.selfMonster=!0;var a=y.default.instance.getSkills(o),r={skillid:a[0].skillid,skilllv:a[0].skilllv};t.push(r);for(var s=0;s<n.skillId.length;s++){var l={skillid:n.skillId[s],skilllv:1};t.push(l)}return t},t.prototype.onGetCardID=function(e){for(var t=0,i=0;i<this._configs1.scroll[1].length;i++)this._configs1.scroll[1][i].id==e&&(t=this._configs1.scroll[1][i].param1);return t},t.prototype.addClientMonster=function(e){this.UseReelBack({index:e}),o.GameEventDispatcher.instance.emit(a.EventDefiner.CloseReelList)},t.instance=null,t=i=__decorate([S],t)}(n.default));i.default=I,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/LoadManager":"LoadManager","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Fight/staticattr":"staticattr","../FightInfoPanel/FightInfoPanel":"FightInfoPanel","../Guide/GuideNewController":"GuideNewController","../Item/ItemController":"ItemController","../Role/RoleInfo":"RoleInfo","../Scene/Controller/FightController":"FightController","../Scene/Controller/SceneController":"SceneController","../Scene/Controller/SkillController":"SkillController","../Scene/Prop/EntityProperty":"EntityProperty","../WarTeam/MonsterController":"MonsterController","./ReelMode":"ReelMode"}],ReelMode:[function(e,t,i){"use strict";cc._RF.push(t,"dc4b0DdxnJN9IQH7Jl1PmWk","ReelMode"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){return function(){this.id=0,this.grade=0,this.curreellist=[],this.listid=0,this.listcount=0}}();i.ReelData=n,i.MyReelData=new n,cc._RF.pop()},{}],ReelWin:[function(e,t,i){"use strict";cc._RF.push(t,"968f6PdIMhPcLr7Sd7g8iy+","ReelWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../../Core/GameEventDispatcher"),a=e("../../Core/Event"),r=e("../../Core/WindowManager"),s=e("./ReelMode"),l=e("../Tips/OpTipsController"),c=e("../../Core/ConfigsManager"),d=e("../WarTeam/MonsterController"),p=e("../Scene/Controller/SkillController"),h=e("../Commons/MonsterPreview"),u=e("../../Core/WindowType"),f=e("../../Util/Utils"),g=e("../Commons/TabBtnList"),y=e("./ReelController"),m=e("../../NetConnect/NetConnet"),C=e("../../Global/GlobalValue"),v=e("../../GlobalContext"),_=e("./ReelCardInfo"),b=e("../../Core/Language"),T=e("../../Core/CommonsResManager"),S=e("../../Util/GrayEffect"),I=e("../Scene/View/Chapter/FightInfo"),w=e("../Commons/ListViewCtrl"),D=e("../Item/ItemController"),R=e("../../Core/LoadManager"),A=cc._decorator,N=A.ccclass,L=A.property,E=function(e){function t(){var t=e.call(this)||this;return t.ReelWork1=null,t.ReelWork2=null,t.ReelWork3=null,t.ReelWork4=null,t.ReelWork5=null,t.ReelWorkList=null,t.CardList=null,t.TipsPanl=null,t.SkillPanl=null,t.MonsterPanl=null,t.ReelPic=null,t.TabBtnList=null,t.lisViewtControl=null,t.CardPrefab=null,t.porpData=[],t.StatusReel1=1,t.StatusReel2=0,t.StatusReel3=0,t.StatusReel4=0,t.StatusReel5=0,t.Di1=null,t.Di2=null,t.Di3=null,t.Di4=null,t.Di5=null,t.Status=[],t.CardInfo=[],t.Id=0,t.idIndexArr=[],t.scrollidIndexArr=[],t.MaxLevel=0,t.reelsArr=null,t.Index=0,t.NewScroll=[],t.Num=0,t._configs=null,t._configs1=null,t.arry=[],t.scrollConf=[],i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){this.onInit(u.WindowType.ReelWin,!0),e.prototype.onLoad.call(this),this._configs=c.ConfigsManager.instance.getConfigs("cardConf"),this._configs1=c.ConfigsManager.instance.getConfigs("scrollconf"),this.Di1=cc.find("Scrollbox_green/di2",this.ReelWorkList),this.Di2=cc.find("Scrollbox_blue/di2",this.ReelWorkList),this.Di3=cc.find("Scrollbox_purple/di2",this.ReelWorkList),this.Di4=cc.find("Scrollbox_orange/di2",this.ReelWorkList),this.Di5=cc.find("Scrollbox_red/di2",this.ReelWorkList),this.CardListScroll=this.CardList.getComponent(cc.ScrollView)},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){this.scrollConf=this._configs1.scroll[1].slice(0),e.prototype.show.call(this),this.onsort(),this.onCheckReelWork(),this.initTab(),o.GameEventDispatcher.instance.on("ChangeReel",this.ChangeReel,this),o.GameEventDispatcher.instance.on(a.EventDefiner.CurScrollInfo,this.RefreshList,this),o.GameEventDispatcher.instance.on(a.EventDefiner.ReelCountInfo,this.RefreshCurList,this),this.TabBtnList.getComponent("TabBtnList").selectItem(0),this.lisViewtControl.refreshItem=this.ScrollInfo,this.lisViewtControl.refreshItemThis=this},t.prototype.hide=function(){e.prototype.hide.call(this),o.GameEventDispatcher.instance.off("ChangeReel",this.ChangeReel,this),o.GameEventDispatcher.instance.off(a.EventDefiner.CurScrollInfo,this.RefreshList,this),o.GameEventDispatcher.instance.off(a.EventDefiner.ReelCountInfo,this.RefreshCurList,this),this.arry=[]},t.prototype.ScrollInfo=function(e,t){var i=!1,n=0,o=0,a=0,r=0;if(this.MaxLevel=d.MonsterType.MaxLevel,0==this.lisViewtControl.dataLsit[t].type){for(var s in this.idIndexArr)parseInt(this.idIndexArr[s])==this.onOwnScorll(this.lisViewtControl.dataLsit[t].id).id&&(i=!0);if(0!=this.onOwnScorll(this.lisViewtControl.dataLsit[t].id)){for(s=0;s<this._configs1.scroll[1].length;s++)if(this._configs1.scroll[1][s].id==this.onOwnScorll(this.lisViewtControl.dataLsit[t].id).id){n=this._configs1.scroll[1][s].param2,o=this._configs1.scroll[1][s].param1,a=this._configs1.scroll[1][s].type;break}e.getComponent(_.default).initInfo(o,n,this.MaxLevel,this.onOwnScorll(this.lisViewtControl.dataLsit[t].id).count,i,a,this.onOwnScorll(this.lisViewtControl.dataLsit[t].id).id),this.scheduleOnce(function(){e.getComponent(cc.Button).interactable=!0,e.getComponent(S.default)?e.getComponent(S.default).setGray(!1):e.addComponent(S.default).setGray(!1)},.1),this.reelsArr[""+this.onOwnScorll(this.lisViewtControl.dataLsit[t].id).id]=e,e.getComponent("ReelCardInfo").setIndex(this.reelsArr.length)}else n=this.lisViewtControl.dataLsit[t].param2,o=this.lisViewtControl.dataLsit[t].param1,a=this.lisViewtControl.dataLsit[t].type,r=this.lisViewtControl.dataLsit[t].id,e.getComponent(_.default).initInfo(o,n,this.MaxLevel,0,i,a,r),this.scheduleOnce(function(){e.getComponent(cc.Button).interactable=!1,e.getComponent(S.default)?e.getComponent(S.default).setGray(!0):e.addComponent(S.default).setGray(!0)},.1),this.reelsArr[""+this._configs1.scroll[1][t].id]=e,e.getComponent("ReelCardInfo").setIndex(this.reelsArr.length)}},t.prototype.onsort=function(){this.NewScroll=y.default.instance.getNewScroll(),this.arry=y.default.instance.sortReelList(this.NewScroll)},t.prototype.RefreshCurList=function(e){this.onsort(),this.RefreshList(this.Index),this.onShowNumber()},t.prototype.RefreshList=function(e){this.Index=e,this.CheckChange(),this.reelsArr={},this.lisViewtControl.initialize(this.ScrollScreen(e)),this.lisViewtControl.scrollToTop(),console.log("\u5237\u65b0\u5f53\u524d\u5217\u8868",e)},t.prototype.CheckChange=function(){var e=!1;if(this.idIndexArr=s.MyReelData.curreellist,this.idIndexArr.length!=s.MyReelData.curreellist.length)e=!0;else for(var t=0;t<s.MyReelData.curreellist.length;t++)if(s.MyReelData.curreellist[t]==this.idIndexArr[t])e=!1;else if(s.MyReelData.curreellist[t]!=this.idIndexArr[t]){e=!0;break}1==e&&this.sortArr()},t.prototype.sortArr=function(){console.warn("\u91cd\u65b0\u6392\u5e8f");var e=[];for(var t in this.idIndexArr)this.idIndexArr[t]&&e.push(this.idIndexArr[t]);for(t=0;t<this.NewScroll.length;t++)if(-1==e.indexOf(this.NewScroll[t].id))for(var i=t,n=!0,o=t+1;o<this.NewScroll.length&&this.NewScroll[i].id>this.NewScroll[o].id;o++){var a=this.NewScroll[i];this.NewScroll[i]=this.NewScroll[o],this.NewScroll[o]=a,i=o,n&&(n=!1,t--)}else if(t!=e.indexOf(this.NewScroll[t].id)){a=this.NewScroll[t];this.NewScroll.splice(t,1),this.NewScroll.splice(e.indexOf(a.id),0,a)}for(var t in e)if(this.NewScroll[t]&&e[t]!=this.NewScroll[t].id)return this.sortArr()},t.prototype.sortList=function(e,t,i,n){var o=this;void 0===t&&(t=0),void 0===n&&(n=!0);for(var a=0,r=0,s=0,l=0;l<this._configs1.scroll[1].length;l++)if(this._configs1.scroll[1][l].id==i){a=this._configs1.scroll[1][l].param2,r=this._configs1.scroll[1][l].param1,s=this._configs1.scroll[1][l].type;break}if(d.default.instance.GetAllCardArr(),this.MaxLevel=d.MonsterType.MaxLevel,0==e||1==e&&5==a||2==e&&4==a||3==e&&3==a){[].push(i),this.CardListScroll.content.y=200;var c=!1;for(var l in this.idIndexArr)parseInt(this.idIndexArr[l])==i&&(c=!0);R.default.instance.loadResByType(v.GlobalContext.Root+"prefab/Reel/ReelPrefab",cc.Prefab,function(e){var l=f.default.getNodeByUrl(e,v.GlobalContext.Root+"prefab/Reel/ReelPrefab");void 0!=t&&null!=t||(t=0),l.getComponent("ReelCardInfo").initInfo(r,a,o.MaxLevel,t,c,s,i),l.getComponent("ReelCardInfo").setIndex(o.reelsArr.length),o.CardListScroll.content.addChild(l),o.reelsArr[""+i]=l,o.scheduleOnce(function(){l.getComponent(cc.Button).interactable=n,l.addComponent(S.default).setGray(!n)},.1)},this)}},t.prototype.onCheckReelWork=function(){var e;this.StatusReel1,(e=d.default.instance.GetAllCardArr().length)>=e?(this.ReelWorkList.children[1].children[1].active=!1,this.ReelWorkList.children[1].children[3].active=!1,this.ReelWorkList.children[1].children[5].active=!1,this.StatusReel2=1):e<this._configs1.slot[1][0].count&&(this.ReelWorkList.children[1].children[1].active=!1),e>=e?(this.ReelWorkList.children[2].children[1].active=!1,this.ReelWorkList.children[2].children[3].active=!1,this.ReelWorkList.children[2].children[5].active=!1,this.StatusReel3=1):e<e&&(this.ReelWorkList.children[2].children[1].active=!1),e>=e?(this.ReelWorkList.children[3].children[1].active=!1,this.ReelWorkList.children[3].children[3].active=!1,this.ReelWorkList.children[3].children[5].active=!1,this.StatusReel4=1):e<this._configs1.slot[1][2].count&&(this.ReelWorkList.children[3].children[1].active=!1),e>=e?(this.ReelWorkList.children[4].children[1].active=!1,this.ReelWorkList.children[4].children[3].active=!1,this.ReelWorkList.children[4].children[5].active=!1,this.StatusReel5=1):e<this._configs1.slot[1][3].count&&(this.ReelWorkList.children[4].children[1].active=!1),this.onShowNumber()},t.prototype.onShowNumber=function(){var e=0;this._configs1.scroll[1];if(0==s.MyReelData.curreellist.length){for(var t=0;t<this.idIndexArr.length;t++)1!=this.ReelWorkList.children[t].children[1].active&&0!=this.ReelWorkList.children[t].children[2].active||(this.ReelWorkList.children[t].children[1].active=!this.ReelWorkList.children[t].children[1].active),this.Status[t]=1;this.UpdataStatus()}if(0==s.MyReelData.curreellist.length){this.Status=[];for(var i=0;i<this.ReelWorkList.childrenCount;i++)this.ReelWorkList.children[i].children[1].active=!1,this.ReelWorkList.children[i].children[5].active=!1;this.Status.push(this.StatusReel1),this.Status.push(this.StatusReel2),this.Status.push(this.StatusReel3),this.Status.push(this.StatusReel4),this.Status.push(this.StatusReel5),console.log("\u65e0\u4fe1\u606f",this.Status)}else{this.Status=[];for(i=0;i<s.MyReelData.curreellist.length;i++)for(var n=0;n<D.default.instance.scrollList.length;n++)s.MyReelData.curreellist[i]==D.default.instance.scrollList[n].id&&0==D.default.instance.scrollList[n].count&&(s.MyReelData.curreellist.splice(i,1),i--);var o=this.idIndexArr.length>s.MyReelData.curreellist.length?this.idIndexArr.length:s.MyReelData.curreellist.length;for(i=0;i<o;i++)switch(e=0,e=s.MyReelData.curreellist[i]?2:1,i){case 0:if(1==e)this.StatusReel1=1,this.ReelWorkList.children[0].children[1].active=!1,this.ReelWorkList.children[0].children[5].active=!1,this.scrollidIndexArr[0]=0,this.idIndexArr[0]=0;else if(2==e&&(this.StatusReel1=2,this.ReelWorkList.children[0].children[2].active=!1,this.ReelWorkList.children[0].children[1].active=!0,this.ReelWorkList.children[0].children[5].active=!0,this.idIndexArr[0]=s.MyReelData.curreellist[i],this.NewScroll.length>0))for(t=0;t<this.NewScroll.length;t++)if(this.NewScroll[t].id==s.MyReelData.curreellist[i]){this.scrollidIndexArr[0]=i;var a=this.onGetCardInfo(this.NewScroll[t].id),r=this._configs.Card[this.onGetCardID(this.NewScroll[t].id)].rarity;this.ReelWorkList.children[0].children[0].getComponent(cc.Sprite).spriteFrame=T.default.instance.getSpriteFrameByName("bg_juanzhou"+r),this.ReelWorkList.children[0].children[0].setScale(1.2),this.Di1.children[0].getComponent(cc.Label).string=""+this.NewScroll[t].count,this.ReelWorkList.children[0].children[5].getComponent(cc.Sprite).spriteFrame=T.default.instance.getSpriteFrameByName("form_"+a);var l=this.onGetCardID(this.NewScroll[t].id);if(this.ReelWorkList.children[0].children[4].childrenCount>=0){(c=f.default.getNodeByPool(u.PoolType.MonsterPreview,d.default.instance.MonsterPreview)).setScale(.3),this.ReelWorkList.children[0].children[4].addChild(c),(p=c.getComponent(h.default)).clear(),p.init("monster",l,a,C.DEFAULTS_SKIN+a+"",C.PRIORITY.MONSTER);break}}break;case 1:if(1==e)this.StatusReel2=1,this.ReelWorkList.children[1].children[1].active=!1,this.ReelWorkList.children[1].children[5].active=!1,this.scrollidIndexArr[1]=0,this.idIndexArr[1]=0;else if(2==e){if(this.StatusReel2=2,this.ReelWorkList.children[1].children[2].active=!1,this.ReelWorkList.children[1].children[5].active=!0,this.NewScroll.length>0)for(t=0;t<this.NewScroll.length;t++)if(this.NewScroll[t].id==s.MyReelData.curreellist[i]){this.scrollidIndexArr[1]=i;a=this.onGetCardInfo(this.NewScroll[t].id),r=this._configs.Card[this.onGetCardID(this.NewScroll[t].id)].rarity;this.ReelWorkList.children[1].children[0].getComponent(cc.Sprite).spriteFrame=T.default.instance.getSpriteFrameByName("bg_juanzhou"+r),this.ReelWorkList.children[1].children[0].setScale(1.2),this.Di2.active=!0,this.Di2.children[0].getComponent(cc.Label).string=""+this.NewScroll[t].count,this.ReelWorkList.children[1].children[5].getComponent(cc.Sprite).spriteFrame=T.default.instance.getSpriteFrameByName("form_"+a);l=this.onGetCardID(this.NewScroll[t].id);if(this.ReelWorkList.children[1].children[4].childrenCount>=0){(c=f.default.getNodeByPool(u.PoolType.MonsterPreview,d.default.instance.MonsterPreview)).setScale(.3),this.ReelWorkList.children[1].children[4].addChild(c),(p=c.getComponent(h.default)).clear(),p.init("monster",l,a,C.DEFAULTS_SKIN+a+"",C.PRIORITY.MONSTER);break}}this.ReelWorkList.children[1].children[2].active=!1,this.idIndexArr[1]=s.MyReelData.curreellist[i]}break;case 2:if(1==e)this.StatusReel3=1,this.ReelWorkList.children[2].children[1].active=!1,this.ReelWorkList.children[2].children[5].active=!1,this.scrollidIndexArr[2]=0,this.idIndexArr[2]=0;else if(2==e){if(this.StatusReel3=2,this.ReelWorkList.children[2].children[2].active=!1,this.ReelWorkList.children[2].children[5].active=!0,this.NewScroll.length>0)for(t=0;t<this.NewScroll.length;t++)if(this.NewScroll[t].id==s.MyReelData.curreellist[i]){this.scrollidIndexArr[2]=i;a=this.onGetCardInfo(this.NewScroll[t].id),r=this._configs.Card[this.onGetCardID(this.NewScroll[t].id)].rarity;this.ReelWorkList.children[2].children[0].getComponent(cc.Sprite).spriteFrame=T.default.instance.getSpriteFrameByName("bg_juanzhou"+r),this.ReelWorkList.children[2].children[0].setScale(1.2),this.Di3.active=!0,this.Di3.children[0].getComponent(cc.Label).string=""+this.NewScroll[t].count,this.ReelWorkList.children[2].children[5].getComponent(cc.Sprite).spriteFrame=T.default.instance.getSpriteFrameByName("form_"+a);l=this.onGetCardID(this.NewScroll[t].id);if(this.ReelWorkList.children[2].children[4].childrenCount>=0){(c=f.default.getNodeByPool(u.PoolType.MonsterPreview,d.default.instance.MonsterPreview)).setScale(.3),this.ReelWorkList.children[2].children[4].addChild(c),(p=c.getComponent(h.default)).clear(),p.init("monster",l,a,C.DEFAULTS_SKIN+a+"",C.PRIORITY.MONSTER);break}}this.ReelWorkList.children[2].children[2].active=!1,this.idIndexArr[2]=s.MyReelData.curreellist[i]}break;case 3:if(1==e)this.StatusReel4=1,this.ReelWorkList.children[3].children[1].active=!1,this.ReelWorkList.children[3].children[5].active=!1,this.scrollidIndexArr[3]=0,this.idIndexArr[3]=0;else if(2==e){if(this.StatusReel4=2,this.ReelWorkList.children[3].children[2].active=!1,this.ReelWorkList.children[3].children[5].active=!0,this.NewScroll.length>0)for(t=0;t<this.NewScroll.length;t++)if(this.NewScroll[t].id==s.MyReelData.curreellist[i]){this.scrollidIndexArr[3]=i;r=this._configs.Card[this.onGetCardID(this.NewScroll[t].id)].rarity,l=this.onGetCardID(this.NewScroll[t].id),a=this.onGetCardInfo(this.NewScroll[t].id);if(this.ReelWorkList.children[3].children[0].getComponent(cc.Sprite).spriteFrame=T.default.instance.getSpriteFrameByName("bg_juanzhou"+r),this.ReelWorkList.children[3].children[0].setScale(1.2),this.Di4.active=!0,this.Di4.children[0].getComponent(cc.Label).string=""+this.NewScroll[t].count,this.ReelWorkList.children[3].children[5].getComponent(cc.Sprite).spriteFrame=T.default.instance.getSpriteFrameByName("form_"+a),this.ReelWorkList.children[3].children[4].childrenCount>=0){(c=f.default.getNodeByPool(u.PoolType.MonsterPreview,d.default.instance.MonsterPreview)).setScale(.3),this.ReelWorkList.children[3].children[4].addChild(c),(p=c.getComponent(h.default)).clear(),p.init("monster",l,a,C.DEFAULTS_SKIN+a+"",C.PRIORITY.MONSTER);break}}this.ReelWorkList.children[3].children[2].active=!1,this.idIndexArr[3]=s.MyReelData.curreellist[i]}break;case 4:if(1==e)this.StatusReel5=1,this.ReelWorkList.children[4].children[1].active=!1,this.ReelWorkList.children[4].children[5].active=!1,this.scrollidIndexArr[4]=0,this.idIndexArr[4]=0;else if(2==e){if(this.StatusReel5=2,this.ReelWorkList.children[4].children[2].active=!1,this.ReelWorkList.children[4].children[5].active=!0,this.NewScroll.length>0)for(t=0;t<this.NewScroll.length;t++)if(this.NewScroll[t].id==s.MyReelData.curreellist[i]){this.scrollidIndexArr[4]=i;r=this._configs.Card[this.onGetCardID(this.NewScroll[t].id)].rarity,a=this.onGetCardInfo(this.NewScroll[t].id);this.ReelWorkList.children[4].children[0].getComponent(cc.Sprite).spriteFrame=T.default.instance.getSpriteFrameByName("bg_juanzhou"+r),this.ReelWorkList.children[4].children[0].setScale(1.2),this.Di5.active=!0,this.Di5.children[0].getComponent(cc.Label).string=""+this.NewScroll[t].count,this.ReelWorkList.children[4].children[5].getComponent(cc.Sprite).spriteFrame=T.default.instance.getSpriteFrameByName("form_"+a);l=this.onGetCardID(this.NewScroll[t].id);if(this.ReelWorkList.children[4].children[4].childrenCount>=0){var c,p;(c=f.default.getNodeByPool(u.PoolType.MonsterPreview,d.default.instance.MonsterPreview)).setScale(.3),this.ReelWorkList.children[4].children[4].addChild(c),(p=c.getComponent(h.default)).clear(),p.init("monster",l,a,C.DEFAULTS_SKIN+a+"",C.PRIORITY.MONSTER);break}}this.ReelWorkList.children[4].children[2].active=!1,this.idIndexArr[4]=s.MyReelData.curreellist[i]}}this.Status=[],this.Status.push(this.StatusReel1),this.Status.push(this.StatusReel2),this.Status.push(this.StatusReel3),this.Status.push(this.StatusReel4),this.Status.push(this.StatusReel5);var g=s.MyReelData.curreellist;if(s.MyReelData.curreellist.length!=this.idIndexArr.length){for(i=0;i<this.idIndexArr.length;i++)-1==g.indexOf(this.idIndexArr[i])&&(this.idIndexArr[i]=0);this.RefreshList(this.Index)}}},t.prototype.ChangeReel=function(e){var t=e.getUserData().data,i=(e.getUserData().index,e.getUserData().type);this.CardInfo=t;var n=this.onGetCardType(t[6]);if(2==i){if(0==n)for(var o=0;o<this.Status.length;o++){this.Status[o];var a=this._configs.Card[t[0]].rarity;if(1==this.Status[o]){this.ReelWorkList.children[o].children[0].getComponent(cc.Sprite).spriteFrame=T.default.instance.getSpriteFrameByName("bg_juanzhou"+a),this.ReelWorkList.children[o].children[0].setScale(1.2),this.ReelWorkList.children[o].children[1].active=!0,this.ReelWorkList.children[o].children[1].children[0].getComponent(cc.Label).string=""+t[3],this.ReelWorkList.children[o].children[2].active=!1,(l=f.default.getNodeByPool(u.PoolType.MonsterPreview,d.default.instance.MonsterPreview)).setScale(.3),this.ReelWorkList.children[o].children[4].addChild(l),this.ReelWorkList.children[o].children[5].active=!0,this.ReelWorkList.children[o].children[5].getComponent(cc.Sprite).spriteFrame=T.default.instance.getSpriteFrameByName("form_"+t[1]),l.getComponent(h.default).init("monster",t[0],t[1],C.DEFAULTS_SKIN+t[1]+"",C.PRIORITY.MONSTER),this.Status[o]=2;for(var r=0;r<this._configs1.scroll[1].length;r++)this._configs1.scroll[1][r].param1==t[0]&&(this.Id=this._configs1.scroll[1][r].id);var s=this.onGetCardID(this.Id);this.scrollidIndexArr[o]=s,this.idIndexArr[o]=t[6];break}if(2==this.Status[o])if(3!=this.Status[o+1]){if(void 0==this.Status[o+1]){if(this.ReelWorkList.children[4].children[0].getComponent(cc.Sprite).spriteFrame=T.default.instance.getSpriteFrameByName("bg_juanzhou"+a),this.ReelWorkList.children[4].children[0].setScale(1.2),this.ReelWorkList.children[4].children[1].active=!0,this.ReelWorkList.children[4].children[1].children[0].getComponent(cc.Label).string=""+t[3],this.ReelWorkList.children[4].children[2].active=!1,this.ReelWorkList.children[o].children[5].getComponent(cc.Sprite).spriteFrame=T.default.instance.getSpriteFrameByName("form_"+t[1]),this.ReelWorkList.children[4].children[4].childrenCount>0)this.ReelWorkList.children[4].children[4].children[0].getComponent(h.default).clear(),f.default.setNodeToPool(u.PoolType.MonsterPreview,this.ReelWorkList.children[4].children[4].children[0]);this.idIndexArr[4]=t[6],(l=f.default.getNodeByPool(u.PoolType.MonsterPreview,d.default.instance.MonsterPreview)).setScale(.3),this.ReelWorkList.children[4].children[4].addChild(l),l.getComponent(h.default).init("monster",t[0],t[1],C.DEFAULTS_SKIN+t[1]+"",C.PRIORITY.MONSTER),this.Status[4]=2}}else if(3==this.Status[o+1]){var l;if(this.ReelWorkList.children[o].children[0].getComponent(cc.Sprite).spriteFrame=T.default.instance.getSpriteFrameByName("bg_juanzhou"+a),this.ReelWorkList.children[o].children[0].setScale(1.2),this.ReelWorkList.children[o].children[1].active=!0,this.ReelWorkList.children[o].children[1].children[0].getComponent(cc.Label).string=""+t[3],this.ReelWorkList.children[o].children[2].active=!1,this.ReelWorkList.children[o].children[5].getComponent(cc.Sprite).spriteFrame=T.default.instance.getSpriteFrameByName("form_"+t[1]),void 0!=this.ReelWork1.childrenCount&&0==Number(o))this.ReelWork1.children[0].getComponent(h.default).clear(),f.default.setNodeToPool(u.PoolType.MonsterPreview,this.ReelWork1.children[0]);else if(this.ReelWorkList.children[o].children[4].childrenCount>0&&0!=Number(o)){this.ReelWorkList.children[o].children[4].children[0].getComponent(h.default).clear(),f.default.setNodeToPool(u.PoolType.MonsterPreview,this.ReelWorkList.children[o].children[4].children[0])}this.idIndexArr[o]=t[6],(l=f.default.getNodeByPool(u.PoolType.MonsterPreview,d.default.instance.MonsterPreview)).setScale(.3),this.ReelWorkList.children[o].children[4].addChild(l),l.getComponent(h.default).init("monster",t[0],t[1],C.DEFAULTS_SKIN+t[1]+"",C.PRIORITY.MONSTER),this.Status[o]=2}}else 1==n&&console.warn("\u6548\u679c\u5377\u8f74,\u6682\u4e0d\u5904\u7406\u4e0a\u9635\u5377\u8f74");this.UpdataStatus()}else{for(o=0;o<this.idIndexArr.length;o++)if(this.idIndexArr[o]==t[6]){this.ReelWorkList.children[o].children[4].children[0].getComponent(h.default).clear(),f.default.setNodeToPool(u.PoolType.MonsterPreview,this.ReelWorkList.children[o].children[4].children[0]),this.ReelWorkList.children[o].children[0].getComponent(cc.Sprite).spriteFrame=this.ReelPic.getSpriteFrame("icon_jzk"),this.ReelWorkList.children[o].children[0].setScale(1),this.ReelWorkList.children[o].children[1].active=!1,this.ReelWorkList.children[o].children[5].active=!1,this.Status[o]=1,this.idIndexArr[o]=0;break}this.UpdataStatus()}},t.prototype.UpdataStatus=function(){for(var e=0;e<this.Status.length;e++)0==e?this.StatusReel1=this.Status[e]:1==e?this.StatusReel2=this.Status[e]:2==e?this.StatusReel3=this.Status[e]:3==e?this.StatusReel4=this.Status[e]:4==e&&(this.StatusReel5=this.Status[e])},t.prototype.onCheckLength=function(){for(var e=0,t=0;t<this.Status.length;t++)1!=this.Status[t]&&2!=this.Status[t]||(e+=1);return e},t.prototype.onClickReelWork=function(e,t){switch(console.log("\u70b9\u51fb\u5377\u8f74\u69fd"),Number(t)){case 1:if(1==this.StatusReel1);else if(2==this.StatusReel1){this.ReelWork1.children[0].getComponent(h.default).clear(),f.default.setNodeToPool(u.PoolType.MonsterPreview,this.ReelWork1.children[0]),this.ReelWorkList.children[0].children[0].getComponent(cc.Sprite).spriteFrame=this.ReelPic.getSpriteFrame("icon_jzk"),this.ReelWorkList.children[0].children[0].setScale(1),this.ReelWorkList.children[0].children[5].active=!1,this.Di1.active=!1,this.StatusReel1=1,this.reelsArr[this.idIndexArr[parseInt(t)-1]]&&this.reelsArr[this.idIndexArr[parseInt(t)-1]].getComponent("ReelCardInfo").setOut(),this.idIndexArr[parseInt(t)-1]=0}break;case 2:if(1==this.StatusReel2);else if(2==this.StatusReel2){this.ReelWork2.children[0].getComponent(h.default).clear(),f.default.setNodeToPool(u.PoolType.MonsterPreview,this.ReelWork2.children[0]),this.ReelWorkList.children[1].children[0].getComponent(cc.Sprite).spriteFrame=this.ReelPic.getSpriteFrame("icon_jzk"),this.ReelWorkList.children[1].children[0].setScale(1),this.ReelWorkList.children[1].children[5].active=!1,this.ReelWorkList.children[1].children[1].active=!1,this.Di2.active=!1,this.StatusReel2=1,this.reelsArr[this.idIndexArr[parseInt(t)-1]]&&this.reelsArr[this.idIndexArr[parseInt(t)-1]].getComponent("ReelCardInfo").setOut(),this.idIndexArr[parseInt(t)-1]=0}else 3==this.StatusReel2&&l.default.instance.ShowMsg("\u6536\u96c6\u6ee1"+this._configs1.slot[1][0].count+"\u79cd\u5361\u724c\u5f00\u542f");break;case 3:if(1==this.StatusReel3);else if(2==this.StatusReel3){this.ReelWork3.children[0].getComponent(h.default).clear(),f.default.setNodeToPool(u.PoolType.MonsterPreview,this.ReelWork3.children[0]),this.ReelWorkList.children[2].children[0].getComponent(cc.Sprite).spriteFrame=this.ReelPic.getSpriteFrame("icon_jzk"),this.ReelWorkList.children[2].children[0].setScale(1),this.ReelWorkList.children[2].children[5].active=!1,this.Di3.active=!1,this.StatusReel3=1,this.reelsArr[this.idIndexArr[parseInt(t)-1]]&&this.reelsArr[this.idIndexArr[parseInt(t)-1]].getComponent("ReelCardInfo").setOut(),this.idIndexArr[parseInt(t)-1]=0}else 3==this.StatusReel3&&l.default.instance.ShowMsg("\u6536\u96c6\u6ee1"+this._configs1.slot[1][1].count+"\u79cd\u5361\u724c\u5f00\u542f");break;case 4:if(1==this.StatusReel4);else if(2==this.StatusReel4){this.ReelWork4.children[0].getComponent(h.default).clear(),f.default.setNodeToPool(u.PoolType.MonsterPreview,this.ReelWork4.children[0]),this.ReelWorkList.children[3].children[0].getComponent(cc.Sprite).spriteFrame=this.ReelPic.getSpriteFrame("icon_jzk"),this.ReelWorkList.children[3].children[0].setScale(1),this.ReelWorkList.children[3].children[5].active=!1,this.Di4.active=!1,this.StatusReel4=1,this.reelsArr[this.idIndexArr[parseInt(t)-1]]&&this.reelsArr[this.idIndexArr[parseInt(t)-1]].getComponent("ReelCardInfo").setOut(),this.idIndexArr[parseInt(t)-1]=0}else 3==this.StatusReel4&&l.default.instance.ShowMsg("\u6536\u96c6\u6ee1"+this._configs1.slot[1][2].count+"\u79cd\u5361\u724c\u5f00\u542f");break;case 5:if(1==this.StatusReel5);else if(2==this.StatusReel5){this.ReelWork5.children[0].getComponent(h.default).clear(),f.default.setNodeToPool(u.PoolType.MonsterPreview,this.ReelWork5.children[0]),this.ReelWorkList.children[4].children[0].getComponent(cc.Sprite).spriteFrame=this.ReelPic.getSpriteFrame("icon_jzk"),this.ReelWorkList.children[4].children[0].setScale(1),this.ReelWorkList.children[4].children[5].active=!1,this.Di5.active=!1,this.StatusReel5=1,this.reelsArr[this.idIndexArr[parseInt(t)-1]]&&this.reelsArr[this.idIndexArr[parseInt(t)-1]].getComponent("ReelCardInfo").setOut(),this.idIndexArr[parseInt(t)-1]=0}else 3==this.StatusReel5&&l.default.instance.ShowMsg("\u6536\u96c6\u6ee1"+this._configs1.slot[1][3].count+"\u79cd\u5361\u724c\u5f00\u542f")}this.UpdataStatusReel()},t.prototype.UpdataStatusReel=function(){this.Status=[],this.Status.push(this.StatusReel1),this.Status.push(this.StatusReel2),this.Status.push(this.StatusReel3),this.Status.push(this.StatusReel4),this.Status.push(this.StatusReel5)},t.prototype.onGetCardInfo=function(e){for(var t=0,i=0;i<this._configs1.scroll[1].length;i++)this._configs1.scroll[1][i].id==e&&(t=this._configs1.scroll[1][i].param2);return t},t.prototype.onGetCardID=function(e){for(var t=0,i=0;i<this._configs1.scroll[1].length;i++)this._configs1.scroll[1][i].id==e&&(t=this._configs1.scroll[1][i].param1);return t},t.prototype.onGetCardId=function(e){for(var t=0,i=0;i<this._configs1.scroll[1].length;i++)this._configs1.scroll[1][i].param1==e&&(t=this._configs1.scroll[1][i].id);return t},t.prototype.onGetCardType=function(e){for(var t=0,i=0;i<this._configs1.scroll[1].length;i++)this._configs1.scroll[1][i].id==e&&(t=this._configs1.scroll[1][i].type);return t},t.prototype.onOwnScorll=function(e){for(var t=0;t<this.NewScroll.length;t++)if(e==this.NewScroll[t].id)return this.NewScroll[t];return!1},t.prototype.OpenPanl=function(e){var t=e.getUserData();this.Data=t;for(var i=0;i<this._configs1.scroll[1].length;i++)this._configs1.scroll[1][i].param1==t[0]&&this._configs1.scroll[1][i].type},t.prototype.OpenMonsterPanl=function(e){cc.find("Bg/Title2/Label",this.MonsterPanl).getComponent(cc.Label).string=this._configs.Card[e].cardFamilyName;for(var t=cc.find("content/LeftPanl/MonsterLayer",this.MonsterPanl),i=t.childrenCount-1;i>=0;i--){t.children[i].getComponent(h.default).clear(),f.default.setNodeToPool(u.PoolType.MonsterPreview,t.children[i])}d.default.instance.infoPreview(t,cc.v2(0,0),e,this.Data[1],.7,-1),cc.find("content/LeftPanl/CombatPower/value",this.MonsterPanl).getComponent(cc.Label).string=d.default.instance.getCarFight(e,this.Data[2],this.Data[1],!0,null,!1)+"",cc.find("content/LeftPanl/name",this.MonsterPanl).getComponent(cc.Label).string=this._configs.Card[e].cardName,cc.find("content/LeftPanl/level/number",this.MonsterPanl).getComponent(cc.Label).string=this.Data[2]+" ";var n=cc.find("content/LeftPanl/prop",this.MonsterPanl),o=this._configs.Card[e].fiveLineAttributes;n.getComponent(cc.Sprite).spriteFrame=T.default.instance.getSpriteFrameByName("fiveLine_"+o);var a=cc.find("content/LeftPanl/MonsterType",this.MonsterPanl),r=this._configs.Card[e].cardType;a.getComponent(cc.Sprite).spriteFrame=T.default.instance.getSpriteFrameByName("stance_"+r);var s=cc.find("content/LeftPanl/MonsterRarity",this.MonsterPanl),l=this._configs.Card[e].rarity;s.getComponent(cc.Sprite).spriteFrame=T.default.instance.getSpriteFrameByName("rarity_"+l);var c=cc.find("content/UpPanl/gradeImage",this.MonsterPanl),g=this.Data[1];c.getComponent(cc.Sprite).spriteFrame=T.default.instance.getSpriteFrameByName("form_"+g);var y=cc.find("content/UpPanl/gradeImage/gradeText",this.MonsterPanl);5==this.Data[1]?y.getComponent(cc.Label).string=b.default.getStr("Preferential_7"):4==this.Data[1]?y.getComponent(cc.Label).string=b.default.getStr("Preferential_8"):3==this.Data[1]&&(y.getComponent(cc.Label).string=b.default.getStr("Preferential_9")),this.porpData=this._configs.level[this._configs.grade[this._configs.Card[e].grade][this.Data[1]-1].level][this.MaxLevel-1].prop,cc.find("content/UpPanl/Att/HitInfo/number",this.MonsterPanl).getComponent(cc.Label).string=this.porpData[1]+"",cc.find("content/UpPanl/Att/DefenseInfo/number",this.MonsterPanl).getComponent(cc.Label).string=this.porpData[2]+"",cc.find("content/UpPanl/Att/ExpInfo/number",this.MonsterPanl).getComponent(cc.Label).string=this.porpData[0]+"",cc.find("content/UpPanl/Att/RateInfo/number",this.MonsterPanl).getComponent(cc.Label).string=Math.round(100*Math.min((this.porpData[3]+100)/100*.85,1))+"%",cc.find("content/UpPanl/Att/CriticalInfo/number",this.MonsterPanl).getComponent(cc.Label).string=Math.round(100*Math.min(Math.max((this.porpData[5]+100)/100*.05,.05),1))+"%";var m=this._configs.Card[e].skillId,C=d.default.instance.GetMonsterData(e);for(i=0;i<m.length;i++){var v=0,_=p.default.instance.getSkillBySkillId(m[i]),S=cc.find("content/Skill",this.MonsterPanl).children[i],I=_.name;if(d.default.instance.setSkillPic(m[i],cc.find("sp/pic",S).getComponent(cc.Sprite)),I.length>5&&(I=I.substring(0,6)),cc.find("name",S).getComponent(cc.Label).string=I+"",void 0==C);else{for(var w=0;w<C.skill.length;w++)if(m[i]==C.skill[w].id){v=C.skill[w].level;break}var D=p.default.instance.getSkillBySkillId(m[i]);cc.find("level",S).getComponent(cc.Label).string=v+"/"+p.default.instance.skillConfigs.levelConf[D.levelConf].length,S.active=!0}}this.node.insertChild(this.MonsterPanl,this.node.childrenCount)},t.prototype.btn_skillUpgrade=function(e,t){},t.prototype.OpenSkillPanl=function(){cc.find("content/UpPanl/SkilIModel",this.MonsterPanl),cc.find("content/UpPanl/SkillName",this.MonsterPanl),cc.find("content/UpPanl/SkillLevel",this.MonsterPanl),cc.find("content/UpPanl/SkillType",this.MonsterPanl),cc.find("content/DownPanl/desc",this.SkillPanl);this.node.insertChild(this.SkillPanl,this.node.childrenCount)},t.prototype.initTab=function(){var e=this;this.TabBtnList.selectedCallback=this.RefreshList,this.TabBtnList.selectedCallbackThisObj=this,this.scheduleOnce(function(){e.TabBtnList.getComponent("TabBtnList")._delaySelectedIndexTime=0;for(var t=1;t<4;t++)e.TabBtnList.node.children[1].children[t].children[0].children[1].active=!0,e.TabBtnList.node.children[1].children[t].children[1].children[1].active=!0,e.TabBtnList.node.children[1].children[t].children[0].getComponentInChildren(cc.Sprite).spriteFrame=T.default.instance.getSpriteFrameByName("icon_"+t),e.TabBtnList.node.children[1].children[t].children[1].getComponentInChildren(cc.Sprite).spriteFrame=T.default.instance.getSpriteFrameByName("icon_"+t)},.001)},t.prototype.OpenTipsPanl=function(){this.node.insertChild(this.TipsPanl,this.node.childrenCount)},t.prototype.onCloseTipsPanl=function(){this.TipsPanl.removeFromParent(!1)},t.prototype.onCloseMosterPanl=function(){this.MonsterPanl.removeFromParent(!1)},t.prototype.onCloseSkillPanl=function(){this.SkillPanl.removeFromParent(!1)},t.prototype.close=function(){e.prototype.close.call(this);var t={cmd:"scrollequip",list:this.idIndexArr};m.default.instance.sendProto(t),s.MyReelData.curreellist=[];for(var i=0;i<this.idIndexArr.length;i++)0!=this.idIndexArr[i]&&s.MyReelData.curreellist.push(this.idIndexArr[i]);console.log(s.MyReelData.curreellist,"scroll\u4fdd\u5b58\u4e0a\u9635\u5377\u8f74\uff1f"),I.default.instance&&I.default.instance.setReelinfo(),r.default.instance.closeWindow(this.node);for(i=0;i<this.idIndexArr.length;i++){if(this.ReelWorkList.children[i].children[4].childrenCount>0)this.ReelWorkList.children[i].children[4].children[0].getComponent(h.default).clear(),f.default.setNodeToPool(u.PoolType.MonsterPreview,this.ReelWorkList.children[i].children[4].children[0]),this.ReelWorkList.children[i].children[0].getComponent(cc.Sprite).spriteFrame=this.ReelPic.getSpriteFrame("icon_jzk"),this.ReelWorkList.children[i].children[0].setScale(1);this.Status[i]=1}},t.prototype.ScrollScreen=function(e){var t=[],i=this.arry.slice(0);if(0==e){for(var n=0;n<s.MyReelData.curreellist.length;n++)for(var o=0;o<i.length;o++)s.MyReelData.curreellist[n]==i[o].id&&(t.push(i[o]),i.splice(o,1),o--);for(n=0;n<i.length;n++)t.push(i[n]);return t}switch(e){case 1:for(n=0;n<s.MyReelData.curreellist.length;n++)for(o=0;o<i.length;o++)s.MyReelData.curreellist[n]==i[o].id&&5==i[o].param2&&(t.push(i[o]),i.splice(o,1),o--);for(n=0;n<i.length;n++)5==i[n].param2&&t.push(i[n]);break;case 2:for(n=0;n<s.MyReelData.curreellist.length;n++)for(o=0;o<i.length;o++)s.MyReelData.curreellist[n]==i[o].id&&4==i[o].param2&&(t.push(i[o]),i.splice(o,1),o--);for(n=0;n<i.length;n++)4==i[n].param2&&t.push(i[n]);break;case 3:for(n=0;n<s.MyReelData.curreellist.length;n++)for(o=0;o<i.length;o++)s.MyReelData.curreellist[n]==i[o].id&&3==i[o].param2&&(t.push(i[o]),i.splice(o,1),o--);for(n=0;n<i.length;n++)3==i[n].param2&&t.push(i[n])}return t},t.instance=null,__decorate([L(cc.Node)],t.prototype,"ReelWork1",void 0),__decorate([L(cc.Node)],t.prototype,"ReelWork2",void 0),__decorate([L(cc.Node)],t.prototype,"ReelWork3",void 0),__decorate([L(cc.Node)],t.prototype,"ReelWork4",void 0),__decorate([L(cc.Node)],t.prototype,"ReelWork5",void 0),__decorate([L(cc.Node)],t.prototype,"ReelWorkList",void 0),__decorate([L(cc.Node)],t.prototype,"CardList",void 0),__decorate([L(cc.Node)],t.prototype,"TipsPanl",void 0),__decorate([L(cc.Node)],t.prototype,"SkillPanl",void 0),__decorate([L(cc.Node)],t.prototype,"MonsterPanl",void 0),__decorate([L(cc.SpriteAtlas)],t.prototype,"ReelPic",void 0),__decorate([L(g.default)],t.prototype,"TabBtnList",void 0),__decorate([L(w.default)],t.prototype,"lisViewtControl",void 0),t=i=__decorate([N],t)}(n.default);i.default=E,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/ConfigsManager":"ConfigsManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/Window":"Window","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../NetConnect/NetConnet":"NetConnet","../../Util/GrayEffect":"GrayEffect","../../Util/Utils":"Utils","../Commons/ListViewCtrl":"ListViewCtrl","../Commons/MonsterPreview":"MonsterPreview","../Commons/TabBtnList":"TabBtnList","../Item/ItemController":"ItemController","../Scene/Controller/SkillController":"SkillController","../Scene/View/Chapter/FightInfo":"FightInfo","../Tips/OpTipsController":"OpTipsController","../WarTeam/MonsterController":"MonsterController","./ReelCardInfo":"ReelCardInfo","./ReelController":"ReelController","./ReelMode":"ReelMode"}],Refine:[function(e,t,i){"use strict";cc._RF.push(t,"6598co1T9dOZrMwqW58vwXy","Refine"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Item/ItemData"),o=e("../../Item/ItemIcon"),a=e("../../Role/RoleController"),r=e("../../../Global/GlobalValue"),s=e("./EquipCtrl"),l=e("../Attr/AttrNode"),c=e("../../../Core/Language"),d=e("../../Item/ItemModel"),p=e("../../../Core/LoadManager"),h=e("../../../GlobalContext"),u=e("../../../Util/Utils"),f=e("../../../Core/Widget"),g=e("../../../Core/GameEventDispatcher"),y=e("../../../Core/Event"),m=e("../../../Util/RechargeUtils"),C=e("../../../Util/RechargeConst"),v=e("../../Commons/RewardUtils"),_=e("../../Item/ItemController"),b=e("../../Role/RoleStrengthen/RoleStrengthenController"),T=e("../../Role/RoleStrengthen/RoleStrengthenEvent"),S=e("../../../Core/SimpleActionEffect"),I=e("../EquipWin"),w=e("../../Sound/SoundController"),D=e("../../WarTeam/MonsterController"),R=e("../../Tips/TipsWinController"),A=cc._decorator,N=A.ccclass,L=A.property,E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.starImg=null,t.effect=null,t.toggle=null,t._guid=null,t._data=null,t.goldValueColor=[new cc.Color(92,60,52),new cc.Color(255,0,0),new cc.Color(0,202,71)],t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),g.GameEventDispatcher.instance.on(y.EventDefiner.EQUIP_UP_Refine,this.UPRefine,this),g.GameEventDispatcher.instance.on("BagPackInfoChange",this.upShowData,this),g.GameEventDispatcher.instance.on(y.EventDefiner.Card_updataCardInfo,this.upShowData,this)},t.prototype.hide=function(){this._data=null,g.GameEventDispatcher.instance.off(y.EventDefiner.EQUIP_UP_Refine,this.UPRefine,this),g.GameEventDispatcher.instance.off("BagPackInfoChange",this.upShowData,this),g.GameEventDispatcher.instance.off(y.EventDefiner.Card_updataCardInfo,this.upShowData,this),e.prototype.hide.call(this)},t.prototype.UPRefine=function(e){var t=e?e.getUserData():null;t&&t.flag&&w.default.instance.PlayEffect(w.SoundType.upSucceeds),this.upShowData()},t.prototype.setData=function(e){this._guid=e,this.upShowData()},t.prototype.upShowData=function(){this._data=s.default.instance.data.getItemByGuid(this._guid),this._data?this.setInfo(this._data):this.initData()},t.prototype.initData=function(){this.node.getChildByName("notItem").active=!0,this.node.getChildByName("ItemIcon").active=!1,this.node.getChildByName("starNode").active=!1,this.node.getChildByName("attrNode").active=!1;var e=this.node.getChildByName("ProgressBar");e.getComponent(cc.ProgressBar).progress=0;var t=e.getChildByName("node");t.getChildByName("Label1").getComponent(cc.Label).string="0",t.getChildByName("Label2").getComponent(cc.Label).string="/0",this.setItemData(null),this.setGoldVlaue(0)},t.prototype.setInfo=function(e){var t=e.refineLevel>=0?e.refineLevel:0,i=s.default.instance.data.getRefineCfgData(e.id,t)?s.default.instance.data.getRefineCfgData(e.id,t):null;this.setEquip(e),this.setOther(e.refineLevel),this.setAttr(e),this.setProgressBar(e),this.setItemData(i?i.consume:null),this.setGoldVlaue(i?i.consume[2]:0)},t.prototype.setEquip=function(e){var t=!!e;this.node.getChildByName("notItem").active=!t,this.node.getChildByName("ItemIcon").active=t,t&&this.node.getChildByName("ItemIcon").getComponent(o.default).ItemData(e)},t.prototype.setOther=function(e){var t=this.node.getChildByName("starNode");t.active=!0;var i=e>=0?e:0,n=Math.ceil((i+1)/10);i=i%10+1,n<1&&(n=1),t.children[0].getComponent(cc.Sprite).spriteFrame=this.starImg.getSpriteFrame("icon_quality_"+n);for(var o=1;o<t.childrenCount;++o){var a=null;a=o<=i?this.starImg.getSpriteFrame("icon_xingxiing1"):this.starImg.getSpriteFrame("icon_xingxiing2"),t.children[o].getComponent(cc.Sprite).spriteFrame=a}},t.prototype.setAttr=function(e){var t=this.node.getChildByName("attrNode");t.active=!0,u.default.setNodeChildDestoryByUrl(t,h.GlobalContext.Root+"prefab/Equip/attr/AttrNode");var i=e.refineLevel>=0?e.refineLevel:0,n=s.default.instance.data.getRefineCfgData(e.id,i)?s.default.instance.data.getRefineCfgData(e.id,i):null,o=s.default.instance.data.getRefineCfgData(e.id,i+1)?s.default.instance.data.getRefineCfgData(e.id,i+1):null,a=n?n.attr:[];a=D.default.instance.getAttrPrecentByGradeAndType(D.default.instance.data.MorphologicalTag,a);var c=o?o.attr:[];c=D.default.instance.getAttrPrecentByGradeAndType(D.default.instance.data.MorphologicalTag,c),p.default.instance.loadResByType(h.GlobalContext.Root+"prefab/Equip/attr/AttrNode",cc.Prefab,function(e){for(var i in a)if(a[i]>0){var n=u.default.getNodeByUrl(e,h.GlobalContext.Root+"prefab/Equip/attr/AttrNode"),o=[];o.push({type:parseInt(i),value:a[i]}),o.push({type:parseInt(i),value:c[i]?c[i]:a[i]}),n.getComponent(l.default).setData(r.AttrNodeType.TYPE,o),t.addChild(n)}},this)},t.prototype.setProgressBar=function(e){var t=this.node.getChildByName("ProgressBar"),i=e.refineLevel>=0?e.refineLevel:0,n=s.default.instance.data.getRefineCfgData(e.id,i)?s.default.instance.data.getRefineCfgData(e.id,i):null;t.getComponent(cc.ProgressBar).progress=e.refineBless/(n?n.needBless:1);var o=t.getChildByName("node");o.getChildByName("Label1").getComponent(cc.Label).string=e.refineBless+"",o.getChildByName("Label2").getComponent(cc.Label).string="/"+(n?n.needBless:1)},t.prototype.playEffect=function(){this.effect.getComponent(S.default).playById(5,"upSKIllEffect",!1,null,this)},t.prototype.setItemData=function(e){var t=!!e,i=this.node.getChildByName("item");if(i.getChildByName("ItemIcon").active=t,i.getChildByName("itemNum").active=t,t){var a=n.default.creatItem(e[0],1);i.getChildByName("ItemIcon").getComponent(o.default).ItemData(a,!1,null,!0)}var r=e?_.default.instance.getItemNum(e[0]):0,s=e?e[1]:0,l=i.getChildByName("itemNum").getChildByName("node");l.getChildByName("value2").getComponent(cc.Label).string="/"+s;var c=l.getChildByName("value");c.getComponent(cc.Label).string=r+"",c.color=r<s?this.goldValueColor[1]:this.goldValueColor[2]},t.prototype.setGoldVlaue=function(e){var t=this.node.getChildByName("gold").getChildByName("Label");t.getComponent(cc.Label).string=e+"",e<=a.default.instance.GetMyWealth(r.WealthType.Money)?t.color=this.goldValueColor[0]:t.color=this.goldValueColor[1],this.node.getChildByName("btnNode").getChildByName("btn").getComponent(cc.Button).interactable=e>0;var i=this.node.getChildByName("btnNode").getChildByName("btn"),n=0;this._data&&(n=s.default.instance.data.getMaxRefineLevel(this._data.id)),this._data&&this._data.refineLevel==n-1?(i.getComponent(cc.Button).interactable=!1,i.getChildByName("New Label").getComponent(cc.Label).string=c.default.getStr("\u5df2\u6ee1\u7ea7")):(i.getComponent(cc.Button).interactable=!0,i.getChildByName("New Label").getComponent(cc.Label).string=c.default.getStr("\u7cbe \u70bc"))},t.prototype.RefiningEquip=function(){var e=this,t=this._data.refineLevel>=0?this._data.refineLevel:0,i=s.default.instance.data.getRefineCfgData(this._data.id,t);if(!(d.default.getCountByid(i.consume[0])<i.consume[1])||this.toggle.isChecked||I.default.instance.refine)if(this.toggle.isChecked)this.refiningEquipSend();else{if(!this._data)return;var n=this._data.refineLevel>=0?this._data.refineLevel:0,o=s.default.instance.data.getRefineCfgData(this._data.id,n);if(!o)return;m.default.PurchaseItemOrRechage(C.RechargeTypeConst.Prop,o.consume[2],this.callBack1,this,v.RewardType.Coin)}else{I.default.instance.refine=!0;R.default.instance.ShowTips("\u662f\u5426\u5f00\u542f\u81ea\u52a8\u8d2d\u4e70",function(){e.toggle.isChecked=!0},null,null,1,null,null,function(){e.callBack1()})}},t.prototype.callBack1=function(){var e=this._data.refineLevel>=0?this._data.refineLevel:0,t=s.default.instance.data.getRefineCfgData(this._data.id,e);m.default.PurchaseItemOrRechage(C.RechargeTypeConst.Prop,t.consume[1],this.refiningEquipSend,this,t.consume[0])},t.prototype.refiningEquipSend=function(){b.default.instence.setImgState(T.RoleImgType.Refine),s.default.instance.reqRefineEquip(this._data.guid,this.toggle.isChecked)},__decorate([L(cc.SpriteAtlas)],t.prototype,"starImg",void 0),__decorate([L(cc.Node)],t.prototype,"effect",void 0),__decorate([L(cc.Toggle)],t.prototype,"toggle",void 0),t=__decorate([N],t)}(f.default);i.default=E,cc._RF.pop()},{"../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Core/LoadManager":"LoadManager","../../../Core/SimpleActionEffect":"SimpleActionEffect","../../../Core/Widget":"Widget","../../../Global/GlobalValue":"GlobalValue","../../../GlobalContext":"GlobalContext","../../../Util/RechargeConst":"RechargeConst","../../../Util/RechargeUtils":"RechargeUtils","../../../Util/Utils":"Utils","../../Commons/RewardUtils":"RewardUtils","../../Item/ItemController":"ItemController","../../Item/ItemData":"ItemData","../../Item/ItemIcon":"ItemIcon","../../Item/ItemModel":"ItemModel","../../Role/RoleController":"RoleController","../../Role/RoleStrengthen/RoleStrengthenController":"RoleStrengthenController","../../Role/RoleStrengthen/RoleStrengthenEvent":"RoleStrengthenEvent","../../Sound/SoundController":"SoundController","../../Tips/TipsWinController":"TipsWinController","../../WarTeam/MonsterController":"MonsterController","../Attr/AttrNode":"AttrNode","../EquipWin":"EquipWin","./EquipCtrl":"EquipCtrl"}],ReinforcementsController:[function(e,t,i){"use strict";cc._RF.push(t,"fe083ccwRBIob5wUCJA7ywH","ReinforcementsController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Controller"),o=e("../../../Core/ConfigsManager"),a=e("../Manager/SceneManager"),r=e("../../Chapter/GuanqiaController"),s=e("./FightTimeController"),l=e("../../WarTeam/MonsterController"),c=e("./SkillController"),d=e("../Prop/EntityProperty"),p=e("../../../Core/Const/EntityType"),h=e("./FightController"),u=e("../View/FightView"),f=e("../Unit/FightLog"),g=e("../../PlotWin/PlotController"),y=e("../../../GlobalContext"),m=e("../../../Global/GlobalValue"),C=cc._decorator,v=C.ccclass,_=(C.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.intervalDic=null,t.fighttype=0,t}var i;return __extends(t,e),i=t,Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new i,i.instance.init()),this._instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){this.conf=o.ConfigsManager.instance.getConfigs("reinforcements")},t.prototype.checkReinforcements=function(){if(this.playgamesconf=r.default.instance.getGuanqiaPlaygames(a.default.instance.quanqiaId,a.default.instance.games),this.playgamesconf.reinforcements){var e=this.conf.Reinforcements[this.playgamesconf.reinforcements];f.default.log("\u7f13\u52a9\u914d\u7f6e",e),e&&(this.checkFight(e),this.checkTime(e))}},t.prototype.checkFight=function(e){var t=this,i=e.condition1;switch(this.fighttype=0,i){case 1:s.default.instance.setInterval("reinforcements"+i,function(e){a.default.instance.leftFight<e.param&&(t.fighttype=1,t.checkPolt(e),s.default.instance.clearInterval("reinforcements"+i))},this,2==a.default.instance.fightMode?20:30*a.default.instance.fightViewPlayRate,e);break;case 2:a.default.instance.leftFight<e.param&&(this.fighttype=2,this.checkPolt(e))}},t.prototype.checkTime=function(e){var t=this;switch(e.condition2){case 1:s.default.instance.setTimeout("reinforcements"+e.condition2,function(e){s.default.instance.clearTimeout("reinforcements"+e.condition2),e.plot&&t.checkPolt(e)},this,e.param,e)}},t.prototype.checkPolt=function(e){if(e.plot){if(a.default.instance.fightstatus==a.FIGHTSTATUS.FIGHTEND)return;a.default.instance.fightstatus=a.FIGHTSTATUS.NONE,g.default.instance.checkPlot(g.PlotType.SlowTroops,this.comCall,this)}else this.addMonster(e)},t.prototype.comCall=function(){1==this.fighttype?a.default.instance.fightstatus=a.FIGHTSTATUS.FIGHT:a.default.instance.fightstatus=a.FIGHTSTATUS.UPGRADECOM},t.prototype.addMonster=function(e){var t;this.oldPlayRate!=a.default.instance.fightViewPlayRate&&u.default.instance.SetFightViewPlayRate(this.oldPlayRate),f.default.log("\u7f13\u52a9",e),e.selfmonster&&(t=this.conf.monsters[e.selfmonster])&&this.addMonsters(t,!0),e.enemymonster&&(t=this.conf.monsters[e.enemymonster])&&this.addMonsters(t,!1)},t.prototype.addMonsters=function(e,t){for(var i=0,n=e;i<n.length;i++){var o=n[i],a=y.GlobalContext.UIWidth/2,r=-y.GlobalContext.UIHeight/2,s=this.getReinforcementsMonsterAttr(o),l={cardid:o.cardId,grade:o.grade,level:o.level,num:o.num,self:t,x:o.camp?a-o.x:o.x-a,y:r+o.y,attr:s,autoUseSkill:!!o.autousebigskill&&o.autousebigskill,skills:s.skills,reinforcement:!0};f.default.log("\u7f13\u52a9\u602a\u7269",l),h.default.instance.fightingAddActor(l,m.ADD_ACTOR_TYPE.REINFORCEMENTS,null,null,!1)}},t.prototype.getReinforcementsMonsterAttr=function(e){var t=l.default.instance.GetMyTeamAttar(e.cardId,e.level,e.grade,.85),i=(l.default.instance.getCardConfCardType(e.cardId),new d.EntityProperty);i.cardid=e.cardId,i.grade=e.grade,i.type=p.EntityType.enMonster,i.selfMonster=!1;for(var n=c.default.instance.getSkills(i,e.skilllevel),o=0;o<e.prop.length;o++){var a=e.prop[o];t.Push(o,a)}return t.skills=n,t},t.prototype.update=function(){},t._instance=null,t=i=__decorate([v],t)}(n.default));i.default=_,cc._RF.pop()},{"../../../Core/ConfigsManager":"ConfigsManager","../../../Core/Const/EntityType":"EntityType","../../../Core/Controller":"Controller","../../../Global/GlobalValue":"GlobalValue","../../../GlobalContext":"GlobalContext","../../Chapter/GuanqiaController":"GuanqiaController","../../PlotWin/PlotController":"PlotController","../../WarTeam/MonsterController":"MonsterController","../Manager/SceneManager":"SceneManager","../Prop/EntityProperty":"EntityProperty","../Unit/FightLog":"FightLog","../View/FightView":"FightView","./FightController":"FightController","./FightTimeController":"FightTimeController","./SkillController":"SkillController"}],ReplaceWin:[function(e,t,i){"use strict";cc._RF.push(t,"330b2/5UutC0aZLO9e06fQx","ReplaceWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../../Core/ConfigsManager"),a=e("../../Core/GameEventDispatcher"),r=e("../../Core/Event"),s=e("../../NetConnect/NetConnet"),l=e("../../Core/WindowManager"),c=e("../../Core/WindowType"),d=e("../../Core/Language"),p=e("../Item/ItemIcon"),h=e("./equip/EquipCtrl"),u=e("../OpenWin/OpenWinController"),f=e("../Commons/ListViewCtrl"),g=e("../WarTeam/MonsterController"),y=e("../Functionicon/FunctionIconController"),m=e("./Attr/EquipAttrTileNode"),C=e("../Ornament/OrnamentCtrl"),v=e("../../GlobalContext"),_=e("../../Core/LoadManager"),b=e("../../Util/Utils"),T=e("../Tips/EquipTips"),S=e("../Sound/SoundController"),I=e("../../Util/NumberUtil"),w=e("../Tips/TipsWinController"),D=cc._decorator,R=D.ccclass,A=(D.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ChooseIndex=-1,t.allEquipIconList=null,t._cardConfigs=null,t.isCanLoadEquip=void 0,t._buwei=null,t._cardid=null,t._itemFlag=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.start=function(){e.prototype.start.call(this),i.instance=this},t.prototype.show=function(){e.prototype.show.call(this),this._cardConfigs=o.ConfigsManager.instance.getConfigs("cardConf"),a.GameEventDispatcher.instance.on(r.EventDefiner.EQUIP_UP_WEAR,this.upShOW,this),a.GameEventDispatcher.instance.on(r.EventDefiner.Card_updataCardInfo,this.upShOW,this)},t.prototype.hide=function(){this.ChooseIndex=-1,this.allEquipIconList=null,this._cardConfigs=null,this.isCanLoadEquip=void 0,this._buwei=null,this._cardid=null,this._itemFlag=null,l.default.instance.close(c.WindowType.EquipRelpace),a.GameEventDispatcher.instance.off(r.EventDefiner.EQUIP_UP_WEAR,this.upShOW,this),a.GameEventDispatcher.instance.off(r.EventDefiner.Card_updataCardInfo,this.upShOW,this),e.prototype.hide.call(this)},t.prototype.setData=function(e,t,i){void 0===i&&(i=!1),this._cardid=e,this._buwei=t,this._itemFlag=i,this.setLeft(),this.setRight(),this.chooseGrid(null)},t.prototype.upShOW=function(){this.setLeft(),this.setRight(),this.chooseGrid(null)},t.prototype.setLeft=function(){h.default.instance.data.getEquipList(this._cardid,this._itemFlag)[this._buwei]?(this.resetShow(!0),this.setItemInfo()):this.resetShow(!1)},t.prototype.setRight=function(){var e=[];if(this._itemFlag)e=C.default.instance.data.getOrnamentItem(this._buwei);else{var t=this._cardConfigs.Card[this._cardid].cardType;e=h.default.instance.data.getIconList(t,this._buwei)}this.setItemList(e)},t.prototype.setItemList=function(e){if(e.length<30)for(var t=e.length;t<30;++t)e.push(null);this.allEquipIconList=e;var i=this.node.getChildByName("container").getChildByName("rightNode").getChildByName("ListViewCtrl");i.getComponent(f.default).refreshItem=this.updateitem,i.getComponent(f.default).refreshItemThis=this,i.getComponent(f.default).initialize(e),i.getComponent(f.default).scrollToTop()},t.prototype.updateitem=function(e,t){var i=!!this.allEquipIconList[t];e.getChildByName("bg").active=!i,e.getChildByName("equireItem").active=this.getItemwearFlag(this.allEquipIconList[t]),e.getChildByName("ItemIcon").active=i,e.getChildByName("Choose").active=!1,i&&e.getChildByName("ItemIcon").getComponent(p.default).ItemData(this.allEquipIconList[t])},t.prototype.resetShow=function(e){void 0===e&&(e=!1);var t=this.node.getChildByName("container").getChildByName("leftNode");t.getChildByName("itemInfo").active=e,t.getChildByName("btnUnload").active=e;var i=t.getChildByName("itemNode");i.getChildByName("noEquipNode").active=!e,i.getChildByName("ItemIcon").active=e;var n=t.getChildByName("infoNode");n.getChildByName("noNode").active=!e,n.getChildByName("haveNode").active=e},t.prototype.setItemInfo=function(){var e=h.default.instance.data.getEquipList(this._cardid,this._itemFlag)[this._buwei],t=this.node.getChildByName("container").getChildByName("leftNode");t.getChildByName("itemNode").getChildByName("ItemIcon").getComponent(p.default).ItemData(e,!1,null,!1),t.getChildByName("itemNode").getChildByName("ItemIcon").children[0].scale=.75;var i=C.default.instance.data.ornamentFlag(e.id),n=i?c.WindowType.OrnamentUpStage:c.WindowType.UpgradeStage,o="";y.default.instance.checkIsOpenbyWindowtype(n)&&!i&&e.stage>0&&(o=I.NumberUtil.unitsDigitToText(e.stage)+d.default.getStr("rank"));var a=t.getChildByName("itemInfo");a.getChildByName("equipName").getComponent(cc.Label).string=o+e.name;var r=this._cardConfigs.Card[this._cardid].cardType,s=this._itemFlag?C.default.instance.data.cptOrnamentFightTwo(e,r):h.default.instance.data.getEqupFight(e);a.getChildByName("Fight").getChildByName("FightNode").getChildByName("Label").getComponent(cc.Label).string=s+"";var l=h.default.instance.data.getEquipInfoById(e.id),u=a.getChildByName("type");if(u.active=!this._itemFlag,!this._itemFlag){for(var f in l.range)u.getChildByName("img0"+l.range[f]).active=!0;for(var g=0;g<3;++g)l.range[g]?u.getChildByName("img0"+l.range[g]).active=!0:u.getChildByName("img0"+(g+1)).active=!1}this._itemFlag?this.ornamentAttrInfo(e):this.setEqiupAttrInfo(e)},t.prototype.setEqiupAttrInfo=function(e){var t=this.node.getChildByName("container").getChildByName("leftNode").getChildByName("infoNode").getChildByName("haveNode").getChildByName("initInfo").getComponent(cc.ScrollView).content,i=h.default.instance.data.getEquipCfg(),n=h.default.instance.data.getEquipInfoById(e.id);b.default.setNodeChildDestoryByUrl(t,v.GlobalContext.Root+"prefab/Equip/attr/EquipAttrTileNodeTwo");var o={};if(h.default.instance.data.getEquipBaseAttrMap(e.id,o),o=g.default.instance.getAttrPrecentByGradeAndType(1,o),this.setEquipAttr(t,1,o),y.default.instance.checkIsOpenbyWindowtype(c.WindowType.Strengthen)&&e.level>0){o={};var a=h.default.instance.data.getCalculateEquipStrengthenAttr(e.id,e.level);h.default.instance.data.getEquipStrengthenAttr(o,a),o=g.default.instance.getAttrPrecentByGradeAndType(1,o),this.setEquipAttr(t,2,o,e.level)}if(y.default.instance.checkIsOpenbyWindowtype(c.WindowType.Strengthen)&&e.stage>0){var r=i.stage[n.stage][e.stage].randomAttr,s=i.randomAttr[r];o={},h.default.instance.data.getEquipStageAttr(o,s),o=g.default.instance.getAttrPrecentByGradeAndType(1,o),this.setEquipAttr(t,5,o,e.stage+1)}if(e.gem.length>0){if(!e.gem[0]&&!e.gem[1]&&!e.gem[2])return;this.setEquipAttr(t,4,e.gem,null,null,!0,e.id)}if(e.effect&&e.effect.length>0){var l={};for(var d in e.effect)if(e.effect[d]>=0){var p=h.default.instance.data.getEquipEffectAttrCfg(e.effect[d],e.stage);l[p.type]=p.value}this.setEquipAttr(t,6,l,e.stage+1)}},t.prototype.setEquipAttr=function(e,t,i,n,o,a,r){_.default.instance.loadResByType(v.GlobalContext.Root+"prefab/Equip/attr/EquipAttrTileNodeTwo",cc.Prefab,function(s){var l=b.default.getNodeByUrl(s,v.GlobalContext.Root+"prefab/Equip/attr/EquipAttrTileNodeTwo");e.addChild(l),l.getComponent(m.default).setData(t,i,n,o,a,r)},this)},t.prototype.onUnloadEquip=function(e){if(this._itemFlag){var t=h.default.instance.data.getEquipList(this._cardid,this._itemFlag)[this._buwei],i=C.default.instance.data.getOrnamentType(t.id);C.default.instance.reqPeiShiTakeOff(this._cardid,i)}else{var n={cmd:"takeoffequip",id:this._cardid,buwei:this._buwei};s.default.instance.sendProto(n)}},t.prototype.chooseGrid=function(e){var t=this,i=this.node.getChildByName("container").getChildByName("rightNode"),n=i.getChildByName("ItemList").getChildByName("view").getChildByName("content"),o=i.getChildByName("ListViewCtrl"),a=e?o.getComponent(f.default).getItemIndex(e.currentTarget.x,e.currentTarget.y):-1,r=this._cardConfigs.Card[this._cardid].cardType,s=this.allEquipIconList[Number(a)];-1!=a&&s&&(this.isCanLoadEquip=s,u.default.instance.openWindow(c.WindowType.EquipTips,function(){t.isCanLoadEquip.ower!=t._cardid&&(t.isCanLoadEquip.belongcardid,t._cardid);var e=h.default.instance.data.getEquipList(t._cardid,t._itemFlag),i=e[t._buwei]?e[t._buwei]:null;T.default.instance.setData(t.isCanLoadEquip,i,r,t.onLoadEquip,t,d.default.getStr("\u88c5 \u5907"))},this)),n.children[this.ChooseIndex]&&n.children[this.ChooseIndex].getChildByName("Choose")&&(n.children[this.ChooseIndex].getChildByName("Choose").active=!1),this.ChooseIndex=a,n.children[this.ChooseIndex]&&n.children[this.ChooseIndex].getChildByName("Choose")&&(n.children[this.ChooseIndex].getChildByName("Choose").active=!!s)},t.prototype.onClickWearCell=function(){var e=this._cardConfigs.Card[this._cardid].cardType,t=h.default.instance.data.getIconList(e,this._buwei);t&&t.length>0&&(this.isCanLoadEquip=t[0],this.onClickWearEquip())},t.prototype.onClickWearEquip=function(){if(this._itemFlag)C.default.instance.reqPeiShiTakeOn(this._cardid,this.isCanLoadEquip.guid);else{var e={cmd:"takeonequip",id:this._cardid,equipGuid:this.isCanLoadEquip.guid};s.default.instance.sendProto(e)}S.default.instance.PlayEffect(S.SoundType.replaceSucceeds)},t.prototype.onLoadEquip=function(){if(void 0!=this.isCanLoadEquip)if(this.isCanLoadEquip.ower>0){var e=this._cardConfigs.Card[this.isCanLoadEquip.ower].cardFamilyName,t=g.MonsterType.MonsterCardArr[this.isCanLoadEquip.ower].level,i=d.default.getStr("replaceEquip",e+"",t+"");w.default.instance.ShowTips(i,this.onClickWearEquip,this,null,1,null,null,null,null,null,!1)}else this.onClickWearEquip()},t.prototype.ornamentAttrInfo=function(e){var t=this.node.getChildByName("container").getChildByName("leftNode").getChildByName("infoNode").getChildByName("haveNode").getChildByName("initInfo").getComponent(cc.ScrollView).content;b.default.setNodeChildDestoryByUrl(t,v.GlobalContext.Root+"prefab/Equip/attr/EquipAttrTileNodeTwo");var i={};if(C.default.instance.data.getLevelAttr(i,e),i=g.default.instance.getAttrPrecentByGradeAndType(1,i),this.setEquipAttr(t,2,i,e.level),e.stage>0){var n={};C.default.instance.data.getStageAttr(n,e),n=g.default.instance.getAttrPrecentByGradeAndType(1,n),this.setEquipAttr(t,5,n,e.stage)}},t.prototype.getItemwearFlag=function(e){if(!e)return!1;if(C.default.instance.data.ornamentFlag(e.id)){if(e.belongcardid&&e.belongcardid>0)return!0}else if(e.ower&&e.ower>-1)return!0;return!1},t.instance=null,t=i=__decorate([R],t)}(n.default));i.default=A,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/Window":"Window","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../NetConnect/NetConnet":"NetConnet","../../Util/NumberUtil":"NumberUtil","../../Util/Utils":"Utils","../Commons/ListViewCtrl":"ListViewCtrl","../Functionicon/FunctionIconController":"FunctionIconController","../Item/ItemIcon":"ItemIcon","../OpenWin/OpenWinController":"OpenWinController","../Ornament/OrnamentCtrl":"OrnamentCtrl","../Sound/SoundController":"SoundController","../Tips/EquipTips":"EquipTips","../Tips/TipsWinController":"TipsWinController","../WarTeam/MonsterController":"MonsterController","./Attr/EquipAttrTileNode":"EquipAttrTileNode","./equip/EquipCtrl":"EquipCtrl"}],ReportSdkUtils:[function(e,t,i){"use strict";cc._RF.push(t,"cce939b1sJE/bGFntNl8r8Z","ReportSdkUtils"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./SDKUtils"),o=e("../GlobalContext"),a=e("../Module/Role/RoleInfo"),r=cc._decorator,s=r.ccclass,l=(r.property,function(){function e(){this.reportUrl=""}var t;return t=e,Object.defineProperty(e,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),e.prototype.loginPointOut=function(e,t,i,r,s,l,c){if(void 0===t&&(t=""),void 0===i&&(i=""),void 0===r&&(r=""),void 0===s&&(s=!0),void 0===l&&(l=null),void 0===c&&(c=null),this.reportUrl&&""!=this.reportUrl){var d=o.GlobalContext.currentServerData&&o.GlobalContext.currentServerData.server_id?o.GlobalContext.currentServerData.server_id+"":"";a.MyRoleInfo.serverid>0&&(d=a.MyRoleInfo.serverid+"");var p="";n.default.instance.openId&&""!=n.default.instance.openId&&(p=n.default.instance.openId+"");var h=this.reportUrl+"&counter=load&key=3e6d590812e1f1d370c135feeef60f97&data="+n.default.instance.plat_id+"|"+d+"|"+p+"|enter_game|"+e+"|"+t+"|"+i+"|"+n.default.instance.device_id+"|"+r+"|"+n.default.instance.ditch_id+"|"+Math.floor(1e8*Math.random());1==s&&console.log("ReportSdkUtils.pointOut, \u6253\u70b9\u4e0a\u62a5, url= "+h),n.default.instance.sendToHttps(h,l,c,s)}},e.prototype.loginPointOutActivity=function(e,t,i,r,s,l,c){if(void 0===t&&(t=""),void 0===i&&(i=""),void 0===r&&(r=""),void 0===s&&(s=!0),void 0===l&&(l=null),void 0===c&&(c=null),this.reportUrl&&""!=this.reportUrl){o.GlobalContext.currentServerData&&o.GlobalContext.currentServerData.server_id&&o.GlobalContext.currentServerData.server_id;a.MyRoleInfo.serverid>0&&a.MyRoleInfo.serverid+"";n.default.instance.openId&&""!=n.default.instance.openId&&n.default.instance.openId+"",e=encodeURIComponent(e);var d=o.GlobalContext.currentServerData,p=d.pfrom_id+"|"+d.server_id+"|"+n.default.instance.openId+"|"+e+"|"+Math.floor(Date.now()/1e3),h=this.reportUrl+"&counter=actions&env=dev&key=a256e370d8d5fc594f8d74ecddc29457&data="+p;1==s&&console.log("ReportSdkUtils.loginPointOutActivity, \u6253\u70b9\u4e0a\u62a5, url= "+h),n.default.instance.sendToHttps(h,l,c,s)}},e.LoginPointKingdom_1="dot_enter_loginwin",e.LoginPointKingdom_2="dot_sdk_login_suc",e.LoginPointKingdom_3="dot_enter_create_win",e.LoginPointKingdom_4="dot_req_create",e.LoginPointKingdom_5="dot_create_suc",e.LoginPointKingdom_6="dot_req_enter_game",e.LoginPointKingdom_7="dot_enter_game",e=t=__decorate([s],e)}());i.default=l,cc._RF.pop()},{"../GlobalContext":"GlobalContext","../Module/Role/RoleInfo":"RoleInfo","./SDKUtils":"SDKUtils"}],RewardTips:[function(e,t,i){"use strict";cc._RF.push(t,"b4842bA6PRHA63ytOhN7VeW","RewardTips"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../../Util/Utils"),a=e("../Item/ItemIcon"),r=e("../../Core/WindowManager"),s=e("../Sound/SoundController"),l=e("../../GlobalContext"),c=e("../../Core/LoadManager"),d=e("../../Core/GameEventDispatcher"),p=e("../../Core/Event"),h=cc._decorator,u=h.ccclass,f=h.property,g=function(e){function t(){var t=e.call(this)||this;return t.itemListNode=null,t.ScrollView=null,t.itemScrollListContent=null,t.MaskBgNode=null,t.RewardTipsEffectNode=null,t.Effect=null,t.HuodeBG=null,t.baseHeight=260,t.spacing_X=10,t.spacing_Y=10,t.maxCellNum=6,t.cellHeight=120,t.cellWidth=120,t.isPageShow=!1,t.saveReward=[],t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.show=function(){s.default.instance.PlayEffect(s.SoundType.rewardGet),e.prototype.show.call(this)},t.prototype.close=function(){s.default.instance.StopEffectByType(s.SoundType.rewardGet),this.isPageShow=!1,this.saveReward.length>0?this.setShow(this.saveReward.shift()):(r.default.instance.closeWindow(this.node),d.GameEventDispatcher.instance.emit(p.EventDefiner.CardActive),d.GameEventDispatcher.instance.emit(p.EventDefiner.rewardTips_close))},t.prototype.hide=function(){e.prototype.hide.call(this)},t.prototype.setData=function(e){this.saveReward.push(e),this.isPageShow||this.setShow(this.saveReward.shift())},t.prototype.setShow=function(e){var t=this;this.isPageShow=!0;var i=Math.ceil(e.length/this.maxCellNum);this.changeShow(e.length,i-1),o.default.setNodeChildDestoryByUrl(this.itemListNode,l.GlobalContext.Root+"prefab/Bag/ItemIcon"),o.default.setNodeChildDestoryByUrl(this.itemScrollListContent,l.GlobalContext.Root+"prefab/Bag/ItemIcon"),i>3?(this.itemListNode.active=!1,this.ScrollView.active=!0,c.default.instance.loadResByType(l.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(i){for(var n=0;n<e.length;++n){var r=o.default.getNodeByUrl(i,l.GlobalContext.Root+"prefab/Bag/ItemIcon");r.getComponent(a.default).ItemData(e[n],!0,null,!0),t.itemScrollListContent.addChild(r)}},this)):(this.itemListNode.active=!0,this.ScrollView.active=!1,c.default.instance.loadResByType(l.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(i){for(var n=0;n<e.length;++n){var r=o.default.getNodeByUrl(i,l.GlobalContext.Root+"prefab/Bag/ItemIcon");r.getComponent(a.default).ItemData(e[n],!0,null,!0),t.itemListNode.addChild(r)}},this))},t.prototype.changeShow=function(e,t){t>2&&(t=2),this.HuodeBG.height=126*t+300,this.RewardTipsEffectNode.y=126*t/2,this.Effect.y=-169-126*t,this.itemListNode.width=e<6?126*e:756},t.instance=null,__decorate([f(cc.Node)],t.prototype,"itemListNode",void 0),__decorate([f(cc.Node)],t.prototype,"ScrollView",void 0),__decorate([f(cc.Node)],t.prototype,"itemScrollListContent",void 0),__decorate([f(cc.Node)],t.prototype,"MaskBgNode",void 0),__decorate([f(cc.Node)],t.prototype,"RewardTipsEffectNode",void 0),__decorate([f(cc.Node)],t.prototype,"Effect",void 0),__decorate([f(cc.Node)],t.prototype,"HuodeBG",void 0),t=i=__decorate([u],t)}(n.default);i.default=g,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/LoadManager":"LoadManager","../../Core/Window":"Window","../../Core/WindowManager":"WindowManager","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Item/ItemIcon":"ItemIcon","../Sound/SoundController":"SoundController"}],RewardUtils:[function(e,t,i){"use strict";cc._RF.push(t,"a02beGbRBpCApJQ21VjshkB","RewardUtils"),Object.defineProperty(i,"__esModule",{value:!0});var n,o=e("../../Core/ConfigsManager"),a=e("../Item/ItemData"),r=cc._decorator,s=r.ccclass,l=(r.property,function(){function e(){this._configs=null,this._boxConfig=null}var t;return t=e,Object.defineProperty(e,"instance",{get:function(){return t._instance||(t._instance=new t,t._instance.init()),t._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this._configs=o.ConfigsManager.instance.getConfigs("stdrewardconf"),this._boxConfig=o.ConfigsManager.instance.getConfigs("boxconf")},e.prototype.getItemList=function(e){var t=[],i=this._configs.StdReward[e];if(i){var n=this._configs.reward[i.reward];if(n&&n.length>0)for(var o=0;o<n.length;o++){var r=this.getItemId(n[o].type,n[o].id,n[o].count);t.push(a.default.creatItem(Number(r[0]),Number(r[1])))}}return t},e.prototype.getItemListByServerData=function(e){var t=[];if(e&&e.length>0)for(var i=0;i<e.length;i++){var n=this.getItemId(e[i].type,e[i].id,e[i].count);t.push(a.default.creatItem(Number(n[0]),Number(n[1])))}return t},e.prototype.getItemId=function(e,t,i){var o=t,a=i;switch(e){case n.Item:o=t;break;case n.Box:void 0===this._boxConfig.box[t]&&console.warn("\u6ca1\u6709\u914d\u7f6e\u5b9d\u7bb1"+t),o=this._boxConfig.box[t].itemId;break;default:o=e}return[o,a]},e=t=__decorate([s],e)}());i.default=l,function(e){e[e.Item=0]="Item",e[e.Coin=1]="Coin",e[e.Exp=2]="Exp",e[e.Energy=3]="Energy",e[e.Integral=6]="Integral",e[e.Box=7]="Box",e[e.VipExp=8]="VipExp",e[e.Diamond=9]="Diamond",e[e.Honor=10]="Honor",e[e.Point=11]="Point",e[e.Vitality=12]="Vitality"}(n=i.RewardType||(i.RewardType={})),cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../Item/ItemData":"ItemData"}],RewardedCard:[function(e,t,i){"use strict";cc._RF.push(t,"ec27ehBR1ND+5mn7Uw7EgLB","RewardedCard"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/TimeController"),a=e("./CardEffect"),r=e("../../Core/Language"),s=e("../../Core/GameEventDispatcher"),l=e("../../Core/Event"),c=e("./DrawCardConst"),d=e("./DrawCard"),p=e("./DrawController"),h=cc._decorator,u=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cardOneNode=null,t.cardTenNodeList=[],t.MaskBgNode=null,t.positionList=[new cc.Vec2(-455,102),new cc.Vec2(-229,102),new cc.Vec2(1,102),new cc.Vec2(230,102),new cc.Vec2(456,102),new cc.Vec2(-455,-155),new cc.Vec2(-229,-155),new cc.Vec2(1,-155),new cc.Vec2(230,-155),new cc.Vec2(456,-155)],t.bgNode=null,t.interval=null,t.index=0,t.flag=!1,t._modeFlag=!1,t._modeNum=0,t.rewardEffectFun=null,t.bgHeight=0,t.heightList=[580,750],t}return __extends(t,e),t.prototype.onEnable=function(){this.playEffect()},t.prototype.resetShow=function(){this.node.getChildByName("one").active=!1,this.node.getChildByName("ten").active=!1},t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.playEffect=function(){switch(this.resetShow(),p.default.instance.clickType){case c.DrawCardClickType.one:this.rewardEffectFun=this.RewardEffectOne,this.node.getChildByName("one").active=!0,this.cardOneNode.scale=0,this.cardOneNode.opacity=0,this.bgNode=this.node.getChildByName("one").getChildByName("bg"),this.node.getChildByName("one").getChildByName("label").active=!1,this.bgHeight=this.heightList[0];break;case c.DrawCardClickType.ten:this.rewardEffectFun=this.RewardEffecTen,d.default.instance.toggle.isChecked||this.initCrardNode(),this.node.getChildByName("ten").active=!0,this.node.getChildByName("ten").getChildByName("Label").active=!1,this.bgNode=this.node.getChildByName("ten").getChildByName("bg"),this.bgHeight=this.heightList[1]}this.flag=!1,this.bgNode.stopAllActions(),this.RewardBgEffect(this.bgNode)},t.prototype.hide=function(){e.prototype.hide.call(this),this.resetShow(),this.interval&&(o.default.instance.clearInterval(this.interval),this.interval=null),this.MaskBgNode.off(cc.Node.EventType.TOUCH_START,this.onClick,this)},t.prototype.RewardBgEffect=function(e){if(d.default.instance.toggle.isChecked)e.scale=1,this.rewardEffectFun();else{var t=p.default.instance.clickType==c.DrawCardClickType.ten?1.2:1.6;e.scale=0,e.runAction(cc.sequence(cc.scaleTo(.4,t,t),cc.callFunc(function(){e.getChildByName("title").runAction(cc.sequence(cc.scaleTo(.2,1.5,1.5),cc.scaleTo(.2,1,1)))}),cc.scaleTo(.4,1,1),cc.callFunc(this.rewardEffectFun,this)))}},t.prototype.setData=function(e){this._modeNum=e.length,this._modeFlag=!1;for(var t=0;t<e.length;++t)c.DrawCardClickType.ten!=p.default.instance.clickType?this.cardOneNode.getComponent(a.default).setData(e[t]):this.cardTenNodeList[t].getComponent(a.default).setData(e[t])},t.prototype.initCrardNode=function(){for(var e=0;e<this.cardTenNodeList.length;++e)this.cardTenNodeList[e].x=0,this.cardTenNodeList[e].y=0,this.cardTenNodeList[e].opacity=0,this.cardTenNodeList[e].scale=0},t.prototype.RewardEffectOne=function(){var e=this,t=this.node.getChildByName("one").getChildByName("label");this.cardOneNode.stopAllActions(),d.default.instance.toggle.isChecked?(this.cardOneNode.opacity=255,this.cardOneNode.scale=1,this.setText(t),this.onClick()):this.cardOneNode.runAction(cc.spawn(cc.fadeIn(.2),cc.scaleTo(.2,1,1),cc.callFunc(function(){e.setText(t)})))},t.prototype.RewardEffecTen=function(){var e=this,t=this.node.getChildByName("ten").getChildByName("Label");if(d.default.instance.toggle.isChecked){for(var i=0;i<this.cardTenNodeList.length;++i)this.cardTenNodeList[i].scale=1,this.cardTenNodeList[i].opacity=255,this.cardTenNodeList[i].position=this.positionList[i];this.setText(t),this.onClick()}else s.GameEventDispatcher.instance.emit(l.EventDefiner.DrawCard_CardEffect,{flag:!1}),this.index=0,this.interval=o.default.instance.setInterval(function(){e.cardTenNodeList[e.index]?(e.cardTenNodeList[e.index].stopAllActions(),e.cardTenNodeList[e.index].runAction(cc.spawn(cc.fadeIn(.2),cc.scaleTo(.2,1,1),cc.moveTo(.2,e.positionList[e.index]))),e.index+=1):(o.default.instance.clearInterval(e.interval),e.interval=null,e.setText(t),s.GameEventDispatcher.instance.emit(l.EventDefiner.DrawCard_CardEffect,{flag:!0}))},this,250)},t.prototype.setText=function(e){if(e.active=!0,this.setMOde(),this.flag)e.getComponent(cc.Label).string=r.default.getStr("\u70b9\u51fb\u7ee7\u7eed"),this.flag=!1;else{var t=c.DrawCardClickType.ten!=p.default.instance.clickType?r.default.getStr("\u70b9\u51fb\u7ffb\u724c"):r.default.getStr("\u70b9\u51fb\u5168\u90e8\u7ffb\u724c");e.getComponent(cc.Label).string=t,this.MaskBgNode.on(cc.Node.EventType.TOUCH_START,this.onClick,this),this.flag=!0}},t.prototype.setMOde=function(){if(!this._modeFlag){if(c.DrawCardClickType.ten!=p.default.instance.clickType)this.cardOneNode.getComponent(a.default).setMode();else for(var e=0;e<this._modeNum;e++)this.cardTenNodeList[e].getComponent(a.default).setMode();this._modeFlag=!0}},t.prototype.openAll=function(){for(var e=0;e<this.cardTenNodeList.length;++e)this.cardTenNodeList[e].getComponent(a.default).rolloverEffect();var t=this.node.getChildByName("ten").getChildByName("Label");this.setText(t)},t.prototype.onClick=function(){if(this.flag)if(c.DrawCardClickType.ten==p.default.instance.clickType)this.openAll();else{this.cardOneNode.getComponent(a.default).rolloverEffect();var e=this.node.getChildByName("one").getChildByName("label");this.setText(e)}else d.default.instance.RewardPanel()},t.prototype.update=function(e){if(this.flag)switch(p.default.instance.clickType){case c.DrawCardClickType.one:if(this.cardOneNode.getComponent(a.default).getCardFlag()){var t=this.node.getChildByName("one").getChildByName("label");this.setText(t)}}},__decorate([f(cc.Node)],t.prototype,"cardOneNode",void 0),__decorate([f([cc.Node])],t.prototype,"cardTenNodeList",void 0),__decorate([f(cc.Node)],t.prototype,"MaskBgNode",void 0),t=__decorate([u],t)}(n.default);i.default=g,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","./CardEffect":"CardEffect","./DrawCard":"DrawCard","./DrawCardConst":"DrawCardConst","./DrawController":"DrawController"}],RichAvatar:[function(e,t,i){"use strict";cc._RF.push(t,"7a0b11z0gND5qekzYDqkDdy","RichAvatar"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./AvatarBase"),o=e("../Unit/AsyncResObj"),a=e("../../../Global/GlobalValue"),r=function(e){function t(){return e.call(this)||this}return __extends(t,e),Object.defineProperty(t.prototype,"weapon",{get:function(){return this._weapon},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wing",{get:function(){return this._wing},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasWeapon",{get:function(){return!(void 0==this.weapon)},enumerable:!0,configurable:!0}),t.prototype.setPlayRate=function(t){e.prototype.setPlayRate.call(this,t),this.weapon&&(this.weapon.playRate=t),this.wing&&(this.wing.playRate=t)},t.prototype.bodyAnimEndCall=function(){},t.prototype.otherAnimEndCall=function(){this.status>=a.ACTION.FIGHT1&&this.play(a.ACTION.STAND)},t.prototype.play=function(t,i,n){e.prototype.play.call(this,t,i,n),t==a.ACTION.DEAD?(this.weapon&&(this.weapon.node.active=!1),this.wing&&(this.wing.node.active=!1)):(this.weapon&&(this.weapon.node.active=!0,this.weapon.changeAnimAndDir(t,i,n)),this.wing&&(this.wing.node.active=!0,this.wing.changeAnimAndDir(t,i,n),this.changeSwingLayer()))},t.prototype.updateWeapon=function(t,i){if(t>0){if(!this.weapon){var n=new cc.Node;this._weapon=n.addComponent(o.default),this._weapon.completeCallback=e.prototype.bodyAnimEndCall,this._weapon.completeCallbackThisObj=this,this.addChildAtLayer(this.weapon,3)}this.weapon.node.active=!0}else this.weapon&&(this.weapon.node.active=!1)},t.prototype.updateWing=function(t,i){if(t>0){if(!this._wing){var n=new cc.Node;this._wing=n.addComponent(o.default),this._wing.completeCallback=e.prototype.bodyAnimEndCall,this._wing.completeCallbackThisObj=this,this.addChildAtLayer(this.wing,1)}this.wing.node.active=!0,this.changeSwingLayer()}else this.wing&&(this.wing.node.active=!1)},t.prototype.changeSwingLayer=function(){this.wing&&(this.wing.dir==a.DIR.LEFT_DOWN||this.wing.dir==a.DIR.RIGHT_DOWN||this.wing.dir==a.DIR.DOWN?1!=this.wing.layerIndex&&this.wing.changeSelfLayer(1):4!=this.wing.layerIndex&&this.wing.changeSelfLayer(4))},t.prototype.showWeapon=function(e){this.weapon&&(this.weapon.node.active=e,this.weapon.node.active&&this.weapon.changeAnimAndDir(this.body.status,null,this.body.dir))},t.prototype.showWing=function(e){this.wing&&(this.wing.node.active=e,this.wing.node.active&&this.wing.changeAnimAndDir(this.body.status,null,this.body.dir))},t.prototype.clear=function(){this._weapon&&this._weapon.clear(),this._wing&&this._wing.clear(),e.prototype.clear.call(this)},t.prototype.dispose=function(){this._weapon&&(this._weapon.dispose(),this._weapon=null),this._wing&&(this._wing.dispose(),this._wing=null),e.prototype.dispose.call(this)},t}(n.default);i.RichAvatar=r,cc._RF.pop()},{"../../../Global/GlobalValue":"GlobalValue","../Unit/AsyncResObj":"AsyncResObj","./AvatarBase":"AvatarBase"}],RichTextUtils:[function(e,t,i){"use strict";cc._RF.push(t,"96f23AjXd1Ha67KCm2XXvWI","RichTextUtils"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../OpenWin/OpenWinController"),a=e("../Chat/ChatController"),r=e("../../Core/TimeController"),s=cc._decorator,l=s.ccclass,c=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.richText=null,t.imageAtlas=null,t._spriteFrameList=[],t._updateCount=0,t._updateRichTextHandleTime=0,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this),this.updateRichText()},t.clickEventHandle=function(e){if(e&&""!=e){var t=e.substr(1);switch(e.charAt(0)){case"w":o.default.instance.openWindow(Number(t))}}},t.prototype.clear=function(){if(this._spriteFrameList)for(;this._spriteFrameList.length>0;){var e=this._spriteFrameList.shift();e.labelSegment=null,e=null}r.default.instance.clearTimeout(this._updateRichTextHandleTime)},t.prototype.updateRichText=function(){this.clear(),r.default.instance.clearTimeout(this._updateRichTextHandleTime),this._updateRichTextHandleTime=r.default.instance.setTimeout(this.updateRichTextHandle.bind(this),this,100)},t.prototype.updateRichTextHandle=function(){var e=this.richText._labelSegments;if(e&&e.length>0){if(this.imageAtlas=this.richText.imageAtlas,!this.imageAtlas)return;for(var t=this.imageAtlas.getSpriteFrames(),i=0;i<e.length;i++){var n=e[i];if(null!=n.setSpriteFrame){var o=n._spriteFrame.name,a=o.substr(0,o.length-1),s=this.getSpriteFrameLenghtByKey(t,a);s>1&&this._spriteFrameList.push({labelSegment:n,key:a,len:s,currentIndex:1})}}}r.default.instance.clearTimeout(this._updateRichTextHandleTime),this._updateRichTextHandleTime=0},t.prototype.dispose=function(){this.clear(),e.prototype.dispose.call(this)},t.prototype.onDestroy=function(){this.clear(),e.prototype.onDestroy.call(this)},t.prototype.update=function(){this._updateCount++,this._updateCount>1e4&&(this._updateCount=0),this._updateCount%2&&this.updateLabelSegment()},t.prototype.handler=function(e){a.default.instance.setCanClick();var t=this.richText._labelSegments;if(t&&t.length>0)for(var n=0;n<t.length;n++){var o=t[n];if(o._clickHandler&&this.richText._containsTouchLocation(o,e.touch.getLocation())){var r=this.richText.string.match(/event='(.*?)'/g);if(null!=r&&r.length>0){var s=r[r.length-1].match(/event='(.*?)'/)[1];i.clickEventHandle(s)}}}},t.prototype.getSpriteFrameLenghtByKey=function(e,t){var i=0;return e.forEach(function(e){-1!=e.name.search(new RegExp("^"+t+"(\\d)+$"))&&i++}),i},t.prototype.updateLabelSegment=function(){if(this._spriteFrameList&&this._spriteFrameList.length>0)for(var e=0;e<this._spriteFrameList.length;e++){var t=this._spriteFrameList[e],i=t.currentIndex+1;i>t.len&&(i=1),t.currentIndex=i,t.labelSegment.setSpriteFrame(this.imageAtlas.getSpriteFrame(t.key+i))}},__decorate([c(cc.RichText)],t.prototype,"richText",void 0),t=i=__decorate([l],t)}(n.default);i.default=d,cc._RF.pop()},{"../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../Chat/ChatController":"ChatController","../OpenWin/OpenWinController":"OpenWinController"}],RoleAddAttrItem:[function(e,t,i){"use strict";cc._RF.push(t,"eb1f2G7n0NOU4PcmKvwPnlB","RoleAddAttrItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Util/AttrUtil"),a=cc._decorator,r=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.attrIcons=null,t.icon=null,t.attrName=null,t.attrNum=null,t.nowAttr=null,t.updateNum=null,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.hide=function(){e.prototype.hide.call(this)},t.prototype.initData=function(e){var t=o.default.getAttrIconID(e);this.icon.spriteFrame=this.attrIcons.getSpriteFrame("attrIcon_"+t),this.attrName.string=o.default.getAttrName(e)},t.prototype.updateData=function(e,t){this.nowAttr.active=null!=t,null!=t?(this.updateNum.string=t+"",this.attrNum.string=e+""):this.updateNum.string=e+""},__decorate([s(cc.SpriteAtlas)],t.prototype,"attrIcons",void 0),__decorate([s(cc.Sprite)],t.prototype,"icon",void 0),__decorate([s(cc.Label)],t.prototype,"attrName",void 0),__decorate([s(cc.Label)],t.prototype,"attrNum",void 0),__decorate([s(cc.Node)],t.prototype,"nowAttr",void 0),__decorate([s(cc.Label)],t.prototype,"updateNum",void 0),t=__decorate([r],t)}(n.default);i.default=l,cc._RF.pop()},{"../../Core/Widget":"Widget","../../Util/AttrUtil":"AttrUtil"}],RoleAddProductEffectWin:[function(e,t,i){"use strict";cc._RF.push(t,"1eaa7wNcUZDJKuYi3wm/e7v","RoleAddProductEffectWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/WindowManager"),o=e("../../GlobalContext"),a=e("../WarTeam/MonsterController"),r=e("../Commons/MonsterPreview"),s=e("../../Util/Utils"),l=e("../../Core/WindowType"),c=e("../../Core/CommonsResManager"),d=e("../../Global/GlobalValue"),p=e("./RoleController"),h=e("../Commons/CombatValue"),u=e("./RoleAttrItem"),f=e("../../Core/Window"),g=e("./RoleUtils"),y=e("../../Util/UtilsFight"),m=e("../../Core/TimeController"),C=cc._decorator,v=C.ccclass,_=C.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.contents=[],t.prefab=null,t.isCanColse=!1,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.show=function(){var e=this,t=p.default.instance.lv,i=g.RoleUtils.getNowData();this.setData(1,i.modelId,t,g.RoleUtils.getNowAddAttr()),i=g.RoleUtils.getOldData(),this.setData(0,i.modelId,t-1,g.RoleUtils.getOldAddAttr()),this.isCanColse=!1;m.default.instance.setTimeout(function(){e.isCanColse=!0},this,1e3)},t.prototype.setData=function(e,t,i,n){var p,f,g=0==e,m=this.contents[e],C=s.default.getNodeByPool(l.PoolType.MonsterPreview,a.default.instance.MonsterPreview);C.setScale(1),m.getChildByName("model").addChild(C),cc.find("img/rarity",m).getComponent(cc.Sprite).spriteFrame=c.default.instance.getSpriteFrameByName("rarity_"+i);var v=y.default.cptFight(3,n);m.getChildByName("CombatVal").getComponent(h.default).onInit(v),p=m.getChildByName("content");for(var _=0;_<7;_++)f=s.default.getNodeByPool(l.PoolType.RoleAttrItem,this.prefab,o.GlobalContext.Root+"prefab/Role/RoleAttrItem"),p.addChild(f),f.getComponent(u.default).initData(_,g),f.getComponent(u.default).updateData(n[_]);C.getComponent(r.default).init("role",t,1,d.DEFAULTS_SKIN+1+"",d.PRIORITY.MONSTER)},t.prototype.hide=function(){for(var e,t,i=0;i<this.contents.length;i++){t=(e=this.contents[i]).getChildByName("content"),e.getChildByName("model").children[0].getComponent(r.default).clear(),s.default.setNodeToPool(l.PoolType.MonsterPreview,e.getChildByName("model").children[0]);for(var n=t.childrenCount-1;n>=0;n--)s.default.setNodeToPool(l.PoolType.RoleAttrItem,t.children[n])}},t.prototype.close=function(){this.isCanColse&&n.default.instance.closeWindow(this.node)},t.instance=null,__decorate([_([cc.Node])],t.prototype,"contents",void 0),__decorate([_(cc.Prefab)],t.prototype,"prefab",void 0),t=i=__decorate([v],t)}(f.default);i.default=b,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/TimeController":"TimeController","../../Core/Window":"Window","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../../Util/UtilsFight":"UtilsFight","../Commons/CombatValue":"CombatValue","../Commons/MonsterPreview":"MonsterPreview","../WarTeam/MonsterController":"MonsterController","./RoleAttrItem":"RoleAttrItem","./RoleController":"RoleController","./RoleUtils":"RoleUtils"}],RoleAddProductWin:[function(e,t,i){"use strict";cc._RF.push(t,"c8343WmZnpKMKElV4hzIrI2","RoleAddProductWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../GlobalContext"),a=e("../WarTeam/MonsterController"),r=e("../Commons/MonsterPreview"),s=e("../../Util/Utils"),l=e("../../Core/WindowType"),c=e("../../Core/GameEventDispatcher"),d=e("../../Core/Event"),p=e("../../Core/CommonsResManager"),h=e("../../Global/GlobalValue"),u=e("./RoleController"),f=e("./RoleUtils"),g=e("./RoleAddAttrItem"),y=e("../Sound/SoundController"),m=cc._decorator,C=m.ccclass,v=m.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.old=null,t.label1=null,t.label2=null,t.model1=null,t.model2=null,t.rarity1=null,t.rarity2=null,t.img=null,t.star=null,t.labelPow1=null,t.labelPow2=null,t.next=null,t.cont=null,t.full=null,t.add=null,t.icon=null,t.cost=null,t.prefab=null,t.btn=null,t.particle=null,t.toggle=null,t.starPos=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.updateModel=function(){if(!f.RoleUtils.isMaxLv()){var e=f.RoleUtils.getNowData();this.setModel(this.model1,e.modelId,this.label1,e.name),cc.find("MonsterPreview/PreviewBody",this.model1).color=new cc.Color(128,121,121),e=f.RoleUtils.getNextData(),this.setModel(this.model2,e.modelId,this.label2,e.name)}},t.prototype.hideInfo=function(){this.toggle.isChecked=!1},t.prototype.updateData=function(){var e=u.default.instance,t=f.RoleUtils.getNowData();if(!this.cont.childrenCount)for(var i=void 0,n=0;n<7;n++)i=s.default.getNodeByPool(l.PoolType.RoleAddAttrItem,this.prefab,o.GlobalContext.Root+"prefab/Role/RoleAddAttrItem"),this.cont.addChild(i),i.getComponent(g.default).initData(n);var a=f.RoleUtils.getNowAddAttr();if(this.full.active=this.old.active=this.img.active=this.add.active=this.next.active=!1,f.RoleUtils.isMaxLv())if(cc.find("role/now/img",this.node).active=!1,this.setModel(this.model2,t.modelId,this.label2,t.name),this.labelPow1.string=f.RoleUtils.getNowAddPower()+"",this.rarity1.spriteFrame=p.default.instance.getSpriteFrameByName("rarity_"+e.lv),f.RoleUtils.isMaxLvMaxStar()){this.full.active=!0;for(n=0;n<this.cont.childrenCount;n++)this.cont.children[n].getComponent(g.default).updateData(a[n])}else{this.next.active=this.add.active=!0,this.labelPow1.string=f.RoleUtils.getNowAddPower()+"",this.labelPow2.string=f.RoleUtils.getNextAddPower()+"";var r=f.RoleUtils.getNextAddAttr();for(n=0;n<this.cont.childrenCount;n++)this.cont.children[n].getComponent(g.default).updateData(a[n],r[n])}else{this.add.active=this.img.active=this.old.active=this.next.active=!0,this.rarity1.spriteFrame=p.default.instance.getSpriteFrameByName("rarity_"+e.lv),this.rarity2.spriteFrame=p.default.instance.getSpriteFrameByName("rarity_"+(e.lv+1)),this.labelPow1.string=f.RoleUtils.getNowAddPower()+"",this.labelPow2.string=f.RoleUtils.getNextAddPower()+"";for(r=f.RoleUtils.getNextAddAttr(),n=0;n<this.cont.childrenCount;n++)this.cont.children[n].getComponent(g.default).updateData(a[n],r[n])}for(n=0;n<this.star.childrenCount;n++)this.star.children[n].getChildByName("bright").active=n+1<=e.star;this.particle.node.active=!1},t.prototype.setModel=function(e,t,i,n){if(!e.childrenCount){var o=void 0;(o=s.default.getNodeByPool(l.PoolType.MonsterPreview,a.default.instance.MonsterPreview)).setScale(1),e.addChild(o)}var c=e.getComponentInChildren(r.default);c.onShowRoleTitle(null),e==this.model2?(e.scale=u.default.instance.lv+1>=3?.8:1,e.y=u.default.instance.lv+1>=3?-190:-150):(e.scale=u.default.instance.lv>=3?.8:1,e.y=u.default.instance.lv>=3?-150:-100),c.init("role",t,1,h.DEFAULTS_SKIN+1+"",h.PRIORITY.MONSTER),i.string=n},t.prototype.hide=function(){if(cc.find("MonsterPreview/PreviewBody",this.model1)&&(cc.find("MonsterPreview/PreviewBody",this.model1).color=new cc.Color(255,255,255)),this.model1.childrenCount){var e=this.model1.children[0].getComponent(r.default);e.clear(),s.default.setNodeToPool(l.PoolType.MonsterPreview,this.model1.children[0]),(e=this.model2.children[0].getComponent(r.default)).clear(),s.default.setNodeToPool(l.PoolType.MonsterPreview,this.model2.children[0])}if(this.cont.childrenCount)for(var t=this.cont.children.length-1;t>=0;t--)s.default.setNodeToPool(l.PoolType.RoleAddAttrItem,this.cont.children[t]);c.GameEventDispatcher.instance.off(d.EventDefiner.RoleClearUpdate,this.playParticle,this),c.GameEventDispatcher.instance.off(d.EventDefiner.RoleAddProductEffect,this.updateModel,this),c.GameEventDispatcher.instance.off("BagPackInfoChange",this.updateData,this),c.GameEventDispatcher.instance.off("CloseRoleWin",this.hideInfo,this),this.playEffect&&this.stopPlay()},t.prototype.onClickAdd=function(){},t.prototype.playParticle=function(){var e=this;this.particle.resetSystem(),this.particle.node.active=!0,this.particle.node.position=cc.v2(281,-198);var t=u.default.instance.star?u.default.instance.star-1:4;this.playEffect=!0,this.particle.node.runAction(cc.sequence(cc.moveTo(1,cc.v2(this.starPos[t+1].x,this.starPos[t+1].y)),cc.callFunc(function(){e.playEffect=null,e.updateData()})))},t.prototype.stopPlay=function(){y.default.instance.PlayEffect(y.SoundType.upSucceeds),this.updateData(),this.playEffect=null,this.particle.stopSystem(),this.particle.node.stopAllActions()},t.instance=null,__decorate([v(cc.Node)],t.prototype,"old",void 0),__decorate([v(cc.Label)],t.prototype,"label1",void 0),__decorate([v(cc.Label)],t.prototype,"label2",void 0),__decorate([v(cc.Node)],t.prototype,"model1",void 0),__decorate([v(cc.Node)],t.prototype,"model2",void 0),__decorate([v(cc.Sprite)],t.prototype,"rarity1",void 0),__decorate([v(cc.Sprite)],t.prototype,"rarity2",void 0),__decorate([v(cc.Node)],t.prototype,"img",void 0),__decorate([v(cc.Node)],t.prototype,"star",void 0),__decorate([v(cc.Label)],t.prototype,"labelPow1",void 0),__decorate([v(cc.Label)],t.prototype,"labelPow2",void 0),__decorate([v(cc.Node)],t.prototype,"next",void 0),__decorate([v(cc.Node)],t.prototype,"cont",void 0),__decorate([v(cc.Node)],t.prototype,"full",void 0),__decorate([v(cc.Node)],t.prototype,"add",void 0),__decorate([v(cc.Node)],t.prototype,"icon",void 0),__decorate([v(cc.RichText)],t.prototype,"cost",void 0),__decorate([v(cc.Prefab)],t.prototype,"prefab",void 0),__decorate([v(cc.Button)],t.prototype,"btn",void 0),__decorate([v(cc.ParticleSystem)],t.prototype,"particle",void 0),__decorate([v(cc.Toggle)],t.prototype,"toggle",void 0),t=__decorate([C],t)}(n.default);i.default=_,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/MonsterPreview":"MonsterPreview","../Sound/SoundController":"SoundController","../WarTeam/MonsterController":"MonsterController","./RoleAddAttrItem":"RoleAddAttrItem","./RoleController":"RoleController","./RoleUtils":"RoleUtils"}],RoleAttrItem:[function(e,t,i){"use strict";cc._RF.push(t,"34bddxoyfpDML5IziXzOBQE","RoleAttrItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Util/AttrUtil"),a=cc._decorator,r=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.attrIcons=null,t.icon=null,t.attrName=null,t.attrNum=null,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.hide=function(){e.prototype.hide.call(this)},t.prototype.initData=function(e,t){var i=o.default.getAttrIconID(e);this.icon.spriteFrame=this.attrIcons.getSpriteFrame("attrIcon_"+i),this.attrName.string=o.default.getAttrName(e),this.attrNum.node.color=this.attrName.node.color=t?new cc.Color(255,255,255):new cc.Color(255,246,0)},t.prototype.updateData=function(e){this.attrNum.string=e+""},__decorate([s(cc.SpriteAtlas)],t.prototype,"attrIcons",void 0),__decorate([s(cc.Sprite)],t.prototype,"icon",void 0),__decorate([s(cc.Label)],t.prototype,"attrName",void 0),__decorate([s(cc.Label)],t.prototype,"attrNum",void 0),t=__decorate([r],t)}(n.default);i.default=l,cc._RF.pop()},{"../../Core/Widget":"Widget","../../Util/AttrUtil":"AttrUtil"}],RoleClearItem:[function(e,t,i){"use strict";cc._RF.push(t,"bee096MmYZNXpOeu08z/vbA","RoleClearItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Util/AttrUtil"),a=cc._decorator,r=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.attrIcons=null,t.icon=null,t.attrName=null,t.attrNum=null,t.addNum=null,t.tipsbg=null,t}return __extends(t,e),t.prototype.initData=function(e,t){this.addNum.node.active=!1;var i=o.default.getAttrIconID(e);this.icon.spriteFrame=this.attrIcons.getSpriteFrame("attrIcon_"+i),this.attrName.string=o.default.getAttrName(e),this.tipsbg.active=t%2!=0},t.prototype.updateData=function(e){this.attrNum.string=e+""},t.prototype.updateAddNum=function(e,t){this.addNum.node.active=e,e&&(this.addNum.string=t>=0?"+"+t:""+t)},__decorate([s(cc.SpriteAtlas)],t.prototype,"attrIcons",void 0),__decorate([s(cc.Sprite)],t.prototype,"icon",void 0),__decorate([s(cc.Label)],t.prototype,"attrName",void 0),__decorate([s(cc.Label)],t.prototype,"attrNum",void 0),__decorate([s(cc.Label)],t.prototype,"addNum",void 0),__decorate([s(cc.Node)],t.prototype,"tipsbg",void 0),t=__decorate([r],t)}(n.default);i.default=l,cc._RF.pop()},{"../../Core/Widget":"Widget","../../Util/AttrUtil":"AttrUtil"}],RoleClearWin:[function(e,t,i){"use strict";cc._RF.push(t,"269558QwSBOQJzgH/W5TkYn","RoleClearWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/GameEventDispatcher"),a=e("../../Core/Event"),r=e("../Sound/SoundController"),s=e("./RoleController"),l=e("./RoleConst"),c=e("../../Core/Language"),d=e("../../Util/RechargeUtils"),p=e("../../Util/RechargeConst"),h=e("../Commons/RewardUtils"),u=e("../Item/ItemData"),f=e("../../Core/CommonsResManager"),g=e("../Item/ItemModel"),y=e("./RoleUtils"),m=e("../../Core/WindowType"),C=e("../WarTeam/MonsterController"),v=e("../../Util/Utils"),_=e("../Commons/MonsterPreview"),b=e("../../Global/GlobalValue"),T=e("../../GlobalContext"),S=e("./RoleClearItem"),I=e("./RoleStrengthen/RoleStrengthenController"),w=e("./RoleStrengthen/RoleStrengthenEvent"),D=e("../Fight/FightUtils"),R=e("../Scene/Controller/SkillController"),A=e("../Tips/TipsWinController"),N=e("../../Core/TimeController"),L=cc._decorator,E=L.ccclass,B=L.property,M=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rankType=null,t.model=null,t.CombatVal=null,t.illusion=null,t.illusionBtn=null,t.item1=null,t.clearBtn=null,t.icon1=null,t.attrContent=null,t.toggleContainer=null,t.activeCost=null,t.cost1=null,t.power=null,t.addPower=null,t.changeIcon=null,t.nameLabel=null,t.prefab=null,t.skillName=null,t.skillIcon=null,t}return __extends(t,e),t.prototype.show=function(){this.selectionIndex=s.default.instance.selectionIndex,this.toggleContainer.children[this.selectionIndex].getComponent(cc.Toggle).isChecked=!0;var e=110*(this.selectionIndex+1)-500;this.toggleContainer.y=e>=0?e:0,o.GameEventDispatcher.instance.on(a.EventDefiner.RoleClearUpdate,this.successUp,this),this.updateData(!1),this.setModel()},t.prototype.closeTime=function(){this.time&&(N.default.instance.clearInterval(this.time),this.time=null)},t.prototype.successUp=function(){r.default.instance.PlayEffect(r.SoundType.upSucceeds),this.updateData(!0)},t.prototype.setTime=function(){var e=this;this.closeTime(),this.time=N.default.instance.setInterval(function(){for(var t in e.addPower.node.active=e.changeIcon.node.active=!1,e.attrContent.children)e.attrContent.children[t].getComponent(S.default).updateAddNum(!1,null)},this,2e3)},t.prototype.btnSend=function(e,t){var i=this,n=(s.default.instance.roleFaShionData[this.selectionIndex],s.default.instance.nowFashionData[this.selectionIndex]);switch(parseInt(t)){case l.RoleClearBtnType.ShowTips:A.default.instance.ShowTips(c.default.getStr("2006"),function(){i.btnSend(null,l.RoleClearBtnType.ClearSend+"")},this,null,1,null,null,null,null,null,!1,!1,!0);break;case l.RoleClearBtnType.ClearSend:I.default.instence.setImgState(w.RoleImgType.Culture),s.default.instance.reqFshreshuffle(this.selectionIndex);break;case l.RoleClearBtnType.Active:d.default.PurchaseItemOrRechage(p.RechargeTypeConst.Prop,n.needItems.count,function(){s.default.instance.reqFshactive(i.selectionIndex)},this,n.constId);break;case l.RoleClearBtnType.Clear:d.default.PurchaseItemOrRechage(p.RechargeTypeConst.Prop,parseInt(this.cost1.string),this.clearSend,this,h.RewardType.Coin);break;case l.RoleClearBtnType.Illusion:s.default.instance.reqModelIllusion(this.selectionIndex)}},t.prototype.clearSend=function(){this.btnSend(null,l.RoleClearBtnType.ClearSend+"")},t.prototype.initInfo=function(){var e=h.RewardType.Coin,t=s.default.instance.nowFashionData[this.selectionIndex],i=s.default.instance.roleFaShionData[this.selectionIndex],n=u.default.creatItem(e);this.icon1.getComponent(cc.Button).clickEvents[0].customEventData=e+"";var o=T.GlobalContext.ResRoot+"resources/itemicon/"+n.ItemIcon+".png";v.default.setImage(this.icon1,o),this.icon1.scale=.5,this.rankType.spriteFrame=f.default.instance.getSpriteFrameByName("rarity_"+(s.default.instance.qualityStr.indexOf(t.quality)+1)),this.cost1.string=t.getCostMoney(i.cnt)+"",this.isCanClear=i.isCanClear,this.cost1.node.color=this.isCanClear?new cc.Color(48,24,16):new cc.Color(255,0,0)},t.prototype.initLeft=function(){for(var e=0;e<this.toggleContainer.children.length;e++)this.initStateLeft(e),this.setStateLeft(e)},t.prototype.initStateLeft=function(e){var t=this.toggleContainer.children[e],i=s.default.instance.nowFashionData[e];cc.find("Background/name",t).getComponent(cc.Label).string=i.name;var n=u.default.creatItem(i.needItems.id),o=T.GlobalContext.ResRoot+"resources/itemicon/"+n.ItemIcon+".png";v.default.setImage(cc.find("Background/head/icon",t),o),cc.find("Background/head/ItemColor",t).getComponent(cc.Sprite).spriteFrame=f.default.instance.getSpriteFrameByName("bag"+n.colorIndex)},t.prototype.setStateLeft=function(e){var t=this.toggleContainer.children[e],i=s.default.instance.roleFaShionData;cc.find("Background/lv",t).color=i[e]&&i[e].state?new cc.Color(92,60,52):new cc.Color(255,0,0),cc.find("Background/lv",t).getComponent(cc.Label).string=i[e]&&i[e].state?"":c.default.getStr("2000"),cc.find("Background/flag",t).active=i[e].getRed()},t.prototype.setModel=function(){var e=s.default.instance.nowFashionData[this.selectionIndex];s.default.instance.roleFaShionData;if(!this.model.childrenCount){var t=void 0;(t=v.default.getNodeByPool(m.PoolType.MonsterPreview,C.default.instance.MonsterPreview)).setScale(1),this.model.addChild(t)}this.model.scale=this.selectionIndex>=4&&this.selectionIndex<=5?.85:1;var i=this.model.getComponentInChildren(_.default);i.onShowRoleTitle(null),i.init("role",e.modelId,1,b.DEFAULTS_SKIN+1+"",b.PRIORITY.MONSTER),C.default.instance.setSkillPic(e.skillID,this.skillIcon);var n=R.default.instance.getSkillBySkillId(e.skillID);this.skillName.string=n.name},t.prototype.onClickBuff=function(){var e=s.default.instance.nowFashionData[this.selectionIndex].skillID;D.FightUtils.onClickSkill(e)},t.prototype.updateData=function(e){this.closeTime(),e&&this.setTime(),this.initInfo(),this.initLeft();var t,i=s.default.instance.nowFashionData[this.selectionIndex],n=(s.default.instance.roleFaShionData,s.default.instance.roleFaShionData[this.selectionIndex]);if(this.illusionBtn.active=this.illusion.active=this.item1.active=!1,this.clearBtn.getComponent(cc.Button).interactable=!!n.state,this.clearBtn.getChildByName("flag").active=!!n.state&&y.RoleUtils.getTrainTypeRed(this.selectionIndex),n.state)n.isIllusion()?this.illusion.active=!0:this.illusionBtn.active=!0;else{this.item1.active=!0;var o=i.needItems,a=g.default.getCountByid(i.constId);this.activeCost.string=c.default.getStr("2013",i.name,a,o.count),cc.find("activeBtn/flag",this.item1).active=a>=o.count}if(this.power.string=n.nowPower+"",n.rshAttr&&e){this.addPower.node.active=this.changeIcon.node.active=!0;var r=I.default.instence.strengthenData.curGradeFight,l=I.default.instence.strengthenData.befGradeFight,d=(I.default.instence.imgState,Math.abs(r-l));this.addPower.string=d+"";var p="icon_"+(r-l>0?"shangcheng":"xiajian");this.changeIcon.spriteFrame=f.default.instance.getSpriteFrameByName(p)}else this.addPower.node.active=this.changeIcon.node.active=!1;if(!this.attrContent.childrenCount){var h=0;for(var u in n.attr)t=v.default.getNodeByPool(m.PoolType.RoleClearItem,this.prefab,T.GlobalContext.Root+"prefab/Role/RoleClearItem"),this.attrContent.addChild(t),t.getComponent(S.default).initData(parseInt(u),h),h++}var C=!!n.rshAttr,_=0;for(var u in n.attr)t=this.attrContent.children[_],_++,t.getComponent(S.default).updateData(n.attr[u]),t.getComponent(S.default).updateAddNum(C&&e,C&&e?n.rshAttr[u]:null);this.nameLabel.string=i.name},t.prototype.hide=function(){(o.GameEventDispatcher.instance.off(a.EventDefiner.RoleClearUpdate,this.successUp,this),this.model.childrenCount)&&(this.model.children[0].getComponent(_.default).clear(),v.default.setNodeToPool(m.PoolType.MonsterPreview,this.model.children[0]));for(var e=this.attrContent.children.length-1;e>=0;e--)v.default.setNodeToPool(m.PoolType.RoleClearItem,this.attrContent.children[e]);this.closeTime(),this.isCanClear=null},t.prototype.onClickToggle=function(e){var t=parseInt(e.target.name);s.default.instance.roleFaShionData;t!=this.selectionIndex&&(s.default.instance.selectionIndex=this.selectionIndex=t,this.updateData(!1),this.setModel())},__decorate([B(cc.Sprite)],t.prototype,"rankType",void 0),__decorate([B(cc.Node)],t.prototype,"model",void 0),__decorate([B(cc.Node)],t.prototype,"CombatVal",void 0),__decorate([B(cc.Node)],t.prototype,"illusion",void 0),__decorate([B(cc.Node)],t.prototype,"illusionBtn",void 0),__decorate([B(cc.Node)],t.prototype,"item1",void 0),__decorate([B(cc.Node)],t.prototype,"clearBtn",void 0),__decorate([B(cc.Node)],t.prototype,"icon1",void 0),__decorate([B(cc.Node)],t.prototype,"attrContent",void 0),__decorate([B(cc.Node)],t.prototype,"toggleContainer",void 0),__decorate([B(cc.Label)],t.prototype,"activeCost",void 0),__decorate([B(cc.Label)],t.prototype,"cost1",void 0),__decorate([B(cc.Label)],t.prototype,"power",void 0),__decorate([B(cc.Label)],t.prototype,"addPower",void 0),__decorate([B(cc.Sprite)],t.prototype,"changeIcon",void 0),__decorate([B(cc.Label)],t.prototype,"nameLabel",void 0),__decorate([B(cc.Prefab)],t.prototype,"prefab",void 0),__decorate([B(cc.Label)],t.prototype,"skillName",void 0),__decorate([B(cc.Sprite)],t.prototype,"skillIcon",void 0),t=__decorate([E],t)}(n.default);i.default=M,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/RechargeConst":"RechargeConst","../../Util/RechargeUtils":"RechargeUtils","../../Util/Utils":"Utils","../Commons/MonsterPreview":"MonsterPreview","../Commons/RewardUtils":"RewardUtils","../Fight/FightUtils":"FightUtils","../Item/ItemData":"ItemData","../Item/ItemModel":"ItemModel","../Scene/Controller/SkillController":"SkillController","../Sound/SoundController":"SoundController","../Tips/TipsWinController":"TipsWinController","../WarTeam/MonsterController":"MonsterController","./RoleClearItem":"RoleClearItem","./RoleConst":"RoleConst","./RoleController":"RoleController","./RoleStrengthen/RoleStrengthenController":"RoleStrengthenController","./RoleStrengthen/RoleStrengthenEvent":"RoleStrengthenEvent","./RoleUtils":"RoleUtils"}],RoleConst:[function(e,t,i){"use strict";cc._RF.push(t,"1da79HlEkFHSJVnBXGeAXLH","RoleConst"),Object.defineProperty(i,"__esModule",{value:!0}),function(e){e[e.News=0]="News",e[e.Culture=1]="Culture",e[e.AddProduct=2]="AddProduct"}(i.RolePageType||(i.RolePageType={})),function(e){e[e.ShowTips=1]="ShowTips",e[e.ClearSend=2]="ClearSend",e[e.SetEject=3]="SetEject",e[e.Active=4]="Active",e[e.Clear=6]="Clear",e[e.Illusion=7]="Illusion"}(i.RoleClearBtnType||(i.RoleClearBtnType={})),cc._RF.pop()},{}],RoleController:[function(e,t,i){"use strict";cc._RF.push(t,"1185e3nvj9AQK8xgIUN+jwc","RoleController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../Core/GameEventDispatcher"),a=e("../../Core/Event"),r=e("./RoleInfo"),s=e("../Login/LoginController"),l=e("../../Global/GlobalValue"),c=e("../Tips/OpTipsController"),d=e("../../Core/WindowType"),p=e("../Scene/Upgrading/RoleUpgrading"),h=e("../WarTeam/MonsterController"),u=e("../../Core/ConfigsManager"),f=e("../OpenWin/OpenWinController"),g=e("../Scene/Controller/SceneController"),y=e("../Artifact/ArtifactCtrl"),m=e("../../Core/Language"),C=e("../Item/ItemController"),v=e("../Shop/ShopController"),_=e("../Guide/GuideNewController"),b=e("../../GlobalContext"),T=e("./RoleFashionVo"),S=e("./RoleConst"),I=e("./RoleFaShionData"),w=e("./RoleUtils"),D=e("../../Util/ReportSdkUtils"),R=e("./RoleNeedItemVo"),A=e("../Scene/Controller/SkillController"),N=e("../Scene/Controller/FightController"),L=e("../Status/StatusType"),E=e("./RoleSkillVo"),B=e("../Commons/WindowOpenUtils"),M=e("../../Util/SDKUtils"),x=cc._decorator,k=x.ccclass,P=(x.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.RoleFigh=0,t.grailvaule=0,t.grailInfo=[],t.expAgo=0,t.nowFashionData=[],t.needItems={},t.roleFaShionData=[],t.qualityStr=["C","B","A","S","SS","SSS"],t.isInit=!1,t.constData=[d.WindowType.RoleWin,d.WindowType.RoleTrain,d.WindowType.RoleGpUp],t.selectionIndex=0,t.qualityData={},t.pageIndex=S.RolePageType.News,t.lv=null,t.star=5,t.isMaxLv=!1,t.clickSkillId=601,t.config={},t.serSkillData={},t}var i;return __extends(t,e),i=t,t.prototype.setIsClickBuff=function(e){this.isClickMyBuff=e},t.prototype.setSelectionIndex=function(e){for(var t=0;t<this.nowFashionData.length;t++)if(this.nowFashionData[t].constId==e){this.selectionIndex=t,B.default.instance.openWindowType(d.WindowType.RoleTrain);break}},t.prototype.onLoad=function(){if(e.prototype.onLoad.call(this),s.default._instance?this.sendToLogin():(console.log("\u672a\u767b\u5f55\uff0c\u5207\u6362Enter"),cc.director.loadScene("Enter")),i.instance=this,this.config=u.ConfigsManager.instance.getConfigs("RoleDevelopConf"),this.config){var t=void 0,n=this.config.needItem;for(var o in n)this.needItems[o]=new R.RoleNeedItemVo(n[o]);for(var o in n=this.config.fashionConf)t=new T.RoleFashionVo(n[o]),this.nowFashionData.push(t)}},t.prototype.setClickSkillId=function(e){this.clickSkillId=e},t.prototype.getSkillIdData=function(){return this.isClickMyBuff?this.mySkill:N.default.instance.foeSkillFaShion},t.prototype.getSkillData=function(){return A.default.instance.getSkillBySkillId(this.clickSkillId)},t.prototype.getReserveNum=function(){var e=0;for(var t in this.nowFashionData)this.nowFashionData[t].addStepNum&&1==this.roleFaShionData[t].state&&(e+=this.nowFashionData[t].addStepNum);return e},t.prototype.getMonsterReserveNum=function(){var e=0;for(var t in this.nowFashionData)this.nowFashionData[t].addRetainNum&&1==this.roleFaShionData[t].state&&(e+=this.nowFashionData[t].addRetainNum);return e},t.prototype.setActiveAttr=function(){for(var e in N.default.instance.myFaShionAttr=[],this.mySkill=[],this.nowFashionData)this.nowFashionData[e].attrType&&1==this.roleFaShionData[e].state&&(N.default.instance.myFaShionAttr=N.default.instance.myFaShionAttr.concat(this.nowFashionData[e].attrType)),1==this.roleFaShionData[e].state&&this.mySkill.push(this.nowFashionData[e].skillID)},t.prototype.sendToLogin=function(){this.sendProto({cmd:"login"}),D.default.instance.loginPointOut(D.default.LoginPointKingdom_6),console.log("\u53d1\u9001\u89d2\u8272\u767b\u5f55\u534f\u8bae login")},t.prototype.listNotification=function(){this.addProto("init",this.InitRoleInfo,this),this.addProto("propchange",this.PropChangeRoleInfo,this),this.addProto("attr",this.AttributeValue,this),this.addProto("battlecardattr",this.AttrCard,this),this.addProto("grailinfo",this.Grailinfo,this),this.addProto("graillevelupret",this.GrailLeven,this),this.addProto("fshinfo",this.setFashionInitInfo,this),this.addProto("fshchange",this.setFashionInfo,this),this.addProto("fshsetmodel",this.setFashionModel,this),this.addProto("skills",this.setSkills,this),this.addProto("skillinfo",this.setSkillInfo,this),this.addProto("useskillresult",this.setSkillresult,this),this.addProto("fshseticon",this.setFshsetIcon,this),this.addProto(a.EventDefiner.ARTIFACT_ATFCURSKILL_ID,this.resatfsetskill,this)},t.prototype.setFshsetIcon=function(e){r.MyRoleInfo.icon=e.icon,this.iconIndex=e.iconIndex,this.chooseIndex=e.iconIndex,this.isInit&&c.default.instance.ShowMsg(m.default.getStr("2024")),o.GameEventDispatcher.instance.emit(a.EventDefiner.RoleSetUpDate)},t.prototype.resatfsetskill=function(e){var t=y.default.instance.getData();t.skillIdx=e.idx,t.viceSkillIdx=e.vice_idx,t.illusionSkillId=e.skillId,o.GameEventDispatcher.instance.emit(a.EventDefiner.ARTIFACT_SKILL)},t.prototype.setSkillresult=function(e){if(e.status){var t=this.serSkillData[e.id];N.default.instance.myRoleUseSkill(t.skillid,t.skilllv)}},t.prototype.setSkills=function(e){var t=e.skills;for(var i in this.serSkillData={},t)this.serSkillData[t[i].id]=new E.RoleSkillVo(t[i]);this.setRoleAttr()},t.prototype.setSkillInfo=function(e){var t=e.skill;this.serSkillData[t.id].updateData(t),this.setRoleAttr()},t.prototype.setRoleAttr=function(){r.MyRoleInfo.attr.setSkills(this.serSkillData),o.GameEventDispatcher.instance.emit(a.EventDefiner.Fight_BigSkill_Update)},Object.defineProperty(t.prototype,"canUseSkill",{get:function(){var e=y.default.instance.getData(),t=this.serSkillData[e.illusionSkillId].data[L.ActivityStatus.value];return null==t||t==e.skillIdsData[e.illusionSkillId].skillCD},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canUseSkillNum",{get:function(){var e=y.default.instance.getData();return this.serSkillData[e.illusionSkillId].data[L.ActivityStatus.value]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canUseSkillCd",{get:function(){var e=y.default.instance.getData();return e.skillIdsData[e.illusionSkillId].skillCD},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"overSkillNum",{get:function(){var e=y.default.instance.getData();return e.skillIdsData[e.illusionSkillId].skillCD-this.serSkillData[e.illusionSkillId].data[L.ActivityStatus.value]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"artifact",{get:function(){var e=y.default.instance.getData();return[e.skillIdx,e.viceSkillIdx]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"artfactList",{get:function(){return y.default.instance.getData().artifactInfo},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"artfactConf",{get:function(){return y.default.instance.getData().cfg},enumerable:!0,configurable:!0}),t.prototype.setFashionInitInfo=function(e){var t=e.data;null!=t.iconIndex&&(this.iconIndex=t.iconIndex,this.chooseIndex=t.iconIndex),this.roleFaShionData=[];for(var i=0;i<t.suit.length;i++)this.roleFaShionData.push(new I.RoleFaShionData(t.suit[i],i));if(!this.clearState){this.clearState=[];for(i=0;i<this.roleFaShionData.length;i++)this.clearState.push(!0)}o.GameEventDispatcher.instance.emit(a.EventDefiner.RoleClearUpdate),r.MyRoleInfo.currentsurface=t.model,o.GameEventDispatcher.instance.emit(a.EventDefiner.SkillChange),w.RoleUtils.setRed(),this.setActiveAttr()},t.prototype.setFashionInfo=function(e){this.roleFaShionData&&(this.roleFaShionData[e.idx].updateData(e.suit),o.GameEventDispatcher.instance.emit(a.EventDefiner.RoleClearUpdate),w.RoleUtils.setRed(),this.setActiveAttr())},t.prototype.setFashionModel=function(e){r.MyRoleInfo.currentsurface=e.model,o.GameEventDispatcher.instance.emit(a.EventDefiner.SkillChange),o.GameEventDispatcher.instance.emit(a.EventDefiner.RoleClearUpdate)},t.prototype.IsOpenWuxingPeiyang=function(){y.default.instance.getData().artifactInfo;return!1},t.prototype.RoleUpgrading=function(e){return void 0===e&&(e=!1),!!h.MonsterType.oldRoleInfo&&(r.MyRoleInfo.level>1&&r.MyRoleInfo.level!=h.MonsterType.oldRoleInfo.level?(f.default.instance.openWindow(d.WindowType.RoleUpgrading,function(){for(var t in p.default.instance.initInfo(h.MonsterType.oldRoleInfo,e),h.MonsterType.oldRoleInfo)h.MonsterType.oldRoleInfo[t]=r.MyRoleInfo[t]},this),!0):(o.GameEventDispatcher.instance.emit(a.EventDefiner.FunOpenEvent,e),!1))},t.prototype.InitRoleInfo=function(e){for(var t in e)"cmd"!=t&&(r.MyRoleInfo[t]=e[t]);if(r.MyRoleInfo.sex=e.gender,r.MyRoleInfo.name=e.name,r.MyRoleInfo.money=e.money,r.MyRoleInfo.diamond=e.diamond,r.MyRoleInfo.energy=e.energy,r.MyRoleInfo.exp=e.exp,r.MyRoleInfo.level=e.level,r.MyRoleInfo.prop=e.element,r.MyRoleInfo.icon=e.icon,r.MyRoleInfo.id=e.id,r.MyRoleInfo.serverid=e.srvid,r.MyRoleInfo.vipLevel=e.vipLevel,b.PlayerData.actorid=e.id,r.MyRoleInfo.nameChangeCnt=e.changeNameCnt,this.expAgo=e.exp,console.log("\u521d\u59cb\u5316\u89d2\u8272\u4fe1\u606f, MyRoleInfo: ",r.MyRoleInfo),!this.nowFashionData[0].modelId){this.config.model;for(var i=0;i<this.nowFashionData.length;i++)this.nowFashionData[i].setModelId(this.nowFashionData[i].model[r.MyRoleInfo.sex])}o.GameEventDispatcher.instance.emit(a.EventDefiner.InitPlayerInfo),this.RoleUpgrading(),_.default.instance.checkOnline(),D.default.instance.loginPointOut(D.default.LoginPointKingdom_7),M.default.instance.platformSdk.notifyroleInfo()},t.prototype.Grailinfo=function(e){this.grailInfo=e.data.cups,o.GameEventDispatcher.instance.emit("GRAIL",this),o.GameEventDispatcher.instance.emit("GRAILINFO",this),o.GameEventDispatcher.instance.emit(a.EventDefiner.InitPlayerInfo,this)},t.prototype.GrailLeven=function(e){this.grailvaule=e.value,o.GameEventDispatcher.instance.emit("VAULE",this)},t.prototype.PropChangeRoleInfo=function(e){this.setRoleInfo(e),w.RoleUtils.setRed()},t.prototype.setRoleInfo=function(e){switch(console.log("\u57fa\u672c\u4fe1\u606f\u6539\u53d8",e.propery,e.value),"exp"==e.propery&&(this.expAgo=r.MyRoleInfo.exp),r.MyRoleInfo[e.propery]=e.value,e.propery){case r.RoleInfoKey.money:r.MyRoleInfo.money=e.value,o.GameEventDispatcher.instance.emit(a.EventDefiner.PlayerMoneyChange);break;case r.RoleInfoKey.diamond:r.MyRoleInfo.diamond=e.value,o.GameEventDispatcher.instance.emit(a.EventDefiner.PlayerMoneyChange);break;case r.RoleInfoKey.honor:r.MyRoleInfo.honor=e.value,o.GameEventDispatcher.instance.emit(a.EventDefiner.PlayerMoneyChange);break;case r.RoleInfoKey.point:r.MyRoleInfo.point=e.value,o.GameEventDispatcher.instance.emit(a.EventDefiner.PlayerMoneyChange);break;case r.RoleInfoKey.energy:r.MyRoleInfo.energy=e.value,o.GameEventDispatcher.instance.emit(a.EventDefiner.PowerChange);break;case r.RoleInfoKey.exp:r.MyRoleInfo.exp=e.value,o.GameEventDispatcher.instance.emit(a.EventDefiner.ExpChange),o.GameEventDispatcher.instance.emit("CHAPTERNOTENTER",this);break;case r.RoleInfoKey.level:r.MyRoleInfo.level=e.value,o.GameEventDispatcher.instance.emit(a.EventDefiner.LevelChange),g.default.instance.scenestatus!=l.GameScene.Fight&&this.RoleUpgrading();break;case r.RoleInfoKey.rolename:r.MyRoleInfo.name=e.value,o.GameEventDispatcher.instance.emit("RoleNameChange",this);break;case r.RoleInfoKey.nameChangeCnt:r.MyRoleInfo.nameChangeCnt=e.value}},t.prototype.AttributeValue=function(e){for(var t in r.MyRoleInfo.attribute=e.attr,r.MyRoleInfo.maxHp=e.attr[l.AttrType.MaxHp],r.MyRoleInfo.attack=e.attr[l.AttrType.Attack],r.MyRoleInfo.defence=e.attr[l.AttrType.Defence],r.MyRoleInfo.critical=e.attr[l.AttrType.Critical],r.MyRoleInfo.hit=e.attr[l.AttrType.Hit],h.MonsterType.oldRoleInfo||(h.MonsterType.oldRoleInfo={level:r.MyRoleInfo.level,maxHp:r.MyRoleInfo.maxHp,attack:r.MyRoleInfo.attack,defence:r.MyRoleInfo.defence}),e.attr)r.MyRoleInfo.attr.ChangeAtt(parseInt(t),e.attr[t]);console.log("\u4eba\u7269\u5c5e\u6027\uff1aMyRoleInfo.attr",e),this.RoleFigh=r.MyRoleInfo.attr.GetFight(),o.GameEventDispatcher.instance.emit(a.EventDefiner.AttributeChange)},t.prototype.AttrCard=function(e){console.log(e)},t.prototype.onSetOldExp=function(){this.expAgo=r.MyRoleInfo.exp},t.prototype.GetMyWealth=function(e){var t=0,i=null;switch(e){case l.WealthType.Money:i=r.MyRoleInfo.money;break;case l.WealthType.Diamond:i=r.MyRoleInfo.diamond;break;case l.WealthType.Honor:i=r.MyRoleInfo.honor;break;case l.WealthType.Integral:i=r.MyRoleInfo.point;break;case l.WealthType.Energy:i=r.MyRoleInfo.energy;break;case l.WealthType.Equip:i=C.default.instance.getItemNum(v.default.instance.chipid);break;case l.WealthType.SoulCard:i=C.default.instance.getItemNum(v.default.instance.soulCard)}return i&&(t=Number(i)),t},t.prototype.CheckMyWealthIsEnough=function(e,t,i){return void 0===i&&(i=!0),this.GetMyWealth(e)>=t||(i&&c.default.instance.ShowMsg(m.default.getStr("not_enough_"+e)+" \u4e0d\u8db3"),!1)},t.prototype.getModelConfByModelId=function(e){var t=this.config.model[e];return t||console.error("\u6ca1\u6709\u6a21\u578b\u8868"+e),t},t.prototype.getModelAtkEfcByModelId=function(e){var t=this.config.atkEffect[this.getModelConfByModelId(e).atkEffect];return t||console.error("\u6ca1\u6709\u6a21\u578b\u653b\u51fb\u7c7b\u578b"+e),t},t.prototype.GetEXPAdd=function(){var e=0,t=r.MyRoleInfo.level;return 1e3-t>=5&&(e=.05*(1e3-t)/2),e},t.prototype.reqModelQuality=function(e){var t={cmd:"fshstartup",index:this.lv-1,isAutoBuy:e};this.sendProto(t)},t.prototype.reqFshreshuffle=function(e){var t={cmd:"fshreshuffle",idx:e};this.sendProto(t),this.clearState[e]=!1},t.prototype.reqModelIllusion=function(e){var t={cmd:"fshsetmodel",idx:e};this.sendProto(t)},t.prototype.reqFshactive=function(e){var t={cmd:"fshactive",idx:e};this.sendProto(t)},t.prototype.reqModelReplace=function(e){var t={cmd:"fshreplace",idx:e};this.sendProto(t)},t.prototype.roleSetUpReq=function(){this.isInit||(this.isInit=!0);var e={cmd:"fshseticon",idx:this.chooseIndex};this.sendProto(e)},t.instance=null,t=i=__decorate([k],t)}(n.default));i.default=P,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/ReportSdkUtils":"ReportSdkUtils","../../Util/SDKUtils":"SDKUtils","../Artifact/ArtifactCtrl":"ArtifactCtrl","../Commons/WindowOpenUtils":"WindowOpenUtils","../Guide/GuideNewController":"GuideNewController","../Item/ItemController":"ItemController","../Login/LoginController":"LoginController","../OpenWin/OpenWinController":"OpenWinController","../Scene/Controller/FightController":"FightController","../Scene/Controller/SceneController":"SceneController","../Scene/Controller/SkillController":"SkillController","../Scene/Upgrading/RoleUpgrading":"RoleUpgrading","../Shop/ShopController":"ShopController","../Status/StatusType":"StatusType","../Tips/OpTipsController":"OpTipsController","../WarTeam/MonsterController":"MonsterController","./RoleConst":"RoleConst","./RoleFaShionData":"RoleFaShionData","./RoleFashionVo":"RoleFashionVo","./RoleInfo":"RoleInfo","./RoleNeedItemVo":"RoleNeedItemVo","./RoleSkillVo":"RoleSkillVo","./RoleUtils":"RoleUtils"}],RoleFaShionData:[function(e,t,i){"use strict";cc._RF.push(t,"312ddsqIOdJvbPEpsmAIrtd","RoleFaShionData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./RoleController"),o=e("./RoleInfo"),a=e("../Item/ItemModel"),r=e("../Commons/RewardUtils"),s=function(){function e(e,t){this.index=t,this.updateData(e)}return e.prototype.isIllusion=function(){return n.default.instance.nowFashionData[this.index].modelId==o.MyRoleInfo.currentsurface},e.prototype.updateData=function(e){for(var t in e)this[t]=e[t];this.isUpper=this.cnt==n.default.instance.nowFashionData[this.index].needMoney.length-1},Object.defineProperty(e.prototype,"powerAdd",{get:function(){return o.MyRoleInfo.attr.TempCalCurrentFight(this.rshAttr,!1)-o.MyRoleInfo.Fight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nowPower",{get:function(){return o.MyRoleInfo.Fight-o.MyRoleInfo.attr.TempCalCurrentFight(this.attr,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCanClear",{get:function(){return n.default.instance.nowFashionData[this.index].getCostMoney(this.cnt)<=a.default.getCountByid(r.RewardType.Coin)},enumerable:!0,configurable:!0}),e.prototype.getRed=function(){return n.default.instance.clearState[this.index]&&this.isCanClear&&!this.isFull()&&(this.isCanActive()||this.state&&!this.isUpper)},e.prototype.isCanActive=function(){return!this.state&&n.default.instance.nowFashionData[this.index].getCanActive()},e.prototype.isFull=function(){var e=n.default.instance.nowFashionData[this.index].attrAny,t=!0;for(var i in this.attr)if(e[i]!=this.attr[i]){t=!1;break}return t},e}();i.RoleFaShionData=s,cc._RF.pop()},{"../Commons/RewardUtils":"RewardUtils","../Item/ItemModel":"ItemModel","./RoleController":"RoleController","./RoleInfo":"RoleInfo"}],RoleFashionVo:[function(e,t,i){"use strict";cc._RF.push(t,"91c9cXA3thNN4Vcolxl4cSC","RoleFashionVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./RoleController"),o=e("../Item/ItemModel"),a=e("../Commons/RewardUtils"),r=function(){function e(e){for(var t in e)this[t]=e[t];this.needItems=n.default.instance.needItems[this.needItem],this.attrAny=n.default.instance.config.attr[this.attr],this.constId=this.needItems.type!=a.RewardType.Item?this.needItems.type:this.needItems.id}return e.prototype.setModelId=function(e){this.modelId=e,this.iconUrl=this.icon.split(",")[this.model.indexOf(this.modelId)]},e.prototype.getCostMoney=function(e){return this.needMoney[e]?this.needMoney[e]:this.needMoney[this.needMoney.length-1]},e.prototype.getCanActive=function(){return o.default.getCountByid(this.constId)>=this.needItems.count},e}();i.RoleFashionVo=r,cc._RF.pop()},{"../Commons/RewardUtils":"RewardUtils","../Item/ItemModel":"ItemModel","./RoleController":"RoleController"}],RoleFightChange:[function(e,t,i){"use strict";cc._RF.push(t,"b238ak/OchI6b8LH5U7GSjR","RoleFightChange"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../GlobalContext"),a=e("./RoleStrengthenController"),r=e("../../../Core/TimeController"),s=e("../../Commons/Image"),l=e("./RoleStrengthenEvent"),c=cc._decorator,d=c.ccclass,p=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.labelCombat=null,t.layerAdd=null,t.layerReduce=null,t.labelAdd=null,t.labelReduce=null,t.layerContent=null,t.img=null,t.imgContent=null,t.content=null,t._interval=0,t._isAdd=!0,t._intervalTimer=0,t._delayTimer=0,t._initNum=0,t._changeLabel=null,t._oldFight=0,t._curFight=0,t}return __extends(t,e),t.prototype.onInit=function(){this.onClearTimer(),this._interval=0,this._isAdd=!0,this._intervalTimer=0,this._initNum=0},t.prototype.show=function(){e.prototype.show.call(this),this.content.opacity=0,this.content.y=-o.GlobalContext.UIHeight/2-135,this.onInit(),this.onShowEffect(!0),this.onShowFightChange(),o.PlayerData.TipsLayer.insertChild(this.node,999)},t.prototype.onDisable=function(){this.onEffectFinish(),e.prototype.onDisable.call(this),this.onInit()},t.prototype.onClearTimer=function(){r.default.instance.clearTimeout(this._delayTimer),r.default.instance.clearInterval(this._intervalTimer)},t.prototype.onShowEffect=function(e){if(e)this.content.runAction(cc.spawn(cc.moveBy(.3,0,400),cc.fadeTo(.3,255)));else{var t=cc.callFunc(function(e){this.onEffectFinish()},this);this.content.runAction(cc.sequence(cc.spawn(cc.moveBy(.3,0,400),cc.fadeTo(.3,0)),t))}},t.prototype.onEffectFinish=function(){this.node.parent&&this.node.parent.active&&this.node.removeFromParent()},t.prototype.onShowFightChange=function(){var e=this;this.onClearTimer(),this._curFight=a.default.instence.strengthenData.curGradeFight,this._oldFight=a.default.instence.strengthenData.befGradeFight;var t=a.default.instence.imgState;this._isAdd=this._curFight>this._oldFight,this._interval=Math.abs(this._curFight-this._oldFight),this._changeLabel=this._isAdd?this.labelAdd:this.labelReduce,this.layerAdd.active=this._isAdd,this.layerReduce.active=!this._isAdd;var i=this._interval/100>3?Math.ceil(this._interval/100):3;this.imgContent.active=t!=l.RoleImgType.Empty,t!=l.RoleImgType.Empty&&this.img.getComponent(s.default).updateBg("resources/advance/i18n_"+t+".png"),a.default.instence.resetImgState(),this._intervalTimer=r.default.instance.setInterval(function(){if(e._initNum+=i,e._initNum>=e._interval)return e.onFightEffectEnd(),e.labelCombat.string=e._interval+"",void(e._changeLabel.string=e._interval+"");e.onShowCombat()},this,1)},t.prototype.onFightEffectEnd=function(){var e=this;this.onClearTimer(),this._delayTimer=r.default.instance.setTimeout(function(){r.default.instance.clearTimeout(e._delayTimer),e._delayTimer=null,e.onShowEffect(!1)},this,1e3)},t.prototype.onShowCombat=function(){this.labelCombat.string=this._initNum+"",this._changeLabel.string=this._initNum+""},__decorate([p(cc.Label)],t.prototype,"labelCombat",void 0),__decorate([p(cc.Node)],t.prototype,"layerAdd",void 0),__decorate([p(cc.Node)],t.prototype,"layerReduce",void 0),__decorate([p(cc.Label)],t.prototype,"labelAdd",void 0),__decorate([p(cc.Label)],t.prototype,"labelReduce",void 0),__decorate([p(cc.Node)],t.prototype,"layerContent",void 0),__decorate([p(cc.Node)],t.prototype,"img",void 0),__decorate([p(cc.Node)],t.prototype,"imgContent",void 0),__decorate([p(cc.Node)],t.prototype,"content",void 0),t=__decorate([d],t)}(n.default);i.default=h,cc._RF.pop()},{"../../../Core/TimeController":"TimeController","../../../Core/Widget":"Widget","../../../GlobalContext":"GlobalContext","../../Commons/Image":"Image","./RoleStrengthenController":"RoleStrengthenController","./RoleStrengthenEvent":"RoleStrengthenEvent"}],RoleHeadSetUpItem:[function(e,t,i){"use strict";cc._RF.push(t,"d4222PAhGdJFYlW/Sx25osd","RoleHeadSetUpItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../Commons/Image"),a=e("../../Core/GameEventDispatcher"),r=e("../../Core/Event"),s=e("./RoleController"),l=e("../../Util/Utils"),c=e("../Tips/OpTipsController"),d=e("../../Core/Language"),p=cc._decorator,h=p.ccclass,u=p.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.choose=null,t.icon=null,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this),a.GameEventDispatcher.instance.on(r.EventDefiner.RoleSetUpChoose,this.setUpChoose,this)},t.prototype.setUpChoose=function(){this.choose.active=s.default.instance.chooseIndex==this.index},t.prototype.hide=function(){e.prototype.hide.call(this),l.default.setGrayEffect(this.node,!0),a.GameEventDispatcher.instance.off(r.EventDefiner.RoleSetUpChoose,this.setUpChoose,this)},t.prototype.setGrayEffect=function(){var e=s.default.instance.roleFaShionData;this.icon.node.setContentSize(cc.size(76,76)),l.default.setGrayEffect(this.node,!!e[this.index].state,!0)},t.prototype.setData=function(e){this.index=e,this.icon.loadSpriteAtlas("ui/HeadIcon/headIcon",s.default.instance.nowFashionData[this.index].iconUrl,this.setGrayEffect,this),this.setUpChoose()},t.prototype.onClickChoose=function(){s.default.instance.roleFaShionData[this.index].state?s.default.instance.chooseIndex!=this.index&&(s.default.instance.chooseIndex=this.index,a.GameEventDispatcher.instance.emit(r.EventDefiner.RoleSetUpChoose)):c.default.instance.ShowMsg(d.default.getStr("2023"))},__decorate([u(cc.Node)],t.prototype,"choose",void 0),__decorate([u(o.default)],t.prototype,"icon",void 0),t=__decorate([h],t)}(n.default);i.default=f,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/Widget":"Widget","../../Util/Utils":"Utils","../Commons/Image":"Image","../Tips/OpTipsController":"OpTipsController","./RoleController":"RoleController"}],RoleHeadSetUpWin:[function(e,t,i){"use strict";cc._RF.push(t,"19966If7i1M05SK2Wzmr8Wp","RoleHeadSetUpWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Commons/CommonPageBG"),o=e("../../Core/Language"),a=e("./RoleController"),r=e("../../Core/LoadManager"),s=e("../../GlobalContext"),l=e("../../Util/Utils"),c=e("../../Core/WindowType"),d=e("./RoleHeadSetUpItem"),p=cc._decorator,h=p.ccclass,u=p.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=null,t.closeBtn=null,t.confirmBtn=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.onInit(524,408,o.default.getStr("2020"),!0),this.closeBtn.getComponentInChildren(cc.Label).string=o.default.getStr("2021"),this.confirmBtn.getComponentInChildren(cc.Label).string=o.default.getStr("2022")},t.prototype.show=function(){e.prototype.show.call(this),this.initData()},t.prototype.hide=function(){e.prototype.hide.call(this);for(var t=this.content.childrenCount-1;t>=0;t--)l.default.setNodeToPool(c.PoolType.RoleHeadSetUpItem,this.content.children[t])},t.prototype.initData=function(){var e=this;r.default.instance.loadResByType(s.GlobalContext.Root+"prefab/Role/RoleHeadSetUpItem",cc.Prefab,function(t){for(var i,n=a.default.instance.nowFashionData,o=0;o<n.length;o++)i=l.default.getNodeByPool(c.PoolType.RoleHeadSetUpItem,t,s.GlobalContext.Root+"prefab/Card/RoleHeadSetUpItem"),e.content.addChild(i),i.getComponent(d.default).setData(o)},this)},t.prototype.onClickBtn=function(t,i){i&&a.default.instance.roleSetUpReq(),e.prototype.onClose.call(this)},__decorate([u(cc.Node)],t.prototype,"content",void 0),__decorate([u(cc.Node)],t.prototype,"closeBtn",void 0),__decorate([u(cc.Node)],t.prototype,"confirmBtn",void 0),t=__decorate([h],t)}(n.default);i.default=f,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/CommonPageBG":"CommonPageBG","./RoleController":"RoleController","./RoleHeadSetUpItem":"RoleHeadSetUpItem"}],RoleHead:[function(e,t,i){"use strict";cc._RF.push(t,"64e88LxosZMzaQEldwBW8rj","RoleHead"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../Commons/Image"),a=cc._decorator,r=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Image=null,t._url=null,t._Image=null,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this),this._Image=this.Image.addComponent(o.default),this._url&&""!=this._url&&this.SetHead(this._url)},t.prototype.SetHead=function(e){this._url=e,e&&""!=e?(this.Image.node.active=!0,this._Image&&this._Image.loadSpriteAtlas("ui/HeadIcon/headIcon",e)):this.Image.node.active=!1},t.prototype.clear=function(){this._Image&&this._Image.clear()},t.prototype.dispose=function(){this.clear(),e.prototype.dispose.call(this)},t.prototype.onDestroy=function(){this.clear(),e.prototype.onDestroy.call(this)},__decorate([s(cc.Sprite)],t.prototype,"Image",void 0),t=__decorate([r],t)}(n.default);i.default=l,cc._RF.pop()},{"../../Core/Widget":"Widget","../Commons/Image":"Image"}],RoleInfo:[function(e,t,i){"use strict";cc._RF.push(t,"a3d42/25OJCqZKcae9IfXaS","RoleInfo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Fight/staticattr"),o=e("../../Global/GlobalValue"),a=e("../Status/StatusType"),r=e("../WarTeam/MonsterController"),s=e("../TotemsCopy/TotemsCopyCtrl"),l=e("../../Core/ConfigsManager"),c=e("../Fight/FightUtils"),d=e("../Expedition/ExpeditionController"),p=function(){function e(){}return e.id="id",e.rolename="name",e.diamond="diamond",e.honor="honor",e.point="point",e.money="money",e.energy="energy",e.level="level",e.exp="exp",e.nameChangeCnt="changeNameCnt",e}();i.RoleInfoKey=p;var h=function(){function e(){this.id="",this.name="",this.sex=0,this.icon="",this.serverid=0,this.money=0,this.energy=0,this.maxEnergy=200,this.showEnergy=100,this.hp=0,this.diamond=0,this.honor=0,this.point=0,this.level=0,this.exp=0,this.attribute="",this.equipment="",this.skill="",this.surface="",this.result=-1,this.possess=[],this.currentsurface=0,this.prop=0,this.maxHp=0,this.attack=0,this.defence=0,this.critical=0,this.hit=0,this.system=[],this.firstgame=!1,this.guide=[],this.vipLevel=0,this.vipExp=0,this.nameChangeCnt=0,this.attr=new n.StaticAttr}return Object.defineProperty(e.prototype,"MaxHp",{get:function(){return this.attr.GetAttrVale(o.AttrType.MaxHp)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Attack",{get:function(){return this.attr.GetAttrVale(o.AttrType.Attack)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Defence",{get:function(){return this.attr.GetAttrVale(o.AttrType.Defence)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Hit",{get:function(){return this.attr.GetAttrVale(o.AttrType.Hit)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dodge",{get:function(){return this.attr.GetAttrVale(o.AttrType.Dodge)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Critical",{get:function(){return this.attr.GetAttrVale(o.AttrType.Critical)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DefCri",{get:function(){return this.attr.GetAttrVale(o.AttrType.DefCri)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Fight",{get:function(){return this.attr.GetFight()},enumerable:!0,configurable:!0}),e.prototype.GetCurrentFight=function(e){return this.attr.GetCurrentFight(e)},Object.defineProperty(e.prototype,"AllFight",{get:function(){return this.attr.GetFight()+r.default.instance.data.getCardTotalFight()},enumerable:!0,configurable:!0}),e.prototype.ReserveNum=function(e){void 0===e&&(e=!1);var t=c.FightUtils.addMonsterReserveNum(),i=l.ConfigsManager.instance.getConfigs("levelconf").LevelConf[this.level].savenum+t;switch(a.ActivityStatus.value){case a.ActivityStatus.TotemsCopy:i=e?s.default.instance.getNum():s.default.instance.getMonNum()+t;break;case a.ActivityStatus.Expedition:var n=d.default.instance.getSaveMonsterNum();n>=0&&(i=n)}return Math.min(10+t,i)},e}();i.RoleInfo=h,i.MyRoleInfo=new h,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Global/GlobalValue":"GlobalValue","../Expedition/ExpeditionController":"ExpeditionController","../Fight/FightUtils":"FightUtils","../Fight/staticattr":"staticattr","../Status/StatusType":"StatusType","../TotemsCopy/TotemsCopyCtrl":"TotemsCopyCtrl","../WarTeam/MonsterController":"MonsterController"}],RoleNeedItemVo:[function(e,t,i){"use strict";cc._RF.push(t,"1b470i+3g5Kja1atRZYg2gA","RoleNeedItemVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){return function(e){for(var t in e)this[t]=e[t]}}();i.RoleNeedItemVo=n,cc._RF.pop()},{}],RoleQualityVo:[function(e,t,i){"use strict";cc._RF.push(t,"5d365rWOexLWohNusA2d92F","RoleQualityVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){return function(e){for(var t in e)this[t]=e[t]}}();i.RoleQualityVo=n,cc._RF.pop()},{}],RoleSkillTips:[function(e,t,i){"use strict";cc._RF.push(t,"f0d38ykXOZCroM1R6ztej9d","RoleSkillTips"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../../GlobalContext"),a=e("../Role/RoleController"),r=e("../Scene/Controller/SkillController"),s=e("../WarTeam/MonsterController"),l=cc._decorator,c=l.ccclass,d=l.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.spriteIcon=null,t.main=null,t.labelName=null,t.labelDesc=null,t}return __extends(t,e),t.prototype.show=function(){var e=a.default.instance.getSkillData(),t=a.default.instance.clickSkillId;this.labelName.string=e.name,s.default.instance.setSkillPic(t,this.spriteIcon),this.labelDesc.string=r.default.instance.getSkillDescBySkillIdAndLv(t,1);var i=.5*(o.GlobalContext.StageWidth-1624)+590;this.main.position=new cc.Vec2(i,-30)},__decorate([d(cc.Sprite)],t.prototype,"spriteIcon",void 0),__decorate([d(cc.Node)],t.prototype,"main",void 0),__decorate([d(cc.Label)],t.prototype,"labelName",void 0),__decorate([d(cc.RichText)],t.prototype,"labelDesc",void 0),t=__decorate([c],t)}(n.default);i.default=p,cc._RF.pop()},{"../../Core/Window":"Window","../../GlobalContext":"GlobalContext","../Role/RoleController":"RoleController","../Scene/Controller/SkillController":"SkillController","../WarTeam/MonsterController":"MonsterController"}],RoleSkillVo:[function(e,t,i){"use strict";cc._RF.push(t,"d2a6e5850hCz6LatpJssJt+","RoleSkillVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e){this.updateData(e)}return e.prototype.updateData=function(e){this.skillid=e.id,this.skilllv=e.level,this.cd=e.cd,this.data=e.data},e}();i.RoleSkillVo=n,cc._RF.pop()},{}],RoleSkinPage:[function(e,t,i){"use strict";cc._RF.push(t,"790bf2tw4FFk4u5Sk7+NU0S","RoleSkinPage"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Commons/CommonPageBG"),o=e("../../Core/Language"),a=e("../../Core/GameEventDispatcher"),r=e("../../Core/Event"),s=e("../../Util/Utils"),l=e("../../Core/WindowType"),c=e("../WarTeam/MonsterController"),d=e("../Commons/MonsterPreview"),p=e("../../Global/GlobalValue"),h=e("./RoleInfo"),u=e("../../NetConnect/NetConnet"),f=e("../../Core/ConfigsManager"),g=e("../../Core/LoadManager"),y=e("../../GlobalContext"),m=cc._decorator,C=m.ccclass,v=m.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.SkinWin=null,t.SkinList=null,t.normalButton=null,t.specialButton=null,t.PicDrap1=null,t._configs1=null,t.modelList=[],t.normalModelList=[],t.specialModelList=[],t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this._configs1=f.ConfigsManager.instance.getConfigs("RoleDevelopConf"),this.PageView=this.SkinList.getComponent(cc.ScrollView),this.onInit(1034,580,o.default.getStr("role_skin_title"),!0)},t.prototype.show=function(){e.prototype.show.call(this),this.initXingxiangList(),this.onClickXingxiangNormalButton(),a.GameEventDispatcher.instance.on(r.EventDefiner.SkillChange,this.onShowSkinInfo,this)},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),a.GameEventDispatcher.instance.off(r.EventDefiner.SkillChange,this.onShowSkinInfo,this)},t.prototype.onClickBtn=function(e,t){switch(Number(t)){case 1:this.PageView.content.x-420>-2740&&this.PageView.content.runAction(cc.sequence(cc.moveBy(.1,-420,0),cc.callFunc(function(){},this)));break;case 2:this.PageView.content.x+420<=0&&this.PageView.content.runAction(cc.sequence(cc.moveBy(.1,420,0),cc.callFunc(function(){},this)))}},t.prototype.initXingxiangList=function(){if(!this.normalModelList.length)for(var e=0;e<this._configs1.fashion[1].length;e++)1!=this._configs1.fashion[1][e].condType&&0!=this._configs1.fashion[1][e].condType||this.normalModelList.push(this._configs1.fashion[1][e]);if(!this.specialModelList.length)for(e=0;e<this._configs1.fashion[1].length;e++)2==this._configs1.fashion[1][e].condType&&this.specialModelList.push(this._configs1.fashion[1][e]);this.normalButton.getComponent(cc.Sprite).spriteFrame=this.PicDrap1.getSpriteFrame("tabbtn3"),this.specialButton.getComponent(cc.Sprite).spriteFrame=this.PicDrap1.getSpriteFrame("tabbtn4"),this.normalButton.node.width=80,this.specialButton.node.width=65,this.modelList=this.normalModelList},t.prototype.onClickXingxiangNormalButton=function(){this.normalButton.getComponent(cc.Sprite).spriteFrame=this.PicDrap1.getSpriteFrame("tabbtn3"),this.specialButton.getComponent(cc.Sprite).spriteFrame=this.PicDrap1.getSpriteFrame("tabbtn4"),this.normalButton.node.width=80,this.specialButton.node.width=65,this.modelList=this.normalModelList,this.onShowSkinInfo()},t.prototype.onClickXingxiangSpecialButton=function(){this.normalButton.getComponent(cc.Sprite).spriteFrame=this.PicDrap1.getSpriteFrame("tabbtn4"),this.specialButton.getComponent(cc.Sprite).spriteFrame=this.PicDrap1.getSpriteFrame("tabbtn3"),this.normalButton.node.width=65,this.specialButton.node.width=80,this.modelList=this.specialModelList,this.onShowSkinInfo()},t.prototype.onShowSkinInfo=function(){var e=this;g.default.instance.loadResByType(y.GlobalContext.Root+"prefab/Skin/Skin",cc.Prefab,function(t){var i,n;i=e.SkinList.getComponent(cc.ScrollView),s.default.setNodeChildDestoryByUrl(i.content,y.GlobalContext.Root+"prefab/Skin/Skin");for(var o=0;o<e.modelList.length;o++){n=s.default.getNodeByUrl(t,y.GlobalContext.Root+"prefab/Skin/Skin");var a=cc.find("Name/NameText",n),r=(cc.find("Status/ActiveBtn",n),cc.find("HaveBtn",n),cc.find("Status/CurSkin",n),cc.find("HaveBtn/normal",n),cc.find("HaveBtn/specail",n),cc.find("HaveBtn/normal/Text1",n),cc.find("HaveBtn/normal/Text2",n),cc.find("HaveBtn/normal/ProgressBar/CardHaveFigh",n),cc.find("HaveBtn/normal/ProgressBar/TarFigh",n),cc.find("Status/CurSkin",n),cc.find("Model",n));cc.find("Id",n),cc.find("Status/ActiveBtn",n),cc.find("Status/ActiveBtn/UseSkin",n),cc.find("HaveBtn/specail/Item",n),cc.find("Lock",n);cc.find("richtext",n).active=!1;var u=h.MyRoleInfo.sex?e.modelList[o].femaleModel:e.modelList[o].maleModel;a.getComponent(cc.Label).string=e.modelList[o].manname;var f=s.default.getNodeByPool(l.PoolType.MonsterPreview,c.default.instance.MonsterPreview);f.setScale(1),r.addChild(f),f.getComponent(d.default).init("role",u,1,p.DEFAULTS_SKIN+1+"",p.PRIORITY.MONSTER),i.content.addChild(n)}i.content.width=10*e.modelList.length+e.modelList.length*n.width},this)},t.prototype.onChangeSkin=function(e,t,i){t>1&&(e+=i);var n={cmd:"modelset",id:e};u.default.instance.sendProto(n)},t.prototype.onActive=function(e,t,i){t>1&&(e+=i);var n={cmd:"modelactive",id:e};u.default.instance.sendProto(n)},__decorate([v(cc.Node)],t.prototype,"SkinWin",void 0),__decorate([v(cc.Node)],t.prototype,"SkinList",void 0),__decorate([v(cc.Button)],t.prototype,"normalButton",void 0),__decorate([v(cc.Button)],t.prototype,"specialButton",void 0),__decorate([v(cc.SpriteAtlas)],t.prototype,"PicDrap1",void 0),t=__decorate([C],t)}(n.default);i.default=_,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../NetConnect/NetConnet":"NetConnet","../../Util/Utils":"Utils","../Commons/CommonPageBG":"CommonPageBG","../Commons/MonsterPreview":"MonsterPreview","../WarTeam/MonsterController":"MonsterController","./RoleInfo":"RoleInfo"}],RoleStrengthenController:[function(e,t,i){"use strict";cc._RF.push(t,"6051d3IbItGVqzGl3TsJuc6","RoleStrengthenController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Controller"),o=e("./RoleStrengthenData/RoleStrengthenData"),a=e("../../../Core/ConfigsManager"),r=e("../../../NetConnect/NetConnet"),s=e("../../../Core/GameEventDispatcher"),l=e("./RoleStrengthenEvent"),c=e("../../../Core/Event"),d=e("../../../Core/TimeController"),p=cc._decorator,h=p.ccclass,u=(p.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._delayShowCount=0,t._config=null,t._roleStrengthenData=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instence=this,this._config=a.ConfigsManager.instance.getConfigs("strongconf"),this._roleStrengthenData=new o.default,this.onInitMaterialData(),this.resetImgState()},t.prototype.listNotification=function(){this.addProto("stronginfo",this.onStrongMainInfo,this),this.addProto("strongrewardstate",this.onStrongRewardInfo,this),this.addProto("fight",this.onFightChange,this)},t.prototype.clearTime=function(){this.time&&(d.default.instance.clearTimeout(this.time),this.time=null)},t.prototype.setImgState=function(e){var t=this;this.imgState=e,this.clearTime(),this.time=d.default.instance.setTimeout(function(){t.resetImgState()},this,3e3)},t.prototype.resetImgState=function(){this.clearTime(),this.imgState=l.RoleImgType.Empty},t.prototype.sendCmdStrongInfo=function(){r.default.instance.sendProto({cmd:"stronginfo"})},t.prototype.sendCmdGetReward=function(e){var t={cmd:"stronggetreward",index:e};r.default.instance.sendProto(t)},t.prototype.onStrongMainInfo=function(e){this._roleStrengthenData.onInitStrengthen(e,this._config.windowTypeConf),s.GameEventDispatcher.instance.emit(l.RoleStrengthenEvent.MainInfo),s.GameEventDispatcher.instance.emit(l.RoleStrengthenEvent.CanGetReward)},t.prototype.onStrongRewardInfo=function(e){this._roleStrengthenData.onInitStrengthenReward(e.status),s.GameEventDispatcher.instance.emit(l.RoleStrengthenEvent.RewardInfo),s.GameEventDispatcher.instance.emit(l.RoleStrengthenEvent.CanGetReward)},t.prototype.onFightChange=function(e){this._roleStrengthenData.onInitFight(e),s.GameEventDispatcher.instance.emit(c.EventDefiner.PlayerFightChange)},t.prototype.onInitMaterialData=function(){this._roleStrengthenData.onInitMaterial(this._config.materialConf,this._config.windowTypeConf)},Object.defineProperty(t.prototype,"materialList",{get:function(){return this._roleStrengthenData.materialList},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"strengthenData",{get:function(){return this._roleStrengthenData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"delayShowFightChange",{get:function(){return this._delayShowCount},set:function(e){this._delayShowCount=e},enumerable:!0,configurable:!0}),t.instence=null,t=i=__decorate([h],t)}(n.default));i.default=u,cc._RF.pop()},{"../../../Core/ConfigsManager":"ConfigsManager","../../../Core/Controller":"Controller","../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/TimeController":"TimeController","../../../NetConnect/NetConnet":"NetConnet","./RoleStrengthenData/RoleStrengthenData":"RoleStrengthenData","./RoleStrengthenEvent":"RoleStrengthenEvent"}],RoleStrengthenData:[function(e,t,i){"use strict";cc._RF.push(t,"c678e2qRJVMfb2tNKXP0C3z","RoleStrengthenData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./RoleStrengthenMaterialItemData"),o=e("./RoleStrengthenItemData"),a=e("./RoleStrengthenRewardData"),r=function(){function e(){this._strengthenItemList=[],this._strengthenReward=new a.default,this._strengthenData=null,this._fight=0,this._recommendFight=0,this._evaluate=1,this._currentFight=0,this._oldFight=0,this._befGradeFight=0,this._curGradeFight=0,this._clientOldFight=0,this._isCanGet=!1,this._materialItemList=[]}return e.prototype.onInitStrengthen=function(e,t){this._strengthenItemList=[],this._strengthenData=e,this.onInitMainInfo(this._strengthenData.total),this.onInitSysInfo(this._strengthenData.data,t)},e.prototype.onInitMainInfo=function(e){this._evaluate=e.point,this._fight=e.fight,this._recommendFight=e.rfight,this.onInitStrengthenReward(e.status)},e.prototype.onInitSysInfo=function(e,t){for(var i=0;i<e.length;i++)if(e[i]&&t[e[i].type]){var n=new o.default;n.onInit(e[i],t[e[i].type]),this._strengthenItemList.push(n)}},e.prototype.onInitStrengthenReward=function(e){this._strengthenData&&this._strengthenData.total&&this._strengthenData.total.rewards&&this._strengthenReward.onInit(e,this._strengthenData.total.rewards),this._isCanGet=!1;for(var t=0;t<e.length;t++)if(1==e[t]){this._isCanGet=!0;break}},Object.defineProperty(e.prototype,"isCanGet",{get:function(){return this._isCanGet},enumerable:!0,configurable:!0}),e.prototype.onInitFight=function(e){this.clientOldFight<1?this.clientOldFight=e.beforeFight:this.clientOldFight=this._currentFight,this._currentFight=e.curFight,this._oldFight=e.beforeFight,this._befGradeFight=e.befGradeFight,this._curGradeFight=e.curGradeFight},Object.defineProperty(e.prototype,"clientOldFight",{get:function(){return this._clientOldFight},set:function(e){this._clientOldFight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentFight",{get:function(){return this._currentFight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"oldFight",{get:function(){return this._oldFight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"befGradeFight",{get:function(){return this._befGradeFight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"curGradeFight",{get:function(){return this._curGradeFight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rewardInfo",{get:function(){return this._strengthenReward},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sysFightDataList",{get:function(){return this._strengthenItemList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"roleFight",{get:function(){return this._fight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recomendFight",{get:function(){return this._recommendFight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fightEvaluate",{get:function(){return this._evaluate},enumerable:!0,configurable:!0}),e.prototype.onInitMaterial=function(e,t){for(var i in this._materialItemList=[],e){var o=new n.default;o.onInit(e[i].itemIcon,e[i].itemName,e[i].itemType,e[i].materialWayType,e[i].materialWayStar,t),this._materialItemList.push(o)}},Object.defineProperty(e.prototype,"materialList",{get:function(){return this._materialItemList},enumerable:!0,configurable:!0}),e}();i.default=r,cc._RF.pop()},{"./RoleStrengthenItemData":"RoleStrengthenItemData","./RoleStrengthenMaterialItemData":"RoleStrengthenMaterialItemData","./RoleStrengthenRewardData":"RoleStrengthenRewardData"}],RoleStrengthenEvent:[function(e,t,i){"use strict";cc._RF.push(t,"8b829MauVhDPJ8VaFcwBeGy","RoleStrengthenEvent"),Object.defineProperty(i,"__esModule",{value:!0}),function(e){e.MainInfo="MainInfo",e.RewardInfo="RewardInfo",e.CanGetReward="CanGetReward"}(i.RoleStrengthenEvent||(i.RoleStrengthenEvent={})),function(e){e[e.Empty=0]="Empty",e[e.Culture=1]="Culture",e[e.AddProduct=2]="AddProduct",e[e.Upgrade=3]="Upgrade",e[e.AddRank=4]="AddRank",e[e.Strengthen=5]="Strengthen",e[e.Refine=6]="Refine",e[e.Injection=7]="Injection"}(i.RoleImgType||(i.RoleImgType={})),cc._RF.pop()},{}],RoleStrengthenItemData:[function(e,t,i){"use strict";cc._RF.push(t,"b7d4f+s2xxEt5aPP1VCiBVQ","RoleStrengthenItemData"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(){this._evaluate=1,this._currentCombat=0,this._recommendCombat=0,this._isNeedUp=!1,this._data=null,this._config=null}return e.prototype.onInit=function(e,t){this._data=e,this._config=t},Object.defineProperty(e.prototype,"evaluateValue",{get:function(){return this._data.point||1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentCombat",{get:function(){return this._data.fight||0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recommendCombat",{get:function(){return this._data.recommendFight||0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sysIcon",{get:function(){return this._config.icon},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sysName",{get:function(){return this._config.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"windowType",{get:function(){return this._config.windowType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"windowChildindex",{get:function(){return this._config.windowChildindex},enumerable:!0,configurable:!0}),e}();i.default=n,cc._RF.pop()},{}],RoleStrengthenItem:[function(e,t,i){"use strict";cc._RF.push(t,"c5247L8lydPDa0+Ham6lqHE","RoleStrengthenItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../../Core/Widget"),o=e("../../../Commons/Image"),a=e("../../../../GlobalContext"),r=e("../../../../Core/Language"),s=e("../../../../Core/CommonsResManager"),l=e("../../../Commons/WindowOpenUtils"),c=e("../../../../Core/WindowType"),d=e("../../../WarTeam/MonsterController"),p=cc._decorator,h=p.ccclass,u=p.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.spriteIcon=null,t.progressCombat=null,t.spriteEvaluate=null,t.spriteTips=null,t.richTextDesc=null,t._strongData=null,t}return __extends(t,e),t.prototype.onInitData=function(e){this._strongData=e,this.onShowPage()},t.prototype.onShowPage=function(){this.spriteIcon.getComponent(o.default).loadSpriteAtlas(a.GlobalContext.Root+"ui/roleStrengthen/RoleStrengthenFunPic",this._strongData.sysIcon),this.richTextDesc.string=r.default.getStr("strong_item_combat",this._strongData.sysName,this._strongData.currentCombat,this._strongData.recommendCombat),this.spriteEvaluate.getComponent(cc.Sprite).spriteFrame=s.default.instance.getSpriteFrameByName("rarity_"+this._strongData.evaluateValue),this.spriteTips.active=this._strongData.evaluateValue<2,this.progressCombat.progress=this._strongData.currentCombat/this._strongData.recommendCombat},t.prototype.onClick=function(){var e=0,t=0,i=null;switch(this._strongData.windowType){case c.WindowType.CardUpgrade:case c.WindowType.CardStage:i=d.default.instance.getWarTeamMinStage();break;case c.WindowType.Strengthen:i=d.default.instance.getWarTeamMinEquipLevel(1);break;case c.WindowType.UpgradeStage:i=d.default.instance.getWarTeamMinEquipLevel(2);break;case c.WindowType.Gemstone:i=d.default.instance.getWarTeamMinEquipLevel(3);break;case c.WindowType.Refine:i=d.default.instance.getWarTeamMinEquipLevel(4)}i&&i>=0?e=i:i&&i.length>1&&(e=i[0],t=i[1]),l.default.instance.openWindowType(this._strongData.windowType,this._strongData.windowChildindex,e,t)},__decorate([u(cc.Node)],t.prototype,"spriteIcon",void 0),__decorate([u(cc.ProgressBar)],t.prototype,"progressCombat",void 0),__decorate([u(cc.Node)],t.prototype,"spriteEvaluate",void 0),__decorate([u(cc.Node)],t.prototype,"spriteTips",void 0),__decorate([u(cc.RichText)],t.prototype,"richTextDesc",void 0),t=__decorate([h],t)}(n.default);i.default=f,cc._RF.pop()},{"../../../../Core/CommonsResManager":"CommonsResManager","../../../../Core/Language":"Language","../../../../Core/Widget":"Widget","../../../../Core/WindowType":"WindowType","../../../../GlobalContext":"GlobalContext","../../../Commons/Image":"Image","../../../Commons/WindowOpenUtils":"WindowOpenUtils","../../../WarTeam/MonsterController":"MonsterController"}],RoleStrengthenMaterialItemData:[function(e,t,i){"use strict";cc._RF.push(t,"fa5a4aZXX5DkpOGnzkNMDMv","RoleStrengthenMaterialItemData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./RoleStrengthenMaterialWayData"),o=function(){function e(){this._materialWayList=[]}return e.prototype.onInit=function(e,t,i,o,a,r){this._itemIcon=e,this._itemName=t,this._itemType=i,this._materialWayList=[];for(var s=0;s<o.length;s++)if(r[o[s]]){var l=new n.default;l.onInit(a[s],r[o[s]]),this._materialWayList.push(l)}},Object.defineProperty(e.prototype,"itemIcon",{get:function(){return this._itemIcon},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemName",{get:function(){return this._itemName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemType",{get:function(){return this._itemType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"materialWayList",{get:function(){return this._materialWayList},enumerable:!0,configurable:!0}),e}();i.default=o,cc._RF.pop()},{"./RoleStrengthenMaterialWayData":"RoleStrengthenMaterialWayData"}],RoleStrengthenMaterialItem:[function(e,t,i){"use strict";cc._RF.push(t,"ce019DW/zNP6bIMF46JvPkG","RoleStrengthenMaterialItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../../Core/Widget"),o=e("./RoleStrengthenMaterialWay"),a=e("../../../../Util/Utils"),r=e("../../../../Core/CommonsResManager"),s=e("../../../Commons/Image"),l=e("../../../../GlobalContext"),c=e("../../../../Core/LoadManager"),d=cc._decorator,p=d.ccclass,h=d.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.labelMaterialName=null,t.layerMaterContent=null,t.layerMaterialWayContent=null,t.spriteMaterialBG=null,t.spriteMaterial=null,t._materialItemData=null,t}return __extends(t,e),t.prototype.onInitData=function(e){this._materialItemData=e,this.onShowPage()},t.prototype.onShowPage=function(){this.onShowMaterial(),this.onShowWay()},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),a.default.setNodeChildDestoryByUrl(this.layerMaterialWayContent,l.GlobalContext.Root+"prefab/Role/RoleStrengthen/RoleStrengthenMaterialWay")},t.prototype.onShowMaterial=function(){this.labelMaterialName.string=this._materialItemData.itemName+"",this.spriteMaterialBG.getComponent(cc.Sprite).spriteFrame=r.default.instance.getSpriteFrameByName("bag"+this._materialItemData.itemType),this.spriteMaterialBG.setScale(.8),this.spriteMaterial.getComponent(s.default).loadSpriteAtlas(l.GlobalContext.Root+"ui/roleStrengthen/RoleMaterial",this._materialItemData.itemIcon)},t.prototype.onShowWay=function(){var e=this;a.default.setNodeChildDestoryByUrl(this.layerMaterialWayContent,l.GlobalContext.Root+"prefab/Role/RoleStrengthen/RoleStrengthenMaterialWay"),c.default.instance.loadResByType(l.GlobalContext.Root+"prefab/Role/RoleStrengthen/RoleStrengthenMaterialWay",cc.Prefab,function(t){for(var i=e._materialItemData.materialWayList.concat(),n=0;n<i.length;n++){var r=a.default.getNodeByUrl(t,l.GlobalContext.Root+"prefab/Role/RoleStrengthen/RoleStrengthenMaterialWay");r.getComponent(o.default).onInitData(i[n]),e.layerMaterialWayContent.addChild(r)}},this)},__decorate([h(cc.Label)],t.prototype,"labelMaterialName",void 0),__decorate([h(cc.Node)],t.prototype,"layerMaterContent",void 0),__decorate([h(cc.Node)],t.prototype,"layerMaterialWayContent",void 0),__decorate([h(cc.Node)],t.prototype,"spriteMaterialBG",void 0),__decorate([h(cc.Node)],t.prototype,"spriteMaterial",void 0),t=__decorate([p],t)}(n.default);i.default=u,cc._RF.pop()},{"../../../../Core/CommonsResManager":"CommonsResManager","../../../../Core/LoadManager":"LoadManager","../../../../Core/Widget":"Widget","../../../../GlobalContext":"GlobalContext","../../../../Util/Utils":"Utils","../../../Commons/Image":"Image","./RoleStrengthenMaterialWay":"RoleStrengthenMaterialWay"}],RoleStrengthenMaterialWayData:[function(e,t,i){"use strict";cc._RF.push(t,"f677dU+FKZGlrJYOZM43WZn","RoleStrengthenMaterialWayData"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(){this._starCount=0,this._data=null}return e.prototype.onInit=function(e,t){this._starCount=e,this._data=t},Object.defineProperty(e.prototype,"starCount",{get:function(){return this._starCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sysIcon",{get:function(){return this._data.icon},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"windowType",{get:function(){return this._data.windowType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"windowChildIndex",{get:function(){return this._data.windowChildIndex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sysName",{get:function(){return this._data.name},enumerable:!0,configurable:!0}),e}();i.default=n,cc._RF.pop()},{}],RoleStrengthenMaterialWay:[function(e,t,i){"use strict";cc._RF.push(t,"118edjeD3JAzIUdLeyhYF4+","RoleStrengthenMaterialWay"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../../Core/Widget"),o=e("../../../Commons/Image"),a=e("../../../../GlobalContext"),r=e("../../../Commons/WindowOpenUtils"),s=e("../../../../Util/Utils"),l=e("../../../../Core/LoadManager"),c=cc._decorator,d=c.ccclass,p=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.labelTitle=null,t.spriteIcon=null,t.layerStarContent=null,t._materialWay=null,t}return __extends(t,e),t.prototype.onInitData=function(e){this._materialWay=e,this.onShowPage()},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),s.default.setNodeChildDestoryByUrl(this.layerStarContent,a.GlobalContext.Root+"prefab/Role/RoleStrengthen/RoleStrengthenStar")},t.prototype.onShowPage=function(){this.labelTitle.string=this._materialWay.sysName+"",this.spriteIcon.getComponent(o.default).loadSpriteAtlas(a.GlobalContext.Root+"ui/roleStrengthen/RoleStrengthenFunPic",this._materialWay.sysIcon),this.onShowStar()},t.prototype.onShowStar=function(){var e=this;s.default.setNodeChildDestoryByUrl(this.layerStarContent,a.GlobalContext.Root+"prefab/Role/RoleStrengthen/RoleStrengthenStar"),l.default.instance.loadResByType(a.GlobalContext.Root+"prefab/Role/RoleStrengthen/RoleStrengthenStar",cc.Prefab,function(t){for(var i=0;i<e._materialWay.starCount;i++){var n=s.default.getNodeByUrl(t,a.GlobalContext.Root+"prefab/Role/RoleStrengthen/RoleStrengthenStar");e.layerStarContent.addChild(n)}},this)},t.prototype.onClick=function(){r.default.instance.openWindowType(this._materialWay.windowType,this._materialWay.windowChildIndex)},__decorate([p(cc.Label)],t.prototype,"labelTitle",void 0),__decorate([p(cc.Node)],t.prototype,"spriteIcon",void 0),__decorate([p(cc.Node)],t.prototype,"layerStarContent",void 0),t=__decorate([d],t)}(n.default);i.default=h,cc._RF.pop()},{"../../../../Core/LoadManager":"LoadManager","../../../../Core/Widget":"Widget","../../../../GlobalContext":"GlobalContext","../../../../Util/Utils":"Utils","../../../Commons/Image":"Image","../../../Commons/WindowOpenUtils":"WindowOpenUtils"}],RoleStrengthenMaterial:[function(e,t,i){"use strict";cc._RF.push(t,"adcb4nKAwJCWYanCCOh/wBt","RoleStrengthenMaterial"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../../Core/Widget"),o=e("../RoleStrengthenController"),a=e("./RoleStrengthenMaterialItem"),r=e("../../../../Util/Utils"),s=e("../../../../GlobalContext"),l=e("../../../../Core/LoadManager"),c=cc._decorator,d=c.ccclass,p=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollView=null,t.layerMaterialContent=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),this.onShowPage()},t.prototype.onShowPage=function(){var e=this;r.default.setNodeChildDestoryByUrl(this.layerMaterialContent,s.GlobalContext.Root+"prefab/Role/RoleStrengthen/RoleStrengthenMaterialItem");var t=o.default.instence.materialList.concat();l.default.instance.loadResByType(s.GlobalContext.Root+"prefab/Role/RoleStrengthen/RoleStrengthenMaterialItem",cc.Prefab,function(i){for(var n=0;n<t.length;n++){var o=r.default.getNodeByUrl(i,s.GlobalContext.Root+"prefab/Role/RoleStrengthen/RoleStrengthenMaterialItem");o.getComponent(a.default).onInitData(t[n]),e.layerMaterialContent.addChild(o)}e.scrollView.scrollToTop()},this)},__decorate([p(cc.ScrollView)],t.prototype,"scrollView",void 0),__decorate([p(cc.Node)],t.prototype,"layerMaterialContent",void 0),t=__decorate([d],t)}(n.default);i.default=h,cc._RF.pop()},{"../../../../Core/LoadManager":"LoadManager","../../../../Core/Widget":"Widget","../../../../GlobalContext":"GlobalContext","../../../../Util/Utils":"Utils","../RoleStrengthenController":"RoleStrengthenController","./RoleStrengthenMaterialItem":"RoleStrengthenMaterialItem"}],RoleStrengthenPage:[function(e,t,i){"use strict";cc._RF.push(t,"b2f7063nsxJFYnjMZgBb9WO","RoleStrengthenPage"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Window"),o=e("../../Commons/WindowBg1"),a=cc._decorator,r=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layerStrengthen=null,t.layerMaterial=null,t._index=0,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){var t=this;this.loadWindowCom=function(){t.onShowPage(t._index)},this.loadWindowComThis=this,e.prototype.onLoad.call(this),i.instance=this},t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.onDisable=function(){e.prototype.onDisable.call(this)},t.prototype.onInitData=function(e){void 0===e&&(e=0),this._index=e,this.onShowPage(this._index)},t.prototype.onShowPage=function(e){if(this.windowBg){var t=this.windowBg.getComponent(o.default);t.TabBtnList._delaySelectedIndexTime=0,t.TabBtnList.selectItem(e)}},t.instance=null,__decorate([s(cc.Node)],t.prototype,"layerStrengthen",void 0),__decorate([s(cc.Node)],t.prototype,"layerMaterial",void 0),t=i=__decorate([r],t)}(n.default);i.default=l,cc._RF.pop()},{"../../../Core/Window":"Window","../../Commons/WindowBg1":"WindowBg1"}],RoleStrengthenRewardData:[function(e,t,i){"use strict";cc._RF.push(t,"1fb86ZtFGRAf5/Mu0p2FNHM","RoleStrengthenRewardData"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(){this._index=-1,this._rewardId=0,this._iscanGet=!1}return e.prototype.onInit=function(e,t){for(var i=0;i<t.length;i++)if(2!=e[i]){this._index=i,this._rewardId=t[i].rewardId,this._recomendFight=t[i].value,this._iscanGet=1==e[i];break}},Object.defineProperty(e.prototype,"rewardId",{get:function(){return this._rewardId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recomendFight",{get:function(){return this._recomendFight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rewardIndex",{get:function(){return this._index},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canGetReward",{get:function(){return this._iscanGet},enumerable:!0,configurable:!0}),e}();i.default=n,cc._RF.pop()},{}],RoleStrengthen:[function(e,t,i){"use strict";cc._RF.push(t,"826f0cTJzZCS4kvlaBbDIWv","RoleStrengthen"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../../Core/Widget"),o=e("../../../../Core/GameEventDispatcher"),a=e("../RoleStrengthenEvent"),r=e("../RoleStrengthenController"),s=e("../../../../Core/Language"),l=e("../../../../Core/CommonsResManager"),c=e("../../../../Util/Utils"),d=e("../../../../Core/WindowType"),p=e("../../../Commons/RewardUtils"),h=e("../../../Item/ItemIcon"),u=e("./RoleStrengthenItem"),f=e("../../../../GlobalContext"),g=e("../../../../Core/LoadManager"),y=e("../../../../Core/Event"),m=e("../../../../Core/TimeController"),C=cc._decorator,v=C.ccclass,_=C.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.spriteEvaluateValue=null,t.labelCombatValue=null,t.labelRecommendCombat=null,t.layerRewardContent=null,t.richTextRewardDesc=null,t.btnReward=null,t.spriteRewardRed=null,t.scrollView=null,t.layerStrengthenContent=null,t._isFirst=!0,t._strongData=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.show=function(){e.prototype.show.call(this),this._isFirst=!0,r.default.instence.sendCmdStrongInfo(),o.GameEventDispatcher.instance.on(y.EventDefiner.PlayerFightChange,this.onFightChange,this),o.GameEventDispatcher.instance.on(a.RoleStrengthenEvent.MainInfo,this.onMainInfo,this),o.GameEventDispatcher.instance.on(a.RoleStrengthenEvent.RewardInfo,this.onRewardInfo,this)},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),this.onClearReward(),o.GameEventDispatcher.instance.off(a.RoleStrengthenEvent.MainInfo,this.onMainInfo,this),o.GameEventDispatcher.instance.off(a.RoleStrengthenEvent.RewardInfo,this.onRewardInfo,this),o.GameEventDispatcher.instance.off(y.EventDefiner.PlayerFightChange,this.onFightChange,this)},t.prototype.onShowPage=function(){this._strongData=r.default.instence.strengthenData,this.onShowMain(),this.onShowReward(),this.onShowSysList()},t.prototype.onShowMain=function(){this.labelCombatValue.string=this._strongData.roleFight+"",this.labelRecommendCombat.string=s.default.getStr("strong_recommend",[this._strongData.recomendFight]),this.spriteEvaluateValue.getComponent(cc.Sprite).spriteFrame=l.default.instance.getSpriteFrameByName("rarity_"+this._strongData.fightEvaluate)},t.prototype.onShowReward=function(){var e=this;this.onClearReward();var t=r.default.instence.strengthenData.rewardInfo;t.rewardId>0?g.default.instance.loadResByType(f.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(i){e.onIsShowRewardChild(!0,t.canGetReward),e.richTextRewardDesc.string=s.default.getStr("strong_reward_tips",t.recomendFight);var n=p.default.instance.getItemList(t.rewardId);if(n.length>0){var o=c.default.getNodeByPool(d.PoolType.ItemIcon,i,f.GlobalContext.Root+"prefab/Bag/ItemIcon");o.scale=.7,o.getComponent(h.default).ItemData(n[0],!0,null,!0),e.layerRewardContent.addChild(o)}},this):this.onIsShowRewardChild(!1)},t.prototype.onIsShowRewardChild=function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1),this.richTextRewardDesc.node.active=e,this.btnReward.interactable=e&&t,this.spriteRewardRed.active=e&&t},t.prototype.onShowSysList=function(){var e=this;c.default.setNodeChildDestoryByUrl(this.layerStrengthenContent,f.GlobalContext.Root+"prefab/Role/RoleStrengthen/RoleStrengthenItem"),g.default.instance.loadResByType(f.GlobalContext.Root+"prefab/Role/RoleStrengthen/RoleStrengthenItem",cc.Prefab,function(t){for(var i=e._strongData.sysFightDataList,n=0;n<i.length;n++){var o=c.default.getNodeByUrl(t,f.GlobalContext.Root+"prefab/Role/RoleStrengthen/RoleStrengthenItem");o.getComponent(u.default).onInitData(i[n]),e.layerStrengthenContent.addChild(o)}m.default.instance.setTimeout(function(){e._isFirst&&i.length>0&&(e.scrollView.scrollToTop(),e._isFirst=!1)},e,1)},this)},t.prototype.onMainInfo=function(){this.onShowPage()},t.prototype.onFightChange=function(){r.default.instence.strengthenData.clientOldFight>0&&r.default.instence.strengthenData.currentFight!=r.default.instence.strengthenData.clientOldFight&&r.default.instence.sendCmdStrongInfo()},t.prototype.onRewardInfo=function(){this.onShowReward()},t.prototype.onClearReward=function(){this.layerRewardContent.childrenCount>0&&c.default.setNodeToPool(d.PoolType.ItemIcon,this.layerRewardContent.children[0]),this.layerRewardContent.removeAllChildren()},t.prototype.onClickReward=function(){var e=r.default.instence.strengthenData.rewardInfo;e&&e.rewardIndex>=0&&r.default.instence.sendCmdGetReward(e.rewardIndex)},__decorate([_(cc.Node)],t.prototype,"spriteEvaluateValue",void 0),__decorate([_(cc.Label)],t.prototype,"labelCombatValue",void 0),__decorate([_(cc.Label)],t.prototype,"labelRecommendCombat",void 0),__decorate([_(cc.Node)],t.prototype,"layerRewardContent",void 0),__decorate([_(cc.RichText)],t.prototype,"richTextRewardDesc",void 0),__decorate([_(cc.Button)],t.prototype,"btnReward",void 0),__decorate([_(cc.Node)],t.prototype,"spriteRewardRed",void 0),__decorate([_(cc.ScrollView)],t.prototype,"scrollView",void 0),__decorate([_(cc.Node)],t.prototype,"layerStrengthenContent",void 0),t=__decorate([v],t)}(n.default);i.default=b,cc._RF.pop()},{"../../../../Core/CommonsResManager":"CommonsResManager","../../../../Core/Event":"Event","../../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../../Core/Language":"Language","../../../../Core/LoadManager":"LoadManager","../../../../Core/TimeController":"TimeController","../../../../Core/Widget":"Widget","../../../../Core/WindowType":"WindowType","../../../../GlobalContext":"GlobalContext","../../../../Util/Utils":"Utils","../../../Commons/RewardUtils":"RewardUtils","../../../Item/ItemIcon":"ItemIcon","../RoleStrengthenController":"RoleStrengthenController","../RoleStrengthenEvent":"RoleStrengthenEvent","./RoleStrengthenItem":"RoleStrengthenItem"}],RoleTitleAttrData:[function(e,t,i){"use strict";cc._RF.push(t,"dc6e4t/0yRJX5Ln/p4FPND1","RoleTitleAttrData"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(){this._attrType=0,this._attrValue=0}return e.prototype.onInit=function(e,t){this._attrType=e,this._attrValue=t},Object.defineProperty(e.prototype,"attrType",{get:function(){return this._attrType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"attrValue",{get:function(){return this._attrValue},enumerable:!0,configurable:!0}),e}();i.default=n,cc._RF.pop()},{}],RoleTitleAttrItem:[function(e,t,i){"use strict";cc._RF.push(t,"1d862LQMMhOKr8N1iPxpPLM","RoleTitleAttrItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Util/AttrUtil"),a=cc._decorator,r=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.labelTitle=null,t.labelAttrValue=null,t._attrData=null,t}return __extends(t,e),t.prototype.onInitData=function(e){this._attrData=e,this.onShowPage()},t.prototype.onShowPage=function(){this.labelTitle.string=o.default.getAttrName(this._attrData.attrType)+"\uff1a",this.labelAttrValue.string=this._attrData.attrValue+""},__decorate([s(cc.Label)],t.prototype,"labelTitle",void 0),__decorate([s(cc.Label)],t.prototype,"labelAttrValue",void 0),t=__decorate([r],t)}(n.default);i.default=l,cc._RF.pop()},{"../../../Core/Widget":"Widget","../../../Util/AttrUtil":"AttrUtil"}],RoleTitleController:[function(e,t,i){"use strict";cc._RF.push(t,"a2938eLsNpErI0URTVMjQxt","RoleTitleController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Controller"),o=e("../../../NetConnect/NetConnet"),a=e("./RoleTitleData/RoleTitleData"),r=e("../../../Core/ConfigsManager"),s=e("../../../Core/GameEventDispatcher"),l=e("./RoleTitleEvent"),c=e("../../../Global/GlobalValue"),d=e("../../../Core/Event"),p=e("../../Item/ItemController"),h=e("../RoleUtils"),u=cc._decorator,f=u.ccclass,g=(u.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._titleData=null,t._config=null,t._roleTitleData=new a.default,t._activeIndex=-1,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instence=this,this._config=r.ConfigsManager.instance.getConfigs("roletitleconf"),s.GameEventDispatcher.instance.on(d.EventDefiner.GetBackpackListinfo,this.onInitBagTitle,this),s.GameEventDispatcher.instance.on(d.EventDefiner.AddBackpackItem,this.onInitBagTitle,this),s.GameEventDispatcher.instance.on(d.EventDefiner.DelBackpackItem,this.onInitBagTitle,this),s.GameEventDispatcher.instance.on(d.EventDefiner.BackpackItemChange,this.onInitBagTitle,this),this.onInitBagTitle()},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.listNotification=function(){},t.prototype.sendCmdRoleTitleMain=function(){o.default.instance.sendProto({cmd:"roletitle"})},t.prototype.sendCmdRoleTitleActive=function(e){this.roleUseTitle||(this._activeIndex=e);var t={cmd:"roletitleoperation",index:e,type:!1};o.default.instance.sendProto(t)},t.prototype.sendCmdRoleTitleUse=function(e){var t={cmd:"roletitleoperation",index:e,type:!0};o.default.instance.sendProto(t)},t.prototype.onRoleTitleMain=function(e){e&&(this._titleData=e.state,this._roleTitleData.onInit(this._titleData,this._config,p.default.instance.getTitleList)),this._activeIndex>=0?(this.sendCmdRoleTitleUse(this._activeIndex),this._activeIndex=-1):s.GameEventDispatcher.instance.emit(l.RoleTitleEvent.RoleTitleInfo),h.RoleUtils.setRed()},Object.defineProperty(t.prototype,"roleTitleData",{get:function(){return this._roleTitleData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"roleUseTitle",{get:function(){return this._roleTitleData.useTitle},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"roleUseTitleIcon",{get:function(){return this.roleUseTitle?this.roleUseTitle.titleImageName:""},enumerable:!0,configurable:!0}),t.prototype.onAddRoleTitleAttr=function(e){e.maxHP=e.maxHP+this.roleTitleData.titleAddAttr[0],e.hp=e.hp+this.roleTitleData.titleAddAttr[0];for(var t=c.AttrType.MaxHp;t<=c.AttrType.DefCri;t++){var i=e.attr.GetVale(t);e.attr.ChangeAtt(t,i+this.roleTitleData.titleAddAttr[0])}},t.prototype.getTitleIconNameByType=function(e){var t=null,i=this._config.roletitleConf[1];for(var n in i)if(i[n].type==e){t=i[n].iconName;break}return t},Object.defineProperty(t.prototype,"getIsCanActive",{get:function(){return this._roleTitleData.isCanActive},enumerable:!0,configurable:!0}),t.prototype.onInitBagTitle=function(){},t.instence=null,t=i=__decorate([f],t)}(n.default));i.default=g,cc._RF.pop()},{"../../../Core/ConfigsManager":"ConfigsManager","../../../Core/Controller":"Controller","../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Global/GlobalValue":"GlobalValue","../../../NetConnect/NetConnet":"NetConnet","../../Item/ItemController":"ItemController","../RoleUtils":"RoleUtils","./RoleTitleData/RoleTitleData":"RoleTitleData","./RoleTitleEvent":"RoleTitleEvent"}],RoleTitleData:[function(e,t,i){"use strict";cc._RF.push(t,"442134s/hhCb5fhosfg6KxE","RoleTitleData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./RoleTitleItemData"),o=function(){function e(){this._titleList=[],this._selectIndex=0,this._configList=[],this._titleAddAttr=[0,0,0,0,0,0,0],this._useTitle=null,this._isCanActive=!1}return e.prototype.onInit=function(e,t,i){this._configList=t.roletitleConf[1],this._titleList=[],this._titleAddAttr=[0,0,0,0,0,0,0],this._isCanActive=!1;for(var o=0;o<this._configList.length;o++){var a=!1;if(e)for(var r=0;r<e.length;r++){var s=e[r].type;if(this._configList[o].type==s){(l=new n.default).onInit(this._configList[o],e[r].flag?3:2,e[r].time,o+100),this._titleList.push(l),3==l.status&&(this._useTitle=l),a=!0;break}}if(i&&!a)for(r=0;r<i.length;r++)if(this._configList[o].itemId==i[r]&&this._configList[o].itemId>0){var l;(l=new n.default).onInit(this._configList[o],1,0,o),this._titleList.push(l),a=!0,this._isCanActive=!0;break}if(!a)(l=new n.default).onInit(this._configList[o],0,0,o+200),this._titleList.push(l)}for(o=0;o<this._titleList.length;o++)for(r=o;r<this._titleList.length;r++)if(this._titleList[o].index>this._titleList[r].index){var c=this._titleList[o];this._titleList[o]=this._titleList[r],this._titleList[r]=c}if(this._titleList.length>0)for(o=0;o<this._titleList.length;o++)if(this._titleList[o].status>1)for(r=0;r<this._titleList[o].attrList.length;r++){var d=this._titleList[o].attrList[r];this._titleAddAttr.length>d.attrType&&(this._titleAddAttr[d.attrType]+=d.attrValue)}},Object.defineProperty(e.prototype,"titleList",{get:function(){return this._titleList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectIndex",{get:function(){return this._selectIndex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"titleAddAttr",{get:function(){return this._titleAddAttr},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useTitle",{get:function(){return this._useTitle},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCanActive",{get:function(){return this._isCanActive},enumerable:!0,configurable:!0}),e}();i.default=o,cc._RF.pop()},{"./RoleTitleItemData":"RoleTitleItemData"}],RoleTitleEvent:[function(e,t,i){"use strict";cc._RF.push(t,"bcf49WH3qBMCaRaJL8D5noV","RoleTitleEvent"),Object.defineProperty(i,"__esModule",{value:!0}),function(e){e.RoleTitleInfo="RoleTitleInfo",e.RoleTitleSelect="RoleTitleSelect"}(i.RoleTitleEvent||(i.RoleTitleEvent={})),cc._RF.pop()},{}],RoleTitleItemData:[function(e,t,i){"use strict";cc._RF.push(t,"f38f02oZBNB34q/b1uULARq","RoleTitleItemData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./RoleTitleAttrData"),o=function(){function e(){this._titleType=0,this._condition="",this._status=0,this._attrList=[],this._titleImageName="",this._titleIndex=0,this._day=0,this._index=0}return e.prototype.onInit=function(e,t,i,o){if(this._titleType=e.type,this._titleImageName=e.iconName,this._condition=e.condition,this._status=t,this._activeTime=i,this._day=e.day,this._titleIndex=e.type,this._attrList=[],this._index=o,e.propertyType.length==e.property.length)for(var a=0;a<e.propertyType.length;a++){var r=new n.default;r.onInit(e.propertyType[a],e.property[a]),this._attrList.push(r)}},Object.defineProperty(e.prototype,"titleType",{get:function(){return this._titleType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"condition",{get:function(){return this._condition},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canActive",{get:function(){return 1==this._status},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"attrList",{get:function(){return this._attrList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"titleImageName",{get:function(){return this._titleImageName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"titleIndex",{get:function(){return this._titleIndex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activeTime",{get:function(){return this._activeTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"haveDay",{get:function(){return this._day},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this._index},enumerable:!0,configurable:!0}),e}();i.default=o,cc._RF.pop()},{"./RoleTitleAttrData":"RoleTitleAttrData"}],RoleTitleItem:[function(e,t,i){"use strict";cc._RF.push(t,"d5344F2xolMj5jfOtGRb2Ue","RoleTitleItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../Commons/Image"),a=e("../../../Core/GameEventDispatcher"),r=e("./RoleTitleEvent"),s=e("../../../GlobalContext"),l=e("../../../Util/GrayEffect"),c=cc._decorator,d=c.ccclass,p=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.nodeSelectBG=null,t.nodeNormalBG=null,t.nodeTitle=null,t.spriteRed=null,t._titleData=null,t._selectIndex=0,t._itemIndex=0,t}return __extends(t,e),t.prototype.onInitData=function(e,t,i){this._titleData=i,this._selectIndex=e,this._itemIndex=t,this.node.on(cc.Node.EventType.TOUCH_END,this.onClick,this),this.onShowPage()},t.prototype.onChangeSelectIndex=function(e){this._selectIndex=e,this.onSetBG()},t.prototype.onSetBG=function(){this.nodeSelectBG.active=this._itemIndex==this._selectIndex,this.nodeNormalBG.active=this._itemIndex!=this._selectIndex},t.prototype.onShowPage=function(){this.onSetBG(),this.nodeTitle.getComponent(o.default).loadImageByHttps(s.GlobalContext.ResRoot+"resources/RoleTitle/"+this._titleData.titleImageName+".png"),this.nodeTitle.getComponent(l.default).setGray(0==this._titleData.status),this.spriteRed.active=this._titleData.canActive},t.prototype.onClick=function(){a.GameEventDispatcher.instance.emit(r.RoleTitleEvent.RoleTitleSelect,this._itemIndex)},__decorate([p(cc.Node)],t.prototype,"nodeSelectBG",void 0),__decorate([p(cc.Node)],t.prototype,"nodeNormalBG",void 0),__decorate([p(cc.Node)],t.prototype,"nodeTitle",void 0),__decorate([p(cc.Node)],t.prototype,"spriteRed",void 0),t=__decorate([d],t)}(n.default);i.default=h,cc._RF.pop()},{"../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Widget":"Widget","../../../GlobalContext":"GlobalContext","../../../Util/GrayEffect":"GrayEffect","../../Commons/Image":"Image","./RoleTitleEvent":"RoleTitleEvent"}],RoleTitlePage:[function(e,t,i){"use strict";cc._RF.push(t,"3aa79M5QS1GbISgWjAtnR88","RoleTitlePage"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Commons/CommonPageBG"),o=e("../../../Core/Language"),a=e("../../../Core/GameEventDispatcher"),r=e("./RoleTitleEvent"),s=e("./RoleTitleAttrItem"),l=e("./RoleTitleController"),c=e("./RoleTitleItem"),d=e("../../../Core/WindowManager"),p=e("../../../Core/WindowType"),h=e("../../../Core/TimeController"),u=e("../../../Util/DateUtil"),f=e("../../../Util/Utils"),g=e("../../Commons/Image"),y=e("../../../GlobalContext"),m=e("../../../Core/LoadManager"),C=cc._decorator,v=C.ccclass,_=C.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layerTitleContent=null,t.layerAttrContent=null,t.scrollViewTitle=null,t.labelCondition=null,t.labelRemainTime=null,t.spriteTitle=null,t.scrollViewAttr=null,t.btnAttr=null,t.btnActive=null,t.btnConfirm=null,t.labelAttrList=[],t.layerAttrPage=null,t._isShowAttrPage=!1,t._selectIndex=-1,t._titleDataList=[],t._itemTitleList=[],t._selectRoleTitle=null,t._remainTimeDelay=null,t._remainTime=0,t._intervalTime=1e3,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.onInit(769,536,o.default.getStr("role_title"),!0)},t.prototype.show=function(){e.prototype.show.call(this),this._isShowAttrPage=!1,this.layerAttrPage.opacity=0,this.node.setPosition(0,0),this.btnAttr.node.on(cc.Node.EventType.TOUCH_END,this.onClick,this),this.btnConfirm.node.on(cc.Node.EventType.TOUCH_END,this.onClick,this),this.btnActive.node.on(cc.Node.EventType.TOUCH_END,this.onClick,this),a.GameEventDispatcher.instance.on(r.RoleTitleEvent.RoleTitleSelect,this.onRoleTitleSelect,this),a.GameEventDispatcher.instance.on(r.RoleTitleEvent.RoleTitleInfo,this.onRoleTitleInfo,this),this.onRoleTitleInfo()},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),h.default.instance.clearInterval(this._remainTimeDelay),this.btnAttr.node.off(cc.Node.EventType.TOUCH_END,this.onClick,this),this.btnConfirm.node.off(cc.Node.EventType.TOUCH_END,this.onClick,this),this.btnActive.node.off(cc.Node.EventType.TOUCH_END,this.onClick,this),a.GameEventDispatcher.instance.off(r.RoleTitleEvent.RoleTitleSelect,this.onRoleTitleSelect,this),a.GameEventDispatcher.instance.off(r.RoleTitleEvent.RoleTitleInfo,this.onRoleTitleInfo,this)},t.prototype.onClose=function(){d.default.instance.close(p.WindowType.RoleTitleWin)},t.prototype.onRoleTitleInfo=function(){var e=this;this._itemTitleList=[],f.default.setNodeChildDestoryByUrl(this.layerTitleContent,y.GlobalContext.Root+"prefab/Role/RoleTitle/RoleTitleItem"),this._titleDataList=l.default.instence.roleTitleData.titleList.concat();var t=this._titleDataList.length;this._selectIndex=-1==this._selectIndex?l.default.instence.roleTitleData.selectIndex:this._selectIndex,m.default.instance.loadResByType(y.GlobalContext.Root+"prefab/Role/RoleTitle/RoleTitleItem",cc.Prefab,function(i){for(var n=0;n<t;n++){var o=f.default.getNodeByUrl(i,y.GlobalContext.Root+"prefab/Role/RoleTitle/RoleTitleItem");o.getComponent(c.default).onInitData(e._selectIndex,n,e._titleDataList[n]),e.layerTitleContent.addChild(o),e._itemTitleList.push(o)}e.onShowSelectTitle(),e.onShowTitleAttr(),e.scrollViewTitle.scrollToTop()},this)},t.prototype.onRoleTitleSelect=function(e){for(var t in this._selectIndex=e.detail,this._itemTitleList)this._itemTitleList[t]&&this._itemTitleList[t].getComponent(c.default).onChangeSelectIndex(this._selectIndex);this.onShowSelectTitle()},t.prototype.onShowSelectTitle=function(){var e=this;if(this._selectRoleTitle=this._titleDataList[this._selectIndex],this.labelCondition.string=this._selectRoleTitle.condition+"",m.default.instance.loadResByType(y.GlobalContext.Root+"prefab/Role/RoleTitle/RoleTilteAttrItem",cc.Prefab,function(t){for(var i in f.default.setNodeChildDestoryByUrl(e.layerAttrContent,y.GlobalContext.Root+"prefab/Role/RoleTitle/RoleTilteAttrItem"),e._selectRoleTitle.attrList){var n=f.default.getNodeByUrl(t,y.GlobalContext.Root+"prefab/Role/RoleTitle/RoleTilteAttrItem");n.getComponent(s.default).onInitData(e._selectRoleTitle.attrList[i]),e.layerAttrContent.addChild(n)}e.scrollViewAttr.scrollToTop()},this),this.spriteTitle.getComponent(g.default).loadImageByHttps(y.GlobalContext.ResRoot+"resources/RoleTitle/"+this._selectRoleTitle.titleImageName+".png"),f.default.setNodeActive([this.btnActive,this.btnConfirm],null),this.btnActive.node.active=1==this._selectRoleTitle.status||0==this._selectRoleTitle.status,this.btnActive.interactable=1==this._selectRoleTitle.status,this.btnConfirm.node.active=1!=this._selectRoleTitle.status&&0!=this._selectRoleTitle.status,this.btnConfirm.interactable=2==this._selectRoleTitle.status,this.labelRemainTime.node.active=this._selectRoleTitle.haveDay>0&&this._selectRoleTitle.activeTime>0,h.default.instance.clearInterval(this._remainTimeDelay),this._selectRoleTitle.haveDay>0&&this._selectRoleTitle.activeTime>0){var t=24*this._selectRoleTitle.haveDay*3600;this._remainTime=t-Math.floor((h.default.instance.ServerTimeMins-this._selectRoleTitle.activeTime)/1e3),this.onShowRemainTime(),this._remainTimeDelay=h.default.instance.setInterval(function(){e.onShowRemainTime()},this,this._intervalTime)}},t.prototype.onShowRemainTime=function(){this._remainTime<=1&&(this.labelRemainTime.node.active=!1,h.default.instance.clearInterval(this._remainTimeDelay)),this.labelRemainTime.string=o.default.getStr("role_title_remaintime",u.DateUtil.setTimeToChineseHM(this._remainTime,1))+"",this._remainTime-=this._intervalTime/1e3},t.prototype.onShowTitleAttr=function(){for(var e=l.default.instence.roleTitleData.titleAddAttr.concat(),t=0;t<this.labelAttrList.length;t++)this.labelAttrList[t].string=e[t]+""},t.prototype.onClick=function(e){var t=this;switch(e.target.name){case"btnAttr":this._isShowAttrPage=!this._isShowAttrPage,this._isShowAttrPage?this.node.runAction(cc.sequence(cc.moveTo(.2,-170,0),cc.callFunc(function(){t.layerAttrPage.runAction(cc.fadeTo(.2,255))}))):this.layerAttrPage.runAction(cc.sequence(cc.fadeTo(.2,0),cc.callFunc(function(){t.node.runAction(cc.moveTo(.2,0,0))})));break;case"btnConfirm":this.btnConfirm.interactable&&l.default.instence.sendCmdRoleTitleUse(this._selectRoleTitle.titleIndex);break;case"btnActive":this.btnActive.interactable&&l.default.instence.sendCmdRoleTitleActive(this._selectRoleTitle.titleIndex)}},__decorate([_(cc.Node)],t.prototype,"layerTitleContent",void 0),__decorate([_(cc.Node)],t.prototype,"layerAttrContent",void 0),__decorate([_(cc.ScrollView)],t.prototype,"scrollViewTitle",void 0),__decorate([_(cc.RichText)],t.prototype,"labelCondition",void 0),__decorate([_(cc.Label)],t.prototype,"labelRemainTime",void 0),__decorate([_(cc.Node)],t.prototype,"spriteTitle",void 0),__decorate([_(cc.ScrollView)],t.prototype,"scrollViewAttr",void 0),__decorate([_(cc.Button)],t.prototype,"btnAttr",void 0),__decorate([_(cc.Button)],t.prototype,"btnActive",void 0),__decorate([_(cc.Button)],t.prototype,"btnConfirm",void 0),__decorate([_([cc.Label])],t.prototype,"labelAttrList",void 0),__decorate([_(cc.Node)],t.prototype,"layerAttrPage",void 0),t=__decorate([v],t)}(n.default);i.default=b,cc._RF.pop()},{"../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Core/LoadManager":"LoadManager","../../../Core/TimeController":"TimeController","../../../Core/WindowManager":"WindowManager","../../../Core/WindowType":"WindowType","../../../GlobalContext":"GlobalContext","../../../Util/DateUtil":"DateUtil","../../../Util/Utils":"Utils","../../Commons/CommonPageBG":"CommonPageBG","../../Commons/Image":"Image","./RoleTitleAttrItem":"RoleTitleAttrItem","./RoleTitleController":"RoleTitleController","./RoleTitleEvent":"RoleTitleEvent","./RoleTitleItem":"RoleTitleItem"}],RoleTitle:[function(e,t,i){"use strict";cc._RF.push(t,"5cab74Hn3lBTp3pT97LR4qT","RoleTitle"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../Commons/Image"),a=e("../../../GlobalContext"),r=cc._decorator,s=r.ccclass,l=r.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.spriteImage=null,t}return __extends(t,e),t.prototype.onInitData=function(e){e&&""!=e?(this.node.active=!0,this.spriteImage.getComponent(o.default).loadImageByHttps(a.GlobalContext.ResRoot+"resources/RoleTitle/"+e+".png")):this.node.active=!1},__decorate([l(cc.Node)],t.prototype,"spriteImage",void 0),t=__decorate([s],t)}(n.default);i.default=c,cc._RF.pop()},{"../../../Core/Widget":"Widget","../../../GlobalContext":"GlobalContext","../../Commons/Image":"Image"}],RoleTrainVo:[function(e,t,i){"use strict";cc._RF.push(t,"88204T/PJ1GTKaM3A0a11km","RoleTrainVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){return function(e){for(var t in e)this[t]=e[t]}}();i.RoleTrainVo=n,cc._RF.pop()},{}],RoleUpgrading:[function(e,t,i){"use strict";cc._RF.push(t,"25594gTsYpPZ5SkmTmMs7DI","RoleUpgrading"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Core/WindowManager"),a=e("../../../GlobalContext"),r=e("../../Role/RoleInfo"),s=e("../../../Core/ConfigsManager"),l=e("../../../Core/GameEventDispatcher"),c=e("../../../Core/Event"),d=e("../Pool/SpinePools"),p=e("../../../Core/SpineBase"),h=e("../../Guide/GuideNewController"),u=cc._decorator,f=u.ccclass,g=u.property,y=function(e){function t(){var t=e.call(this)||this;return t.oneLayer=null,t.roleEffect=null,t.levelNode=null,t.energy=null,t.skeleton=null,t.animation=null,t.effect=null,t.modelEffect=null,t.endPos=cc.v2(320,124),t.isFightExit=!1,i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.playAni=function(){this.effect.active=!0,this.skeleton=this.animation.getComponentInChildren(sp.Skeleton),this.effect.position=cc.v2(0,0),this.skeleton.setCompleteListener(this.setEffectsFinished),this.skeleton.setAnimation(0,"animation01",!0);var e=cc.scaleTo(.26,1);this.levelNode.runAction(e)},t.prototype.show=function(){e.prototype.show.call(this),this.roleEffect.active=this.oneLayer.active=this.canClick=this.effect.active=!1,this.levelNode.scale=0,h.default.instance.pause()},t.prototype.hide=function(){for(var t in e.prototype.hide.call(this),this.oldData=null,this.isFightExit=null,this.skeleton.clearTracks(),d.SpinePools.recoverSpineNoder(this.animation.children[0]),this.modelEffect.children)d.SpinePools.recoverSpineNoder(this.modelEffect.children[t].children[0]);h.default.instance.resume()},t.prototype.setEffectsFinished=function(e){var t=i.instance;if("animation01"==e.animation.name&&(t.skeleton.clearTracks(),t.skeleton.setAnimation(0,"animation02",!0),t.effect.position!=new cc.Vec2(320,124))){t.effect.stopAllActions();var n=cc.sequence(cc.moveBy(.6,t.endPos),cc.callFunc(t.showNode));t.effect.runAction(n)}},t.prototype.showNode=function(){var e=i.instance;e.oneLayer.active=e.roleEffect.active=e.canClick=!0;for(var t=s.ConfigsManager.instance.getConfigs("levelconf"),n=Math.floor((r.MyRoleInfo.level-1)/5+5),o=t.LevelConf[e.oldData.level].savenum,l=Math.floor(r.MyRoleInfo.level/5+5),c=t.LevelConf[r.MyRoleInfo.level].savenum,h=t.LevelConf[r.MyRoleInfo.level].addEnergy,u=[e.oldData.level,n,o],f=[r.MyRoleInfo.level,l,c],g=[e.oldData.maxHp,e.oldData.attack,e.oldData.defence],y=[r.MyRoleInfo.maxHp,r.MyRoleInfo.attack,r.MyRoleInfo.defence],m=[],C=[e.oldData.maxHp,e.oldData.attack,e.oldData.defence],v=cc.find("Layer/oneLayer",e.node),_=1;_<=3;_++)cc.find("propLayer/oldVal"+_,v).getComponent(cc.Label).string=C[_-1]+"",m[_-1]=Math.ceil((y[_-1]-g[_-1])/50),cc.find("propLayer/nowVal"+_,v).getComponent(cc.Label).string=g[_-1]+"";e.energy.string=h+"";var b=["WarTeamLevel","SandTableStepNumber","SaveTeam"];for(_=0;_<=2;_++)e.setInfoData(v.getChildByName(b[_]),u[_]);var T=0,S=function(){if(T>=3)return cc.find("threeLayer",e.node).active=!0,void e.unschedule(S);v.getChildByName(["WarTeamLevel","SandTableStepNumber","SaveTeam"][T]).getChildByName("jiantou").active=!0,v.getChildByName(["WarTeamLevel","SandTableStepNumber","SaveTeam"][T]).getChildByName("value2").getComponent(cc.Label).string=f[T]+"",v.getChildByName(["WarTeamLevel","SandTableStepNumber","SaveTeam"][T]).getChildByName("value2").runAction(cc.sequence(cc.scaleTo(1.2,1.2),cc.scaleTo(1,1))),T++},I=function(){for(var t=!1,i=0;i<=2;i++)g[i]<y[i]&&(g[i]+=m[i],g[i]>y[i]&&(g[i]=y[i]),cc.find("propLayer/nowVal"+(i+1),v).getComponent(cc.Label).string=g[i]+"",t=!0);t||e.unschedule(I)};e.schedule(S,.5),e.schedule(I,.01);var w=r.MyRoleInfo.sex?"g":"b",D=e.modelEffect.getChildByName(w+"-v");D.children.length||d.SpinePools.addSpineNoder(D,cc.v2(0,0)).getComponent(p.default).initSpineData(a.GlobalContext.Root+"effects/animations/FightResult/"+w+"-v/"+w+"-v",null,"idle",!0)},t.prototype.initInfo=function(e,t){if(void 0===e&&(e=null),void 0===t&&(t=!1),this.animation.children.length)this.playAni();else{var i=d.SpinePools.addSpineNoder(this.animation,cc.v2(0,0)).getComponent(p.default);i.readlySpineCall=this.playAni,i.readlySpineCallThisObj=this,i.initSpineData(a.GlobalContext.Root+"spine/RoleUpgrading/effect",null,"animation01",!0)}this.oldData=JSON.parse(JSON.stringify(e)),this.isFightExit=t,this.levelNode.getComponent(cc.Label).string=r.MyRoleInfo.level+""},t.prototype.setInfoData=function(e,t){e.getChildByName("value1").getComponent(cc.Label).string=t+"",e.getChildByName("jiantou").active=!1,e.getChildByName("value2").getComponent(cc.Label).string=""},t.prototype.btn_close=function(){this.canClick&&(this.unschedule(this.schedule),o.default.instance.closeWindow(this.node),l.GameEventDispatcher.instance.emit(c.EventDefiner.FunOpenEvent,this.isFightExit))},t.instance=null,__decorate([g(cc.Node)],t.prototype,"oneLayer",void 0),__decorate([g(cc.Node)],t.prototype,"roleEffect",void 0),__decorate([g(cc.Node)],t.prototype,"levelNode",void 0),__decorate([g(cc.Label)],t.prototype,"energy",void 0),__decorate([g(cc.Node)],t.prototype,"animation",void 0),__decorate([g(cc.Node)],t.prototype,"effect",void 0),__decorate([g(cc.Node)],t.prototype,"modelEffect",void 0),t=i=__decorate([f],t)}(n.default);i.default=y,cc._RF.pop()},{"../../../Core/ConfigsManager":"ConfigsManager","../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/SpineBase":"SpineBase","../../../Core/Widget":"Widget","../../../Core/WindowManager":"WindowManager","../../../GlobalContext":"GlobalContext","../../Guide/GuideNewController":"GuideNewController","../../Role/RoleInfo":"RoleInfo","../Pool/SpinePools":"SpinePools"}],RoleUtils:[function(e,t,i){"use strict";cc._RF.push(t,"62a2eJMh9JN/J20MjkAnkSh","RoleUtils"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./RoleController"),o=e("../../Util/UtilsFight"),a=e("../Functionicon/FunctionIconController"),r=e("../../Core/WindowType"),s=function(){function e(){}return Object.defineProperty(e,"ctrl",{get:function(){return n.default.instance},enumerable:!0,configurable:!0}),e.isMaxLv=function(){return this.ctrl.isMaxLv},e.isMaxLvMaxStar=function(){var e=this.ctrl;return e.isMaxLv&&5==e.star},e.getNowData=function(){this.ctrl;return null},e.getOldData=function(){this.ctrl;return null},e.getNextData=function(){this.ctrl;return null},e.getNowAddPower=function(){var e=this.getNowAddAttr();return o.default.cptFight(3,e)},e.getNowAddAttr=function(){var e=this.ctrl,t=0==e.star?e.lv-2:e.lv-1,i=(0==e.star||e.star,{});if(t>=0)for(var n=0;n<7;n++);else for(n=0;n<7;n++)i[n]=0;return i},e.getOldAddAttr=function(){this.ctrl.lv;for(var e=0;e<7;e++);return{}},e.getNextAddAttr=function(){this.ctrl.lv;for(var e=0;e<7;e++);return{}},e.getNextAddPower=function(){var e=this.getNextAddAttr();return o.default.cptFight(3,e)},e.getQualityCount=function(){var e=this.ctrl,t=5==e.star?e.lv+1:e.lv,i=5==e.star?0:e.star,n=e.qualityData[t];return n?n[i].itemCnt:0},e.isManCultureLv=function(e){this.ctrl;return!1},e.setRed=function(){a.default.instance.FuncIconRedDeal(r.WindowType.RoleWin,this.getRedState())},e.getRedState=function(){return!!this.getTrainRed()},e.getTrainTypeRed=function(e){return this.ctrl.roleFaShionData[e].getRed()},e.getTrainRed=function(){var e=this.ctrl,t=!1;if(a.default.instance.checkIsOpenbyWindowtype(r.WindowType.RoleTrain,!1))for(var i=0;i<e.roleFaShionData.length;i++)if(this.getTrainTypeRed(i)){t=!0;break}return t},e.getAddRed=function(){this.ctrl;if(!this.isMaxLvMaxStar())this.getQualityCount();return!1},e.getBuffNum=function(){return 0},e}();i.RoleUtils=s,cc._RF.pop()},{"../../Core/WindowType":"WindowType","../../Util/UtilsFight":"UtilsFight","../Functionicon/FunctionIconController":"FunctionIconController","./RoleController":"RoleController"}],RoleWin:[function(e,t,i){"use strict";cc._RF.push(t,"61fd5pfAwtEg6Q+3ASAJ7se","RoleWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/GameEventDispatcher"),o=e("../../Core/Event"),a=e("./RoleInfo"),r=e("../../Core/Window"),s=e("../../Core/WindowType"),l=e("../../Core/LoadManager"),c=e("../Gamelayer/RoleHead"),d=e("../WarTeam/MonsterController"),p=e("../../Global/GlobalValue"),h=e("../../Core/ConfigsManager"),u=e("../../Util/Utils"),f=e("../Commons/MonsterPreview"),g=e("../../Core/Language"),y=e("./RoleController"),m=e("../Tips/OpTipsController"),C=e("../OpenWin/OpenWinController"),v=e("./RoleTitle/RoleTitleController"),_=e("./RoleTitle/RoleTitleEvent"),b=e("../Commons/WindowBg1"),T=e("./RoleConst"),S=e("../../Core/TimeController"),I=e("./RoleUtils"),w=e("../Functionicon/FunctionIconController"),D=e("../Fight/FightUtils"),R=e("../../GlobalContext"),A=e("../Artifact/ArtifactEquip"),N=cc._decorator,L=N.ccclass,E=N.property,B=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Left=null,t.Up=null,t.Down=null,t.AttributeContent=null,t.Model=null,t.Level=null,t.BaseAttribute1=null,t.BaseAttribute2=null,t.BaseAttribute3=null,t.BaseAttribute4=null,t.BaseAttribute5=null,t.BaseAttribute6=null,t.BaseAttribute7=null,t.CurrentExp=null,t.TargetExp=null,t.ExpProgress=null,t.StepNumber=null,t.RoleHead=null,t.spriteTitleRed=null,t.artifactLeft=null,t.artifactRight=null,t.artifactList=null,t.listNode=null,t.artifactImgs=null,t.wuXingNode=null,t.Togglechoose=0,t.bar=null,t._configs=null,t.Index=0,t.grailArrt=[],t.attrNumLabe=null,t.attrNumLabeTwo=null,t._selectIndex=0,t.isFrist=!1,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){var t=this;this.loadWindowCom=function(){t.onShowPage()},this.loadWindowComThis=this,e.prototype.onLoad.call(this),i.instance=this,this.bar=this.ExpProgress.getComponent(cc.ProgressBar),this._configs=h.ConfigsManager.instance.getConfigs("levelconf"),cc.find("Text/New Label",this.Left).getComponent(cc.Label).string=g.default.getStr("Role_2"),cc.find("Text/New Label",this.Up).getComponent(cc.Label).string=g.default.getStr("Role_3"),cc.find("Step",this.Up).getComponent(cc.Label).string=g.default.getStr("Role_5"),cc.find("BaseAttribute/New Label",this.Down).getComponent(cc.Label).string=g.default.getStr("Role_6"),cc.find("Prop/New Label",this.Down).getComponent(cc.Label).string=g.default.getStr("Role_7")},t.prototype.onInitData=function(e){this._selectIndex=e,this.onShowPage()},t.prototype.onShowPage=function(){var e=this;if(this.windowBg){var t=this.windowBg.getComponent(b.default);t.TabBtnList._delaySelectedIndexTime=0,t.TabBtnList.selectItem(this._selectIndex),this.updateRed()}else var i=S.default.instance.setTimeout(function(){e.onShowPage(),S.default.instance.clearTimeout(i)},this,50);this.onSetRoleTitleRed()},t.prototype.start=function(){e.prototype.start.call(this),this.AttributeValue()},t.prototype.onJumpPage=function(e){var t=e.detail;this.windowBg.getComponent(b.default).TabBtnList.selectItem(t)},t.prototype.show=function(){this.onShowModel(),this.AttributeValue(),n.GameEventDispatcher.instance.on(o.EventDefiner.RoleJumpPage,this.onJumpPage,this),n.GameEventDispatcher.instance.on(o.EventDefiner.InitPlayerInfo,this.AttributeValue,this),n.GameEventDispatcher.instance.on(o.EventDefiner.AttributeChange,this.AttributeValue,this),n.GameEventDispatcher.instance.on(o.EventDefiner.SkillChange,this.onShowSkinInfo,this),n.GameEventDispatcher.instance.on(o.EventDefiner.ExpChange,this.AttributeValue,this),n.GameEventDispatcher.instance.on(_.RoleTitleEvent.RoleTitleInfo,this.onChangeRoleTitle,this),n.GameEventDispatcher.instance.on(o.EventDefiner.RoleClearUpdate,this.updateRed,this),n.GameEventDispatcher.instance.on(o.EventDefiner.ARTIFACT_SKILL,this.artifactInit,this),this.onShowPage(),this.artifactInit()},t.prototype.hide=function(){(e.prototype.hide.call(this),this.isFrist=!1,n.GameEventDispatcher.instance.off(_.RoleTitleEvent.RoleTitleInfo,this.onChangeRoleTitle,this),n.GameEventDispatcher.instance.off(o.EventDefiner.InitPlayerInfo,this.AttributeValue,this),n.GameEventDispatcher.instance.off(o.EventDefiner.AttributeChange,this.AttributeValue,this),n.GameEventDispatcher.instance.off(o.EventDefiner.SkillChange,this.onShowSkinInfo,this),n.GameEventDispatcher.instance.off(o.EventDefiner.ExpChange,this.AttributeValue,this),n.GameEventDispatcher.instance.off(o.EventDefiner.RoleJumpPage,this.onJumpPage,this),n.GameEventDispatcher.instance.off(o.EventDefiner.RoleClearUpdate,this.updateRed,this),n.GameEventDispatcher.instance.off(o.EventDefiner.ARTIFACT_SKILL,this.artifactInit,this),n.GameEventDispatcher.instance.emit("CloseRoleWin",this),this.Model.childrenCount>0)&&(this.Model.children[0].getComponent(f.default).clear(),u.default.setNodeToPool(s.PoolType.MonsterPreview,this.Model.children[0]))},t.prototype.onShowModel=function(){var e;this.Model.childrenCount||((e=u.default.getNodeByPool(s.PoolType.MonsterPreview,d.default.instance.MonsterPreview)).setScale(1),this.Model.addChild(e)),this.Model.getComponentInChildren(f.default).init("role",a.MyRoleInfo.currentsurface,1,p.DEFAULTS_SKIN+1+"",p.PRIORITY.MONSTER),this.onChangeRoleTitle()},t.prototype.onChangeRoleTitle=function(){this.Model.getComponentInChildren(f.default).onShowRoleTitle(v.default.instence.roleUseTitleIcon),this.onSetRoleTitleRed()},t.prototype.AttributeValue=function(){var e=this;this.grailArrt=[];var t=0;this.scheduleOnce(function(){e.RoleHead.getComponent(c.default).SetHead(a.MyRoleInfo.icon)},.1),this.Level.getChildByName("LevelLabel").getComponent(cc.Label).string=a.MyRoleInfo.level+g.default.getStr("RoleLevel"),this.CurrentExp.string=a.MyRoleInfo.exp+"",this.TargetExp.string=this._configs.LevelConf[a.MyRoleInfo.level].exp?this._configs.LevelConf[a.MyRoleInfo.level].exp:0,(t=Math.floor(a.MyRoleInfo.level/5+5))>15&&(t=15),this.StepNumber.string=t+D.FightUtils.additionalReserveNum()+"";var i=Number(this.CurrentExp.string),n=Number(this.TargetExp.string);this.bar.progress=i/n,this.BaseAttribute1.string=a.MyRoleInfo.maxHp+"",this.BaseAttribute2.string=a.MyRoleInfo.attack+"",this.BaseAttribute3.string=a.MyRoleInfo.defence+"",this.BaseAttribute4.string=a.MyRoleInfo.hit+"",this.BaseAttribute5.string=a.MyRoleInfo.Dodge+"",this.BaseAttribute6.string=a.MyRoleInfo.Critical+"",this.BaseAttribute7.string=a.MyRoleInfo.DefCri+"",this.setWuXingInfo();for(var o=0;o<y.default.instance.grailInfo.length;o++){var r=y.default.instance.grailInfo[o];-1!=r.type&&this.grailArrt.push(r.type)}},t.prototype.setWuXingInfo=function(){for(var e=0;e<this.wuXingNode.childrenCount;e++){var t=this.wuXingNode.children[e];t.getChildByName("num").getComponent(cc.Label).string=a.MyRoleInfo.attr.GetAttrVale(Number(t.name))}},t.prototype.onClickStepShuoming=function(){m.default.instance.ShowMsg(g.default.getStr("Step_shuoming"))},t.prototype.onShowSkinInfo=function(){this.onShowModel()},t.prototype.OpenGrail=function(){C.default.instance.openWindow(s.WindowType.Artifact)},t.prototype.onClickRoleTitle=function(){v.default.instence.roleTitleData.titleList.length<1?m.default.instance.ShowMsg(g.default.getStr("role_title_none")):C.default.instance.openWindow(s.WindowType.RoleTitleWin)},t.prototype.onSetRoleTitleRed=function(){this.spriteTitleRed.active=v.default.instence.getIsCanActive,this.updateRed()},t.prototype.updateRed=function(){if(this.windowBg){var e=this.windowBg.getComponent(b.default);e.TabBtnList.selectItemSetRed(T.RolePageType.Culture,I.RoleUtils.getTrainRed()),e.TabBtnList.selectItemSetRed(T.RolePageType.News,v.default.instence.getIsCanActive)}},t.prototype.conditionCallback=function(t){e.prototype.conditionCallback.call(this,t);var i=y.default.instance.constData;return t==T.RolePageType.News&&this.onShowSkinInfo(),t==T.RolePageType.News||w.default.instance.checkIsOpenbyWindowtype(i[t],!0)},t.prototype.tabBtnSelectedChange=function(t){e.prototype.tabBtnSelectedChange.call(this,t),y.default.instance.pageIndex=t},t.prototype.onClickRule=function(){n.GameEventDispatcher.instance.emit(o.EventDefiner.OpenRulePage,s.WindowType.RoleWin)},t.prototype.artifactInit=function(){var e=y.default.instance.artifact;e[0]>=0&&(this.artifactLeft.getChildByName("icon").active=!0,this.artifactLeft.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=this.artifactImgs.getSpriteFrame("artifactIcon_"+e[0]),this.artifactLeft.getChildByName("lock").active=!1,this.artifactLeft.getChildByName("fireicon").active=!0);var t=y.default.instance.artfactConf;w.default.instance.checkIsPass(t.unlock[2].openChapter-1,t.unlock[2].openGuanqia-1)&&(e[1]>=0?(this.artifactRight.getChildByName("icon").active=!0,this.artifactRight.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=this.artifactImgs.getSpriteFrame("artifactIcon_"+e[1]),this.artifactRight.getChildByName("lock").active=!1,this.artifactRight.getChildByName("fireicon").active=!0,this.artifactRight.getChildByName("click").active=!1):(this.artifactRight.getChildByName("click").active=!0,this.artifactRight.getChildByName("lock").active=!1))},t.prototype.onclickCloseList=function(){this.listNode.active=!1},t.prototype.onclickOpenList=function(e,t){var i=this,n=y.default.instance.artifact,o=y.default.instance.artfactConf;if(1==t){if(n[0]<0)return void w.default.instance.checkIsOpenbyWindowtype(s.WindowType.Artifact,!0);this.artifactList.x=-500}else{if(!w.default.instance.checkIsPass(o.unlock[2].openChapter-1,o.unlock[2].openGuanqia-1))return void m.default.instance.ShowMsg(g.default.getStr("function_open_tips",o.unlock[2].openChapter+"\u7ae0",o.unlock[2].openGuanqia+"\u5173"));this.artifactList.x=-175}this.listNode.active=!0;var a=y.default.instance.artfactList;u.default.setNodeChildDestoryByUrl(this.artifactList,R.GlobalContext.Root+"prefab/Artifact/ArtifactEquip"),l.default.instance.loadResByType(R.GlobalContext.Root+"prefab/Artifact/ArtifactEquip",cc.Prefab,function(e){for(var o=0;o<a.length;o++)if(a[o].isActive&&o!=n[0]){var r=u.default.getNodeByPool(s.PoolType.ArtifactEquip,e,R.GlobalContext.Root+"prefab/Artifact/ArtifactEquip");r.getComponent(A.default).initData(o,t),i.artifactList.addChild(r)}},this)},t.instance=null,__decorate([E(cc.Node)],t.prototype,"Left",void 0),__decorate([E(cc.Node)],t.prototype,"Up",void 0),__decorate([E(cc.Node)],t.prototype,"Down",void 0),__decorate([E(cc.Node)],t.prototype,"AttributeContent",void 0),__decorate([E(cc.Node)],t.prototype,"Model",void 0),__decorate([E(cc.Node)],t.prototype,"Level",void 0),__decorate([E(cc.Label)],t.prototype,"BaseAttribute1",void 0),__decorate([E(cc.Label)],t.prototype,"BaseAttribute2",void 0),__decorate([E(cc.Label)],t.prototype,"BaseAttribute3",void 0),__decorate([E(cc.Label)],t.prototype,"BaseAttribute4",void 0),__decorate([E(cc.Label)],t.prototype,"BaseAttribute5",void 0),__decorate([E(cc.Label)],t.prototype,"BaseAttribute6",void 0),__decorate([E(cc.Label)],t.prototype,"BaseAttribute7",void 0),__decorate([E(cc.Label)],t.prototype,"CurrentExp",void 0),__decorate([E(cc.Label)],t.prototype,"TargetExp",void 0),__decorate([E(cc.Node)],t.prototype,"ExpProgress",void 0),__decorate([E(cc.Label)],t.prototype,"StepNumber",void 0),__decorate([E(c.default)],t.prototype,"RoleHead",void 0),__decorate([E(cc.Node)],t.prototype,"spriteTitleRed",void 0),__decorate([E(cc.Node)],t.prototype,"artifactLeft",void 0),__decorate([E(cc.Node)],t.prototype,"artifactRight",void 0),__decorate([E(cc.Node)],t.prototype,"artifactList",void 0),__decorate([E(cc.Node)],t.prototype,"listNode",void 0),__decorate([E(cc.SpriteAtlas)],t.prototype,"artifactImgs",void 0),__decorate([E(cc.Node)],t.prototype,"wuXingNode",void 0),t=i=__decorate([L],t)}(r.default);i.default=B,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/Window":"Window","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Artifact/ArtifactEquip":"ArtifactEquip","../Commons/MonsterPreview":"MonsterPreview","../Commons/WindowBg1":"WindowBg1","../Fight/FightUtils":"FightUtils","../Functionicon/FunctionIconController":"FunctionIconController","../Gamelayer/RoleHead":"RoleHead","../OpenWin/OpenWinController":"OpenWinController","../Tips/OpTipsController":"OpTipsController","../WarTeam/MonsterController":"MonsterController","./RoleConst":"RoleConst","./RoleController":"RoleController","./RoleInfo":"RoleInfo","./RoleTitle/RoleTitleController":"RoleTitleController","./RoleTitle/RoleTitleEvent":"RoleTitleEvent","./RoleUtils":"RoleUtils"}],Role:[function(e,t,i){"use strict";cc._RF.push(t,"1ed24uDGpNGTaozp48kOVZq","Role"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./Animal"),o=e("../../Global/GlobalValue"),a=cc._decorator,r=a.ccclass,s=(a.property,function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.clear=function(){e.prototype.clear.call(this)},t.prototype.disappear=function(){this.setBloodVisible(!1),e.prototype.disappear.call(this)},t.prototype.updateData=function(t,i){e.prototype.updateData.call(this,t,i),this.movingTag&&this.moving(t)},t.prototype.updateSit=function(t,i){e.prototype.updateSit.call(this,t,i)},t.prototype.idle=function(e){this.beforeChangeAnim(),this.avatar&&this.avatar.play(o.ACTION.STAND,null,e)},t.prototype.run=function(e){this.beforeChangeAnim(),this.avatar&&this.avatar.play(o.ACTION.WALK,null,e)},t.prototype.dead=function(t){this.beforeChangeAnim(),e.prototype.dead.call(this)},t.prototype.reLive=function(e){this.idle(e)},t.prototype.beforeChangeAnim=function(){},t.prototype.attack=function(t,i){this.beforeChangeAnim(),e.prototype.attack.call(this,t,i)},t.prototype.stopMove=function(){this.movingTag=!1,this.noticeUpdateBodyMoveTargetXY(this.worldX,this.worldY),this.status!=o.ACTION.STAND&&this.idle()},t.prototype.stopMoveAndIdle=function(){this.movingTag=!1,this.status!=o.ACTION.STAND&&this.idle()},t=__decorate([r],t)}(n.default));i.default=s,cc._RF.pop()},{"../../Global/GlobalValue":"GlobalValue","./Animal":"Animal"}],RulePage:[function(e,t,i){"use strict";cc._RF.push(t,"8ffefPRXaRL95ebHxQwyrjp","RulePage"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/WindowManager"),a=e("../../Core/WindowType"),r=e("../../Core/ConfigsManager"),s=e("../../Core/Language"),l=e("../../Core/TimeController"),c=e("../../GlobalContext"),d=cc._decorator,p=d.ccclass,h=d.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layerBG=null,t.richTextDesc=null,t.labelTitle=null,t.scrollView=null,t._helpTextCfg=null,t._maxViewHeight=330,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this._helpTextCfg=r.ConfigsManager.instance.getConfigs("help"),i.instance=this},t.prototype.show=function(){e.prototype.show.call(this),this.layerBG.setContentSize(c.GlobalContext.UIWidth,c.GlobalContext.UIHeight)},t.prototype.setDataByWindowType=function(e,t,i){var n=this;if(void 0===e&&(e=0),void 0===t&&(t=""),void 0===i&&(i=""),e>0){if(this._helpTextCfg&&this._helpTextCfg.help){var o=this._helpTextCfg.help[e];this.labelTitle.string=o?o.title:s.default.getStr("rule_title"),this.richTextDesc.string=o?o.desc:s.default.getStr("rule_error",e)}}else t&&""!=t&&(this.labelTitle.string=i||s.default.getStr("rule_title"),this.richTextDesc.string=t+"");l.default.instance.setTimeout(function(){n.onResetScrollView()},this,5)},t.prototype.onResetScrollView=function(){this.richTextDesc.node.height>this._maxViewHeight?this.scrollView.scrollToTop():this.scrollView.scrollToPercentVertical(.5)},t.prototype.onClickClose=function(){o.default.instance.close(a.WindowType.RulePage)},t.instance=null,__decorate([h(cc.Node)],t.prototype,"layerBG",void 0),__decorate([h(cc.RichText)],t.prototype,"richTextDesc",void 0),__decorate([h(cc.Label)],t.prototype,"labelTitle",void 0),__decorate([h(cc.ScrollView)],t.prototype,"scrollView",void 0),t=i=__decorate([p],t)}(n.default);i.default=u,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Language":"Language","../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext"}],SAttributeConst:[function(e,t,i){"use strict";cc._RF.push(t,"937b0j+QCRAtrR93UDdqY0W","SAttributeConst"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(){}return e.PROP_ENTITY_ID=0,e.PROP_ENTITY_POS=1,e.PROP_ENTITY_POS2=2,e.PROP_ICON_MODEL=3,e.PROP_LEVEL=4,e.PROP_HP=5,e.PROP_MAXHP=6,e.PROP_ATK=7,e.PROP_DEF=8,e.PROP_HIT=9,e.PROP_AVOID=10,e.PROP_CRI=11,e.PROP_CRT_RES=12,e.PROP_BLOCK=13,e.PROP_PEN=14,e.PROP_SKILL_INC=15,e.PROP_SKILL_DEC=16,e.PROP_SKILL_ADD=17,e.PROP_CRT_ADD=18,e.PROP_CRT_RES_ADD=19,e.PROP_AVOID_ADD=20,e.PROP_HIT_ADD=21,e.PROP_BLOCK_ADD=22,e.PROP_PEN_ADD=23,e.PROP_CRT_DMG=24,e.PROP_BLOCK_DMG=25,e.PROP_IGN_DEF=26,e.PROP_DMG_DEC=27,e.PROP_PVP_DMG_INC=28,e.PROP_PVP_DMG_DEC=29,e.PROP_PVE_DMG_INC=30,e.PROP_PVE_DMG_DEC=31,e.PROP_MOVE_SPEED=32,e.PROP_CREATURE_STATE=33,e.PROP_FUBEN_CAMP=34,e.PROP_ACTOR_PK_MOD=35,e.PROP_SEX=36,e.PROP_VOCATION=37,e.PROP_EXP=38,e.PROP_MAX_EXP=39,e.PROP_VIP=40,e.PROP_COIN=41,e.PROP_BIND_YUANBAO=42,e.PROP_YUANBAO=43,e.PROP_GIVE_YUANBAO=44,e.PROP_TOTAL_ONLINE=45,e.PROP_DAILY_ONLINE=46,e.PROP_TOTAL_DAYS=47,e.PROP_ACTOR_BAG_GRID_COUNT=48,e.PROP_ACTOR_DEPOT_GRID_COUNT=49,e.PROP_GUILD_ID=50,e.PROP_TEAM_ID=51,e.PROP_SYSTEM_OPEN=52,e.PROP_ACTOR_FIGHT_VALUE=53,e}();i.SAttributeConst=n,cc._RF.pop()},{}],SAttributeEvent:[function(e,t,i){"use strict";cc._RF.push(t,"f0bb7Q2dFdLxZlEv3y1duth","SAttributeEvent"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(e){function t(t,i,n){var o=e.call(this,t,!1)||this;return o._oldValue=i,o._value=n,o}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"oldValue",{get:function(){return this._oldValue},enumerable:!0,configurable:!0}),t.INIT_DATA="SAttributeEvent.INIT_DATA",t.UPDATE_NAME="SAttributeEvent.UPDATE_NAME",t.UPDATE_MONEY="SAttributeEvent.UPDATE_MONEY",t.UPDATE_DATA_="SAttributeEvent.UPDATE_DATA_",t}(cc.Event);i.SAttributeEvent=n,cc._RF.pop()},{}],SDKPlatform:[function(e,t,i){"use strict";cc._RF.push(t,"5ec90UPi9VPl4dzKvtidDTW","SDKPlatform"),Object.defineProperty(i,"__esModule",{value:!0}),function(e){e.NONE="1",e.QQAudit="2",e.APP="3",e.Bilibili="4",e.XYHD="5",e.Test="99"}(i.SDKPlatfotmType||(i.SDKPlatfotmType={})),cc._RF.pop()},{}],SDKUtils:[function(e,t,i){"use strict";cc._RF.push(t,"6b7d9FqWh9A64DkI2cr+9L+","SDKUtils"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../GlobalContext"),o=e("./LocalStorageUtils"),a=e("../Core/GameEventDispatcher"),r=e("../Core/Event"),s=e("../Module/Role/RoleInfo"),l=e("../Core/ConfigsManager"),c=e("../Module/SDK/GameSDK"),d=e("../Module/SDK/SDKPlatform"),p=cc._decorator,h=p.ccclass,u=(p.property,function(){function e(){this._sdkUtilsInit=!1,this.defaultUrl=null,this.sdk={},this._platformSdk=null,this.wsUrl="",this.help="",this.helpname="",this.topupinfo="",this.rewardedVideoAdId=null,this._isInitWX=!1,this.shareTitle="",this.shareImageUrl="",this.getCurrentTimeFun=null,this.getCurrentTimeFunThisObj=null,this._bannerAd=null,this._rewardedVideoAd=null,this._rewardedVideoAdOnCloseFun=null,this._rewardedVideoAdOnCloseFunThisObj=null,this._rechargePrice=.1,this._offerId="",this.loginData={},this._getPhoneGameData=null,this._isInitJsb=!1,this.platid="0",this._registerJsMethodToNativeDic={}}var t;return t=e,Object.defineProperty(e,"instance",{get:function(){return t._instance||(t._instance=new t,t._instance.init()),t._instance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"openId",{get:function(){return this.platformSdk.openId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"session_key",{get:function(){return this.platformSdk.session_key},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gameID",{get:function(){return this.platformSdk.gameID},enumerable:!0,configurable:!0}),e.prototype.init=function(){},e.prototype.sendToConnect=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null);var i="";i=this.getQueryString("locality")?this.getQueryString("websocketdomain")+":"+this.getQueryString("port")+"/?userid="+this.openId+"&timestamp="+Math.floor(Date.now()/1e3)+"&dbidx=1&sign=3151edbd94ffe344d55fb6b4ace984c2327531cd":this.defaultUrl&&""!=this.defaultUrl?this.defaultUrl:this.getQueryString("websocketdomain")?this.getQueryString("websocketdomain")+":"+this.getQueryString("port")+"/?userid="+this.openId+"&timestamp="+Math.floor(Date.now()/1e3)+"&dbidx=1&sign=3151edbd94ffe344d55fb6b4ace984c2327531cd":"ws://192.168.1.208:20010/?userid="+this.openId+"&timestamp="+Math.floor(Date.now()/1e3)+"&dbidx=1&sign=3151edbd94ffe344d55fb6b4ace984c2327531cd",e&&e.call(t,{msg:"none",url:i})},e.prototype.getQueryString=function(e){var t,i=new RegExp("(^|&)"+e+"=([^&]*)(&|$)");return window&&window.location&&window.location.search&&""!=window.location.search&&null!==(t=window.location.search.substr(1).match(i))?unescape(t[2]):null},Object.defineProperty(e.prototype,"isInitWX",{get:function(){return this._isInitWX},enumerable:!0,configurable:!0}),e.prototype.initWX=function(){this._isInitWX=!0,console.log("\u83b7\u53d6\u8fdb\u5165\u6e38\u620f\u53c2\u6570:",qq.getLaunchOptionsSync()),console.log("\u83b7\u53d6\u7cfb\u7edf\u4fe1\u606f:",qq.getSystemInfoSync()),qq.getLaunchOptionsSync().query.help&&qq.getLaunchOptionsSync().query.topupinfo&&(this.help=qq.getLaunchOptionsSync().query.help,this.topupinfo=qq.getLaunchOptionsSync().query.topupinfo,this.helpname=qq.getLaunchOptionsSync().query.name),this.postMessageToSubDomain({cmd:"shareTicket",value:qq.getLaunchOptionsSync().shareTicket}),this.postMessageToSubDomain({cmd:"openId",value:this.openId}),n.PlayerData.SceneBorld=qq.getSystemInfoSync().statusBarHeight,qq.getSystemInfoSync().statusBarHeight>20&&("ios"==qq.getSystemInfoSync().platform?n.PlayerData.SceneBorld=40:"vivo"==qq.getSystemInfoSync().brand&&(n.PlayerData.SceneBorld=40)),console.log("PlayerData.SceneBorld = "+n.PlayerData.SceneBorld),this.initShare("\u6b22\u8fce\u6765\u5230\u53f2\u83b1\u59c6\uff01","https://cdn.qmttl.moyangmoyang.com/slm_qq/imgShare.bg"),this.initRewardedVideoAd(),qq.onShow(this.onshow),qq.onHide(this.onhide)},e.prototype.onshow=function(e){cc.sys.garbageCollect(),0==n.GlobalContext.GameForeground&&(n.GlobalContext.GameForeground=!0,console.log("GameShow"),a.GameEventDispatcher.instance.emit(r.EventDefiner.GameForegroundChange),e&&e.query&&(e.query.help&&e.query.topupinfo?a.GameEventDispatcher.instance.emit(r.EventDefiner.DiamondShop,e.query):e.query.send&&a.GameEventDispatcher.instance.emit(r.EventDefiner.ShareTicket,{ticket:e.shareTicket,query:e.query})))},e.prototype.onhide=function(){cc.sys.garbageCollect(),1==n.GlobalContext.GameForeground&&(n.GlobalContext.GameForeground=!1,console.log("GameHide"),a.GameEventDispatcher.instance.emit(r.EventDefiner.GameBackgroundChange))},e.prototype.getLaunchOptionsSync=function(){return 1==this._isInitWX?qq.getLaunchOptionsSync():{}},e.prototype.getEnterType=function(){var e=this.getLaunchOptionsSync().query,t=this.getLaunchOptionsSync().shareTicket;return t?(console.log("\u8fdb\u5165\u6e38\u620f\uff0c\u6765\u81ea\u7fa4\u5206\u4eab\u94fe\u63a5, shareTicket:"+t),2):e&&e.shareType&&1==Number(e.shareType)?(console.log("\u8fdb\u5165\u6e38\u620f\uff0c\u6765\u81ea\u597d\u53cb\u5206\u4eab\u94fe\u63a5, query:",e),1):(console.log("\u8fdb\u5165\u6e38\u620f\uff0c\u81ea\u5df1\u8fdb\u5165\u6e38\u620f"),0)},e.prototype.restart=function(){console.log("\u5237\u65b0\u5c0f\u6e38\u620f"),cc.loader._cache={},cc.game.restart()},e.prototype.close=function(){console.log("\u5173\u95ed\u5c0f\u6e38\u620f"),1==this._isInitWX?qq.exitMiniProgram():window.location.reload()},e.prototype.setItem=function(e,t){o.default.instance.setItem(e,t)},e.prototype.getItem=function(e){return o.default.instance.getItem(e)},e.prototype.cleanItem=function(e){o.default.instance.removeItem(e)},e.prototype.postMessageToSubDomain=function(e){console.log("\u4e3b\u57df\u5411\u5b50\u57df\u53d1\u9001\u4fe1\u606f:",e)},e.prototype.initShare=function(e,t){this.shareTitle=e,this.shareImageUrl=t},e.prototype.shareAppMessage=function(e,t,i,n,o,a,r){var s=this;if(void 0===e&&(e=null),void 0===t&&(t=null),void 0===i&&(i=null),void 0===n&&(n=null),void 0===o&&(o=null),void 0===a&&(a=null),void 0===r&&(r=null),a||(a=this.shareTitle),r||(r=this.shareImageUrl),0==this._isInitWX)return console.log("\u8fd8\u6ca1\u521d\u59cb\u5316\u5fae\u4fe1\uff0c\u76f4\u63a5\u5f53\u6210\u5206\u4eab\u6210\u529f"),void(e&&e.call(t));var l={title:a};l.query=i?i+"&"+this.getQueryShareInfo():this.getQueryShareInfo(),r&&(l.imageUrl=r),console.log("\u5206\u4eab\uff1a"+JSON.stringify(l)),tdgamesdk.mysdk.getDyb().share(l,function(i){console.log("\u5206\u4eab\u8c03\u7528",i),1==i.code?(s.shareSuccessSdk(),e&&e.call(t)):n&&n.call(o)})},e.prototype.getQueryShareInfo=function(){return"shareType=1&userId="+this.openId},e.prototype.shareSuccessSdk=function(){},e.prototype.saveMyData=function(e,t,i){t.saveData_endTime=i,t.saveData_startTime=this.getCurrentTime();var n=JSON.stringify(t);this.postMessageToSubDomain({cmd:"saveMyData",key:e,value:n})},e.prototype.getCurrentTime=function(){return this.getCurrentTimeFun?this.getCurrentTimeFun.call(this.getCurrentTimeFunThisObj):Date.now()},e.prototype.getDataEndTime=function(){var e=new Date(this.getCurrentTime()),t=e.getDay();0==t&&(t=7),console.log("\u5f53\u524d\u5468\u51e0: "+t);var i=7-t,n=e.getTime(),o=new Date(n+=6e4*i*60*24);return o.setHours(23,59,59,0),console.log("\u6e05\u7406\u65f6\u95f4\uff1a"+o.toLocaleString()),o.getTime()},e.prototype.createBannerAd=function(e){var t=this;if(this._bannerAd&&this._bannerAd.destroy(),e&&""!=e)if(0!=this._isInitWX){var i=qq.getSystemInfoSync();this._bannerAd=qq.createBannerAd({adUnitId:e,style:{left:0,top:Number(i.screenHeight),width:Number(i.screenWidth)}}),this._bannerAd.onError(function(e){console.log("bannerAd.onError: ",e)}),this._bannerAd.onLoad(function(){console.log("banner \u5e7f\u544a\u52a0\u8f7d\u6210\u529f")}),this._bannerAd.onResize(function(e){console.log("banner \u5e7f\u544a",e.width,e.height),console.log("banner \u5e7f\u544a, realWidth",t._bannerAd.style.realWidth,t._bannerAd.style.realHeight),t._bannerAd.style.top=Number(i.screenHeight)-t._bannerAd.style.realHeight}),console.log("bannerAd  \u663e\u793a\u5e7f\u544a, adUnitId:"+e),this._bannerAd.show()}else console.log("\u8fd8\u6ca1\u521d\u59cb\u5316\u5fae\u4fe1\uff0c\u76f4\u63a5\u5f53\u6210\u662f\u6210\u529f")},e.prototype.hideBannerAd=function(){this._bannerAd&&(this._bannerAd.hide(),console.log("bannerAd  \u9690\u85cf\u5e7f\u544a"))},e.prototype.initRewardedVideoAd=function(){var e=this,t=this.rewardedVideoAdId;t&&""!=t&&(this._rewardedVideoAd||(this._rewardedVideoAd=qq.createRewardedVideoAd({adUnitId:t}),this._rewardedVideoAd.onClose(function(t){var i=!0;i=!!(t&&t.isEnded||void 0===t),console.log("\u5173\u95ed\u89c6\u9891\u5e7f\u544a, isEnded:",i),e._rewardedVideoAdOnCloseFun&&e._rewardedVideoAdOnCloseFun.call(e._rewardedVideoAdOnCloseFunThisObj,i)})))},e.prototype.showRewardedVideoAd=function(e,t){var i=this;if(void 0===e&&(e=null),void 0===t&&(t=null),0==this._isInitWX)return console.log("\u8fd8\u6ca1\u521d\u59cb\u5316\u5fae\u4fe1\uff0c\u76f4\u63a5\u5f53\u6210\u662f\u6210\u529f"),void(e&&e.call(t,!0));var n=this.rewardedVideoAdId;n&&""!=n&&(this.initRewardedVideoAd(),this._rewardedVideoAdOnCloseFun=e,this._rewardedVideoAdOnCloseFunThisObj=t,this._rewardedVideoAd.show().catch(function(e){console.log("\u89c6\u9891\u5e7f\u544a\u8fd8\u6ca1\u62c9\u53d6\uff0c\u5148\u62c9\u53d6"),i._rewardedVideoAd.load().then(function(){return i._rewardedVideoAd.show()}).catch(function(e){return console.log("\u64ad\u653e\u89c6\u9891\u5e7f\u544a\u5931\u8d25:"+e.errMsg)})}))},e.prototype.checkRewardedVideoAdIsOK=function(e,t){if(void 0===e&&(e=null),void 0===t&&(t=null),0==this._isInitWX)return console.log("\u8fd8\u6ca1\u521d\u59cb\u5316\u5fae\u4fe1\uff0c\u76f4\u63a5\u5f53\u6210\u662f\u6210\u529f"),void(e&&e.call(t,!0));this._rewardedVideoAd?this._rewardedVideoAd.load().then(function(){e&&e.call(t,!0)}).catch(function(i){e&&e.call(t,!1)}):e&&e.call(t,!1)},e.prototype.sendToHttps=function(e,t,i,n){if(void 0===t&&(t=null),void 0===i&&(i=null),void 0===n&&(n=!0),n&&console.log("sendToHttps  \u8bf7\u6c42https\u6570\u636e, url:"+e),this._isInitWX)qq.request({url:e,success:function(n){console.log("sendToHttps success, url:"+e+", data:",n.data),t&&t.call(i,n.data)},fail:function(n){console.log("sendToHttps fail, url:"+e+", res:",n),t&&t.call(i,null)},complete:function(e){}});else{var o=new XMLHttpRequest;o.onreadystatechange=function(){if(console.log("sendToHttps \u8fd4\u56de:  c.readyState="+o.readyState+",  c.status="+o.status,o.responseText),4==o.readyState)if(200==o.status){var e=o.responseText,n=JSON.parse(e);t&&t.call(i,n)}else console.log("sendToHttps \u5931\u8d25",o),t&&t.call(i,null)},o.open("GET",e,!0),o.send()}},e.prototype.rechargeByIndex=function(e,t,i){var n=this;if(void 0===t&&(t=null),void 0===i&&(i=null),1==this._isInitWX){var o=this.BackstageUrl+"/"+this.plat_id+"-"+this.ditch_id+"/payment/orderid?openid="+this.openId+"&extra_info="+s.MyRoleInfo.id+"|"+s.MyRoleInfo.serverid+"|"+e;this.sendToHttps(o,function(o){if(o&&o.orderid){var a=l.ConfigsManager.instance.getConfigs("rechargeconf").RechargeConf;o.index=e,o.name=a[e].name,n.platformSdk.pay(o,t,i)}else console.log("\u8bf7\u6c42\u5546\u54c1\u5931\u8d25: ",o),t&&t.call(i,!1)},this)}else this.platformSdk.pay(e,t,i)},Object.defineProperty(e.prototype,"isWeb",{get:function(){return"1"==this.plat_id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isTest",{get:function(){return-1!=[d.SDKPlatfotmType.NONE,d.SDKPlatfotmType.Test].indexOf(this.plat_id)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"BackstageUrl",{get:function(){return console.log("window[tengdindbackstageurl]",window.tengdindbackstageurl,this.getQueryString("backstageurl"),this._getPhoneGameData,this.initWX),window.tengdindbackstageurl?window.tengdindbackstageurl:this.getQueryString("backstageurl")?(console.log("this.getQueryString(backstageurl);"+this.getQueryString("backstageurl")),this.getQueryString("backstageurl")):this._getPhoneGameData?"https://slm.login.tengdinggame.com":this.initWX?"https://slm.login.tengdinggame.com":"http://192.168.3.248:5002"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"BackstageSendUrl",{get:function(){return this.getQueryString("backstageurl")?"http://192.168.3.248":this._getPhoneGameData?"https://slm.login.tengdinggame.com":this.initWX?"https://slm.login.tengdinggame.com":"http://192.168.3.248"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"setPhoneGameData",{set:function(e){this._getPhoneGameData=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasSdk",{get:function(){return"1"!=this.plat_id||"1"!=this.ditch_id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"plat_id",{get:function(){return this.getQueryString("plat_id")?this.platid=this.getQueryString("plat_id"):this._getPhoneGameData?this.platid=this._getPhoneGameData.plat_id+"":!cc.sys.isNative&&tdgamereportsdk?this.platid=tdgamereportsdk.platId+"":window.tengdinplatid?window.tengdinplatid:this.platid="1"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ditch_id",{get:function(){return this.getQueryString("ditch_id")?this.getQueryString("ditch_id"):this.getQueryString("channelid")?this.getQueryString("channelid"):this._getPhoneGameData?this._getPhoneGameData?this._getPhoneGameData.ditch_id+"":"1":!cc.sys.isNative&&tdgamereportsdk?tdgamereportsdk.channelId+"":window.tengdinditchid?window.tengdinditchid:"1"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localBigVersion",{get:function(){return this._getPhoneGameData?Number(this._getPhoneGameData.localBigVersion):1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"device_id",{get:function(){return t.instance&&t.instance.platformSdk.deviceid?t.instance.platformSdk.deviceid:this._getPhoneGameData?this._getPhoneGameData.device_id+"":""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isNative",{get:function(){return cc.sys.isNative},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"need_check",{get:function(){return window.need_check?window.need_check:this.getQueryString("need_check")?this.getQueryString("need_check"):"1"},enumerable:!0,configurable:!0}),e.prototype.initJsb=function(e,t){var i=this;void 0===e&&(e=null),void 0===t&&(t=null),1!=this._isInitJsb&&(this._isInitJsb=!0,window.tdGame_jsbFun=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(console.log("SdkUtils.Jsb \u539f\u751f\u8c03\u7528js\u63a5\u53e3, jsMethodName:"+e+", arg:"+t),i._registerJsMethodToNativeDic[e]){var o=i._registerJsMethodToNativeDic[e].callback,a=i._registerJsMethodToNativeDic[e].callbackThisObj;o&&o.apply(a,t)}},this.registerJsMethodToNative("jsLog",function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.log("SdkUtils.jsLog: "+e)},this),this.registerJsMethodToNative("getMsgFromPhone",this.getMsgFromPhone,this),this.registerJsMethodToNative("onBackPressed",this.onBackPressed,this),this.registerJsMethodToNative("loginBack",this.loginBack,this),this.registerJsMethodToNative("onAccountInvalid",this.onAccountInvalid,this),this.registerJsMethodToNative("getGameData",function(n){console.log("SdkUtils.getGameData: "+JSON.stringify(n)),i._getPhoneGameData=n,e&&e.call(t)},this),console.log("SDKUtils.initJsb"),this.getGameData())},e.prototype.registerJsMethodToNative=function(e,t,i){this._registerJsMethodToNativeDic[e]={callback:t,callbackThisObj:i}},e.prototype.callStaticMethod=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var n=["org/cocos2dx/javascript/TDGameSdk",e];return t&&t.length>0&&(n=n.concat(t)),console.log("SdkUtils.Jsb js\u8c03\u7528\u539f\u751f\u63a5\u53e3, nativeMethodName:"+e+", args:"+t),jsb.reflection.callStaticMethod.apply(jsb.reflection,n)},e.prototype.showToast=function(e){1==this.isNative&&cc.sys.os==cc.sys.OS_ANDROID&&this.callStaticMethod("showToast","(Ljava/lang/String;)V",e),console.log("SdkUtils.showToast: "+e)},e.prototype.getLocation=function(){1==this.isNative&&cc.sys.os==cc.sys.OS_ANDROID&&this.callStaticMethod("getLocation","()V")},e.prototype.copyString=function(e){return 1==cc.sys.isBrowser?this.webCopyString(e):1==cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID&&this.callStaticMethod("copyString","(Ljava/lang/String;)Z",e)},e.prototype.webCopyString=function(e){var t=document.createElement("textarea");t.value=e,t.setAttribute("readonly",""),t.style.contain="strict",t.style.position="absolute",t.style.left="-9999px",t.style.fontSize="12pt";var i=getSelection(),n=null;i.rangeCount>0&&(n=i.getRangeAt(0)),document.body.appendChild(t),t.select(),t.selectionStart=0,t.selectionEnd=e.length;var o=!1;try{o=document.execCommand("copy")}catch(e){}return document.body.removeChild(t),n&&(i.removeAllRanges(),i.addRange(n)),o},e.prototype.sendMsgToPhone=function(e){var t=JSON.stringify(e);1==this.isNative&&cc.sys.os==cc.sys.OS_ANDROID&&this.callStaticMethod("sendMsgToPhone","(Ljava/lang/String;)V",t)},e.prototype.getMsgFromPhone=function(e){if(console.log("SdkUtils.getMsgFromPhone: "+JSON.stringify(e)),e&&e.func_name)switch(e.func_name){case"send_login":console.log("APP\u767b\u5f55\u6210\u529f"),t.instance.loginData=e,cc.game.emit("LoginSuccess");break;case"send_logout":console.log("APP\u767b\u51fa\u6210\u529f")}},e.prototype.onBackPressed=function(){t.instance.sendToUploadGameData(4)},e.prototype.sendToLogin=function(){this.sendMsgToPhone({func_name:"send_login"})},e.prototype.sendToPay=function(e,t,i){void 0===i&&(i="");var n={price:e+"",product_id:t+"",product_name:i+"",plat_id:this.plat_id,ditch_id:this.ditch_id},o=JSON.stringify(n);o=encodeURIComponent(o);var a=e;this.sendMsgToPhone({func_name:"send_pay",price:a+"",product_id:t+"",product_name:i+"",extend_info:o})},e.prototype.sendToUploadGameData=function(e){switch(e){case 1:"send_createrole";break;case 2:"send_enter_server";break;case 3:"send_levelup";break;case 4:"send_exit_game";break;case 5:e=4,"send_logout"}var t={};console.log("sdk\u4e0a\u62a5\u6570\u636e: "+JSON.stringify(t)),this.sendMsgToPhone(t)},e.prototype.getGameData=function(){1==cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID?t.instance.callStaticMethod("getGameData","()V"):window.tdGame_jsbFun("getGameData",null)},e.prototype.vibration=function(e){1==this.isNative&&cc.sys.os==cc.sys.OS_ANDROID&&this.callStaticMethod("vibrate","()V",e)},e.prototype.clear=function(){t._instance=null},Object.defineProperty(e.prototype,"platformSdk",{get:function(){return this._platformSdk||(this._platformSdk=c.default.instance.sdk),this._platformSdk},enumerable:!0,configurable:!0}),e.prototype.loginBack=function(e){this.platformSdk.loginBack(e)},e.prototype.onAccountInvalid=function(){console.log("\u8d26\u53f7\u767b\u51fa"),this.platformSdk.onAccountInvalid()},e=t=__decorate([h],e)}());i.default=u,cc._RF.pop()},{"../Core/ConfigsManager":"ConfigsManager","../Core/Event":"Event","../Core/GameEventDispatcher":"GameEventDispatcher","../GlobalContext":"GlobalContext","../Module/Role/RoleInfo":"RoleInfo","../Module/SDK/GameSDK":"GameSDK","../Module/SDK/SDKPlatform":"SDKPlatform","./LocalStorageUtils":"LocalStorageUtils"}],SandTableBackstage:[function(e,t,i){"use strict";cc._RF.push(t,"dd451DitK5L0bbL05/Y/wH+","SandTableBackstage"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/GameEventDispatcher"),o=e("../../Core/Widget"),a=e("./SandTableController"),r=e("../../Global/GlobalValue"),s=e("../../Util/Utils"),l=e("../WarTeam/MonsterController"),c=e("../Status/StatusType"),d=e("../Arena/ArenaController"),p=e("../Chapter/ChapterController"),h=cc._decorator,u=h.ccclass,f=(h.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.symbolArr=[],t.symbolGuideBaoXiangArr=[15,16],t.guideOneCharps=[[1,16,1,1],[16,15,15,16],[1,16,1,1],[15,16,15,16]],t.nums=[1,1,1,1,16,1,16],t.terrainArr=[[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],t.OfferTypeTrap=[r.SandTableTrapType.JITAN,r.SandTableTrapType.LEITING,r.SandTableTrapType.HEIDONG,r.SandTableTrapType.WODI,r.SandTableTrapType.YAOJI,r.SandTableTrapType.PINGDENG,r.SandTableTrapType.SHENGJI,r.SandTableTrapType.CUIMIAN],t.OfferTypeTrapInfo=[r.SandTableTrapType.PINGDENG,r.SandTableTrapType.SHENGJI,r.SandTableTrapType.CUIMIAN],t.OfferTypeTrapTree=[r.SandTableTrapType.CHUANSONG],t.OfferTypeTrapTwo=[r.SandTableTrapType.TIECHUI,r.SandTableTrapType.HUOPAO,r.SandTableTrapType.QIYUAN,r.SandTableTrapType.JIANGJI,r.SandTableTrapType.CHUANSONG,r.SandTableTrapType.TANGHUANG,r.SandTableTrapType.MEIDUSHA,r.SandTableTrapType.WUSHU],t.storageArr=[],t.removeArr=[],t.resultIndex=0,t.loopIndex=0,t._activeIndex=null,t._passiveIndex=null,t.height=0,t.width=0,t.isDropNum=0,t.data=[],t.upSymbol=[],t.crossArr=[],t.monster=[],t.stoneArr=[],t.operationArr=[],t.trapArr=[],t.trapInfoArr=[],t.addTrapArr=[],t.secondArr=[],t.historyArr=[],t.screeningArr=[],t._aloneOut=!1,t.isSeedCome=!1,t.gradeMin=1,t.gradeMax=1,t.upTalentArr=[],t.talenSkills=!1,t.skillsProbability=0,t.skillsIncrease=0,t.starNum=0,t.deleteChuanSongNum=!1,t.deleteTangHuangNum=!1,t.meidushaIndex=1,t.numsindex=-1,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this),i.instance=this,n.GameEventDispatcher.instance.on("SANDTABLESTAR",this._starGame,this),n.GameEventDispatcher.instance.on("SABDTAVKEINITDATA",this._initData,this),n.GameEventDispatcher.instance.on("GAMEMOTION",this._gameMotion,this)},t.prototype._initData=function(){this.symbolArr=[],this.data=[],this.resetResultArr(),this.stoneArr=[],this.trapArr=[],this.historyArr=[],this.trapInfoArr=[],this.upTalentArr=[],this._passiveIndex=null,this._activeIndex=null,this.resultIndex=0,this.talenSkills=!1},t.prototype._starGame=function(e){var t=this,i=e.getUserData();if(i.seed){this.isSeedCome=!0;var n=!0;c.ActivityStatus.Arena==c.ActivityStatus.value&&1==d.default.instance.isArenaNextFight&&(n=!1);var o=function(e,i){void 0===i&&(i=null);for(var n=[],o=0;o<e;o++)for(var a=0;a<e;a++){var r=0,s=0,l=0,c=0;i&&i[o]&&i[o][a]?(r=i[o][a].type,s=i[o][a].gradeUp,l=i[o][a].fallDownNum,c=i[o][a].grade):r=t.Random();var d={type:r,gradeUp:s,fallDownNum:l,grade:c};n[o]||(n[o]=[]),n[o][a]=d}if(i)t.symbolArr=n;else{t.symbolArr=[];for(o=0;o<e;o++)for(a=0;a<e;a++)t.symbolArr[o]||(t.symbolArr[o]=[]),t.symbolArr[o][a]=n[a][e-1-o]}};if(i&&i.gradeMax&&(this.gradeMax=i.gradeMax?i.gradeMax:1,this.gradeMin=i.gradeMin?i.gradeMin:1),n)o(i.scale);if(this.symbolArr.length<=0){var r=a.default.instance.getOldArr();r&&o(r.length,r)}this.node.getComponent("SandTableMain").gameStar(this.symbolArr)}else this.isSeedCome=!1,this.Single()},t.prototype.Single=function(){var e=a.default.instance.getOldArr(),t=a.default.instance.getSandInfo();if(this.gradeMax=1,this.gradeMin=1,t&&(this.gradeMax=t.randomMax,this.gradeMin=1,void 0!==t.randomMin&&(this.gradeMin=t.randomMin)),e&&e.length)this.height=e.length,this.width=e[0].length;else if(t&&0!=t.table.length){this.terrainArr=[];var i=t.table.split(";"),n=i.splice(0,1)[0].split(",");this.height=parseInt(n[0]),this.width=parseInt(n[1]),i.splice(i.length-1,1);for(var o=[],r=0;r<this.height;r++){o[r]=[];for(var s=0;s<this.width;s++)o[r][s]=i[r*this.width+s].split(",")[1].indexOf("-")>-1?i[r*this.width+s].split(",")[1]:parseInt(i[r*this.width+s].split(",")[1])}for(var r in o)this.terrainArr[r]=o[Math.abs(this.height-1-parseInt(r))]}else this.height=this.terrainArr.length,this.width=this.terrainArr[0].length;var d=this.symbolArr,h=0,u=0;for(r=0;r<this.height;r++)for(s=0;s<this.width;s++){d[r]||(d[r]=[]);var f=0,g=0,y=0,m=0,C=null,v=0,_=0,b=0;if(e){f=(S=e[r][s]).type,g=S.gradeUp,y=S.grade,v=S.trapNum,_=S.stepsNum,m=S.removalFr,C=S.info,b=e[r][s].type<30?1:e[r][s].type-0,101==e[r][s].type?b=101:e[r][s].type<100&&e[r][s].type>30&&(b=50)}else{if(f=this.SingleRandom(),t&&t.monsterTable)f=t.monsterTable[r*this.width+s];else{if(0==p.default.instance.currentChapterId&&c.ActivityStatus.value==c.ActivityStatus.Chapter&&0==p.default.instance.currentGuanqiaId&&0==p.default.instance.currentGuanqiaId&&(f=this.guideOneCharps[r][s]),0==r&&0==s){var T=l.default.instance.nowIsHaveExperience();T&&(f=T)}null!==f&&h==f?++u>=2&&(f<3*this.gradeMax-1&&(f=this.NewRandom(f)),u=0,h=f):(h=f,u=0)}m=this.terrainArr[r][s],b=this.terrainArr[r][s]<=1?this.terrainArr[r][s]:101}if(1==b){var S={type:f,gradeUp:g,fallDownNum:0,banOneGame:0,cuimian:0,info:C,grade:y,x:r,y:s};d[r][s]=S}else if(50==b){S={type:f,removalFr:m,operation:!1,banOneGame:0,cuimian:0,info:C,x:r,y:s};d[r][s]=S,this.trapArr.push(S)}else if(101==b){if(!e){var I=(m+"").split("-");_=parseInt(I[2]),v=parseInt(I[1]),m=parseInt(I[0]),1==v&&(C={id:parseInt(I[3]),grade:parseInt(I[4]),lv:parseInt(I[5])})}S={type:101,removalFr:m,operation:!1,trapNum:v,stepsNum:_,banOneGame:0,cuimian:0,info:C,x:r,y:s};d[r][s]=S,this.stoneArr.push(S)}else{S={type:100,removalFr:m};d[r][s]=S}}e?this.node.getComponent("SandTableMain").gameStar(this.symbolArr):this.starCtninuity()},t.prototype.starCtninuity=function(e){void 0===e&&(e=!0);var t=this.continuity();if(t.length){if(!e&&this.loopIndex>100)return this.loopIndex=0,void this.screening();if(this.loopIndex>1e3)return this.loopIndex=0,this._initData(),void this.Single();if(0==t[0])for(var i=null,n=0,o=0;o<this.symbolArr[t[1]].length;o++)(this.checkCanUpCarMonster(this.symbolArr[t[1]][o].type)||this.checkIsGuideBaoXiang(this.symbolArr[t[1]][o].type))&&null!==this.symbolArr[t[1]][o].type&&i==this.symbolArr[t[1]][o].type?++n>=2&&(this.symbolArr[t[1]][o].type=this.NewRandom(this.symbolArr[t[1]][o].type),o--):(i=this.symbolArr[t[1]][o].type,n=0);else if(1==t[0])for(i=null,n=0,o=0;o<this.symbolArr.length;o++)(this.checkCanUpCarMonster(this.symbolArr[o][t[1]].type)||this.checkIsGuideBaoXiang(this.symbolArr[o][t[1]].type))&&null!==this.symbolArr[o][t[1]].type&&i==this.symbolArr[o][t[1]].type?++n>=2&&(this.symbolArr[o][t[1]].type=this.NewRandom(this.symbolArr[o][t[1]].type),o--):(i=this.symbolArr[o][t[1]].type,n=0);else if(2==t[0])for(i=null,n=0,o=0;o<t[1].length;o++)(this.checkCanUpCarMonster(this.symbolArr[t[1][o][0]][t[1][o][1]].type)||this.checkIsGuideBaoXiang(this.symbolArr[t[1][o][0]][t[1][o][1]].type))&&null!==this.symbolArr[t[1][o][0]][t[1][o][1]].type&&i==this.symbolArr[t[1][o][0]][t[1][o][1]].type?++n>=2&&(this.symbolArr[t[1][o][0]][t[1][o][1]].type=this.NewRandom(this.symbolArr[t[1][o][0]][t[1][o][1]].type),o--):(i=this.symbolArr[t[1][o][0]][t[1][o][1]].type,n=0);else if(e)return void this.node.getComponent("SandTableMain").gameStar(this.symbolArr);this.starCtninuity(e)}else e&&this.node.getComponent("SandTableMain").gameStar(this.symbolArr)},t.prototype.continuity=function(){var e=[];for(var t in this.symbolArr)for(var i in e[t]=[],this.symbolArr[t]){var n=null!==this.symbolArr[t][i].type?this.symbolArr[t][i].type:null;e[t].push(n)}var o=[];for(var t in e){if(this._check(e[t]))return[0,t];for(var i in o=[],e)o.push(e[i][t]);if(this._check(o))return[1,t]}var a=[],r=[],s=e.length;for(t=0;t<2*s-1;t++){var l=t<s-1?t:s-1,c=s-1-t>=0?0:Math.abs(s-1-t);a=[],r=[];for(i=0;i<s;i++)if(a.push(e[l][c]),r.push([l,c]),c++,--l>=s||l<0||c>=s||c<0){if(this._check(a))return[2,r];break}}for(t=0;t<2*s-1;t++){c=s-1-t>=0?0:Math.abs(s-1-t),l=s-1-t<=0?0:Math.abs(s-1-t);a=[],r=[];for(i=0;i<s;i++)if(a.push(e[l][c]),r.push([l,c]),c++,++l>=s||l<0||c>=s||c<0){if(this._check(a))return[2,r];break}}return[]},t.prototype._check=function(e){this.loopIndex++;var t=0,i=null,n=0;for(var o in e)if((this.checkCanUpCarMonster(e[o])||this.checkIsGuideBaoXiang(e[o]))&&null!==e[o]&&i==e[o]?++n>=2&&t++:(i=e[o],n=0),t)return t;return t},t.prototype.gameSingle=function(e,t){if(this._aloneOut=!0,this.resultIndex=0,this.isDropNum=0,this.crossArr=[],this.upSymbol=[],this.monster=[],this.data=[],this.historyArr=[],this.trapInfoArr=[],this.secondArr=[],this.sameTesting(t,this.symbolArr))if(this.storageArr.push([{type:this.symbolArr[e.x][e.y].type,grade:this.symbolArr[e.x][e.y].grade,x:e.x,y:e.y}]),this.monster[0]={type:this.symbolArr[e.x][e.y].type,num:1,lv:this.symbolArr[e.x][e.y].grade},this.operationArr=[{x:e.x,y:e.y}],this.symbolArr[e.x][e.y]=null,this._arrange(),this._aloneData(1),this.upSymbol=[],this.monster=[],this.crossArr=[],this.storageArr=[],this._eliminate()>0)this.resultIndex++,this._formationJudge(),this._arrange(),this.addRes(1);else{if(this.trapArr.length)return void this.trapScreening();this.node.getComponent("SandTableMain").gameResult(this.data)}},t.prototype._exDelete=function(e,t){this.symbolArr[t.x][t.y].removalFr-=1,this.addTrapArr.push({type:this.symbolArr[t.x][t.y].type,x:this.symbolArr[t.x][t.y].x,y:this.symbolArr[t.x][t.y].y,removalFr:this.symbolArr[t.x][t.y].removalFr,info:{type:this.symbolArr[t.x][t.y].info.id,grade:this.symbolArr[t.x][t.y].info.grade,lv:this.symbolArr[t.x][t.y].info.lv}}),this.symbolArr[e.x][e.y]=null,this.symbolArr[t.x][t.y].removalFr<=0&&(this.symbolArr[t.x][t.y]=null),this._arrange(),this._aloneData(1),this.continue()},t.prototype._deleteTrapNum=function(e,t){var i=this.symbolArr[t.x][t.y].type;i==r.SandTableTrapType.CHUANSONG&&(this.deleteChuanSongNum=!0),i==r.SandTableTrapType.TANGHUANG&&(this.deleteTangHuangNum=!0),this.symbolArr[t.x][t.y].removalFr-=1,this.addTrapArr.push({type:this.symbolArr[t.x][t.y].type,x:this.symbolArr[t.x][t.y].x,y:this.symbolArr[t.x][t.y].y,removalFr:this.symbolArr[t.x][t.y].removalFr}),this.symbolArr[e.x][e.y]=null,this.symbolArr[t.x][t.y].removalFr<=0&&(this.symbolArr[t.x][t.y]=null),this._arrange(),this._aloneData(1),this.continue()},t.prototype._exStop=function(e,t){var i=this.symbolArr[t.x][t.y],n=i.type;if(-1!=this.OfferTypeTrapInfo.indexOf(n)){for(var o=void 0,a=0;a<this.trapArr.length;a++)if(n==this.trapArr[a].type){o=a;break}this._aloneData(1),this.symbolArr[e.x][e.y]=null,this.inTrapScreenTwo(n,[o],e.x,e.y),this.upSymbol=[],this.monster=[],this.crossArr=[],this.storageArr=[],this.addTrapArr=[],this.historyArr=[],this.addTrapArr.push({type:n}),this._arrange(),this._upGrade(),this.data[this.data.length-1].trapInfoArr=this.trapInfoArr.slice(0),this.data[this.data.length-1].secondArr=this.secondArr.slice(0),this.node.getComponent("SandTableMain").gameResult(this.data)}else{if(this.storageArr.push([{type:this.symbolArr[e.x][e.y].type,grade:this.symbolArr[e.x][e.y].grade,x:e.x,y:e.y}]),this.operationArr=[{x:e.x,y:e.y}],i.removalFr-=1,this.addTrapArr.push({type:n,x:t.x,y:t.y,removalFr:i.removalFr,info:{type:l.MonsterType.MonsterWarTeam[l.MonsterType.MonsterBattle][this.symbolArr[e.x][e.y].type%3],grade:Math.floor(this.symbolArr[e.x][e.y].type/3)+1,lv:this.symbolArr[e.x][e.y].grade+1}}),this.symbolArr[e.x][e.y]=null,!i.removalFr){for(a=0;a<this.trapArr.length;a++)if(this.trapArr[a].type==n&&this.trapArr[a].x==t.x&&this.trapArr[a].y==t.y){this.trapArr.splice(a,1);break}this.symbolArr[t.x][t.y]=null}this._arrange(),this._aloneData(1),this.continue()}},t.prototype.continue=function(){if(this.upSymbol=[],this.monster=[],this.crossArr=[],this.storageArr=[],this.addTrapArr=[],this.historyArr=[],this._eliminate()>0)this.resultIndex++,this._formationJudge(),this._arrange(),this.addRes(1);else{if(this.trapArr.length)return void this.trapScreening();this.node.getComponent("SandTableMain").gameResult(this.data)}},t.prototype._gameMotion=function(e){var t=e.getUserData(),i=t.active,n=t.passive,o=t.symbol;if(this._activeIndex={x:i.x,y:i.y},this._passiveIndex={x:n.x,y:n.y},this.resultIndex=0,this.isDropNum=0,this.operationArr=[this._activeIndex,this._passiveIndex],this.crossArr=[],this.upSymbol=[],this.monster=[],this.addTrapArr=[],this.trapInfoArr=[],this.secondArr=[],this.historyArr=[],this._aloneOut=!1,this.sameTesting(o,this.symbolArr)){for(var a in this.symbolArr)for(var s in this.symbolArr[a])this.symbolArr[a][s].banOneGame>0&&(this.symbolArr[a][s].banOneGame-=1);for(var a in this.symbolArr)for(var s in this.symbolArr[a])this.symbolArr[a][s].cuimian>0&&(this.symbolArr[a][s].cuimian-=1);if(this.deleteChuanSongNum=!1,this.deleteTangHuangNum=!1,this.data=[],this.symbolArr[n.x][n.y].type==r.SandTableTrapType.JITAN)return this._exDelete(i,n);if(this.OfferTypeTrapTree.indexOf(this.symbolArr[n.x][n.y].type)>-1)return this._deleteTrapNum(i,n);if(this.OfferTypeTrap.indexOf(this.symbolArr[n.x][n.y].type)>-1)return this._exStop(i,n);this._exchange(i,n),this._eliminate()>0&&(this._formationJudge(),this._arrange()),this.addRes(1)}},t.prototype.addRes=function(e){for(var t in this.stoneArr)this.stoneArr[t].operation=!1;if(this._aloneData(e),this._eliminate()>0)this.resultIndex++,this.upSymbol=[],this.monster=[],this.crossArr=[],this.addTrapArr=[],1==e&&(this.trapInfoArr=[]),this._formationJudge(),this._arrange(),this.addRes(e);else if(1==e){if(this.trapArr.length)return void this.trapScreening();this.node.getComponent("SandTableMain").gameResult(this.data)}},t.prototype.sameTesting=function(e,t){for(var i in e)for(var n in e[i])if(e[i][n]!=t[i][n].type)return console.log("\u6570\u636e\u6570\u7ec4\u548c\u6c99\u76d8\u663e\u793a\u6570\u636e\u4e0d\u5bf9",i,n,e,t),!1;return!0},t.prototype._exchange=function(e,t){var i=this.symbolArr[e.x][e.y];this.symbolArr[e.x][e.y]=this.symbolArr[t.x][t.y],this.symbolArr[t.x][t.y]=i},t.prototype._eliminate=function(){var e=[],t=0,i=[],n=[];for(var o in this.storageArr=[],this.symbolArr)for(var a in e[o]=[],this.symbolArr[o]){var r=null!==this.symbolArr[o][a].type?this.symbolArr[o][a].type:null;e[o].push(r)}for(var o in e){for(var s in i=[],e[o])i.push({type:e[o][s],grade:this.symbolArr[o][s].grade,y:parseInt(s),x:parseInt(o)});for(var a in t+=this._eliminateScreen(i),i=[],e)i.push({type:e[a][o],grade:this.symbolArr[a][o].grade,y:parseInt(o),x:parseInt(a)});t+=this._eliminateScreen(i)}var l=e.length;for(o=0;o<2*l-1;o++){var c=o<l-1?o:l-1,d=l-1-o>=0?0:Math.abs(l-1-o);n=[];for(a=0;a<l;a++)if(n.push({type:e[c][d],grade:this.symbolArr[c][d].grade,x:c,y:d}),d++,--c>=l||c<0||d>=l||d<0){t+=this._eliminateScreen(n);break}}for(o=0;o<2*l-1;o++){d=l-1-o>=0?0:Math.abs(l-1-o),c=l-1-o<=0?0:Math.abs(l-1-o);n=[];for(a=0;a<l;a++)if(n.push({type:e[c][d],grade:this.symbolArr[c][d].grade,x:c,y:d}),d++,++c>=l||c<0||d>=l||d<0){t+=this._eliminateScreen(n);break}}return t},t.prototype.increase=function(e,t){var i=!1;if(this.checkIsGuideBaoXiang(this.symbolArr[this.storageArr[e][t].x][this.storageArr[e][t].y].type)||(this.symbolArr[this.storageArr[e][t].x][this.storageArr[e][t].y].type+=3),this.upTalentArr&&this.upTalentArr.length){var n=this.symbolArr[this.storageArr[e][t].x][this.storageArr[e][t].y].type,o=this.upTalentArr.indexOf(n%3);o>-1&&this.checkCanUpCarMonster(n)&&(this.upTalentArr.splice(o,1),this.symbolArr[this.storageArr[e][t].x][this.storageArr[e][t].y].type+=3)}(this.checkIsGuideBaoXiang(this.symbolArr[this.storageArr[e][t].x][this.storageArr[e][t].y].type)||(this.symbolArr[this.storageArr[e][t].x][this.storageArr[e][t].y].grade=this._getNowGrade(this.storageArr[e])),this.talenSkills)&&(100*Math.random()<this.skillsProbability&&(this.symbolArr[this.storageArr[e][t].x][this.storageArr[e][t].y].grade+=this.skillsIncrease,i=!0));this.upSymbol.push([this.storageArr[e][t].x,this.storageArr[e][t].y,this.symbolArr[this.storageArr[e][t].x][this.storageArr[e][t].y].type,i])},t.prototype._formationJudge=function(){for(var e=0;e<this.storageArr.length;e++)for(var t=e;t<this.storageArr.length;t++){var i=!1;t!=e&&this.storageArr[e][0].type==this.storageArr[t][0].type&&(i=this._relation(this.storageArr[e],this.storageArr[t],e)),i&&(this._mergeArr(this.storageArr[e],this.storageArr[t]),this.storageArr.splice(t,1),t=e)}for(var e in this.storageArr)for(var t in this._setMonster(parseInt(e),this.symbolArr[this.storageArr[e][0].x][this.storageArr[e][0].y].type,this.storageArr[e].length-2),this.storageArr[e])if(this.stoneArr.length&&this._stoneTesting(this.storageArr[e][t].x,this.storageArr[e][t].y),this._aloneOut||0!=this.resultIndex)this.storageArr[e].length<5?parseInt(t)==Math.floor((this.storageArr[e].length-1)/2)?this.increase(e,t):this.symbolArr[this.storageArr[e][t].x][this.storageArr[e][t].y]=null:this.crossArr[e]&&this.crossArr[e].length?this.storageArr[e][t].x==this.crossArr[e][0].x&&this.storageArr[e][t].y==this.crossArr[e][0].y?this.increase(e,t):this.symbolArr[this.storageArr[e][t].x][this.storageArr[e][t].y]=null:parseInt(t)==Math.floor((this.storageArr[e].length-1)/2)?this.increase(e,t):this.symbolArr[this.storageArr[e][t].x][this.storageArr[e][t].y]=null;else{var n=!0;for(var o in this.storageArr[e])if(this.storageArr[e][o].x==this._passiveIndex.x&&this.storageArr[e][o].y==this._passiveIndex.y||this.storageArr[e][o].x==this._activeIndex.x&&this.storageArr[e][o].y==this._activeIndex.y){n=!1;break}n?this.storageArr[e][t].x==this.storageArr[e][this.storageArr[e].length-1].x&&this.storageArr[e][t].y==this.storageArr[e][this.storageArr[e].length-1].y?this.increase(e,t):this.symbolArr[this.storageArr[e][t].x][this.storageArr[e][t].y]=null:this.storageArr[e][t].x==this._passiveIndex.x&&this.storageArr[e][t].y==this._passiveIndex.y||this.storageArr[e][t].x==this._activeIndex.x&&this.storageArr[e][t].y==this._activeIndex.y?this.increase(e,t):this.symbolArr[this.storageArr[e][t].x][this.storageArr[e][t].y]=null}},t.prototype._arrange=function(){for(var e=this.symbolArr.length-1;e>=0;e--)for(var t=0;t<this.symbolArr.length;t++)if(!(null==this.symbolArr[e][t]||this.symbolArr[e][t].type>50||this.symbolArr[e][t].cuimian||this.symbolArr[e][t].banOneGame)){for(var i=0,n=this.symbolArr[e].length-1;n>e;n--)(null==this.symbolArr[n][t]||i>0&&(this.symbolArr[n][t].type>50||this.symbolArr[n][t].cuimian||this.symbolArr[n][t].banOneGame))&&i++;this.symbolArr[e][t].fallDownNum=i,this._exchange({x:e,y:t},{x:e+this.symbolArr[e][t].fallDownNum,y:t})}if(this.isSeedCome)for(e=0;e<this.symbolArr.length;e++)for(t=this.symbolArr.length-1;t>=0;t--)if(null==this.symbolArr[t][e]){var o={type:this.Random(),gradeUp:0,fallDownNum:0,grade:0};this.symbolArr[t][e]=o}else this.symbolArr[t][e].fallDownNum=0;else{var a=[];for(e=0;e<this.symbolArr.length;e++)for(var t in this.symbolArr[e])if(null==this.symbolArr[e][t]){o={type:this.SingleRandom(!0),gradeUp:0,fallDownNum:0,banOneGame:0,cuimian:0,grade:0,x:e,y:parseInt(t)};a.push(o),this.symbolArr[e][t]=o}else this.symbolArr[e][t].fallDownNum=0}},t.prototype.resetScreening=function(e){if(this.screening()){var t=[];for(var i in this.screeningArr)for(var n in this.screeningArr[i]){var o=this.screeningArr[i][n];-1==t.indexOf(this.symbolArr[o.x][o.y])&&t.push(this.symbolArr[o.x][o.y])}for(var i in e)t.indexOf(e[i])>-1&&(e[i].type=this.NewRandom(e[i].type));this.starCtninuity(!1)}},t.prototype.screening=function(){var e=[],t=0,i=[],n=[];for(var o in this.screeningArr=[],this.symbolArr)for(var a in e[o]=[],this.symbolArr[o]){var r=null!==this.symbolArr[o][a].type?this.symbolArr[o][a].type:null;e[o].push(r)}for(var o in e){for(var s in i=[],e[o])i.push({type:e[o][s],grade:this.symbolArr[o][s].grade,y:parseInt(s),x:parseInt(o)});for(var a in t+=this.screeningTwo(i),i=[],e)i.push({type:e[a][o],grade:this.symbolArr[a][o].grade,y:parseInt(o),x:parseInt(a)});t+=this.screeningTwo(i)}var l=e.length;for(o=0;o<2*l-1;o++){var c=o<l-1?o:l-1,d=l-1-o>=0?0:Math.abs(l-1-o);n=[];for(a=0;a<l;a++)if(n.push({type:e[c][d],grade:this.symbolArr[c][d].grade,x:c,y:d}),d++,--c>=l||c<0||d>=l||d<0){t+=this.screeningTwo(n);break}}for(o=0;o<2*l-1;o++){d=l-1-o>=0?0:Math.abs(l-1-o),c=l-1-o<=0?0:Math.abs(l-1-o);n=[];for(a=0;a<l;a++)if(n.push({type:e[c][d],grade:this.symbolArr[c][d].grade,x:c,y:d}),d++,++c>=l||c<0||d>=l||d<0){t+=this.screeningTwo(n);break}}return t},t.prototype.screeningTwo=function(e){var t=0,i=[],n=null,o=0;for(var a in e)!this.checkIsGuideBaoXiang(e[a].type)&&!this.checkCanUpCarMonster(e[a].type)||this.symbolArr[e[a].x][e[a].y].banOneGame||this.symbolArr[e[a].x][e[a].y].cuimian||null==e[a].type||n!==e[a].type?(o>=2&&this.screeningArr.push(i.slice(0)),i=[],n=null,!this.symbolArr[e[a].x][e[a].y].banOneGame&&!this.symbolArr[e[a].x][e[a].y].cuimian&&null!=e[a].type&&e[a].type<51&&(i.push(e[a]),n=e[a].type),o=0):(o++,i.push(e[a]),o>=2&&t++);return o>=2&&this.screeningArr.push(i.slice(0)),t},t.prototype.setupTalent=function(e){this.upTalentArr.indexOf(e)>-1||this.upTalentArr.push(e)},t.prototype.setTalent=function(e){this.talenSkills=!0,this.skillsProbability=e,this.skillsIncrease=1},t.prototype._eliminateScreen=function(e){var t=0,i=[],n=null,o=0;for(var a in e)!this.checkIsGuideBaoXiang(e[a].type)&&!this.checkCanUpCarMonster(e[a].type)||this.symbolArr[e[a].x][e[a].y].banOneGame||this.symbolArr[e[a].x][e[a].y].cuimian||null==e[a].type||n!==e[a].type?(o>=2&&this.storageArr.push(i.slice(0)),i=[],n=null,!this.symbolArr[e[a].x][e[a].y].banOneGame&&!this.symbolArr[e[a].x][e[a].y].cuimian&&null!=e[a].type&&e[a].type<51&&(i.push(e[a]),n=e[a].type),o=0):(o++,i.push(e[a]),o>=2&&t++);return o>=2&&this.storageArr.push(i.slice(0)),t},t.prototype._relation=function(e,t,i){this.crossArr[i]||(this.crossArr[i]=[]);var n=!1;for(var o in e)for(var a in t)e[o].x==t[a].x&&e[o].y==t[a].y&&(this.crossArr[i].length?this.crossArr[i][0].y>e[o].y?this.crossArr[i][0]=e[o]:this.crossArr[i][0].y==e[o].y&&this.crossArr[i][0].x<e[o].x&&(this.crossArr[i][0]=e[o]):this.crossArr[i].push(e[o]),n=!0);return n},t.prototype._mergeArr=function(e,t){for(var i in t){var n=!1;for(var o in e)t[i].x==e[o].x&&t[i].y==e[o].y&&(n=!0);n||e.push(t[i])}},t.prototype._getNowGrade=function(e){var t=0;for(var i in e)t+=e[i].grade;return t+=e.length-3},t.prototype._setMonster=function(e,t,i){this.monster[e]={type:t,num:i,lv:0}},t.prototype._stoneTesting=function(e,t){for(var i=0;i<this.stoneArr.length;i++)if(!this.stoneArr[i].operation&&(this.stoneArr[i].x==e&&1==Math.abs(this.stoneArr[i].y-t)||this.stoneArr[i].y==t&&1==Math.abs(this.stoneArr[i].x-e))&&(this.stoneArr[i].operation=!0,this.stoneArr[i].removalFr-=1,0==this.stoneArr[i].removalFr))if(this.stoneArr[i].trapNum>0){var n;n=50+this.stoneArr[i].trapNum,this.symbolArr[this.stoneArr[i].x][this.stoneArr[i].y]={type:n,removalFr:this.stoneArr[i].stepsNum,info:this.stoneArr[i].info,operation:!1,banOneGame:0,cuimian:0,first:!0,x:this.stoneArr[i].x,y:this.stoneArr[i].y},this.trapArr.push(this.symbolArr[this.stoneArr[i].x][this.stoneArr[i].y]),this.stoneArr.splice(i,1),i--}else this.symbolArr[this.stoneArr[i].x][this.stoneArr[i].y]=null,this.stoneArr.splice(i,1),i--},t.prototype.trapScreening=function(){var e=[];for(var t in this.trapArr)this.trapArr[t].first?this.trapArr[t].first=!1:e.push(this.trapArr[t].type);var i=[];for(t=0;t<this.OfferTypeTrapTwo.length;t++){i[t]||(i[t]=[]);for(var n=0;n<e.length;n++)this.OfferTypeTrapTwo[t]==e[n]&&i[t].push(n)}for(t=0;t<i.length;t++)if(i[t]&&i[t].length){var o=e[i[t][0]];this.inTrapScreen(o,i[t])}for(t=0;t<this.trapArr.length;t++)this.trapArr[t].removalFr<=0&&(this.trapArr.splice(t,1),t--);this.data[this.data.length-1].trapInfoArr=this.trapInfoArr.slice(0),this.data[this.data.length-1].secondArr=this.secondArr.slice(0),this.node.getComponent("SandTableMain").gameResult(this.data)},t.prototype.addTrapResult=function(e,t){(this.trapInfoArr.push(t),e)?this._trapAway():this._eliminate()>0&&this._upGrade()},t.prototype.addTrapResultTwo=function(e,t){if(this.trapInfoArr.push(t),this.resultIndex=0,this.secondArr[this.isDropNum]||(this.secondArr[this.isDropNum]=[]),this._arrange(),this._aloneData(2),this.resetResultArr(),this._eliminate()>0)return this._formationJudge(),this._arrange(),void this.addRes(2)},t.prototype.inTrapScreen=function(e,t){if(!(this.OfferTypeTrapTree.indexOf(e)>-1&&(this.deleteTangHuangNum||this.deleteChuanSongNum))){this.historyArr=[];var i=[],n=!1,o=!1,a=null;for(var s in t){var c=t[s],d=this.trapArr[c];-1==this.OfferTypeTrapTree.indexOf(e)&&(d.removalFr-=1),n=d.removalFr<=0;var p=d.x,h=d.y;switch(e){case r.SandTableTrapType.TIECHUI:var u=this._randomStone();if(this.historyArr=this.historyArr.concat(u),!n){for(var f in u)0==u[f].removalFr?1:0}if(u.length)for(var g=0;g<u.length;g++)i.push({index:e,center:d,isDrop:n,stora:u[g]});else i.push({index:e,center:d,isDrop:n,stora:null});break;case r.SandTableTrapType.HUOPAO:i.push({index:e,center:d,delete:n});break;case r.SandTableTrapType.QIYUAN:this.symbolArr[d.x][d.y+1]&&this.symbolArr[d.x][d.y+1].type<30&&(this.symbolArr[d.x][d.y+1].grade+=5),this.symbolArr[d.x][d.y-1]&&this.symbolArr[d.x][d.y-1].type<30&&(this.symbolArr[d.x][d.y-1].grade+=5),this.symbolArr[d.x+1]&&this.symbolArr[d.x+1][d.y]&&this.symbolArr[d.x+1][d.y].type<30&&(this.symbolArr[d.x+1][d.y].grade+=5),this.symbolArr[d.x-1]&&this.symbolArr[d.x-1][d.y]&&this.symbolArr[d.x-1][d.y].type<30&&(this.symbolArr[d.x-1][d.y].grade+=5),i.push({index:e,center:d,arr:[{symbol:this.symbolArr[d.x][d.y+1],x:d.x,y:d.y+1},{symbol:this.symbolArr[d.x][d.y-1],x:d.x,y:d.y-1},{symbol:this.symbolArr[d.x+1]?this.symbolArr[d.x+1][d.y]:null,x:d.x+1,y:d.y},{symbol:this.symbolArr[d.x-1]?this.symbolArr[d.x-1][d.y]:null,x:d.x-1,y:d.y}]});break;case r.SandTableTrapType.JIANGJI:var y=[];this.symbolArr[d.x][d.y+1]&&this.checkCanUpCarMonster(this.symbolArr[d.x][d.y+1].type)&&(this.symbolArr[d.x][d.y+1].type>2&&(this.symbolArr[d.x][d.y+1].type-=3),y.push({symbol:this.symbolArr[d.x][d.y+1]?this.symbolArr[d.x][d.y+1].type:null,x:d.x,y:d.y+1})),this.symbolArr[d.x][d.y-1]&&this.checkCanUpCarMonster(this.symbolArr[d.x][d.y-1].type)&&(this.symbolArr[d.x][d.y-1].type>2&&(this.symbolArr[d.x][d.y-1].type-=3),y.push({symbol:this.symbolArr[d.x][d.y-1]?this.symbolArr[d.x][d.y-1].type:null,x:d.x,y:d.y-1})),this.symbolArr[d.x+1]&&this.symbolArr[d.x+1][d.y]&&this.checkCanUpCarMonster(this.symbolArr[d.x+1][d.y].type)&&(this.symbolArr[d.x+1][d.y].type>2&&(this.symbolArr[d.x+1][d.y].type-=3),y.push({symbol:this.symbolArr[d.x+1]?this.symbolArr[d.x+1][d.y].type:null,x:d.x+1,y:d.y})),this.symbolArr[d.x-1]&&this.symbolArr[d.x-1][d.y]&&this.checkCanUpCarMonster(this.symbolArr[d.x-1][d.y].type)&&(this.symbolArr[d.x-1][d.y].type>2&&(this.symbolArr[d.x-1][d.y].type-=3),y.push({symbol:this.symbolArr[d.x-1]?this.symbolArr[d.x-1][d.y].type:null,x:d.x-1,y:d.y})),i.push({index:e,center:d,isDrop:n,arr:y});break;case r.SandTableTrapType.CHUANSONG:var m=this._randomSym(),C=d.x,v=d.y,_=m.x,b=m.y;this._exchange({x:m.x,y:m.y},{x:d.x,y:d.y}),d.x=m.x,d.y=m.y,i.push({index:e,center:d,active:{type:m.type,x:_,y:b},passive:{type:e,x:C,y:v},isDrop:n});break;case r.SandTableTrapType.TANGHUANG:C=d.x,v=d.y;if(this.symbolArr[C-1]&&this.symbolArr[C-1][v]){m=this.symbolArr[C-1][v].type;var T=this.symbolArr[C-1][v].grade;m<15&&(1==(a={type:m,id:l.MonsterType.MonsterWarTeam[l.MonsterType.MonsterBattle][m%3],grade:Math.max(Math.ceil(m/3),1),lv:Math.max(T,1),x:C-1,y:v}).id&&a.type&&a.grade++,this.symbolArr[C-1][v]=null),n||this._trapAway()}i.push({index:e,isDrop:n,center:d,launch:a});break;case r.SandTableTrapType.MEIDUSHA:var S=[[d.x+1,d.y-1],[d.x,d.y-1],[d.x-1,d.y-1],[d.x-1,d.y-1],[d.x-1,d.y],[d.x-1,d.y+1],[d.x+1,d.y-1],[d.x+1,d.y],[d.x+1,d.y+1],[d.x-1,d.y+1],[d.x,d.y+1],[d.x+1,d.y+1]],I=this.getMeiDuShaIndex(),w=[],D=S[I][0],R=S[I][1];this.symbolArr[D]&&this.symbolArr[D][R]&&this.symbolArr[D][R].type<15&&(this.symbolArr[D][R].banOneGame=2,w.push({x:D,y:R})),D=S[++I][0],R=S[I][1],this.symbolArr[D]&&this.symbolArr[D][R]&&this.symbolArr[D][R].type<15&&(this.symbolArr[D][R].banOneGame=2,w.push({x:D,y:R})),D=S[++I][0],R=S[I][1],this.symbolArr[D]&&this.symbolArr[D][R]&&this.symbolArr[D][R].type<15&&(this.symbolArr[D][R].banOneGame=2,w.push({x:D,y:R})),i.push({index:r.SandTableTrapType.MEIDUSHA,center:{removalFr:d.removalFr,x:d.x,y:d.y},arr:w});break;case r.SandTableTrapType.WUSHU:i.push({index:r.SandTableTrapType.WUSHU,center:{removalFr:d.removalFr,x:d.x,y:d.y}})}r.SandTableTrapType.TANGHUANG!=e&&r.SandTableTrapType.CHUANSONG!=e&&this._trapAway(),n&&(this.storageArr[0]||(this.storageArr[0]=[]),this.storageArr[0].push({type:e,x:p,y:h}),this.symbolArr[d.x][d.y]=null,o=!0,e==r.SandTableTrapType.TANGHUANG&&this._arrange())}this.addTrapResult(o,i),this.isDropNum++}},t.prototype.getMeiDuShaIndex=function(){for(var e=0;e<9999;e++){var t=3*s.default.RandomBy(0,3);if(this.meidushaIndex!=t)return this.meidushaIndex=t,t}},t.prototype.inTrapScreenTwo=function(e,t,i,n){this.historyArr=[];var o=[],a=!1,s=!1;for(var l in t){var c=t[l],d=this.trapArr[c];switch(d.removalFr-=1,a=d.removalFr<=0,e){case r.SandTableTrapType.SHENGJI:var p=[];this.symbolArr[d.x][d.y+1]&&this.checkCanUpCarMonster(this.symbolArr[d.x][d.y+1].type)&&(i==d.x&&d.y+1==n||(this.symbolArr[d.x][d.y+1].type+=3,p.push({symbol:this.symbolArr[d.x][d.y+1]?this.symbolArr[d.x][d.y+1].type:null,x:d.x,y:d.y+1}))),this.symbolArr[d.x][d.y-1]&&this.checkCanUpCarMonster(this.symbolArr[d.x][d.y-1].type)&&(i==d.x&&d.y-1==n||(this.symbolArr[d.x][d.y-1].type+=3,p.push({symbol:this.symbolArr[d.x][d.y-1]?this.symbolArr[d.x][d.y-1].type:null,x:d.x,y:d.y-1}))),this.symbolArr[d.x+1]&&this.symbolArr[d.x+1][d.y]&&this.checkCanUpCarMonster(this.symbolArr[d.x+1][d.y].type)&&(i==d.x+1&&d.y==n||(this.symbolArr[d.x+1][d.y].type+=3,p.push({symbol:this.symbolArr[d.x+1][d.y]?this.symbolArr[d.x+1][d.y].type:null,x:d.x+1,y:d.y}))),this.symbolArr[d.x-1]&&this.symbolArr[d.x-1][d.y]&&this.checkCanUpCarMonster(this.symbolArr[d.x-1][d.y].type)&&(i==d.x-1&&d.y==n||(this.symbolArr[d.x-1][d.y].type+=3,p.push({symbol:this.symbolArr[d.x-1][d.y]?this.symbolArr[d.x-1][d.y].type:null,x:d.x-1,y:d.y}))),o.push({index:e,center:d,isDrop:a,arr:p});break;case r.SandTableTrapType.PINGDENG:var h=[];this.symbolArr[d.x][d.y+1]&&this.checkCanUpCarMonster(this.symbolArr[d.x][d.y+1].type)&&(i==d.x&&d.y+1==n||(this.symbolArr[d.x][d.y+1].type=this.symbolArr[d.x][d.y+1].type%3+6,h.push({symbol:this.symbolArr[d.x][d.y+1]?this.symbolArr[d.x][d.y+1].type:null,x:d.x,y:d.y+1}))),this.symbolArr[d.x][d.y-1]&&this.checkCanUpCarMonster(this.symbolArr[d.x][d.y-1].type)&&(i==d.x&&d.y-1==n||(this.symbolArr[d.x][d.y-1].type=this.symbolArr[d.x][d.y-1].type%3+6,h.push({symbol:this.symbolArr[d.x][d.y-1]?this.symbolArr[d.x][d.y-1].type:null,x:d.x,y:d.y-1}))),this.symbolArr[d.x+1]&&this.symbolArr[d.x+1][d.y]&&this.checkCanUpCarMonster(this.symbolArr[d.x+1][d.y].type)&&(i==d.x+1&&d.y==n||(this.symbolArr[d.x+1][d.y].type=this.symbolArr[d.x+1][d.y].type%3+6,h.push({symbol:this.symbolArr[d.x+1][d.y]?this.symbolArr[d.x+1][d.y].type:null,x:d.x+1,y:d.y}))),this.symbolArr[d.x-1]&&this.symbolArr[d.x-1][d.y]&&this.checkCanUpCarMonster(this.symbolArr[d.x-1][d.y].type)&&(i==d.x-1&&d.y==n||(this.symbolArr[d.x-1][d.y].type=this.symbolArr[d.x-1][d.y].type%3+6,h.push({symbol:this.symbolArr[d.x-1][d.y]?this.symbolArr[d.x-1][d.y].type:null,x:d.x-1,y:d.y}))),o.push({index:e,center:d,isDrop:a,arr:h});break;case r.SandTableTrapType.CUIMIAN:var u=[];this.symbolArr[d.x][d.y+1]&&(this.setSymbolInfo(this.symbolArr[d.x][d.y+1],3,5),(i!=d.x||d.y+1!=n&&this.symbolArr[d.x][d.y+1].type<15)&&u.push({symbol:this.symbolArr[d.x][d.y+1]?this.symbolArr[d.x][d.y+1].type:null,grade:this.symbolArr[d.x][d.y+1]?this.symbolArr[d.x][d.y+1].grade:null,x:d.x,cuimian:1,y:d.y+1})),this.symbolArr[d.x][d.y-1]&&(this.setSymbolInfo(this.symbolArr[d.x][d.y-1],3,5),(i!=d.x||d.y-1!=n&&this.symbolArr[d.x][d.y-1].type<15)&&u.push({symbol:this.symbolArr[d.x][d.y-1]?this.symbolArr[d.x][d.y-1].type:null,grade:this.symbolArr[d.x][d.y-1]?this.symbolArr[d.x][d.y-1].grade:null,x:d.x,cuimian:1,y:d.y-1})),this.symbolArr[d.x+1]&&this.symbolArr[d.x+1][d.y]&&(this.setSymbolInfo(this.symbolArr[d.x+1][d.y],3,5),(i!=d.x+1||d.y!=n&&this.symbolArr[d.x+1][d.y].type<15)&&u.push({symbol:this.symbolArr[d.x+1]&&this.symbolArr[d.x+1][d.y]?this.symbolArr[d.x+1][d.y].type:null,grade:this.symbolArr[d.x+1]&&this.symbolArr[d.x+1][d.y]?this.symbolArr[d.x+1][d.y].grade:null,x:d.x+1,cuimian:1,y:d.y})),this.symbolArr[d.x-1]&&this.symbolArr[d.x-1][d.y]&&(this.setSymbolInfo(this.symbolArr[d.x-1][d.y],3,5),(i!=d.x-1||d.y!=n&&this.symbolArr[d.x-1][d.y].type<15)&&u.push({symbol:this.symbolArr[d.x-1]&&this.symbolArr[d.x-1][d.y]?this.symbolArr[d.x-1][d.y].type:null,grade:this.symbolArr[d.x-1]&&this.symbolArr[d.x-1][d.y]?this.symbolArr[d.x-1][d.y].grade:null,x:d.x-1,cuimian:1,y:d.y})),o.push({index:e,center:d,isDrop:a,arr:u})}a&&(this.storageArr[0]||(this.storageArr[0]=[]),this.storageArr[0].push({type:e,x:d.x,y:d.y}),this.symbolArr[d.x][d.y]=null,s=!0)}this.addTrapResultTwo(s,o)},t.prototype.setSymbolInfo=function(e,t,i){this.checkCanUpCarMonster(e.type)&&(e.type+=t),e.cuimian=1,e.grade=Math.min(r.MonsterMaxLevel,e.grade+i)},t.prototype._randomSym=function(){var e=Math.floor(this.height*Math.random()),t=Math.floor(this.width*Math.random());return this.symbolArr[e][t]&&this.checkCanUpCarMonster(this.symbolArr[e][t].type)&&-1==this.historyArr.indexOf(this.symbolArr[e][t])&&this.symbolArr[e][t].cuimian<=0&&this.symbolArr[e][t].banOneGame<=0?this.symbolArr[e][t+1]&&this.symbolArr[e][t+1].type==r.SandTableTrapType.CHUANSONG?this._randomSym():(this.historyArr.push(this.symbolArr[e][t]),{type:this.symbolArr[e][t].type,x:e,y:t}):this._randomSym()},t.prototype._randomStone=function(){var e=[],t=[];if(this.stoneArr.length)for(var i=0;i<this.stoneArr.length;i++){var n=this.stoneArr[i].removalFr-=5,o=this.stoneArr[i].x,a=this.stoneArr[i].y;if(n<=0)if(this.stoneArr[i].trapNum>0){var r;r=50+this.stoneArr[i].trapNum,this.symbolArr[this.stoneArr[i].x][this.stoneArr[i].y]={type:r,removalFr:this.stoneArr[i].stepsNum,info:this.stoneArr[i].info,operation:!1,banOneGame:0,cuimian:0,x:this.stoneArr[i].x,y:this.stoneArr[i].y},this.trapArr.push(this.symbolArr[this.stoneArr[i].x][this.stoneArr[i].y]);var s=this.trapArr[this.trapArr.length-1].removalFr;e.push({removalFr:-1,removaNum:s,x:o,y:a})}else this.symbolArr[this.stoneArr[i].x][this.stoneArr[i].y]=null,e.push({removalFr:0,x:o,y:a});else t.push(this.stoneArr[i]),e.push({removalFr:n,x:o,y:a})}return this.stoneArr=t,e},t.prototype._upGrade=function(){this.resultIndex=1,this.secondArr[this.isDropNum]||(this.secondArr[this.isDropNum]=[]),this._formationJudge(),this._arrange(),this.addRes(2),this.resetResultArr()},t.prototype.resetResultArr=function(){this.upSymbol=[],this.monster=[],this.crossArr=[],this.storageArr=[]},t.prototype._trapAway=function(){if(this.resultIndex=0,this.secondArr[this.isDropNum]||(this.secondArr[this.isDropNum]=[]),this._arrange(),this._aloneData(2),this.resetResultArr(),this._eliminate()>0)return this.resultIndex++,this._formationJudge(),this._arrange(),void this.addRes(2)},t.prototype._aloneData=function(e){var t=[];for(var i in this.symbolArr)for(var n in t[i]=[],this.symbolArr[i]){var o=this.symbolArr[i][n];t[i][n]={type:o.type,gradeUp:o.gradeUp,grade:o.grade,removalFr:o.removalFr,info:o.info,banOneGame:o.banOneGame,fallDownNum:o.fallDownNum,cuimian:o.cuimian,trapNum:o.trapNum,stepsNum:o.stepsNum}}var a=[];for(var i in this.storageArr)for(var n in a[i]=[],this.storageArr[i]){o=this.storageArr[i][n];a[i][n]={type:o.type,x:o.x,y:o.y}}var r=[];for(var i in this.monster){o=this.monster[i];r[i]={type:o.type,num:o.num,lv:o.lv}}var s=[];if(this.upSymbol.length>0)for(var i in this.storageArr)for(var n in s[i]=[],this.upSymbol[i])s[i].push(this.upSymbol[i][n]);this.upSymbol=[];var l=[];for(var i in this.addTrapArr)l.push(this.addTrapArr[0]);this.addTrapArr=[],1==e?this.data.push({result:{index:this.resultIndex,resultArr:t,storageArr:a,upSymbol:s,monsterArr:r,operationArr:this.operationArr,addTrapArr:l}}):(this.secondArr[this.isDropNum].push({result:{index:this.resultIndex,resultArr:t,storageArr:a,upSymbol:s,monsterArr:r,operationArr:this.operationArr,addTrapArr:l}}),console.log("\u6dfb\u52a0\u9677\u9631\u989d\u5916\u4e8b\u4ef6++ ",this.isDropNum,this.secondArr[this.isDropNum])),this.operationArr=[]},t.prototype.Random=function(){var e=3*this.gradeMax,t=Math.max(0,3*(this.gradeMin-1));a.default.instance.seed=(9301*a.default.instance.seed+49297)%233280;var i=a.default.instance.seed/233280;return Math.floor(t+i*(e-t))},t.prototype.SingleRandom=function(e){if(void 0===e&&(e=!1),e&&0==p.default.instance.currentChapterId&&c.ActivityStatus.value==c.ActivityStatus.Chapter&&0==p.default.instance.currentGuanqiaId&&0==p.default.instance.currentGuanqiaId&&(this.numsindex++,this.numsindex<this.nums.length))return this.nums[this.numsindex];var t=s.default.RandomBy(3*(this.gradeMin-1),3*(this.gradeMax-1)+2);if(l.MonsterType.MonsterWarTeam[l.MonsterType.MonsterBattle][t%3]>0)return t;if(c.ActivityStatus.value!=c.ActivityStatus.Guide){return[15,2,16][t%3]}return t},t.prototype.NewRandom=function(e){var t=this.SingleRandom();return t!=e?t:this.NewRandom(e)},t.prototype.checkIsGuideBaoXiang=function(e){return-1!=this.symbolGuideBaoXiangArr.indexOf(e)},t.prototype.checkCanUpCarMonster=function(e){return e<12},t.instance=null,t=i=__decorate([u],t)}(o.default));i.default=f,cc._RF.pop()},{"../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Widget":"Widget","../../Global/GlobalValue":"GlobalValue","../../Util/Utils":"Utils","../Arena/ArenaController":"ArenaController","../Chapter/ChapterController":"ChapterController","../Status/StatusType":"StatusType","../WarTeam/MonsterController":"MonsterController","./SandTableController":"SandTableController"}],SandTableBg:[function(e,t,i){"use strict";cc._RF.push(t,"d628c0KugZC8ZoN+MLvfZcB","SandTableBg"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/CommonsResManager"),a=cc._decorator,r=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bg=null,t.colorRecord=0,t._height=110,t._width=110,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this),this.colorRecord=0},t.prototype.setBgColor=function(e){this.colorRecord=e;var t=0;e<20?(t=Math.floor(e/3),15==e?t=0:16==e&&(t=0),this.bg.spriteFrame=o.default.instance.getSpriteFrameByName("mapPaper_"+t)):99==e?this.bg.spriteFrame=o.default.instance.getSpriteFrameByName("sandBg"):(t=0,this.bg.spriteFrame=o.default.instance.getSpriteFrameByName("mapPaper_6"))},t.prototype.setBgColorforgrade=function(e){this.bg.spriteFrame=o.default.instance.getSpriteFrameByName("mapPaper_"+(e-1))},t.prototype.setMapSize=function(e,t){this._width=t,this.bg.node.setContentSize(cc.size(e,t))},__decorate([s(cc.Sprite)],t.prototype,"bg",void 0),t=__decorate([r],t)}(n.default);i.default=l,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Widget":"Widget"}],SandTableCardSynthesis:[function(e,t,i){"use strict";cc._RF.push(t,"4d653sD4RpByoEt6bFqUiMP","SandTableCardSynthesis"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/WindowType"),a=e("../WarTeam/MonsterController"),r=e("../../Core/WindowManager"),s=e("../../Core/GameEventDispatcher"),l=e("../../Core/Event"),c=cc._decorator,d=c.ccclass,p=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layerMonster=null,t.spriteBG=null,t._scaleValue=1,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.show=function(){e.prototype.show.call(this),this.layerMonster.setPosition(0,0),this.spriteBG.on(cc.Node.EventType.TOUCH_END,this.onClick,this),this.node.getComponent(cc.Animation).on("finished",this.onAnimationFinish,this)},t.prototype.onPlayerEffect=function(){this.node.getComponent(cc.Animation).playAdditive("jyhc"),this.spriteBG.active=!0},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),this.spriteBG.off(cc.Node.EventType.TOUCH_END,this.onClick,this)},t.prototype.onClick=function(){this.onFinishEffect()},t.prototype.onInitData=function(e,t,i){void 0===i&&(i=5),this.onClear(),this.onPlayerEffect();var n=a.default.instance.getCardGradeByGradeConf(e,i);this._position=t,this._cardId=e,this._grade=i,this._scaleValue=n.sandScale/100,this.layerMonster.opacity=30,this.layerMonster.runAction(cc.fadeIn(.8)),a.default.instance.infoPreview(this.layerMonster,cc.v2(n.monsteroffset[0]/100,n.monsteroffset[1]/100),e,i,2*this._scaleValue,-1,!0,null,null)},t.prototype.onAnimationFinish=function(){var e=this;(this.spriteBG.active=!1,this.layerMonster.childrenCount>0)?this.layerMonster.children[0].runAction(cc.sequence(cc.spawn(cc.moveTo(.4,this._position),cc.scaleTo(.4,this._scaleValue)),cc.callFunc(function(){e.onFinishEffect()}))):this.onFinishEffect()},t.prototype.onFinishEffect=function(){this.onClear(),r.default.instance.close(o.WindowType.SandTableCardSynthesis),s.GameEventDispatcher.instance.emit(l.EventDefiner.SandTableCardSynthesisEffect)},t.prototype.onClear=function(){this.layerMonster.children.length>0&&this.layerMonster.children[0].stopAllActions(),this.layerMonster.destroyAllChildren()},t.instance=null,__decorate([p(cc.Node)],t.prototype,"layerMonster",void 0),__decorate([p(cc.Node)],t.prototype,"spriteBG",void 0),t=i=__decorate([d],t)}(n.default);i.default=h,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Widget":"Widget","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../WarTeam/MonsterController":"MonsterController"}],SandTableChapterguide:[function(e,t,i){"use strict";cc._RF.push(t,"58711gCQUNG8K6uvCZyc4bc","SandTableChapterguide"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("./SandTableMain"),a=e("../Status/StatusType"),r=e("../../Core/LoadManager"),s=e("../../GlobalContext"),l=e("./SandTableBg"),c=e("../WarTeam/MonsterController"),d=e("../../Core/GameEventDispatcher"),p=e("../../Core/Event"),h=e("../Commons/MonsterPreview"),u=e("../../Core/WindowType"),f=e("../../Util/Utils"),g=e("./SandTableController"),y=cc._decorator,m=y.ccclass,C=(y.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isgradelevel=!1,t.gradeindex=0,t.sandTableMerge=null,t.isMerge=!0,t.content=null,t.contentdata={},t.activeSandTable=[a.ActivityStatus.FridBoss],t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this),i.instance=this},t.prototype.hide=function(){e.prototype.hide.call(this),this.node.getChildByName("sandMonsterMerge")&&(this.isgradelevel=!1,this.gradeindex=0,this.contentdata={})},t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.creatorsandTableMerge=function(){var e=this;this.isMerge=!0,this.sandTableMerge?this.creatorMerge():r.default.instance.loadResByType(s.GlobalContext.Root+"prefab/sandTable/sandMonsterMerge",cc.Prefab,function(t){var i=f.default.getNodeByUrl(t,s.GlobalContext.Root+"prefab/sandTable/sandMonsterMerge");e.sandTableMerge=i,e.creatorMerge()},this)},t.prototype.setgradedata=function(e){this.isgradelevel||e>=3&&(o.default.instance.isStopoutside=!0)},t.prototype.getgradeindexnum=function(e){this.isgradelevel&&this.gradeindex++,this.gradeindex>=3&&(o.default.instance._moveNum=0)},t.prototype.creatorMerge=function(){var e;this.node.getChildByName("sandMonsterMerge")?e=this.node.getChildByName("sandMonsterMerge"):this.node.addChild(this.sandTableMerge),e.getComponent(cc.Widget).left=s.PlayerData.SceneBorld,this.content=e.getComponentInChildren(cc.Layout).node,this.creatorlist()},t.prototype.creatorlist=function(){var e=this;r.default.instance.loadResByType(s.GlobalContext.Root+"prefab/sandTable/lattice",cc.Prefab,function(t){for(var i=0;i<6;i++){var n=void 0;if(e.content.children[i])(n=e.content.children[i]).getComponentInChildren(h.default).clear(),f.default.setNodeToPool(u.PoolType.MonsterPreview,n.getComponentInChildren(h.default).node);else{n=f.default.getNodeByUrl(t,s.GlobalContext.Root+"prefab/sandTable/lattice");var o=cc.instantiate(e.content.parent.getChildByName("fonttips"));n.addChild(o),o.setPosition(15,-20),o.active=!0,e.content.addChild(n)}var r=g.default.instance.getMonsterid(i%3),d=c.default.instance.getCardGradeByGradeConf(r.id,1+Math.floor(i/3));c.default.instance.infoPreview(n,cc.v2(2*d.monsteroffset[0]/300,2*d.monsteroffset[1]/300),r.id,1+Math.floor(i/3),.625*d.sandScale/100),n.active=!0,n.setContentSize(100,100),n.getComponent(l.default).setMapSize(80,80),n.getComponent(l.default).setBgColorforgrade(1+Math.floor(i/3)),n.name=r.id+"_"+(1+Math.floor(i/3)),n.getChildByName("fonttips").getComponentInChildren(cc.Label).string="0",n.getChildByName("fonttips").setSiblingIndex(n.childrenCount-1),e.activeSandTable.indexOf(a.ActivityStatus.value)>-1&&1+Math.floor(i/3)<=1&&(n.active=!1)}},this)},t.prototype.getcontentdata=function(e){var t=e[0]+"_"+e[1],i=e[0]+"_"+e[1]+"_"+e[2];if(this.activeSandTable.indexOf(a.ActivityStatus.value)>-1&&e[1]<=1){var n={cardid:e[0],grade:e[1],level:e[2],num:1,self:!0,autoUseSkill:!1,noaddfight:!0};d.GameEventDispatcher.instance.emit(p.EventDefiner.C_Scene_Add_Actor,n)}else{if(this.contentdata[t]||(this.contentdata[t]={}),this.contentdata[t][i])this.contentdata[t][i].num+=e[3];else{n={grade:e[1],id:e[0],level:e[2],num:e[3]};this.contentdata[t][i]=n}var o=0,r=[];for(var s in this.contentdata[t])if(o+=this.contentdata[t][s].num,r.push(s),o>=3)for(var l=0,c=0,h=0,u=0;u<r.length;u++){var f=this.contentdata[t][r[u]];if(c=f.grade,h=f.id,f.num>0)if(o-f.num>0)l+=f.num*f.level,o-=f.num,this.contentdata[t][r[u]].num=0;else{if(l+=(o>3?3:o)*f.level,this.contentdata[t][r[u]].num=f.num-(o>3?3:o),c<=1)this.getcontentdata([h,c+1,l,1]);else{console.log("\u5408\u6210\u602a\u7269id:"+h+",grade:"+(c+1)+",level:"+l+",num:1");n={cardid:h,grade:c+1,level:l,num:1,self:!0,autoUseSkill:!1,noaddfight:!0};d.GameEventDispatcher.instance.emit(p.EventDefiner.C_Scene_Add_Actor,n)}if(!((o=this.contentdata[t][r[u]].num)>=3))break;u--}}this.content.getChildByName(t)&&(this.content.getChildByName(t).getChildByName("fonttips").getComponentInChildren(cc.Label).string=""+o)}},t.prototype.addAllmonster=function(){for(var e in this.contentdata){for(var t in this.contentdata[e])if(this.contentdata[e][t].num>0){console.log("\u5408\u6210\u602a\u7269id:"+this.contentdata[e][t].id+",grade:"+this.contentdata[e][t].grade+",level:"+this.contentdata[e][t].level+",num:"+this.contentdata[e][t].num);var i={cardid:this.contentdata[e][t].id,grade:this.contentdata[e][t].grade,level:this.contentdata[e][t].level,num:this.contentdata[e][t].num,self:!0,autoUseSkill:!1,noaddfight:!0};d.GameEventDispatcher.instance.emit(p.EventDefiner.C_Scene_Add_Actor,i)}this.content.getChildByName(e)&&(this.content.getChildByName(e).getChildByName("fonttips").getComponentInChildren(cc.Label).string="0")}this.isMerge=!1,this.scheduleOnce(function(){o.default.instance.close()},1)},t.instance=null,t=i=__decorate([m],t)}(n.default));i.default=C,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/LoadManager":"LoadManager","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/MonsterPreview":"MonsterPreview","../Status/StatusType":"StatusType","../WarTeam/MonsterController":"MonsterController","./SandTableBg":"SandTableBg","./SandTableController":"SandTableController","./SandTableMain":"SandTableMain"}],SandTableConditionController:[function(e,t,i){"use strict";cc._RF.push(t,"a4510HMy85EfLHNwN8PJBpq","SandTableConditionController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Chapter/GuanqiaController"),o=e("../OpenWin/OpenWinController"),a=e("../../Core/WindowType"),r=e("./SandTableController"),s=e("./SandtableFunTip"),l=function(){function e(){this.gradeCompoundCount={},this.dragCount=0,this.oldconfitionconf=null,this._conf={},this._conditionList=[]}return Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"config",{get:function(){return this._conf},enumerable:!0,configurable:!0}),e.prototype.init=function(e){this._conf=e,this._conditionList=[],e.condition&&(this._conditionList=n.default.instance.config.condition[e.condition]),this.oldconfitionconf=null,this.gradeCompoundCount={1:0,2:0,3:0,4:0,5:0},this.dragCount=0},Object.defineProperty(e.prototype,"hasCondition",{get:function(){return this._conditionList.length>0},enumerable:!0,configurable:!0}),e.prototype.getCurConditionConf=function(){for(var e=0;e<this._conditionList.length;e++){var t=this._conditionList[e];switch(t.type){case 1:if(!this.gradeCompoundCount[t.param])return this.cheakNewCondidion(t),t;break;case 2:if(t.param>this.dragCount)return this.cheakNewCondidion(t),t}}return null},e.prototype.cheakNewCondidion=function(e){if(e!=this.oldconfitionconf)switch(this.oldconfitionconf=e,e.type){case 1:this.gradeCompoundCount={1:0,2:0,3:0,4:0,5:0};break;case 2:this.dragCount=0}},e.prototype.checkOpenFunctionTip=function(){var e=this;this._conf.openfunction&&(r.default.instance.automatic=!1,r.default.instance.autoPlay=!1,3!=this._conf.openfunction?o.default.instance.openWindow(a.WindowType.SandtableFunTip,function(){s.default.instance.Info(e._conf.openfunction)},this):o.default.instance.openWindow(a.WindowType.SandtableShapan))},e._instance=null,e}();i.default=l,cc._RF.pop()},{"../../Core/WindowType":"WindowType","../Chapter/GuanqiaController":"GuanqiaController","../OpenWin/OpenWinController":"OpenWinController","./SandTableController":"SandTableController","./SandtableFunTip":"SandtableFunTip"}],SandTableController:[function(e,t,i){"use strict";cc._RF.push(t,"4ab2fEQF59JxJoCN/aCoTQ8","SandTableController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../NetConnect/NetConnet"),a=e("../../Core/GameEventDispatcher"),r=e("../Status/StatusType"),s=e("../Scene/Manager/SceneManager"),l=e("../../Core/Event"),c=e("../WarTeam/MonsterController"),d=e("../Chapter/ChapterController"),p=e("../../Core/ConfigsManager"),h=e("../Scene/Controller/GuideFightController"),u=e("./SandTableMain"),f=e("../Fight/FightUtils"),g=e("../Guide/GuideNewController"),y=cc._decorator,m=y.ccclass,C=(y.property,function(e){function t(){var t=e.call(this)||this;return t._recordArr=[],t.totaleMove=0,t.infoData=null,t.scale=null,t.step=null,t.seed=null,t.gradeMin=null,t.gradeMax=null,t.sharpstep=0,t.autoPlay=null,t.sandtableDrop=[r.ActivityStatus.Arena,r.ActivityStatus.HighLadder,r.ActivityStatus.TreasureMap,r.ActivityStatus.WorldBoss,r.ActivityStatus.EliteBoss,r.ActivityStatus.LoardCrusade],t.ConsumeOffice=null,t.autoSwitch={},t._openTipe=!0,t.fractionArr=[],t.indexArr=[],i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){this.addProto("sandtable",this.sandtable,this),this.addProto("addstep",this.addstep,this);var e=p.ConfigsManager.instance.getConfigs("sandtableconf").sandTableConf;for(var t in this.ConsumeOffice=[],e)e[t].isconsume||this.ConsumeOffice.push(e[t].code)},t.prototype.addstep=function(e){i.instance.step=e.step,r.ActivityStatus.value==r.ActivityStatus.Arena&&(s.default.instance.enemyallstep=e.step,a.GameEventDispatcher.instance.emit(l.EventDefiner.Updata_StepNum))},t.prototype.clearData=function(){this._recordArr=[],this.infoData=null,this.totaleMove=0,this.scale=null,this.step=null,this.seed=null,this.gradeMax=null,this.gradeMin=null},t.prototype.setNowArr=function(e){for(var t in e)for(var i in this._recordArr[t]=[],e[t])e[t][i].type<50?this._recordArr[t][i]={type:e[t][i].type,grade:e[t][i].grade,gradeUp:e[t][i].gradeUp,info:e[t][i].info,fallDownNum:0}:this._recordArr[t][i]={type:e[t][i].type,info:e[t][i].info,trapNum:e[t][i].trapNum,removalFr:e[t][i].removalFr,stepsNum:e[t][i].stepsNum||0};this.totaleMove=0},t.prototype.sandtable=function(e){this.scale=e.scale,this.step=e.step,this.gradeMax=e.gradeMax,this.gradeMin=e.gradeMin,r.ActivityStatus.value==r.ActivityStatus.Arena&&(s.default.instance.enemyallstep=this.step,a.GameEventDispatcher.instance.emit(l.EventDefiner.Updata_StepNum)),this.seed=e.seed,a.GameEventDispatcher.instance.emit("SANDTABLECOMEBACK",{scale:this.scale,step:this.step,seed:this.seed,gradeMax:this.gradeMax,gradeMin:this.gradeMin})},t.prototype.getSandCome=function(){var e=null;return this.seed?{scale:this.scale,step:this.step,seed:this.seed,gradeMax:this.gradeMax,gradeMin:this.gradeMin}:e},t.prototype.sandtableinput=function(e){this.SendInfo(e)},t.prototype.sandtablefinish=function(){o.default.instance.sendProto({cmd:"sandtablefinish"})},t.prototype.getOldArr=function(){return!!this._recordArr.length&&this._recordArr},t.prototype.setOldArr=function(e){this._recordArr=e},t.prototype.setTotaleMove=function(e){void 0===e&&(e=-1),this.totaleMove=e+f.FightUtils.additionalReserveNum()},t.prototype.setSandInfo=function(e){this.infoData=e},t.prototype.getSandInfo=function(){return this.infoData},t.prototype.getTotaleMove=function(){return this.totaleMove},t.prototype.oneMoveTime=function(e){void 0===e&&(e=!0),this._recordArr=[],this.infoData="",this.totaleMove=0},t.prototype.setMaxGrade=function(e,t){var i={cmd:"cardupgrade",id:e,grade:t};this.sendProto(i)},t.prototype.SendInfo=function(e){var t={cmd:"sandtableinput",input:e};this.sendProto(t)},t.prototype.getMonsterid=function(e){return r.ActivityStatus.value==r.ActivityStatus.Guide?{id:h.default.instance.getBattleList(e),level:1}:c.default.instance.GetWarTeamConfig()[e]},Object.defineProperty(t.prototype,"automatic",{get:function(){return this.autoSwitch[r.ActivityStatus.value]||!1},set:function(e){this.autoSwitch[r.ActivityStatus.value]=e,u.default.instance&&!e&&u.default.instance.stopAutoEffect()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"openTipe",{get:function(){return(0!=d.default.instance.currentChapterId||0!=d.default.instance.currentGuanqiaId||!g.default.instance.isGuide)&&(!g.default.instance.isGuide&&this._openTipe)},set:function(e){this._openTipe=e},enumerable:!0,configurable:!0}),t.prototype.getautomaticStar=function(e){this.indexArr=e,this.fractionArr=[];for(var t=0;t<this.indexArr.length;t++)for(var i=0;i<this.indexArr[t].length;i++){var n=this.indexArr[t][i];null!=n&&n.type<30&&!n.cuimian&&!n.banOneGame&&this._replaceStar(t,i)}return this.fractionArr},t.prototype._replaceStar=function(e,t){for(var i=0,n=0,o=0,a=this.indexArr.slice(0),r=e;r<this.indexArr.length;r++)for(var s=r==e?t:0;s<this.indexArr[r].length;s++){var l=this.indexArr[r][s];if((r!=e||s!=t)&&null!=l&&l.type<30&&!l.cuimian&&!l.banOneGame){this._arrExchange(a,e,t,r,s),o=0;var c=0;if(i=this._inspectArr(a,e,t),o+=this.computingPower(a[e][t].type,i),i&&(c+=Math.floor(a[e][t].type/3)),n=this._inspectArr(a,r,s),o+=this.computingPower(a[r][s].type,n),n&&(c+=Math.floor(a[r][s].type/3)),o||(o=0),i+n>0){var d={power:o,x:0,y:0,x1:0,y1:0,type:c};i>n?(d.x=r,d.y=s,d.x1=e,d.y1=t):(d.x=e,d.y=t,d.x1=r,d.y1=s),this.fractionArr.push(d)}this._arrExchange(a,r,s,e,t)}}},t.prototype._arrExchange=function(e,t,i,n,o){var a=e[t][i];e[t][i]=e[n][o],e[n][o]=a},t.prototype._inspectArr=function(e,t,i){var n=0,o=[],a=e[t][i].type,r=0;for(var s in e)o.push(e[s][i].type);for(var s in r+=(n=this._check(o,a))>0?2+n:0,o=[],e[t])o.push(e[t][s].type);n=this._check(o,a),r+=r?n>0?1+n:0:n>0?2+n:0;var l=this.indexArr[0].length>this.indexArr.length?this.indexArr[0].length:this.indexArr.length,c=0,d=0;t+i<l?(c=t+i,d=0):d=i-((c=this.indexArr.length-1)-t),o=[];for(var p=0;p<l;p++)if(o.push(e[c][d].type),d++,--c>=l||c<0||d>=l||d<0){n=this._check(o,a);break}r+=r?n>0?1+n:0:n>0?2+n:0,t>i?(c=t-i,d=0):(c=0,d=i-t),o=[];for(p=0;p<l;p++)if(o.push(e[c][d].type),d++,++c>=l||c<0||d>=l||d<0){n=this._check(o,a);break}return r+=r?n>0?1+n:0:n>0?2+n:0},t.prototype._check=function(e,t){var i=0,n=null,o=0;for(var a in e)e[a]<12&&null!==e[a]&&n==e[a]&&n==t?++o>=2&&i++:(n=e[a],o=0);return i},t.prototype.computingPower=function(e,t){var i=this.getMonsterid(e%3);if(!i)return 0;if(!t)return 0;var n=i.id,o=i.level,a=Math.floor(e/3)+1,r=t-2;return c.default.instance.getCarFight(n,o,a)*r},t.instance=null,t=i=__decorate([m],t)}(n.default));i.default=C,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../NetConnect/NetConnet":"NetConnet","../Chapter/ChapterController":"ChapterController","../Fight/FightUtils":"FightUtils","../Guide/GuideNewController":"GuideNewController","../Scene/Controller/GuideFightController":"GuideFightController","../Scene/Manager/SceneManager":"SceneManager","../Status/StatusType":"StatusType","../WarTeam/MonsterController":"MonsterController","./SandTableMain":"SandTableMain"}],SandTableIntegral:[function(e,t,i){"use strict";cc._RF.push(t,"cb0d9Tb3phKsYXk18CkAmKo","SandTableIntegral"),Object.defineProperty(i,"__esModule",{value:!0});var n=cc._decorator,o=n.ccclass,a=n.property,r=e("../../Core/Widget"),s=e("../../NetConnect/NetConnet"),l=e("../../Core/GameEventDispatcher"),c=e("../../Core/Event"),d=e("../../Util/SDKUtils"),p=e("../Role/RoleInfo"),h=e("../Tips/OpTipsController"),u=e("../../Core/Language"),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.btnLabel=null,t.Label=null,t.windowsBox=null,t.cb=null,t}return __extends(t,e),t.prototype.start=function(){},t.prototype.show=function(){e.prototype.show.call(this),this.node.active=!0,l.GameEventDispatcher.instance.once(c.EventDefiner.buystep,this.successbuy,this)},t.prototype.init=function(e){this.cb=e},t.prototype.consumer=function(){s.default.instance.sendProto({cmd:"buygamesteps"}),console.log("\u8d2d\u4e70\u6b65\u6570")},t.prototype.successbuy=function(){this.cb&&this.cb(1),this.cb=null,this.hide()},t.prototype.share=function(){var e=this;d.default.instance.isInitWX?d.default.instance.shareAppMessage(function(){e.cb&&e.cb(2),e.cb=null,e.hide()},this,"themeshopstep="+p.MyRoleInfo.id,function(){h.default.instance.ShowMsg(u.default.getStr("\u5931\u8d25")),e.cb&&e.cb(2),e.cb=null,e.hide()},this):(this.cb&&this.cb(2),this.cb=null,this.hide())},t.prototype.hide=function(){e.prototype.hide.call(this),l.GameEventDispatcher.instance.off(c.EventDefiner.buystep,this.successbuy,this),this.cb&&this.cb(3),this.cb=null,this.node.active=!1},__decorate([a(cc.Label)],t.prototype,"btnLabel",void 0),__decorate([a(cc.Label)],t.prototype,"Label",void 0),__decorate([a(cc.Node)],t.prototype,"windowsBox",void 0),t=__decorate([o],t)}(r.default);i.default=f,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/Widget":"Widget","../../NetConnect/NetConnet":"NetConnet","../../Util/SDKUtils":"SDKUtils","../Role/RoleInfo":"RoleInfo","../Tips/OpTipsController":"OpTipsController"}],SandTableMain:[function(e,t,i){"use strict";cc._RF.push(t,"c97f5Cg60NFqodQApTTXFIn","SandTableMain"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/GameEventDispatcher"),o=e("../WarTeam/MonsterController"),a=e("../../Core/Event"),r=e("./SandTableController"),s=e("../Status/StatusType"),l=e("../Role/RoleInfo"),c=e("../../Core/Window"),d=e("../../GlobalContext"),p=e("../Scene/Manager/SceneManager"),h=e("../../Core/TimeController"),u=e("../Chapter/ChapterController"),f=e("./SandTableChapterguide"),g=e("./SandTableBackstage"),y=e("../Scene/Controller/SceneController"),m=e("../../Global/GlobalValue"),C=e("../../NetConnect/NetConnet"),v=e("./SandTableSymbol"),_=e("../../Core/ConfigsManager"),b=e("../Status/StatusController"),T=e("../OpenWin/OpenWinController"),S=e("../../Core/WindowType"),I=e("../Guide/GuideNewController"),w=e("../Scene/Controller/FightController"),D=e("../Scene/Controller/MonsterInitPointController"),R=e("../Scene/View/ActorsLayer"),A=e("../Scene/Pool/SpinePools"),N=e("../../Core/SpineBase"),L=e("../../Core/LoadManager"),E=e("../../Core/CacheManager"),B=e("./SandTableCardSynthesis"),M=e("../../Core/Language"),x=e("../Totems/TotemsCtrl"),k=e("../Arena/ArenaController"),P=e("../Tips/OpTipsController"),G=e("../Sound/SoundController"),F=e("../Scene/Controller/GuideFightController"),W=e("./SandTableConditionController"),U=e("../../Util/Utils"),O=e("../setting/SettingData"),V=e("../../Core/WindowManager"),q=cc._decorator,H=q.ccclass,j=q.property,K=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.labelNode=null,t.TouchNode=null,t.actionNode=null,t.bg=null,t.tipsNode=null,t.tipsBtn=[],t.autoBtn=null,t.fightBtn=null,t.infoNode=null,t.canPrompt=null,t.comboBox=null,t.btnBack=null,t.stepback=null,t.timeLab=null,t.timenode=null,t.incredible=null,t.great=null,t.good=null,t.spalt=null,t.course=null,t.Spoint=cc.v2(286,167.5),t._height=110,t._width=110,t._speed=.05,t.sandTableScale=650,t._arrHeight=4,t._arrWidth=4,t.length=0,t.sonLength=0,t._moveNum=0,t._motionNum=0,t._motionAllNum=0,t._totalMoveNum=0,t._cycleIndex=0,t._twinkleNum=0,t._twinkleSign=0,t.dropNum=0,t.orldropNum=0,t.drakeIndex=0,t.secondCycle=0,t._data=[],t.mapArr=[],t.symbolArr=[],t.stoneArr=[],t.indexArr=[],t.fractionArr=[],t._nowSymbol=null,t.tipePool=null,t.twinkleTime=null,t._processIn=!1,t._lock=!1,t._sports=!1,t._INTheHigh=!1,t.inSecondCycle=!1,t.synthesis=!1,t.isStopoutside=!0,t.integraArr=[],t.integraSArr=[],t.isaddstep=!1,t.fighitNum=0,t.istrap=!1,t.canplayelimination=!0,t._oldSandData=null,t._effectSymbolNode=null,t.sandtableeffects=[m.SPINE_RES_DIR+"sandtable/compound/effect"],t.autoNodeList=[],t.time1=null,t.time2=null,t.showEffectSymbolNodeTime=0,t.isMove=!1,t.isImmediatelyClose=!1,t.creatorMonsterNum=0,t.trapcom=!0,t.tipoperation=null,t.combo=0,t.starttipstime=0,t.ctr=null,t.isHaveMasSenior=!1,t.waitlist=[],t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){this.node.width=d.GlobalContext.UIWidth,this.node.height=d.GlobalContext.UIHeight,this.node.width=Math.min(d.GlobalContext.StageWidth,1624),this.node.height=Math.min(d.GlobalContext.StageHeight,1e3),this.ctr=r.default.instance},t.prototype.start=function(){e.prototype.start.call(this),i.instance=this,this.incredible.getComponent(cc.Animation).on("finished",this.eliminationCom,this),this.great.getComponent(cc.Animation).on("finished",this.eliminationCom,this),this.good.getComponent(cc.Animation).on("finished",this.eliminationCom,this),this.tipsNode.node.active=!1,this.course.getComponent(cc.RichText).string=M.default.getStr("101")},t.prototype.setNei=function(e){for(var t in this.symbolArr)for(var i=0;i<this.symbolArr.length;i++)this.symbolArr[t][i]&&this.symbolArr[t][i].getComponent("SandTableSymbol").index(e)},t.prototype.findOffice=function(){var e,t,n;if(-1==l.MyRoleInfo.guide.indexOf(24)&&!I.default.instance.isGuide){for(var o in this.symbolArr)for(var a=0;a<this.symbolArr.length;a++)this.symbolArr[o][a]&&(e=this.symbolArr[o][a].getComponent("SandTableSymbol").getIndex(),!t&&e/3>=2&&e/3<3&&(t=!0),e==m.SandTableTrapType.SHENGJI&&(n=!0));t&&n&&i.instance._moveNum>0&&I.default.instance.checkCondition(24,m.SandTableTrapType.SHENGJI)}},t.prototype.findNode=function(){var e;for(var t in this.setXY(),this.symbolArr)for(var i=0;i<this.symbolArr.length;i++)if(this.symbolArr[t][i]&&(e=this.symbolArr[t][i].getComponent("SandTableSymbol").getIndex())/3>=2&&e/3<3)return this.symbolArr[t][i];return null},t.prototype.highLadder=function(e){if(e)this.close();else{for(var t in n.GameEventDispatcher.instance.emit("SABDTAVKEINITDATA",this),this.symbolArr)for(var i in this.symbolArr[t])this.symbolArr[t][i]&&(U.default.setNodeDestoryByUrl(this.symbolArr[t][i],d.GlobalContext.Root+"prefab/sandTable/symbol"),U.default.setNodeDestoryByUrl(this.mapArr[t][i],d.GlobalContext.Root+"prefab/sandTable/lattice"));this.TouchNode.destroyAllChildren(),this.indexArr=[],this.symbolArr=[],this.mapArr=[],this._data=[],this.stoneArr=[],this.integraArr=[];var o=this,a=h.default.instance.setTimeout(function(){o.inGame(),h.default.instance.clearTimeout(a)},this,250)}},t.prototype.switchRule=function(e){var t=this.node.getChildByName("rulebox");t.stopAllActions();var i=this.node.getChildByName("ruleBtn").getChildByName("btn_jiantou");if(t.active){var n=1,o=d.GlobalContext.UIWidth/2-this.node.getChildByName("rulebox").width/2;o>=t.x&&(o=d.GlobalContext.UIWidth/2+this.node.getChildByName("rulebox").width/2,n=-1),i.scaleX=n,t.runAction(cc.moveTo(.5,o,0))}},t.prototype.show=function(){var t=this;e.prototype.show.call(this),G.default.instance.PlayBGM(G.SoundType.sandtableWindowBG),this.sandtableeffects.forEach(function(e){L.default.instance.loadResByType(e,sp.SkeletonData,null,null),E.default.instance.setUseRecord(e)}),this.UpdataStepTime(),n.GameEventDispatcher.instance.on(a.EventDefiner.SandTableSybomlMove,this._starMore,this),n.GameEventDispatcher.instance.on(a.EventDefiner.SandTableMainClose,this.close,this),n.GameEventDispatcher.instance.on(a.EventDefiner.Updata_Step_Time,this.UpdataStepTime,this),n.GameEventDispatcher.instance.on(a.EventDefiner.SandTableCardSynthesisEffect,this.onSynthesisEffect,this);var i=this,o=h.default.instance.setTimeout(function(){i.inGame(),n.GameEventDispatcher.instance.on("SHOWTRAP",t.showInfo,t),h.default.instance.clearTimeout(o)},this,100);this.incredible.active=!1,this.great.active=!1,this.good.active=!1,this.stopAutoEffect(),n.GameEventDispatcher.instance.emit(a.EventDefiner.C_Fight_StopTask),this.isHaveMasSenior=!1},t.prototype.initUIData=function(){var e=this;I.default.instance.isGuide||I.default.instance.checkCondition(22),this.fightBtn.active=!1,this.TouchNode.active=!0,this.actionNode.active=!0,this.labelNode.active=!0,this.labelNode.active=!0,this.course.active=u.default.instance.isBaoXiangCourse();if(s.ActivityStatus.value==s.ActivityStatus.Guide)this.autoBtn.active=!1,this.setTipsBtnActive(!1),this.labelNode.active=!1,this.course.active=!1,this.openTips(1);else{if(s.ActivityStatus.value==s.ActivityStatus.Chapter){if(0==u.default.instance.currentChapterId&&!I.default.instance.isGuide)h.default.instance.setTimeout(function(){e.openTips(1)},this,1e3);var t=u.default.instance.chekcSatisfyChapteridAndGqid(3,1);if(t)var i=h.default.instance.setTimeout(function(){e.fightBtn.active=!0,h.default.instance.clearTimeout(i)},this,2e3);this.autoBtn.active=t,this.initAutoState()}else this.autoBtn.active=!0,this.ctr.openTipe=!1,this.initAutoState();1e3}this.ctr.automatic||(this._processIn=!1),this.initRuleBox(),this.updateCondition()},t.prototype.initRuleBox=function(){var e=this.node.getChildByName("ruleBtn").getChildByName("btn_jiantou"),t=d.GlobalContext.UIWidth/2-this.node.getChildByName("rulebox").width/2;e.scaleX<0&&(t=d.GlobalContext.UIWidth/2+this.node.getChildByName("rulebox").width/2),this.node.getChildByName("rulebox").x=t,this.node.getChildByName("ruleBtn").x=d.GlobalContext.UIWidth/2-this.node.getChildByName("ruleBtn").width/2},t.prototype.startAutoEffect=function(){var e=cc.repeatForever(cc.rotateBy(1,360));this.autoBtn.getChildByName("icon_fengche").runAction(e),this.autoBtn.getChildByName("autostutasp").getComponent(cc.Sprite).spriteFrame=this.spalt.getSpriteFrame("i18n_shoudong")},t.prototype.stopAutoEffect=function(){this.autoBtn.getChildByName("icon_fengche").stopAllActions(),this.autoBtn.getChildByName("icon_fengche").rotation=0,this.autoBtn.getChildByName("autostutasp").getComponent(cc.Sprite).spriteFrame=this.spalt.getSpriteFrame("i18n_zidong")},t.prototype.initAutoState=function(){this.ctr.openTipe?this.setTipsShow(!0):this.setTipsShow(!1)},t.prototype.initAutoStateX=function(e){this.autoBtn.x=e,this.tipsBtn[1].node.x=e,this.tipsBtn[0].node.x=e,this.fightBtn.x=e},t.prototype.hide=function(){e.prototype.hide.call(this),this.sandtableeffects.forEach(function(e){E.default.instance.clearUseRecord(e)}),n.GameEventDispatcher.instance.off(a.EventDefiner.SandTableCardSynthesisEffect,this.onSynthesisEffect,this),n.GameEventDispatcher.instance.off(a.EventDefiner.Updata_Step_Time,this.UpdataStepTime,this),s.ActivityStatus.value==s.ActivityStatus.Chapter&&0==u.default.instance.currentChapterId&&u.default.instance.currentGuanqiaId<2&&this.ctr.clearData(),n.GameEventDispatcher.instance.off(a.EventDefiner.SandTableSybomlMove,this._starMore,this),n.GameEventDispatcher.instance.off(a.EventDefiner.SandTableMainClose,this.close,this)},t.prototype.talentInfoSet=function(e,t){},t.prototype.showInfo=function(e){var t=e.getUserData(),i=t.index,n=t.info;this.infoNode.getComponent("SandTableRec").setInfo(i,n),this.infoNode.getComponent("SandTableRec").show(),I.default.instance.isGuide&&I.default.instance.stopCondition(21)},t.prototype.UpdataStepTime=function(){var e=this;if(s.ActivityStatus.value==s.ActivityStatus.Arena&&2!=k.default.instance.waittype){if(this.timenode.active=p.default.instance.steptime>0,p.default.instance.steptime>0)var t=h.default.instance.setInterval(function(){p.default.instance.steptime-h.default.instance.ServerTimeMins>0?e.timeLab.string=Math.ceil((p.default.instance.steptime-h.default.instance.ServerTimeMins)/1e3)+"":(p.default.instance.steptime=0,e.timenode.active=!1,h.default.instance.clearInterval(t),e.close())},this,1e3)}else this.timenode.active=!1},t.prototype.checkClose=function(){return!!(this.isImmediatelyClose&&this.creatorMonsterNum<=0&&this.trapcom)&&(this.close(),!0)},t.prototype.onFightBtn=function(e){var t=this;if(e){if(this.fightBtn.active=!1,this.isImmediatelyClose=!0,!this.ctr.automatic&&this.creatorMonsterNum<=0&&this.trapcom)var i=h.default.instance.setTimeout(function(){t.close(),h.default.instance.clearTimeout(i)},this,200)}else this.close()},t.prototype.close=function(t,i){if(void 0===t&&(t=!1),void 0===i&&(i=!1),I.default.instance.isGuide&&I.default.instance.stopCondition(21),this.fightBtn.active=!1,s.ActivityStatus.value==s.ActivityStatus.Guide&&(this.ctr.openTipe=!1),this.tipoperation=null,this.isImmediatelyClose=!1,this.creatorMonsterNum=0,this.clearAutoEffect(),f.default.instance.isMerge)f.default.instance.addAllmonster();else{for(var o in s.ActivityStatus.Arena==s.ActivityStatus.value&&p.default.instance.steptime-h.default.instance.ServerTimeMins>0?(this.TouchNode.active=!1,this.autoBtn.active=!1,this.actionNode.active=!1,this.labelNode.active=!1):e.prototype.close.call(this),s.ActivityStatus.value!=s.ActivityStatus.Arena&&n.GameEventDispatcher.instance.emit("SABDTAVKEINITDATA",this),this.symbolArr)for(var r in this.symbolArr[o])this.symbolArr[o][r]&&(U.default.setNodeDestoryByUrl(this.symbolArr[o][r],d.GlobalContext.Root+"prefab/sandTable/symbol"),U.default.setNodeDestoryByUrl(this.mapArr[o][r],d.GlobalContext.Root+"prefab/sandTable/lattice"));for(this.canPrompt&&this.canPrompt.active&&(this.canPrompt.stopAllActions(),this.canPrompt.active=!1),n.GameEventDispatcher.instance.off("SHOWTRAP",this.showInfo,this),s.ActivityStatus.Chapter==s.ActivityStatus.value&&(this.ctr.automatic=!1),this.symbolArr=[],this.mapArr=[],this._data=[],this.stoneArr=[],this.indexArr=[],this.integraArr=[],this.TouchNode&&this.TouchNode.destroyAllChildren();this.tipePool.size()>0;)U.default.setNodeDestoryByUrl(this.tipePool.get(),d.GlobalContext.Root+"prefab/sandTable/callNum");this.autoBtn&&this.stopAutoEffect(),this.tipsNode.node.stopAllActions(),this.tipsNode.node.active=!1,this._processIn=!1,this.inSecondCycle=!1,this._lock=!1,this.stopAutoEffect(),this.infoNode&&this.infoNode.getComponent("SandTableRec").hide(),this.twinkleTime&&(clearTimeout(this.twinkleTime),this.twinkleTime=null),this.offTouchNode(),i?T.default.instance.openWindow(S.WindowType.TreasureTroop,function(){},this):t||this._INTheHigh||s.ActivityStatus.value==s.ActivityStatus.Guide||n.GameEventDispatcher.instance.emit(a.EventDefiner.C_Fight_Start)}},t.prototype.btnOpenTips=function(e){this.openTips()},t.prototype.openAutomatic=function(){this.setAutomatic()},t.prototype.setTipsBtnActive=function(e){this.tipsBtn[1].node.active=e,this.tipsBtn[0].node.active=e},t.prototype.setTipsShow=function(e){u.default.instance.chekcSatisfyChapteridAndGqid(0,2)?(this.tipsBtn[0].node.active=!e,this.tipsBtn[1].node.active=e):this.setTipsBtnActive(!1)},t.prototype.setStartTipsTime=function(){var e=this;if((this.ctr.openTipe||this.ctr.automatic)&&!this._processIn){this.clearStartTipsTime();var t=2e3;(this.ctr.automatic||0==u.default.instance.currentChapterId&&0==u.default.instance.currentGuanqiaId)&&(t=100),!this.starttipstime&&this._moveNum>0&&(O.default.isAutomaticMode?(this._startTips(),this.clearStartTipsTime()):this.starttipstime=h.default.instance.setTimeout(function(){e._startTips(),e.clearStartTipsTime()},this,t))}},t.prototype.clearStartTipsTime=function(){this.starttipstime&&(h.default.instance.clearTimeout(this.starttipstime),this.starttipstime=0)},t.prototype.openTips=function(e){void 0===e&&(e=-1),this.ctr.openTipe=-1!=e?1==e:!this.ctr.openTipe,this.ctr.openTipe?this.setTipsShow(!0):(this.clearStartTipsTime(),this.clearAutoEffect(),this.setTipsShow(!1)),this.ctr.automatic||(this.ctr.openTipe?this._processIn||(this.canPrompt.active&&(this.canPrompt.stopAllActions(),this.canPrompt.active=!1),this.setStartTipsTime()):(this.tipsNode.node.stopAllActions(),this.tipsNode.node.active=!1,this.canPrompt.active&&(this.canPrompt.stopAllActions(),this.canPrompt.active=!1)))},t.prototype.setAutomatic=function(e){void 0===e&&(e=-1);var t=!1;if(t=-1!=e?1==e:!this.ctr.automatic,this.ctr.automatic=t,t)i.instance.startAutoEffect(),this.offTouchNode(),this._processIn||(this._lockAll(!0),this.setStartTipsTime());else{if(i.instance.stopAutoEffect(),this.canPrompt.active&&(this.canPrompt.stopAllActions(),this.canPrompt.active=!1),!this._processIn){this.onTouchNode(),this._lockAll(!1),this.tipsNode.node.stopAllActions(),this.tipsNode.node.active=!1;for(var n=0;n<this.symbolArr.length;n++)for(var o=0;o<this.symbolArr[n].length;o++)if(this.symbolArr[n][o]&&this.symbolArr[n][o].getComponent("SandTableSymbol").getIndex()<30){var a=(this.symbolArr.length-1)/2,r=(this.symbolArr[n].length-1)/2,s=this.Spoint.y+(a-n)*this._height,l=this.Spoint.x+(o-r)*this._width;this.symbolArr[n][o].stopAllActions(),this.symbolArr[n][o].setPosition(l,s)}}this.setStartTipsTime()}},t.prototype.onClickBack=function(){this.ctr.autoPlay=!1,this.close(!0),b.default.instance.activityStatusHandle(),this.ctr.clearData(),y.default.instance.clearAll()},t.prototype.inGame=function(){switch(this._INTheHigh=!0,this._sports=!1,s.ActivityStatus.value){case s.ActivityStatus.HighLadder:this.setTipsBtnActive(!1);break;case s.ActivityStatus.Arena:this._sports=!0,this.setTipsBtnActive(!1);break;case s.ActivityStatus.WorldBoss:case s.ActivityStatus.EliteBoss:case s.ActivityStatus.ExpCopy:case s.ActivityStatus.LoardCrusade:break;case s.ActivityStatus.ThemeShop:var e=Math.floor(5*Math.random());this.integraArr.push(e),this._INTheHigh=!1;break;default:this._INTheHigh=!1}if(this._INTheHigh){var t=this.ctr.getSandCome();if(t){this._totalMoveNum=t.step;var i=t.seed,o=t.scale,a=t.gradeMax,r=t.gradeMin;n.GameEventDispatcher.instance.emit("SANDTABLESTAR",{scale:o,seed:i,gradeMax:a,gradeMin:r})}else n.GameEventDispatcher.instance.on("SANDTABLECOMEBACK",this._dataComeBack,this)}else this._totalMoveNum=this.ctr.getTotaleMove(),this._totalMoveNum<=0&&(this._totalMoveNum=9),n.GameEventDispatcher.instance.emit("SANDTABLESTAR",{scale:null,seed:0})},t.prototype._dataComeBack=function(e){var t=e.getUserData();this._totalMoveNum=t.step;var i=t.seed,o=t.scale,a=t.gradeMax,r=t.gradeMin;n.GameEventDispatcher.instance.off("SANDTABLECOMEBACK",this._dataComeBack,this),n.GameEventDispatcher.instance.emit("SANDTABLESTAR",{scale:o,seed:i,gradeMin:r,gradeMax:a})},t.prototype.setXY=function(){for(var e=0;e<this.symbolArr.length;e++)for(var t=0;t<this.symbolArr[e].length;t++)if(this.symbolArr[e][t]&&this.symbolArr[e][t].getComponent("SandTableSymbol").getIndex()<30){var i=(this.symbolArr.length-1)/2,n=(this.symbolArr[e].length-1)/2,o=this.Spoint.y+(i-e)*this._height,a=this.Spoint.x+(t-n)*this._width;this.symbolArr[e][t].setPosition(a,o)}},t.prototype.gameStar=function(e){var t=this;e&&(n.GameEventDispatcher.instance.emit(a.EventDefiner.OPEN_UPDATE_TIME),L.default.instance.loadResByType(d.GlobalContext.Root+"prefab/sandTable/lattice",cc.Prefab,function(i){L.default.instance.loadResByType(d.GlobalContext.Root+"prefab/sandTable/symbol",cc.Prefab,function(o){var a=e;t.ctr.setNowArr(e),t.onCloneOldSandData(e),t.length=a.length,t.sonLength=a[0]&&a[0].length,t._arrWidth=t.sonLength,t.tipePool=new cc.NodePool,t.bg.node.setContentSize(cc.size(t.sandTableScale,t.sandTableScale)),t._height=t.sandTableScale/t.length,t._width=t.sandTableScale/t.sonLength,t.TouchNode.active=!0,t.indexArr=[],t._height<t._width?t._width=t._height:t._height=t._width,f.default.instance.isMerge=!1,t.synthesis=!1;for(var r=0;r<a.length;r++){t.symbolArr[r]=[],t.mapArr[r]=[],t.indexArr[r]=[];for(var s=0;s<a[r].length;s++){var l=(a.length-1)/2,c=(a[r].length-1)/2,p=t.Spoint.y+(l-r)*t._height,h=t.Spoint.x+(s-c)*t._width;if(t.indexArr[r][s]=a[r][s].type,100!=a[r][s].type){var u=U.default.getNodeByUrl(i,d.GlobalContext.Root+"prefab/sandTable/lattice");t.TouchNode.addChild(u),u.setPosition(h,p),u.getComponent("SandTableBg").setMapSize(t._height,t._width),t.mapArr[r][s]=u;var g=U.default.getNodeByUrl(o,d.GlobalContext.Root+"prefab/sandTable/symbol");t.TouchNode.addChild(g,1),g.setPosition(h,p),g.getComponent("SandTableSymbol").init(),g.getComponent("SandTableSymbol").initSymbol(),g.getComponent("SandTableSymbol").setSymbolSize(t._height,t._width),t.symbolArr[r][s]=g,u.getComponent("SandTableBg").setBgColor(a[r][s].type),g.getComponent("SandTableSymbol").setSpoint(r*t._arrWidth+s),g.getComponent("SandTableSymbol").setIndex(a[r][s].type),a[r][s].grade&&!t._sports&&g.getComponent("SandTableSymbol").setGrade(a[r][s].grade),a[r][s].type<100&&a[r][s].type>30?(g.getComponent("SandTableSymbol").setGrade(a[r][s].removalFr),g.getComponent("SandTableSymbol").setTrap(a[r][s])):101==a[r][s].type&&(g.getComponent("SandTableSymbol").setGrade(a[r][s].removalFr),g.getComponent("SandTableSymbol").setTrap(a[r][s]),a[r][s].info&&g.getComponent("SandTableSymbol").setMonsterInfo(a[r][s].info),t.stoneArr.push(g))}else 100==a[r][s].type&&(t.mapArr[r][s]=null,t.symbolArr[r][s]=!1)}}for(var r in t._moveNum=t._totalMoveNum,t.setLabel(!1),t.symbolArr)for(s=0;s<t.symbolArr.length;s++)t.indexArr[r][s]=t.symbolArr[r][s]?t.symbolArr[r][s].getComponent("SandTableSymbol").getIndex():null;t.TouchNode.opacity=0,t.TouchNode.runAction(cc.sequence(cc.delayTime(.2),cc.fadeTo(1,255),cc.callFunc(function(){t.onTouchNode(),t.initUIData()},t))),n.GameEventDispatcher.instance.on("TOUCHMOVE",t._starMore,t),I.default.instance.isGuide||t.checkGuide(),W.default.instance.checkOpenFunctionTip(),t.ctr.autoPlay||t.ctr.automatic?(t.setAutomatic(1),t._processIn=!0):t.ctr.openTipe&&t.setStartTipsTime(),t.initAutoStateX(t.TouchNode.x+t.TouchNode.width+100)},t)},this))},t.prototype.onTouchNode=function(){this.TouchNode.on(cc.Node.EventType.TOUCH_MOVE,this.OnSceneTouchMove,this),this.TouchNode.on(cc.Node.EventType.TOUCH_START,this.OnSceneTouchStart,this),this.TouchNode.on(cc.Node.EventType.TOUCH_END,this.OnSceenTouchEnd,this),this.TouchNode.on(cc.Node.EventType.TOUCH_CANCEL,this.OnSceneTouchCancel,this)},t.prototype.offTouchNode=function(){this.TouchNode&&(this.TouchNode.off(cc.Node.EventType.TOUCH_MOVE,this.OnSceneTouchMove,this),this.TouchNode.off(cc.Node.EventType.TOUCH_START,this.OnSceneTouchStart,this),this.TouchNode.off(cc.Node.EventType.TOUCH_END,this.OnSceenTouchEnd,this),this.TouchNode.off(cc.Node.EventType.TOUCH_CANCEL,this.OnSceneTouchCancel,this))},t.prototype.OnSceneTouchMove=function(e){if(this._nowSymbol&&this.isMove){var t=this.TouchNode.convertToNodeSpaceAR(e.getLocation()),i=!1;if(I.default.instance.isSandTableGuide()||I.default.instance.isSandTableDropGuide()){var n=I.default.instance.bgmask.convertToWorldSpaceAR(new cc.Vec2(0,0));n=this.TouchNode.convertToNodeSpaceAR(n),t.x<n.x-I.default.instance.bgmask.width/2?(t.x=n.x-I.default.instance.bgmask.width/2,i=!0):t.x>n.x+I.default.instance.bgmask.width/2&&(t.x=n.x+I.default.instance.bgmask.width/2,i=!0),t.y<n.y-I.default.instance.bgmask.height/2?(t.y=n.y-I.default.instance.bgmask.height/2,i=!0):t.y>n.y+I.default.instance.bgmask.height/2&&(t.y=n.y+I.default.instance.bgmask.height/2,i=!0)}this._nowSymbol.setPosition(t),i&&this.touchEnd(t)}},t.prototype.OnSceneTouchStart=function(e){},t.prototype.setLabel=function(e){var t=this;void 0===e&&(e=!0);var i=this.labelNode.getChildByName("stepLabel");0==u.default.instance.currentChapterId&&e?i.runAction(cc.sequence(cc.scaleTo(.3,4),cc.callFunc(function(){i.getComponent(cc.Label).string=t._moveNum+""}),cc.scaleTo(.2,1))):i.getComponent(cc.Label).string=this._moveNum+"",this.btnBack.active=s.ActivityStatus.value==s.ActivityStatus.Expedition&&this._moveNum>0},t.prototype.checkPoint=function(e,t,i){return t.x==e.x&&t.y==e.y&&i.x==e.x1&&i.y==e.y1||t.x==e.x1&&t.y==e.y1&&i.x==e.x&&i.y==e.y},t.prototype.touchEnd=function(e){var t=this.TouchNode.convertToNodeSpaceAR(e),i=0,o=0;for(var a in this.symbolArr){for(var r=0;r<this.symbolArr[a].length;r++)if(this.symbolArr[a][r]&&this._nowSymbol.getComponent("SandTableSymbol").getSpoint()!=this.symbolArr[a][r].getComponent("SandTableSymbol").getSpoint()&&(i=this.symbolArr[a][r].getComponent("SandTableSymbol").getNndSpoint(t))){o=this.symbolArr[a][r].getComponent("SandTableSymbol").getSpoint();break}if(i)break}var s=this._nowSymbol.getComponent("SandTableSymbol").getSpoint(),l=[];for(var a in this.symbolArr)for(var r in l[a]=[],this.symbolArr[a]){var c=this.symbolArr[a][r]?this.symbolArr[a][r].getComponent("SandTableSymbol").getIndex():100;l[a].push(c)}var d=(this.symbolArr.length-1)/2,p=(this.symbolArr[0].length-1)/2,y=Math.floor(s/this._arrWidth),C=s%this._arrWidth,v=this.Spoint.y+(d-y)*this._height,_=this.Spoint.x+(C-p)*this._width,b=new cc.Vec2(Math.floor(s/this._arrWidth),s%this._arrWidth),T=new cc.Vec2(Math.floor(o/this._arrWidth),o%this._arrWidth);if(this.tipoperation)if(void 0!==this.tipoperation.x1){if(!this.checkPoint(this.tipoperation,b,T))return this.symbolArr[y][C].setPosition(cc.v2(_,v)),this._lockAll(!1),void(this._nowSymbol=null)}else if(1==i)return this.symbolArr[y][C].setPosition(cc.v2(_,v)),this._lockAll(!1),void(this._nowSymbol=null);if(1==i){var S=this.symbolArr[T.x][T.y];S.getComponent("SandTableSymbol").getSpoint();this._nowSymbol.zIndex=1,this.tipsNode.node.stopAllActions(),this.tipsNode.node.active=!1;var w=S.getComponent("SandTableSymbol").getIndex();if(g.default.instance.OfferTypeTrap.indexOf(w)>-1||g.default.instance.OfferTypeTrapTree.indexOf(w)>-1){var D=this._nowSymbol.getComponent("SandTableSymbol").getIndex();if(D/3<2||w==m.SandTableTrapType.JITAN&&D/3>3)return P.default.instance.ShowMsg(M.default.getStr("\u8bf7\u62d6\u84dd\u8272\u5361\u724c\u8fdb\u5165\u673a\u5173")),this._lockAll(!1),void this.symbolArr[y][C].setPosition(cc.v2(_,v));this._removeLize(this.symbolArr[y][C]),this.symbolArr[y][C]=null}else{if(w>17)return this._lockAll(!1),this.symbolArr[y][C].setPosition(cc.v2(_,v)),void(this._nowSymbol=null);0==u.default.instance.currentChapterId&&0==u.default.instance.currentGuanqiaId?(this._exchange(S,this._nowSymbol),I.default.instance.isSandTableGuide()&&I.default.instance.otherCheckNextStep(1)):this._exchange(S,this._nowSymbol)}var R=Math.floor(o/this._arrWidth),A=o%this._arrWidth,N=this.symbolArr[R][A].getComponent("SandTableSymbol").getIndex();-1==this.ctr.ConsumeOffice.indexOf(N)&&(this._moveNum-=1,this.setLabel());var L=h.default.instance.setTimeout(function(){n.GameEventDispatcher.instance.emit("GAMEMOTION",{active:{x:y,y:C},passive:{x:R,y:A},symbol:l}),h.default.instance.clearTimeout(L)},this,50);this._processIn=!0}else if(I.default.instance.isSandTableGuide()||2==i||Math.abs(this.symbolArr[y][C].x-_)<this._width/2&&Math.abs(this.symbolArr[y][C].y-v)<this._height/2)this._lockAll(!1),this.symbolArr[y][C].setPosition(cc.v2(_,v));else{if(I.default.instance.isSandTableDropGuide()&&I.default.instance.otherCheckNextStep(2),!this.isStopoutside)return void this.symbolArr[y][C].setPosition(cc.v2(_,v));f.default.instance.getgradeindexnum(1),this._moveNum-=1,this.setLabel(),this.symbolArr[y][C].active=!1,this.tipsNode.node.stopAllActions(),this.tipsNode.node.active=!1,g.default.instance.gameSingle({x:y,y:C},l),this._processIn=!0}this._nowSymbol=null},t.prototype.OnSceenTouchEnd=function(e){this.clearAutoEffect(),this.isMove=!1,this._nowSymbol&&this.touchEnd(e.getLocation())},t.prototype.OnSceneTouchCancel=function(e){if(this.clearAutoEffect(),this._nowSymbol){var t=this._nowSymbol.getComponent("SandTableSymbol").getSpoint(),i=(this.symbolArr.length-1)/2,n=(this.symbolArr[0].length-1)/2,o=this.Spoint.y+(i-Math.floor(t/this._arrWidth))*this._height,a=this.Spoint.x+(t%this._arrWidth-n)*this._width;this._lockAll(!1),this.symbolArr[Math.floor(t/this._arrWidth)][t%this._arrWidth].setPosition(cc.v2(a,o))}},t.prototype._exchange=function(e,t){var i=(this.length-1)/2,n=(this.sonLength-1)/2,o=e.getComponent("SandTableSymbol").getSpoint(),a=t.getComponent("SandTableSymbol").getSpoint();e.getComponent("SandTableSymbol").setSpoint(a),this.symbolArr[Math.floor(a/this._arrWidth)][a%this._arrWidth]=e;var r=this.Spoint.y+(i-Math.floor(a/this._arrWidth))*this._height,s=this.Spoint.x+(a%this._arrWidth-n)*this._width;e.setPosition(cc.v2(s,r)),t.getComponent("SandTableSymbol").setSpoint(o),this.symbolArr[Math.floor(o/this._arrWidth)][o%this._arrWidth]=t;var l=this.Spoint.y+(i-Math.floor(o/this._arrWidth))*this._height,c=this.Spoint.x+(o%this._arrWidth-n)*this._width;t.setPosition(cc.v2(c,l))},t.prototype._starMore=function(e){this.isMove=!0;var t=e.getUserData().spoint;this._nowSymbol=this.symbolArr[Math.floor(t/this._arrWidth)][t%this._arrWidth];for(var i=0;i<this.symbolArr.length;i++)for(var n=0;n<this.symbolArr[i].length;n++)this.symbolArr[i][n]&&(this.symbolArr[i][n].zIndex=1);this._nowSymbol.zIndex=999,this.canPrompt.active&&(this.canPrompt.stopAllActions(),this.canPrompt.active=!1),this._lockAll(!0)},t.prototype._moveEnd=function(e,t,i){var n=this._data[this._cycleIndex].result.monsterArr[0];W.default.instance.dragCount++,this._youGo(this.symbolArr[e][t].x,this.symbolArr[e][t].y,n,!0),this._removeLize(this.symbolArr[e][t]),this.symbolArr[e][t]=null,this._twinkleOver(i)},t.prototype.altarMove=function(e,t,i){var n=this,o=t.info,a=this.symbolArr[e[1].x][e[1].y];a.getComponent("SandTableSymbol").setAltar(t.removalFr,function(){var r={type:o.type,grade:o.grade,lv:o.lv};n._youGo(a.x,a.y,r,!1);var s=h.default.instance.setTimeout(function(){t.removalFr<=0&&(n.symbolArr[e[1].x][e[1].y].destroy(),n.symbolArr[e[1].x][e[1].y]=null),n._twinkleOver(i),h.default.instance.clearTimeout(s)},n,1100)},this)},t.prototype.deleteChuanSongNum=function(e,t,i){var n=this,o=h.default.instance.setTimeout(function(){t.removalFr<=0&&(n.symbolArr[e[1].x][e[1].y].destroy(),n.symbolArr[e[1].x][e[1].y]=null),n._twinkleOver(i),h.default.instance.clearTimeout(o)},this,100)},t.prototype.deleteChuanSongNum1=function(e){var t=this;this.time2||(this.time2=h.default.instance.setTimeout(function(){t._resultLoop(!0),h.default.instance.clearTimeout(t.time2),t.time2=null},this,2e3))},t.prototype.gameResult=function(e){var t=e;this._data=t,this._cycleIndex=0,this.inSecondCycle=!1,this.canplayelimination=!0,t.length&&(this.dropNum=0,this.orldropNum=-1,this.drakeIndex=0,this.secondCycle=0,this.istrap=!1,this.combo=0,this.clearAutoEffect(),this.clearStartTipsTime(),this.tipsNode.node.stopAllActions(),this.tipsNode.node.active=!1,this._resultLoop()),I.default.instance.isGuide&&I.default.instance.stopCondition(21)},t.prototype.playelimination=function(){this.canplayelimination&&(this._cycleIndex>4?(G.default.instance.PlayEffect(G.SoundType.good),this.incredible.getComponent(cc.Animation).play(),this.incredible.active=!0):this._cycleIndex>2&&(G.default.instance.PlayEffect(G.SoundType.good),this.great.getComponent(cc.Animation).play(),this.good.getComponent(cc.Animation).play(),this.good.active=!0),this.canplayelimination=!1)},t.prototype.eliminationCom=function(){this.incredible.active=!1,this.great.active=!1,this.good.active=!1},t.prototype.playcombo=function(){var e=this;this.combo>0&&(this.comboBox.active=!0,this.comboBox.stopAllActions(),this.comboBox.getChildByName("New Node").getChildByName("combolabel").getComponent(cc.Label).string=this.combo+1+"",this.comboBox.scale=0,this.comboBox.runAction(cc.sequence(cc.scaleTo(.2,1),cc.delayTime(1),cc.callFunc(function(){e.stopcombo(),e.combo=0},this))))},t.prototype.stopcombo=function(){this.comboBox.stopAllActions(),this.comboBox.scale=1,this.comboBox.active=!1},t.prototype._resultLoop=function(e){var t=this;void 0===e&&(e=!1);var i=null,n=null,o=null;if(this._data.length>this._cycleIndex)n=(i=this._data[this._cycleIndex].result).upSymbol,o=i.resultArr,this._cycleIndex>0&&(this.combo=this._data[0].result.upSymbol?this._cycleIndex:this._cycleIndex-1,this.playcombo());else{if(this.istrap=!0,!(this._data[this._data.length-1].trapInfoArr&&this._data[this._data.length-1].trapInfoArr.length&&this._data[this._data.length-1].secondArr[this.dropNum]&&this._data[this._data.length-1].secondArr[this.dropNum][this.secondCycle]))return void this._flowEnd();var a=this._data[this._data.length-1].secondArr[this.dropNum];o=(i=a[this.secondCycle].result).resultArr,n=i.upSymbol}for(var r in this.symbolArr)for(var l in this.symbolArr[r])this.symbolArr[r][l]&&this.symbolArr[r][l].getComponent("SandTableSymbol").getBanGame()>0&&o[r][l]&&this.symbolArr[r][l].getComponent("SandTableSymbol").setBanGame(o[r][l].banOneGame),this.symbolArr[r][l]&&this.symbolArr[r][l].getComponent("SandTableSymbol").getCuiMian()>0&&o[r][l]&&this.symbolArr[r][l].getComponent("SandTableSymbol").setCuiMian(o[r][l].cuimian);var c=[];for(r=0;r<this.symbolArr.length;r++)for(l=0;l<this.symbolArr[r].length;l++)if(this.symbolArr[r][l]){var d=this.symbolArr[r][l].getComponent("SandTableSymbol").getIndex();this.mapArr[r][l].getComponent("SandTableBg").setBgColor(d)}if(n.length>0)for(var p in G.default.instance.PlayEffect(G.SoundType.checkerboardCompound),n)this.symbolArr[n[p][0]][n[p][1]]&&(c.push(this.symbolArr[n[p][0]][n[p][1]]),this._playUpAni(this.symbolArr[n[p][0]][n[p][1]],n[p][2],n[p][0],n[p][1],p,n[p][3],i));if(this._twinkleNum=0,this._twinkleSign=0,this.trapcom=!1,1==i.storageArr.length&&1==i.storageArr[0].length){var u=i.storageArr[0][0].type;if(u>=50)u!=m.SandTableTrapType.TANGHUANG&&-1==g.default.instance.OfferTypeTrapInfo.indexOf(u)||e?this._twinkleOver(i):this._flowEnd();else if(i.addTrapArr.length&&-1!=g.default.instance.OfferTypeTrap.indexOf(i.addTrapArr[0].type)){var f=function(){i.addTrapArr[0].removalFr||(t.symbolArr[i.addTrapArr[0].x][i.addTrapArr[0].y].destroy(),t.symbolArr[i.addTrapArr[0].x][i.addTrapArr[0].y]=null),t._twinkleOver(i,!0)};if(i.addTrapArr[0].type==m.SandTableTrapType.HEIDONG){var C=this.mapArr[i.addTrapArr[0].x][i.addTrapArr[0].y].getPosition();this._playShrink(C,f,this),console.log("\u9ed1\u6d1e\u9677\u9631\u6548\u679c\u89e6\u53d1\u5b8c\u6210 \uff1a ")}else i.addTrapArr[0].type==m.SandTableTrapType.JITAN?(console.log("\u89e6\u53d1\u4e8b\u4ef6 51 \u8fd9\u4e2a\u662f\u5728\u5f00\u59cb\u8fdb\u884c\u89e6\u53d1\u7684 \u6240\u4ee5\u9700\u8981\u5728\u8fd9\u91cc\u8fdb\u884c\u6d88\u9664\u53ec\u5524"),this.altarMove(i.operationArr,i.addTrapArr[0],i)):i.addTrapArr[0].type==m.SandTableTrapType.WODI?(console.log("\u89e6\u53d1\u4e8b\u4ef6 \u5367\u5e95"),this.symbolArr[i.addTrapArr[0].x][i.addTrapArr[0].y].getComponent(v.default).setWoDi(function(){y.default.instance.sandTableTrap(i.addTrapArr[0].type,f,t)},this)):i.addTrapArr[0].type==m.SandTableTrapType.YAOJI?(console.log("\u89e6\u53d1\u4e8b\u4ef6 \u836f\u5242"),this.symbolArr[i.addTrapArr[0].x][i.addTrapArr[0].y].getComponent(v.default).setYaoJi(function(){var e=i.addTrapArr[0].info,n={type:e.type,grade:e.grade,lv:e.lv},o=(e=_.ConfigsManager.instance.getConfigs("sandtableconf").sandTableConf[m.SandTableTrapType.YAOJI-50]).params[U.default.RandomBy(0,e.params.length-1)],a=i.addTrapArr[0].x,r=i.addTrapArr[0].y,s=t.symbolArr[a][r];t._youGo(s.x,s.y,n,!1,o);h.default.instance.setTimeout(function(){f()},t,1100)},this)):-1!=g.default.instance.OfferTypeTrapInfo.indexOf(i.addTrapArr[0].type)?(console.log("\u6d88\u8017\u602a\u7269\u89e6\u53d1\u9677\u9631\u3002\u9677\u9631\u89e6\u53d1\u989d\u5916\u4e09\u6d88\u4e8b\u4ef6\u8fd4\u56de"),this._twinkleOver(i,!0)):y.default.instance.sandTableTrap(i.addTrapArr[0].type,f,this)}else this._moveEnd(i.storageArr[0][0].x,i.storageArr[0][0].y,i),s.ActivityStatus.value!=s.ActivityStatus.Guide&&(this.integraArr.indexOf(2)>-1&&Math.random()<.3&&(this._moveNum+=1,this.setLabel()),s.ActivityStatus.value!=s.ActivityStatus.HighLadder&&s.ActivityStatus.value!=s.ActivityStatus.Arena&&s.ActivityStatus.value!=s.ActivityStatus.Guide&&Math.floor(i.storageArr[0][0].type/3)>2&&-1==g.default.instance.symbolGuideBaoXiangArr.indexOf(i.storageArr[0][0].type)&&(this._moveNum+=1,this.stepback.active=!0,this.stepback.runAction(cc.sequence(cc.moveBy(.5,0,100),cc.delayTime(.7),cc.callFunc(function(){t.stepback.stopAllActions(),t.stepback.active=!1},this))),this.setLabel()))}else if(0==i.storageArr.length&&i.addTrapArr.length&&51==i.addTrapArr[0].type)console.log("\u89e6\u53d1\u4e8b\u4ef6 51 \u8fd9\u4e2a\u662f\u5728\u5f00\u59cb\u8fdb\u884c\u89e6\u53d1\u7684 \u6240\u4ee5\u9700\u8981\u5728\u8fd9\u91cc\u8fdb\u884c\u6d88\u9664\u53ec\u5524"),this.altarMove(i.operationArr,i.addTrapArr[0],i);else if(0==i.storageArr.length&&i.addTrapArr.length&&g.default.instance.OfferTypeTrapTree.indexOf(i.addTrapArr[0].type)>-1)console.log("\u89e6\u53d1\u6d88\u9664 \u4f20\u9001\u6216\u8005\u5f39\u7c27\u6b21\u6570"),this.deleteChuanSongNum(i.operationArr,i.addTrapArr[0],i);else if(this._data.length<=this._cycleIndex&&!i.storageArr.length)console.log("\u68c0\u6d4b\u9677\u9631\u989d\u5916\u4e8b\u4ef6"),e?this._twinkleOver(i):this._flowEnd();else{for(var r in i.storageArr){this.integraArr.indexOf(0)>-1&&i.storageArr[r].length>=5?Math.random()<.3&&(this._moveNum+=1,this.setLabel()):this.integraArr.indexOf(4)>-1&&i.storageArr[r].length>=6?(this._moveNum+=1,this.setLabel()):this.integraArr.indexOf(3)>-1&&!this._cycleIndex&&(i.storageArr[r].length>=4?this.integraSArr.push(1):this.integraSArr=[],3==this.integraSArr.length&&(this.integraSArr=[],this.integraArr=[],this._moveNum+=1,this.setLabel()));var b=new cc.Vec2(0,0);for(var l in i.storageArr[r]){var T=i.storageArr[r][l].x,S=i.storageArr[r][l].y;if(i.upSymbol[r]&&i.upSymbol[r][0]==T&&i.upSymbol[r][1]==S){b.x=this.symbolArr[T][S].x,b.y=this.symbolArr[T][S].y;break}}for(var l in i.storageArr[r]){T=i.storageArr[r][l].x,S=i.storageArr[r][l].y;var I=this.mapArr[T][S].getComponent("SandTableBg");this.playUpEffect(this.mapArr[T][S].position,1,!1,I.bg.node.getContentSize()),-1==c.indexOf(this.symbolArr[T][S])&&(this._twinkleNum++,this._playOutAni(this.symbolArr[T][S],parseInt(T),parseInt(S),i,b))}}this._twinkleNum||(this._cycleIndex=this._data.length>this._cycleIndex?this._cycleIndex+1:this._cycleIndex,this._resultLoop())}this._cycleIndex=this._data.length>this._cycleIndex?this._cycleIndex+1:this._cycleIndex},t.prototype.playUpEffect=function(e,t,i,n){var o=this.actionNode;1==t&&(o=this.TouchNode);var a=A.SpinePools.addSpineNoder(o,e),r=a.getComponent(N.default);r.initSpineData(m.SPINE_RES_DIR+"sandtable/compound/effect","default","effect"+t,i),r.playRate=(this.ctr.automatic?2:1)*p.default.instance.fightViewPlayRate,1==t&&(a.scale=n.width/136),i?(r.playRate=.1*(this.ctr.automatic?2:1)*p.default.instance.fightViewPlayRate,this.autoNodeList.push(a)):(r.completeCallbackThisObj=this,r.completeCallbackParam=[a],r.completeCallback=function(e){A.SpinePools.recoverSpineNoder(e)})},t.prototype.clearAutoEffect=function(){if(this.autoNodeList){for(;this.autoNodeList.length>0;){var e=this.autoNodeList.shift();A.SpinePools.recoverSpineNoder(e)}this.autoNodeList=[]}},t.prototype._playShrink=function(e,t,i){var n=this;L.default.instance.loadResByType(d.GlobalContext.Root+"prefab/sandTable/symbol",cc.Prefab,function(o){var a=null;a=U.default.getNodeByUrl(o,d.GlobalContext.Root+"prefab/sandTable/symbol"),n.actionNode.addChild(a,1),a.setPosition(e),a.runAction(cc.sequence(cc.scaleTo(1,0),cc.callFunc(function(){t&&t.apply(i)},n)))},this)},t.prototype._playUpAni=function(e,t,i,n,o,a,r){var s=this,l=e.scale,c=cc.scaleTo(.1,l+.5);c.easing(cc.easeIn(3));var d=.5/p.default.instance.fightViewPlayRate;e.runAction(cc.sequence(cc.delayTime(d),cc.callFunc(function(){s.playUpEffect(e.position,2,!1)}),c,cc.scaleTo(.05,l),cc.callFunc(function(){s._playUp(e,t,i,n,o,a,r)})))},t.prototype._playUp=function(e,t,i,n,o,a,r){e.getComponent("SandTableSymbol").getIndex(),e.active=!0,e.runAction(cc.show()),e.opacity=255,e.getComponent("SandTableSymbol").setIndex(t),this.mapArr[i][n].getComponent("SandTableBg").setBgColor(t);var s,l;s=r.resultArr,l=r.monsterArr[o],this._sports||this.symbolArr[i][n].getComponent("SandTableSymbol").setGrade(s[i][n].grade),W.default.instance.gradeCompoundCount[Math.floor(t/3)+1]++,this._youGo(e.x,e.y,l,!0,null,!0)},t.prototype._playOutAni=function(e,t,i,n,o){var a=this,r=.3*(this.ctr.automatic?.5:1)/p.default.instance.fightViewPlayRate,s=cc.moveTo(r,o);s.easing(cc.easeIn(3)),e.runAction(cc.sequence(cc.delayTime(r),s,cc.callFunc(function(){a._removeSymbol(e,t,i,n)},this)))},t.prototype._removeSymbol=function(e,t,i,n){var o=this;if(e.stopAllActions(),this._removeLize(this.symbolArr[t][i]),this.symbolArr[t][i]=null,this._twinkleSign++,this._twinkleNum==this._twinkleSign){var a=this;this.twinkleTime=h.default.instance.setTimeout(function(){a._twinkleOver(n),h.default.instance.clearTimeout(o.twinkleTime),o.twinkleTime=0},this,300)}},t.prototype._twinkleOver=function(e,t){var i=this;void 0===t&&(t=!1),t&&this.secondCycle++,this.twinkleTime&&(h.default.instance.clearTimeout(this.twinkleTime),this.twinkleTime=0);var n;n=e.resultArr;for(var o=0;o<n.length;o++)for(var a=n[o],r=0;r<a.length;r++)if(this.symbolArr[o][r]){var s=this.symbolArr[o][r].getComponent("SandTableSymbol").getIndex();s<101&&s>50&&n[o][r].type!=s&&(this.symbolArr[o][r]&&(this.symbolArr[o][r].getComponent("SandTableSymbol").clearhammerHit(),this.symbolArr[o][r].destroy()),this.symbolArr[o][r]=null)}var l=!1;this._motionAllNum=0,this._motionNum=0;for(o=0;o<this.stoneArr.length;o++){var c=this.stoneArr[o].getComponent("SandTableSymbol").getSpoint(),p=this.stoneArr[o].getComponent("SandTableSymbol").getGrade(),u=this.stoneArr[o].getComponent("SandTableSymbol").getTrap();if(1==p&&n[Math.floor(c/this._arrWidth)][c%this._arrWidth].type<100){if(this.integraArr.indexOf(1)>-1){var f=Math.floor(2*Math.random())+3;this._moveNum+=f,this.setLabel()}if(u){var g=u+50;this.stoneArr[o].getComponent("SandTableSymbol").setIndex(g),this.stoneArr.splice(o,1),o--}else this.TouchNode.removeChild(this.stoneArr[o]),this.stoneArr.splice(o,1),this.symbolArr[Math.floor(c/this._arrWidth)][c%this._arrWidth].destroy(),this.symbolArr[Math.floor(c/this._arrWidth)][c%this._arrWidth]=null,o-=1}}for(o=this.symbolArr.length-1;o>=0;o--)for(var y=0;y<this.symbolArr.length;y++)if(!(null==this.symbolArr[o][y]||0==this.symbolArr[o][y]||this.symbolArr[o][y].getComponent("SandTableSymbol").getIndex()>50||this.symbolArr[o][y].getComponent("SandTableSymbol").getCuiMian()>0||this.symbolArr[o][y].getComponent("SandTableSymbol").getBanGame()>0)){for(var m=0,C=this.symbolArr[o].length-1;C>o;C--)(null==this.symbolArr[C][y]||m>0&&0==this.symbolArr[C][y]||m>0&&this.symbolArr[C][y]&&(this.symbolArr[C][y].getComponent("SandTableSymbol").getIndex()>50||this.symbolArr[C][y].getComponent("SandTableSymbol").getCuiMian()>0||this.symbolArr[C][y].getComponent("SandTableSymbol").getBanGame()>0))&&m++;if(this.symbolArr[o][y].getComponent("SandTableSymbol").setDownNum(m),0!=m){var v=this.symbolArr[o][y].x,_=this.symbolArr[o][y].y,b=this.symbolArr[o][y];this._motionAllNum++,l=!0,this._moveStar(b,v,_,m),this._arrayExchange({x:o,y:y},{x:o+m,y:y})}}L.default.instance.loadResByType(d.GlobalContext.Root+"prefab/sandTable/symbol",cc.Prefab,function(e){for(var t=0;t<i.symbolArr.length;t++)for(var o=0;o<i.symbolArr[t].length;o++)if(null==i.symbolArr[t][o]){var a=null;a=U.default.getNodeByUrl(e,d.GlobalContext.Root+"prefab/sandTable/symbol"),i.TouchNode.addChild(a,1);var r=(i.symbolArr.length-1)/2,s=(i.symbolArr[t].length-1)/2,c=i.Spoint.y+(r-t)*i._height+3*i._height,p=i.Spoint.x+(o-s)*i._width;a.setPosition(p,c),a.getComponent("SandTableSymbol").init(),a.getComponent("SandTableSymbol").initSymbol(),a.getComponent("SandTableSymbol").setSymbolSize(i._height,i._width),a.getComponent("SandTableSymbol").setSpoint(t*i._arrWidth+o),a.getComponent("SandTableSymbol").setIndex(n[t][o].type),a.getComponent("SandTableSymbol").setLook(!0),a.active=!0,a.runAction(cc.show()),a.opacity=255,i.symbolArr[t][o]=a,i._motionAllNum++,l=!0,i._moveStar(a,p,c,3)}else i.symbolArr[t][o]&&(i.symbolArr[t][o].getComponent("SandTableSymbol").setSpoint(t*i._arrWidth+o),i.symbolArr[t][o].zIndex=1);for(t=0;t<i.symbolArr.length;t++){var u=[];for(o=0;o<i.symbolArr[t].length;o++)if(i.symbolArr[t][o]){var f=i.symbolArr[t][o].getComponent("SandTableSymbol").getIndex();u.push(f),i.mapArr[t][o].getComponent("SandTableBg").setBgColor(f),f<30?i._sports||i.symbolArr[t][o].getComponent("SandTableSymbol").setGrade(n[t][o].grade):i.symbolArr[t][o].getComponent("SandTableSymbol").setGrade(n[t][o].removalFr)}}if(!l){i.istrap&&i.secondCycle++;var g=h.default.instance.setTimeout(function(){i._moveSymbolEnd(),h.default.instance.clearTimeout(g)},i,600)}},this)},t.prototype._flowEnd=function(){this._infoInTurn(this._data),this._data[this._data.length-1].trapInfoArr&&this._data[this._data.length-1].trapInfoArr.length?this.dropDeal():this.dropEnd()},t.prototype.dropDeal=function(e){void 0===e&&(e=!1),console.log("\u68c0\u6d4b\u9677\u9631\u4e8b\u4ef6\u7d22\u5f15dropNum"+this.dropNum,this.secondCycle);var t=this._data[this._data.length-1].trapInfoArr;if(!t||!t[this.dropNum])return console.log("\u9677\u9631\u4e8b\u4ef6\u5904\u7406\u5b8c\u6210"),this._flowEnd();if(this.orldropNum==this.dropNum){var i=this._data[this._data.length-1].secondArr[this.dropNum];if(i&&i.length>this.secondCycle)return console.log("this.dropNum"+this.dropNum+"\u8fdb\u5165\u4e0b\u4e00\u4e2a\u6c99\u76d8\u9677\u9631\u989d\u5916\u4e8b\u4ef6\u5904\u7406"+this.secondCycle),this._resultLoop(e),this.secondCycle++,void console.log("--------------this.secondCycle--------------"+this.secondCycle);this._data[this._data.length-1];return this.dropNum++,this.secondCycle=0,console.log("\u4e0a\u4e00\u4e2a\u9677\u9631\u4e8b\u4ef6\u5904\u7406\u5b8c\u6210this.dropNum",this.dropNum,this.secondCycle),this.dropEnd()}if(t[this.dropNum].length){this.orldropNum=this.dropNum;var n=t[this.dropNum],o=n[0];this.trapStart(o,n)}else this.dropDeal()},t.prototype.checkTrapCom=function(e,t,i,n,o){var a=this;if(void 0===i&&(i=500),void 0===n&&(n=0),0==e)var r=h.default.instance.setTimeout(function(){for(var e in t){var i=t[e];i.center.removalFr||(a.symbolArr[i.center.x][i.center.y]&&a.symbolArr[i.center.x][i.center.y].destroy(),a.symbolArr[i.center.x][i.center.y]=null,a.inSecondCycle=!0)}var s=a._data[a._data.length-1];if(g.default.instance.OfferTypeTrap.indexOf(o)>-1&&s.secondArr.length>0&&s.secondArr[a.dropNum].length>=1){var l=s.secondArr[a.dropNum][a.secondCycle].result;a._twinkleOver(l,!0)}else a.secondCycle+=n,a.dropDeal(!0);a.checkClose(),h.default.instance.clearTimeout(r)},this,i)},t.prototype.trapStart=function(e,t){var i=this;if(this.trapcom=!1,t.length<=0)this.checkTrapCom(0,t,100,1,e.index);else if(this.setXY(),e.index!=m.SandTableTrapType.TIECHUI)if(e.index!=m.SandTableTrapType.SHENGJI)if(e.index!=m.SandTableTrapType.HUOPAO)if(e.index!=m.SandTableTrapType.QIYUAN)if(e.index!=m.SandTableTrapType.PINGDENG)if(e.index!=m.SandTableTrapType.CUIMIAN)if(e.index!=m.SandTableTrapType.JIANGJI)if(e.index!=m.SandTableTrapType.CHUANSONG)if(e.index!=m.SandTableTrapType.TANGHUANG)if(e.index!=m.SandTableTrapType.MEIDUSHA)if(e.index!=m.SandTableTrapType.WUSHU);else{var n=0;for(var o in t){(E=t[o]).center;n++,this.symbolArr[E.center.x][E.center.y].getComponent("SandTableSymbol").setGrade(E.center.removalFr);var a=this.mapArr[E.center.x][E.center.y],r=a.getComponent("SandTableBg");this.playUpEffect(a.position,2,!1,r.bg.node.getContentSize()),y.default.instance.sandTableTrap(m.SandTableTrapType.WUSHU,function(){n--,i.checkTrapCom(n,t,500,1,e.index)},this)}}else{var s=0;for(var o in t){var l=(E=t[o]).arr;for(var c in this.symbolArr[E.center.x][E.center.y].getComponent("SandTableSymbol").setGrade(E.center.removalFr),l){var d=this.symbolArr[l[c].x][l[c].y];s++,this.symbolArr[E.center.x][E.center.y].getComponent("SandTableSymbol").shooting(d,m.SymbolShotType.Minus,function(n,o){n.getComponent("SandTableSymbol").wereShot(m.SymbolShotType.Minus,function(n){n.getComponent("SandTableSymbol").setBanGame(2),s--,i.checkTrapCom(s,t,1e3,1,e.index)},i,[n])},this,[d])}}}else{var p=function(n){var o=t[n];if(null==o.launch){u.symbolArr[o.center.x][o.center.y].getComponent("SandTableSymbol").tanghuang(o.center.removalFr,function(){});var a=h.default.instance.setTimeout(function(){h.default.instance.clearTimeout(a);var n=i._data[i._data.length-1].secondArr[i.dropNum];o.center.removalFr?i._twinkleOver(n[i.secondCycle].result,!0):i.checkTrapCom(0,t,1e3,0,e.index)},u,350);return{value:void 0}}u.symbolArr[o.center.x][o.center.y].getComponent("SandTableSymbol").tanghuang(o.center.removalFr,function(){},u);h.default.instance.setTimeout(function(){var n=i.symbolArr[o.launch.x][o.launch.y];i._youGo(n.x,n.y,{type:o.launch.id,lv:o.launch.lv,grade:o.launch.grade,num:1},!1),i._removeLize(i.symbolArr[o.launch.x][o.launch.y]),i.symbolArr[o.launch.x][o.launch.y]=null,i.checkTrapCom(0,t,1e3,0,e.index)},u,350)},u=this;for(var o in t){var f=p(o);if("object"==typeof f)return f.value}}else{var g=function(n){var o=t[n],a=C.mapArr[o.active.x][o.active.y].getPosition(),r=C.mapArr[o.passive.x][o.passive.y].getPosition();C.symbolArr[o.passive.x][o.passive.y].runAction(cc.sequence(cc.moveTo(.3,a),cc.callFunc(function(){i.symbolArr[o.active.x][o.active.y].setPosition(r),i.symbolArr[o.passive.x][o.passive.y].setPosition(a),i.mapArr[o.active.x][o.active.y].getComponent("SandTableBg").setBgColor(o.passive.type),i.mapArr[o.passive.x][o.passive.y].getComponent("SandTableBg").setBgColor(o.active.type),i._exchange(i.symbolArr[o.passive.x][o.passive.y],i.symbolArr[o.active.x][o.active.y]),i.symbolArr[o.active.x][o.active.y].getComponent("SandTableSymbol").setGrade(o.center.removalFr),i.checkTrapCom(0,t,200,1,e.index)},C)))},C=this;for(var o in t)g(o)}else{var v=0,_=function(n){var o=t[n],a=o.arr;b.symbolArr[o.center.x][o.center.y].getComponent("SandTableSymbol").setGrade(o.center.removalFr);var r=function(n){var r=b.symbolArr[a[n].x][a[n].y],s=b.mapArr[a[n].x][a[n].y];v++,b.symbolArr[o.center.x][o.center.y].getComponent("SandTableSymbol").shooting(r,m.SymbolShotType.Minus,function(o,r){o.getComponent("SandTableSymbol").wereShot(m.SymbolShotType.Minus,function(o,r){v--,o.getComponent("SandTableSymbol").setIndex(a[n].symbol),r.getComponent("SandTableBg").setBgColor(a[n].symbol),i.checkTrapCom(v,t,1e3,1,e.index)},i,[o,r])},b,[r,s])};for(var s in a)r(s)},b=this;for(var o in t)_(o)}else{var T=0,S=function(n){var o=t[n],a=o.arr;I.symbolArr[o.center.x][o.center.y].getComponent("SandTableSymbol").setGrade(o.center.removalFr);var r=function(n){if(null!=a[n].symbol){var r=I.symbolArr[a[n].x][a[n].y],s=I.mapArr[a[n].x][a[n].y];T++,I.symbolArr[o.center.x][o.center.y].getComponent("SandTableSymbol").shooting(r,m.SymbolShotType.Add,function(o,r){o.getComponent("SandTableSymbol").wereShot(m.SymbolShotType.Add,function(o,r){T--,o.getComponent("SandTableSymbol").setIndex(a[n].symbol),o.getComponent("SandTableSymbol").setUp(a[n].grade),r.getComponent("SandTableBg").setBgColor(a[n].symbol),o.getComponent("SandTableSymbol").setCuiMian(a[n].cuimian),i.checkTrapCom(T,t,1500,1,e.index)},i,[o,r])},I,[r,s])}};for(var s in a)r(s)},I=this;for(var o in t)S(o)}else{var w=0,D=function(n){var o=t[n],a=o.arr;R.symbolArr[o.center.x][o.center.y].getComponent("SandTableSymbol").setGrade(o.center.removalFr);var r=function(n){if(null!=a[n].symbol&&a[n].symbol<15){var r=R.symbolArr[a[n].x][a[n].y],s=R.mapArr[a[n].x][a[n].y];w++,R.symbolArr[o.center.x][o.center.y].getComponent("SandTableSymbol").shooting(r,m.SymbolShotType.Add,function(o,r){o.getComponent("SandTableSymbol").wereShot(m.SymbolShotType.Add,function(o,r){w--,o.getComponent("SandTableSymbol").setIndex(a[n].symbol),r.getComponent("SandTableBg").setBgColor(a[n].symbol),i.checkTrapCom(w,t,500,1,e.index)},i,[o,r])},R,[r,s])}};for(var s in a)r(s)},R=this;for(var o in t)D(o)}else{var A=0,N=function(n){var o=t[n],a=o.arr;L.symbolArr[o.center.x][o.center.y].getComponent("SandTableSymbol").setGrade(o.center.removalFr);var r=function(n){if(null!=a[n].symbol&&void 0!==a[n].symbol&&a[n].symbol.type<15){var r=L.symbolArr[a[n].x][a[n].y],s=L.mapArr[a[n].x][a[n].y];A++,L.symbolArr[o.center.x][o.center.y].getComponent("SandTableSymbol").shooting(r,m.SymbolShotType.Add,function(o,r){o.getComponent("SandTableSymbol").wereShot(m.SymbolShotType.Add,function(o,r){A--,i.symbolArr[a[n].x][a[n].y].getComponent("SandTableSymbol").setUp(a[n].symbol.grade),i.checkTrapCom(A,t,500,1,e.index)},i,[o,r])},L,[r,s])}};for(var s in a)r(s)},L=this;for(var o in t)N(o)}else for(var o in t){var E=t[o];this.symbolArr[E.center.x][E.center.y].getComponent("SandTableSymbol").setBullet(E.center.removalFr,function(){y.default.instance.readyChangeMonsterHp(0,-.1),i.checkTrapCom(0,t,1e3,1,e.index)},this)}else{var B=0,M=function(n){var o=t[n],a=o.arr;x.symbolArr[o.center.x][o.center.y].getComponent("SandTableSymbol").setGrade(o.center.removalFr),a.length||x.checkTrapCom(B,t,500,1,e.index);var r=function(n){if(null!=a[n].symbol&&a[n].symbol<=15){var r=x.symbolArr[a[n].x][a[n].y],s=x.mapArr[a[n].x][a[n].y];B++,x.symbolArr[o.center.x][o.center.y].getComponent("SandTableSymbol").shooting(r,m.SymbolShotType.Add,function(o,r){o.getComponent("SandTableSymbol").wereShot(m.SymbolShotType.Add,function(o,r){B--,o.getComponent("SandTableSymbol").setIndex(a[n].symbol),r.getComponent("SandTableBg").setBgColor(a[n].symbol),i.checkTrapCom(B,t,500,1,e.index)},i,[o,r])},x,[r,s])}};for(var s in a)r(s)},x=this;for(var o in t)M(o)}else{var k=!0;this.time1=null;var P=function(e){var n=t[e];G.symbolArr[n.center.x][n.center.y].getPosition();if(G.symbolArr[n.center.x][n.center.y].getComponent("SandTableSymbol").hammerHit(n.center.removalFr),n.stora){var o=n.stora.removalFr<=0?0:n.stora.removalFr;if(G.symbolArr[n.stora.x][n.stora.y].getComponent("SandTableSymbol").hammerHit2(o),0==o){k=!1;var a=h.default.instance.setTimeout(function(){var e=i.stoneArr.indexOf(i.symbolArr[n.stora.x][n.stora.y]);if(i.stoneArr.splice(e,1),-1==n.stora.removalFr){var t=i.symbolArr[n.stora.x][n.stora.y].getComponent("SandTableSymbol").getTrap();if(t){var o=t+50;i.symbolArr[n.stora.x][n.stora.y].getComponent("SandTableSymbol").clearhammerHit(),i.symbolArr[n.stora.x][n.stora.y].getComponent("SandTableSymbol").setIndex(o)}i.symbolArr[n.stora.x][n.stora.y].getComponent("SandTableSymbol").setGrade(n.stora.removaNum)}else i.symbolArr[n.stora.x][n.stora.y].getComponent("SandTableSymbol").clearhammerHit(),i.symbolArr[n.stora.x][n.stora.y].destroy(),i.symbolArr[n.stora.x][n.stora.y]=null;h.default.instance.clearTimeout(a)},G,1e3);k||G.time1||(G.time1=h.default.instance.setTimeout(function(){var e=i._data[i._data.length-1].result,t=i._data[i._data.length-1].secondArr;t&&t.length&&(e=t[t.length-1][i.secondCycle].result);i._twinkleOver(e,!0),h.default.instance.clearTimeout(i.time1),i.time1=null},G,1200))}}},G=this;for(var F in t)P(F);k&&this.checkTrapCom(0,t,500,1,e.index)}},t.prototype.onCheckIsMaxLevel=function(e){return e>=12&&e<=14},t.prototype.onCloneOldSandData=function(e){var t=JSON.parse(JSON.stringify(e));this._oldSandData=t},t.prototype.onSynthesisEffect=function(){h.default.instance.clearTimeout(this.showEffectSymbolNodeTime),this.showEffectSymbolNodeTime=0,this._effectSymbolNode&&(this._effectSymbolNode.opacity=255),this.onSynthesisEffectEnd(!0),this.setStartTipsTime()},t.prototype.onShowCardSynthesisEffect=function(e){var t=this,i=this._data[0].result.operationArr,n=[],o=[],a=-1,r=[];if(s.ActivityStatus.value!=s.ActivityStatus.Guide&&!O.default.isFiveEffect){for(var l=0;l<i.length;l++)if(this._oldSandData[i[l].x]&&this._oldSandData[i[l].x][i[l].y]){var c=this._oldSandData[i[l].x][i[l].y];this.onCheckIsMaxLevel(c.type)&&(a=-1==a?l:-2)}if(-2!=a){for(l=0;l<e.length;l++)if(this._oldSandData[l]&&e[l])for(var d=0;d<e[l].length;d++)n[d]||(n[d]=[]),o[d]||(o[d]=[]),e[l][d]&&this.onCheckIsMaxLevel(e[l][d].type)&&n[d].push([l,d,e[l][d].type]),this._oldSandData[l][d]&&this.onCheckIsMaxLevel(this._oldSandData[l][d].type)&&o[d].push([l,d,this._oldSandData[l][d].type]);for(l=0;l<n.length;l++)if(a>=0&&i.length>1){c=this._oldSandData[i[a].x][i[a].y];if(l==i[0].y&&a+1==1||l==i[1].y&&a+1==2){for(var p=0;p<o[l].length;p++)if(o[l][p]&&o[l][p][2]==c.type){o[l].splice(p,1);break}a+1==1?o[i[1].y]&&o[i[1].y].push([i[1].x,i[1].y,c.type]):a+1==2&&o[i[0].y]&&o[i[0].y].push([i[0].x,i[0].y,c.type]);break}}for(l=0;l<n.length;l++)if(n[l].length>o[l].length)if(o[l].length<1)for(d=0;d<n[l].length;d++)r.push(n[l][d]);else{var u=null,f=n[l].length-o[l].length;for(d=0;d<n[l].length;d++){var g=!1;for(p=0;p<o[l].length;p++)n[l][d][2]==o[l][p][2]&&(g=!0,n[l][d][0]!=o[l][p][0]&&(u=n[l][d]));g||(f--,r.push(n[l][d]))}f>0&&u&&r.push(u)}}}if(r.length>0){var y=0,m=0;for(l=0;l<r.length;l++)if(r[l].length>2){var C=this.ctr.getMonsterid(r[l][2]%3).id;C>=m&&(m=C,y=l)}r[y]&&r[y].length>2&&(this._effectSymbolNode=this.symbolArr[r[y][0]][r[y][1]],this._effectSymbolNode&&(T.default.instance.openWindow(S.WindowType.SandTableCardSynthesis,function(){t._effectSymbolNode.opacity=1;var e=new cc.Vec2(t._effectSymbolNode.x+t.TouchNode.x,t._effectSymbolNode.y+t.TouchNode.y-60);B.default.instance.onInitData(m,e,Math.floor(r[y][2]/3)+1)},this),this.showEffectSymbolNodeTime=h.default.instance.setTimeout(this.onSynthesisEffect,this,5e3)))}else this.onSynthesisEffectEnd(),this.setStartTipsTime();this.onCloneOldSandData(e)},t.prototype.onSynthesisEffectEnd=function(e){var t=this;if(void 0===e&&(e=!1),this.trapcom=!0,this.checkClose(),this._moveNum<=0){if(!F.default.instance.iscomplete)return void this.close(!1);var i=s.ActivityStatus.value==s.ActivityStatus.Guide?0:1e3,o=h.default.instance.setTimeout(function(){if(s.ActivityStatus.value==s.ActivityStatus.WorldBoss||s.ActivityStatus.value==s.ActivityStatus.EliteBoss||s.ActivityStatus.value==s.ActivityStatus.HighLadder||s.ActivityStatus.value==s.ActivityStatus.LoardCrusade)T.default.instance.openWindow(S.WindowType.LadderFighTips);else{var e=!1;s.ActivityStatus.value==s.ActivityStatus.TreasureMap&&(e=!0),t.close(!1,e),n.GameEventDispatcher.instance.emit(a.EventDefiner.FightUpdateArenaWait,{type:2})}h.default.instance.clearTimeout(o)},this,i)}else{for(var r in this.updateCondition(),this.symbolArr)for(var l=0;l<this.symbolArr.length;l++)this.indexArr[r][l]=this.symbolArr[r][l]?this.symbolArr[r][l].getComponent("SandTableSymbol").getIndex():null;this._lockAll(this.ctr.automatic),this.ctr.automatic||this.onTouchNode()}this._processIn=!1},t.prototype.dropEnd=function(){var e=this._data[this._data.length-1].result.resultArr,t=this._data[this._data.length-1].secondArr;if(t&&t.length){var i=t[t.length-1];e=i[i.length-1].result.resultArr}this.ctr.setNowArr(e),this.checkGuide(),I.default.instance.isGuide||I.default.instance.checkCondition(22),this.findOffice(),this.onShowCardSynthesisEffect(e),this.playelimination()},t.prototype.checkGuide=function(){if(this._moveNum>0&&!I.default.instance.isGuide)for(var e in this.symbolArr)for(var t in this.symbolArr[e])if(this.symbolArr[e][t]&&this.symbolArr[e][t].getComponent("SandTableSymbol").index>=9&&this.symbolArr[e][t].getComponent("SandTableSymbol").index<=14){I.default.instance.checkCondition(21,this.symbolArr[e][t].getComponent("SandTableSymbol").index);break}},t.prototype._moveStar=function(e,t,i,n){var o=this;e.runAction(cc.sequence(cc.moveTo(n*this._speed,cc.v2(t,i-this._height*n)),cc.callFunc(function(){o._motionNum++,o._moveSymbolEnd()},this)))},t.prototype._moveSymbolEnd=function(){if(this._motionNum==this._motionAllNum)if(this._motionNum=0,this._data.length<=this._cycleIndex&&this.istrap){var e=this._data[this._data.length-1].secondArr;if(void 0!==e&&e.length){if(!e[this.dropNum])return;if(e[this.dropNum].length==this.secondCycle)return void this.dropEnd()}this.dropDeal(!0)}else this._resultLoop()},t.prototype._arrayExchange=function(e,t){var i=this.symbolArr[e.x][e.y];this.symbolArr[e.x][e.y]=this.symbolArr[t.x][t.y],this.symbolArr[t.x][t.y]=i},t.prototype.addMonster=function(e){for(var t=this,i=function(){var i=r.waitlist.shift(),l=i[0],c=i[1],h=i[2],u=i[3],m=i[4],C=(i[5],null);C=U.default.getNodeByUrl(e,d.GlobalContext.Root+"prefab/sandTable/symbol");var v=r.TouchNode.convertToWorldSpaceAR(new cc.Vec2(0,0));v=d.PlayerData.TipsLayer.convertToNodeSpaceAR(new cc.Vec2(v.x+l,v.y+c)),d.PlayerData.TipsLayer.addChild(C,1),C.setPosition(v.x,v.y),C.getComponent("SandTableSymbol").init(),C.getComponent("SandTableSymbol").initSymbol(),C.getComponent("SandTableSymbol").setLook(!0),C.getComponent("SandTableSymbol").setSymbolSize(r._height,r._width);var _=0,b=0,T=0,S=0;if(u){T=h.num,_=Math.floor(h.type/3)+1;var w=r.ctr.getMonsterid(h.type%3),A=r._sports?1:h.lv+w.level+x.default.instance.getTotemsAddLevel(w.id);S=w.id,C.getComponent("SandTableSymbol").setIndex(h.type),b=s.ActivityStatus.Arena==s.ActivityStatus.value?k.default.instance.getCardFlyFight(S,_):o.default.instance.getCarFight(S,A,_)}else S=h.type,b=o.default.instance.getCarFight(h.type,h.lv,h.grade),C.getComponent("SandTableSymbol").setNewMon(h.type,h.grade),_=h.grade,T=1;_>3&&(r.isHaveMasSenior=!0),C.getComponent("SandTableSymbol").setFlyFight(b,T),C.active=!0,C.runAction(cc.show()),C.opacity=255;var N=-200,E=-p.default.instance.fightSceneWidth/2+120;s.ActivityStatus.value!=s.ActivityStatus.Arena&&(N=D.default.instance.getMonsterY(_,!0),E=-p.default.instance.fightSceneWidth/2+y.default.instance.getActorRandX(o.default.instance.getCardConfCardType(h.type)));var B=1.5;r.synthesis&&(h.grade<3||Math.floor(h.type/3)<2)&&(B=.75),C.stopAllActions();var M=R.default.instance.node.convertToWorldSpaceAR(new cc.Vec2(E,N));M=d.PlayerData.TipsLayer.convertToNodeSpaceAR(M),B=(r.ctr.automatic?B/2:B)/p.default.instance.fightViewPlayRate,C.runAction(cc.sequence(cc.show(),cc.moveTo(B,M),cc.hide(),cc.callFunc(function(){if(t._removeLize(C),I.default.instance.isGuide&&I.default.instance.vo&&20==I.default.instance.vo.condition&&(E=-p.default.instance.fightSceneWidth/2+220),u)g.default.instance.checkIsGuideBaoXiang(h.type)||t._generate(S,T,h.lv,h.type,E,N,_,C);else if(f.default.instance.isMerge&&_<=2)f.default.instance.getcontentdata([S,_,h.lv,1,!0]);else{var e={cardid:S,grade:_,level:h.lv,num:1,self:!0,autoUseSkill:!1,buffList:[m],x:E,y:N,noaddfight:!0};n.GameEventDispatcher.instance.emit(a.EventDefiner.C_Scene_Add_Actor,e)}t.creatorMonsterNum--,t.checkClose()},r))),T>1&&F.default.instance.iscomplete&&L.default.instance.loadResByType(d.GlobalContext.Root+"prefab/sandTable/callNum",cc.Prefab,function(e){var i=null;i=t.tipePool.size()>0?t.tipePool.get():U.default.getNodeByUrl(e,d.GlobalContext.Root+"prefab/sandTable/callNum"),t.actionNode.addChild(i,2),i.setPosition(l,c),i.active=!0,i.opacity=255,i.getChildByName("numLabel").getComponent(cc.Label).string=h.num-1+"";var n=.5*(t.ctr.automatic?.5:1)/p.default.instance.fightViewPlayRate,o=.2*(t.ctr.automatic?.5:1)/p.default.instance.fightViewPlayRate;i.runAction(cc.sequence(cc.show(),cc.moveBy(n,0,100),cc.delayTime(o),cc.hide(),cc.callFunc(function(){t._removeCallNum(i)},t)))},r)},r=this;this.waitlist.length>0;)i()},t.prototype._youGo=function(e,t,i,n,a,r){var l=this;if(void 0===a&&(a=null),void 0===r&&(r=!1),this.creatorMonsterNum++,(void 0===i.type||15!=i.type)&&16!=i.type){i=x.default.instance.setActorData(i),this.waitlist.push([e,t,i,n,a,r]),I.default.instance.checkCondition(20),L.default.instance.loadResByType(d.GlobalContext.Root+"prefab/sandTable/symbol",cc.Prefab,function(e){l.addMonster(e)},this);var c=0,h=1;if(n){h=i.num;var u=Math.floor(i.type/3)+1,f=this.ctr.getMonsterid(i.type%3);if(s.ActivityStatus.Arena==s.ActivityStatus.value)c=k.default.instance.getCardFlyFight(f.id,u);else{var g=this._sports?1:i.lv+f.level+x.default.instance.getTotemsAddLevel(f.id);c=o.default.instance.getCarFight(f.id,g,u)}}else c=o.default.instance.getCarFight(i.type,i.lv,i.grade);p.default.instance.leftFight+=c*h,F.default.instance.addMonster||F.default.instance.iscomplete||F.default.instance.checkSandtable()}},t.prototype._removeLize=function(e){U.default.setNodeDestoryByUrl(e,d.GlobalContext.Root+"prefab/sandTable/symbol")},t.prototype._removeCallNum=function(e){V.default.instance.isOpenWindow(S.WindowType.SandTable)?this.tipePool.put(e):U.default.setNodeDestoryByUrl(e,d.GlobalContext.Root+"prefab/sandTable/callNum")},t.prototype._generate=function(e,t,i,r,l,c,d,h){for(var g=l,m=c,v=0;v<t;v++){0!=v&&(m=-200,g=-p.default.instance.fightSceneWidth/2+120,s.ActivityStatus.value!=s.ActivityStatus.Arena&&(m=D.default.instance.getMonsterY(d,!0),g=-p.default.instance.fightSceneWidth/2+y.default.instance.getActorRandX(o.default.instance.getCardConfCardType(e))));var _=this._sports?1:this.ctr.getMonsterid(r%3).level+i,b={cardid:e,grade:d,level:_,num:1,self:!0,autoUseSkill:!1,x:g,y:m,noaddfight:!0,addlevel:i};if(s.ActivityStatus.value!=s.ActivityStatus.HighLadder&&s.ActivityStatus.value!=s.ActivityStatus.WorldBoss&&s.ActivityStatus.value!=s.ActivityStatus.EliteBoss&&s.ActivityStatus.value!=s.ActivityStatus.LoardCrusade||(f.default.instance.isMerge&&d<=2?f.default.instance.getcontentdata([e,d,_,1,!0]):n.GameEventDispatcher.instance.emit(a.EventDefiner.C_Scene_Add_Actor,b)),!this._INTheHigh&&s.ActivityStatus.value!=s.ActivityStatus.Arena)if(s.ActivityStatus.value==s.ActivityStatus.Chapter&&0==u.default.instance.readyPath&&f.default.instance.setgradedata(d),f.default.instance.isMerge&&d<=2)f.default.instance.getcontentdata([e,d,_,1,!0]);else if(n.GameEventDispatcher.instance.emit(a.EventDefiner.C_Scene_Add_Actor,b),s.ActivityStatus.value==s.ActivityStatus.Chapter&&_>4){w.default.instance.SynthesisSLMNumber++;var T={cmd:"fightachieve",param:4,number:w.default.instance.SynthesisSLMNumber};C.default.instance.sendProto(T)}d>3&&this.ctr.setMaxGrade(e,d)}},t.prototype._lockAll=function(e){for(var t in this._lock=e,e||(this._processIn=!1),this.symbolArr)for(var i=0;i<this.symbolArr.length;i++)this.symbolArr[t][i]&&this.symbolArr[t][i].getComponent("SandTableSymbol").setLook(e)},t.prototype._startTips=function(){var e=this;if(this.clearAutoEffect(),this.node.active&&!(this._moveNum<=0)){var t=W.default.instance.getCurConditionConf(),i=0,n=0;if(this._moveNum<=2&&-1==this.ctr.sandtableDrop.indexOf(s.ActivityStatus.value)&&(u.default.instance.islastChapter()&&2==p.default.instance.games?i=1:(n=p.default.instance.rightFight-p.default.instance.leftFight)>0&&(i=2)),i){var o=this.getCanOperationSymbol(i,n);if(Math.floor(o.bol.index/3)+1<=2)this.sandtableAuto(t);else{var a=this.mapArr[o.x][o.y].x,r=this.mapArr[o.x][o.y].y;this.tipsNode.node.active=!0,this.tipsNode.node.setPosition(cc.v2(a,r)),this.symbolArr[o.x][o.y].zIndex=3;var l=.5*(this.ctr.automatic?.5:1)/p.default.instance.fightViewPlayRate,c=.2*(this.ctr.automatic?.5:1)/p.default.instance.fightViewPlayRate;this.ctr.automatic?(this.tipsNode.node.runAction(cc.sequence(cc.show(),cc.moveTo(l,cc.v2(-200,r)),cc.delayTime(l),cc.hide(),cc.delayTime(c),cc.callFunc(function(){e.tipsNode.node.setPosition(cc.v2(a,r))},this))),O.default.isAutomaticMode?this.setAutomatic():this.symbolArr[o.x][o.y].runAction(cc.sequence(cc.moveTo(l,cc.v2(-200,r)),cc.callFunc(function(){e._voluntarilyOne(o.x,o.y)},this)))):this.tipsNode.node.runAction(cc.sequence(cc.show(),cc.moveTo(l,cc.v2(-200,r)),cc.delayTime(l),cc.hide(),cc.delayTime(c),cc.callFunc(function(){e.tipsNode.node.setPosition(cc.v2(a,r))},this)).repeatForever())}}else this.sandtableAuto(t)}},t.prototype.getCanOperationSymbol=function(e,t){for(var i=[],n=0;n<this.symbolArr.length;n++)for(var o=0;o<this.symbolArr[n].length;o++){var a=this.symbolArr[n][o];if(null!=this.indexArr[n][o]&&this.indexArr[n][o]<30&&a&&a.getComponent(v.default).canDragMaster()){var r={bol:a.getComponent(v.default),fight:a.getComponent(v.default).Fight,x:n,y:o};i.push(r)}}i.sort(function(e,t){return t.fight-e.fight});var s=0;if(2==e){t=Math.abs(t);var l=0;for(n=0;n<i.length;n++){var c=Math.abs(i[n].fight-t);n||(l=c),l>c&&i[n].fight>t&&(l=c,s=n)}}return i[s]},t.prototype.sandtableAuto=function(e){var t=this,i=!0;this.tipoperation=null;var n=null;e&&2==e.type&&(i=!1);var a=r.default.instance.getautomaticStar(g.default.instance.symbolArr);if(this.tipsNode.node.stopAllActions(),a.length&&i){var l=null;for(var c in a)l||(l=a[c]),a[c]&&l&&(a[c].type<2&&l.type<2&&a[c].power>l.power?l=a[c]:a[c].type>=2&&l.type>=2&&a[c].power>l.power?l=a[c]:l.type>=2&&a[c].type<2&&(l=a[c]));n=l;var d=this.mapArr[l.x][l.y],h=this.mapArr[l.x1][l.y1],u=d.x,f=d.y,y=h.x,m=h.y,C=d.getComponent("SandTableBg");this.playUpEffect(d.position,1,!0,C.bg.node.getContentSize()),this.playUpEffect(h.position,1,!0,C.bg.node.getContentSize()),this.tipsNode.node.setPosition(cc.v2(u,f)),this.tipsNode.node.active=!0,this.symbolArr[l.x][l.y]&&(this.symbolArr[l.x][l.y].zIndex=3);var v=.5*(this.ctr.automatic?.5:1)/p.default.instance.fightViewPlayRate,_=.2*(this.ctr.automatic?.5:1)/p.default.instance.fightViewPlayRate;this.ctr.automatic?(this.tipsNode.node.runAction(cc.sequence(cc.show(),cc.delayTime(v),cc.moveTo(v,cc.v2(y,m)),cc.delayTime(v),cc.hide(),cc.delayTime(_),cc.callFunc(function(){t.tipsNode.node.setPosition(cc.v2(u,f))},this))),this.symbolArr[l.x][l.y].runAction(cc.sequence(cc.delayTime(v),cc.moveTo(v,cc.v2(y,m)),cc.callFunc(function(){t._voluntarily(l.x,l.y,l.x1,l.y1)},this)))):this.tipsNode.node.runAction(cc.sequence(cc.show(),cc.delayTime(v),cc.moveTo(v,cc.v2(y,m)),cc.delayTime(v),cc.hide(),cc.delayTime(_),cc.callFunc(function(){t.tipsNode.node.setPosition(cc.v2(u,f))},this)).repeatForever())}else{for(var b={x:0,y:0,power:0},T=0;T<this.symbolArr.length;T++)for(var S=0;S<this.symbolArr.length;S++)if(this.symbolArr[T][S]){var w=this.symbolArr[T][S].getComponent("SandTableSymbol"),D=w.getIndex();if(D<30&&!g.default.instance.checkIsGuideBaoXiang(D)){var R=this.ctr.getMonsterid(D%3),A=R.id,N=R.level+w.getGrade(),L=Math.floor(D/3)+1,E=o.default.instance.getCarFight(A,N,L);E>b.power&&(b.power=E,b.x=T,b.y=S)}}n=b;var B=this.mapArr[b.x][b.y].x,M=this.mapArr[b.x][b.y].y;this.tipsNode.node.active=!0,this.tipsNode.node.setPosition(cc.v2(B,M)),this.symbolArr[b.x][b.y].zIndex=3;v=.5*(this.ctr.automatic?.5:1)/p.default.instance.fightViewPlayRate;this.ctr.automatic&&!O.default.isAutomaticMode?(this.canPrompt.active=!0,this.canPrompt.runAction(cc.sequence(cc.fadeIn(v),cc.fadeOut(v),cc.callFunc(function(){t.canPrompt.active=!1},this))),this.tipsNode.node.runAction(cc.sequence(cc.show(),cc.moveTo(v,cc.v2(-200,M)),cc.delayTime(v),cc.hide(),cc.delayTime(.1),cc.callFunc(function(){t.tipsNode.node.setPosition(cc.v2(B,M))},this))),this.symbolArr[b.x][b.y].runAction(cc.sequence(cc.moveTo(v,cc.v2(-200,M)),cc.callFunc(function(){t._voluntarilyOne(b.x,b.y)},this)))):(s.ActivityStatus.value!=s.ActivityStatus.Guide&&(e?2!=e.type&&(this.canPrompt.active=!0,this.canPrompt.runAction(cc.sequence(cc.fadeIn(v),cc.fadeOut(v)).repeatForever())):(this.canPrompt.active=!0,this.canPrompt.runAction(cc.sequence(cc.fadeIn(v),cc.fadeOut(v)).repeatForever()))),this.tipsNode.node.runAction(cc.sequence(cc.show(),cc.moveTo(v,cc.v2(-200,M)),cc.delayTime(v),cc.hide(),cc.delayTime(.2),cc.callFunc(function(){t.tipsNode.node.setPosition(cc.v2(B,M))},this)).repeatForever()))}s.ActivityStatus.value==s.ActivityStatus.Guide?this.tipoperation=n:e&&e.type&&!I.default.instance.isGuide&&(this.tipoperation=n)},t.prototype._voluntarily=function(e,t,i,o){this._processIn=!0,this._moveNum-=1,this.setLabel();var a=[];for(var r in this.symbolArr)for(var s in a[r]=[],this.symbolArr[r]){var l=this.symbolArr[r][s]?this.symbolArr[r][s].getComponent("SandTableSymbol").getIndex():100;a[r].push(l)}var c=this.symbolArr[e][t];this.symbolArr[e][t].zIndex=2,this._exchange(c,this.symbolArr[i][o]);var d=h.default.instance.setTimeout(function(){n.GameEventDispatcher.instance.emit("GAMEMOTION",{active:{x:e,y:t},passive:{x:i,y:o},symbol:a}),h.default.instance.clearTimeout(d)},this,50)},t.prototype._voluntarilyOne=function(e,t){this._processIn=!0,this._moveNum-=1,this.setLabel();var i=[];for(var n in this.symbolArr)for(var o in i[n]=[],this.symbolArr[n]){var a=this.symbolArr[n][o]?this.symbolArr[n][o].getComponent("SandTableSymbol").getIndex():100;i[n].push(a)}this.symbolArr[e][t].active=!1,this.tipsNode.node.stopAllActions(),this.tipsNode.node.active=!1,g.default.instance.gameSingle({x:e,y:t},i)},t.prototype._infoInTurn=function(e){if(this._INTheHigh){var t=[],i=e[0].result.operationArr,n=this.length-1,o={type:0,line:[]};for(var a in i[0]&&(o.x=i[0].y,o.y=n-i[0].x),i[1]?(o.tx=i[1].y,o.ty=n-i[1].x):(o.tx=-1,o.ty=-1),t.push(o),e){var r=e[a].result;r.storageArr[0]&&r.storageArr[0].length>1&&(t.push(this._initOperationArr(r.operationArr)),t[t.length-1].line=this._initStorageArr(r.storageArr,r.upSymbol))}this.ctr.sandtableinput(t)}},t.prototype._initOperationArr=function(e){return{type:1,line:[]}},t.prototype._initStorageArr=function(e,t){var i=[],n=this.length-1;for(var o in e)for(var a in i[o]||(i[o]=[]),e[o]){var r=!1;t[o]&&e[o][a].x==t[o][0]&&e[o][a].y==t[o][1]&&(r=!0),i[o].push({x:e[o][a].y,y:n-e[o][a].x,f:r})}return i},t.prototype.updateCondition=function(){var e=this,t=this.node.getChildByName("rulebox");t.active=!1,this.node.getChildByName("ruleBtn").active=!1;var i=W.default.instance.getCurConditionConf();if(this.labelNode.active=null==i&&this.labelNode.active,i)i.rule&&(t.getChildByName("rulebox1").active=!1,t.getChildByName("rulebox2").active=!0,t.active=!0,this.node.getChildByName("ruleBtn").active=!0,t.getChildByName("rulebox2").getChildByName("ruleLabel").getComponent(cc.Label).string=i.rule),1==i.type?(t.getChildByName("rulebox2").getChildByName("bg_lvse").active=!0,t.getChildByName("rulebox2").getChildByName("arrow").scaleX=1):2==i.type&&(t.getChildByName("rulebox2").getChildByName("bg_lvse").active=!1,t.getChildByName("rulebox2").getChildByName("arrow").scaleX=-1);else{if(W.default.instance.hasCondition){this.openTips(2),this._lockAll(!0);var n=h.default.instance.setTimeout(function(){e._lockAll(!1),e.close(),h.default.instance.clearTimeout(n)},this,1300)}var o=0==u.default.instance.currentChapterId&&s.ActivityStatus.value!=s.ActivityStatus.Guide||W.default.instance.config.condition;t.getChildByName("rulebox1").active=o,t.getChildByName("rulebox2").active=!o,t.active=o,this.node.getChildByName("ruleBtn").active=o}},t.instance=null,__decorate([j(cc.Node)],t.prototype,"labelNode",void 0),__decorate([j(cc.Node)],t.prototype,"TouchNode",void 0),__decorate([j(cc.Node)],t.prototype,"actionNode",void 0),__decorate([j(cc.Sprite)],t.prototype,"bg",void 0),__decorate([j(cc.Sprite)],t.prototype,"tipsNode",void 0),__decorate([j(cc.Button)],t.prototype,"tipsBtn",void 0),__decorate([j(cc.Node)],t.prototype,"autoBtn",void 0),__decorate([j(cc.Node)],t.prototype,"fightBtn",void 0),__decorate([j(cc.Node)],t.prototype,"infoNode",void 0),__decorate([j(cc.Node)],t.prototype,"canPrompt",void 0),__decorate([j(cc.Node)],t.prototype,"comboBox",void 0),__decorate([j(cc.Node)],t.prototype,"btnBack",void 0),__decorate([j(cc.Node)],t.prototype,"stepback",void 0),__decorate([j(cc.Label)],t.prototype,"timeLab",void 0),__decorate([j(cc.Node)],t.prototype,"timenode",void 0),__decorate([j(cc.Node)],t.prototype,"incredible",void 0),__decorate([j(cc.Node)],t.prototype,"great",void 0),__decorate([j(cc.Node)],t.prototype,"good",void 0),__decorate([j(cc.SpriteAtlas)],t.prototype,"spalt",void 0),__decorate([j(cc.Node)],t.prototype,"course",void 0),t=i=__decorate([H],t)}(c.default);i.default=K,cc._RF.pop()},{"../../Core/CacheManager":"CacheManager","../../Core/ConfigsManager":"ConfigsManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/SpineBase":"SpineBase","../../Core/TimeController":"TimeController","../../Core/Window":"Window","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../NetConnect/NetConnet":"NetConnet","../../Util/Utils":"Utils","../Arena/ArenaController":"ArenaController","../Chapter/ChapterController":"ChapterController","../Guide/GuideNewController":"GuideNewController","../OpenWin/OpenWinController":"OpenWinController","../Role/RoleInfo":"RoleInfo","../Scene/Controller/FightController":"FightController","../Scene/Controller/GuideFightController":"GuideFightController","../Scene/Controller/MonsterInitPointController":"MonsterInitPointController","../Scene/Controller/SceneController":"SceneController","../Scene/Manager/SceneManager":"SceneManager","../Scene/Pool/SpinePools":"SpinePools","../Scene/View/ActorsLayer":"ActorsLayer","../Sound/SoundController":"SoundController","../Status/StatusController":"StatusController","../Status/StatusType":"StatusType","../Tips/OpTipsController":"OpTipsController","../Totems/TotemsCtrl":"TotemsCtrl","../WarTeam/MonsterController":"MonsterController","../setting/SettingData":"SettingData","./SandTableBackstage":"SandTableBackstage","./SandTableCardSynthesis":"SandTableCardSynthesis","./SandTableChapterguide":"SandTableChapterguide","./SandTableConditionController":"SandTableConditionController","./SandTableController":"SandTableController","./SandTableSymbol":"SandTableSymbol"}],SandTableRec:[function(e,t,i){"use strict";cc._RF.push(t,"0792aDSiStPtqHCHWwCAb56","SandTableRec"),Object.defineProperty(i,"__esModule",{value:!0});var n=cc._decorator,o=n.ccclass,a=n.property,r=e("../../Core/Widget"),s=e("../../Core/ConfigsManager"),l=e("../Scene/Pool/SpinePools"),c=e("../../Core/SpineBase"),d=e("../../Global/GlobalValue"),p=e("./SandTableBackstage"),h=e("./SandTableMain"),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.listNode=null,t.TriggerLabel=null,t.titleRm=null,t.GradeImage=null,t.RemoveLabel=null,t.Result1=null,t.Result2=null,t.TrapIamge=null,t.Images=null,t.spineNode=null,t}return __extends(t,e),t.prototype.start=function(){},t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.setInfo=function(e,t){var i=e-50,n=null;this.node.active=!0,this.GradeImage.node.active=-1!=p.default.instance.OfferTypeTrap.indexOf(e),e>50&&e<100?(n=s.ConfigsManager.instance.getConfigs("sandtableconf").sandTableConf[i],this.Result1.string="<color=#5c3c34>"+n.effectOne+"</color>",this.Result2.string="<color=#5c3c34>"+n.effectTwo+"</color>",this.RemoveLabel.string="<color=#5c3c34>"+n.remove+"</color>",this.TriggerLabel.string="<color=#5c3c34>"+n.trigger+"</color>"):(this.Result1.string="<color=#5c3c34>\u77f3\u5757</color>",this.Result2.string="<color=#5c3c34>\u77f3\u5757\u5360\u636e\u6c99\u76d8\u4e2d\u4e00\u4e2a\u4f4d\u7f6e,\u963b\u788d\u5361\u724c\u7684\u5408\u6210</color>",this.RemoveLabel.string="<color=#5c3c34>\u5728\u77f3\u5757\u7684\u5468\u56f4, \u5b8c\u6210\u4efb\u610f\u4e00\u6b21\u5408\u6210\uff0c\u5373\u53ef\u51cf\u5c11\u77f3\u5757\u7684\u89e6\u53d1\u6b21\u6570</color>",this.TriggerLabel.string="<color=#5c3c34>\u89e6\u53d1\u6b21\u6570\u4e3a0\u540e\uff0c\u77f3\u5757\u5c31\u4f1a\u6d88\u5931</color>"),this.TrapIamge.active=!0,this.spineNode=l.SpinePools.addSpineNoder(this.TrapIamge,new cc.Vec2(0,0));var o=["01jitai","02chuizi_ani1","09shanshen","13huopao_ani1","03qiyuan","14shandian","04tianping","10cuimian","05xiajiang","07heidong","11chuansongzhen_ani1","16tanghuang_ani1","12wodi_ani1","08meidusha","15yaoji_ani1","06wusu"][e-51];this.spineNode.getComponent(c.default).initSpineData(d.SPINE_RES_DIR+"effect/sandtable/effect",null,o,!0)},t.prototype.hide=function(){e.prototype.hide.call(this),this.node.active=!1,this.spineNode&&(l.SpinePools.recoverSpineNoder(this.spineNode),this.spineNode=null),this.TrapIamge.destroyAllChildren(),h.default.instance.findOffice()},__decorate([a(cc.Node)],t.prototype,"listNode",void 0),__decorate([a(cc.RichText)],t.prototype,"TriggerLabel",void 0),__decorate([a(cc.Label)],t.prototype,"titleRm",void 0),__decorate([a(cc.Sprite)],t.prototype,"GradeImage",void 0),__decorate([a(cc.RichText)],t.prototype,"RemoveLabel",void 0),__decorate([a(cc.RichText)],t.prototype,"Result1",void 0),__decorate([a(cc.RichText)],t.prototype,"Result2",void 0),__decorate([a(cc.Node)],t.prototype,"TrapIamge",void 0),__decorate([a(cc.SpriteAtlas)],t.prototype,"Images",void 0),t=__decorate([o],t)}(r.default);i.default=u,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/SpineBase":"SpineBase","../../Core/Widget":"Widget","../../Global/GlobalValue":"GlobalValue","../Scene/Pool/SpinePools":"SpinePools","./SandTableBackstage":"SandTableBackstage","./SandTableMain":"SandTableMain"}],SandTableShow:[function(e,t,i){"use strict";cc._RF.push(t,"f3ff3maLdxHeLRwtc98VYyh","SandTableShow"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../WarTeam/MonsterController"),a=e("../../Core/CommonsResManager"),r=e("../../Global/GlobalValue"),s=e("../../Core/SpineBase"),l=e("../Scene/Pool/SpinePools"),c=cc._decorator,d=c.ccclass,p=(c.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Spoint=cc.v2(0,0),t._height=0,t._width=0,t.sandTableScale=200,t.length=0,t.sonLength=0,t.symbolArr=[],t.typeArr=[],t._monsterData=[],t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this),i.instence=this},t.prototype.show=function(){if(e.prototype.show.call(this),this.typeArr&&this.typeArr.length){this.length=this.typeArr.length,this.sonLength=this.typeArr[0].length,this._height=this.sandTableScale/this.length,this._width=this.sandTableScale/this.sonLength,this._monsterData=o.default.instance.GetWarTeamConfig();for(var t=0;t<this.length;t++)for(var i=0;i<this.sonLength;i++)if(100!=this.typeArr[t][i].type&&(this.typeArr[t][i].type<30||this.typeArr[t][i].type<=101)){var n=(this.length-1)/2,c=(this.sonLength-1)/2,d=this.Spoint.y+(n-t)*this._height,p=this.Spoint.x+(i-c)*this._width,h=new cc.Node("sprite"),u=this.typeArr[t][i].type;if(u<30){(m=new cc.Node("sprite")).addComponent(cc.Sprite).spriteFrame=a.default.instance.getSpriteFrameByName("mapPaper_"+Math.floor(u/3)),m.setPosition(cc.v2(p,d)),m.scale=this._height/m.getContentSize().height,this.node.addChild(m),this.symbolArr.push(m),this.node.addChild(h);var f=0,g=0;15==u?(f=1001,g=1):16==u?(f=1002,g=1):(f=this._monsterData[u%3].id,g=Math.floor(u/3)+1);var y=o.default.instance.getCardGradeByGradeConf(f,g);o.default.instance.infoPreview(h,new cc.Vec2(2*y.monsteroffset[0]/3/100,2*y.monsteroffset[1]/3/100),f,g,.5*y.sandScale/100,-1,!1)}else if(101==u){h.addComponent(cc.Sprite).spriteFrame=a.default.instance.getSpriteFrameByName("mapPaper_5"),h.scale=this._height/h.getContentSize().height,this.node.addChild(h)}else{var m;(m=new cc.Node("sprite")).addComponent(cc.Sprite).spriteFrame=a.default.instance.getSpriteFrameByName("mapPaper_0"),m.setPosition(cc.v2(p,d)),m.scale=this._height/m.getContentSize().height,this.node.addChild(m),this.symbolArr.push(m),this.node.addChild(h);var C=r.spinenamelist[u-51],v=l.SpinePools.addCreateSpineNoder(h,new cc.Vec2(0,0));v.setScale(.6);var _=v.getComponent(s.default);_.initSpineData(r.SPINE_RES_DIR+"effect/sandtable/effect",null,C,!1),_.stop()}h.setPosition(cc.v2(p,d)),this.symbolArr.push(h)}}},t.prototype.setSize=function(e,t){this.sandTableScale=e,this.typeArr=t,this.symbolArr.length&&this.close(),this.show()},t.prototype.close=function(){for(var e in this.symbolArr)this.symbolArr[e].destroy(),this.symbolArr[e]=null;this.symbolArr=[]},t.prototype.hide=function(){e.prototype.hide.call(this),this.close()},t.instence=null,t=i=__decorate([d],t)}(n.default));i.default=p,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/SpineBase":"SpineBase","../../Core/Widget":"Widget","../../Global/GlobalValue":"GlobalValue","../Scene/Pool/SpinePools":"SpinePools","../WarTeam/MonsterController":"MonsterController"}],SandTableSymbol:[function(e,t,i){"use strict";cc._RF.push(t,"a2de2m+ypRHeKHcW6DfIqAq","SandTableSymbol"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/GameEventDispatcher"),o=e("../../Core/Widget"),a=e("../WarTeam/MonsterController"),r=e("../Commons/MonsterPreview"),s=e("../../Util/Utils"),l=e("../../Core/WindowType"),c=e("../../Global/GlobalValue"),d=e("../Scene/Pool/SpinePools"),p=e("../../Core/SpineBase"),h=e("../Tips/OpTipsController"),u=e("../../GlobalContext"),f=e("../../Core/TimeController"),g=e("../../Core/Event"),y=e("./SandTableMain"),m=e("./SandTableBackstage"),C=e("../../Core/CommonsResManager"),v=e("../../Core/Language"),_=e("../Guide/GuideNewController"),b=e("./SandTableController"),T=e("../Status/StatusType"),S=cc._decorator,I=S.ccclass,w=S.property,D=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.symbolNode=null,t.Images=null,t.gr=null,t.pushImage=null,t.label0=null,t.fight=null,t.numLb=null,t.flybg=null,t.index=-1,t.spoint=0,t.eliminateNum=0,t._height=55,t._width=55,t._lookType=!1,t.fallDownNum=0,t._scale=0,t._trapNum=0,t._removalFr=0,t.symType=null,t.symStatus=null,t.banOneGame=0,t.cuimian=0,t.monsterInfo=null,t.spineNode=null,t.wodieffectnumber=1,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this),this.node.on(cc.Node.EventType.TOUCH_START,this.OnSceneTouchStart,this)},t.prototype.init=function(){this.index=-1,this.monsterInfo=null,this.banOneGame=0,this.cuimian=0,this.flybg.active=!1,this.fight.node.active=!1,this.numLb.node.active=!1},t.prototype.setFlyFight=function(e,t){this.flybg.active=!0,this.fight.node.active=!0,this.numLb.node.active=!0,this.fight.string=e*t+"",this.numLb.string="x"+t},t.prototype.OnSceneTouchStart=function(e){if(_.default.instance.isGuide&&24==_.default.instance.vo.condition&&this.node!=_.default.instance.curGuideNode)console.log("\u4e0d\u662f\u5f15\u5bfc\u602a\u7269\u4e0d\u80fd\u62d6\u62c9");else if(y.default.instance._moveNum<=0)console.log("\u6ca1\u6709\u6b65\u6570");else if(this._lookType)console.log("SandTableSymbol.OnSceneTouchStart, this._lookType:"+this._lookType);else if(-1==m.default.instance.symbolGuideBaoXiangArr.indexOf(this.index)){if(this.index>50)return console.log("SandTableSymbol.OnSceneTouchStart, this.index:"+this.index),n.GameEventDispatcher.instance.emit("SHOWTRAP",{index:this.index,info:this.monsterInfo});if(this.banOneGame)console.log("SandTableSymbol.OnSceneTouchStart, this.banOneGame:"+this.banOneGame);else if(this.cuimian)console.log("\u50ac\u7720\u4e2d\u4e0d\u53ef\u62d6\u52a8, this.cuimian:"+this.cuimian);else{this.node.convertToNodeSpaceAR(cc.v2(e.touch.getLocation().x,e.touch.getLocation().y));n.GameEventDispatcher.instance.emit(g.EventDefiner.SandTableSybomlMove,{ball:this,spoint:this.spoint})}}else h.default.instance.ShowMsg(v.default.getStr("100"))},t.prototype.getNndSpoint=function(e){if(!this._lookType)return 0;var t=e;return Math.abs(t.x-this.node.x)<(this._width-10)/2&&Math.abs(t.y-this.node.y)<(this._height-10)/2?[101,67].indexOf(this.index)>-1?2:this.banOneGame||this.cuimian?2:1:0},t.prototype.setGrade=function(e){if(e&&T.ActivityStatus.value!=T.ActivityStatus.Guide){this.pushImage.node.x=e<10?41:20,this.eliminateNum=e,this.index<30?(this.label0.string=""+e,this.pushImage.spriteFrame=this.Images.getSpriteFrame("w_Add"),this.pushImage.node.active=!0):(this.label0.string=""+e,this.pushImage.spriteFrame=this.Images.getSpriteFrame("w_multiply"),this.pushImage.node.active=!0)}else this.label0.string="",this.pushImage.node.active=!1},t.prototype.getGrade=function(){return this.eliminateNum},t.prototype.setNewMon=function(e,t){this.symType&&(this.symbolNode.removeChild(this.symType),this.symType=null);for(var i=this.symbolNode,n=e,o=t,c=i.childrenCount-1;c>=0;c--){var d=i.children[c].getComponent(r.default);d&&(d.clear(),s.default.setNodeToPool(l.PoolType.MonsterPreview,i.children[c]))}var p=a.default.instance.getCardGradeByGradeConf(n,o);a.default.instance.infoPreview(this.symbolNode,cc.v2(p.monsteroffset[0]/100,p.monsteroffset[1]/100),n,o,p.sandScale/100,-1,!0,null,null)},t.prototype.setMonsterInfo=function(e){this.monsterInfo=e},t.prototype.getMonsterInfo=function(){return this.monsterInfo},Object.defineProperty(t.prototype,"Fight",{get:function(){var e=0;return this.index>=0&&this.index<=14&&(e=a.default.instance.getCarFight(b.default.instance.getMonsterid(this.index%3).id,this.eliminateNum,Math.floor(this.index/3)+1)),e},enumerable:!0,configurable:!0}),t.prototype.setIndex=function(e){if(this.node.name="symbol"+e,this.index!=e)if(this.index=e,e<20){this.initTrap(),this.symType&&(this.symbolNode.removeChild(this.symType),this.symType=null),this.symStatus&&(this.symbolNode.removeChild(this.symStatus),this.symStatus=null);var t=this.symbolNode,i=0,n=0;e==m.default.instance.symbolGuideBaoXiangArr[0]?(i=1001,n=1):e==m.default.instance.symbolGuideBaoXiangArr[1]?(i=1002,n=1):(i=b.default.instance.getMonsterid(e%3).id,n=Math.floor(e/3)+1);for(var o=t.childrenCount-1;o>=0;o--){var h=t.children[o].getComponent(r.default);h&&(h.clear(),s.default.setNodeToPool(l.PoolType.MonsterPreview,t.children[o]))}var u=a.default.instance.getCardGradeByGradeConf(i,n);a.default.instance.infoPreview(this.symbolNode,cc.v2(u.monsteroffset[0]/100,u.monsteroffset[1]/100),i,n,u.sandScale/100,-1,!0,null,null),this.node.setScale(this._height/162.5)}else if(e<100){this.symType&&(this.symbolNode.removeChild(this.symType),this.symType=null),this.spineNode=d.SpinePools.addCreateSpineNoder(this.symbolNode,new cc.Vec2(0,0));var f=["01jitai","02chuizi_ani1","09shanshen","13huopao_ani1","03qiyuan","14shandian","04tianping","10cuimian","05xiajiang","07heidong","11chuansongzhen_ani1","16tanghuang_ani1","12wodi_ani1","08meidusha","15yaoji_ani1","06wusu"][e-51];this.spineNode.getComponent(p.default).initSpineData(c.SPINE_RES_DIR+"effect/sandtable/effect",null,f,!0),y.default.instance._moveNum>0&&_.default.instance.checkCondition(23,e)}else{if(this.initTrap(),!this.symType){var g=new cc.Node("sprite");g.addComponent(cc.Sprite).spriteFrame=C.default.instance.getSpriteFrameByName("mapPaper_5"),this.symbolNode.addChild(g),this.symType=g}this.node.setScale(this._height/162.5),this._scale=this._height/this.node.height,this._scale=this._scale<this._width/this.symType.width?this._scale:this._width/this.symType.width,this._scale=this._scale/(this._height/162.5),this.symType.setScale(this._scale)}},t.prototype.offShadow=function(e){var t=e.getComponent("AvatarBase").body.spine.findSlot("weiba");console.log(t),t&&(t.active=!1)},t.prototype.initSymbol=function(){this.pushImage.node.active=!1},t.prototype.getIndex=function(){return this.index},t.prototype.setSpoint=function(e){this.spoint=e},t.prototype.getSpoint=function(){return this.spoint},t.prototype.setDownNum=function(e){this.fallDownNum=e},t.prototype.getDownNum=function(){return this.fallDownNum},t.prototype.setLook=function(e){this._lookType=e},t.prototype.setSymbolSize=function(e,t){this._height=e,this._width=t},t.prototype.setTrap=function(e){this._removalFr=e.removalFr,this._trapNum=e.trapNum},t.prototype.initTrap=function(){this._removalFr=0,this._trapNum=0},t.prototype.getTrap=function(){return this._trapNum},t.prototype.setGoddess=function(e,t,i){void 0===t&&(t=null),void 0===i&&(i=null)},t.prototype.setAltar=function(e,t,i){var n=this;void 0===t&&(t=null),void 0===i&&(i=null),this.wereShot(c.SymbolShotType.Add,function(){n.setGrade(e),t&&t.apply(i)},this)},t.prototype.setBullet=function(e,t,i){var n=this;if(void 0===t&&(t=null),void 0===i&&(i=null),e!=this.eliminateNum){var o=3,a=0,r=this.spineNode.getComponent(p.default);r.initSpineData(c.SPINE_RES_DIR+"effect/sandtable/effect",null,"13huopao_ani2",!1),r.completeCallbackThisObj=this,r.completeCallbackParam=[r],r.completeCallback=function(r){var s=0,l=function(){o--;var r=d.SpinePools.addCreateSpineNoder(h.default.instance.node,h.default.instance.node.convertToNodeSpaceAR(n.node.convertToWorldSpaceAR(new cc.Vec2(10,10)))),l=r.getComponent(p.default);r.x+=40,r.y+=16,l.initSpineData(c.SPINE_RES_DIR+"effect/sandtable/effect",null,"13huopao_dang",!1),o<=0&&f.default.instance.clearInterval(s),r.runAction(cc.sequence(cc.bezierTo(1,[cc.v2(320,20),cc.v2(500,60),cc.v2(600,-200)]),cc.callFunc(function(r){var s=r.getComponent(p.default);s.completeCallbackThisObj=n,s.completeCallbackParam=[r,o],s.initSpineData(c.SPINE_RES_DIR+"effect/sandtable/effect",null,"13huopao_shouji",!1),r.scaleX=5,r.scaleY=5,s.completeCallback=function(o,r){o.scaleX=1,o.scaleY=1,d.SpinePools.recoverSpineNoder(o),o=null,r<=0&&3==++a&&(n.setGrade(e),t&&t.call(i))}},n,[r])))};s=f.default.instance.setInterval(l,n,200),l(),r.loop=!0,r.play("13huopao_ani1"),r.completeCallbackThisObj=null,r.completeCallback=null}}},t.prototype.setWoDi=function(e,t){var i=this;void 0===e&&(e=null),void 0===t&&(t=null);var n=this.spineNode.getComponent(p.default);n.initSpineData(c.SPINE_RES_DIR+"effect/sandtable/effect",null,"12wodi_ani2",!1),n.completeCallbackThisObj=this,n.completeCallbackParam=[n],n.completeCallback=function(n){i.wodieffectnumber=1==i.wodieffectnumber?3:1,n.play("12wodi_ani"+i.wodieffectnumber),n.loop=!0,n.completeCallbackThisObj=null,n.completeCallback=null,e&&e.apply(t)}},t.prototype.setYaoJi=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null);var i=this.spineNode.getComponent(p.default);i.initSpineData(c.SPINE_RES_DIR+"effect/sandtable/effect",null,"15yaoji_ani2",!1),i.completeCallbackThisObj=this,i.completeCallbackParam=[i],i.completeCallback=function(i){i.play("15yaoji_ani1"),i.loop=!0,i.completeCallbackThisObj=null,i.completeCallback=null,e&&e.apply(t)}},t.prototype.setUp=function(e){e!=this.eliminateNum&&this.setGrade(e)},t.prototype.hammerHit=function(e){e!=this.eliminateNum&&this.setGrade(e)},t.prototype.hammerHit2=function(e){this.spineNode=d.SpinePools.addCreateSpineNoder(this.symbolNode,new cc.Vec2(0,0));var t=this.spineNode.getComponent(p.default);t.initSpineData(c.SPINE_RES_DIR+"effect/sandtable/effect",null,"02chuizi_ani2",!1),t.completeCallbackThisObj=this,t.completeCallbackParam=[this.spineNode],this.setGrade(e),t.completeCallback=function(e){d.SpinePools.recoverSpineNoder(e),e=null}},t.prototype.clearhammerHit=function(){this.spineNode&&(d.SpinePools.recoverSpineNoder(this.spineNode),this.spineNode=null)},t.prototype.showDown=function(e){if(this.symType&&0!=this.symType.childrenCount){var t=this.symType.children[0].x,i=this.symType.children[0].y;this.symType.children[0].runAction(cc.sequence(cc.moveBy(.2,0,-30).easing(cc.easeOut(3)),cc.moveTo(.2,cc.v2(t,i)).easing(cc.easeIn(3)),cc.callFunc(function(){this.setGrade(e)},this)))}},t.prototype.shooting=function(e,t,i,n,o){void 0===i&&(i=null),void 0===n&&(n=null),void 0===o&&(o=null);var a=d.SpinePools.addCreateSpineNoder(u.PlayerData.TipsLayer,u.PlayerData.TipsLayer.convertToNodeSpaceAR(this.node.convertToWorldSpaceAR(new cc.Vec2(0,0)))),r=a.getComponent(p.default),s="buff1-1";2==t&&(s="debuff1-1");var l=0;e.y==this.node.y?l=e.x<this.node.x?-90:90:e.x==this.node.x?l=e.y<this.node.y?-180:0:e.x>this.node.x?l=e.y>this.node.y?45:135:e.x<this.node.x?l=e.y>this.node.y?-45:-135:e.y<this.node.y?l=this.node.x>e.x?-135:135:e.y>this.node.y&&(l=this.node.x>e.x?-45:45);var h=e.x==this.node.x||e.y==this.node.y?1:1.5;a.rotation=l,a.scaleY=h,r.completeCallbackThisObj=this,r.completeCallbackParam=[a],r.initSpineData(c.SPINE_RES_DIR+"effect/sandtable/effect",null,s,!1),r.completeCallback=function(e){e.scaleY=1,e.rotation=0,d.SpinePools.recoverCreateSpineNoder(e),e=null,i&&i.apply(n,o)}},t.prototype.wereShot=function(e,t,i,n){void 0===t&&(t=null),void 0===i&&(i=null),void 0===n&&(n=null);var o=d.SpinePools.addCreateSpineNoder(h.default.instance.node,h.default.instance.node.convertToNodeSpaceAR(this.node.convertToWorldSpaceAR(new cc.Vec2(0,0)))),a=o.getComponent(p.default),r="buff1-2";2==e&&(r="debuff1-2"),a.completeCallbackThisObj=this,a.completeCallbackParam=[o],a.initSpineData(c.SPINE_RES_DIR+"effect/sandtable/effect",null,r,!1),a.completeCallback=function(e){d.SpinePools.recoverSpineNoder(e),e=null,t&&t.apply(i,n)}},t.prototype.starDelivery=function(){this.symType&&(this.symType.children[0].opacity=0,this.symType.children[0].setScale(0),this.symType.children[0].runAction(cc.sequence(cc.spawn(cc.fadeIn(.2),cc.scaleTo(.3,1)),cc.fadeOut(.1),cc.fadeIn(.1),cc.callFunc(function(){this.symType.children[0].opacity=0,this.symType.children[0].setScale(0)},this))))},t.prototype.tanghuang=function(e,t,i){var n=this;void 0===t&&(t=null),void 0===i&&(i=null);var o=this.spineNode.getComponent(p.default);o.initSpineData(c.SPINE_RES_DIR+"effect/sandtable/effect",null,"16tanghuang_ani2",!1),o.completeCallbackThisObj=this,o.completeCallbackParam=[o],o.completeCallback=function(o){n.setGrade(e),o.loop=!0,o.play("16tanghuang_ani1"),o.completeCallbackThisObj=null,o.completeCallback=null,t&&t.call(i)}},t.prototype.getBanGame=function(){return this.banOneGame},t.prototype.setBanGame=function(e){if(e>0){if(!this.symType){var t=new cc.Node("sprite");t.addComponent(cc.Sprite).spriteFrame=C.default.instance.getSpriteFrameByName("mapPaper_5"),this.symbolNode.addChild(t),this.symType=t}this._scale=this._height/this.node.height,this._scale=this._scale<this._width/this.symType.width?this._scale:this._width/this.symType.width,this.symType.setScale(this._scale)}else this.index<30&&this.symType&&(this.symbolNode.removeChild(this.symType),this.symType=null);this.banOneGame=e},t.prototype.getCuiMian=function(){return this.cuimian},t.prototype.setCuiMian=function(e){if(e>0){if(!this.symStatus){var t=new cc.Node("sprite");t.addComponent(cc.Sprite).spriteFrame=this.Images.getSpriteFrame("icon_shuimian"),this.symbolNode.addChild(t),this.symStatus=t}this._scale=this._height/this.node.height,this._scale=this._scale<this._width/this.symStatus.width?this._scale:this._width/this.symStatus.width,this.symStatus.x=(this._width-this.symStatus.width)/2,this.symStatus.y=(this._height-this.symStatus.height)/2,this.symStatus.setScale(this._scale)}else this.index<30&&this.symStatus&&(this.symbolNode.removeChild(this.symStatus),this.symStatus=null);this.cuimian=e},t.prototype.canDragMaster=function(){return this.index>=0&&this.index<=16&&this.getBanGame()<=0&&this.getCuiMian()<=0},__decorate([w(cc.Node)],t.prototype,"symbolNode",void 0),__decorate([w(cc.SpriteAtlas)],t.prototype,"Images",void 0),__decorate([w(cc.Node)],t.prototype,"gr",void 0),__decorate([w(cc.Sprite)],t.prototype,"pushImage",void 0),__decorate([w(cc.Label)],t.prototype,"label0",void 0),__decorate([w(cc.Label)],t.prototype,"fight",void 0),__decorate([w(cc.Label)],t.prototype,"numLb",void 0),__decorate([w(cc.Node)],t.prototype,"flybg",void 0),t=__decorate([I],t)}(o.default);i.default=D,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/SpineBase":"SpineBase","../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/MonsterPreview":"MonsterPreview","../Guide/GuideNewController":"GuideNewController","../Scene/Pool/SpinePools":"SpinePools","../Status/StatusType":"StatusType","../Tips/OpTipsController":"OpTipsController","../WarTeam/MonsterController":"MonsterController","./SandTableBackstage":"SandTableBackstage","./SandTableController":"SandTableController","./SandTableMain":"SandTableMain"}],SandTableTalent:[function(e,t,i){"use strict";cc._RF.push(t,"b5a65IafT5HWabHuGk2QQpk","SandTableTalent"),Object.defineProperty(i,"__esModule",{value:!0});var n=cc._decorator,o=n.ccclass,a=n.property,r=e("../../Core/Widget"),s=e("../WarTeam/MonsterController"),l=e("../../Util/LocalStorageUtils"),c=e("../Role/RoleInfo"),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.node0=null,t.node1=null,t.node2=null,t.node3=null,t.infoArr=[0,0,0],t.nodeArr=[],t.current=0,t.currentNum=0,t.GradeTwo=!1,t.GradeThree=!1,t.nameText="",t}var i;return __extends(t,e),i=t,t.prototype.start=function(){i.instance=this},t.prototype.show=function(){e.prototype.show.call(this),this.node.active=!0},t.prototype.hide=function(){this.node.active=!1},t.prototype.setMonster=function(e,t){if(this.GradeThree){this.nameText=t;var i=l.default.instance.getItem(c.MyRoleInfo.id+"SandTableTalent");for(var n in i?(this.infoData=i,this.infoData[t]?this.infoArr=this.infoData[t]:this.infoArr=[0,0,0]):(this.infoArr=[0,0,0],this.infoData={}),this.nodeArr=[this.node1,this.node2,this.node3],this.setNodeOne(this.node0,-1,0),this.setNodeOne(this.node1,0,this.infoArr[0]),this.setNodeOne(this.node2,1,this.infoArr[1]),this.setNodeOne(this.node3,2,this.infoArr[2]),e){var o=e[n].id,a=this.nodeArr[n],r=s.default.instance.getCardGradeByGradeConf(o,1);s.default.instance.infoPreview(a,cc.v2(r.monsteroffset[0]/100+5,r.monsteroffset[1]/100+20),o,1,r.sandScale/100*.7,-1,!0)}}},t.prototype.setInfo=function(e){this.current+=1,this.GradeThree&&(0==e?(this.infoArr[0]+=1,this.setNodeOne(this.node1,e,this.infoArr[0])):1==e?(this.infoArr[1]+=1,this.setNodeOne(this.node2,e,this.infoArr[1])):(this.infoArr[2]+=1,this.setNodeOne(this.node3,e,this.infoArr[2])))},t.prototype.setNodeOne=function(e,t,i){},t.prototype.emptyData=function(e){this.infoArr[e]=0,this.setNodeOne(this.nodeArr[e],e,this.infoArr[e])},t.prototype.openTwo=function(e){console.log("\u6c99\u76d8\u5929\u8d4b\u4e8c\u6570\u91cf   \uff1a ",e),this.GradeTwo=!0,this.currentNum=e},t.prototype.triggerTwo=function(){this.GradeTwo&&(this.current,this.currentNum,this.GradeThree&&(this.infoData[this.nameText]=this.infoArr,l.default.instance.setItem(c.MyRoleInfo.id+"SandTableTalent",this.infoData)))},t.prototype.openThree=function(e){this.GradeThree=!0},t.instance=null,__decorate([a(cc.Node)],t.prototype,"node0",void 0),__decorate([a(cc.Node)],t.prototype,"node1",void 0),__decorate([a(cc.Node)],t.prototype,"node2",void 0),__decorate([a(cc.Node)],t.prototype,"node3",void 0),t=i=__decorate([o],t)}(r.default);i.default=d,cc._RF.pop()},{"../../Core/Widget":"Widget","../../Util/LocalStorageUtils":"LocalStorageUtils","../Role/RoleInfo":"RoleInfo","../WarTeam/MonsterController":"MonsterController"}],SandTableWin:[function(e,t,i){"use strict";cc._RF.push(t,"68d23QmxgpJErKrT46kxvMI","SandTableWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../GlobalContext"),a=e("./SandTableShow"),r=e("../../Core/WindowManager"),s=e("../../Core/LoadManager"),l=e("../../Util/Utils"),c=cc._decorator,d=c.ccclass,p=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Shapanbg=null,t._tableData=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){i.instance=this},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){var t=this;e.prototype.show.call(this),this.Shapanbg.childrenCount||s.default.instance.loadResByType(o.GlobalContext.Root+"prefab/sandTable/SandTableShow",cc.Prefab,function(e){var i=l.default.getNodeByUrl(e,o.GlobalContext.Root+"prefab/sandTable/SandTableShow");t.Shapanbg.addChild(i),t.Shapanbg.getChildByName("SandTableShow").getComponent(a.default).setSize(.7*t.Shapanbg.width,t._tableData)},this)},t.prototype.initData=function(e){this._tableData=e,this.Shapanbg.getChildByName("SandTableShow")&&this.Shapanbg.getChildByName("SandTableShow").getComponent(a.default)&&this.Shapanbg.getChildByName("SandTableShow").getComponent(a.default).setSize(.7*this.Shapanbg.width,e)},t.prototype.hide=function(){e.prototype.hide.call(this),l.default.setNodeDestoryByUrl(this.Shapanbg.children[0],o.GlobalContext.Root+"prefab/sandTable/SandTableShow"),this.Shapanbg.getChildByName("SandTableShow").getComponent(a.default).close()},t.prototype.close=function(){},t.prototype.onClickBack=function(){r.default.instance.closeWindow(this.node)},t.instance=null,__decorate([p(cc.Node)],t.prototype,"Shapanbg",void 0),t=i=__decorate([d],t)}(n.default);i.default=h,cc._RF.pop()},{"../../Core/LoadManager":"LoadManager","../../Core/Widget":"Widget","../../Core/WindowManager":"WindowManager","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","./SandTableShow":"SandTableShow"}],SandtableFunTip:[function(e,t,i){"use strict";cc._RF.push(t,"908b65ivU9M4p5F4+orygIB","SandtableFunTip"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Commons/CommonPageBG"),o=e("../../Core/Language"),a=e("../FightInfoPanel/FightInfoPanel"),r=e("./SandTableMain"),s=cc._decorator,l=s.ccclass,c=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.descLabel=null,t.fightnode=null,t.tipnode=null,t.type=0,t.isclose=!1,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this,this.onInit(525,330,o.default.getStr("common_page_title"),!0)},t.prototype.Info=function(e){this.type=e,this.isclose=!1,this.descLabel.string=o.default.getStr("sandtableFuntip"+e),this.node.getChildByName("type1").active=1==e,this.node.getChildByName("type2").active=2==e},t.prototype.onClose=function(){if(!this.isclose)if(this.isclose=!0,2==this.type){var t=a.default.instance.node,i=(t=t.getChildByName("SelfBox").getChildByName("box").getChildByName("Fight")).convertToWorldSpaceAR(new cc.Vec2(0,0)),n=cc.instantiate(this.fightnode);this.node.addChild(n),n.setPosition(this.fightnode.x,this.fightnode.y),this.fly(n,i)}else if(1==this.type){var o=r.default.instance.node,s=(i=(o=o.getChildByName("tipsToggle")).convertToWorldSpaceAR(new cc.Vec2(0,0)),cc.instantiate(this.tipnode));this.node.addChild(s),s.setPosition(this.tipnode.x,this.tipnode.y),this.fly(s,i)}else e.prototype.onClose.call(this)},t.prototype.fly=function(t,i){var n=this;t.runAction(cc.sequence(cc.moveTo(1,this.node.convertToNodeSpaceAR(i)),cc.callFunc(function(){t.removeFromParent(!0),t.destroy(),e.prototype.onClose.call(n)},this)))},t.instance=null,__decorate([c(cc.Label)],t.prototype,"descLabel",void 0),__decorate([c(cc.Node)],t.prototype,"fightnode",void 0),__decorate([c(cc.Node)],t.prototype,"tipnode",void 0),t=i=__decorate([l],t)}(n.default);i.default=d,cc._RF.pop()},{"../../Core/Language":"Language","../Commons/CommonPageBG":"CommonPageBG","../FightInfoPanel/FightInfoPanel":"FightInfoPanel","./SandTableMain":"SandTableMain"}],SandtableShapan:[function(e,t,i){"use strict";cc._RF.push(t,"30fcayoe9FBwqa9mpzoyLQQ","SandtableShapan"),Object.defineProperty(i,"__esModule",{value:!0});var n=cc._decorator,o=n.ccclass,a=n.property,r=e("../../Util/Utils"),s=e("../Scene/Controller/SceneController"),l=e("../Tips/OpTipsController"),c=e("../../Core/Language"),d=e("../../Core/LoadManager"),p=e("../../GlobalContext"),h=e("./SandTableShow"),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.shapanbg=null,t}return __extends(t,e),t.prototype.start=function(){s.default.instance.fightData.data&&this.setShapan(s.default.instance.fightData.data.table)},t.prototype.setShapan=function(e){var t=this;e?this.shapanbg&&!this.shapanbg.getChildByName("SandTableShow")?d.default.instance.loadResByType(p.GlobalContext.Root+"prefab/sandTable/SandTableShow",cc.Prefab,function(i){var n=r.default.getNodeByUrl(i,p.GlobalContext.Root+"prefab/sandTable/SandTableShow");t.shapanbg.addChild(n),t.shapanbg.getChildByName("SandTableShow").getComponent(h.default).setSize(.7*t.shapanbg.width,e)},this):this.shapanbg.getChildByName("SandTableShow").getComponent(h.default).setSize(.7*this.shapanbg.width,e):l.default.instance.ShowMsg(c.default.getStr("\u6682\u65e0\u6c99\u76d8\u6570\u636e"))},t.prototype.close=function(){r.default.setNodeDestoryByUrl(this.shapanbg.children[0],p.GlobalContext.Root+"prefab/sandTable/SandTableShow"),e.prototype.close.call(this)},__decorate([a(cc.Node)],t.prototype,"shapanbg",void 0),t=__decorate([o],t)}(e("../../Core/Window").default);i.default=u,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/Window":"Window","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Scene/Controller/SceneController":"SceneController","../Tips/OpTipsController":"OpTipsController","./SandTableShow":"SandTableShow"}],SceneController:[function(e,t,i){"use strict";cc._RF.push(t,"7f174DrgPRJFJm0cBD+orLS","SceneController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Controller"),o=e("../Prop/EntityProperty"),a=e("../../../Core/GameEventDispatcher"),r=e("../../../Core/Event"),s=e("../View/ActorsLayer"),l=e("../Pool/ActorPools"),c=e("../../../Core/Const/EntityType"),d=e("../SceneEntity"),p=e("../Monster"),h=e("../View/FightView"),u=e("../Pool/SpinePools"),f=e("../../../Core/SpineBase"),g=e("../../../Global/GlobalValue"),y=e("../Manager/SceneManager"),m=e("../../../GlobalContext"),C=e("../Effect/FntSwingUtils"),v=e("../../../Core/WindowManager"),_=e("../../../Core/WindowType"),b=e("../../../Core/TimeController"),T=e("../../WarTeam/MonsterController"),S=e("./SkillController"),I=e("../Effect/AttackEffectUtils"),w=e("../../../Core/LoadManager"),D=e("../../LoadingPanel/LoadingPanel"),R=e("../View/SceneView"),A=e("../../Status/StatusType"),N=e("../View/ActorsBigSkillLayer"),L=e("../../../NetConnect/NetConnet"),E=e("../../Role/RoleController"),B=e("../../Role/RoleInfo"),M=e("../../SandTable/SandTableController"),x=e("./FightController"),k=e("../../Expedition/ExpeditionConfig"),P=e("../../Fight/staticattr"),G=e("../../Status/StatusController"),F=e("../Effect/BuffTypeEffectUtils"),W=e("../../OpenWin/OpenWinController"),U=e("../UIAnim/VariousAnim"),O=e("../Effect/ThundercloudEffect"),V=e("./FightTimeController"),q=e("../Effect/MonsterIndividualityUtils"),H=e("../../Buff/BuffController"),j=e("../Unit/FightLog"),K=e("./MonsterInitPointController"),Y=e("../BigSkill/SpecialEffectController"),z=e("./ZFController"),X=e("../../Chapter/ChapterController"),J=e("../../../Util/Utils"),Q=e("../../Tips/OpTipsController"),Z=e("../../PlotWin/PlotController"),$=e("../View/Chapter/ChapterMapView"),ee=e("../../TreasureMap/TreasureMapController"),te=e("../../Chat/ChatNoticeController"),ie=e("../../FridBoss/FridBossController"),ne=e("../View/Chapter/PlayerWealthControl"),oe=e("../../Role/RoleTitle/RoleTitleController"),ae=e("../../Guide/GuideNewController"),re=e("./SpecialSkillEffectController"),se=e("../../Gamelayer/GameLayer"),le=e("../../Arena/ArenaController"),ce=e("../../Functionicon/FunctionIconBtn"),de=e("../../Activity/ActivityController"),pe=e("../../Sound/SoundController"),he=e("./GuideFightController"),ue=e("../../Fight/FightUtils"),fe=cc._decorator,ge=fe.ccclass,ye=fe.property,me=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.SceneView=null,t.FightView=null,t.FightInfoView=null,t.fightinfoPanel=null,t.fightinfoPanelActive=!1,t.sceneScale=1,t.scenestatus=g.GameScene.Main,t.clearPoolResTimeOut=0,t.enterOffx=500,t.lasthandle=0,t.time=0,t.fightData=null,t.monsterEnterMoveTime=2,t.setRoleHpState=[A.ActivityStatus.TreasureMap],t.roleHps={},t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this),i.instance=this;var n=b.default.instance.setTimeout(function(){w.default.instance.loadResByType(m.GlobalContext.Root+"prefab/scene/Monster",cc.Prefab,function(e){l.ActorPools.monsterPre=e},t),w.default.instance.loadResByType(m.GlobalContext.Root+"prefab/scene/Player",cc.Prefab,function(e){l.ActorPools.playerPre=e},t),b.default.instance.clearTimeout(n)},this,1e3)},t.prototype.setFightInfoPanelActive=function(e){var t=this;this.fightinfoPanelActive=e,null==this.fightinfoPanel?e&&w.default.instance.loadResByType(m.GlobalContext.Root+"prefab/fightinfopanel/FightInfoPanel",cc.Prefab,function(e){var i=J.default.getNodeByUrl(e,m.GlobalContext.Root+"prefab/fightinfopanel/FightInfoPanel");t.fightinfoPanel=i,t.FightInfoView.addChild(t.fightinfoPanel),t.FightInfoView.active=t.fightinfoPanelActive},this):this.FightInfoView.active=this.fightinfoPanelActive},t.prototype.start=function(){var t=this;e.prototype.start.call(this),this.SceneView.active=!1,this.setFightInfoPanelActive(!1),this.scheduleOnce(function(){t.FightView.active=!1},.1)},t.prototype.listNotification=function(){a.GameEventDispatcher.instance.on(r.EventDefiner.C_Scene_Add_Actor,this.addActor,this),a.GameEventDispatcher.instance.on(r.EventDefiner.C_Scene_Actor_Prop_Change,this.actorPropChange,this),a.GameEventDispatcher.instance.on(r.EventDefiner.ChangeGameScene,this.changeGameScene,this),this.addProto("fightdata",this.getFightData,this)},t.prototype.getFightData=function(e){if(this.fightData=e,0==X.default.instance.currentGuanqiaId&&A.ActivityStatus.value==A.ActivityStatus.Chapter&&(this.fightData.data=null),j.default.log("\u83b7\u53d6\u602a\u7269\u4fe1\u606f",this.fightData.data),-1!=this.setRoleHpState.indexOf(A.ActivityStatus.value)&&(this.roleHps[A.ActivityStatus.value]=this.fightData.data?this.fightData.data.hp:0),this.scenestatus==g.GameScene.Fight&&y.default.instance.fightstatus!==y.FIGHTSTATUS.FIGHTEND){if(this.fightData.data){for(var t=A.ActivityStatus.value==A.ActivityStatus.TreasureMap?ee.default.instance.getFinalBuffList:[],i=0,n=this.fightData.data.reserve;i<n.length;i++){var o=n[i],s=T.MonsterType.MonsterWarTeam[T.MonsterType.MonsterBattle][o.id],l=this.getFightDataEntityInfo(s,o,t);a.GameEventDispatcher.instance.emit(r.EventDefiner.C_Scene_Add_Actor,l)}if(this.fightData.data.specialMonsters)for(var c=0,d=this.fightData.data.specialMonsters;c<d.length;c++){o=d[c];(l=this.getFightDataEntityInfo(o.id,o,t)).autoUseSkill=!1,l.attr=o.attr,j.default.log("\u6dfb\u52a0\u7279\u6b8a\u602a\u7269\uff1a",l),a.GameEventDispatcher.instance.emit(r.EventDefiner.C_Scene_Add_Actor,l)}if(this.fightData.data.table&&M.default.instance.setNowArr(this.fightData.data.table),A.ActivityStatus.value==A.ActivityStatus.TreasureMap){this.roleHps[A.ActivityStatus.value]=this.fightData.data.hp;var p=ee.default.instance.getReinforcement().concat();for(var u in p)a.GameEventDispatcher.instance.emit(r.EventDefiner.C_Scene_Add_Actor,p[u]);ee.default.instance.clearReinforment()}-1!=this.setRoleHpState.indexOf(A.ActivityStatus.value)&&this.addMyRole()}h.default.instance.getFightDataCom=!0,h.default.instance.checkFightdata()}else A.ActivityStatus.value==A.ActivityStatus.TotemsCopy&&a.GameEventDispatcher.instance.emit(r.EventDefiner.ToeamsCopyTableData,this.fightData),a.GameEventDispatcher.instance.emit(r.EventDefiner.ActivityStatus_GuanQia_Data,this.fightData);A.ActivityStatus.value==A.ActivityStatus.TreasureMap&&ee.default.instance.setFightData(this.fightData.data)},t.prototype.gerReserveData=function(e){var t=[];if(e&&e.length){var i=void 0;for(var n in e){var a=new o.EntityProperty;e[n].self=!0,i=T.MonsterType.MonsterWarTeam[T.MonsterType.MonsterBattle][e[n].id],e[n].cardid=i,a.init(c.EntityType.enMonster,e[n]),e[n].currentHp&&(a.hp=e[n].currentHp),t.push(a)}}return t},t.prototype.gerReserveReinData=function(e){var t=[];if(e&&e.length){for(var i in e){var n=new o.EntityProperty;e[i].self=!0,e[i].id&&(e[i].cardid=e[i].id),n.init(c.EntityType.enMonster,e[i]),e[i].currentHp&&(n.hp=e[i].currentHp),t.push(n)}}return t},t.prototype.sunFightDataFight=function(e,t){var i=0;if(e&&e.length){var n=void 0;for(var a in e){var r=new o.EntityProperty;e[a].self=!0,n=T.MonsterType.MonsterWarTeam[T.MonsterType.MonsterBattle][e[a].id],e[a].cardid=n,r.init(c.EntityType.enMonster,e[a]),e[a].currentHp&&(r.hp=e[a].currentHp),i+=r.currentFight}}if(t&&t.length){n=void 0;for(var a in t){r=new o.EntityProperty;t[a].self=!0,t[a].id&&(t[a].cardid=t[a].id),r.init(c.EntityType.enMonster,t[a]),t[a].currentHp&&(r.hp=t[a].currentHp),i+=r.currentFight}}return i},t.prototype.getFightDataEntityInfo=function(e,t,i){return{cardid:e,grade:t.grade,level:T.default.instance.getCurBattleInfo(e)+t.addlevel,num:1,self:!0,autoUseSkill:!1,skillcdDic:t.skillCdDic?t.skillCdDic:null,currentHp:t.currentHp,buffList:i,playeffect:!1,ismoveenter:!0,addtype:t.addtype}},t.prototype.addMyRole=function(e){if(void 0===e&&(e=!0),de.default.instance.isSetSandTab&&(e=!1),de.default.instance.isSetSandTab||G.default.instance.isSingle&&!y.default.instance.myRole&&A.ActivityStatus.value!=A.ActivityStatus.ThemeShop){var t=new o.EntityProperty;t.handle=this.allocHandle(),A.ActivityStatus.value==A.ActivityStatus.Guide?(t.handle=0,t.spineId=B.MyRoleInfo.sex?206:106):t.spineId=B.MyRoleInfo.currentsurface,y.default.instance.myRoleHandle=t.handle;var n=E.default.instance.getModelConfByModelId(t.spineId);t.maxHP=B.MyRoleInfo.MaxHp,t.hp=ue.FightUtils.getRoleHp(),t.moveSpeed=n.moveSpeed,t.dir=-1,t.originalName=B.MyRoleInfo.name,t.type=c.EntityType.enActor;var p=-y.default.instance.fightSceneWidth/2+120;e&&(p+=-this.enterOffx),t.x=p,t.y=-200,t.scale=n.scenescale,t.monsterConf=n,t.attr=B.MyRoleInfo.attr,t.skillList=S.default.instance.getSkills(t),y.default.instance.myRole=l.ActorPools.createPlayer(t);var h=y.default.instance.myRole.getComponent(d.default);h.onShowRoleTitle(oe.default.instence.roleUseTitleIcon),h.avatar.body.playRate=y.default.instance.fightViewPlayRate,j.default.log("\u6dfb\u52a0\u4e3b\u89d2"+B.MyRoleInfo.Fight,B.MyRoleInfo.attr,B.MyRoleInfo.prop),y.default.instance.leftFight+=B.MyRoleInfo.Fight,this.addEntitys(h),s.default.instance.addActorObj_toScene(h),a.GameEventDispatcher.instance.emit(r.EventDefiner.Fight_Power_Change);var u=i.instance.setCardEntity(t),f=y.default.instance.fightlogic.PushEntity(u);x.default.instance.updateFight(f)}},t.prototype.addActor=function(e){if(y.default.instance.fightstatus!=y.FIGHTSTATUS.FIGHTEND)if(he.default.instance.addMonster||he.default.instance.iscomplete){var t=e.getUserData(),n=!0;void 0!==t.playeffect&&(n=t.playeffect);for(var a=function(e){var a=new o.EntityProperty;a.addlevel=t.addlevel?t.addlevel:0,a.addtype=t.addtype?t.addtype:-1;var s=void 0;if(t.prop?a=t.prop:(a.init(c.EntityType.enMonster,t),t.currentHp>0&&A.ActivityStatus.value==A.ActivityStatus.TreasureMap&&(a.hp=t.currentHp)),t.self||(A.ActivityStatus.value==A.ActivityStatus.TreasureMap?ee.default.instance.onChangeAttrByCoefficient(a):A.ActivityStatus.value==A.ActivityStatus.FridBoss&&ie.default.instance.onChangeAttrByCoefficient(a),A.ActivityStatus.value!=A.ActivityStatus.MoneyDailyCopy&&a.setHP()),t.handle?a.handle=t.handle:a.handle=r.allocHandle(),a.hp<.9*a.maxHP&&a.otherAttr==g.OtherAttr.MaxHpchange)return{value:void 0};var d=y.default.instance.quanqiaId.toString();if(parseInt(d.charAt(d.length-1))<=4){var h=a.selfMonster?y.default.instance.leftentitys.length:y.default.instance.rightentitys.length;a.y=K.default.instance.getResetMonsterY(h+1)}if(t.skills)a.skillList=t.skills;else{var u=!0;void 0!==t.reinforcement&&(u=!1),a.skillList=S.default.instance.getSkills(a,null,u)}if(a.attr.skills=a.skillList,a.selfMonster?(a.x=-y.default.instance.fightSceneWidth/2+r.getActorRandX(T.default.instance.getCardConfCardType(a.cardid)),a.dir=-1,void 0===t.noaddfight&&(y.default.instance.leftFight+=a.fight)):(a.x=y.default.instance.fightSceneWidth/2-r.getActorRandX(T.default.instance.getCardConfCardType(a.cardid)),a.dir=1,void 0===!t.noaddfight&&(y.default.instance.rightFight+=a.fight)),void 0!==t.x&&t.x&&(a.x=t.x),void 0!==t.y&&t.y&&(a.y=t.y),t.ismoveenter&&(a.x+=a.selfMonster?-r.enterOffx:r.enterOffx),t.skillcdDic)for(var f in t.skillcdDic){var m={time:0,curusenum:t.skillcdDic[f].curusenum,allcanusenum:t.skillcdDic[f].allcanusenum,onewarusenum:0,onewarcanusenum:t.skillcdDic[f].onewarcanusenum};a.skillCdDic[f]=m}a.originalName=a.originalName,a.autobigskill=!!t.autoUseSkill&&t.autoUseSkill,(s=l.ActorPools.returnMonster(a).getComponent(p.default)).avatar.body.playRate=y.default.instance.fightViewPlayRate,r.playZHEffect(s,n);var C=i.instance.setCardEntity(a),v=y.default.instance.fightlogic.PushEntity(C);x.default.instance.updateFight(v),r.addBigSkillIcon(s,t.autoUseSkill);var _=0;if(a.skillList.forEach(function(e){_+=e.skilllv}),_=Math.max(1,(_-(a.skillList.length-3))/3),t.buffList)if(A.ActivityStatus.value==A.ActivityStatus.TreasureMap)b.default.instance.setTimeout(function(){if(ee.default.instance.isPlaySkill)for(var e in t.buffList){for(var i=y.default.instance.fightlogic.AddBuffByHandle(a.handle,t.buffList[e],_),n=0,o=i.result;n<o.length;n++){var r=o[n];x.default.instance.attackResultState(null,r),x.default.instance.attackResultEffect(null,r)}x.default.instance.updateFight(i.fight)}},r,500);else b.default.instance.setTimeout(function(){for(var e in j.default.log("\u6c99\u76d8\u9677\u9631\u6dfb\u52a0Buff"),t.buffList){for(var i=y.default.instance.fightlogic.AddBuffByHandle(a.handle,t.buffList[e],_),n=0,o=i.result;n<o.length;n++){var r=o[n];x.default.instance.attackResultState(null,r),x.default.instance.attackResultEffect(null,r)}x.default.instance.updateFight(i.fight)}},r,500)},r=this,s=0;s<t.num;s++){var d=a();if("object"==typeof d)return d.value}}else he.default.instance.checkAddMonster()},t.prototype.playZHEffect=function(e,t){if(this.addEntitys(e),s.default.instance.addActorObj_toScene(e),Z.default.instance.iscomplete||(e.node.opacity=0),e.avatar.node.active=!0,t){e.avatar.node.opacity=0,F.default.instance.addOneEffect(e,g.BuffEffectName.ZHAOHUAN2),F.default.instance.addOneEffect(e,g.BuffEffectName.ZHAOHUAN3),e.avatar.node.runAction(cc.sequence(cc.delayTime(.4),cc.fadeIn(.2)));var i=b.default.instance.setTimeout(function(){e.avatar.node.opacity=255,b.default.instance.clearTimeout(i)},this,500)}},t.prototype.checkCanUpMonster=function(){},t.prototype.removeSceneEntity=function(e){e.forEach(function(e){y.default.instance.leftlives.splice(y.default.instance.leftlives.indexOf(e.prop),1),y.default.instance.leftentitys.splice(y.default.instance.leftentitys.indexOf(e),1),y.default.instance.leftFight-=e.prop.fight,y.default.instance.leftPlayPrewarSkillEntity.splice(y.default.instance.leftPlayPrewarSkillEntity.indexOf(e),1),s.default.instance.removeActorObj_fromScene(e.prop.handle+""),e.recovery()}),this.checkCanUpMonster()},t.prototype.clearSkillCD=function(e){e.skillCdDic.forEach(function(e){e.onewarusenum=0,e.time=0})},t.prototype.addBigSkillIcon=function(e,t){void 0===t&&(t=!0);for(var i=0,n=e.prop.skillList;i<n.length;i++){var o=n[i],a=S.default.instance.getSkillBySkillId(o.skillid);if(a&&a.triggerway==g.TRIGGER_WAY.INITIATIVE){N.default.instance.addSkillBigIcon(e,o.skillid,o.skilllv,t);break}}},t.prototype.readyChangeMonsterHp=function(e,t){void 0===t&&(t=0);for(var i=y.default.instance.fightlogic.ChangeHp(1,e,t),n=0,o=i.result;n<o.length;n++){var a=o[n];x.default.instance.attackResultState(null,a),x.default.instance.attackResultEffect(null,a)}x.default.instance.updateFight(i.fight)},t.prototype.sandTableTrap=function(e,t,i,n){var o,s=this;void 0===n&&(n=null);var l=function(){for(var e=0,a=o.result;e<a.length;e++){var r=a[e];x.default.instance.attackResultState(null,r),x.default.instance.attackResultEffect(null,r)}x.default.instance.updateFight(o.fight),t&&t.apply(i,n)};if(e==g.SandTableTrapType.LEITING){for(var d,h=J.default.RandomBy(0,y.default.instance.rightentitys.length-1),m=y.default.instance.rightlives.sort(x.default.instance.sortSaveEntity)[0],C=0;C<y.default.instance.rightentitys.length;C++){var v=y.default.instance.rightentitys[C];if(v.prop.cardid==m.cardid){d=v;break}}var _=3,T=3,S=b.default.instance.setInterval(function(){T--,o=y.default.instance.fightlogic.ChangeHp(1,0,-1,d.prop.handle);var e=u.SpinePools.addCreateSpineNoder(Q.default.instance.node,Q.default.instance.node.convertToNodeSpaceAR(d.node.convertToWorldSpaceAR(new cc.Vec2(0,10)))),t=e.getComponent(f.default);e.scaleX=2,e.scaleY=2,console.log("\u96f7\u9706 ------------- ",e.position),t.initSpineData(g.SPINE_RES_DIR+"effect/sandtable/effect",null,"14shandian-leidian",!1),t.completeCallbackThisObj=s,t.completeCallbackParam=[e],t.completeCallback=function(e){var t=e.getComponent(f.default);t.initSpineData(g.SPINE_RES_DIR+"effect/sandtable/effect",null,"14shandian-shouji",!1),t.completeCallbackThisObj=s,t.completeCallbackParam=[e],t.completeCallback=function(e){if(_--,u.SpinePools.recoverCreateSpineNoder(e),_){for(var t=0,i=o.result;t<i.length;t++){var n=i[t];x.default.instance.attackResultState(null,n),x.default.instance.attackResultEffect(null,n)}x.default.instance.updateFight(o.fight)}else l()}},T||b.default.instance.clearInterval(S)},this,400)}else if(e==g.SandTableTrapType.WODI){h=J.default.RandomBy(0,y.default.instance.rightentitys.length-1);var I=y.default.instance.rightentitys[h];I.node.runAction(cc.sequence(cc.bezierTo(1,[cc.v2(I.prop.x-100,I.prop.y),cc.v2(0,I.prop.y+400),cc.v2(-I.prop.x,I.prop.y)]),cc.callFunc(function(e){I.prop.specialMonster=!0,I.prop.x=-I.prop.x,I.getComponent(p.default).avatar.changeDir(-I.prop.dir),s.sandTableWoDiEntity(I),I.prop.selfMonster=!0,I.setMonsterBarState(),o=y.default.instance.fightlogic.SandTableChangeMonsterCamp(I.prop.handle),l()},this)))}else if(e==g.SandTableTrapType.WUSHU){var w=function(){var e=J.default.RandomBy(0,1)?y.default.instance.leftentitys:y.default.instance.rightentitys,t=e[J.default.RandomBy(0,e.length-1)];return t.prop.type==c.EntityType.enActor&&(t=w()),t},D=w(),R=D.prop;R.grade=1,R.cultivateLv=1;var A={cardid:R.cardid,grade:1,level:1,num:1,self:R.selfMonster,x:R.x,y:R.y,playeffect:!0,autoUseSkill:!!D.autoUseSkillList,skillcdDic:R.skillCdDic};this.clearEntity(D),a.GameEventDispatcher.instance.emit(r.EventDefiner.C_Scene_Add_Actor,A);var N=b.default.instance.setTimeout(function(){t&&t.apply(i,n),b.default.instance.clearTimeout(N)},this,500)}},t.prototype.clearEntity=function(e){var t=y.default.instance,i=t.rightlives,n=t.rightentitys,o=t.rightPlayPrewarSkillEntity;e.prop.selfMonster?(t.leftFight-=e.prop.fight,i=t.leftlives,n=t.leftentitys,o=t.leftPlayPrewarSkillEntity):t.rightFight-=e.prop.fight,o.splice(t.rightPlayPrewarSkillEntity.indexOf(e),1),i.splice(i.indexOf(e.prop),1),n.splice(n.indexOf(e),1),s.default.instance.removeActorObj_fromScene(e.prop.handle+""),e.recovery(),x.default.instance.updateFight(t.fightlogic.RemoveEntity(e.prop.handle))},t.prototype.sandTableWoDiEntity=function(e){var t=0,i=y.default.instance;e.prop.selfMonster?(t=i.leftPlayPrewarSkillEntity.indexOf(e),i.leftPlayPrewarSkillEntity.splice(t,1),t=i.leftdeadentitys.indexOf(e),i.leftdeadentitys.splice(t,1),t=i.leftentitys.indexOf(e),i.leftentitys.splice(t,1),t=i.leftlives.indexOf(e.prop),i.leftlives.splice(t,1),y.default.instance.rightentitys.push(e),y.default.instance.rightlives.push(e.prop),this.addPlayPrewarSkillEntity(y.default.instance.rightPlayPrewarSkillEntity,e)):(t=i.rightPlayPrewarSkillEntity.indexOf(e),i.rightPlayPrewarSkillEntity.splice(t,1),t=i.rightdeadentitys.indexOf(e),i.rightdeadentitys.splice(t,1),t=i.rightentitys.indexOf(e),i.rightentitys.splice(t,1),t=i.rightlives.indexOf(e.prop),i.rightlives.splice(t,1),y.default.instance.leftentitys.push(e),y.default.instance.leftlives.push(e.prop),this.addPlayPrewarSkillEntity(y.default.instance.leftPlayPrewarSkillEntity,e))},t.prototype.enterTreasureMap=function(e,t){if(ee.default.instance.nowType=e,e==ee.default.instance.Event_Type_Campsite)W.default.instance.openWindow(_.WindowType.SandTable);else if(e==ee.default.instance.Event_Type_medical||e==ee.default.instance.Event_Type_Trap)var i=b.default.instance.setInterval(function(){if(y.default.instance.fightlogic){for(var e=0,n=y.default.instance.fightlogic.ChangeHp(0,0,t).result;e<n.length;e++){var o=n[e];x.default.instance.attackResultState(null,o),x.default.instance.attackResultEffect(null,o)}b.default.instance.clearInterval(i)}a.GameEventDispatcher.instance.emit(r.EventDefiner.C_Fight_Start)},this,1e3+1e3*this.monsterEnterMoveTime);else if(e==ee.default.instance.Event_Type_Monster||e==ee.default.instance.Event_Type_Elite)b.default.instance.setTimeout(function(){a.GameEventDispatcher.instance.emit(r.EventDefiner.C_Fight_Start)},this,1e3+1e3*this.monsterEnterMoveTime);else if(e==ee.default.instance.Event_Type_Boss)b.default.instance.setTimeout(function(){a.GameEventDispatcher.instance.emit(r.EventDefiner.TreasureDialog)},this,1e3+1e3*this.monsterEnterMoveTime)},t.prototype.requestFightData=function(e,t){var i;switch(e){case A.ActivityStatus.Chapter:i={cmd:"loadfightdata",key:A.ActivityStatus.Chapter},L.default.instance.sendProto(i);break;case A.ActivityStatus.TreasureMap:ee.default.instance.treasureLevel>1||ee.default.instance.FightNum!=ee.default.instance.Event_Type_Campsite||ee.default.instance.isOpenMainView?(i={cmd:"loadfightdata",key:A.ActivityStatus.TreasureMap+""},L.default.instance.sendProto(i)):this.addMyRole();break;case A.ActivityStatus.Expedition:i=t?{cmd:"loadfightdata",key:A.ActivityStatus.value+"_"+(t-1)}:{cmd:"loadfightdata",key:A.ActivityStatus.value+"_"+(k.ExpeditionConfig.current-1)},L.default.instance.sendProto(i);break;case A.ActivityStatus.TotemsCopy:i={cmd:"loadfightdata",key:A.ActivityStatus.TotemsCopy},L.default.instance.sendProto(i)}j.default.log("loadfightdata",i)},t.prototype.changeGameScene=function(e){var t=e.getUserData();j.default.log("shuju",t);var i=this.scenestatus;U.default.instance.oldStatus=i,this.scenestatus=Number(t.status);var n=t.guanqiaId||1;switch(y.default.instance.quanqiaId=n,i==this.scenestatus&&i==g.GameScene.Main?j.default.log("\u4ece\u4e3b\u573a\u666f\u518d\u5207\u4e00\u6b21\u4e3b\u573a\u666f\uff0c\u4e0d\u7528\u52a0\u8f7d\u9875\u4e86"):(j.default.log("changeGameScene, \u5207\u6362\u573a\u666f, status:"+this.scenestatus+", oldStatus:"+i),this.changeScene(this.scenestatus,t)),this.scenestatus){case g.GameScene.Scene:var o=t.type||1;this.SceneView.getComponent(R.default).showType(o);break;case g.GameScene.Fight:y.default.instance.fightstatus=y.FIGHTSTATUS.NONE,I.default.instance.initPre(),te.default.instance.Clear();var s=X.default.instance.currentChapterId,l=X.default.instance.guanqiaIndex;j.default.log("guanqiaId:"+n),ae.default.instance.checkCondition(18),b.default.instance.setTimeout(function(){a.GameEventDispatcher.instance.emit(r.EventDefiner.C_Scene_EnterScene,{chapter:s,section:l,guanqiaId:n})},this,500)}},t.prototype.inchangeScene=function(){se.default.instance&&ce.default.instance&&(2==this.scenestatus?ce.default.instance.node.y=-285:1==this.scenestatus&&(ce.default.instance.node.y=-195))},t.prototype.changeScene=function(e,t){var n=this;if(void 0===t&&(t=null),m.PlayerData.GameLayer)if(j.default.log("\u5207\u6362\u573a\u666f, status:"+e),v.default.instance.closeAll(),e==g.GameScene.Main)pe.default.instance.PlayBGM(pe.SoundType.mainBG),D.default.instance.showSceneLoadingFinish(-1,0),m.PlayerData.TopPanel&&(m.PlayerData.GameLayer.insertChild(m.PlayerData.TopPanel,m.PlayerData.GameLayer.childrenCount),a.GameEventDispatcher.instance.emit(r.EventDefiner.PlayerWealthBG,!1)),m.PlayerData.GameLayer.active=!0,U.default.instance.openScene(),this.SceneView.active=!1,this.FightView.active=!1,this.setFightInfoPanelActive(!1),T.default.instance.setIsUpdateInfo(),E.default.instance.RoleUpgrading(),a.GameEventDispatcher.instance.emit(r.EventDefiner.CheckDailyGuide,1);else if(e==g.GameScene.Scene){this.SceneView.active=!1,this.FightView.active=!1,X.default.instance.openWin&&(W.default.instance.openWindow(X.default.instance.openWin),X.default.instance.openWin=null),function(){D.default.instance.showSceneLoading(50,5e3,0),m.PlayerData.TopPanel&&(m.PlayerData.GameLayer.insertChild(m.PlayerData.TopPanel,m.PlayerData.GameLayer.childrenCount),a.GameEventDispatcher.instance.emit(r.EventDefiner.PlayerWealthBG,!0)),m.PlayerData.GameLayer.active=!0,U.default.instance.onOpenFiveAnim();var e=b.default.instance.setTimeout(function(){n.SceneView.active=!0,b.default.instance.clearTimeout(e)},n,500);n.FightView.active=!1,n.setFightInfoPanelActive(!1),D.default.instance.hideCompleteCallbackThisObj=n,D.default.instance.hideCompleteCallback=function(){t.isFightBack?y.default.instance.fightresult&&Z.default.instance.checkPlot(Z.PlotType.ExitChapter):$.default.instance.checkPlotReady(),$.default.instance.canOpenRewardTips()}}()}else e==g.GameScene.Fight&&(G.default.instance.isSingle?h.default.instance.SetFightViewPlayRate(y.default.instance.oldfightViewPlayRate):h.default.instance.SetFightViewPlayRate(1),D.default.instance.showSceneLoading(50,5e3,0),A.ActivityStatus.value==A.ActivityStatus.Chapter&&Z.default.instance.checkPlot(Z.PlotType.FightBefore,function(){v.default.instance.open(_.WindowType.SandTable),i.instance.playMonsterEnter()},this),m.PlayerData.TopPanel&&(m.PlayerData.GameLayer.insertChild(m.PlayerData.TopPanel,m.PlayerData.GameLayer.childrenCount),ne.default.instance.onSetBGActive(!1)),m.PlayerData.GameLayer.active=!1,this.setFightInfoPanelActive(!0),this.SceneView.active=!1,this.FightView.active=!0,A.ActivityStatus.Arena==A.ActivityStatus.value&&le.default.instance.sendcliententer(),this.clearPoolResTimeOut&&(b.default.instance.clearTimeout(this.clearPoolResTimeOut),this.clearPoolResTimeOut=0))},t.prototype.realyShow=function(){v.default.instance.showAll()},t.prototype.playMonsterEnter=function(e){void 0===e&&(e=!0);var t=!0;if(e&&(t=Z.default.instance.iscomplete),t)for(var i=function(e){var t=s.default.instance.entities[e];t.setPlayRate(1);var i=t.prop.selfMonster?-n.enterOffx:n.enterOffx;t.node.opacity=0,t.setCompleteAnimation(g.ACTION.WALK),t.playAnimation(g.ACTION.WALK),t.avatar.body.spine.loop=!0,t.node.runAction(cc.sequence(cc.spawn(cc.moveBy(n.monsterEnterMoveTime,new cc.Vec2(-i,0)),cc.fadeIn(.5)),cc.callFunc(function(){t.setPlayRate(y.default.instance.fightViewPlayRate),t.node.opacity=255,t.prop.x=t.x,y.default.instance.fightstatus!=y.FIGHTSTATUS.FIGHT&&t.playAnimation(g.ACTION.STAND),t.setCompleteAnimation(g.ACTION.STAND)},n)))},n=this,o=0,a=Object.keys(s.default.instance.entities);o<a.length;o++){i(a[o])}},t.prototype.clear=function(e){void 0===e&&(e=!1),re.default.instance.allcom(),C.default.instance.recoveryAll(),O.default.instance.removeAll(),Y.default.instance.removeAll(),y.default.instance.clear(),q.default.instance.clearAll(),H.default.instance.clearAllBuff(),K.default.instance.clear(),this.clearInjuredEffects(),z.default.instance.clearAll(),N.default.instance.clear();var t=b.default.instance.setTimeout(function(){I.default.instance.recoveryAll(),y.default.instance.myRole=null,y.default.instance.otherRole=null,V.default.instance.clearAll(),b.default.instance.clearTimeout(t)},this,100);this.clearPoolResTimeOut||b.default.instance.setTimeout(this.clearFightResPool,this,e?200:y.default.instance.clearResPoolTime)},t.prototype.clearFightResPool=function(){j.default.log("\u6e05\u7406\u6218\u6597buff\u9884\u5236\u4f53\u8d44\u6e90"),this.clearPoolResTimeOut=0,J.default.clearPoolToType(_.PoolType.BuffCell),J.default.clearPoolToType(_.PoolType.BuffTip),I.default.instance.clearPool(),C.default.instance.clearAll(),u.SpinePools.clearAll(),l.ActorPools.clearAll()},t.prototype.clearAll=function(){y.default.instance.clearLeftlives(),this.clear()},t.prototype.clearInjuredEffects=function(){for(var e=0,t=y.default.instance.injuredEffects;e<t.length;e++){var i=t[e];u.SpinePools.recoverSpineNoder(i)}y.default.instance.injuredEffects.length=0},t.prototype.updateInjureEffectsPlayRate=function(){for(var e=0,t=y.default.instance.injuredEffects;e<t.length;e++){t[e].getComponent(f.default).playRate=y.default.instance.fightViewPlayRate}},t.prototype.getactorByHandle=function(e){for(var t=0,i=y.default.instance.rightentitys;t<i.length;t++){if((a=i[t]).prop.handle==e)return a}for(var n=0,o=y.default.instance.leftentitys;n<o.length;n++){var a;if((a=o[n]).prop.handle==e)return a}return null},t.prototype.addEntitys=function(e){y.default.instance.fightCaridEntityDic[e.prop.cardid]||(y.default.instance.fightCaridEntityDic[e.prop.cardid]=[]),y.default.instance.fightCaridEntityDic[e.prop.cardid].push(e),e.prop.selfMonster?(y.default.instance.leftentitys.push(e),e.prop.type==c.EntityType.enMonster&&y.default.instance.leftlives.push(e.prop),this.addPlayPrewarSkillEntity(y.default.instance.leftPlayPrewarSkillEntity,e)):(y.default.instance.rightentitys.push(e),e.prop.type==c.EntityType.enMonster&&y.default.instance.rightlives.push(e.prop),this.addPlayPrewarSkillEntity(y.default.instance.rightPlayPrewarSkillEntity,e)),w.default.instance.loadResByType(e.prop.getAttackEffectUrl(),sp.SkeletonData,null,null),e.setPlayRate(y.default.instance.fightViewPlayRate)},t.prototype.setCardEntity=function(e,t){void 0===t&&(t=1);var i=new P.StaticAttr;i=e.attr;var n={handle:e.handle,camp:e.selfMonster?0:1,hp:e.hp,prop:e,attr:i};return j.default.log("\u6dfb\u52a0\u602a\u7269:",n.handle,n.attr,n.hp),n},t.prototype.addPlayPrewarSkillEntity=function(e,t){if(e[t.prop.cardid]){var i=e[t.prop.cardid];i.prop.grade<t.prop.grade?i=t:i.prop.grade==t.prop.grade&&i.prop.cultivateLv<t.prop.cultivateLv&&(i=t)}else e[t.prop.cardid]=t},t.prototype.actorPropChange=function(e){e.getUserData()},t.prototype.allocHandle=function(){var e=Date.now();return this.lasthandle<e?this.lasthandle=e:this.lasthandle++,this.lasthandle},t.prototype.getActorRandX=function(e){var t=0;switch(e){case 1:t=201+200*Math.random();break;case 2:t=151+150*Math.random();break;case 3:t=1+200*Math.random()}return t},t.prototype.addTestMyRole=function(e,t){void 0===t&&(t=!1);var n=new o.EntityProperty;n.handle=this.allocHandle(),n.spineId=B.MyRoleInfo.currentsurface,y.default.instance.myRoleHandle=n.handle;var p=E.default.instance.getModelConfByModelId(n.spineId);n.moveSpeed=p.moveSpeed,n.dir=-1,n.originalName=B.MyRoleInfo.name,n.type=c.EntityType.enActor;var h=-y.default.instance.fightSceneWidth/2+120;t&&(h+=-this.enterOffx),n.x=h,n.y=-200,n.scale=p.scenescale,n.monsterConf=p,n.attr=e,n.skillList=S.default.instance.getSkills(n),y.default.instance.myRole=l.ActorPools.createPlayer(n);var u=y.default.instance.myRole.getComponent(d.default);u.onShowRoleTitle(oe.default.instence.roleUseTitleIcon),u.avatar.body.playRate=y.default.instance.fightViewPlayRate,y.default.instance.leftFight+=n.attr.fight,this.addEntitys(u),s.default.instance.addActorObj_toScene(u),a.GameEventDispatcher.instance.emit(r.EventDefiner.Fight_Power_Change);var f=i.instance.setCardEntity(n),g=y.default.instance.fightlogic.PushEntity(f);x.default.instance.updateFight(g)},t.instance=null,__decorate([ye(cc.Node)],t.prototype,"SceneView",void 0),__decorate([ye(cc.Node)],t.prototype,"FightView",void 0),__decorate([ye(cc.Node)],t.prototype,"FightInfoView",void 0),t=i=__decorate([ge],t)}(n.default);i.default=me,cc._RF.pop()},{"../../../Core/Const/EntityType":"EntityType","../../../Core/Controller":"Controller","../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/LoadManager":"LoadManager","../../../Core/SpineBase":"SpineBase","../../../Core/TimeController":"TimeController","../../../Core/WindowManager":"WindowManager","../../../Core/WindowType":"WindowType","../../../Global/GlobalValue":"GlobalValue","../../../GlobalContext":"GlobalContext","../../../NetConnect/NetConnet":"NetConnet","../../../Util/Utils":"Utils","../../Activity/ActivityController":"ActivityController","../../Arena/ArenaController":"ArenaController","../../Buff/BuffController":"BuffController","../../Chapter/ChapterController":"ChapterController","../../Chat/ChatNoticeController":"ChatNoticeController","../../Expedition/ExpeditionConfig":"ExpeditionConfig","../../Fight/FightUtils":"FightUtils","../../Fight/staticattr":"staticattr","../../FridBoss/FridBossController":"FridBossController","../../Functionicon/FunctionIconBtn":"FunctionIconBtn","../../Gamelayer/GameLayer":"GameLayer","../../Guide/GuideNewController":"GuideNewController","../../LoadingPanel/LoadingPanel":"LoadingPanel","../../OpenWin/OpenWinController":"OpenWinController","../../PlotWin/PlotController":"PlotController","../../Role/RoleController":"RoleController","../../Role/RoleInfo":"RoleInfo","../../Role/RoleTitle/RoleTitleController":"RoleTitleController","../../SandTable/SandTableController":"SandTableController","../../Sound/SoundController":"SoundController","../../Status/StatusController":"StatusController","../../Status/StatusType":"StatusType","../../Tips/OpTipsController":"OpTipsController","../../TreasureMap/TreasureMapController":"TreasureMapController","../../WarTeam/MonsterController":"MonsterController","../BigSkill/SpecialEffectController":"SpecialEffectController","../Effect/AttackEffectUtils":"AttackEffectUtils","../Effect/BuffTypeEffectUtils":"BuffTypeEffectUtils","../Effect/FntSwingUtils":"FntSwingUtils","../Effect/MonsterIndividualityUtils":"MonsterIndividualityUtils","../Effect/ThundercloudEffect":"ThundercloudEffect","../Manager/SceneManager":"SceneManager","../Monster":"Monster","../Pool/ActorPools":"ActorPools","../Pool/SpinePools":"SpinePools","../Prop/EntityProperty":"EntityProperty","../SceneEntity":"SceneEntity","../UIAnim/VariousAnim":"VariousAnim","../Unit/FightLog":"FightLog","../View/ActorsBigSkillLayer":"ActorsBigSkillLayer","../View/ActorsLayer":"ActorsLayer","../View/Chapter/ChapterMapView":"ChapterMapView","../View/Chapter/PlayerWealthControl":"PlayerWealthControl","../View/FightView":"FightView","../View/SceneView":"SceneView","./FightController":"FightController","./FightTimeController":"FightTimeController","./GuideFightController":"GuideFightController","./MonsterInitPointController":"MonsterInitPointController","./SkillController":"SkillController","./SpecialSkillEffectController":"SpecialSkillEffectController","./ZFController":"ZFController"}],SceneEntity:[function(e,t,i){"use strict";cc._RF.push(t,"95c39UUvv1PM76gFyGcCGDJ","SceneEntity"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./Avater/AvatarBase"),o=e("../../Core/Const/SAttributeConst"),a=e("../../Util/ComFun"),r=e("./LayerableCompent"),s=e("../../Global/GlobalValue"),l=e("../../Util/Parabola"),c=e("./Manager/SceneManager"),d=e("../WarTeam/MonsterController"),p=e("../../Core/Const/EntityType"),h=e("../Role/RoleController"),u=e("../Buff/BuffController"),f=e("../Buff/BuffCell"),g=e("../../Core/TimeController"),y=e("../../Util/Scene/MoveUtil"),m=e("../../GlobalContext"),C=cc._decorator,v=C.ccclass,_=C.property,b=function(e){function t(){var t=e.call(this)||this;return t.handle=0,t.masterHandle=0,t._isShowBloodBar=!0,t._isLive=!0,t.hitStatus=s.HIT_STATUS.NONE,t.isDraging=!1,t.autoUseSkillList=[],t.playPrewarSkillNums=[],t._tauntTagets=[],t.avatar=null,t.bloodBar=null,t.shieldBar=null,t.singBar=null,t.nameLabel=null,t.actorstatus=null,t.fightpanel=null,t.qiPao=null,t.qiPaoLabel=null,t.buffbox=null,t._parabola=null,t.delayNum=0,t.attackEntity=null,t.showFigure=!0,t.flytime=0,t.flyBackTime=0,t._playRate=1,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this)},Object.defineProperty(t.prototype,"isLive",{get:function(){return!!this.prop&&this.prop.isLive},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isShowBloodBar",{get:function(){return this._isShowBloodBar},set:function(e){this._isShowBloodBar=e,e||this.setBloodVisible(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"prop",{get:function(){return this._prop},set:function(e){null!=e&&(this.isShowBloodBar=!0,this.avatar.visible=!0,this.avatar.body.readlySpineCall=this.readlyComplete,this.avatar.body.readlySpineCallThisObj=this,this._prop=e,this.prop.isLive=!0,this.delayNum=this._prop.handle%2,this.worldX=e.x,this.worldY=e.y,this.x=e.x,this.y=e.y,this.updateBloodBarHp(),this.actorstatus&&(this.actorstatus.node.active=!1,this.actorstatus.node.setScale(this.prop.scale)),this.avatar.scaleBody(this.prop.scale),this.prop.type==p.EntityType.enMonster?(this.avatar.height=d.default.instance.getCardGradeByGradeConf(this.prop.cardid,this.prop.grade).height*this.prop.scale,this.avatar.width=d.default.instance.getCardGradeByGradeConf(this.prop.cardid,this.prop.grade).width*this.prop.scale,this.hideQiPao()):this.prop.type==p.EntityType.enActor&&(this.avatar.height=h.default.instance.getModelConfByModelId(this.prop.spineId).height*this.prop.scale,this.avatar.width=h.default.instance.getModelConfByModelId(this.prop.spineId).width*this.prop.scale),this.prop.selfMonster?this.bloodBar.barSprite.spriteFrame=this.fightpanel.getSpriteFrame("hpbar2"):this.bloodBar.barSprite.spriteFrame=this.fightpanel.getSpriteFrame("hpbar1"),this.setColor())},enumerable:!0,configurable:!0}),t.prototype.setMonsterBarState=function(){this.bloodBar.barSprite.spriteFrame=this.fightpanel.getSpriteFrame("hpbar2")},t.prototype.readlyComplete=function(){this.updateName()},t.prototype.updateName=function(){this.nameLabel.string=this.prop.originalName,this.bloodBar.node.y=this.height,this.shieldBar&&(this.shieldBar.node.y=this.height),this.buffbox&&(this.buffbox.y=this.shieldBar.node.y+this.shieldBar.node.height),this.nameLabel.node.y=this.bloodBar.node.y+this.bloodBar.node.height},Object.defineProperty(t.prototype,"width",{get:function(){var e=0;return this.avatar&&(e=this.avatar.width),e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){var e=0;return this.avatar&&(e=this.avatar.height),e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dir",{get:function(){var e=s.DIR.RIGHT;return this.avatar&&(e=this.avatar.dir),e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"status",{get:function(){var e=s.ACTION.NONE;return this.avatar&&(e=this.avatar.status),e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isExist",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canMove",{get:function(){var e=!1;return this.prop&&(e=(140&this.prop.getProperty(o.SAttributeConst.PROP_CREATURE_STATE))<=0),e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hp",{get:function(){return this.prop.hp},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxHp",{get:function(){return this.prop.maxHP},enumerable:!0,configurable:!0}),t.prototype.recovery=function(){this.dispose()},t.prototype.dispose=function(){this.clear(),this.bloodBar&&(this.bloodBar.destroy(),this.bloodBar=null),this.avatar&&(this.avatar.dispose(),this.avatar=null),e.prototype.dispose.call(this)},t.prototype.clear=function(){this.avatar&&this.avatar.clear(),this.parabola&&this.parabola.clear(),this.prop&&(this.prop=null),this.clearfly()},Object.defineProperty(t.prototype,"parabola",{get:function(){return null==this._parabola&&(this._parabola=new l.default,this._parabola.targetNode=this.node),this._parabola},enumerable:!0,configurable:!0}),t.prototype.parabolaTwoComCall=function(){this.hitStatus=s.HIT_STATUS.NONE,this.parabola.clear()},t.prototype.parabolaComCall=function(){if(this.hitStatus!=s.HIT_STATUS.STRIKEFLY&&this.hitStatus!=s.HIT_STATUS.STRIKEFLYBACK||this.clearfly(),this.hitStatus==s.HIT_STATUS.DRAP){this.parabola.clear(),this.parabola.onCompleteCallback=this.parabolaTwoComCall,this.parabola.onCompleteCallbackThisObj=this,this.hitStatus=s.HIT_STATUS.DRAP;var e=this.node.position.x+100*this.dir,t=1/c.default.instance.fightViewPlayRate*.3,i=cc.v2(this.node.position.x,this.node.position.y),n=cc.v2(e,this.node.position.y);return this.parabola.MoveBySpeed(i,n,0,!1,t),void(this.prop.x=e)}this.hitStatus=s.HIT_STATUS.NONE,this.parabola.clear()},t.prototype.clearfly=function(){g.default.instance.clearInterval(this.flytime),g.default.instance.clearInterval(this.flyBackTime),this.updateBloodBarHp(),this.avatar.node.y=0,this.flytime=0,this.flyBackTime=0,this.avatar.node.parent.rotation=0},t.prototype.clearParabola=function(){},t.prototype.disappear=function(){if(this.hitStatus==s.HIT_STATUS.NONE){this.parabola.clear(),this.parabola.onCompleteCallback=this.parabolaComCall,this.parabola.onCompleteCallbackThisObj=this;var e=0,t=0,i=0;this.prop.selfMonster?(e=-200,t=Math.max(this.node.position.x+e/2,-m.GlobalContext.UIWidth/2),i=Math.max(this.node.position.x+e,-m.GlobalContext.UIWidth/2)):(e=200,t=Math.min(this.node.position.x+e/2,m.GlobalContext.UIWidth/2),i=Math.min(this.node.position.x+e,m.GlobalContext.UIWidth/2));var n=cc.v2(t,this.node.position.y+250),o=cc.v2(i,this.node.position.y);this.prop.x=i,this.parabola.MoveBySpeed(n,o,800/c.default.instance.fightViewPlayRate)}},t.prototype.back=function(e){this.parabola.clear(),this.parabola.onCompleteCallback=this.parabolaComCall,this.parabola.onCompleteCallbackThisObj=this;var t=0,i=0;if(e>this.prop.x){if(t=-125,this.node.position.x+t-this.width/2<-812)return;i=Math.max(this.node.position.x+t-this.width/2,-812)}else{if(t=125,this.node.position.x+t+this.width/2>812)return;i=Math.min(this.node.position.x+t+this.width/2,812)}var n=cc.v2(this.node.position.x,this.node.position.y),o=cc.v2(i,this.node.position.y),a=c.default.instance.specialskillstatus==s.SPECIAL_SKILL_STATUS.COMBO?1:1e3;this.parabola.MoveBySpeed(n,o,a/c.default.instance.fightViewPlayRate,!0),this.prop.x=i,this.hitStatus=s.HIT_STATUS.REPEL},t.prototype.strikeFly=function(){var e=this;if(this.hitStatus==s.HIT_STATUS.STRIKEFLY){var t=0;this.prop.selfMonster?Math.max(this.parabola.nodex+t,-m.GlobalContext.UIWidth/2):Math.min(this.parabola.nodex+t,m.GlobalContext.UIWidth/2);cc.v2(this.parabola.nodex,this.parabola.nodey);var i=cc.v2(this.prop.x,this.parabola.nodey+300),n=cc.v2(this.prop.x,this.prop.y);this.parabola.MoveBySpeed(i,n,4/c.default.instance.fightViewPlayRate,!1,2/(3*c.default.instance.fightViewPlayRate))}else{this.clearfly(),this.parabola.clear(),this.parabola.onCompleteCallback=this.parabolaComCall,this.parabola.onCompleteCallbackThisObj=this;t=0,i=cc.v2(this.prop.x,this.node.position.y+400),n=cc.v2(this.prop.x,this.prop.y);this.parabola.MoveBySpeed(i,n,4/c.default.instance.fightViewPlayRate,!1,2/(3*c.default.instance.fightViewPlayRate)),this.hitStatus=s.HIT_STATUS.STRIKEFLY,this.avatar.node.y=-this.avatar.height/2;this.flytime=g.default.instance.setInterval(function(){e.flyBackTime&&(e.avatar.node.parent.rotation+=1==e.dir?30:-30,e.setBloodVisible(!1))},this,10)}},t.prototype.strikeFlyBack=function(e){var t=this,i=e>this.prop.x?-125:125,n=this.prop.x+i;if(e>this.prop.x?n-this.width/2<-m.GlobalContext.UIWidth/2&&(n=(-m.GlobalContext.UIWidth+this.width)/2):n+this.width/2>m.GlobalContext.UIWidth/2&&(n=(m.GlobalContext.UIWidth-this.width)/2),this.hitStatus==s.HIT_STATUS.STRIKEFLYBACK){cc.v2(this.parabola.nodex,this.parabola.nodey);var o=cc.v2(this.prop.x,this.parabola.nodey+300),a=cc.v2(n,this.prop.y);this.parabola.MoveBySpeed(o,a,4/c.default.instance.fightViewPlayRate,!1,2/(3*c.default.instance.fightViewPlayRate)),this.prop.x=n}else{this.clearfly(),this.parabola.clear(),this.parabola.onCompleteCallback=this.parabolaComCall,this.parabola.onCompleteCallbackThisObj=this;o=cc.v2(this.prop.x,this.node.position.y+300),a=cc.v2(n,this.prop.y);if(this.parabola.MoveBySpeed(o,a,4/c.default.instance.fightViewPlayRate,!1,2/(3*c.default.instance.fightViewPlayRate)),this.hitStatus=s.HIT_STATUS.STRIKEFLYBACK,this.prop.grade<=3){this.avatar.node.y=-this.avatar.height/2;this.flyBackTime=g.default.instance.setInterval(function(){t.flyBackTime&&(t.avatar.node.parent.rotation+=1==t.dir?30:-30,t.setBloodVisible(!1))},this,10)}this.prop.x=n}},t.prototype.movex=function(e,t){this.parabola.clear(),this.parabola.onCompleteCallback=this.parabolaComCall,this.parabola.onCompleteCallbackThisObj=this;var i=0,n=this.getPlayRate();if(1==t){if(y.MoveUtil.getPixelDis(e,0,this.prop.x,0)<100)return;i=e>this.prop.x?e-100:e+100,this.hitStatus=s.HIT_STATUS.DRAP,n=1/c.default.instance.fightViewPlayRate*.2}else 2==t&&(i=e,this.hitStatus=s.HIT_STATUS.IMPACT,n=1/c.default.instance.fightViewPlayRate*.2);var o=cc.v2(this.node.position.x,this.node.position.y),a=cc.v2(i,this.node.position.y);this.parabola.MoveBySpeed(o,a,0,!1,n),this.prop.x=i},t.prototype.lookAt=function(e){this.changeDir(a.ComFun.getDiretion(this.worldX,this.worldY,e.worldX,e.worldY))},t.prototype.updateSit=function(e,t){this.worldX=e,this.worldY=t,this.node.x=this.worldX,this.node.y=this.worldY},t.prototype.setColor=function(){},t.prototype.setBloodVisible=function(e){this.bloodBar&&(this.bloodBar.node.active=e&&this.isShowBloodBar),this.buffbox,this.setShieldVisible(e)},t.prototype.setShieldVisible=function(e){this.shieldBar&&(this.shieldBar.node.active=e&&this.isShowBloodBar)},t.prototype.setSingVisible=function(e){this.singBar&&(this.singBar.node.active=e)},t.prototype.setNameVisible=function(e){this.nameLabel&&(this.nameLabel.node.active=!1)},t.prototype.updateBloodBarHp=function(){if(this.bloodBar){var e=u.default.instance.buffdic[this.prop.handle];this.setBloodVisible(this.prop.hp>0&&this.prop.hp!=this.prop.maxHP||this.prop.shield>0||e),this.bloodBar.progress=this.prop.hp/(this.prop.maxHP+this.prop.shield),this.updateHp(this.prop.hp),this.updateShieldBarHp()}},t.prototype.updateShieldBarHp=function(){if(this.shieldBar){if(this.prop.shield<=0)return void(this.shieldBar.progress=0);this.prop.maxHP>this.prop.shield+this.prop.hp?this.shieldBar.progress=Math.max(1,this.prop.shield+this.prop.hp/this.prop.maxHP):this.shieldBar.progress=this.prop.shield&&this.prop.shield>0?1:0}},t.prototype.dead=function(){this.setSingBar(!1),this.setBloodVisible(!1),this.setNameVisible(!1),c.default.instance.rightlives.length&&this.hideQiPao(),this.actorstatus&&(this.actorstatus.spriteFrame=this.fightpanel.getSpriteFrame("GRAVE"+Math.ceil(3*Math.random())),this.actorstatus.node.active=!0),this.prop.selfMonster?this.actorstatus.node.color=cc.color(255,255,255,255):this.actorstatus.node.color=cc.color(112,193,255,255),this.avatar.visible=!1,this.prop.isLive=!1},t.prototype.rescure=function(){this.updateBloodBarHp(),this.setNameVisible(!0),this.actorstatus&&(this.actorstatus.spriteFrame=null,this.actorstatus.node.active=!1),this.avatar.visible=!0,this.avatar.body.spine.paused=!1,this.prop.isLive=!0},t.prototype.incHp=function(e,t){},t.prototype.decHp=function(e,t){},t.prototype.hpOverDead=function(){this.disappear(),this.dead()},t.prototype.updateState=function(){},t.prototype.updateHp=function(e){e<=0&&(e=0)},t.prototype.updateShield=function(e){},t.prototype.judgeDir=function(e,t){var i=Math.atan2(t-this.worldY,e-this.worldX);return a.ComFun.calcDirByRadian8(i)},t.prototype.updateData=function(e,t){},t.prototype.changeDir=function(e){this.prop.dir=e,this.qiPao&&this.qiPao.active&&(this.qiPao.x=this.width/2*-this.dir,this.qiPao.scaleX=this.dir,this.qiPaoLabel.node.scaleX=this.dir),this.avatar.changeDir(e)},t.prototype.playAnimation=function(e){this.avatar&&this.avatar.body&&this.avatar.body.play(e)},t.prototype.setloop=function(e){this.avatar&&this.avatar.body&&(this.avatar.body.loop=e)},t.prototype.setCompleteAnimation=function(e){this.avatar&&this.avatar.body&&(this.avatar.body.comanimationnkey=e)},t.prototype.setPlayRate=function(e){this._playRate=e,this.avatar&&this.avatar.setPlayRate(e)},t.prototype.getPlayRate=function(){return this._playRate},t.prototype.setTarget=function(e){void 0===e&&(e=[])},t.prototype.playPrewarSkill=function(){},t.prototype.moveTowardTarget=function(e,t){},t.prototype.setSingBar=function(e,t,i){},t.prototype.useInitiativeSkill=function(e,t,i){void 0===i&&(i=!1)},t.prototype.skillCanUse=function(e){return!1},t.prototype.showQiPao=function(e){this.qiPao.scaleX=this.dir,this.qiPaoLabel.string=e,this.qiPaoLabel.node.scaleX=this.dir,this.qiPao.y=this.qiPao.height,this.qiPao.x=this.width/2*-this.dir,this.qiPao.active=!0},t.prototype.hideQiPao=function(){this.qiPao.active&&(this.qiPao.active=!1,this.qiPaoLabel.string="")},t.prototype.addBuff=function(e){this.updateBloodBarHp(),this.buffbox.addChild(e)},t.prototype.removeBuff=function(e){for(var t=0;t<this.buffbox.childrenCount;t++){if(this.buffbox.children[t].getComponent(f.default).strindex==e){this.buffbox.children[t].getComponent(f.default).recovery();break}}},t.prototype.showQiPaoFace=function(e){},t.prototype.hideQiPaoFace=function(){},t.prototype.onShowRoleTitle=function(e){},Object.defineProperty(t.prototype,"tauntTagets",{get:function(){return this._tauntTagets},set:function(e){this._tauntTagets=e},enumerable:!0,configurable:!0}),t.HOLDPOWER_INDEX_ADD=1e3,__decorate([_(n.default)],t.prototype,"avatar",void 0),__decorate([_(cc.ProgressBar)],t.prototype,"bloodBar",void 0),__decorate([_(cc.ProgressBar)],t.prototype,"shieldBar",void 0),__decorate([_(cc.ProgressBar)],t.prototype,"singBar",void 0),__decorate([_(cc.Label)],t.prototype,"nameLabel",void 0),__decorate([_(cc.Sprite)],t.prototype,"actorstatus",void 0),__decorate([_(cc.SpriteAtlas)],t.prototype,"fightpanel",void 0),__decorate([_(cc.Node)],t.prototype,"qiPao",void 0),__decorate([_(cc.Label)],t.prototype,"qiPaoLabel",void 0),__decorate([_(cc.Node)],t.prototype,"buffbox",void 0),t=__decorate([v],t)}(r.default);i.default=b,cc._RF.pop()},{"../../Core/Const/EntityType":"EntityType","../../Core/Const/SAttributeConst":"SAttributeConst","../../Core/TimeController":"TimeController","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/ComFun":"ComFun","../../Util/Parabola":"Parabola","../../Util/Scene/MoveUtil":"MoveUtil","../Buff/BuffCell":"BuffCell","../Buff/BuffController":"BuffController","../Role/RoleController":"RoleController","../WarTeam/MonsterController":"MonsterController","./Avater/AvatarBase":"AvatarBase","./LayerableCompent":"LayerableCompent","./Manager/SceneManager":"SceneManager"}],SceneJumpCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"cbf60FzZjZO9Jdnpc0KDo/H","SceneJumpCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/TimeController"),o=function(){function e(e){this._data={},this._target=e}return e.prototype.clear=function(){this.stop(),this._data=null,this._target=null},e.prototype.Jump=function(e,t,i,o,a,r,s,l){void 0===a&&(a=null),void 0===r&&(r=null),void 0===s&&(s=null),void 0===l&&(l=null),this._data.updateCallBack=a,this._data.topCallBack=r,this._data.compCallBack=s,this._data.functionCompleteParm=l,this._data.g=t,this._data.startTime=n.default.instance.getTimer(),this._data.lastTime=0,this._data.startY=this._target.y,this._data.totalTime=e,this._data.startSpdY=-(this._data.g*this._data.totalTime+this._data.startY/this._data.totalTime);var c=this._data.totalTime>>1,d=this._data.startY+(this._data.startSpdY+this._data.g*c)*c;this._data.startY+(this._data.startSpdY+this._data.g*c)*c<o?(this._data.g=-2*(2*(o-this._data.startY)/this._data.totalTime+this._data.startY/this._data.totalTime)/this._data.totalTime,this._data.startSpdY=-(this._data.g*this._data.totalTime+this._data.startY/this._data.totalTime)):d>i&&(this._data.g=-2*(2*(i-this._data.startY)/this._data.totalTime+this._data.startY/this._data.totalTime)/this._data.totalTime,this._data.startSpdY=-(this._data.g*this._data.totalTime+this._data.startY/this._data.totalTime)),this._funcMyUpdate=this.JumpUpdate},e.prototype.JumpUpdate=function(){if(null!=this._data){var e=0,t=n.default.instance.getTimer()-this._data.startTime;t>this._data.totalTime&&(t=this._data.totalTime);e=t<.3*this._data.totalTime?(this._data.totalTime>>1)*t/(.3*this._data.totalTime):(this._data.totalTime>>1)+(this._data.totalTime>>1)*(t-.3*this._data.totalTime)/(.7*this._data.totalTime);var i=this._data.startY+(this._data.startSpdY+this._data.g*e)*e;this._target.y=i,null!=this._data.updateCallBack&&this._data.updateCallBack.call(this._target),this._data.lastTime<.3*this._data.totalTime&&t>.3*this._data.totalTime&&null!=this._data.topCallBack&&this._data.topCallBack.call(this._target),this._data.lastTime>=this._data.totalTime?(this.cleanUpdateFun(this.JumpUpdate),null!=this._data.compCallBack&&this._data.compCallBack.call(this._target,this._data.functionCompleteParm)):this._data.lastTime=t}},e.prototype.stop=function(){this._funcMyUpdate=null},Object.defineProperty(e.prototype,"jumping",{get:function(){return null!=this._funcMyUpdate},enumerable:!0,configurable:!0}),e.prototype.update=function(e){null!=this._funcMyUpdate&&this._funcMyUpdate()},e.prototype.cleanUpdateFun=function(e){this._funcMyUpdate==e&&(this._funcMyUpdate=null)},e.prototype.jumpUpAndDown=function(e,t,i,o){void 0===i&&(i=null),void 0===o&&(o=null),this._data=new Object,this._data.updateCallBack=i,this._data.compCallBack=o,this._data.speed=(t-this._target.y)/e,this._data.startTime=n.default.instance.getTimer(),this._data.lastTime=0,this._data.startY=this._target.y,this._data.totalTime=e,this._funcMyUpdate=this.jumpUpAndDownUpdate},e.prototype.jumpUpAndDownUpdate=function(){var e=n.default.instance.getTimer()-this._data.startTime;e>this._data.totalTime&&(e=this._data.totalTime),this._target.y=this._data.startY+this._data.speed*e,null!=this._data.updateCallBack&&this._data.updateCallBack.call(this._target),this._data.lastTime>=this._data.totalTime?(this.cleanUpdateFun(this.jumpUpAndDownUpdate),null!=this._data.compCallBack&&this._data.compCallBack.call(this._target)):this._data.lastTime=e},e}();i.default=o,cc._RF.pop()},{"../../../Core/TimeController":"TimeController"}],SceneManager:[function(e,t,i){"use strict";cc._RF.push(t,"9572f9g1KhF6qnMww8nTzzs","SceneManager"),Object.defineProperty(i,"__esModule",{value:!0});var n,o=e("../../../Core/Managet"),a=e("../../../Core/GameEventDispatcher"),r=e("../../../Core/Event"),s=e("../Pool/ActorPools"),l=e("../../../Core/Const/EntityType"),c=e("../SceneEntity"),d=e("../../../Global/GlobalValue"),p=e("../../Fight/fightlogic"),h=e("../Controller/SceneController"),u=e("../../../Util/Scene/MoveUtil"),f=e("../Controller/SkillController"),g=e("../../WarTeam/MonsterController"),y=e("../../../GlobalContext"),m=e("../Effect/BuffTypeEffectUtils"),C=e("../Controller/FightController"),v=e("../../Status/StatusType"),_=e("../Effect/MonsterIndividualityUtils"),b=e("../../DailyCopy/DailyCopyCtrl"),T=e("../View/ActorsLayer"),S=e("../View/ActorsMaskLayer"),I=cc._decorator,w=I.ccclass;I.property;(function(e){e[e.NONE=0]="NONE",e[e.UPGRADE=1]="UPGRADE",e[e.UPGRADECOM=2]="UPGRADECOM",e[e.PLAYSKILL=3]="PLAYSKILL",e[e.PLAYSKILLCOM=4]="PLAYSKILLCOM",e[e.FIGHT=5]="FIGHT",e[e.FIGHTEND=6]="FIGHTEND"})(n=i.FIGHTSTATUS||(i.FIGHTSTATUS={}));var D=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fightlogic=new p.FightLogic,t.myRole=null,t.otherRole=null,t.fightCaridEntityDic={},t.specialskillstatus=0,t.specialskillid=0,t.effectShowType=0,t.specialskillcount=0,t.specialskillEntityComEffect=!1,t.sceneScale=2,t.resultShowMonster=[],t._resultShowItemList=[],t.fightstatus=-1,t.fightresult=!0,t.fightresultType=0,t.injuredEffects=[],t.leftentitys=[],t.rightentitys=[],t.leftdeadentitys=[],t.rightdeadentitys=[],t.leftFight=0,t.rightFight=0,t.leftlives=[],t.rightlives=[],t.treasureMapleftlives=[],t.leftPlayPrewarSkillEntity=[],t.leftPrewarSkill=[],t.rightPlayPrewarSkillEntity=[],t.rightPrewarSkill=[],t._fightViewPlayRate=1,t._oldfightViewPlayRate=1,t.attackenemyhp=0,t.attackEnemyHpOnce=0,t.quanqiaId=-1,t.games=1,t.mycamp=0,t.serverEntity=[],t.enemyallstep=0,t.enemystep=-1,t.steptime=0,t.handledie={},t.myRoleHandle=0,t.clearResPoolTime=5e3,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.start=function(){i.instance=this},t.prototype.listNotification=function(){},Object.defineProperty(t.prototype,"fightMode",{get:function(){return y.GlobalContext.fightMode},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fightViewPlayRate",{get:function(){return this._fightViewPlayRate},set:function(e){this._fightViewPlayRate=e,h.default.instance.updateInjureEffectsPlayRate(),m.default.instance.updateEffectsPlayRate(),_.default.instance.updatePlayRate()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"oldfightViewPlayRate",{get:function(){return this._oldfightViewPlayRate},set:function(e){this._oldfightViewPlayRate=Math.max(1,e)},enumerable:!0,configurable:!0}),t.prototype.checkRangeHasTarget=function(e,t,i){for(var n=0,o=e.prop.selfMonster?this.rightentitys.concat():this.leftentitys.concat();n<o.length;n++){var a=o[n];if(a.isLive&&this.checkPixelDis(e,a,this.getActorSkillRange(e,t,i)))return!0}return!1},t.prototype.getActorSkillRange=function(e,t,i,n){void 0===n&&(n=null);var o=f.default.instance.getSkillBySkillIdAndLv(t,1),a=isNaN(o.actRange)?3e3:o.actRange;return e.prop.type==l.EntityType.enMonster&&(a=e.prop.grade<=3?15*(e.prop.grade-1)+a:a),v.ActivityStatus.EliteBoss!=v.ActivityStatus.value&&v.ActivityStatus.WorldBoss!=v.ActivityStatus.value&&v.ActivityStatus.MoneyDailyCopy!=v.ActivityStatus.value&&v.ActivityStatus.LoardCrusade!=v.ActivityStatus.value||e.prop.selfMonster&&e.prop.grade<=3&&3!=e.prop.CardType&&(a+=300),v.ActivityStatus.value==v.ActivityStatus.Guide&&n&&n.triggerway==d.TRIGGER_WAY.INITIATIVE&&(a=5e3),a},t.prototype.getTargetList=function(e,t,i,n){var o=[],a=[],r=[],s=n.prop.selfMonster,l=T.default.instance,p=this.fightlogic;switch(n.tauntTagets=[],e){case d.ATTACK_TARGE.SELF:o.push(n);break;case d.ATTACK_TARGE.FRIENDLY:a=s?this.leftlives.concat():this.rightlives.concat();break;case d.ATTACK_TARGE.ENEMY:(a=s?this.rightlives.concat():this.leftlives.concat()).length<=0&&(s?this.otherRole&&o.push(this.otherRole.getComponent(c.default)):this.myRole&&o.push(this.myRole.getComponent(c.default)));for(var h=[],u=[],f=0;f<a.length;f++){p.getFightEntityByHandle(a[f].handle).attr.buff.IsHasBuffByType(d.BuffType.Taunt)&&a[f].isLive?h.push(a[f]):u.push(a[f])}n.tauntTagets=h,a=h.length>0?h:u;break;case d.ATTACK_TARGE.FRIENDLY_DEAD:o=s?this.leftdeadentitys.concat():this.rightdeadentitys.concat();break;case d.ATTACK_TARGE.FAMILY:a=s?this.leftlives.concat():this.rightlives.concat();for(f=0;f<a.length;f++)a[f].cardid==n.prop.cardid&&r.push(a[f]);a=r;break;case d.ATTACK_TARGE.COPY:a=s?this.rightlives.concat():this.leftlives.concat();for(f=0;f<a.length;f++){p.getFightEntityByHandle(a[f].handle).attr.buff.IsHasBuffByType(d.BuffType.NotCopy)||a[f].copyEntity||!a[f].isLive||a[f].isBoss||r.push(a[f])}if(i<=r.length){var g=r.length-i;r=r.splice(Math.floor(g/2),i)}a=r;break;case d.ATTACK_TARGE.ALL:a=this.rightlives.concat().concat(this.leftlives.concat())}for(f=0;f<a.length;f++)o.push(l.getSceneEntity(a[f].handle));return o},t.prototype.seekTarget=function(e,t,i){if(e&&e.prop&&e.prop.attr&&e.prop.isLive){var n,o=f.default.instance.getSkillBySkillId(t),a=this.getActorSkillRange(e,t,i,o),r=this.fightlogic,s=[],l=[],c=o.attackNum||1,p=e.prop.selfMonster;if(v.ActivityStatus.value==v.ActivityStatus.MoneyDailyCopy&&p&&this.leftlives.length<=0){b.default.instance.setProp(this.rightlives[0]);var h=!0;return C.default.instance.isEndGames()&&(h=!1),this.fightlogic.OnFightResult(h),s}if(r){var u=r.getFightEntityByHandle(e.prop.handle);if(!u||!u.attr)return console.warn("\u6ca1\u6709\u627e\u5230\u6218\u6597\u6570\u636e"+e.prop.handle,r),s;if(o.triggerway==d.TRIGGER_WAY.COMMON&&u.attr&&u.attr.buff.IsHasBuffByType(d.BuffType.Puzzle)){for(var g=0,y=e.prop.selfMonster?this.leftlives.concat():this.rightlives.concat();g<y.length;g++){var m=y[g],_=T.default.instance.getSceneEntity(m.handle);m.handle!=e.prop.handle&&m.isLive&&this.checkPixelDis(e,_,a)&&s.push(_)}return s.slice(0,c)}}if(l=this.getTargetList(o.attackTarget,a,c,e),v.ActivityStatus.value==v.ActivityStatus.Guide&&o.triggerway==d.TRIGGER_WAY.INITIATIVE)return l=l.slice(0,c);if(o.iscombo){s=[];for(var S=0,I=l;S<I.length;S++){m=I[S];1==o.iscombo&&m.hitStatus==d.HIT_STATUS.STRIKEFLY?m.isLive&&(o.attackway==d.ATTACK_TYPE.ATTACK_TYPE_3||this.checkPixelDis(e,m,a))&&s.push(m):2==o.iscombo&&m.hitStatus==d.HIT_STATUS.REPEL&&m.isLive&&(o.attackway==d.ATTACK_TYPE.ATTACK_TYPE_3||this.checkPixelDis(e,m,a))&&s.push(m)}}else n=this.setTarget(o,l,e,a),s=s.concat(n);return o.farthest&&s.reverse(),s.length>c&&(s=s.slice(0,c)),s}},t.prototype.setTarget=function(e,t,i,n){var o=[];if(e.priorityProfession&&e.priorityProfession.length>0)for(var a=0,r=e.priorityProfession;a<r.length;a++)for(var s=r[a],c=0,p=t;c<p.length;c++){var h=p[c],u=g.default.instance.getCardConfCardType(h.prop.cardid);h.isLive&&u==s&&(e.attackway==d.ATTACK_TYPE.ATTACK_TYPE_3||this.checkPixelDis(i,h,n))&&o.push(h)}else if(e.attackMaxGrade){for(var f=0,y=t;f<y.length;f++){h=y[f],u=g.default.instance.getCardConfCardType(h.prop.cardid);h.isLive&&(e.attackway==d.ATTACK_TYPE.ATTACK_TYPE_3||this.checkPixelDis(i,h,n))&&o.push(h)}o.sort(this.sortGrade)}else if(e.attackMinHp)o=this.getMinHpHandles(i,t,e.attackMinHp,n);else if(e.copyEntity)for(var m=0,C=t;m<C.length;m++){(h=C[m]).isLive&&h.prop.copyEntity&&o.push(h)}else if(e.fiveLineAttributes&&e.fiveLineAttributes.length>0)for(var v=0,_=t;v<_.length;v++){if((h=_[v])&&h.prop&&h.prop.type==l.EntityType.enMonster){var b=g.default.instance.GetMonsterInfo(h.prop.cardid);h.isLive&&-1!=e.fiveLineAttributes.indexOf(b.fiveLineAttributes)&&(e.attackway==d.ATTACK_TYPE.ATTACK_TYPE_3||this.checkPixelDis(i,h,n))&&o.push(h)}}else if(void 0!==e.selectgrade)if(e.selectgrade>0)for(var T=0,S=t;T<S.length;T++){(h=S[T]).isLive&&h.prop.grade>i.prop.grade&&o.push(h)}else if(e.selectgrade<0)for(var I=0,w=t;I<w.length;I++){(h=w[I]).isLive&&h.prop.grade<=Math.max(1,i.prop.grade+e.selectgrade)&&o.push(h)}else for(var D=0,R=t;D<R.length;D++){(h=R[D]).isLive&&h.prop.grade<=i.prop.grade&&o.push(h)}else if(e.maxgrade);else if(e.fightTargetOffY)for(var A=0;A<t.length;A++)t[A]&&t[A].isLive&&(e.attackway==d.ATTACK_TYPE.ATTACK_TYPE_3||Math.abs(Math.abs(t[A].prop.y)-Math.abs(i.prop.y))<=e.fightTargetOffY)&&o.push(t[A]);else{var N=1.8;i.prop.cardid?N-=.2*g.default.instance.getCardConfCardType(i.prop.cardid):N-=3*.2;for(var L=0,E=t;L<E.length;L++){(h=E[L]).isLive&&(e.attackway==d.ATTACK_TYPE.ATTACK_TYPE_3||this.checkPixelDis(i,h,n,N))&&o.push(h)}o.sort(this.sortPixelDisYCompare(i.prop.x,i.prop.y));var B=[];for(A=0;A<o.length;A++)o[A]&&o[A].isLive&&(e.attackway==d.ATTACK_TYPE.ATTACK_TYPE_3||this.checkPixelDis(i,o[A],n))&&B.push(o[A]);o=B}if(e.targetHpPercent){for(var M=[],x=0,k=o;x<k.length;x++){(h=k[x]).prop.hp/h.prop.maxHP<=e.targetHpPercent/100&&M.push(h)}o=M}return o},t.prototype.getMinHpHandles=function(e,t,i,n){for(var o=[],a=0,r=t;a<r.length;a++){var s=r[a];s.isLive&&this.checkPixelDis(e,s,n)&&o.push(s)}return 1==i?o.sort(this.sortNumber):2==i&&o.sort(this.sortPercentNumber),o},t.prototype.sortNumber=function(e,t){return e.prop.hp-t.prop.hp},t.prototype.sortPercentNumber=function(e,t){return e.prop.hp/e.prop.maxHP-t.prop.hp/t.prop.maxHP},t.prototype.sortGrade=function(e,t){return e.prop.grade==t.prop.grade?t.prop.fight-e.prop.fight:t.prop.grade-e.prop.grade},t.prototype.sortPixelDisCompare=function(e,t){return function(i,n){return u.MoveUtil.getPixelDis(e,t,i.prop.x,i.prop.y)-u.MoveUtil.getPixelDis(e,t,n.prop.x,n.prop.y)}},t.prototype.sortPixelDisYCompare=function(e,t){return function(e,i){var n=0,o=0,a=Math.abs(t);return a>=0?(n=Math.abs(a-Math.abs(e.prop.y)),o=Math.abs(a-Math.abs(i.prop.y))):(n=Math.abs(a+Math.abs(e.prop.y)),o=Math.abs(a+Math.abs(i.prop.y))),n-o}},t.prototype.checkPixelDis=function(e,t,i,n){return void 0===n&&(n=1),u.MoveUtil.getPixelDis(Math.ceil(e.prop.x),Math.ceil(e.prop.y),Math.ceil(t.prop.x),Math.ceil(t.prop.y))<=i*n},t.prototype.clearLeftlives=function(){this.leftlives=[]},t.prototype.clear=function(){this.fightstatus=n.FIGHTEND,this.leftPlayPrewarSkillEntity=[],this.rightPlayPrewarSkillEntity=[],this.leftentitys=[],this.leftdeadentitys=[],this.rightdeadentitys=[],this.rightentitys=[],this.rightlives=[],this.rightFight=0,this.leftFight=0,this.fightCaridEntityDic=[],this.fightlogic=null,this.handledie={},console.log("\u6e05\u7406\u6218\u6597\u6570\u636efightlogic"),T.default.instance.clearAllEntities(),S.default.instance.clear(),this.fightlogic=new p.FightLogic},t.prototype.clearRole=function(){s.ActorPools.recoverPlayer(this.otherRole),s.ActorPools.recoverPlayer(this.myRole),this.otherRole=null,this.myRole=null},Object.defineProperty(t.prototype,"resultShowItemList",{get:function(){return this._resultShowItemList},set:function(e){this._resultShowItemList=e,a.GameEventDispatcher.instance.emit(r.EventDefiner.Updata_ComResultReward)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fightSceneWidth",{get:function(){var e=1280;return v.ActivityStatus.value!=v.ActivityStatus.Arena&&(e=y.GlobalContext.UIWidth),e},enumerable:!0,configurable:!0}),t.prototype.artifactSkill=function(){var e=!1;switch(this.specialskillstatus){case d.SPECIAL_SKILL_STATUS.SPECIAL_SKILL_STATUS8:case d.SPECIAL_SKILL_STATUS.SPECIAL_SKILL_STATUS9:case d.SPECIAL_SKILL_STATUS.SPECIAL_SKILL_STATUS10:case d.SPECIAL_SKILL_STATUS.SPECIAL_SKILL_STATUS11:case d.SPECIAL_SKILL_STATUS.SPECIAL_SKILL_STATUS12:e=!0}return e},t.instance=null,t=i=__decorate([w],t)}(o.default);i.default=D,cc._RF.pop()},{"../../../Core/Const/EntityType":"EntityType","../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Managet":"Managet","../../../Global/GlobalValue":"GlobalValue","../../../GlobalContext":"GlobalContext","../../../Util/Scene/MoveUtil":"MoveUtil","../../DailyCopy/DailyCopyCtrl":"DailyCopyCtrl","../../Fight/fightlogic":"fightlogic","../../Status/StatusType":"StatusType","../../WarTeam/MonsterController":"MonsterController","../Controller/FightController":"FightController","../Controller/SceneController":"SceneController","../Controller/SkillController":"SkillController","../Effect/BuffTypeEffectUtils":"BuffTypeEffectUtils","../Effect/MonsterIndividualityUtils":"MonsterIndividualityUtils","../Pool/ActorPools":"ActorPools","../SceneEntity":"SceneEntity","../View/ActorsLayer":"ActorsLayer","../View/ActorsMaskLayer":"ActorsMaskLayer"}],SceneView:[function(e,t,i){"use strict";cc._RF.push(t,"fdfd2cbsYJAMZ4P3PkF00Bp","SceneView"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../Status/StatusType"),a=e("../../../Core/GameEventDispatcher"),r=e("../../../Core/Event"),s=e("../../../GlobalContext"),l=e("../../../Core/TimeController"),c=e("../../PlotWin/PlotController"),d=cc._decorator,p=d.ccclass,h=d.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ChapterMapView=null,t.BackBtn=null,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this),this.node.width=s.GlobalContext.UIWidth,this.node.height=s.GlobalContext.UIHeight,this.BackBtn.setPosition(-s.GlobalContext.UIWidth/2+this.BackBtn.width/2,s.GlobalContext.UIHeight/2-this.BackBtn.height/2)},t.prototype.show=function(){e.prototype.show.call(this),a.GameEventDispatcher.instance.on(r.EventDefiner.SetSceneBackState,this.setBackBtnState,this),this.BackBtn.active=!0},t.prototype.hide=function(){e.prototype.hide.call(this),a.GameEventDispatcher.instance.off(r.EventDefiner.SetSceneBackState,this.setBackBtnState,this),this.ChapterMapView.active=!1},t.prototype.setBackBtnState=function(e){this.BackBtn.active=!e||e.getUserData()},t.prototype.showType=function(e){var t=this;this.ChapterMapView.active=!1;var i=l.default.instance.setTimeout(function(){1==e&&(t.ChapterMapView.active=!0),l.default.instance.clearTimeout(i)},this,100)},t.prototype.backBtnClick=function(){c.default.instance.iscomplete&&a.GameEventDispatcher.instance.emit(r.EventDefiner.ChangeActivityStatus,o.ActivityStatus.NoActivity)},__decorate([h(cc.Node)],t.prototype,"ChapterMapView",void 0),__decorate([h(cc.Node)],t.prototype,"BackBtn",void 0),t=__decorate([p],t)}(n.default);i.default=u,cc._RF.pop()},{"../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/TimeController":"TimeController","../../../Core/Widget":"Widget","../../../GlobalContext":"GlobalContext","../../PlotWin/PlotController":"PlotController","../../Status/StatusType":"StatusType"}],SeckillItem:[function(e,t,i){"use strict";cc._RF.push(t,"cdc64ug6QdMvZzoDUEkOdE8","SeckillItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Util/SDKUtils"),a=e("../ActivityView/GroupPurchase/GroupPurchaseContrl"),r=e("../Tips/OpTipsController"),s=e("../../Core/Language"),l=e("../../NetConnect/NetConnet"),c=e("./OneSeckillWin"),d=e("../Tips/TipsWinController"),p=cc._decorator,h=p.ccclass,u=(p.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.BuyBtnEvent=function(e){var t=this,i=e.currentTarget.parent.getSiblingIndex(),n=c.default.instance.conf.giftbag[c.default.instance.giftbag][i].id;if(o.default.instance.isInitWX){if(!a.default.instance.OneSeckill.length)return void d.default.instance.ShowTips("\u5355\u72ec\u8d2d\u4e70\u793c\u5305\u7684\u8bdd\u6ca1\u67098\u6298\u4f18\u60e0\u5594~",function(){o.default.instance.rechargeByIndex(n,function(e){e&&r.default.instance.ShowMsg(s.default.getStr("\u5145\u503c\u6210\u529f"))},t)});o.default.instance.rechargeByIndex(n,function(e){e&&r.default.instance.ShowMsg(s.default.getStr("\u5145\u503c\u6210\u529f"))},this)}else if(a.default.instance.OneSeckill.length){var p={cmd:"gm",type:"diamondshop",param:[n]};l.default.instance.sendProto(p),r.default.instance.ShowMsg(s.default.getStr("\u5145\u503c\u6210\u529f"))}else d.default.instance.ShowTips("\u5355\u72ec\u8d2d\u4e70\u793c\u5305\u7684\u8bdd\u6ca1\u67098\u6298\u4f18\u60e0\u5594~",function(){var e={cmd:"gm",type:"diamondshop",param:[n]};l.default.instance.sendProto(e),r.default.instance.ShowMsg(s.default.getStr("\u5145\u503c\u6210\u529f"))})},t.prototype.GetRewardBtnEvent=function(e,t){var i;if(t)i=Number(t);else{var n=e.currentTarget.parent.getSiblingIndex();i=c.default.instance.conf.giftbag[c.default.instance.giftbag][n].id}var o={cmd:"seckillreward",id:i,actid:16};l.default.instance.sendProto(o)},t=__decorate([h],t)}(n.default));i.default=u,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/Widget":"Widget","../../NetConnect/NetConnet":"NetConnet","../../Util/SDKUtils":"SDKUtils","../ActivityView/GroupPurchase/GroupPurchaseContrl":"GroupPurchaseContrl","../Tips/OpTipsController":"OpTipsController","../Tips/TipsWinController":"TipsWinController","./OneSeckillWin":"OneSeckillWin"}],SelectListItem:[function(e,t,i){"use strict";cc._RF.push(t,"0947beFSLZBlJ7BGxDHg24F","SelectListItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("./SelectServersPanel"),a=e("../../Core/Language"),r=cc._decorator,s=r.ccclass,l=r.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.nameLb=null,t.btnsprite=null,t.conmonAtlas=null,t.serverNum=50,t.data=0,t.index=0,t}return __extends(t,e),t.prototype.start=function(){this.node.on(cc.Node.EventType.TOUCH_END,this.onSelect,this)},t.prototype.setData=function(e,t){this.data=e,this.index=t,this.setNameLb(e)},t.prototype.setNameLb=function(e){this.nameLb.string=-1==e?a.default.getStr("\u6211\u7684\u670d\u52a1\u5668"):-2==e?a.default.getStr("\u63a8\u8350\u670d"):e*this.serverNum+1+"-"+(e+1)*this.serverNum+a.default.getStr("\u670d")},Object.defineProperty(t.prototype,"select",{set:function(e){var t="btn_fenye1";this.index==e&&(t="btn_fenye1_HL"),this.node.getComponent(cc.Sprite).spriteFrame=this.conmonAtlas.getSpriteFrame(t)},enumerable:!0,configurable:!0}),t.prototype.onSelect=function(){o.default.instance.setSelectListItem(this.data,this.index)},t.prototype.hide=function(){this.node.off(cc.Node.EventType.TOUCH_END,this.onSelect)},__decorate([l(cc.Label)],t.prototype,"nameLb",void 0),__decorate([l(cc.Sprite)],t.prototype,"btnsprite",void 0),__decorate([l(cc.SpriteAtlas)],t.prototype,"conmonAtlas",void 0),t=__decorate([s],t)}(n.default);i.default=c,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/Widget":"Widget","./SelectServersPanel":"SelectServersPanel"}],SelectServersPanel:[function(e,t,i){"use strict";cc._RF.push(t,"9971dmnjTRB8rDnvWEG97SK","SelectServersPanel"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./SelectListItem"),o=e("../Commons/ListViewCtrl"),a=e("../../GlobalContext"),r=e("../../Util/SDKUtils"),s=e("../../Util/ReportSdkUtils"),l=e("../../Core/Language"),c=e("./ServersListItem"),d=e("./MyServersListItem"),p=e("../../Core/Event"),h=e("../SDK/GameSDK"),u=e("../Tips/OpTipsController"),f=cc._decorator,g=f.ccclass,y=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.myServertListViewCrt=null,t.myServertListView=null,t.servertListViewCrt=null,t.servertListView=null,t.selectListViewCrt=null,t.selectView=null,t.enterGamePanel=null,t.StartBtn=null,t.commondrop1=null,t.tipWin=null,t.tipLb=null,t.serverInfo=null,t._serverDic={},t._serverNumList=[],t.serverNum=50,t.currentTabNum=-1,t.currentServerData=null,t.reason=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){h.default.instance.sdk.login(),i.instance=this,this.myServertListViewCrt.refreshItem=this.updateMyServertListItem,this.myServertListViewCrt.refreshItemThis=this,this.selectListViewCrt.refreshItem=this.updateSelectListItem,this.selectListViewCrt.refreshItemThis=this,this.servertListViewCrt.refreshItem=this.updateServertListItem,this.servertListViewCrt.refreshItemThis=this},t.prototype.start=function(){this.tipWin.active=!1,this.LoginSuccess()},t.prototype.updateMyServertListItem=function(e,t){e.getComponent(d.default).setData(this.myServertListViewCrt.dataLsit[t],t)},t.prototype.updateSelectListItem=function(e,t){e.getComponent(n.default).setData(this.selectListViewCrt.dataLsit[t],t)},t.prototype.updateServertListItem=function(e,t){e.getComponent(c.default).setData(this.servertListViewCrt.dataLsit[t],t)},t.prototype.setSelectListItem=function(e,t){this.serverTabChoosed(e);for(var i=0;i<this.selectListViewCrt.items.length;i++){this.selectListViewCrt.items[i].getComponent(n.default).select=t}},t.prototype.setMyServertListItem=function(e){this.currentServerData=e,this.startBtnClick()},t.prototype.setServertListItem=function(e){this.currentServerData=e,this.startBtnClick()},t.prototype.onEnable=function(){cc.game.on("LoginSuccess",this.LoginSuccess,this)},t.prototype.onDisable=function(){cc.game.off("LoginSuccess",this.LoginSuccess,this)},t.prototype.LoginOut=function(){this._serverNumList.length=0,this.setCurrentServerShow(null)},t.prototype.LoginSuccess=function(){if(s.default.instance.loginPointOut(s.default.LoginPointKingdom_2),r.default.instance.BackstageUrl&&""!=r.default.instance.BackstageUrl){var e=r.default.instance.loginData,t=r.default.instance.BackstageUrl+"/login/first?plat_id="+r.default.instance.plat_id+"&ditch_id="+r.default.instance.ditch_id+"&timestamp="+r.default.instance.platformSdk.timestamp+"&session_id="+(e.session_id?e.session_id:"")+"&token="+r.default.instance.platformSdk.access_token+"&account="+r.default.instance.openId+"&device_id="+r.default.instance.device_id+"&need_check="+r.default.instance.need_check;r.default.instance.sendToHttps(t,this.sendToGetServerInfo,this)}else{this.sendToGetServerInfo({last_server_id:"2",dau_server_all:"1,2,3,4",role_info:[{name:"\u89d2\u8272\u540d",gender:0,fight:999,srvid:1}],server_list:[{ip:"192.168.3.108",port:"20079",server_id:"1",merge_id:"1",pfrom_id:"1",onlinedate:"2019-01-22 00:00:00",showdate:"2019-01-22 18:28:14",name:"\u5185\u7f51(chenhuan)",status:"1",index:2},{ip:"192.168.3.90",port:"20079",server_id:"3",merge_id:"3",pfrom_id:"1",onlinedate:"2019-01-22 00:00:00",showdate:"2019-01-22 18:28:14",name:"\u5185\u7f51(yidong)",status:"1",index:3},{ip:"192.168.3.7",port:"20079",server_id:"4",merge_id:"4",pfrom_id:"1",onlinedate:"2019-01-22 00:00:00",showdate:"2019-01-22 18:28:14",name:"\u5185\u7f51(zhiqi)",status:"1",index:4},{ip:"common.qmttl.moyangmoyang.com",port:"8050",server_id:"2",merge_id:"2",pfrom_id:"1",onlinedate:"2019-01-22 00:00:00",showdate:"2019-01-22 18:28:20",name:"\u5916\u7f51",status:"1",index:1}],status:1,is_inner_account:"false",canEnter:"true",reason:""})}},t.prototype.showSelectView=function(){this.selectView.active=!0,this.enterGamePanel.active=!1,this.showServerChooseView()},t.prototype.setCurrentServerShow=function(e){this.currentServerData=e,a.GlobalContext.currentServerData=e;if(e){var t=e.status.split(",");t&&(t.indexOf("1")>=0?1:t.indexOf("3")>=0?0:t.indexOf("4")>=0&&2),0!=this.serverInfo.canEnter&&"false"!=this.serverInfo.canEnter||2;var i="ws://";(1001==Number(r.default.instance.ditch_id)||r.default.instance.isInitWX)&&(i="wss://"),r.default.instance.defaultUrl=i+e.ip+":"+e.port+"/?userid="+r.default.instance.openId+"&channel="+r.default.instance.ditch_id,console.log("SDKUtils.instance.defaultUrl: "+r.default.instance.defaultUrl)}else r.default.instance.defaultUrl=null;this.setEnterGamePanelInfo()},t.prototype.setEnterGamePanelInfo=function(){var e=this.enterGamePanel.getChildByName("Curserverbox");e.getChildByName("Curserverstatus").getComponent(cc.Sprite).spriteFrame=i.instance.getStatusSprite(a.GlobalContext.currentServerData.status),e.getChildByName("ServersNumLabel").getComponent(cc.Label).string=a.GlobalContext.currentServerData.server_id+l.default.getStr("\u533a"),e.getChildByName("ServersNumLabel").getComponent(cc.Label).string=decodeURIComponent(a.GlobalContext.currentServerData.name+"")},t.prototype.showMsg=function(e){console.log("\u767b\u5f55\u63d0\u793a: "+e),u.default.instance.ShowMsg(e)},t.prototype.sendToGetServerInfo=function(e){if(e){if("1"!=e.status)return this.tipWin.active=!0,void(this.tipLb.string="\u767b\u5f55\u6821\u9a8c\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55");console.log("\u83b7\u5f97\u670d\u52a1\u5668\u5217\u8868\u4fe1\u606f: ",e),this.serverInfo=e,this._serverDic={},this._serverNumList.length=0,this.currentTabNum=-1,this.reason=decodeURIComponent(e.reason+"");for(var t=null,i=[],n=e.server_list,o=e.dau_server_all&&""!=e.dau_server_all?(e.dau_server_all+"").split(","):null,r=0;r<n.length;r++){var s=n[r],l=0,c=s.status.split(",");if(!(c&&c.indexOf("0")>=0)){o&&o.indexOf(s.server_id+"")>=0&&(l=-1,this._serverDic[l]||(this._serverDic[l]=[],this._serverNumList.push(l)),this._serverDic[l].push(s)),c&&c.indexOf("2")>=0&&(l=-2,this._serverDic[l]||(this._serverDic[l]=[],this._serverNumList.push(l)),this._serverDic[l].push(s)),c&&c.indexOf("5")>=0&&i.push(s);var d=Number(s.server_id);l=Math.ceil(d/this.serverNum)-1,this._serverDic[l]||(this._serverDic[l]=[],this._serverNumList.push(l)),this._serverDic[l].push(s),e.last_server_id&&""!=e.last_server_id&&e.last_server_id+""==s.server_id+""&&(t=s)}}if(this._serverNumList.indexOf(-1)<0&&this._serverNumList.push(-1),this._serverNumList.indexOf(-2)<0&&this._serverNumList.push(-2),this._serverNumList.sort(function(e,t){return-1==e&&-1!=t?-1:-1!=e&&-1==t?1:e<t?-1:e>t?1:0}),t)cc.director.preloadScene("Main"),console.log("\u52a0\u8f7dMain  Select1");else{l=-1;this._serverDic[l]&&this._serverDic[l].length>0?t=this._serverDic[l][0]:(l=-2,this._serverDic[l]&&this._serverDic[l].length>0?t=this._serverDic[l][0]:i.length>0?t=i[0]:n.length>0&&(t=n[n.length-1])),cc.director.preloadScene("CreateRole"),console.log("\u52a0\u8f7dCreateRole   Select1")}this.enterGamePanel.active=a.GlobalContext.currentServerData,this.selectView.active=!a.GlobalContext.currentServerData,this.setCurrentServerShow(t),this.StartBtn.interactable=1==this.serverInfo.canEnter||"true"==this.serverInfo.canEnter}},t.prototype.showServerChooseView=function(){!this._serverNumList||this._serverNumList.length<=0||(this.servertListViewCrt.node.active=!1,this.selectListViewCrt.initialize(this._serverNumList),this.currentTabNum=-1,this._serverDic&&this._serverDic[this.currentTabNum]?this.setSelectListItem(this.currentTabNum,0):(this.currentTabNum=-2,this.setSelectListItem(this.currentTabNum,1)))},t.prototype.serverTabChoosed=function(e){this.currentTabNum=e;var t=this._serverDic[e];t&&t.length>0&&t.sort(function(e,t){return e.index<t.index?-1:e.index>t.index?1:0}),t&&(-1==e?this.myServertListViewCrt.initialize(t):this.servertListViewCrt.initialize(t)),this.myServertListView.active=-1==e&&null!=t,this.servertListView.active=-1!=e&&null!=t},t.prototype.startBtnClick=function(){var e=this;if(r.default.instance.defaultUrl)if(r.default.instance.BackstageUrl&&""!=r.default.instance.BackstageUrl){var t=this.currentServerData.server_id,i=r.default.instance.BackstageUrl+"/login/lastrequest?serverid="+t+"&plat_id="+r.default.instance.plat_id+"&ditch_id="+r.default.instance.ditch_id+"&account="+r.default.instance.openId+"&device_id="+r.default.instance.device_id;r.default.instance.sendToHttps(i,function(t){var i=t.status+"";if("1"==i||"2"==i)1==t.canEnter||"true"==t.canEnter?e.checkRoleStatus():e.showMsg("\u4e0d\u53ef\u8fdb\u5165");else{e.showMsg({99:"\u5373\u5c06\u5f00\u670d",0:"\u4e0d\u53ef\u8fdb\u5165","-1":"\u533a\u670d\u9519\u8bef"}[i])}e.reason=decodeURIComponent(t.reason+"")},this)}else cc.game.emit(p.EventDefiner.CanEnterGame);else 1==r.default.instance.isNative&&1==r.default.instance.hasSdk&&r.default.instance.sendToLogin()},t.prototype.checkRoleStatus=function(){var e=this;if(r.default.instance.BackstageUrl&&""!=r.default.instance.BackstageUrl){var t=this.currentServerData.server_id,i=r.default.instance.BackstageUrl+"/login/?serverid="+t+"&plat_id="+r.default.instance.plat_id+"&ditch_id="+r.default.instance.ditch_id+"&account="+r.default.instance.openId+"&device_id="+r.default.instance.device_id+"&session_key="+r.default.instance.session_key;r.default.instance.sendToHttps(i,function(t){a.GlobalContext.backstageLoginData=t;var i=t.status+"";if("1"!=i){e.showMsg({"-3":"\u60a8\u7684\u8d26\u53f7\u56e0\u8fdd\u89c4\u5df2\u88ab\u5c01\u7981","-1":"\u670d\u52a1\u5668\u5f02\u5e38\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55"}[i])}else r.default.instance.defaultUrl+="&timestamp="+t.time+"&sign="+t.pw+"&superman="+t.superman,cc.game.emit(p.EventDefiner.CanEnterGame)},this)}},t.prototype.getStatusSprite=function(e){var t=1;return 0==e||e>=10?t=4:5!=e&&2!=e||(t=3),this.commondrop1.getSpriteFrame("icon_dl"+t)},t.prototype.onCloseTipWin=function(e){this.tipWin.active=!1},t.instance=null,__decorate([y(o.default)],t.prototype,"myServertListViewCrt",void 0),__decorate([y(cc.Node)],t.prototype,"myServertListView",void 0),__decorate([y(o.default)],t.prototype,"servertListViewCrt",void 0),__decorate([y(cc.Node)],t.prototype,"servertListView",void 0),__decorate([y(o.default)],t.prototype,"selectListViewCrt",void 0),__decorate([y(cc.Node)],t.prototype,"selectView",void 0),__decorate([y(cc.Node)],t.prototype,"enterGamePanel",void 0),__decorate([y(cc.Button)],t.prototype,"StartBtn",void 0),__decorate([y(cc.SpriteAtlas)],t.prototype,"commondrop1",void 0),__decorate([y(cc.Node)],t.prototype,"tipWin",void 0),__decorate([y(cc.Label)],t.prototype,"tipLb",void 0),t=i=__decorate([g],t)}(cc.Component);i.default=m,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/Language":"Language","../../GlobalContext":"GlobalContext","../../Util/ReportSdkUtils":"ReportSdkUtils","../../Util/SDKUtils":"SDKUtils","../Commons/ListViewCtrl":"ListViewCtrl","../SDK/GameSDK":"GameSDK","../Tips/OpTipsController":"OpTipsController","./MyServersListItem":"MyServersListItem","./SelectListItem":"SelectListItem","./ServersListItem":"ServersListItem"}],ServerFightController:[function(e,t,i){"use strict";cc._RF.push(t,"7259anqwB9LpoYOfVV9ts0Q","ServerFightController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Controller"),o=e("../Manager/SceneManager"),a=e("../Prop/EntityProperty"),r=e("../Monster"),s=e("../../WarTeam/MonsterController"),l=e("../Pool/ActorPools"),c=e("./SceneController"),d=e("../View/ActorsLayer"),p=e("../../../Core/GameEventDispatcher"),h=e("../../../Core/Event"),u=e("../SceneEntity"),f=e("./FightController"),g=e("../../Status/StatusType"),y=e("../../Fight/staticattr"),m=e("../../../NetConnect/NetConnet"),C=e("../../../Core/Const/EntityType"),v=e("../../../Core/WindowManager"),_=e("../../../Core/TimeController"),b=e("../Effect/BuffTypeEffectUtils"),T=e("../../../Global/GlobalValue"),S=e("./SkillController"),I=e("../../Status/StatusController"),w=e("../../Role/RoleController"),D=e("../../Arena/ArenaController"),R=e("../../Activity/ActivityController"),A=e("../../Role/RoleTitle/RoleTitleController"),N=e("../../../Core/WindowType"),L=e("./FightTimeController"),E=e("../../Fight/FightUtils"),B=e("../../../Util/UtilsFight"),M=e("../../LoardCrusadeWin/LoardCrusadeCtrl"),x=cc._decorator,k=x.ccclass,P=(x.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.seed=0,t.timeOut=null,t.BossHp=null,t.monsterEnter=!0,t.isstartfight=!1,t.bossAttack=0,t.bossDefence=0,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){},t.prototype.listNotification=function(){i.instance=this,this.addProto("serverfight",this.serverfight,this),this.addProto("entityappear",this.entityappear,this),this.addProto("entitylist",this.entityappear,this),this.addProto("startfight",this.startfight,this),this.addProto("fightstep",this.fightstep,this),this.addProto("serverresult",this.serverresult,this)},t.prototype.serverresult=function(e){this.isstartfight=!1,o.default.instance.steptime=0,o.default.instance.fightresult=0==e.result,p.GameEventDispatcher.instance.emit(h.EventDefiner.SandTableMainClose),o.default.instance.fightresultType=g.ActivityStatus.value,f.default.instance.fightEnd(!0)},t.prototype.timingDamage=function(){if(g.ActivityStatus.value==g.ActivityStatus.WorldBoss){var e={cmd:"worldbossdamage",damage:o.default.instance.attackEnemyHpOnce};m.default.instance.sendProto(e);m.default.instance.sendProto({cmd:"worldbosshp"})}else if(g.ActivityStatus.value==g.ActivityStatus.EliteBoss){e={cmd:"ebdamage",index:R.default.instance.currElitIndex,damage:o.default.instance.attackEnemyHpOnce};m.default.instance.sendProto(e)}o.default.instance.attackEnemyHpOnce=0},t.prototype.serverfight=function(e){o.default.instance.mycamp=e.camp,this.seed=e.seed,o.default.instance.steptime=e.timeout?e.timeout:0,p.GameEventDispatcher.instance.emit(h.EventDefiner.Updata_Step_Time),this.monsterEnter=!0},t.prototype.entityappear=function(e){var t=this;if(p.GameEventDispatcher.instance.emit(h.EventDefiner.Updata_Step_Time),g.ActivityStatus.value!=g.ActivityStatus.Arena||1!=D.default.instance.isArenaNextFight||D.default.instance.isAddSaveServerEntitysCom){if(e.entity&&e.entity.length>0){o.default.instance.serverEntity=e.entity,e.entity[0].hp&&(this.BossHp=e.entity[0].hp);var i=0;o.default.instance.leftentitys.length<=0&&this.monsterEnter&&(i=c.default.instance.enterOffx,this.monsterEnter=!1),o.default.instance.serverEntity.forEach(function(e){t.createEntity(e,!0,i)}),i&&c.default.instance.playMonsterEnter()}}else D.default.instance.saveServerEntitys=D.default.instance.saveServerEntitys.concat(e.entity)},t.prototype.startfight=function(e){var t=this;if(this.isstartfight=!0,e)return v.default.instance.close(N.WindowType.SandTable),console.log("\u6c99\u76d8\u5173\u95ed\u540e\u518d\u5f00\u59cb\u6218\u6597"),void L.default.instance.setTimeout("serverstartfight",function(){L.default.instance.clearTimeout("serverstartfight"),t.startfight(null)},this,500);p.GameEventDispatcher.instance.emit(h.EventDefiner.FightUpdateArenaWait,{type:-1}),console.log("SceneController.instance.FightView.active"+c.default.instance.FightView.active);if(c.default.instance.FightView.active)var i=_.default.instance.setTimeout(function(){p.GameEventDispatcher.instance.emit(h.EventDefiner.C_Fight_Start),g.ActivityStatus.value!=g.ActivityStatus.WorldBoss&&g.ActivityStatus.value!=g.ActivityStatus.EliteBoss||(o.default.instance.attackEnemyHpOnce=0,t.timeOut&&(_.default.instance.clearInterval(t.timeOut),t.timeOut=null),t.timeOut=_.default.instance.setInterval(t.timingDamage,t,1e3)),_.default.instance.clearTimeout(i)},this,1500);else{console.log("\u672a\u5207\u6362\u5230\u6218\u6597\u573a\u666f\uff0c\u63a5\u6536\u5230\u670d\u52a1\u7aef\u5f00\u59cb\u6218\u6597\u534f\u8bae\u3002\u3002\u5ef6\u8fdf\u6267\u884c");var n=_.default.instance.setInterval(function(){c.default.instance.FightView.active&&(console.log("\u5207\u6362\u5230\u6218\u6597\u573a\u666f\uff0c\u6267\u884c\u5f00\u59cb\u6218\u6597\u534f\u8bae"),p.GameEventDispatcher.instance.emit(h.EventDefiner.C_Fight_Start),g.ActivityStatus.value!=g.ActivityStatus.WorldBoss&&g.ActivityStatus.value!=g.ActivityStatus.EliteBoss||(o.default.instance.attackEnemyHpOnce=0,t.timeOut&&(_.default.instance.clearInterval(t.timeOut),t.timeOut=null),t.timeOut=_.default.instance.setInterval(t.timingDamage,t,1e3)),_.default.instance.clearInterval(n))},this,1e3)}},t.prototype.fightstep=function(e){o.default.instance.enemystep=e.step,p.GameEventDispatcher.instance.emit(h.EventDefiner.Updata_StepNum)},t.prototype.createEntity=function(e,t,i){void 0===t&&(t=!0),void 0===i&&(i=0);var n=new a.EntityProperty;n.handle=e.handle,n.spineId=e.model,n.type=e.type,n.selfMonster=e.camp==o.default.instance.mycamp,i&&(i=n.selfMonster?-i:i),n.camp=e.camp;var p,h=[],m=new y.StaticAttr;if(m.PushAttr(e.attr),n.maxHP=m.GetMaxHp(),n.hp=m.GetMaxHp(),n.attr=m,e.hp?(n.attr.ChangeAtt(T.AttrType.MaxHp,e.hp),n.hp=e.hp):g.ActivityStatus.value==g.ActivityStatus.LoardCrusade&&e.id==M.default.instance.bossID&&(n.attr.ChangeAtt(T.AttrType.MaxHp,1e22),n.hp=1e22,this.bossAttack=m.GetAttack(),this.bossDefence=m.GetDefence()),n.dir=n.selfMonster?-1:1,e.type==C.EntityType.enMonster)n.cardid=e.id,n.grade=e.grade,n.cultivateLv=e.level,n.spineId=s.default.instance.getCardGradeBySpine(n.cardid,n.grade),n.spineName=s.default.instance.getCardGradeBySpineName(n.cardid,n.grade),n.monsterConf=s.default.instance.getMonsterConf(n.cardid,n.grade,n.cultivateLv),h=(h=h.concat(S.default.instance.getNormalSkillList(n.cardid,n.grade))).concat(S.default.instance.getBigSkillList(n.cardid,n.grade)),n.moveSpeed=n.monsterConf.moveSpeed,n.scale=n.monsterConf.scenescale,n.originalName=s.default.instance.GetMonsterInfo(n.cardid).cardName,n.selfMonster?n.x=-o.default.instance.fightSceneWidth/2+this.getActorRandX(s.default.instance.getCardConfCardType(n.cardid))+i:n.x=o.default.instance.fightSceneWidth/2-this.getActorRandX(s.default.instance.getCardConfCardType(n.cardid))+i,B.default.countAdditionAttrs(n.attr.attr_,n.CardType),n.y=-300+Math.floor(150*this.Random()),n.otherAttr=s.default.instance.GetMonsterInfo(n.cardid).otherAttr,p=l.ActorPools.returnMonster(n).getComponent(r.default),c.default.instance.addBigSkillIcon(p),b.default.instance.addOneEffect(p,T.BuffEffectName.ZHAOHUAN2),b.default.instance.addOneEffect(p,T.BuffEffectName.ZHAOHUAN3),g.ActivityStatus.value!=g.ActivityStatus.WorldBoss&&g.ActivityStatus.value!=g.ActivityStatus.EliteBoss&&g.ActivityStatus.value!=g.ActivityStatus.LoardCrusade||!n.isBoss||(p.getComponent(u.default).isShowBloodBar=!1);else if(e.type==C.EntityType.enActor){void 0==n.spineId&&console.log("\u670d\u52a1\u7aef\u6ca1\u6709\u53d1\u89d2\u8272id , \u524d\u7aef\u6682\u65f6\u8fc7\u6ee4\u62a5\u9519\u89c1\u5230\u6b64\u62a5\u9519\u901f\u627e\u670d\u52a1\u7aef\u4fee\u590d"),n.spineId=void 0==n.spineId?1:n.spineId;var v=w.default.instance.getModelConfByModelId(n.spineId);n.moveSpeed=v.moveSpeed,n.scale=v.scenescale,n.monsterConf=v,n.x=(o.default.instance.fightSceneWidth/2-120)*n.dir+i,n.y=-200,h=h.concat(S.default.instance.getRoleNormalSkillList(n.spineId)),n.selfMonster?(o.default.instance.myRole=l.ActorPools.createPlayer(n),p=o.default.instance.myRole.getComponent(u.default)):(o.default.instance.otherRole=l.ActorPools.createPlayer(n),p=o.default.instance.otherRole.getComponent(u.default)),p.onShowRoleTitle(A.default.instence.getTitleIconNameByType(e.title))}var _=[];if(e.skills){!n.selfMonster&&e.skills.length&&e.type==C.EntityType.enActor&&E.FightUtils.setFaShionSkill(e.skills);for(var I=function(i){var n=null,o=null,a=null;if(t?(n=h.find(function(t){return e.skills[i].id==t.skillid}),o=e.skills[i].id,a=e.skills[i].level):(n=h.find(function(t){return e.skills[i].skillid==t.skillid}),o=e.skills[i].skillid,a=e.skills[i].skilllv),!n&&0!=a){var r={skillid:o,skilllv:a};_.push(r)}},D=0;D<e.skills.length;D++)I(D)}n.skillList=h.concat(_),n.attr.skills=n.skillList,n.selfMonster?o.default.instance.leftFight+=n.fight:o.default.instance.rightFight+=n.fight,p.avatar.body.playRate=o.default.instance.fightViewPlayRate,c.default.instance.addEntitys(p),d.default.instance.addActorObj_toScene(p);var R=c.default.instance.setCardEntity(n),N=o.default.instance.fightlogic.PushEntity(R);f.default.instance.updateFight(N),e.type==C.EntityType.enMonster&&e.id>9e4&&c.default.instance.addBigSkillIcon(p,!0)},t.prototype.getActorRandX=function(e){var t=0;switch(e){case 1:t=Math.floor(201+200*this.Random());break;case 2:t=Math.floor(151+150*this.Random());break;case 3:t=Math.floor(1+200*this.Random())}return t},t.prototype.Random=function(){if(I.default.instance.isSingle)return Math.random();return this.seed=(9301*this.seed+49297)%233280,0+1*(this.seed/233280)},t.instance=null,t=i=__decorate([k],t)}(n.default));i.default=P,cc._RF.pop()},{"../../../Core/Const/EntityType":"EntityType","../../../Core/Controller":"Controller","../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/TimeController":"TimeController","../../../Core/WindowManager":"WindowManager","../../../Core/WindowType":"WindowType","../../../Global/GlobalValue":"GlobalValue","../../../NetConnect/NetConnet":"NetConnet","../../../Util/UtilsFight":"UtilsFight","../../Activity/ActivityController":"ActivityController","../../Arena/ArenaController":"ArenaController","../../Fight/FightUtils":"FightUtils","../../Fight/staticattr":"staticattr","../../LoardCrusadeWin/LoardCrusadeCtrl":"LoardCrusadeCtrl","../../Role/RoleController":"RoleController","../../Role/RoleTitle/RoleTitleController":"RoleTitleController","../../Status/StatusController":"StatusController","../../Status/StatusType":"StatusType","../../WarTeam/MonsterController":"MonsterController","../Effect/BuffTypeEffectUtils":"BuffTypeEffectUtils","../Manager/SceneManager":"SceneManager","../Monster":"Monster","../Pool/ActorPools":"ActorPools","../Prop/EntityProperty":"EntityProperty","../SceneEntity":"SceneEntity","../View/ActorsLayer":"ActorsLayer","./FightController":"FightController","./FightTimeController":"FightTimeController","./SceneController":"SceneController","./SkillController":"SkillController"}],ServerMonsterVo:[function(e,t,i){"use strict";cc._RF.push(t,"579b0p4ORZAgaF0FZ682AmC","ServerMonsterVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){return function(){this.cardid=0,this.level=0,this.grade=0,this.count=0}}();i.ServerMonsterVo=n,cc._RF.pop()},{}],ServersListItem:[function(e,t,i){"use strict";cc._RF.push(t,"77e231xsIhBIqtu3rYoRd+r","ServersListItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("./SelectServersPanel"),a=e("../../Core/Language"),r=cc._decorator,s=r.ccclass,l=r.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.index=0,t.data=null,t.curserverstatus=null,t.serverNumLabel=null,t.serverNameLabel=null,t}return __extends(t,e),t.prototype.start=function(){this.node.on(cc.Node.EventType.TOUCH_END,this.onSelect,this)},t.prototype.setData=function(e,t){this.data=e,this.index=t,this.curserverstatus.spriteFrame=o.default.instance.getStatusSprite(e.status),this.serverNumLabel.string=e.server_id+a.default.getStr("\u533a"),this.serverNumLabel.string=decodeURIComponent(e.name+"")},t.prototype.onSelect=function(){o.default.instance.setServertListItem(this.data)},t.prototype.hide=function(){this.node.off(cc.Node.EventType.TOUCH_END,this.onSelect)},__decorate([l(cc.Sprite)],t.prototype,"curserverstatus",void 0),__decorate([l(cc.Label)],t.prototype,"serverNumLabel",void 0),__decorate([l(cc.Label)],t.prototype,"serverNameLabel",void 0),t=__decorate([s],t)}(n.default);i.default=c,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/Widget":"Widget","./SelectServersPanel":"SelectServersPanel"}],SettingData:[function(e,t,i){"use strict";cc._RF.push(t,"db67dreyYhKjox4jA//kGnz","SettingData"),Object.defineProperty(i,"__esModule",{value:!0});var n=cc._decorator,o=n.ccclass,a=(n.property,function(){function e(){}return Object.defineProperty(e,"musicBgm",{get:function(){return Boolean("true"==localStorage.getItem(r.musicBgm)||null==localStorage.getItem(r.musicBgm))},enumerable:!0,configurable:!0}),Object.defineProperty(e,"soundEffect",{get:function(){return Boolean("true"==localStorage.getItem(r.soundEffect)||null==localStorage.getItem(r.soundEffect))},enumerable:!0,configurable:!0}),Object.defineProperty(e,"musicSize",{get:function(){return localStorage.getItem(r.musicSize)?Number(localStorage.getItem(r.musicSize)):1},enumerable:!0,configurable:!0}),Object.defineProperty(e,"soundEffectSize",{get:function(){return localStorage.getItem(r.soundEffectSize)?Number(localStorage.getItem(r.soundEffectSize)):1},enumerable:!0,configurable:!0}),Object.defineProperty(e,"isFiveEffect",{get:function(){return Boolean("true"==localStorage.getItem(r.isFiveEffect))},enumerable:!0,configurable:!0}),Object.defineProperty(e,"isAutomaticMode",{get:function(){return Boolean("true"==localStorage.getItem(r.isAutomaticMode))},enumerable:!0,configurable:!0}),Object.defineProperty(e,"isFightTalk",{get:function(){return Boolean("true"==localStorage.getItem(r.fightTalk))},enumerable:!0,configurable:!0}),e.currMusic=null,e=__decorate([o],e)}());i.default=a;var r=function(){function e(){}return e.musicBgm="musicBgm",e.soundEffect="soundEffect",e.musicSize="musicSize",e.soundEffectSize="soundEffectSize",e.fightTalk="fightTalk",e.isFiveEffect="isFiveEffect",e.isAutomaticMode="isAutomaticMode",e}();i.SettiingType=r,cc._RF.pop()},{}],SettingWin:[function(e,t,i){"use strict";cc._RF.push(t,"c8dfb73r5NOipBm5ejXbmIY","SettingWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Commons/CommonPageBG"),o=e("../../Core/Language"),a=e("../Gamelayer/RoleHead"),r=e("../Role/RoleInfo"),s=e("../Sound/SoundController"),l=e("../../GlobalContext"),c=e("../../Core/GameEventDispatcher"),d=e("./SettingData"),p=e("../OpenWin/OpenWinController"),h=e("../../Core/WindowType"),u=e("./SettingData"),f=e("../Role/RoleStrengthen/RoleStrengthenController"),g=e("../../Util/SDKUtils"),y=cc._decorator,m=y.ccclass,C=y.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.music=null,t.soundEffect=null,t.musicProgressBar=null,t.soundEffectProgressBar=null,t.musicSlider=null,t.soundEffectSlider=null,t.fiveEffect=null,t.automaticMode=null,t.fightTalk=null,t.roleHead=null,t.nameLabe=null,t.fightNumLabe=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),this.onInit(893,593,o.default.getStr("\u8bbe\u7f6e"),!1),this.info(),c.GameEventDispatcher.instance.on("RoleNameChange",this.setName,this)},t.prototype.hide=function(){e.prototype.hide.call(this),c.GameEventDispatcher.instance.off("RoleNameChange",this.setName,this)},t.prototype.setName=function(){this.nameLabe.string=r.MyRoleInfo.name},t.prototype.info=function(){this.roleHead.SetHead(r.MyRoleInfo.icon),this.setName(),this.fightNumLabe.string=f.default.instence.strengthenData.currentFight+"",this.music.getChildByName("checkmark").active=d.default.musicBgm,this.soundEffect.getChildByName("checkmark").active=d.default.soundEffect,this.musicSlider.progress=d.default.musicSize,this.musicProgressBar.progress=this.musicSlider.progress,this.soundEffectSlider.progress=d.default.soundEffectSize,this.soundEffectProgressBar.progress=this.soundEffectSlider.progress,this.fiveEffect.getChildByName("checkmark").active=d.default.isFiveEffect,this.automaticMode.getChildByName("checkmark").active=d.default.isAutomaticMode,this.fightTalk.getChildByName("checkmark").active=u.default.isFightTalk},t.prototype.setMusic=function(){this.music.getChildByName("checkmark").active?(s.default.instance.StopBGM(),this.music.getChildByName("checkmark").active=!1,localStorage.setItem(d.SettiingType.musicBgm,this.music.getChildByName("checkmark").active+"")):(this.music.getChildByName("checkmark").active=!0,localStorage.setItem(d.SettiingType.musicBgm,this.music.getChildByName("checkmark").active+""),s.default.instance.PlayBGM(u.default.currMusic))},t.prototype.setSoundEffect=function(){this.soundEffect.getChildByName("checkmark").active?(s.default.instance.StopEffect(),this.soundEffect.getChildByName("checkmark").active=!1):(l.PlayerData.SoundPlaying=!0,this.soundEffect.getChildByName("checkmark").active=!0),localStorage.setItem(d.SettiingType.soundEffect,this.soundEffect.getChildByName("checkmark").active+"")},t.prototype.setFiveEffect=function(){this.setToggle(this.fiveEffect),localStorage.setItem(d.SettiingType.isFiveEffect,this.fiveEffect.getChildByName("checkmark").active+"")},t.prototype.setAutomaticMode=function(){this.setToggle(this.automaticMode),localStorage.setItem(d.SettiingType.isAutomaticMode,this.automaticMode.getChildByName("checkmark").active+"")},t.prototype.setFightTalk=function(){this.setToggle(this.fightTalk),localStorage.setItem(d.SettiingType.fightTalk,this.fightTalk.getChildByName("checkmark").active+"")},t.prototype.setToggle=function(e){e.getChildByName("checkmark").active?e.getChildByName("checkmark").active=!1:e.getChildByName("checkmark").active=!0},t.prototype.setMusicSize=function(){this.musicProgressBar.progress=this.musicSlider.progress,localStorage.setItem(d.SettiingType.musicSize,this.musicSlider.progress+""),c.GameEventDispatcher.instance.emit("MusicSize",this.musicSlider.progress)},t.prototype.setSoundEffectSize=function(){this.soundEffectProgressBar.progress=this.soundEffectSlider.progress,localStorage.setItem(d.SettiingType.soundEffectSize,this.soundEffectSlider.progress+""),c.GameEventDispatcher.instance.emit("SoundEffectSize",this.soundEffectSlider.progress)},t.prototype.switchAccount=function(){g.default.instance.platformSdk.logout()},t.prototype.exitGame=function(){g.default.instance.platformSdk.exit()},t.prototype.openNickNameChange=function(){p.default.instance.openWindow(h.WindowType.NickNameChange)},__decorate([C(cc.Node)],t.prototype,"music",void 0),__decorate([C(cc.Node)],t.prototype,"soundEffect",void 0),__decorate([C(cc.ProgressBar)],t.prototype,"musicProgressBar",void 0),__decorate([C(cc.ProgressBar)],t.prototype,"soundEffectProgressBar",void 0),__decorate([C(cc.Slider)],t.prototype,"musicSlider",void 0),__decorate([C(cc.Slider)],t.prototype,"soundEffectSlider",void 0),__decorate([C(cc.Node)],t.prototype,"fiveEffect",void 0),__decorate([C(cc.Node)],t.prototype,"automaticMode",void 0),__decorate([C(cc.Node)],t.prototype,"fightTalk",void 0),__decorate([C(a.default)],t.prototype,"roleHead",void 0),__decorate([C(cc.Label)],t.prototype,"nameLabe",void 0),__decorate([C(cc.Label)],t.prototype,"fightNumLabe",void 0),t=__decorate([m],t)}(n.default);i.default=v,cc._RF.pop()},{"../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/SDKUtils":"SDKUtils","../Commons/CommonPageBG":"CommonPageBG","../Gamelayer/RoleHead":"RoleHead","../OpenWin/OpenWinController":"OpenWinController","../Role/RoleInfo":"RoleInfo","../Role/RoleStrengthen/RoleStrengthenController":"RoleStrengthenController","../Sound/SoundController":"SoundController","./SettingData":"SettingData"}],SevenDayGoalCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"3fdf6kzwZxMzqUZk2r6FvJM","SevenDayGoalCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Controller"),o=e("./SevenDayGoalData"),a=e("../../../Core/Event"),r=e("../../../NetConnect/NetConnet"),s=e("../../../Core/GameEventDispatcher"),l=e("../ActivityCtrl"),c=e("../../../Core/WindowType"),d=cc._decorator,p=d.ccclass,h=(d.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.data=null,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.listNotification=function(){i.instance=this,this.data=new o.default},t.prototype.resSevenDayreGoal=function(e){this.data.setData(e),s.GameEventDispatcher.instance.emit(a.EventDefiner.Activity_sevendaygoalUP)},t.prototype.reqSevenDayGoalInfo=function(e){var t={cmd:"sevendaygoalinfo",actid:e};r.default.instance.sendProto(t)},t.prototype.reqSevenDayGoal=function(e,t,i){var n={cmd:"sevendaygoal",actid:e,type:t,index:i};r.default.instance.sendProto(n)},t.prototype.reqProto=function(){var e=l.default.instance.data.getYunyingId(c.WindowType.SevenDayGoal);this.reqSevenDayGoalInfo(e)},t.instance=null,t=i=__decorate([p],t)}(n.default));i.default=h,cc._RF.pop()},{"../../../Core/Controller":"Controller","../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/WindowType":"WindowType","../../../NetConnect/NetConnet":"NetConnet","../ActivityCtrl":"ActivityCtrl","./SevenDayGoalData":"SevenDayGoalData"}],SevenDayGoalData:[function(e,t,i){"use strict";cc._RF.push(t,"fb305ylHXtAK5hBOwlk0DbE","SevenDayGoalData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../ActivityCtrl"),o=e("../../../Core/WindowType"),a=function(){function e(){this._data={}}return e.prototype.getData=function(e){return this._data[e]},e.prototype.setData=function(e){for(var t=e.conf.goalConf,i=e.rewardRecord,n=0;n<Object.keys(i).length;n++){this._data[n]?this._data[n]=[]:this._data[n]=new Array;var o=i[n].goalRecord,a=i[n].curLayer,r=i[n].goalType;for(var s in o){var l=o[s].rewardState,c=t[n].goalType[s],d=parseInt(s);this._data[n].push({flag:l,id:d,curLayer:a,goalType:r,cfg:c})}}this.srotData(),this.setRedDot(e)},e.prototype.srotData=function(){for(var e in this._data){var t=[],i=[],n=[];for(var o in this._data[e])1==this._data[e][o].flag&&t.push(this._data[e][o]),0==this._data[e][o].flag&&i.push(this._data[e][o]),2==this._data[e][o].flag&&n.push(this._data[e][o]);t=t.concat(i,n),this._data[parseInt(e)]=t}},e.prototype.setRedDot=function(e){var t=!1;if(e){var i=e.rewardRecord;for(var a in i){var r=i[a].goalRecord;for(var s in r){if(t)break;t=1==r[s].rewardState}}}n.default.instance.data.setRedFlag(o.WindowType.SevenDayGoal,t)},e.prototype.getReddot=function(e){var t=!1,i=this.getData(e);if(i)for(var n in i)if(1==i[n].flag){t=!0;break}return t},e}();i.default=a,cc._RF.pop()},{"../../../Core/WindowType":"WindowType","../ActivityCtrl":"ActivityCtrl"}],SevenDayGoalItem:[function(e,t,i){"use strict";cc._RF.push(t,"7219eFyhLxFqKReA6m3EBde","SevenDayGoalItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../Commons/RewardUtils"),a=e("../../../Util/Utils"),r=e("../../../Core/WindowType"),s=e("../../Item/ItemIcon"),l=e("../../../Core/Language"),c=e("./SevenDayGoalCtrl"),d=e("../ActivityCtrl"),p=e("../../OpenWin/OpenWinController"),h=e("../../../Core/Event"),u=e("../../../Core/GameEventDispatcher"),f=e("../../Status/StatusType"),g=e("../../../Core/LoadManager"),y=e("../../../GlobalContext"),m=cc._decorator,C=m.ccclass,v=(m.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._data=null,t}return __extends(t,e),t.prototype.onDisable=function(){e.prototype.onDisable.call(this)},t.prototype.setData=function(e){this._data=e;var t=this.node.getChildByName("bg");t.getChildByName("title").getComponent(cc.Label).string=e.cfg.desc,t.getChildByName("num").getComponent(cc.Label).string=l.default.getStr("robbery_house_Exp",e.curLayer,e.cfg.layer);var i=o.default.instance.getItemList(e.cfg.rewardId),n=this.node.getChildByName("itemList");a.default.setNodeChildDestoryByUrl(n,y.GlobalContext.Root+"prefab/Bag/ItemIcon"),g.default.instance.loadResByType(y.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(e){for(var t in i){var o=a.default.getNodeByUrl(e,y.GlobalContext.Root+"prefab/Bag/ItemIcon");o.scale=.7*o.scale,o.getComponent(s.default).ItemData(i[t],!1,""+i[t].count,!0),n.addChild(o)}},this);var r=this.node.getChildByName("btn_01");r.active=e.flag>0,this.node.getChildByName("btn_02").active=0==e.flag,1==e.flag?(r.getComponent(cc.Button).interactable=!0,r.getChildByName("Label").getComponent(cc.Label).string=l.default.getStr("\u9886 \u53d6")):2==e.flag&&(r.getComponent(cc.Button).interactable=!1,r.getChildByName("Label").getComponent(cc.Label).string=l.default.getStr("\u5df2\u9886\u53d6"))},t.prototype.onClickBtn=function(e,t){if(0==parseInt(t)){var i=d.default.instance.data.getYunyingId(r.WindowType.SevenDayGoal);c.default.instance.reqSevenDayGoal(i,this._data.goalType,this._data.id)}else{var n=0;switch(this._data.goalType){case 0:n=r.WindowType.Expedition;break;case 1:n=r.WindowType.EquipCopyMain;break;case 2:return void u.GameEventDispatcher.instance.emit(h.EventDefiner.ChangeActivityStatus,f.ActivityStatus.TotemsCopy)}p.default.instance.openWindow(n)}},t=__decorate([C],t)}(n.default));i.default=v,cc._RF.pop()},{"../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Core/LoadManager":"LoadManager","../../../Core/Widget":"Widget","../../../Core/WindowType":"WindowType","../../../GlobalContext":"GlobalContext","../../../Util/Utils":"Utils","../../Commons/RewardUtils":"RewardUtils","../../Item/ItemIcon":"ItemIcon","../../OpenWin/OpenWinController":"OpenWinController","../../Status/StatusType":"StatusType","../ActivityCtrl":"ActivityCtrl","./SevenDayGoalCtrl":"SevenDayGoalCtrl"}],SevenDayGoalView:[function(e,t,i){"use strict";cc._RF.push(t,"5394a2RZCNONqU05T/TL/vF","SevenDayGoalView"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../Commons/ListViewCtrl"),a=e("./SevenDayGoalCtrl"),r=e("./SevenDayGoalItem"),s=e("../../../Core/Event"),l=e("../../../Core/GameEventDispatcher"),c=e("../../../Util/Utils"),d=cc._decorator,p=d.ccclass,h=d.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lsitViewCtrl=null,t._selectIndex=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this),this.initTab(),this.onClickTab(null,0),a.default.instance.reqProto(),l.GameEventDispatcher.instance.emit(s.EventDefiner.Activity_countdown,this),l.GameEventDispatcher.instance.on(s.EventDefiner.Activity_sevendaygoalUP,this.setItemData,this)},t.prototype.hide=function(){e.prototype.hide.call(this),this._selectIndex=null,l.GameEventDispatcher.instance.emit(s.EventDefiner.Activity_resetTimeout,this),l.GameEventDispatcher.instance.off(s.EventDefiner.Activity_sevendaygoalUP,this.setItemData,this)},t.prototype.initTab=function(){var e=this.node.getChildByName("top");for(var t in e.children)e.children[t].getChildByName("img2").active=!1},t.prototype.setSelectTab=function(e){var t=this.node.getChildByName("top");t.children[this._selectIndex]&&(t.children[this._selectIndex].getChildByName("img2").active=!1),this._selectIndex=e,t.children[this._selectIndex]&&(t.children[this._selectIndex].getChildByName("img2").active=!0)},t.prototype.setBigImg=function(){var e="resources/Activity/OpenService/SevenDayGoal/bg_"+this._selectIndex+".png";c.default.setImage(this.node.getChildByName("img"),e)},t.prototype.setItemData=function(){var e=a.default.instance.data.getData(this._selectIndex);e&&(this.setData(e),this.upRedDot())},t.prototype.setData=function(e){this.lsitViewCtrl.refreshItem=this.updateitem,this.lsitViewCtrl.refreshItemThis=this,this.lsitViewCtrl.initialize(e),this.lsitViewCtrl.scrollToTop()},t.prototype.updateitem=function(e,t){var i=this.lsitViewCtrl.dataLsit[t];e.getComponent(r.default).setData(i)},t.prototype.onClickTab=function(e,t){this.setSelectTab(parseInt(t)),this.setBigImg(),this.setItemData()},t.prototype.upRedDot=function(){var e=this.node.getChildByName("top");for(var t in e.children){var i=a.default.instance.data.getReddot(parseInt(t));e.children[t].getChildByName("red").active=i}},__decorate([h(o.default)],t.prototype,"lsitViewCtrl",void 0),t=__decorate([p],t)}(n.default);i.default=u,cc._RF.pop()},{"../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Widget":"Widget","../../../Util/Utils":"Utils","../../Commons/ListViewCtrl":"ListViewCtrl","./SevenDayGoalCtrl":"SevenDayGoalCtrl","./SevenDayGoalItem":"SevenDayGoalItem"}],SevenDayLoginCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"b15d0mCPRtPz5XSVrjv+F59","SevenDayLoginCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./SevenDayLoginData"),o=e("../../../Core/Controller"),a=e("../../../Core/Event"),r=e("../../../NetConnect/NetConnet"),s=e("../../../Core/GameEventDispatcher"),l=e("../ActivityCtrl"),c=e("../../../Core/WindowType"),d=cc._decorator,p=d.ccclass,h=(d.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.data=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.data=new n.default},t.prototype.listNotification=function(){i.instance=this,this.addProto(a.EventDefiner.Activity_sevendaylogin,this.resSevendaylogin,this),s.GameEventDispatcher.instance.on(a.EventDefiner.Activity_YunyingUP,this.reqProto,this)},t.prototype.resSevendaylogin=function(e){this.data.setData(e.rewardRecord),s.GameEventDispatcher.instance.emit(a.EventDefiner.Activity_sevendayloginUp)},t.prototype.reqsevendaylogin=function(e,t){var i={cmd:"sevendaylogin",actid:e,index:t};r.default.instance.sendProto(i)},t.prototype.reqSevendaylogininfo=function(e){var t={cmd:"sevendaylogininfo",actid:e};r.default.instance.sendProto(t)},t.prototype.reqProto=function(){var e=l.default.instance.data.getYunyingId(c.WindowType.SevenDayLogin);this.reqSevendaylogininfo(e)},t.instance=null,t=i=__decorate([p],t)}(o.default));i.default=h,cc._RF.pop()},{"../../../Core/Controller":"Controller","../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/WindowType":"WindowType","../../../NetConnect/NetConnet":"NetConnet","../ActivityCtrl":"ActivityCtrl","./SevenDayLoginData":"SevenDayLoginData"}],SevenDayLoginData:[function(e,t,i){"use strict";cc._RF.push(t,"c63f7U+kCxINqXg20LaCvVd","SevenDayLoginData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/ConfigsManager"),o=e("../ActivityCtrl"),a=e("../../../Core/WindowType"),r=cc._decorator,s=r.ccclass,l=(r.property,function(){function e(){this._cfg=null,this._reward=[],this._cfg=n.ConfigsManager.instance.getConfigs("sevendayloginconf")}return e.prototype.getSvevnDayIdx=function(e){return this._cfg.SevenDayLogin[e].sevenDay},e.prototype.getCfgData=function(e){var t=this.getSvevnDayIdx(e);return this._cfg.sevenDay[t]},e.prototype.setData=function(e){this._reward=e,this.setRedDot()},e.prototype.setRedDot=function(){var e=!1;for(var t in this._reward){if(e)break;e=1==this.getRewardFlag(parseInt(t))}o.default.instance.data.setRedFlag(a.WindowType.SevenDayLogin,e)},e.prototype.getRewardFlag=function(e){return this._reward&&this._reward[e]?this._reward[e]:0},e=__decorate([s],e)}());i.default=l,cc._RF.pop()},{"../../../Core/ConfigsManager":"ConfigsManager","../../../Core/WindowType":"WindowType","../ActivityCtrl":"ActivityCtrl"}],SevenDayLoginRewardCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"bbf884Z99pCirD//uJtgbRw","SevenDayLoginRewardCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./SevenDayLoginRewardData"),o=e("../../../Core/Controller"),a=e("../../../Core/Event"),r=e("../../ActivityView/ActivityCtrl"),s=e("../../Functionicon/FunctionIconController"),l=e("../../../Core/WindowType"),c=e("../../Commons/WindowOpenUtils"),d=e("../../../Core/GameEventDispatcher"),p=cc._decorator,h=p.ccclass,u=(p.property,function(e){function t(){var t=e.call(this)||this;return t._data=null,i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.listNotification=function(){this.addProto(a.EventDefiner.newlogin,this.newlogin,this),d.GameEventDispatcher.instance.on(a.EventDefiner.openserverday_up,this.openWelfareLobby,this)},Object.defineProperty(t.prototype,"data",{get:function(){return this._data||(this._data=new n.default),this._data},enumerable:!0,configurable:!0}),t.prototype.newlogin=function(){this.openWelfareLobby()},t.prototype.openWelfareLobby=function(){var e=r.default.instance.data.getOpenDay();if(e){var t=this.data.getIsChecked();s.default.instance.checkIsOpenbyWindowtype(l.WindowType.WelfareLobby)&&e<=7&&!t&&!this.data.flag&&(c.default.instance.openWindowType(l.WindowType.WelfareLobby),this.data.flag=!0)}},t.instance=null,t=i=__decorate([h],t)}(o.default));i.default=u,cc._RF.pop()},{"../../../Core/Controller":"Controller","../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/WindowType":"WindowType","../../ActivityView/ActivityCtrl":"ActivityCtrl","../../Commons/WindowOpenUtils":"WindowOpenUtils","../../Functionicon/FunctionIconController":"FunctionIconController","./SevenDayLoginRewardData":"SevenDayLoginRewardData"}],SevenDayLoginRewardData:[function(e,t,i){"use strict";cc._RF.push(t,"2512dgSn7dFy7F0BslwObv5","SevenDayLoginRewardData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/ConfigsManager"),o=e("../../ActivityView/ActivityCtrl"),a=e("../../../Core/TimeController"),r=e("../../../Util/LocalStorageUtils"),s=function(){function e(){this._cfg=null,this._flag=!1}return Object.defineProperty(e.prototype,"cfg",{get:function(){return this._cfg||(this._cfg=n.ConfigsManager.instance.getConfigs("SevenDayLoginReward")),this._cfg},enumerable:!0,configurable:!0}),e.prototype.setIsChecked=function(e){var t={flag:e,time:a.default.instance.ServerTimeMins};r.default.instance.setItem("SevenDayLoginReward_isChecked",t)},e.prototype.getIsChecked=function(){var e=!1,t=o.default.instance.data.getOpenDay(),i=r.default.instance.getItem("SevenDayLoginReward_isChecked");if(t<=7&&i){var n=new Date(i.time).getDate(),s=new Date(a.default.instance.ServerTimeMins).getDate(),l=!!i&&i.flag;n!=s&&(l=!1,this.setIsChecked(!1)),e=l}return e},Object.defineProperty(e.prototype,"flag",{get:function(){return this._flag},set:function(e){this._flag=e},enumerable:!0,configurable:!0}),e}();i.default=s,cc._RF.pop()},{"../../../Core/ConfigsManager":"ConfigsManager","../../../Core/TimeController":"TimeController","../../../Util/LocalStorageUtils":"LocalStorageUtils","../../ActivityView/ActivityCtrl":"ActivityCtrl"}],SevenDayLoginRewardItem:[function(e,t,i){"use strict";cc._RF.push(t,"43cacKn0vVIa4AD8XVnZTN/","SevenDayLoginRewardItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Util/Utils"),a=e("../../ActivityView/ActivityCtrl"),r=e("../../Commons/WindowOpenUtils"),s=cc._decorator,l=s.ccclass,c=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.image=null,t.btn=null,t._day=null,t._data=null,t}return __extends(t,e),t.prototype.setData=function(e,t){this._data=e,this._day=t,this.setImage(e.imgName),this.setBtn()},t.prototype.setImage=function(e){var t="resources/welfarelobby/"+e+".png";o.default.setImage(this.image,t)},t.prototype.setBtn=function(){var e=a.default.instance.data.getOpenDay();this.btn.interactable=e==this._day},t.prototype.onClickBtn=function(){var e=this._data.openWinID,t=this._data.tagIndex?this._data.tagIndex:0;r.default.instance.openWindowType(e,t)},__decorate([c(cc.Node)],t.prototype,"image",void 0),__decorate([c(cc.Button)],t.prototype,"btn",void 0),t=__decorate([l],t)}(n.default);i.default=d,cc._RF.pop()},{"../../../Core/Widget":"Widget","../../../Util/Utils":"Utils","../../ActivityView/ActivityCtrl":"ActivityCtrl","../../Commons/WindowOpenUtils":"WindowOpenUtils"}],SevenDayLoginRewardView:[function(e,t,i){"use strict";cc._RF.push(t,"d95cbv8RkJDjLKgQQF9QGZP","SevenDayLoginRewardView"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("./SevenDayLoginRewardCtrl"),a=e("../../../Util/Utils"),r=e("./SevenDayLoginRewardItem"),s=e("../../ActivityView/ActivityCtrl"),l=cc._decorator,c=l.ccclass,d=l.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollView=null,t.toggle=null,t.childNode=null,t}return __extends(t,e),t.prototype.show=function(){this.setItemList(),this.setToggle()},t.prototype.setItemList=function(){var e=o.default.instance.data.cfg.SevenDayLoginReward,t=s.default.instance.data.getOpenDay();for(var i in a.default.setNodeChildDestroy(this.scrollView.content),e){(n=cc.instantiate(this.childNode)).getComponent(r.default).setData(e[i],parseInt(i)),n.active=!0,this.scrollView.content.addChild(n)}if(t<=7){var n=this.scrollView.content.children[t-1];this.scrollView.scrollToOffset(cc.v2(n.x,0))}else this.scrollView.scrollToLeft()},t.prototype.setToggle=function(){this.toggle.isChecked=o.default.instance.data.getIsChecked()},t.prototype.onClickToggle=function(e){var t=o.default.instance.data.getIsChecked();this.toggle.isChecked=!t,o.default.instance.data.setIsChecked(!t)},__decorate([d(cc.ScrollView)],t.prototype,"scrollView",void 0),__decorate([d(cc.Toggle)],t.prototype,"toggle",void 0),__decorate([d(cc.Node)],t.prototype,"childNode",void 0),t=__decorate([c],t)}(n.default);i.default=p,cc._RF.pop()},{"../../../Core/Widget":"Widget","../../../Util/Utils":"Utils","../../ActivityView/ActivityCtrl":"ActivityCtrl","./SevenDayLoginRewardCtrl":"SevenDayLoginRewardCtrl","./SevenDayLoginRewardItem":"SevenDayLoginRewardItem"}],SevenDayLoginView:[function(e,t,i){"use strict";cc._RF.push(t,"e39a9x7HV5OE4hKhf6AHfmf","SevenDayLoginView"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../Item/ItemData"),a=e("../ActivityCtrl"),r=e("./SevenDayLoginCtrl"),s=e("../../Commons/RewardUtils"),l=e("../../../Util/Utils"),c=e("../../../Core/WindowType"),d=e("../../Item/ItemIcon"),p=e("../../../Core/GameEventDispatcher"),h=e("../../../Core/Event"),u=e("../../../Core/Language"),f=e("../../../Core/LoadManager"),g=e("../../../GlobalContext"),y=cc._decorator,m=y.ccclass,C=y.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.imgs=null,t.topNode=null,t._selectIndex=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this),r.default.instance.reqProto(),p.GameEventDispatcher.instance.emit(h.EventDefiner.Activity_countdown,this);for(var t=0,i=r.default.instance.data._reward,n=0;n<i.length;n++)1==i[n]&&(t=n);this.onClckDayBtn(null,t),p.GameEventDispatcher.instance.on(h.EventDefiner.Activity_sevendayloginUp,this.setShowData,this)},t.prototype.hide=function(){e.prototype.hide.call(this),this._selectIndex=null,p.GameEventDispatcher.instance.emit(h.EventDefiner.Activity_resetTimeout,this),p.GameEventDispatcher.instance.off(h.EventDefiner.Activity_sevendayloginUp,this.setShowData,this)},t.prototype.setShowData=function(){this.setBigImg(),this.setItemData(),this.setTopData()},t.prototype.setTopData=function(){var e=this.node.getChildByName("top"),t=a.default.instance.data.getYunyingData(c.WindowType.SevenDayLogin),i=r.default.instance.data.getCfgData(t.idx);for(var n in e.children)Number(n)==this._selectIndex?e.children[n].getChildByName("bg").getComponent(cc.Sprite).spriteFrame=this.imgs.getSpriteFrame("btn_02"):e.children[n].getChildByName("bg").getComponent(cc.Sprite).spriteFrame=this.imgs.getSpriteFrame("btn_01"),e.children[n].getChildByName("img").getComponent(cc.Sprite).spriteFrame=this.imgs.getSpriteFrame(i[n].imgID),e.children[n].getChildByName("Label").getComponent(cc.Label).string=i[n].desc;for(var o=r.default.instance.data._reward,s=0;s<o.length;s++)1==o[s]?this.topNode.children[s].getChildByName("red").active=!0:this.topNode.children[s].getChildByName("red").active=!1},t.prototype.setBigImg=function(){var e="resources/Activity/OpenService/SevenDayLogin/bg_"+this._selectIndex+".png";l.default.setImage(this.node.getChildByName("img"),e)},t.prototype.setItemData=function(){var e=this.node.getChildByName("right").getChildByName("itemList").getComponent(cc.ScrollView),t=a.default.instance.data.getYunyingData(c.WindowType.SevenDayLogin),i=r.default.instance.data.getCfgData(t.idx)[this._selectIndex].rewardId,n=s.default.instance.getItemList(i);l.default.setNodeChildDestoryByUrl(e.content,g.GlobalContext.Root+"prefab/Bag/ItemIcon"),f.default.instance.loadResByType(g.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(t){for(var i in n){var a=l.default.getNodeByUrl(t,g.GlobalContext.Root+"prefab/Bag/ItemIcon");a.scale=.75*a.scale,a.getComponent(d.default).ItemData(o.default.creatItem(n[i].id,n[i].count),!0,n[i].count+"",!0),e.content.addChild(a)}},this);var p=r.default.instance.data.getRewardFlag(this._selectIndex),h=this.node.getChildByName("right").getChildByName("btn");h.getComponent(cc.Button).interactable=1==p,h.getChildByName("Label").getComponent(cc.Label).string=2==p?u.default.getStr("\u5df2\u9886\u53d6"):u.default.getStr("\u9886 \u53d6")},t.prototype.onClckDayBtn=function(e,t){this._selectIndex=t,this.setShowData()},t.prototype.onClickRewardBtn=function(){if(1==r.default.instance.data.getRewardFlag(this._selectIndex)){var e=a.default.instance.data.getYunyingId(c.WindowType.SevenDayLogin);r.default.instance.reqsevendaylogin(e,this._selectIndex)}},__decorate([C(cc.SpriteAtlas)],t.prototype,"imgs",void 0),__decorate([C(cc.Node)],t.prototype,"topNode",void 0),t=__decorate([m],t)}(n.default);i.default=v,cc._RF.pop()},{"../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Core/LoadManager":"LoadManager","../../../Core/Widget":"Widget","../../../Core/WindowType":"WindowType","../../../GlobalContext":"GlobalContext","../../../Util/Utils":"Utils","../../Commons/RewardUtils":"RewardUtils","../../Item/ItemData":"ItemData","../../Item/ItemIcon":"ItemIcon","../ActivityCtrl":"ActivityCtrl","./SevenDayLoginCtrl":"SevenDayLoginCtrl"}],SevenDayRankingCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"a70754mI99K46LoPhU5RWh2","SevenDayRankingCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Controller"),o=e("./SevenDayRankingData"),a=e("../../../NetConnect/NetConnet"),r=e("../../../Core/Event"),s=e("../../../Core/GameEventDispatcher"),l=e("../../../Core/WindowType"),c=e("../ActivityCtrl"),d=cc._decorator,p=d.ccclass,h=(d.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.data=null,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.listNotification=function(){i.instance=this,this.data=new o.default,this.addProto(r.EventDefiner.Activity_sdrankinfo,this.resSdRankInfo,this),s.GameEventDispatcher.instance.on(r.EventDefiner.Activity_YunyingUP,this.reqRankInfo,this)},t.prototype.resSdRankInfo=function(e){this.data.setData(e),s.GameEventDispatcher.instance.emit(r.EventDefiner.Activity_sdrankinfoUp),this.setTabName()},t.prototype.setTabName=function(){var e=this.data.getType(),t=c.default.instance.data.getYunyingData(l.WindowType.SevenDayRanking);if(t){var n=i.instance.data.getDayData(t.idx,e).name;n&&c.default.instance.data.setTabName(l.WindowType.SevenDayRanking,n)}},t.prototype.reqRankInfo=function(){var e=c.default.instance.data.getYunyingId(l.WindowType.SevenDayRanking);this.reqSdRankInfo(e)},t.prototype.reqSdRankInfo=function(e){var t={cmd:"sdrankinfo",actid:e};a.default.instance.sendProto(t)},t.instance=null,t=i=__decorate([p],t)}(n.default));i.default=h,cc._RF.pop()},{"../../../Core/Controller":"Controller","../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/WindowType":"WindowType","../../../NetConnect/NetConnet":"NetConnet","../ActivityCtrl":"ActivityCtrl","./SevenDayRankingData":"SevenDayRankingData"}],SevenDayRankingData:[function(e,t,i){"use strict";cc._RF.push(t,"d91ccHAdNVMbrdBgovK7BGJ","SevenDayRankingData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Role/RoleInfo"),o=e("../../../Core/ConfigsManager"),a=function(){function e(){this._cfg=null,this._myrank=null,this._type=null,this._rank=[],this._cfg=o.ConfigsManager.instance.getConfigs("sevendayrank")}return e.prototype.setData=function(e){for(var t in this._rank=[],this._myrank=null,this._type=null,this._type=e.type,e.rank)this._rank.push({type:e.type,rank:parseInt(t)+1,name:e.rank[t].info.name,value:e.rank[t].point});this._myrank={type:e.type,rank:-1!=e.myrank.rank?e.myrank.rank:-1,name:n.MyRoleInfo.name,value:e.myrank.data.point}},e.prototype.getType=function(){return this._type},e.prototype.getRank=function(){return this._rank},e.prototype.getMyRank=function(){return this._myrank},e.prototype.getDayidx=function(e){return this._cfg.sevendayrankConf[e].day},e.prototype.getRankIdx=function(e,t){var i=this._cfg.day[e];for(var n in i)if(i[n].type==t)return i[n].rank;return null},e.prototype.getRankCfg=function(e){return this._cfg.rank[e]},e.prototype.getDayData=function(e,t){var i=this.getDayidx(e),n=this._cfg.day[i];for(var o in n)if(n[o].type==t)return n[o]},e.prototype.getRewardId=function(e,t,i){var n=this.getDayidx(e),o=this.getRankIdx(n,t),a=this.getRankCfg(o);for(var r in a)if(a[r].min<=i&&a[r].max>=i)return a[r].rewardId},e}();i.default=a,cc._RF.pop()},{"../../../Core/ConfigsManager":"ConfigsManager","../../Role/RoleInfo":"RoleInfo"}],SevenDayRankingItem:[function(e,t,i){"use strict";cc._RF.push(t,"9625aQOGIdGDJWF0hCEuU+J","SevenDayRankingItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Core/CommonsResManager"),a=e("./SevenDayRankingCtrl"),r=e("../ActivityCtrl"),s=e("../../Commons/RewardUtils"),l=e("../../Item/ItemIcon"),c=e("../../../Core/WindowType"),d=e("../../../Util/Utils"),p=e("../../../Core/LoadManager"),h=e("../../../GlobalContext"),u=cc._decorator,f=u.ccclass,g=u.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.img=null,t.typeImg=[],t}return __extends(t,e),t.prototype.onClearItem=function(e){for(var t=e.childrenCount-1;t>=0;t--)d.default.setNodeToPool(c.PoolType.ItemIcon,e.children[t]);e.removeAllChildren()},t.prototype.setData=function(e){var t=this.node.getChildByName("ranking").getChildByName("img");t.active=e.rank<4;var i=this.node.getChildByName("ranking").getChildByName("Label");i.getComponent(cc.Label).string=e.rank<=0?"0":e.rank+"",-1==e.rank&&(t.getComponent(cc.Sprite).spriteFrame=this.img,i.getComponent(cc.Label).string=""),e.rank>=0&&e.rank<4&&(t.getComponent(cc.Sprite).spriteFrame=o.default.instance.getSpriteFrameByName("crown"+e.rank),i.getComponent(cc.Label).string=""),this.node.getChildByName("title").getChildByName("Label").getComponent(cc.Label).string=e.name;var n=r.default.instance.data.getYunyingData(c.WindowType.SevenDayRanking),u=a.default.instance.data.getRewardId(n.idx,e.type,e.rank),f=this.node.getChildByName("list");p.default.instance.loadResByType(h.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(e){for(var t=s.default.instance.getItemList(u),i=f.childrenCount-1;i>=0;i--)d.default.setNodeToPool(c.PoolType.ItemIcon,f.children[i]);for(var n in f.removeAllChildren(),t){var o=d.default.getNodeByPool(c.PoolType.ItemIcon,e,h.GlobalContext.Root+"prefab/Bag/ItemIcon");o.scale=.65*o.scale,o.getComponent(l.default).ItemData(t[n],!1,""+t[n].count,!0),f.addChild(o)}},this),this.node.getChildByName("fight").getChildByName("img").getComponent(cc.Sprite).spriteFrame=this.typeImg[e.type-1],this.node.getChildByName("fight").getChildByName("Label").getComponent(cc.Label).string=e.value},__decorate([g(cc.SpriteFrame)],t.prototype,"img",void 0),__decorate([g([cc.SpriteFrame])],t.prototype,"typeImg",void 0),t=__decorate([f],t)}(n.default);i.default=y,cc._RF.pop()},{"../../../Core/CommonsResManager":"CommonsResManager","../../../Core/LoadManager":"LoadManager","../../../Core/Widget":"Widget","../../../Core/WindowType":"WindowType","../../../GlobalContext":"GlobalContext","../../../Util/Utils":"Utils","../../Commons/RewardUtils":"RewardUtils","../../Item/ItemIcon":"ItemIcon","../ActivityCtrl":"ActivityCtrl","./SevenDayRankingCtrl":"SevenDayRankingCtrl"}],SevenDayRankingView:[function(e,t,i){"use strict";cc._RF.push(t,"f41de3B6K5KZKKnbaaMhUJX","SevenDayRankingView"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../ActivityCtrl"),a=e("./SevenDayRankingCtrl"),r=e("../../../Core/Event"),s=e("../../../Core/GameEventDispatcher"),l=e("../../Commons/ListViewCtrl"),c=e("./SevenDayRankingItem"),d=e("../../../Core/WindowType"),p=e("../../../Util/Utils"),h=cc._decorator,u=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lsitViewCtrl=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this),this.setData();var t=o.default.instance.data.getYunyingId(d.WindowType.SevenDayRanking);a.default.instance.reqSdRankInfo(t),s.GameEventDispatcher.instance.emit(r.EventDefiner.Activity_countdown,this),s.GameEventDispatcher.instance.on(r.EventDefiner.Activity_sdrankinfoUp,this.setData,this)},t.prototype.hide=function(){e.prototype.hide.call(this),s.GameEventDispatcher.instance.emit(r.EventDefiner.Activity_resetTimeout,this),s.GameEventDispatcher.instance.off(r.EventDefiner.Activity_sdrankinfoUp,this.setData,this)},t.prototype.setData=function(){var e=a.default.instance.data;if(e.getType()){var t="resources/Activity/OpenService/SevenDayRanking/bg_"+e.getType()+".png";p.default.setImage(this.node.getChildByName("bg"),t),this.setRankData(e.getRank()),this.node.getChildByName("item").getComponent(c.default).setData(e.getMyRank())}},t.prototype.setRankData=function(e){this.lsitViewCtrl.refreshItem=this.updateitem,this.lsitViewCtrl.refreshItemThis=this,this.lsitViewCtrl.initialize(e),this.lsitViewCtrl.scrollToTop()},t.prototype.updateitem=function(e,t){var i=this.lsitViewCtrl.dataLsit[t];e.getComponent(c.default).setData(i)},__decorate([f(l.default)],t.prototype,"lsitViewCtrl",void 0),t=__decorate([u],t)}(n.default);i.default=g,cc._RF.pop()},{"../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Widget":"Widget","../../../Core/WindowType":"WindowType","../../../Util/Utils":"Utils","../../Commons/ListViewCtrl":"ListViewCtrl","../ActivityCtrl":"ActivityCtrl","./SevenDayRankingCtrl":"SevenDayRankingCtrl","./SevenDayRankingItem":"SevenDayRankingItem"}],SevenDayTargetConfVo:[function(e,t,i){"use strict";cc._RF.push(t,"1ad1dAgIsRCOrmyDO4CdRCz","SevenDayTargetConfVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./SevenDayTargetRewardVo"),o=function(){function e(e,t,i){this.taskData={},this.taskSortData=[];var o={};for(var a in t)o[t[a].task]||(o[t[a].task]=[]),o[t[a].task].push(t[a]);this.showItemId=e.showItemId;var r,s=o[e.task];for(var a in s){r=i[s[a].reward],this.taskData[s[a].type]=[],this.taskSortData.push(s[a].type);for(var l=0;l<r.length;l++)r[l].day==e.task&&this.taskData[s[a].type].push(new n.SevenDayTargetRewardVo(r[l],l))}}return e.prototype.getRewardData=function(e){return this.taskData[this.taskSortData[e]]},e}();i.SevenDayTargetConfVo=o,cc._RF.pop()},{"./SevenDayTargetRewardVo":"SevenDayTargetRewardVo"}],SevenDayTargetConst:[function(e,t,i){"use strict";cc._RF.push(t,"b0faeHQlPFMiancazjS0P4D","SevenDayTargetConst"),Object.defineProperty(i,"__esModule",{value:!0}),function(e){e.BaseUrl="resources/Activity/OpenService/SevenDayTarget/"}(i.SevenDayTargetConst||(i.SevenDayTargetConst={})),function(e){e[e.LoginGame=1]="LoginGame",e[e.Chapter=2]="Chapter",e[e.Expedition=3]="Expedition",e[e.Card=4]="Card",e[e.Recharge=5]="Recharge",e[e.Equip=6]="Equip",e[e.Artifact=7]="Artifact",e[e.DailyCopy=8]="DailyCopy",e[e.WorrdBoss=9]="WorrdBoss",e[e.DardCard=10]="DardCard",e[e.Treasure=11]="Treasure",e[e.TotemsCopy=12]="TotemsCopy",e[e.Home=13]="Home",e[e.HalfGift=14]="HalfGift",e[e.RoleLv=15]="RoleLv",e[e.GemStone=16]="GemStone",e[e.RoleClear=17]="RoleClear"}(i.SevenDayTargetTaskType||(i.SevenDayTargetTaskType={})),cc._RF.pop()},{}],SevenDayTargetCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"6000aiuYghEOIBJ+BBP9kwt","SevenDayTargetCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Controller"),o=e("../../../Core/Event"),a=e("../../../Core/GameEventDispatcher"),r=e("../../../Core/ConfigsManager"),s=e("./SevenDayTargetUtils"),l=e("./vo/SevenDayTargetConfVo"),c=e("./vo/SevenDayTargetRankConfVo"),d=e("../../../NetConnect/NetConnet"),p=e("../ActivityCtrl"),h=e("../../../Core/WindowType"),u=e("../../Functionicon/FunctionIconController"),f=e("../../OpenWin/OpenWinController"),g=e("../../Tips/RewardTips"),y=e("../../Commons/RewardUtils"),m=e("./vo/SevenDayTargetSerVo"),C=e("../../../Core/TimeController"),v=e("./vo/SevenDayTargetSerRankVo"),_=cc._decorator,b=_.ccclass,T=(_.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.setConf={},t.setRankConf={},t.scoreConf={},t.selectionDayIndex=0,t.selectionTaskIndex=0,t.taskNames={},t.nowIndex=1,t.taskData={},t.rankData=[],t}var i;return __extends(t,e),i=t,t.prototype.listNotification=function(){i.instance=this;var e=r.ConfigsManager.instance.getConfigs("SevenDayGoalConf");this.taskNames=e.taskName,this.scoreConf=e.score,this.sevenDayGoalConf=e.SevenDayGoalConf;var t,n,s=e.SevenDayGoalConf;for(var d in s)for(var p in this.setRankConf[d]=[],this.setConf[d]||(this.setConf[d]=[]),t=e.day[s[d].day])n=new l.SevenDayTargetConfVo(t[p],e.task[1],e.reward),this.setConf[d].push(n);for(var d in s=e.rank)for(var p in t=s[d])this.setRankConf[d].push(new c.SevenDayTargetRankConfVo(t[p]));this.addProto("sdgrank",this.setRank,this),this.addProto("sdginfo",this.setInfo,this),this.addProto("sdgreward",this.setReward,this),a.GameEventDispatcher.instance.on(o.EventDefiner.Activity_YunyingUP,this.serStateData,this)},t.prototype.setReward=function(e){var t=y.default.instance.getItemListByServerData(e.reward);f.default.instance.openWindow(h.WindowType.RewardTips,function(){g.default.instance.setData(t)},this)},t.prototype.serStateData=function(){var e=this,t=p.default.instance.data.getActivityState(h.WindowType.SevenDayTarget);if(this.activityId||(this.activityId=p.default.instance.data.getYunyingId(h.WindowType.SevenDayTarget)),t){this.yunyingData=p.default.instance.data.getYunyingInfo(this.activityId),this.nowIndex=this.yunyingData.idx,this.setInitData(),s.SevenDayTargetUtils.setHideDeal();var i=C.default.instance.setTimeout(function(){e.reqSdginfo(),C.default.instance.clearTimeout(i)},this,1e3)}else u.default.instance.FuncIconHideDeal(h.WindowType.SevenDayTarget,!0)},t.prototype.reqSdginfo=function(){var e={cmd:"sdginfo",actid:this.activityId};d.default.instance.sendProto(e)},t.prototype.setRank=function(e){this.myrank||(this.myrank=new v.SevenDayTargetSerRankVo),this.myrank.updateData(e.myrank.data),this.rankNum=e.myrank.rank;var t=e.rank;for(var i in t)this.rankData[i]||(this.rankData[i]=new v.SevenDayTargetSerRankVo),this.rankData[i].updateData(t[i]);a.GameEventDispatcher.instance.emit(o.EventDefiner.Activity_SevenDayTargetRankUp)},t.prototype.setInfo=function(e){if(this.activityId){this.rewards=e.data.reward?e.data.reward:this.rewards,this.integral=null!=e.data.score?e.data.score:this.integral,this.dayNum=null!=e.day?e.day:this.dayNum;var t=e.data.task;for(var i in t)this.taskData[i]||(this.taskData[i]=new m.SevenDayTargetSerVo),this.taskData[i].updateData(t[i]);s.SevenDayTargetUtils.setRed(),a.GameEventDispatcher.instance.emit(o.EventDefiner.Activity_SevenDayTargetUpdate)}},t.prototype.reqRanking=function(){var e={cmd:"sdgrank",actid:this.activityId};d.default.instance.sendProto(e)},t.prototype.reqSdgtaskreward=function(e,t){var i={cmd:"sdgtaskreward",actid:this.activityId,type:this.taskType,idx:t,subtype:e};d.default.instance.sendProto(i)},t.prototype.reqSdgscorereward=function(e){var t={cmd:"sdgscorereward",actid:this.activityId,idx:e};d.default.instance.sendProto(t)},t.prototype.setInitData=function(){this.nowConf=this.setConf[this.sevenDayGoalConf[this.nowIndex].day],this.nowScoreConf=this.scoreConf[this.sevenDayGoalConf[this.nowIndex].score],this.nowRankConf=this.setRankConf[this.sevenDayGoalConf[this.nowIndex].rank],this.allIntegral=this.nowScoreConf[this.nowScoreConf.length-1].value},t.prototype.setTaskType=function(){this.taskType=this.nowConf[this.selectionDayIndex].taskSortData[this.selectionTaskIndex]},t.instance=null,t=i=__decorate([b],t)}(n.default));i.default=T,cc._RF.pop()},{"../../../Core/ConfigsManager":"ConfigsManager","../../../Core/Controller":"Controller","../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/TimeController":"TimeController","../../../Core/WindowType":"WindowType","../../../NetConnect/NetConnet":"NetConnet","../../Commons/RewardUtils":"RewardUtils","../../Functionicon/FunctionIconController":"FunctionIconController","../../OpenWin/OpenWinController":"OpenWinController","../../Tips/RewardTips":"RewardTips","../ActivityCtrl":"ActivityCtrl","./SevenDayTargetUtils":"SevenDayTargetUtils","./vo/SevenDayTargetConfVo":"SevenDayTargetConfVo","./vo/SevenDayTargetRankConfVo":"SevenDayTargetRankConfVo","./vo/SevenDayTargetSerRankVo":"SevenDayTargetSerRankVo","./vo/SevenDayTargetSerVo":"SevenDayTargetSerVo"}],SevenDayTargetItem:[function(e,t,i){"use strict";cc._RF.push(t,"373fboUSoJDiLhXqZrPHn2W","SevenDayTargetItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../../Core/Widget"),o=e("../../../../Core/Language"),a=e("../../../Commons/RewardUtils"),r=e("../../../Item/ItemData"),s=e("../SevenDayTargetUtils"),l=e("../../../../Core/LoadManager"),c=e("../../../../GlobalContext"),d=e("../../../../Util/Utils"),p=e("../../../../Core/WindowType"),h=e("../../../Item/ItemIcon"),u=e("../../HalfPrice/HalfPriceCtrl"),f=e("../../../OpenWin/OpenWinController"),g=e("../../../../Util/RechargeConst"),y=e("../../../../Util/RechargeUtils"),m=e("../../../Commons/WindowOpenUtils"),C=e("../SevenDayTargetCtrl"),v=e("../SevenDayTargetConst"),_=e("../../../../Util/NumberUtil"),b=e("../../../../Global/GlobalValue"),T=e("../../../Tips/TipsWinController"),S=e("../../../Shop/ShopController"),I=e("../../../Shop/ShopConst"),w=e("../../../Shop/Shop"),D=cc._decorator,R=D.ccclass,A=D.property,N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.receiveBtn=null,t.completeIcon=null,t.buyBtn=null,t.goBtn=null,t.str=null,t.reward=null,t.progressStr=null,t.buyStr=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),this.buyBtn.getComponentInChildren(cc.Label).string=o.default.getStr("7100"),this.receiveBtn.getComponentInChildren(cc.Label).string=o.default.getStr("7109"),this.goBtn.getComponentInChildren(cc.Label).string=o.default.getStr("7110");var t=r.default.creatItem(a.RewardType.Diamond),i=c.GlobalContext.ResRoot+"resources/itemicon/"+t.ItemIcon+".png";d.default.setImage(cc.find("oldPrice/img",this.buyStr),i),d.default.setImage(cc.find("nowPrice/img",this.buyStr),i),this.buyStr.getChildByName("str1").getComponent(cc.Label).string=o.default.getStr("7111"),this.buyStr.getChildByName("str2").getComponent(cc.Label).string=o.default.getStr("7112")},t.prototype.initData=function(e,t){this.index=e,this.node.name=e+"",this.updateConfData(t)},t.prototype.updateConfData=function(e){var t=this;this.isGift=s.SevenDayTargetUtils.isTaskType(v.SevenDayTargetTaskType.HalfGift),this.confData=e;var i=a.default.instance.getItemList(this.isGift?e.rewardId:e.rwId);if(l.default.instance.loadResByType(c.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(e){var n;if(t.reward.childrenCount>i.length)for(var o=t.reward.childrenCount-1;o>=i.length;o--)d.default.setNodeToPool(p.PoolType.ItemIcon,t.reward.children[o]);for(o=0;o<i.length;o++){n=t.reward.children[o];var a=i[o];n||(n=d.default.getNodeByPool(p.PoolType.ItemIcon,e,c.GlobalContext.Root+"prefab/Bag/ItemIcon"),t.reward.addChild(n)),n.getComponent(h.default).ItemData(a,!0,a.count+"",!0)}},this),this.buyStr.active=this.isGift,this.progressStr.node.active=!this.isGift,this.updateData(),this.isGift)cc.find("oldPrice/label",this.buyStr).getComponent(cc.Label).string=""+this.confData.costPrice,cc.find("nowPrice/label",this.buyStr).getComponent(cc.Label).string=""+this.confData.curPrice,this.str.string=o.default.getStr("7113");else{var n=[];s.SevenDayTargetUtils.isTaskType(v.SevenDayTargetTaskType.Chapter)?n.push(_.NumberUtil.unitsDigitToText(this.confData.param[0])):n=s.SevenDayTargetUtils.isTaskType(v.SevenDayTargetTaskType.Card)?[this.confData.param[0],b.CardLvType[this.confData.param[1]]]:this.confData.param,this.str.string=o.default.getStr1(this.confData.str,n),this.progressStr.string="("+s.SevenDayTargetUtils.getMolecule(this.confData.subType)+"/"+this.confData.param[0]+")"}},t.prototype.updateData=function(){this.receiveBtn.active=!1,this.buyBtn.active=!1,this.goBtn.active=!1,this.completeIcon.active=!1;var e=C.default.instance;if(this.isGift){this.buyBtn.active=!0;var t=u.default.instance.isCanBuy(e.selectionDayIndex,this.confData.index);this.buyBtn.getComponent(cc.Button).interactable=t,this.buyBtn.getComponentInChildren(cc.Label).string=o.default.getStr(t?"7100":"7101")}else{switch(s.SevenDayTargetUtils.getTaskState(this.confData.subType,this.confData.index)){case 0:e.taskType!=v.SevenDayTargetTaskType.LoginGame?this.goBtn.active=!0:(this.receiveBtn.getComponent(cc.Button).interactable=!1,this.receiveBtn.active=!0);break;case 1:this.receiveBtn.getComponent(cc.Button).interactable=this.receiveBtn.active=!0;break;case 2:this.completeIcon.active=!0}}},t.prototype.hide=function(){e.prototype.hide.call(this);for(var t=this.reward.childrenCount-1;t>=0;t--)d.default.setNodeToPool(p.PoolType.ItemIcon,this.reward.children[t])},t.prototype.onClickSend=function(e,t){var i=this;switch(t){case"0":T.default.instance.ShowTips(o.default.getStr("7102",this.confData.curPrice),function(){y.default.PurchaseItemOrRechage(g.RechargeTypeConst.Diamonds,i.confData.curPrice,function(){u.default.instance.halfpricebuy(i.confData.index,C.default.instance.selectionDayIndex)},i)},this);break;case"1":C.default.instance.reqSdgtaskreward(this.confData.subType,this.confData.index);break;case"2":C.default.instance.taskType!=v.SevenDayTargetTaskType.Recharge?m.default.instance.openWindowType(this.confData.windowId):f.default.instance.openWindow(p.WindowType.Shop,function(){var e=S.default.instance.nowSortIndex[I.ShopConst.Recharge];w.default.instance.TabBtnList2.selectItem(e)},this)}},__decorate([A(cc.Node)],t.prototype,"receiveBtn",void 0),__decorate([A(cc.Node)],t.prototype,"completeIcon",void 0),__decorate([A(cc.Node)],t.prototype,"buyBtn",void 0),__decorate([A(cc.Node)],t.prototype,"goBtn",void 0),__decorate([A(cc.Label)],t.prototype,"str",void 0),__decorate([A(cc.Node)],t.prototype,"reward",void 0),__decorate([A(cc.Label)],t.prototype,"progressStr",void 0),__decorate([A(cc.Node)],t.prototype,"buyStr",void 0),t=__decorate([R],t)}(n.default);i.default=N,cc._RF.pop()},{"../../../../Core/Language":"Language","../../../../Core/LoadManager":"LoadManager","../../../../Core/Widget":"Widget","../../../../Core/WindowType":"WindowType","../../../../Global/GlobalValue":"GlobalValue","../../../../GlobalContext":"GlobalContext","../../../../Util/NumberUtil":"NumberUtil","../../../../Util/RechargeConst":"RechargeConst","../../../../Util/RechargeUtils":"RechargeUtils","../../../../Util/Utils":"Utils","../../../Commons/RewardUtils":"RewardUtils","../../../Commons/WindowOpenUtils":"WindowOpenUtils","../../../Item/ItemData":"ItemData","../../../Item/ItemIcon":"ItemIcon","../../../OpenWin/OpenWinController":"OpenWinController","../../../Shop/Shop":"Shop","../../../Shop/ShopConst":"ShopConst","../../../Shop/ShopController":"ShopController","../../../Tips/TipsWinController":"TipsWinController","../../HalfPrice/HalfPriceCtrl":"HalfPriceCtrl","../SevenDayTargetConst":"SevenDayTargetConst","../SevenDayTargetCtrl":"SevenDayTargetCtrl","../SevenDayTargetUtils":"SevenDayTargetUtils"}],SevenDayTargetRankConfVo:[function(e,t,i){"use strict";cc._RF.push(t,"378b8X4cbJB/oYroG8/FYwD","SevenDayTargetRankConfVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){return function(e){for(var t in e)this[t]=e[t]}}();i.SevenDayTargetRankConfVo=n,cc._RF.pop()},{}],SevenDayTargetRankItem:[function(e,t,i){"use strict";cc._RF.push(t,"aed12ACp6BJcKUtIEXtDcNl","SevenDayTargetRankItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../../Core/Widget"),o=e("../../../../Core/CommonsResManager"),a=e("../../../Vip/VipLev"),r=e("../../../OpenWin/OpenWinController"),s=e("../../../../Core/WindowType"),l=e("../../../Role/RoleInfo"),c=e("../../../../Core/LoadManager"),d=e("../../../../GlobalContext"),p=e("../../../Commons/RewardUtils"),h=e("../../../../Util/Utils"),u=e("../../../Item/ItemIcon"),f=e("../SevenDayTargetUtils"),g=e("../SevenDayTargetCtrl"),y=cc._decorator,m=y.ccclass,C=y.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.integral=null,t.top=null,t.img=null,t.noImg=null,t.num=null,t.userName=null,t.vipImg=null,t.reward=null,t.Commons1=null,t}return __extends(t,e),t.prototype.initInfo=function(e,t){e&&(this.node.getChildByName("SwitchNode").getComponent(cc.Sprite).spriteFrame=this.Commons1.getSpriteFrame("base03"),this.ranking(t,e.info.viplv,e.info.name,e.point),this.vipImg.getComponent(a.default).setData(e.info.viplv,!0,function(){r.default.instance.openWindow(s.WindowType.VIP)},this),this.userName.string=e.info.name)},t.prototype.initMyInfo=function(){this.node.getChildByName("SwitchNode").getComponent(cc.Sprite).spriteFrame=this.Commons1.getSpriteFrame("base05");var e=g.default.instance.myrank;this.ranking(g.default.instance.rankNum-1,l.MyRoleInfo.vipLevel,l.MyRoleInfo.name,e.point)},t.prototype.ranking=function(e,t,i,n){var l=this;if(e<0)this.img.active=this.top.node.active=this.num.active=!1,this.noImg.active=!0;else{this.noImg.active=!1,this.img.active=!e;var g=e<3;this.top.node.active=g,this.num.active=!g,e<3?this.top.spriteFrame=o.default.instance.getSpriteFrameByName("crown"+(e+1)):this.num.getComponent(cc.Label).string=""+(e+1),c.default.instance.loadResByType(d.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(t){var i,n=p.default.instance.getItemList(f.SevenDayTargetUtils.getRankRewardId(e+1));if(l.reward.childrenCount>n.length)for(var o=l.reward.childrenCount-1;o>=n.length;o--)h.default.setNodeToPool(s.PoolType.ItemIcon,l.reward.children[o]);for(o=0;o<n.length;o++){i=l.reward.children[o];var a=n[o];i||(i=h.default.getNodeByPool(s.PoolType.ItemIcon,t,d.GlobalContext.Root+"prefab/Bag/ItemIcon"),l.reward.addChild(i)),i.getComponent(u.default).ItemData(a,!0,a.count+"",!0)}},this)}this.vipImg.getComponent(a.default).setData(t,!0,function(){r.default.instance.openWindow(s.WindowType.VIP)},this),this.userName.string=i,this.integral.string=""+n},t.prototype.hide=function(){e.prototype.hide.call(this);for(var t=this.reward.childrenCount-1;t>=0;t--)h.default.setNodeToPool(s.PoolType.ItemIcon,this.reward.children[t])},__decorate([C(cc.Label)],t.prototype,"integral",void 0),__decorate([C(cc.Sprite)],t.prototype,"top",void 0),__decorate([C(cc.Node)],t.prototype,"img",void 0),__decorate([C(cc.Node)],t.prototype,"noImg",void 0),__decorate([C(cc.Node)],t.prototype,"num",void 0),__decorate([C(cc.Label)],t.prototype,"userName",void 0),__decorate([C(cc.Node)],t.prototype,"vipImg",void 0),__decorate([C(cc.Node)],t.prototype,"reward",void 0),__decorate([C(cc.SpriteAtlas)],t.prototype,"Commons1",void 0),t=__decorate([m],t)}(n.default);i.default=v,cc._RF.pop()},{"../../../../Core/CommonsResManager":"CommonsResManager","../../../../Core/LoadManager":"LoadManager","../../../../Core/Widget":"Widget","../../../../Core/WindowType":"WindowType","../../../../GlobalContext":"GlobalContext","../../../../Util/Utils":"Utils","../../../Commons/RewardUtils":"RewardUtils","../../../Item/ItemIcon":"ItemIcon","../../../OpenWin/OpenWinController":"OpenWinController","../../../Role/RoleInfo":"RoleInfo","../../../Vip/VipLev":"VipLev","../SevenDayTargetCtrl":"SevenDayTargetCtrl","../SevenDayTargetUtils":"SevenDayTargetUtils"}],SevenDayTargetRankWin:[function(e,t,i){"use strict";cc._RF.push(t,"abe3f1Dl6dK2o5N3kXWkP70","SevenDayTargetRankWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Commons/CommonPageBG"),o=e("../../../Core/Language"),a=e("./item/SevenDayTargetRankItem"),r=e("../../Commons/ListViewCtrl"),s=e("./SevenDayTargetCtrl"),l=cc._decorator,c=l.ccclass,d=l.property,p=e("../../../Core/GameEventDispatcher"),h=e("../../../Core/Event"),u=e("../../../Util/Utils"),f=e("../../../Core/WindowType"),g=e("../../../Core/LoadManager"),y=e("../../../GlobalContext"),m=e("../../../Core/TimeController"),C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.str1=null,t.str2=null,t.str3=null,t.str4=null,t.myInfo=null,t.scrollView=null,t.listViewCtrl=null,t}return __extends(t,e),t.prototype.onLoad=function(){var t;e.prototype.onLoad.call(this),t=[o.default.getStr("7114"),o.default.getStr("7115"),o.default.getStr("7104"),o.default.getStr("7116")],this.str1.string=t[0],this.str2.string=t[1],this.str3.string=t[2],this.str4.string=t[3]},t.prototype.show=function(){var t=this;e.prototype.show.call(this),this.onInit(919,678,o.default.getStr("7106"),!0),p.GameEventDispatcher.instance.on(h.EventDefiner.Activity_SevenDayTargetRankUp,this.updateData,this),this.updateData(),s.default.instance.reqRanking(),g.default.instance.loadResByType(y.GlobalContext.Root+"prefab/SevenDayTarget/SevenDayTargetRankItem",cc.Prefab,function(e){var i=u.default.getNodeByPool(f.PoolType.SevenDayTargetRankItem,e,y.GlobalContext.Root+"prefab/SevenDayTarget/SevenDayTargetRankItem");t.myInfo.addChild(i)},this)},t.prototype.hide=function(){e.prototype.hide.call(this),p.GameEventDispatcher.instance.off(h.EventDefiner.Activity_SevenDayTargetRankUp,this.updateData,this);for(var t=this.myInfo.childrenCount-1;t>=0;t--)u.default.setNodeToPool(f.PoolType.SevenDayTargetRankItem,this.myInfo.children[t])},t.prototype.updateData=function(){var e=this;if(this.myInfo.childrenCount)this.setData(),this.myInfo.getComponentInChildren(a.default).initMyInfo();else var t=m.default.instance.setTimeout(function(){e.updateData(),m.default.instance.clearTimeout(t),t=null},this,50)},t.prototype.setData=function(){this.listViewCtrl.refreshItem=this.updateitem,this.listViewCtrl.refreshItemThis=this,this.listViewCtrl.initialize(s.default.instance.rankData),this.listViewCtrl.scrollToTop()},t.prototype.updateitem=function(e,t){var i=this.listViewCtrl.dataLsit[t];e.getComponent(a.default).initInfo(i,t)},__decorate([d(cc.Label)],t.prototype,"str1",void 0),__decorate([d(cc.Label)],t.prototype,"str2",void 0),__decorate([d(cc.Label)],t.prototype,"str3",void 0),__decorate([d(cc.Label)],t.prototype,"str4",void 0),__decorate([d(cc.Node)],t.prototype,"myInfo",void 0),__decorate([d(cc.ScrollView)],t.prototype,"scrollView",void 0),__decorate([d(r.default)],t.prototype,"listViewCtrl",void 0),t=__decorate([c],t)}(n.default);i.default=C,cc._RF.pop()},{"../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Core/LoadManager":"LoadManager","../../../Core/TimeController":"TimeController","../../../Core/WindowType":"WindowType","../../../GlobalContext":"GlobalContext","../../../Util/Utils":"Utils","../../Commons/CommonPageBG":"CommonPageBG","../../Commons/ListViewCtrl":"ListViewCtrl","./SevenDayTargetCtrl":"SevenDayTargetCtrl","./item/SevenDayTargetRankItem":"SevenDayTargetRankItem"}],SevenDayTargetRewardItem:[function(e,t,i){"use strict";cc._RF.push(t,"cdc7aHDNwJC46fBrIldQ5bQ","SevenDayTargetRewardItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../../Core/Widget"),o=e("../../../Item/ItemData"),a=e("../../../../Core/GameEventDispatcher"),r=e("../../../../Core/Event"),s=e("../SevenDayTargetUtils"),l=e("../../../Item/ItemController"),c=e("../SevenDayTargetCtrl"),d=e("../../../../Core/CommonsResManager"),p=cc._decorator,h=p.ccclass,u=p.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.receiveImg=null,t.icon=null,t.red=null,t.num=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),a.GameEventDispatcher.instance.on(r.EventDefiner.Activity_SevenDayTargetUpdate,this.updateData,this)},t.prototype.hide=function(){e.prototype.hide.call(this),a.GameEventDispatcher.instance.off(r.EventDefiner.Activity_SevenDayTargetUpdate,this.updateData,this),this.index=null,this.itemdata=null},t.prototype.updateData=function(){this.state=c.default.instance.rewards[this.index];var e=2==this.state;this.icon.setState(e?cc.Sprite.State.GRAY:cc.Sprite.State.NORMAL),this.receiveImg.active=e,this.red.active=s.SevenDayTargetUtils.getIntegralRed(this.index)},t.prototype.initData=function(e,t){this.node.name=""+e,this.index=e,this.num.string=""+t.value,this.itemdata=o.default.creatItem(t.reward[0].id),this.icon.spriteFrame=d.default.instance.getSpriteFrameByName("icon_baoxiang"+(e+1)),this.updateData()},t.prototype.onClick=function(){1==this.state?c.default.instance.reqSdgscorereward(this.index):l.default.instance.openItemTips(this.itemdata)},__decorate([u(cc.Node)],t.prototype,"receiveImg",void 0),__decorate([u(cc.Sprite)],t.prototype,"icon",void 0),__decorate([u(cc.Node)],t.prototype,"red",void 0),__decorate([u(cc.Label)],t.prototype,"num",void 0),t=__decorate([h],t)}(n.default);i.default=f,cc._RF.pop()},{"../../../../Core/CommonsResManager":"CommonsResManager","../../../../Core/Event":"Event","../../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../../Core/Widget":"Widget","../../../Item/ItemController":"ItemController","../../../Item/ItemData":"ItemData","../SevenDayTargetCtrl":"SevenDayTargetCtrl","../SevenDayTargetUtils":"SevenDayTargetUtils"}],SevenDayTargetRewardVo:[function(e,t,i){"use strict";cc._RF.push(t,"ccd92n2XH5PvaosqShWLpGo","SevenDayTargetRewardVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){return function(e,t){for(var i in e)this[i]=e[i];this.index=t,this.subType||(this.subType=0)}}();i.SevenDayTargetRewardVo=n,cc._RF.pop()},{}],SevenDayTargetScoreConfVo:[function(e,t,i){"use strict";cc._RF.push(t,"18cd14Z5WNGmo6UNvtCrdto","SevenDayTargetScoreConfVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.updateData=function(e){for(var t in e)this[t]=e[t]},e}();i.SevenDayTargetScoreConfVo=n,cc._RF.pop()},{}],SevenDayTargetSerRankVo:[function(e,t,i){"use strict";cc._RF.push(t,"536e2Q9+Z1ErLScfRiG0cRc","SevenDayTargetSerRankVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.updateData=function(e){this.point=e.point,this.info=e.info},e}();i.SevenDayTargetSerRankVo=n,cc._RF.pop()},{}],SevenDayTargetSerVo:[function(e,t,i){"use strict";cc._RF.push(t,"0265dIxERFDLa7HAxc7Aeyx","SevenDayTargetSerVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(){this.data={},this.state={}}return e.prototype.updateData=function(e){for(var t in e)this[t]=e[t]},e}();i.SevenDayTargetSerVo=n,cc._RF.pop()},{}],SevenDayTargetTaskItem:[function(e,t,i){"use strict";cc._RF.push(t,"9133dscydVKLbc3aK30gDDM","SevenDayTargetTaskItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../../Core/Widget"),o=e("../../../../Core/GameEventDispatcher"),a=e("../../../../Core/Event"),r=e("../SevenDayTargetCtrl"),s=e("../SevenDayTargetUtils"),l=cc._decorator,c=l.ccclass,d=l.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.checkmark=null,t.red=null,t.taskName=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),o.GameEventDispatcher.instance.on(a.EventDefiner.Activity_SevenDayTargetTaskUp,this.updateState,this),o.GameEventDispatcher.instance.on(a.EventDefiner.Activity_SevenDayTargetUpdate,this.upDateRed,this)},t.prototype.hide=function(){e.prototype.hide.call(this),o.GameEventDispatcher.instance.off(a.EventDefiner.Activity_SevenDayTargetTaskUp,this.updateState,this),o.GameEventDispatcher.instance.off(a.EventDefiner.Activity_SevenDayTargetUpdate,this.upDateRed,this),this.index=null},t.prototype.updateState=function(){this.checkmark.active=r.default.instance.selectionTaskIndex==this.index},t.prototype.upDateRed=function(){this.red.active=s.SevenDayTargetUtils.getTaskRed(this.type)},t.prototype.initData=function(e,t){this.node.name=""+e,this.index=e,this.type=t,this.updateState(),this.upDateRed(),this.taskName.string=r.default.instance.taskNames[t].taskName},__decorate([d(cc.Node)],t.prototype,"checkmark",void 0),__decorate([d(cc.Node)],t.prototype,"red",void 0),__decorate([d(cc.Label)],t.prototype,"taskName",void 0),t=__decorate([c],t)}(n.default);i.default=p,cc._RF.pop()},{"../../../../Core/Event":"Event","../../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../../Core/Widget":"Widget","../SevenDayTargetCtrl":"SevenDayTargetCtrl","../SevenDayTargetUtils":"SevenDayTargetUtils"}],SevenDayTargetToggleItem:[function(e,t,i){"use strict";cc._RF.push(t,"714ebtselhApbdfbj1oFxcu","SevenDayTargetToggleItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../../Core/Widget"),o=e("../../../Commons/Image"),a=e("../../../../Core/GameEventDispatcher"),r=e("../../../../Core/Event"),s=e("../SevenDayTargetCtrl"),l=e("../SevenDayTargetUtils"),c=e("../../../Item/ItemData"),d=e("../SevenDayTargetConst"),p=e("../../../../GlobalContext"),h=e("../../../../Util/Utils"),u=cc._decorator,f=u.ccclass,g=u.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.checkmark=null,t.red=null,t.dayImg=null,t.iconImg=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),a.GameEventDispatcher.instance.on(r.EventDefiner.Activity_SevenDayTargetDayUp,this.updateState,this),a.GameEventDispatcher.instance.on(r.EventDefiner.Activity_SevenDayTargetUpdate,this.upDateRed,this)},t.prototype.hide=function(){e.prototype.hide.call(this),a.GameEventDispatcher.instance.off(r.EventDefiner.Activity_SevenDayTargetDayUp,this.updateState,this),a.GameEventDispatcher.instance.off(r.EventDefiner.Activity_SevenDayTargetUpdate,this.upDateRed,this)},t.prototype.updateState=function(){this.checkmark.active=s.default.instance.selectionDayIndex==this.index,this.node.getComponent(cc.Toggle).isChecked=this.checkmark.active},t.prototype.upDateRed=function(){this.red.active=l.SevenDayTargetUtils.getDayRed(this.index)},t.prototype.initData=function(e,t){this.node.name=""+e,this.index=e,this.updateState(),this.upDateRed();var i=c.default.creatItem(t.showItemId),n=p.GlobalContext.ResRoot+"resources/itemicon/"+i.ItemIcon+".png";h.default.setImage(this.iconImg.node,n),this.dayImg.updateBg(d.SevenDayTargetConst.BaseUrl+"i18n_day"+(e+1)+".png")},__decorate([g(cc.Node)],t.prototype,"checkmark",void 0),__decorate([g(cc.Node)],t.prototype,"red",void 0),__decorate([g(o.default)],t.prototype,"dayImg",void 0),__decorate([g(o.default)],t.prototype,"iconImg",void 0),t=__decorate([f],t)}(n.default);i.default=y,cc._RF.pop()},{"../../../../Core/Event":"Event","../../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../../Core/Widget":"Widget","../../../../GlobalContext":"GlobalContext","../../../../Util/Utils":"Utils","../../../Commons/Image":"Image","../../../Item/ItemData":"ItemData","../SevenDayTargetConst":"SevenDayTargetConst","../SevenDayTargetCtrl":"SevenDayTargetCtrl","../SevenDayTargetUtils":"SevenDayTargetUtils"}],SevenDayTargetUtils:[function(e,t,i){"use strict";cc._RF.push(t,"b5c84OizAtGu5i2WCcN7WDa","SevenDayTargetUtils"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./SevenDayTargetCtrl"),o=e("./SevenDayTargetConst"),a=e("../HalfPrice/HalfPriceCtrl"),r=e("../../Functionicon/FunctionIconController"),s=e("../../../Core/WindowType"),l=e("../../../Core/TimeController"),c=function(){function e(){}return Object.defineProperty(e,"ctrl",{get:function(){return n.default.instance},enumerable:!0,configurable:!0}),e.getTargetItemData=function(){var e=this.ctrl;return e.nowConf[e.selectionDayIndex].getRewardData(e.selectionTaskIndex)},e.isTaskType=function(e){return this.ctrl.taskType==e},e.getRankRewardId=function(e){var t,i=this.ctrl.nowRankConf;for(var n in e++,i)if(e>=i[n].min&&e<=i[n].max){t=i[n].rwId;break}return t},e.getSortData=function(){var e=this.ctrl,t=[],i=[];if(e.taskType==o.SevenDayTargetTaskType.HalfGift){for(var n=a.default.instance.gift[e.selectionDayIndex].gift,r=(a.default.instance.giftState[e.selectionDayIndex],0);r<n.length;r++)a.default.instance.isCanBuy(e.selectionDayIndex,r)?t.push(n[r]):i.push(n[r]);t=t.concat(i)}else{var s=e.nowConf[e.selectionDayIndex].taskData[e.taskType];if(!e.taskData[e.taskType])return s;var l=e.taskData[e.taskType].state;if(!l[s[0].subType])return s;var c=[];for(r=0;r<s.length;r++)switch(s[r].subType||(s[r].subType=0),l[s[r].subType][s[r].index]){case 1:t.push(s[r]);break;case 2:i.push(s[r]);break;default:c.push(s[r])}t=t.concat(c,i)}return t},e.getDayRed=function(e){var t=this.ctrl,i=t.nowConf[e].taskData,n=!1;if(e>t.dayNum)return n;for(var o in i)if(this.getTaskRed(parseInt(o),e,i[o][0].subType)){n=!0;break}return n},e.getTaskRed=function(e,t,i){var n=this.ctrl,o=!1;null==t&&(t=n.selectionDayIndex),null==e&&(e=n.taskType);var a=n.nowConf[t].taskData[e];if(null==i&&(i=a[0].subType),!n.taskData[e])return o;var r=n.taskData[e].state[i];for(var s in a)if(r&&1==r[a[s].index]){o=!0;break}return o},e.getTaskState=function(e,t){var i=this.ctrl;if(!i.taskData[i.taskType])return 0;var n=i.taskData[i.taskType].state;return n[e]&&null!=n[e][t]?n[e][t]:0},e.getIntegralRed=function(e){return 1==this.ctrl.rewards[e]},e.getMolecule=function(e){var t=this.ctrl,i=t.taskData[t.taskType];return i?(void 0==e&&(e=0),null!=i.data[e]?i.data[e]:0):0},e.setRed=function(){r.default.instance.FuncIconRedDeal(s.WindowType.SevenDayTarget,this.getRed())},e.setHideDeal=function(e){void 0===e&&(e=!1),r.default.instance.FuncIconHideDeal(s.WindowType.SevenDayTarget,e)},e.getRed=function(){if(!r.default.instance.checkIsOpenbyWindowtype(s.WindowType.SevenDayTarget))return!1;for(var e=this.ctrl,t=e.nowConf,i=0;i<t.length;i++)if(this.getDayRed(i))return!0;var n=e.nowScoreConf;for(i=0;i<n.length;i++)if(this.getIntegralRed(i))return!0;return!1},e.getOverTime=function(){var e=this.ctrl.yunyingData.endtime-l.default.instance.ServerTime;return e<0?0:1e3*e},e.setSelectState=function(){var e=this.ctrl;if(e.nowConf){e.nowConf[e.selectionDayIndex].taskData;e.selectionTaskIndex=e.nowConf[e.selectionDayIndex].taskSortData.indexOf(o.SevenDayTargetTaskType.HalfGift)}},e}();i.SevenDayTargetUtils=c,cc._RF.pop()},{"../../../Core/TimeController":"TimeController","../../../Core/WindowType":"WindowType","../../Functionicon/FunctionIconController":"FunctionIconController","../HalfPrice/HalfPriceCtrl":"HalfPriceCtrl","./SevenDayTargetConst":"SevenDayTargetConst","./SevenDayTargetCtrl":"SevenDayTargetCtrl"}],SevenDayTargetWin:[function(e,t,i){"use strict";cc._RF.push(t,"ee8a2stD91NRaWVd0DTqCnW","SevenDayTargetWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Window"),o=e("../../../Core/GameEventDispatcher"),a=e("../../../Core/Event"),r=e("../../../Util/Utils"),s=e("../../../Core/WindowType"),l=e("../../../Core/LoadManager"),c=e("../../../GlobalContext"),d=e("../../../Core/Language"),p=e("../../../Util/DateUtil"),h=e("../../../Core/TimeController"),u=e("../../Tips/OpTipsController"),f=e("./SevenDayTargetCtrl"),g=e("../../Commons/WindowOpenUtils"),y=e("./SevenDayTargetUtils"),m=e("../HalfPrice/HalfPriceCtrl"),C=e("./item/SevenDayTargetToggleItem"),v=e("./item/SevenDayTargetRewardItem"),_=e("./item/SevenDayTargetTaskItem"),b=e("./item/SevenDayTargetItem"),T=e("./SevenDayTargetConst"),S=e("../../Commons/ListViewCtrl"),I=cc._decorator,w=I.ccclass,D=I.property,R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.progressBar=null,t.integral=null,t.overTimeStr=null,t.rewardContent=null,t.toggleContainer=null,t.toggleTaskContainer=null,t.content=null,t.listViewCtrl=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),this.initUI(),this.updateData(),o.GameEventDispatcher.instance.on(a.EventDefiner.Activity_SevenDayTargetUpdate,this.sortUpdateData,this)},t.prototype.initUI=function(){var e,t=this;y.SevenDayTargetUtils.ctrl;if(this.selectionDayIndex=f.default.instance.selectionDayIndex,this.selectionTaskIndex=f.default.instance.selectionTaskIndex,f.default.instance.setTaskType(),this.toggleContainer.node.childrenCount)for(var i in this.toggleContainer.node.children)this.toggleContainer.node.children[i].getComponent(C.default).upDateRed();else l.default.instance.loadResByType(c.GlobalContext.Root+"prefab/SevenDayTarget/SevenDayTargetToggleItem",cc.Prefab,function(i){for(var n=0;n<f.default.instance.nowConf.length;n++)e=r.default.getNodeByPool(s.PoolType.SevenDayTargetToggleItem,i,c.GlobalContext.Root+"prefab/SevenDayTarget/SevenDayTargetToggleItem"),t.toggleContainer.node.addChild(e),e.getComponent(C.default).initData(n,f.default.instance.nowConf[n])},this);l.default.instance.loadResByType(c.GlobalContext.Root+"prefab/SevenDayTarget/SevenDayTargetRewardItem",cc.Prefab,function(i){for(var n=f.default.instance.nowScoreConf,o=0;o<n.length;o++)e=r.default.getNodeByPool(s.PoolType.SevenDayTargetRewardItem,i,c.GlobalContext.Root+"prefab/SevenDayTarget/SevenDayTargetRewardItem"),t.rewardContent.addChild(e),e.getComponent(v.default).initData(o,n[o])},this),this.time=h.default.instance.setInterval(this.setTImeData,this,1e3),this.nowShow=!0,this.setTImeData(),this.updateTaskData()},t.prototype.updateTaskData=function(){var e=this;l.default.instance.loadResByType(c.GlobalContext.Root+"prefab/SevenDayTarget/SevenDayTargetTaskItem",cc.Prefab,function(t){for(var i,n=f.default.instance.nowConf[e.selectionDayIndex].taskSortData,o=0,a=0;a<n.length;a++)n[a]!=T.SevenDayTargetTaskType.HalfGift||m.default.instance.isOpen?((i=e.toggleTaskContainer.node.children[a])||((i=r.default.getNodeByPool(s.PoolType.SevenDayTargetTaskItem,t,c.GlobalContext.Root+"prefab/SevenDayTarget/SevenDayTargetTaskItem")).scale=.9,e.toggleTaskContainer.node.addChild(i)),i.active=!0,i.getComponent(_.default).initData(a,n[a])):o++;var l=e.toggleTaskContainer.node.children.length-n.length+o;if(l){var d=e.toggleTaskContainer.node.children.length-1;for(a=0;a<l;a++)e.toggleTaskContainer.node.children[d-a].active=!1}var p=h.default.instance.setTimeout(function(){e.node.active&&(e.toggleTaskContainer.node.children[e.selectionTaskIndex].getComponent(cc.Toggle).isChecked=!0,e.selectionTaskIndex>=6&&(e.toggleTaskContainer.node.y=65.7*(e.selectionTaskIndex+1)-388)),h.default.instance.clearTimeout(p)},e,200)},this),this.sortUpdateData()},t.prototype.updateTargetItem=function(){var e=this;l.default.instance.loadResByType(c.GlobalContext.Root+"prefab/SevenDayTarget/SevenDayTargetItem",cc.Prefab,function(t){e.content.parent.parent.getComponent(cc.ScrollView).scrollToTop();var i=y.SevenDayTargetUtils.getSortData();e.setData(i)},this)},t.prototype.setTImeData=function(){var e=y.SevenDayTargetUtils.getOverTime();e<=0?(this.close(),y.SevenDayTargetUtils.setHideDeal(!0)):this.overTimeStr.string=d.default.getStr("7107",p.DateUtil.setTimeToChineseHMStrTwo(e))},t.prototype.hide=function(){e.prototype.hide.call(this),this.nowShow=null;for(var t=this.content.childrenCount-1;t>=0;t--)r.default.setNodeToPool(s.PoolType.SevenDayTargetItem,this.content.children[t]);for(t=this.rewardContent.childrenCount-1;t>=0;t--)r.default.setNodeToPool(s.PoolType.SevenDayTargetRewardItem,this.rewardContent.children[t]);o.GameEventDispatcher.instance.off(a.EventDefiner.Activity_SevenDayTargetUpdate,this.sortUpdateData,this),this.closeTime(),this.selectionDayIndex=this.selectionTaskIndex=null},t.prototype.closeTime=function(){h.default.instance.clearInterval(this.time),this.time=null},t.prototype.updateData=function(){var e=y.SevenDayTargetUtils.ctrl;this.progressBar.getComponent(cc.ProgressBar).progress=e.integral/e.allIntegral,this.integral.string=""+f.default.instance.integral},t.prototype.onClickToggle=function(e){var t=this;if(this.nowShow){var i=parseInt(e.target.name);if(null==i||i!=this.selectionDayIndex)if(i&&f.default.instance.dayNum<i){u.default.instance.ShowMsg(d.default.getStr("7108",i+1));var n=h.default.instance.setTimeout(function(){t.toggleContainer.node.children[t.selectionDayIndex].getComponent(cc.Toggle).isChecked=!0,h.default.instance.clearTimeout(n)},this,200)}else f.default.instance.selectionDayIndex=this.selectionDayIndex=i,f.default.instance.selectionTaskIndex=this.selectionTaskIndex=0,f.default.instance.setTaskType(),this.toggleTaskContainer.node.parent.parent.getComponent(cc.ScrollView).scrollToTop(),this.updateTaskData()}},t.prototype.onClickTaskToggle=function(e){if(this.nowShow){var t=parseInt(e.target.name);null!=t&&t==this.selectionTaskIndex||(f.default.instance.selectionTaskIndex=this.selectionTaskIndex=t,f.default.instance.setTaskType(),this.updateTaskData())}},t.prototype.sortUpdateData=function(){this.updateTargetItem(),this.updateData()},t.prototype.onClickRanking=function(){g.default.instance.openWindowType(s.WindowType.SevenDayTargetRank)},t.prototype.setData=function(e){this.listViewCtrl.refreshItem=this.updateitem,this.listViewCtrl.refreshItemThis=this,this.listViewCtrl.initialize(e),this.listViewCtrl.scrollToTop()},t.prototype.updateitem=function(e,t){var i=this.listViewCtrl.dataLsit[t];e.getComponent(b.default).initData(t,i)},__decorate([D(cc.ProgressBar)],t.prototype,"progressBar",void 0),__decorate([D(cc.Label)],t.prototype,"integral",void 0),__decorate([D(cc.RichText)],t.prototype,"overTimeStr",void 0),__decorate([D(cc.Node)],t.prototype,"rewardContent",void 0),__decorate([D(cc.ToggleContainer)],t.prototype,"toggleContainer",void 0),__decorate([D(cc.ToggleContainer)],t.prototype,"toggleTaskContainer",void 0),__decorate([D(cc.Node)],t.prototype,"content",void 0),__decorate([D(S.default)],t.prototype,"listViewCtrl",void 0),t=__decorate([w],t)}(n.default);i.default=R,cc._RF.pop()},{"../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Core/LoadManager":"LoadManager","../../../Core/TimeController":"TimeController","../../../Core/Window":"Window","../../../Core/WindowType":"WindowType","../../../GlobalContext":"GlobalContext","../../../Util/DateUtil":"DateUtil","../../../Util/Utils":"Utils","../../Commons/ListViewCtrl":"ListViewCtrl","../../Commons/WindowOpenUtils":"WindowOpenUtils","../../Tips/OpTipsController":"OpTipsController","../HalfPrice/HalfPriceCtrl":"HalfPriceCtrl","./SevenDayTargetConst":"SevenDayTargetConst","./SevenDayTargetCtrl":"SevenDayTargetCtrl","./SevenDayTargetUtils":"SevenDayTargetUtils","./item/SevenDayTargetItem":"SevenDayTargetItem","./item/SevenDayTargetRewardItem":"SevenDayTargetRewardItem","./item/SevenDayTargetTaskItem":"SevenDayTargetTaskItem","./item/SevenDayTargetToggleItem":"SevenDayTargetToggleItem"}],Shake:[function(e,t,i){"use strict";cc._RF.push(t,"1903fiNeo5KGIs83IFlkw3C","Shake"),Object.defineProperty(i,"__esModule",{value:!0});var n=cc._decorator,o=n.ccclass,a=(n.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._initial_x=0,t._initial_y=0,t._strength_x=0,t._strength_y=0,t}var i;return __extends(t,e),i=t,t.create=function(e,t,n){var o=new i;return o.initWithDuration(e,t,n),o},t.prototype.initWithDuration=function(e,t,i){return cc.ActionInterval.prototype.initWithDuration.apply(this,arguments),this._strength_x=t,this._strength_y=i,!0},t.prototype.fgRangeRand=function(e,t){return Math.random()*(t-e)+e},t.prototype.update=function(e){var t=this.fgRangeRand(-this._strength_x,this._strength_x),i=this.fgRangeRand(-this._strength_y,this._strength_y);this.getOriginalTarget().setPosition(t+this._initial_x,i+this._initial_y)},t.prototype.startWithTarget=function(e){cc.ActionInterval.prototype.startWithTarget.apply(this,arguments),this._initial_x=e.x,this._initial_y=e.y},t.prototype.stop=function(){this.getOriginalTarget().setPosition(new cc.Vec2(this._initial_x,this._initial_y)),cc.ActionInterval.prototype.stop.apply(this)},t=i=__decorate([o],t)}(cc.ActionInterval));i.Shake=a,cc._RF.pop()},{}],ShopBuyConfire:[function(e,t,i){"use strict";cc._RF.push(t,"8d99e9OWBNOo5XSzfa88OsE","ShopBuyConfire"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/Language"),a=e("../TreasureMap/TreasureMapController"),r=e("../Buff/BuffController"),s=cc._decorator,l=s.ccclass,c=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.labelBuyTips=[],t.labelBuffDesc=null,t.spriteNodeType=null,t.commonAtlas=null,t.index=0,t}return __extends(t,e),t.prototype.onInitData=function(e,t,i,n,s){if(void 0===s&&(s=0),this.index=e,this.spriteNodeType.spriteFrame=this.commonAtlas.getSpriteFrame(t),this.labelBuyTips[0].string=o.default.getStr("treasure_shop_tips1"),this.labelBuyTips[1].string=n+"",this.labelBuyTips[2].string=o.default.getStr("treasure_shop_tips2"),this.labelBuffDesc.node.active=!1,s>0){var l=r.default.instance.getBuffById(a.default.instance.getBuffIdByIndex(s));if(l){var c=Math.floor(1e4*Math.abs(l.param||l.param1))/100,d=o.default.getStr1(l.buffDesc,[c]);this.labelBuffDesc.node.active=!0,this.labelBuffDesc.string=d+""}}},t.prototype.onClickConfire=function(){a.default.instance.sendBuyItem(this.index,1),this.onClickCancle()},t.prototype.onClickCancle=function(){this.node.active=!1},t.prototype.onClickBlack=function(){},__decorate([c(cc.Label)],t.prototype,"labelBuyTips",void 0),__decorate([c(cc.Label)],t.prototype,"labelBuffDesc",void 0),__decorate([c(cc.Sprite)],t.prototype,"spriteNodeType",void 0),__decorate([c(cc.SpriteAtlas)],t.prototype,"commonAtlas",void 0),t=__decorate([l],t)}(n.default);i.default=d,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/Widget":"Widget","../Buff/BuffController":"BuffController","../TreasureMap/TreasureMapController":"TreasureMapController"}],ShopConst:[function(e,t,i){"use strict";cc._RF.push(t,"ca881wu0BJHWJC78c2fWq0B","ShopConst"),Object.defineProperty(i,"__esModule",{value:!0}),function(e){e[e.Diamonds=1]="Diamonds",e[e.Honor=2]="Honor",e[e.integral=3]="integral",e[e.Recharge=4]="Recharge",e[e.Equip=5]="Equip",e[e.SoulCard=6]="SoulCard"}(i.ShopConst||(i.ShopConst={})),cc._RF.pop()},{}],ShopController:[function(e,t,i){"use strict";cc._RF.push(t,"7f9a7o6DBhJ/6R6ZfZyanUf","ShopController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../Core/GameEventDispatcher"),a=e("../../Core/Event"),r=e("../../Core/WindowType"),s=e("../../Core/ConfigsManager"),l=e("../OpenWin/OpenWinController"),c=e("../../Global/GlobalValue"),d=e("../../NetConnect/NetConnet"),p=e("./ShopConst"),h=e("../Role/RoleInfo"),u=e("./ShopItemVo"),f=e("../Item/ItemController"),g=e("../EquipCopy/EquipCopyController"),y=e("../Equip/equip/EquipCtrl"),m=e("./ShopItem"),C=e("../Functionicon/FunctionIconController"),v=e("../ActivityView/ActivityCtrl"),_=e("../../Util/SDKUtils"),b=e("../Chapter/ChapterController"),T=e("../Guide/GuideNewController"),S=e("../Tips/OpTipsController"),I=e("../../Core/Language"),w=e("./ItemInfo"),D=cc._decorator,R=D.ccclass,A=(D.property,function(e){function t(){var t=e.call(this)||this;return t.oldNode=null,t.oldParent=null,t.id=0,t.count=0,t.price=0,t.index=0,t.data=null,t.diamondData=null,t.soulCardData=null,t.freeTimes=0,t.buyFreshTimes=0,t.refreshTime=0,t.maxBuyCount=0,t.chipid=null,t.soulCard=null,t.shopConf=null,t.chooseTpye=null,t.sortIndex={},t.nowSortIndex={},t.shopList={},i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.shopConf=s.ConfigsManager.instance.getConfigs("ShopConf")},t.prototype.start=function(){e.prototype.start.call(this);var t=this.shopConf.label,i=this.shopConf.ShopConf,n=this.shopConf.shopequipment;for(var o in t)this.sortIndex[t[o].buyPriority]=parseInt(o),this.nowSortIndex[o]=t[o].buyPriority;for(var o in i){this.shopList[i[o].type]||(this.shopList[i[o].type]=[]);var a=new u.ShopItemVo(i[o]);this.shopList[i[o].type].push(a)}for(var o in n){this.shopList[n[o].type]||(this.shopList[n[o].type]=[]);a=new u.ShopItemVo(n[o]);this.shopList[n[o].type].push(a)}this.chipid=n[1].chipid,this.soulCard=this.shopConf.shopchipconf[1].itemId,g.default.instance.sendCmdEquipCopyMain()},t.prototype.listNotification=function(){this.addProto("shop",this.getPucheaseNum,this),this.addProto("diamondshop",this.getPresent,this),this.addProto("equipshop",this.updateEquip,this),this.addProto("shopchip",this.SoulCard,this),this.addProto("recharge",this.rechargeSucceedBack,this),this.addProto("buyret",this.buyret,this),o.GameEventDispatcher.instance.on(a.EventDefiner.Activity_YunyingUP,this.RechargeHilarity,this)},t.prototype.rechargeSucceedBack=function(e){console.log("\u652f\u4ed8\u8fd4\u56de"),_.default.instance.platformSdk.payBack()},t.prototype.updateEquip=function(e){o.GameEventDispatcher.instance.emit(a.EventDefiner.PlayerMoneyChange)},t.prototype.onSendBuyCmd=function(e,t){void 0===t&&(t=1);var i={cmd:"shop",id:e,count:t};d.default.instance.sendProto(i)},t.prototype.onSendBuyCmdEquip=function(e,t){void 0===t&&(t=1);var i={cmd:"equipshop",id:e,count:t};d.default.instance.sendProto(i)},t.prototype.SendBuySoulCard=function(e,t){var i={cmd:"shopchip",id:e,count:t};d.default.instance.sendProto(i)},t.prototype.BuyRefreshTimes=function(){d.default.instance.sendProto({cmd:"buyrefreshcnt"})},t.prototype.getPresent=function(e){console.log(e),this.diamondData=e.times,this.RechargeHilarity(),o.GameEventDispatcher.instance.emit(a.EventDefiner.TopUpFlag,this)},t.prototype.openPrefab=function(e,t,i){void 0===i&&(i=0);var n=0;if(this.chooseTpye==p.ShopConst.Equip){var o=this.shopList[p.ShopConst.Equip];if(o[t-1].price.length>1){var a=o[t-1].price.length;if(null!=this.data[t-1])n=(s=Number(this.data[t]))<a?s:a-1}}else if(this.chooseTpye==p.ShopConst.SoulCard)n=t.count;else if(this.shopConf.ShopConf[t].price.length>1){var s;a=this.shopConf.ShopConf[t].price.length;if(null!=this.data[t])n=(s=Number(this.data[t]))<a?s:a-1}e.getComponent(m.default).initItem(t,n,r.WindowType.Shop,i)},t.prototype.openItemInfoPrefab=function(e,t,n,o){void 0===t&&(t=0),void 0===n&&(n=0),void 0===o&&(o=0),this.id=e,this.count=t,this.price=n,i.instance.chooseTpye==p.ShopConst.Equip||i.instance.chooseTpye==p.ShopConst.SoulCard?(i.instance.chooseTpye==p.ShopConst.SoulCard&&(this.index=o),l.default.instance.openWindow(r.WindowType.ShopItemInfo,this.callBack,this)):4!=this.shopConf.ShopConf[e].label&&l.default.instance.openWindow(r.WindowType.ShopItemInfo,this.callBack,this)},t.prototype.callBack=function(){var e=0;this.data[this.id]&&(e=this.data[this.id]);var t=0,n=1;i.instance.chooseTpye==p.ShopConst.Equip?t=e<this.shopConf.shopequipment[this.id].price.length?e:this.shopConf.shopequipment[this.id].price.length-1:i.instance.chooseTpye==p.ShopConst.SoulCard?(e=this.count,t=this.price):(t=e<this.shopConf.ShopConf[this.id].price.length?e:this.shopConf.ShopConf[this.id].price.length-1,n=this.shopConf.ShopConf[this.id].count),w.default.instance.initInfo(this.id,e,t,1,this.index,n)},t.prototype.getPucheaseNum=function(e){this.data=e.data,o.GameEventDispatcher.instance.emit(a.EventDefiner.RenewPrice)},t.prototype.openQUickBuyWin=function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=1),l.default.instance.openWindow(r.WindowType.ShopItemInfo,this.quickBuy,this,[e,t,i]),console.log(e,t,i,"*---------")},t.prototype.quickBuy=function(e,t,i,n){void 0===i&&(i=0),void 0===n&&(n=1),console.log(t+"           "+i);var o=[],a=0,r=0;for(var s in this.shopConf.ShopConf)t==this.shopConf.ShopConf[s].itemid&&(o[a]=Number(s),console.log(o[a]),a++,console.log("\u627e\u5230\u5546\u57ceid\u4e86"));if(o.length>1){console.log("\u6709\u4e24\u4e2a\u4ee5\u4e0a\u6807\u7b7e\uff0c\u9700\u8981\u5224\u5b9a\u8d27\u5e01\u4f18\u5148\u7ea7");for(var l=0,c=0,d=!0,p=0;p<o.length-1;p++)this.shopConf.ShopConf[o[p]].type==n?(console.log("\u4f18\u5148\u9009\u62e9\u8f93\u5165\u8d27\u5e01"),d=!1,(r=this.data[o[p]])<this.shopConf.ShopConf[o[p]].price.length?w.default.instance.initInfo(o[p],r,r,i):w.default.instance.initInfo(o[p],r,this.shopConf.ShopConf[o[p]].price.length-1,i)):this.shopConf.ShopConf[o[p]].label.buyPriority>l&&(l=this.shopConf.ShopConf[o[p]].label.buyPriority,c=o[p]);1==d&&(r=this.data[c],console.log("\u8f93\u5165\u8d27\u5e01\u4e0d\u80fd\u8d2d\u4e70\u6b64\u5546\u54c1\uff0c\u9009\u8868\u4e2d\u4f18\u5148\u7ea7\u6700\u9ad8\u7684id"),r<this.shopConf.ShopConf[c].price.length?w.default.instance.initInfo(c,r,r,i):w.default.instance.initInfo(c,r,this.shopConf.ShopConf[c].price.length-1,i))}else r=this.data[o[0]],console.log("\u53ea\u6709\u4e00\u4e2a\u6807\u7b7e\uff0c\u6839\u636e\u5217\u8868\u9009\u62e9\u8d27\u5e01\u7c7b\u578b"+o[0]),r<this.shopConf.ShopConf[o[0]].price.length?w.default.instance.initInfo(o[0],r,r,i):w.default.instance.initInfo(o[0],r,this.shopConf.ShopConf[o[0]].price.length-1,i)},t.prototype.onEnable=function(){},t.prototype.onDestroy=function(){},t.prototype.getIconNmae=function(e){return e==c.SHOP_TAG.Money?"coin":e==c.SHOP_TAG.Diamond||e==c.SHOP_TAG.Add_Diamond?"diamond":e==c.SHOP_TAG.Honor?"golry":e==c.SHOP_TAG.Integral?"point":e==c.SHOP_TAG.Equip?"equip":e==c.SHOP_TAG.SoulCard?"soulCard":void 0},t.prototype.getShopIconName=function(e){var t=null;switch(e){case p.ShopConst.Diamonds:case p.ShopConst.Recharge:t="diamond";break;case p.ShopConst.Honor:t="golry";break;case p.ShopConst.integral:t="point";break;case p.ShopConst.Equip:t="equip";break;case p.ShopConst.SoulCard:t="soulCard"}return t},t.prototype.getShopTypeNum=function(e){var t=null;switch(e){case p.ShopConst.Diamonds:case p.ShopConst.Recharge:t=h.MyRoleInfo.diamond;break;case p.ShopConst.Honor:t=h.MyRoleInfo.honor;break;case p.ShopConst.integral:t=h.MyRoleInfo.point;break;case p.ShopConst.Equip:t=f.default.instance.getItemNum(this.chipid);break;case p.ShopConst.SoulCard:t=f.default.instance.getItemNum(this.soulCard)}return t},t.prototype.getShopCostType=function(e){return this.shopConf.ShopConf[e].type},t.prototype.isUnUnlockEquip=function(e){var t=0;if(i.instance.chooseTpye==p.ShopConst.Equip){var n=this.shopList[this.chooseTpye][e-1].unlock-1,o=b.default.instance.getChapterLength();C.default.instance.checkIsPass(n,o)||(t=n+1)}return t},t.prototype.equipData=function(e,t){var i=[];for(var n in e){y.default.instance.data.getEquipInfoById(e[n].itemid).range[0]==t&&(e[n].guide?T.default.instance.isGuide&&i.push(e[n]):i.push(e[n]))}return i},t.prototype.SoulCard=function(e){this.soulCardData=e.items,this.freeTimes=e.remainFreshTimes,this.buyFreshTimes=e.buyFreshTimes,this.refreshTime=e.refreshStamp,this.maxBuyCount=e.maxBuyCnt,o.GameEventDispatcher.instance.emit("SoulCardInfo",this)},t.prototype.Refresh=function(){d.default.instance.sendProto({cmd:"refreshchip"})},t.prototype.SendSouldCard=function(){d.default.instance.sendProto({cmd:"shopchipinfo"})},t.prototype.RechargeHilarity=function(){v.default.instance.data.getYunyingData(r.WindowType.RechargeWin)?(C.default.instance.FuncIconHideDeal(r.WindowType.RechargeWin,!1),this.isShow()||C.default.instance.FuncIconHideDeal(r.WindowType.RechargeWin,!0)):C.default.instance.FuncIconHideDeal(r.WindowType.RechargeWin,!0)},t.prototype.isShow=function(){var e=s.ConfigsManager.instance.getConfigs("rechargecarnivalconf").rechargecarnival[1];if(this.diamondData.length!=e.length)return!0;for(var t in this.diamondData)if(this.diamondData.length==e.length&&!this.diamondData[t])return!0},t.prototype.buyret=function(e){e.reward&&S.default.instance.ShowMsg(I.default.getStr("shop_01"))},t.instance=null,t=i=__decorate([R],t)}(n.default));i.default=A,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../NetConnect/NetConnet":"NetConnet","../../Util/SDKUtils":"SDKUtils","../ActivityView/ActivityCtrl":"ActivityCtrl","../Chapter/ChapterController":"ChapterController","../Equip/equip/EquipCtrl":"EquipCtrl","../EquipCopy/EquipCopyController":"EquipCopyController","../Functionicon/FunctionIconController":"FunctionIconController","../Guide/GuideNewController":"GuideNewController","../Item/ItemController":"ItemController","../OpenWin/OpenWinController":"OpenWinController","../Role/RoleInfo":"RoleInfo","../Tips/OpTipsController":"OpTipsController","./ItemInfo":"ItemInfo","./ShopConst":"ShopConst","./ShopItem":"ShopItem","./ShopItemVo":"ShopItemVo"}],ShopData:[function(e,t,i){"use strict";cc._RF.push(t,"aa8d6Y/V4FPZ6MbyoDovUjh","ShopData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/ConfigsManager"),o=e("./ShopConst"),a=e("./ShopController"),r=e("../Vip/VipCtrl"),s=e("../Role/RoleInfo"),l=cc._decorator,c=l.ccclass,d=(l.property,function(){function e(){this._config=null,this.ShopConf=null}return e.prototype.initData=function(e){var t=n.ConfigsManager.instance.getConfigs("ShopConf");a.default.instance.chooseTpye==o.ShopConst.Equip?this.ShopConf=t.shopequipment:this.ShopConf=t.ShopConf,this.id=e},Object.defineProperty(e.prototype,"config",{get:function(){return this._config=n.ConfigsManager.instance.getConfigs("ShopConf"),this._config},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shopid",{get:function(){return this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemid",{get:function(){return this.ShopConf[this.id].itemid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"label",{get:function(){return this.ShopConf[this.id].label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"price",{get:function(){return this.ShopConf[this.id].price},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this.ShopConf[this.id].type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"count",{get:function(){return this.ShopConf[this.id].count},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"limit",{get:function(){var e=0;return this.ShopConf[this.id].limit&&(e=this.ShopConf[this.id].limit),a.default.instance.chooseTpye!=o.ShopConst.Equip&&(e+=r.default.instance.data.getAddNum(s.MyRoleInfo.vipLevel,this.id)),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"discount",{get:function(){return this.ShopConf[this.id].discount?this.ShopConf[this.id].discount:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstPurchase",{get:function(){return this.ShopConf[this.id].firstPurchase?this.ShopConf[this.id].firstPurchase:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labelName",{get:function(){return this.config.label[this.label].name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){return this.ShopConf[this.id].icon},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemType",{get:function(){return this.ShopConf[this.id].itemType},enumerable:!0,configurable:!0}),e=__decorate([c],e)}());i.default=d,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../Role/RoleInfo":"RoleInfo","../Vip/VipCtrl":"VipCtrl","./ShopConst":"ShopConst","./ShopController":"ShopController"}],ShopItemVo:[function(e,t,i){"use strict";cc._RF.push(t,"a1d30ABWEZHgqNbjxyZTXXA","ShopItemVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){return function(e){for(var t in this.id=null,this.levelname=null,this.type=null,this.price=null,this.limit=null,this.label=null,this.count=null,this.itemid=null,this.discount=null,this.firstPurchase=null,this.unlock=null,this.chipid=null,e)this[t]=e[t]}}();i.ShopItemVo=n,cc._RF.pop()},{}],ShopItem:[function(e,t,i){"use strict";cc._RF.push(t,"7672bj0/M9KVKHrKjiLv6B5","ShopItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("./ShopController"),a=e("../Item/ItemData"),r=e("./ShopData"),s=e("../Sound/SoundController"),l=e("../../Core/Language"),c=e("../../Core/WindowType"),d=e("./ShopConst"),p=e("./Shop"),h=cc._decorator,u=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ItemName=null,t.ItemIcon=null,t.Discount=null,t.MoneyIcons=null,t.ThemeNumber=null,t.Price=null,t.condition=null,t.Icon=null,t.itemType=null,t.discountnum=null,t.discount=null,t.TopUp=null,t.sellOut=null,t.ChooseInfo=null,t.id=0,t.count=0,t.priceNum=0,t.isCanClick=null,t.index=0,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.initItem=function(e,t,i,n){void 0===i&&(i=c.WindowType.Shop),void 0===n&&(n=0),this.isCanClick=!0,this.Price.node.active=!0,this.Price.font=this.ThemeNumber,this.condition.node.active=!1,this.id=e;var s,h,u=new a.default;if(o.default.instance.sortIndex[p.default.instance.index]==d.ShopConst.SoulCard)this.Price.string=e.soulCnt,s=e.itemId,h=e.count,this.count=e.remainCnt,this.priceNum=e.soulCnt,this.Icon.spriteFrame=this.MoneyIcons.getSpriteFrame("soulCard"),this.discount.active=!1,this.index=n,this.count<=0?(this.sellOut.active=!0,this.isCanClick=!1,this.ItemName.node.active=!1,this.TopUp.active=!1,this.Price.node.parent.active=!1,this.ItemIcon.active=!1):(this.TopUp.active=!1,this.sellOut.active=!1,this.isCanClick=!0,this.ItemName.node.active=!0,this.Price.node.parent.active=!0,this.ItemIcon.active=!0);else{var f=new r.default;f.initData(e);var g=o.default.instance.getIconNmae(f.labelName);this.Icon.spriteFrame=this.MoneyIcons.getSpriteFrame(g),s=f.itemid,h=f.count,this.ItemName.node.active=!0,this.Price.node.parent.active=!0,this.Price.string=f.price[t]+"";var y=o.default.instance.isUnUnlockEquip(e);this.sellOut.active=!1,this.ItemIcon.active=!0,y&&(this.Price.node.active=!1,this.condition.node.active=!0,this.Icon.spriteFrame=this.MoneyIcons.getSpriteFrame("lock"),this.condition.string=l.default.getStr("5001",y),this.isCanClick=!1),f.discount>0?(this.discount.active=!0,this.discountnum.string=l.default.getStr("discount",f.discount)):this.discount.active=!1,1==f.firstPurchase?this.TopUp.active=!0:this.TopUp.active=!1}u=a.default.creatItem(s,h),this.ItemIcon.getComponent("ItemIcon").ItemData(u,!0,null,!1),this.ItemName.string=u.name},t.prototype.ItemClick=function(){s.default.instance.PlayEffect(s.SoundType.comclick),this.isCanClick&&o.default.instance.openItemInfoPrefab(this.id,this.count,this.priceNum,this.index)},__decorate([f(cc.Label)],t.prototype,"ItemName",void 0),__decorate([f(cc.Node)],t.prototype,"ItemIcon",void 0),__decorate([f(cc.Sprite)],t.prototype,"Discount",void 0),__decorate([f(cc.SpriteAtlas)],t.prototype,"MoneyIcons",void 0),__decorate([f(cc.LabelAtlas)],t.prototype,"ThemeNumber",void 0),__decorate([f(cc.Label)],t.prototype,"Price",void 0),__decorate([f(cc.RichText)],t.prototype,"condition",void 0),__decorate([f(cc.Sprite)],t.prototype,"Icon",void 0),__decorate([f(cc.Sprite)],t.prototype,"itemType",void 0),__decorate([f(cc.Label)],t.prototype,"discountnum",void 0),__decorate([f(cc.Node)],t.prototype,"discount",void 0),__decorate([f(cc.Node)],t.prototype,"TopUp",void 0),__decorate([f(cc.Node)],t.prototype,"sellOut",void 0),t=__decorate([u],t)}(n.default);i.default=g,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../Item/ItemData":"ItemData","../Sound/SoundController":"SoundController","./Shop":"Shop","./ShopConst":"ShopConst","./ShopController":"ShopController","./ShopData":"ShopData"}],ShopModel:[function(e,t,i){"use strict";cc._RF.push(t,"6383f799K1EsLIUWOh5d3tA","ShopModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./Shop"),o=cc._decorator,a=o.ccclass,r=(o.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var i;return __extends(t,e),i=t,Object.defineProperty(t,"instance",{get:function(){return i._instance||(i._instance=new i),i._instance},enumerable:!0,configurable:!0}),t.prototype.openShopByTab=function(e){n.default.instance.TabBtnList2.selectItem(e)},t._instance=null,t=i=__decorate([a],t)}(cc.Widget));i.default=r,cc._RF.pop()},{"./Shop":"Shop"}],Shop:[function(e,t,i){"use strict";cc._RF.push(t,"b4b6aiyYmBIe5yabsdBflm/","Shop"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("./ShopController"),a=e("../../Core/GameEventDispatcher"),r=e("../../Core/Event"),s=e("../../Core/ConfigsManager"),l=e("../Gamelayer/GameLayer"),c=e("../../Global/GlobalValue"),d=e("../../Core/Language"),p=e("../../NetConnect/NetConnet"),h=e("../Status/StatusType"),u=e("../OpenWin/OpenWinController"),f=e("../../Core/WindowType"),g=e("../Arena/ArenaWindow"),y=e("../../Util/NumberUtil"),m=e("../../GlobalContext"),C=e("../Functionicon/FunctionIconController"),v=e("../Commons/TabBtnSubList"),_=e("./ShopConst"),b=e("../Commons/ListViewCtrl"),T=e("../../Core/TimeController"),S=e("../../Util/RechargeUtils"),I=e("../../Util/RechargeConst"),w=e("../Tips/OpTipsController"),D=e("../Vip/VipCtrl"),R=e("../Tips/TipsWinController"),A=cc._decorator,N=A.ccclass,L=A.property,E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.TabBtnList2=null,t.TabIcon=null,t.TopUpNode=null,t.OtherShop=null,t.labelNode=null,t.Node1=null,t.Node2=null,t.Text1=null,t.Text2=null,t.Text3=null,t.Text4=null,t.Text5=null,t.Text6=null,t.icon=null,t.goldLabel=null,t.Images=null,t.itemList=null,t.SoulCard=null,t.index=0,t.tabname=[],t.tabindex={},t.shopConf=null,t.timeOut=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this,o.default.instance.SendSouldCard(),this.shopConf=s.ConfigsManager.instance.getConfigs("ShopConf"),this.node.width=m.GlobalContext.UIWidth,this.node.height=m.GlobalContext.UIHeight,this.initTab()},t.prototype.show=function(){if(e.prototype.show.call(this),this.TabBtnList2.getComponent(v.default).flag=!0,m.PlayerData.TopPanel.active=!1,this.labelNode.active=!1,this.SoulCard.active=!1,this.Node1.active=!1,this.Text2.string=d.default.getStr("expedition"),this.Text3.string=d.default.getStr("Arena"),this.Text4.string=d.default.getStr("and"),this.Text5.string=d.default.getStr("HighLadder"),this.Text6.string=d.default.getStr("pass"),a.GameEventDispatcher.instance.on(r.EventDefiner.RenewPrice,this.ItemChange,this),a.GameEventDispatcher.instance.on(r.EventDefiner.PlayerMoneyChange,this.upCurrency,this),a.GameEventDispatcher.instance.on(r.EventDefiner.itemchangeUP,this.upCurrency,this),a.GameEventDispatcher.instance.on("SoulCardInfo",this.ItemChange,this),a.GameEventDispatcher.instance.on(r.EventDefiner.vip_level_up,this.openVipUPTips,this),o.default.instance.chooseTpye){var t=this.tabindex[o.default.instance.chooseTpye].name;this.setRedirectionText(t)}this.ItemChange()},t.prototype.hide=function(){e.prototype.hide.call(this),T.default.instance.clearInterval(this.timeOut),a.GameEventDispatcher.instance.off(r.EventDefiner.RenewPrice,this.ItemChange,this),a.GameEventDispatcher.instance.off(r.EventDefiner.PlayerMoneyChange,this.upCurrency,this),a.GameEventDispatcher.instance.off("SoulCardInfo",this.ItemChange,this),a.GameEventDispatcher.instance.off(r.EventDefiner.vip_level_up,this.openVipUPTips,this),a.GameEventDispatcher.instance.off(r.EventDefiner.itemchangeUP,this.upCurrency,this),this.TabBtnList2.getComponent(v.default).flag=!1},t.prototype.SelectedChange=function(e){o.default.instance.chooseTpye=o.default.instance.sortIndex[e];var t=this.tabindex[o.default.instance.chooseTpye].label,i=this.tabindex[o.default.instance.chooseTpye].name;this.index=e,i!=c.SHOP_TAG.Add_Diamond?(this.shopConf.label[t].icon?l.default.instance.IconChange(this.shopConf.label[t].icon):l.default.instance.IconChange(),this.TopUpNode.active=!1,this.OtherShop.active=!0,this.Iteminit(e),this.OtherShop.getComponent(cc.ScrollView).scrollToTop(.05)):(l.default.instance.IconChange(),this.TopUpNode.active=!0,this.OtherShop.active=!1,this.TopUpNode.getComponent("DiamondShop").init(),this.TopUpNode.getComponent(cc.ScrollView).scrollToLeft()),this.setRedirectionText(i),this.currency()},t.prototype.Iteminit=function(e){var t=this,i=o.default.instance.sortIndex[e],n=o.default.instance.shopList[i];if(i==_.ShopConst.Equip)n=o.default.instance.equipData(n,1);else if(i==_.ShopConst.SoulCard){this.upCurrency(),n=o.default.instance.soulCardData;var a=T.default.instance.ServerTimeMins,r=o.default.instance;this.SoulCard.getChildByName("TimesLabe").getComponent(cc.Label).string=r.freeTimes+"",T.default.instance.clearInterval(this.timeOut),this.timeOut=T.default.instance.setInterval(function(){if(a<r.refreshTime){a+=1e3;var e=r.refreshTime-a,i=parseInt(""+e/1e3/60/60%24)+"\u65f6"+parseInt(""+e/1e3/60%60)+"\u5206"+parseInt(""+e/1e3%60)+"\u79d2";t.SoulCard.getChildByName("TimeOutLabe").getComponent(cc.Label).string=i}else o.default.instance.SendSouldCard()},this,1e3)}this.setData(n)},t.prototype.ItemChange=function(){this.Iteminit(this.index)},t.prototype.initTab=function(){this.TabBtnList2.getComponent(v.default).flag=!0;var e=this.shopConf.label,t={};for(var i in e)t[e[i].buyPriority]=e[i];var n=0;for(var a in t)1==t[a].isShow&&(this.tabname[n]=t[a].name,this.tabindex[t[a].label]=t[a],n++);this.TabBtnList2.TabBtnNames=this.tabname,this.TabBtnList2.selectedCallback=this.SelectedChange,this.TabBtnList2.selectedCallbackThisObj=this,this.TabBtnList2.subselectedCallback=this.SubTabBtnSelectedChange,this.TabBtnList2.subselectedCallbackThisObj=this;var r=[];r[o.default.instance.nowSortIndex[_.ShopConst.Equip]]=["\u524d  \u6392","\u4e2d  \u6392"," \u540e  \u6392"],this.TabBtnList2.setSubData(r)},t.prototype.SubTabBtnSelectedChange=function(e){var t=o.default.instance.sortIndex[this.index];switch(t){case _.ShopConst.Equip:var i=o.default.instance.shopList[t];i=o.default.instance.equipData(i,e+1),this.setData(i),this.OtherShop.getComponent(cc.ScrollView).scrollToTop(.05)}},t.prototype.close=function(){e.prototype.close.call(this),l.default.instance.IconChange()},t.prototype.getShopTag=function(e){for(var t in this.tabname)if(this.tabname[t]==e)return Number(t);return 0},t.prototype.setRedirectionText=function(e){this.labelNode.active=!0;var t=d.default.getStr("available");e==c.SHOP_TAG.Honor?(this.Node2.active=!0,this.Node1.active=!1,this.SoulCard.active=!1,this.Text1.string=t+d.default.getStr("Honor")):e==c.SHOP_TAG.Integral?(this.Node2.active=!1,this.Node1.active=!0,this.Text1.string=t+d.default.getStr("Integral"),this.SoulCard.active=!1):e==c.SHOP_TAG.SoulCard?(this.labelNode.active=!1,this.SoulCard.active=!0):(this.SoulCard.active=!1,this.labelNode.active=!1)},t.prototype.openHighLadder=function(){this.checkIsOpen(f.WindowType.HighLadderWin)&&(this.hide(),a.GameEventDispatcher.instance.emit(r.EventDefiner.ChangeActivityStatus,h.ActivityStatus.HighLadder))},t.prototype.openArena=function(){this.checkIsOpen(f.WindowType.Arena)&&(this.hide(),a.GameEventDispatcher.instance.emit(r.EventDefiner.ChangeActivityStatus,h.ActivityStatus.Arena),u.default.instance.openWindow(f.WindowType.Arena,function(e){p.default.instance.sendProto({cmd:"matchrace"}),e.getComponent(g.default).initTeamModel(),e.getComponent(g.default).initTime()},this))},t.prototype.openExpedition=function(){this.checkIsOpen(f.WindowType.Expedition)&&(this.hide(),a.GameEventDispatcher.instance.emit(r.EventDefiner.ChangeActivityStatus,h.ActivityStatus.Expedition))},t.prototype.currency=function(){var e=o.default.instance.sortIndex[this.index],t=o.default.instance.getShopIconName(e);this.icon.spriteFrame=this.Images.getSpriteFrame(t);var i=o.default.instance.getShopTypeNum(e);e==_.ShopConst.Diamonds?this.goldLabel.string=y.NumberUtil.getDiamondNum(i):this.goldLabel.string=y.NumberUtil.getNumber(i)},t.prototype.upCurrency=function(){this.currency()},t.prototype.checkIsOpen=function(e){var t=C.default.instance.getWindowtype(e);if(!t)return!1;t.id;return!!C.default.instance.checkIsOpenbyWindowtype(e,!0)},t.prototype.setData=function(e){this.itemList.refreshItem=this.updateitem,this.itemList.refreshItemThis=this,this.itemList.initialize(e),this.itemList.scrollToTop()},t.prototype.updateitem=function(e,t){var i=this.itemList.dataLsit[t];o.default.instance.sortIndex[this.index]==_.ShopConst.SoulCard?o.default.instance.openPrefab(e,i,t):o.default.instance.openPrefab(e,i.id)},t.prototype.refresh=function(){o.default.instance.freeTimes<=0?w.default.instance.ShowMsg("\u5f53\u524d\u5237\u65b0\u6b21\u6570\u4e0d\u8db3\uff0c\u8bf7\u8d2d\u4e70\u6b21\u6570\u540e\u518d\u6b21\u5237\u65b0"):o.default.instance.Refresh()},t.prototype.BuyRefreshTimes=function(){var e=this.shopConf.shopchipconf[1].diamond[o.default.instance.buyFreshTimes],t=o.default.instance;R.default.instance.ShowTips(d.default.getStr("buyRefrshTimes",e,t.buyFreshTimes,t.maxBuyCount),function(){S.default.PurchaseItemOrRechage(I.RechargeTypeConst.Diamonds,e,function(){o.default.instance.BuyRefreshTimes()})})},t.prototype.openVipUPTips=function(){D.default.instance.openVipUPtips()},t.instance=null,__decorate([L(v.default)],t.prototype,"TabBtnList2",void 0),__decorate([L(cc.SpriteAtlas)],t.prototype,"TabIcon",void 0),__decorate([L(cc.Node)],t.prototype,"TopUpNode",void 0),__decorate([L(cc.Node)],t.prototype,"OtherShop",void 0),__decorate([L(cc.Node)],t.prototype,"labelNode",void 0),__decorate([L(cc.Node)],t.prototype,"Node1",void 0),__decorate([L(cc.Node)],t.prototype,"Node2",void 0),__decorate([L(cc.Label)],t.prototype,"Text1",void 0),__decorate([L(cc.Label)],t.prototype,"Text2",void 0),__decorate([L(cc.Label)],t.prototype,"Text3",void 0),__decorate([L(cc.Label)],t.prototype,"Text4",void 0),__decorate([L(cc.Label)],t.prototype,"Text5",void 0),__decorate([L(cc.Label)],t.prototype,"Text6",void 0),__decorate([L(cc.Sprite)],t.prototype,"icon",void 0),__decorate([L(cc.Label)],t.prototype,"goldLabel",void 0),__decorate([L(cc.SpriteAtlas)],t.prototype,"Images",void 0),__decorate([L(b.default)],t.prototype,"itemList",void 0),__decorate([L(cc.Node)],t.prototype,"SoulCard",void 0),t=i=__decorate([N],t)}(n.default);i.default=E,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/TimeController":"TimeController","../../Core/Window":"Window","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../NetConnect/NetConnet":"NetConnet","../../Util/NumberUtil":"NumberUtil","../../Util/RechargeConst":"RechargeConst","../../Util/RechargeUtils":"RechargeUtils","../Arena/ArenaWindow":"ArenaWindow","../Commons/ListViewCtrl":"ListViewCtrl","../Commons/TabBtnSubList":"TabBtnSubList","../Functionicon/FunctionIconController":"FunctionIconController","../Gamelayer/GameLayer":"GameLayer","../OpenWin/OpenWinController":"OpenWinController","../Status/StatusType":"StatusType","../Tips/OpTipsController":"OpTipsController","../Tips/TipsWinController":"TipsWinController","../Vip/VipCtrl":"VipCtrl","./ShopConst":"ShopConst","./ShopController":"ShopController"}],SimpleActionEffect:[function(e,t,i){"use strict";cc._RF.push(t,"868f8JxhW5GI4NVeQ2lU9Jy","SimpleActionEffect"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./EffectBase"),o=e("../Util/StringUtil"),a=e("./ConfigsManager"),r=cc._decorator,s=r.ccclass,l=r.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.effectId=0,t.actionkey="",t.loop=!1,t.fps=0,t.saurl="anim/effect/{0}/{1}_{2}",t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this),this.fps>0&&(this.frametime=this.fps),this.effectId>0&&this.actionkey&&""!=this.actionkey&&this.playById(this.effectId,this.actionkey,this.loop)},t.prototype.playById=function(t,i,n,r,s,l){void 0===n&&(n=!1),void 0===r&&(r=null),void 0===s&&(s=null),void 0===l&&(l=null),e.prototype.clear.call(this),this.conf=a.ConfigsManager.instance.getConfigs("animationconf").animations[t];var c=[];e.prototype.loop=n;for(var d=1;d<=this.conf.spriteatlass;d++){var p=o.default.substitute(this.saurl,[t,t,d]);c.push(p)}e.prototype.playByUrlAndKey.call(this,c,i),e.prototype.setPlayRate.call(this,this.conf.frame),r&&(this.completeCallback=r,this.completeCallbackThisObj=s,this.completeCallbackParam=l)},__decorate([l(cc.Integer)],t.prototype,"effectId",void 0),__decorate([l(cc.String)],t.prototype,"actionkey",void 0),__decorate([l(cc.Boolean)],t.prototype,"loop",void 0),__decorate([l(cc.Integer)],t.prototype,"fps",void 0),t=__decorate([s],t)}(n.default);i.default=c,cc._RF.pop()},{"../Util/StringUtil":"StringUtil","./ConfigsManager":"ConfigsManager","./EffectBase":"EffectBase"}],SingleRechargeRebateCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"0357ab4Al9MfIp3te5BGAHb","SingleRechargeRebateCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Controller"),o=e("./SingleRechargeRebateData"),a=e("../../../Core/Event"),r=e("../../../NetConnect/NetConnet"),s=e("../../Tips/RewardTips"),l=e("../../Commons/RewardUtils"),c=e("../../../Core/WindowType"),d=e("../../OpenWin/OpenWinController"),p=e("../../../Core/GameEventDispatcher"),h=e("../ActivityCtrl"),u=e("../../Functionicon/FunctionIconController"),f=cc._decorator,g=f.ccclass,y=(f.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._data=null,t}var i;return __extends(t,e),i=t,Object.defineProperty(t.prototype,"data",{get:function(){return this._data||(this._data=new o.default),this._data},enumerable:!0,configurable:!0}),t.prototype.listNotification=function(){i.instance=this,this.addProto(a.EventDefiner.SingleRechargeRebate_Info,this.resRechargeRebateInfo,this),this.addProto(a.EventDefiner.SingleRechargeRebate_rechargerebate,this.resRechargeRebateReward,this),p.GameEventDispatcher.instance.on(a.EventDefiner.Activity_YunyingUP,this.reqInfo,this)},t.prototype.reqInfo=function(){var e=h.default.instance.data.getYunyingId(c.WindowType.SingleRechargeRebate);this.reqRechargeRebateInfo(e)},t.prototype.reqRechargeRebateInfo=function(e){var t={cmd:"rechargerebateinfo",actid:e};r.default.instance.sendProto(t)},t.prototype.resRechargeRebateInfo=function(e){this.data.setData(e.data),this.setRedPoit(),p.GameEventDispatcher.instance.emit(a.EventDefiner.SingleRechargeRebate_InfoUp)},t.prototype.reqRechargeRebateReward=function(e,t){var i={cmd:"rechargerebate",actid:e,index:t};r.default.instance.sendProto(i)},t.prototype.resRechargeRebateReward=function(e){d.default.instance.openWindow(c.WindowType.RewardTips,function(){s.default.instance.setData(l.default.instance.getItemListByServerData(e.reward))})},t.prototype.setRedPoit=function(){var e=h.default.instance.data.getActivityState(c.WindowType.SingleRechargeRebate),t=this.data.getRedPoitFlag();u.default.instance.FuncIconRedDeal(c.WindowType.SingleRechargeRebate,e&&t),u.default.instance.FuncIconHideDeal(c.WindowType.SingleRechargeRebate,this.data.getIconHideFlag())},t.instance=null,t=i=__decorate([g],t)}(n.default));i.default=y,cc._RF.pop()},{"../../../Core/Controller":"Controller","../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/WindowType":"WindowType","../../../NetConnect/NetConnet":"NetConnet","../../Commons/RewardUtils":"RewardUtils","../../Functionicon/FunctionIconController":"FunctionIconController","../../OpenWin/OpenWinController":"OpenWinController","../../Tips/RewardTips":"RewardTips","../ActivityCtrl":"ActivityCtrl","./SingleRechargeRebateData":"SingleRechargeRebateData"}],SingleRechargeRebateData:[function(e,t,i){"use strict";cc._RF.push(t,"08b55p4yTRA5pukED4Q91fr","SingleRechargeRebateData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/ConfigsManager"),o=function(){function e(){this._cfg=null,this._state={},this._gold=0}return e.prototype.setData=function(e){this._state=e.state,this._gold=e.value},Object.defineProperty(e.prototype,"cfg",{get:function(){return this._cfg||(this._cfg=n.ConfigsManager.instance.getConfigs("RechargeRebateConf")),this._cfg},enumerable:!0,configurable:!0}),e.prototype.getRewardCfgData=function(){var e=[],t=this.cfg.recharge[1];for(var i in t)e.push({index:parseInt(i),status:0,cfg:t[i]});return this.srot(e)},e.prototype.srot=function(e){var t=[],i=[],n=[];for(var o in e){var a=this.getReceivStatus(e[o].index);switch(e[o].status=a,a){case 0:i.push(e[o]);break;case 1:t.push(e[o]);break;case 2:n.push(e[o])}}return t.concat(i,n)},Object.defineProperty(e.prototype,"gold",{get:function(){return this._gold},enumerable:!0,configurable:!0}),e.prototype.getReceivStatus=function(e){return this._state[e]?this._state[e]:0},e.prototype.getRedPoitFlag=function(){for(var e in this._state)if(1==this._state[e])return!0;return!1},e.prototype.getIconHideFlag=function(){for(var e in this._state)if(2!=this._state[e])return!1;return!(Object.keys(this._state).length<=0||Object.keys(this._state).length<this.cfg.recharge[1].length)},e}();i.default=o,cc._RF.pop()},{"../../../Core/ConfigsManager":"ConfigsManager"}],SingleRechargeRebateItem:[function(e,t,i){"use strict";cc._RF.push(t,"da745jFMAlMEKWue/D4yqST","SingleRechargeRebateItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Core/Language"),a=e("../../Commons/RewardUtils"),r=e("../../../Util/Utils"),s=e("../../../GlobalContext"),l=e("../../../Core/LoadManager"),c=e("../../Item/ItemIcon"),d=e("./SingleRechargeRebateCtrl"),p=e("../ActivityCtrl"),h=e("../../../Core/WindowType"),u=e("../../BaiBeiFanLi/BaiBeiFanLiCtrl"),f=e("../../BaiBeiFanLi/BaiBeiFanLiConst"),g=e("../../Commons/WindowOpenUtils"),y=e("../../Shop/ShopConst"),m=e("../GroupPurchase/GroupPurchaseContrl"),C=e("../../../Util/NumberUtil"),v=cc._decorator,_=v.ccclass,b=(v.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._data=null,t}return __extends(t,e),t.prototype.setData=function(e){this._data=e,this.setOther(e),this.setItem(e.cfg.rwId)},t.prototype.setOther=function(e){this.node.getChildByName("titleNode").getChildByName("Label").getComponent(cc.Label).string=e.cfg.title,this.node.getChildByName("RichText").getComponent(cc.RichText).string=e.cfg.desc;var t=d.default.instance.data.gold,i=e.cfg.value<=t?o.default.getStr("SingleRechargeRebate_01"):o.default.getStr("SingleRechargeRebate_02",e.cfg.value-t);this.node.getChildByName("gold").getChildByName("RichText").getComponent(cc.RichText).string=i,this.node.getChildByName("btn_Receive").active=2!=e.status&&e.cfg.value<=t,this.node.getChildByName("btn_Jump").active=2!=e.status&&e.cfg.value>t,this.node.getChildByName("img").active=2==e.status},t.prototype.setItem=function(e){var t=a.default.instance.getItemList(e),i=this.node.getChildByName("itemNode");r.default.setNodeChildDestoryByUrl(i,s.GlobalContext.Root+"prefab/Bag/ItemIcon"),l.default.instance.loadResByType(s.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(e){for(var n in t){var o=r.default.getNodeByUrl(e,s.GlobalContext.Root+"prefab/Bag/ItemIcon");o.scale=.6*o.scale,o.getComponent(c.default).ItemData(t[n],!1,C.NumberUtil.getNumber(t[n].count),!0),i.addChild(o)}},this)},t.prototype.onClickBtn=function(e,t){if(parseInt(t)){var i=null,n=0;u.default.instance.status!=f.BaiBeiFanLiReceiveState.ButAlreadyReceive?i=h.WindowType.BaiBeiFanLi:p.default.instance.data.getYunyingData(h.WindowType.OneSeckill)&&m.default.instance.IsGet()?i=h.WindowType.OneSeckill:(i=h.WindowType.Shop,n=y.ShopConst.Recharge),g.default.instance.openWindowType(i,n)}else if(this._data&&1==this._data.status){var o=p.default.instance.data.getYunyingId(h.WindowType.SingleRechargeRebate);d.default.instance.reqRechargeRebateReward(o,this._data.index)}},t=__decorate([_],t)}(n.default));i.default=b,cc._RF.pop()},{"../../../Core/Language":"Language","../../../Core/LoadManager":"LoadManager","../../../Core/Widget":"Widget","../../../Core/WindowType":"WindowType","../../../GlobalContext":"GlobalContext","../../../Util/NumberUtil":"NumberUtil","../../../Util/Utils":"Utils","../../BaiBeiFanLi/BaiBeiFanLiConst":"BaiBeiFanLiConst","../../BaiBeiFanLi/BaiBeiFanLiCtrl":"BaiBeiFanLiCtrl","../../Commons/RewardUtils":"RewardUtils","../../Commons/WindowOpenUtils":"WindowOpenUtils","../../Item/ItemIcon":"ItemIcon","../../Shop/ShopConst":"ShopConst","../ActivityCtrl":"ActivityCtrl","../GroupPurchase/GroupPurchaseContrl":"GroupPurchaseContrl","./SingleRechargeRebateCtrl":"SingleRechargeRebateCtrl"}],SingleRechargeRebateView:[function(e,t,i){"use strict";cc._RF.push(t,"8477bpXdENE8qva4zbcFoWN","SingleRechargeRebateView"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Window"),o=e("../../Commons/ListViewCtrl"),a=e("./SingleRechargeRebateCtrl"),r=e("./SingleRechargeRebateItem"),s=e("../../../Core/WindowType"),l=e("../../../Core/GameEventDispatcher"),c=e("../../../Core/Event"),d=e("../ActivityCtrl"),p=e("../../Vip/VipCtrl"),h=cc._decorator,u=h.ccclass,f=(h.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._list=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this._list=this.node.getChildByName("ListViewCtrl").getComponent(o.default)},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.show=function(){e.prototype.show.call(this);var t=d.default.instance.data.getYunyingId(s.WindowType.SingleRechargeRebate);a.default.instance.reqRechargeRebateInfo(t),l.GameEventDispatcher.instance.on(c.EventDefiner.SingleRechargeRebate_InfoUp,this.setData,this)},t.prototype.close=function(){e.prototype.close.call(this),p.default.instance.openVipUPtips()},t.prototype.setData=function(){var e=a.default.instance.data.getRewardCfgData();this._list.refreshItem=this.updateitem,this._list.refreshItemThis=this,this._list.initialize(e),this._list.scrollToLeft()},t.prototype.updateitem=function(e,t){var i=this._list.dataLsit[t];e.getComponent(r.default).setData(i)},t=__decorate([u],t)}(n.default));i.default=f,cc._RF.pop()},{"../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Window":"Window","../../../Core/WindowType":"WindowType","../../Commons/ListViewCtrl":"ListViewCtrl","../../Vip/VipCtrl":"VipCtrl","../ActivityCtrl":"ActivityCtrl","./SingleRechargeRebateCtrl":"SingleRechargeRebateCtrl","./SingleRechargeRebateItem":"SingleRechargeRebateItem"}],SkillController:[function(e,t,i){"use strict";cc._RF.push(t,"f2957Ppua9CN5+80CcL8GYh","SkillController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Controller"),o=e("../../WarTeam/MonsterController"),a=e("../../../Core/ConfigsManager"),r=e("../../../Core/Const/EntityType"),s=e("../../Role/RoleController"),l=e("../Unit/FightLog"),c=e("../../../Core/Language"),d=e("../../Role/RoleInfo"),p=cc._decorator,h=p.ccclass,u=(p.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.skillConfigs=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.skillConfigs=a.ConfigsManager.instance.getConfigs("skillconf"),i.instance=this},t.prototype.start=function(){},t.prototype.getSkillBySkillId=function(e){return void 0==this.skillConfigs.skillconf[e]?(l.default.log("\u6280\u80fd\u8868\u9519\u8bef\uff1a"+e),null):this.skillConfigs.skillconf[e]},t.prototype.getSkillBySkillIdAndLv=function(e,t){var i=this.getSkillBySkillId(e),n=this.skillConfigs.levelConf[i.levelConf];if(void 0==n||n.length<=0)return l.default.log("\u6280\u80fd\u8868\u7b49\u7ea7\u9519\u8bef1\uff1a"+i.levelConf),null;var o=n[t-1];return o||(l.default.log("\u6280\u80fd\u8868\u7b49\u7ea7\u9519\u8bef2\uff1a"+e,t),null)},t.prototype.getSkillUnlockFlag=function(e,t){var i=this.getSkillBySkillId(e),n=this.skillConfigs.levelConf[i.levelConf];if(void 0==n||n.length<=0)return l.default.log("\u6280\u80fd\u8868\u7b49\u7ea7\u9519\u8bef1\uff1a"+i.levelConf),null;var o=n[0];return o?o.unlockStage<=t:(l.default.log("\u6280\u80fd\u8868\u7b49\u7ea7\u9519\u8bef2\uff1a"+e,0),null)},t.prototype.getSkillDescBySkillIdAndLv=function(e,t){var i="",n=this.getSkillBySkillIdAndLv(e,t),o=this.getSkillBySkillIdAndLv(e,1);if(o.descType&&this.skillConfigs.skillDesc[o.descType])if(n.parameter){for(var a=n.parameter.concat(),r=0;r<a.length;r++)a[r]&&(a[r]=a[r]/100);i=c.default.getStr1(this.skillConfigs.skillDesc[o.descType].desc,a)}else i=this.skillConfigs.skillDesc[o.descType].desc;return i},t.prototype.getSkillResultBySkillIdAndLv=function(e,t){if(void 0==this.getSkillBySkillIdAndLv(e,t))return l.default.log("\u6280\u80fd\u7ed3\u679c\u8868\u9519\u8bef\uff1a"+e,t),null;var i=this.skillConfigs.result[e];return void 0==i?(l.default.log("\u6280\u80fd\u7ed3\u679c\u8868\u9519\u8bef\uff1a"+e,t),null):i},t.prototype.getSkills=function(e,t,i,n){void 0===i&&(i=!0),void 0===n&&(n=!0);var a=[];if(e.type==r.EntityType.enMonster){var s=e.cardid,l=e.grade;e.cultivateLv;if(a=a.concat(this.getNormalSkillList(s,l)),e.selfMonster&&n){var c=o.MonsterType.MonsterCardArr[e.cardid];if(c&&c.skill.length)for(var p=0,h=c.skill;p<h.length;p++){var u=h[p];if(u.level>0){var f={skillid:u.id,skilllv:u.level};a.push(f)}else console.warn("\u6280\u80fd\u7b49\u7ea7\u9519\u8bef \u6280\u80fd\u7b49\u7ea7\u4e3a0",u.id)}}else t&&(a=a.concat(this.getSmallSkillList(s,l,t)));i&&(a=a.concat(this.getBigSkillList(s,l)))}else a=a.concat(this.getRoleNormalSkillList(e.spineId)),e.selfMonster&&(a=a.concat(d.MyRoleInfo.attr.skills));return a},t.prototype.getRoleNormalSkillList=function(e){var t=[],i={skillid:s.default.instance.getModelConfByModelId(e).normalskillids,skilllv:1};return t.push(i),t},t.prototype.getNormalSkillList=function(e,t){var i=[],n=o.default.instance.getCardGradeByGradeConf(e,t).normalskillids;n||console.log("\u83b7\u53d6\u4e0d\u5230\u666e\u653b\u6280\u80fd",e,t);for(var a=0;a<n.length;a++){var r={skillid:n[a],skilllv:1};i.push(r)}return i},t.prototype.getBigSkillList=function(e,t){var i=[];if(o.default.instance.getCardGradeByGradeConf(e,t).bigSkill){var n={skillid:o.default.instance.getCardGradeByGradeConf(e,t).bigSkill,skilllv:t=1};i.push(n)}return i},t.prototype.getSmallSkillList=function(e,t,n){void 0===n&&(n=1);for(var a=[],r=o.default.instance.GetMonsterInfo(e),s=0;s<r.skillId.length;s++){var l=i.instance.getSkillBySkillId(r.skillId[s]).maxSkillLevel,c={skillid:r.skillId[s],skilllv:Math.min(n,l)};a.push(c)}return a},t.prototype.GetResultConfParam=function(e,t,i){for(var n=[],o=0;o<e.length;o++){var a=e[o];switch(a.type){case 1:n.push(a.value1);break;case 2:n.push(a.value1/1e4);break;case 3:n.push(t*(a.value1/1e4)+a.value2/1e4);break;case 4:n.push(a.value1);break;case 5:n.push((a.value1*Math.floor((t+1)/2)+a.value2)/1e4);break;case 6:n.push((a.value1*Math.floor(t/2)+a.value2)/1e4)}}return n},t.instance=null,t=i=__decorate([h],t)}(n.default));i.default=u,cc._RF.pop()},{"../../../Core/ConfigsManager":"ConfigsManager","../../../Core/Const/EntityType":"EntityType","../../../Core/Controller":"Controller","../../../Core/Language":"Language","../../Role/RoleController":"RoleController","../../Role/RoleInfo":"RoleInfo","../../WarTeam/MonsterController":"MonsterController","../Unit/FightLog":"FightLog"}],SkillInfo:[function(e,t,i){"use strict";cc._RF.push(t,"1aba0fwjPBEEpkc+qntrABP","SkillInfo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){return function(){}}();i.SkillInfo=n,cc._RF.pop()},{}],SmallWindowZoom:[function(e,t,i){"use strict";cc._RF.push(t,"a926eujvNtABJ/W/FAQphzx","SmallWindowZoom"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../GlobalContext"),a=e("../../Commons/WindowBg2"),r=cc._decorator,s=r.ccclass,l=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.btnPos=null,t}return __extends(t,e),t.prototype.show=function(){var t=this;e.prototype.show.call(this),this.node.stopAllActions(),cc.find("CloseBtn1",this.node)&&(this.btnPos||(this.btnPos=cc.find("CloseBtn1",this.node).position),cc.find("CloseBtn1",this.node).stopAllActions(),cc.find("CloseBtn1",this.node).rotation=90,cc.find("CloseBtn1",this.node).y=o.GlobalContext.UIHeight/2+cc.find("CloseBtn1",this.node).height/2,cc.find("CloseBtn1",this.node).active=!1),this.node.getComponent(a.default).Container&&(this.node.getComponent(a.default).Container.scale=.1,this.node.getComponent(a.default).Container.runAction(cc.sequence(cc.scaleTo(.3,1.1),cc.scaleTo(.1,1)))),this.node.scale=.1,this.node.runAction(cc.sequence(cc.scaleTo(.3,1.1),cc.scaleTo(.1,1),cc.callFunc(function(){t.node.scale=1,cc.find("CloseBtn1",t.node)&&(cc.find("CloseBtn1",t.node).stopAllActions(),cc.find("CloseBtn1",t.node).active=!0,cc.find("CloseBtn1",t.node).runAction(cc.sequence(cc.spawn(cc.moveTo(.2,t.btnPos.x,t.btnPos.y-20),cc.rotateTo(.2,0)),cc.moveTo(.1,t.btnPos.x,t.btnPos.y))))})))},t=__decorate([s],t)}(n.default));i.default=l,cc._RF.pop()},{"../../../Core/Widget":"Widget","../../../GlobalContext":"GlobalContext","../../Commons/WindowBg2":"WindowBg2"}],SoundController:[function(e,t,i){"use strict";cc._RF.push(t,"65aea2oJTBDII4PfarxAneY","SoundController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../Core/LoadManager"),a=e("../../Core/GameEventDispatcher"),r=e("../../Core/Event"),s=e("../../GlobalContext"),l=e("../setting/SettingData"),c=e("../setting/SettingData"),d=cc._decorator,p=d.ccclass,h=d.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.BGMSound=null,t.BGMClipList=[],t.EffectSoundList=[],t.cardEffect=null,t.CurrentBGMType=null,t.CurrentCardEffect=null,t.effectSoundNameList=[],t.qqmusic=[],t.music={},t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.start=function(){s.PlayerData.SoundPlaying=!0,this.Frontend()},t.prototype.onEnable=function(){a.GameEventDispatcher.instance.on(r.EventDefiner.SoundPlayingChange,this.SoundPlayingChange,this),this.BgmVolume(l.default.musicSize),this.EffectVolume(l.default.soundEffectSize),a.GameEventDispatcher.instance.on("MusicSize",this.BgmVolume,this),a.GameEventDispatcher.instance.on("SoundEffectSize",this.EffectVolume,this)},t.prototype.onDisable=function(){a.GameEventDispatcher.instance.off(r.EventDefiner.SoundPlayingChange,this.SoundPlayingChange,this),a.GameEventDispatcher.instance.off("MusicSize",this.BgmVolume,this),a.GameEventDispatcher.instance.off("SoundEffectSize",this.EffectVolume,this)},t.prototype.Frontend=function(){s.PlayerData.SoundPlaying=!0,this.PlayBGMFun(this.CurrentBGMType)},t.prototype.BackendEvent=function(){s.PlayerData.SoundPlaying=!1;var e=this.CurrentBGMType;this.StopBGM(),this.CurrentBGMType=e},t.prototype.SoundPlayingChange=function(){0==s.PlayerData.SoundPlaying?(this.BackendEvent(),this.StopEffect()):this.Frontend()},t.prototype.PlayBGM=function(e){l.default.currMusic=e,l.default.musicBgm&&e&&this.CurrentBGMType!=e&&(this.CurrentBGMType=e,this.PlayBGMFun(e))},t.prototype.playCardEffect=function(e){e&&c.default.soundEffect&&(this.CurrentCardEffect=e,o.default.instance.loadResByType(e,cc.AudioClip,this.loadCardEffectComplete,this,[e]))},t.prototype.stopCardEffect=function(){this.cardEffect.stop(),this.cardEffect.loop=!1,this.cardEffect.clip=null},t.prototype.LoadBGMComplete=function(e,t){this.CurrentBGMType==t&&(this.BGMSound.stop(),this.BGMSound.clip=null,this.BGMSound.clip=e,this.BGMSound.loop=!0,this.BGMSound.play())},t.prototype.loadCardEffectComplete=function(e,t){this.CurrentCardEffect==t&&(this.cardEffect.stop(),this.cardEffect.clip=null,this.cardEffect.clip=e,this.cardEffect.loop=!1,this.cardEffect.play())},t.prototype.getCardEffect=function(){return this.cardEffect.getDuration()},t.prototype.BgmVolume=function(e){this.BGMSound.volume=e.detail},t.prototype.EffectVolume=function(e){for(var t=0;t<this.EffectSoundList.length;t++)this.EffectSoundList[t].volume=e.detail},t.prototype.PlayBGMFun=function(e){e&&o.default.instance.loadResByType(e,cc.AudioClip,this.LoadBGMComplete,this,[e])},t.prototype.StopBGM=function(){this.BGMSound.stop(),this.BGMSound.loop=!1,this.BGMSound.clip=null,this.CurrentBGMType=null},t.prototype.PlayEffect=function(e){0!=s.PlayerData.SoundPlaying&&e&&l.default.soundEffect&&(cc.sys.platform!==cc.sys.WECHAT_GAME||"ios"!=qq.getSystemInfoSync().platform&&"devtools"!=qq.getSystemInfoSync().platform?o.default.instance.loadResByType(e,cc.AudioClip,this.LoadEffectComplete,this,[e]):this.LoadEffectComplete2(e))},t.prototype.StopEffect=function(){for(var e=null,t=0;t<this.EffectSoundList.length;t++)(e=this.EffectSoundList[t])&&0==e.isPlaying&&e.stop()},t.prototype.StopEffectByType=function(e){for(var t=null,i=0;i<this.EffectSoundList.length;i++)if((t=this.EffectSoundList[i])&&this.effectSoundNameList[i]&&this.effectSoundNameList[i].url==e)return console.log("\u6682\u505c\u97f3\u6548\uff1a"+e),void t.stop()},t.prototype.LoadEffectComplete=function(e,t){if(this.EffectSoundList){var i={url:t,time:Date.now()};if(-1!=f.threeList.indexOf(t))for(var n=0,o=[],a=0;a<this.EffectSoundList.length;a++)if(this.effectSoundNameList[a]&&this.effectSoundNameList[a].url==t){var r=this.EffectSoundList[a];if(r&&Number(r.getDuration())>(Date.now()-this.effectSoundNameList[a].time)/1e3&&(o.push(a),++n>=3))return void console.log(t+"\u97f3\u6548\u6700\u5927\u53ef\u540c\u65f6\u64ad\u653e\u97f3\u6548\u5927\u4e8e3\u4e2a \u4e0d\u64ad\u653e")}var s=null;for(a=0;a<this.EffectSoundList.length;a++){s=this.EffectSoundList[a];var l=!0;if(this.effectSoundNameList[a]&&Number(s.getDuration())>(Date.now()-this.effectSoundNameList[a].time)/1e3&&(l=!1),s&&l)return s.clip=null,this.effectSoundNameList[a]=i,s.clip=e,void s.play()}s=this.EffectSoundList[0],this.effectSoundNameList[0]=i,s.clip=null,s.clip=e,s.play()}},t.prototype.LoadEffectComplete2=function(e){if(this.qqmusic.length<=0)for(var t=0;t<this.EffectSoundList.length;t++){var i=qq.createInnerAudioContext(),n={url:e,time:Date.now()};this.effectSoundNameList[t]=n,this.qqmusic[t]=i}var o={url:e,time:Date.now()};if(-1!=f.threeList.indexOf(e)){var a=0,r=[];for(t=0;t<this.qqmusic.length;t++)if(this.effectSoundNameList[t]&&this.effectSoundNameList[t].url==e){var s=this.qqmusic[t];if(s&&Number(s.duration)>(Date.now()-this.effectSoundNameList[t].time)/1e3&&(r.push(t),++a>=3))return void console.log(e+"\u97f3\u6548\u6700\u5927\u53ef\u540c\u65f6\u64ad\u653e\u97f3\u6548\u5927\u4e8e3\u4e2a \u4e0d\u64ad\u653e")}}var l=null;for(t=0;t<this.qqmusic.length;t++){l=this.qqmusic[t];var c=!0;if(this.effectSoundNameList[t]&&Number(l.duration)>(Date.now()-this.effectSoundNameList[t].time)/1e3&&(c=!1),l&&c)return this.effectSoundNameList[t]=o,l.src=wxDownloader.REMOTE_SERVER_ROOT+this.getmd5resurl("resources/"+e+".mp3"),l.loop=!1,l.autoplay=!1,l.seek(0),void l.play()}l=this.qqmusic[0],this.effectSoundNameList[0]=o,l.src=wxDownloader.REMOTE_SERVER_ROOT+this.getmd5resurl("resources/"+e+".mp3"),l.loop=!1,l.autoplay=!1,l.seek(0),l.play()},t.prototype.getmd5resurl=function(e){var t=cc.url.raw(e);return cc.loader.md5Pipe&&(t=cc.loader.md5Pipe.transformURL(t)),t},t.instance=null,__decorate([h(cc.AudioSource)],t.prototype,"BGMSound",void 0),__decorate([h({type:cc.AudioClip})],t.prototype,"BGMClipList",void 0),__decorate([h([cc.AudioSource])],t.prototype,"EffectSoundList",void 0),__decorate([h(cc.AudioSource)],t.prototype,"cardEffect",void 0),t=i=__decorate([p],t)}(n.default);i.default=u;var f=function(){function e(){}return e.comclick="audio/UISound/comclick",e.rewardGet="audio/UISound/rewardGet",e.news="audio/UISound/news",e.upSucceeds="audio/UISound/upSucceeds",e.replaceSucceeds="audio/UISound/replaceSucceeds",e.checkerboardCompound="audio/UISound/checkerboardCompound",e.good="audio/UISound/good",e.sandtableWindowBG="audio/UIMusic/sandtableWindowBG",e.mainBG="audio/UIMusic/mainBG",e.fightWin="audio/UISound/fightWin",e.fightLose="audio/UISound/fightLose",e.bossComming="audio/UISound/bossComming",e.firstPlot="audio/UISound/firstPlot",e.fightstart="audio/UISound/fightstart",e.singleList=["audio/UISound/back"],e.threeList=[e.checkerboardCompound],e.cardTalk="audio/talkSound/",e.guidSound="audio/GuidSound/",e}();i.SoundType=f,cc._RF.pop()},{"../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/LoadManager":"LoadManager","../../GlobalContext":"GlobalContext","../setting/SettingData":"SettingData"}],SpecialEffectController:[function(e,t,i){"use strict";cc._RF.push(t,"871f5b+QqVGoaUXHN2hmYz5","SpecialEffectController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Pool/SpinePools"),o=e("../../../Core/SpineBase"),a=e("../View/ActorsBigSkillLayer"),r=function(){function e(){this.ins=null,this.effectnode=[],this.effectbg=null,this.effectnodeNum=0,this._handleDic={}}return Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.addSpecialEffect=function(e,t){if(void 0===t&&(t=!1),!this._handleDic[e.handle]){var i=-200*e.prop.dir,r=n.SpinePools.addSpineNoder(a.default.instance.node,cc.v2(e.prop.x+i,0)),s=r.getComponent(o.default),l="skin"+e.prop.grade+"_fight2_b";s.initSpineData(e.prop.getAttackEffectUrl(),null,l,!0);var c={source:e,node:r,follow:t};this._handleDic[e.prop.handle]=c}},e.prototype.moving=function(){for(var e in this._handleDic){var t=this._handleDic[e];t&&t.follow&&(t.node.x=t.source.prop.x)}},e.prototype.clearByHandle=function(e){this._handleDic[e]&&(n.SpinePools.recoverSpineNoder(this._handleDic[e].node),delete this._handleDic[e])},e.prototype.removeAll=function(){for(var e in this._handleDic)this.clearByHandle(parseInt(e))},e._instance=null,e}();i.default=r,cc._RF.pop()},{"../../../Core/SpineBase":"SpineBase","../Pool/SpinePools":"SpinePools","../View/ActorsBigSkillLayer":"ActorsBigSkillLayer"}],SpecialSkillEffectController:[function(e,t,i){"use strict";cc._RF.push(t,"526ac5NL+BLaZmU+qCdeXXs","SpecialSkillEffectController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../View/ActorsLayer"),o=e("../Controller/FightController"),a=e("../Manager/SceneManager"),r=e("../../../Global/GlobalValue"),s=e("../View/FightView"),l=e("../Pool/SpinePools"),c=e("../../../Core/SpineBase"),d=e("../Effect/FntSwingUtils"),p=e("./SkillController"),h=e("../Unit/FightLog"),u=e("../Unit/FightConst"),f=e("../../../Util/Scene/MoveUtil"),g=e("../BigSkill/BigSkill22Controller"),y=e("../../../Core/TimeController"),m=e("../BigSkill/BigSkill18Controller"),C=e("../View/ActorsBigSkillLayer"),v=e("../../../GlobalContext"),_=e("../../../Util/Shake"),b=e("../../Sound/SoundController"),T=e("../BigSkill/BigSkillArfController"),S=e("../BigSkill/BigSkillArf2Controller"),I=e("../BigSkill/BigSkillArf3Controller"),w=e("../BigSkill/BigSkillArf4Controller"),D=e("../BigSkill/BigSkillArf5Controller"),R=e("../../../Core/GameEventDispatcher"),A=e("../../../Core/Event"),N=cc._decorator,L=N.ccclass,E=(N.property,function(){function e(){this.specialskillhitentitys=[],this.specialskillattackentitys=[],this.attacktarge=[],this.skill=0,this.skilllv=0,this.specialskillstep=0,this.spskillcom=!0,this.spskilleffectcom=!0,this.spineNode=null,this.othereffect=!0,this.updatelist=[],this.fightspcialstep=0,this.checkskillcom=0,this.skillbgeffect=null,this.skillnameeffect=null,this.otereffect=[],this.skillconf={},this.bigskillcanhit=!0,this.shake=null,this.specialrate=1}var t;return t=e,Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),e.prototype.setSkillbgeffect=function(){if(this.skillconf=p.default.instance.getSkillBySkillId(this.skill),this.skillconf.skillBgEffect){this.skillbgeffect=l.SpinePools.addSpineNoder(o.default.instance.ActorsMaskLayer.node,new cc.Vec2(0,0)),this.skillbgeffect.setSiblingIndex(0);var e=this.skillbgeffect.getComponent(c.default);e.playRate=this.specialrate,this.skillbgeffect.scaleX=this.specialskillattackentitys[0].prop.dir,e.initSpineData(r.SPINE_RES_DIR+"fightskillbg/fight_bg",null,"fight_bg"+this.skillconf.skillBgEffect,!0)}},e.prototype.setSkillnameeffect=function(){this.skillconf=p.default.instance.getSkillBySkillId(this.skill);var e=300;16==this.specialskillattackentitys[0].prop.cardid&&(e=500),this.skillnameeffect=l.SpinePools.addSpineNoder(o.default.instance.ActorsMaskLayer.node,new cc.Vec2((e-v.GlobalContext.UIWidth/2)*this.specialskillattackentitys[0].prop.dir,0));var t=this.skillnameeffect.getComponent(c.default);t.playRate=this.specialrate,t.initSpineData(r.SPINE_RES_DIR+"fightskillname/text",null,this.specialskillattackentitys[0].prop.cardid,!1)},e.prototype.showSpecialEffect=function(e,t,i,n,s){R.GameEventDispatcher.instance.emit(A.EventDefiner.C_Fight_StopTask),a.default.instance.specialskillid=t,this.spskillcom=!0,this.skill=t,this.skilllv=i,this.specialskillattackentitys=e,this.specialskillhitentitys=n,this.attacktarge=n.concat(),a.default.instance.specialskillcount=s,this.bigskillcanhit=!1,h.default.log("\u5927\u62db\u53d7\u51fb \uff1a "+s),this.addRangeEnemy();var l=p.default.instance.getSkillBySkillId(t);switch(this.setSkillbgeffect(),this.updatelist=[],T.default.instance.clear(),this.showMask(),a.default.instance.specialskillstatus){case r.SPECIAL_SKILL_STATUS.SPECIAL_SKILL_STATUS4:this.othereffect=!1,g.default.instance.showSpecialEffect(),l.actionMusic&&b.default.instance.PlayEffect("audio/BattleSound/"+l.actionMusic);break;case r.SPECIAL_SKILL_STATUS.SPECIAL_SKILL_STATUS6:m.default.instance.showSpecialEffect(),l.actionMusic&&b.default.instance.PlayEffect("audio/BattleSound/"+l.actionMusic);break;case r.SPECIAL_SKILL_STATUS.SPECIAL_SKILL_STATUS8:T.default.instance.showSpecialEffect(),l.actionMusic&&b.default.instance.PlayEffect("audio/BattleSound/"+l.actionMusic);break;case r.SPECIAL_SKILL_STATUS.SPECIAL_SKILL_STATUS9:S.default.instance.showSpecialEffect(),l.actionMusic&&b.default.instance.PlayEffect("audio/BattleSound/"+l.actionMusic);break;case r.SPECIAL_SKILL_STATUS.SPECIAL_SKILL_STATUS10:I.default.instance.showSpecialEffect(),l.actionMusic&&b.default.instance.PlayEffect("audio/BattleSound/"+l.actionMusic);break;case r.SPECIAL_SKILL_STATUS.SPECIAL_SKILL_STATUS11:w.default.instance.showSpecialEffect(),l.actionMusic&&b.default.instance.PlayEffect("audio/BattleSound/"+l.actionMusic);break;case r.SPECIAL_SKILL_STATUS.SPECIAL_SKILL_STATUS12:D.default.instance.showSpecialEffect(),l.actionMusic&&b.default.instance.PlayEffect("audio/BattleSound/"+l.actionMusic)}this.setSkillnameeffect(),o.default.instance.ActorsMaskLayer.node.opacity=255},e.prototype.addRangeEnemy=function(){var e=this,t=function(t,i,n){void 0===n&&(n=!0);for(var o=0,a=e.attacktarge;o<a.length;o++)for(var r=a[o],s=function(t){e.specialskillhitentitys.find(function(e){return t.prop.handle==e.handle})||(h.default.log("\u8303\u56f4\u653b\u51fb\u6dfb\u52a0\u53d7\u51fb\u8303\u56f4\u602a\u7269"+t.prop.handle+e.specialskillhitentitys.length),e.specialskillhitentitys.push(t))},l=0,c=e.GetRangeEnemy(r,t,i,!0,n);l<c.length;l++){s(c[l])}},i=p.default.instance.getSkillResultBySkillIdAndLv(this.skill,this.skilllv)[0];if(i.type==u.SKILL_WAY_TYPE.AttackRange){var n,o=!0;(n=p.default.instance.GetResultConfParam(i.param,this.skilllv))[4]&&(o=1==n[4]),t(n[1],n[2],o)}i.type==u.SKILL_WAY_TYPE.Impact&&t((n=p.default.instance.GetResultConfParam(i.param,this.skilllv))[2],n[3])},e.prototype.showMask=function(){var e=this;switch(o.default.instance.ActorsMaskLayer.node.opacity=255,a.default.instance.specialskillstatus){case r.SPECIAL_SKILL_STATUS.COMBO:case r.SPECIAL_SKILL_STATUS.SPECIAL_SKILL_STATUS2:this.fightspcialstep=y.default.instance.setTimeout(this.useSkill,this,200);break;case r.SPECIAL_SKILL_STATUS.SPECIAL_SKILL_STATUS1:this.showSpecialEffect3();break;case r.SPECIAL_SKILL_STATUS.SPECIAL_SKILL_STATUS3:this.showSpecialEffect3(!1),this.fightspcialstep=y.default.instance.setTimeout(this.useSkill,this,100);break;case r.SPECIAL_SKILL_STATUS.SPECIAL_SKILL_STATUS7:this.showSpecialEffect3();break;case r.SPECIAL_SKILL_STATUS.SPECIAL_SKILL_STATUS5:this.fightspcialstep=y.default.instance.setTimeout(this.useSkill,this,200);var t=y.default.instance.setTimeout(function(){e.allcom(),y.default.instance.clearTimeout(t)},this,1400)}this.showMaskHlight(a.default.instance.effectShowType),s.default.instance.SetFightViewPlayRate(this.specialrate)},e.prototype.showMaskHlight=function(e){switch(e){case 0:this.updatelist=this.specialskillhitentitys.concat(this.specialskillattackentitys),this.maskHighlight(this.specialskillhitentitys),this.maskHighlight(this.specialskillattackentitys,!0);break;case 1:this.updatelist=this.specialskillattackentitys,this.maskHighlight(this.specialskillattackentitys);break;case 2:this.updatelist=this.specialskillhitentitys,this.maskHighlight(this.specialskillhitentitys)}},e.prototype.GetRangeEnemy=function(e,t,i,o,r){void 0===i&&(i=5e3),void 0===o&&(o=!0),void 0===r&&(r=!0);var s=[],l=[],c=n.default.instance.getSceneEntity(e.handle).prop.x,d=n.default.instance.getSceneEntity(e.handle).prop.y;s=r?e.prop.selfMonster?a.default.instance.leftentitys:a.default.instance.rightentitys:e.prop.selfMonster?a.default.instance.rightentitys:a.default.instance.leftentitys;for(var p=0;p<s.length;p++){var h=s[p];if(h.isLive&&e.handle!=h.handle){var u=n.default.instance.getSceneEntity(h.handle).prop.x,g=n.default.instance.getSceneEntity(h.handle).prop.y;f.MoveUtil.getPixelDis(c,d,u,g)<=t&&l.push(h)}}return l.sort(this.sortPixelDisCompare(c,d,o)),l.slice(0,i)},e.prototype.sortPixelDisCompare=function(e,t,i){return void 0===i&&(i=!0),function(n,o){var a=n.prop.x,r=n.prop.y,s=o.prop.x,l=o.prop.y,c=f.MoveUtil.getPixelDis(e,t,a,r),d=f.MoveUtil.getPixelDis(e,t,s,l);return i?c-d:d-c}},e.prototype.showSpecialEffect1=function(){var e=this;this.spineNode=l.SpinePools.addSpineNoder(o.default.instance.ActorsMaskLayer.node,new cc.Vec2(0,0)),this.spineNode.scaleX=this.specialskillattackentitys[0].prop.dir;var t=this.spineNode.getComponent(c.default);this.spskillcom=!1,t.playRate=this.specialrate,t.initSpineData(r.SPINE_RES_DIR+"monster/"+this.specialskillattackentitys[0].prop.spineId+"/"+this.skillconf.effectTypeName,r.DEFAULTS_SKIN+this.specialskillattackentitys[0].prop.grade,"fight2",!1),t.completeCallbackThisObj=this,t.completeCallbackParam=[this.spineNode],t.completeCallback=function(t){l.SpinePools.recoverSpineNoder(t),e.spineNode=null,a.default.instance.specialskillstatus=r.SPECIAL_SKILL_STATUS.NONE,a.default.instance.specialskillcount=0,e.specialskillhitentitys=[],e.spskillcom=!0,e.checkComplete(e.specialskillattackentitys[0])}},e.prototype.showSpecialEffect3=function(e){var t=this;void 0===e&&(e=!0),this.spineNode=l.SpinePools.addSpineNoder(o.default.instance.ActorsMaskLayer.node,new cc.Vec2(0,0)),this.spineNode.scaleX=this.specialskillattackentitys[0].prop.dir;var i=this.spineNode.getComponent(c.default),n=p.default.instance.getSkillBySkillId(this.skill);n.actionMusic&&2==n.effectType&&b.default.instance.PlayEffect("audio/BattleSound/"+n.actionMusic),this.spskillcom=!1,i.playRate=this.specialrate,e&&i.setAnimEventCall("skill",this.skillResult,this,null),i.completeCallbackThisObj=this,i.completeCallbackParam=[this.spineNode],i.completeCallback=function(e){t.spskillcom=!0,l.SpinePools.recoverSpineNoder(e),t.spineNode=null,t.complete()},i.initSpineData(r.SPINE_RES_DIR+"monster/"+this.specialskillattackentitys[0].prop.spineId+"/"+this.skillconf.effectTypeName,r.DEFAULTS_SKIN+this.specialskillattackentitys[0].prop.grade,"fight2",!1)},e.prototype.shakeView=function(){var e=this;this.skillconf&&this.skillconf.shake&&(this.shake=null,this.shake=_.Shake.create(1,0,10),this.shake.startWithTarget(s.default.instance.node),s.default.instance.node.runAction(cc.sequence(this.shake,cc.callFunc(function(){e.stopShake()}))))},e.prototype.stopShake=function(){this.shake&&(this.shake.stop(),this.shake=null)},e.prototype.useSkill1=function(){this.shakeView();for(var e=0,t=this.specialskillattackentitys;e<t.length;e++){var i=t[e];i.setTarget(this.attacktarge),i.useSkill(this.skill,this.skilllv)}},e.prototype.useSkill=function(){y.default.instance.clearTimeout(this.fightspcialstep),this.useSkill1()},e.prototype.skillResult=function(){var e=this,t=p.default.instance.getSkillBySkillId(this.skill);t.skillMusic&&2==t.effectType&&b.default.instance.PlayEffect("audio/BattleSound/"+t.skillMusic),this.shakeView(),this.specialskillattackentitys.forEach(function(t){t.setTarget(e.attacktarge),-1==e.updatelist.indexOf(t)&&e.updatelist.push(t),t.addSkillCdInfo(e.skill,e.skilllv),t.skillresult(e.skill,e.skilllv)}),y.default.instance.clearTimeout(this.fightspcialstep)},e.prototype.checkentityhitstatus=function(){for(var e=0,t=this.updatelist;e<t.length;e++){var i=t[e];if(i.hitStatus!=r.HIT_STATUS.NONE&&!i.prop.selfMonster)return void(0==this.checkskillcom&&(this.checkskillcom=y.default.instance.setInterval(this.checkentityhitstatus,this,300)))}y.default.instance.clearInterval(this.checkskillcom),this.checkskillcom=0,this.allcom()},e.prototype.complete=function(){var e=this;if(this.skillconf.bigskillcomtime)var t=y.default.instance.setTimeout(function(){e.checkentityhitstatus(),y.default.instance.clearTimeout(t)},this,this.skillconf.bigskillcomtime);else this.checkentityhitstatus();this.stopShake(),R.GameEventDispatcher.instance.emit(A.EventDefiner.C_Fight_StartTask)},e.prototype.checkComplete=function(e){a.default.instance.specialskillstatus!=r.SPECIAL_SKILL_STATUS.NONE&&a.default.instance.specialskillEntityComEffect&&(p.default.instance.getSkillBySkillId(this.skill).attackway==r.ATTACK_TYPE.ATTACK_TYPE_4&&(a.default.instance.specialskillcount=0),e&&e.avatar&&e.avatar.body,e.avatar.body.animEndCall=null,e.avatar.body.animEndCallThisObj=null,e.avatar.body.animEndCallThisParam=null,a.default.instance.specialskillcount<=0&&this.spskillcom&&this.complete())},e.prototype.setAvatarCom=function(e){e.avatar&&e.avatar.body&&(e.avatar.body.animEndCall=this.checkComplete,e.avatar.body.animEndCallThisObj=this,e.avatar.body.animEndCallThisParam=[e])},e.prototype.updateEntities=function(e,t){for(var i=0,n=this.updatelist;i<n.length;i++){var o=n[i];o.updateData(e*this.specialrate,t),o.getPlayRate()!=this.specialrate&&o.setPlayRate(this.specialrate)}},e.prototype.addHitentitys=function(e){for(var t=0,i=e;t<i.length;t++){var o=i[t],a=n.default.instance.getSceneEntity(o);this.specialskillhitentitys.push(a)}this.updatelist=this.specialskillhitentitys,this.maskHighlight(this.specialskillhitentitys)},e.prototype.maskHighlight=function(e,t){void 0===t&&(t=!1),d.default.instance.recoveryAll();for(var i=0,s=e;i<s.length;i++){var l=s[i];l.prop.handle==this.specialskillattackentitys[0].prop.handle&&a.default.instance.specialskillstatus==r.SPECIAL_SKILL_STATUS.SPECIAL_SKILL_STATUS1||(n.default.instance.removeChildLayer(l.node),o.default.instance.ActorsMaskLayer.addActorObj_toScene(l,t))}for(var c in n.default.instance.entities){var p=n.default.instance.entities[c];-1==e.indexOf(p)?p.setPlayRate(0):p.setPlayRate(a.default.instance.oldfightViewPlayRate)}},e.prototype.actorHighlight=function(e){d.default.instance.recoveryAll();for(var t=0,i=e;t<i.length;t++){var r=i[t];o.default.instance.ActorsMaskLayer.removeChildLayer(r.node),n.default.instance.addActorObj_toScene(r),r.x=r.prop.x,r.y=r.prop.y}for(var s in n.default.instance.entities){var l=n.default.instance.entities[s];-1==e.indexOf(l)?l.setPlayRate(0):l.setPlayRate(a.default.instance.oldfightViewPlayRate)}},e.prototype.allcom=function(){if(this.bigskillcanhit=!0,this.spineNode&&(l.SpinePools.recoverSpineNoder(this.spineNode),this.spineNode=null),this.otereffect.length>0)for(var e=0,t=this.otereffect;e<t.length;e++){var i=t[e];o.default.instance.ActorsMaskLayer.removeChildLayer(i,!1),C.default.instance.node.addChild(i)}this.otereffect=[],this.actorHighlight(this.specialskillattackentitys.concat(this.specialskillhitentitys)),a.default.instance.specialskillstatus=r.SPECIAL_SKILL_STATUS.NONE,a.default.instance.specialskillcount=0,this.specialskillhitentitys=[],this.specialskillattackentitys=[],this.specialskillstep=0,this.skillbgeffect&&(l.SpinePools.recoverSpineNoder(this.skillbgeffect),this.skillbgeffect=null),this.skillnameeffect&&(l.SpinePools.recoverSpineNoder(this.skillnameeffect),this.skillnameeffect=null),g.default.instance.clear(),s.default.instance.SetFightViewPlayRate(a.default.instance.oldfightViewPlayRate)},e._instance=null,e=t=__decorate([L],e)}());i.default=E,cc._RF.pop()},{"../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/SpineBase":"SpineBase","../../../Core/TimeController":"TimeController","../../../Global/GlobalValue":"GlobalValue","../../../GlobalContext":"GlobalContext","../../../Util/Scene/MoveUtil":"MoveUtil","../../../Util/Shake":"Shake","../../Sound/SoundController":"SoundController","../BigSkill/BigSkill18Controller":"BigSkill18Controller","../BigSkill/BigSkill22Controller":"BigSkill22Controller","../BigSkill/BigSkillArf2Controller":"BigSkillArf2Controller","../BigSkill/BigSkillArf3Controller":"BigSkillArf3Controller","../BigSkill/BigSkillArf4Controller":"BigSkillArf4Controller","../BigSkill/BigSkillArf5Controller":"BigSkillArf5Controller","../BigSkill/BigSkillArfController":"BigSkillArfController","../Controller/FightController":"FightController","../Effect/FntSwingUtils":"FntSwingUtils","../Manager/SceneManager":"SceneManager","../Pool/SpinePools":"SpinePools","../Unit/FightConst":"FightConst","../Unit/FightLog":"FightLog","../View/ActorsBigSkillLayer":"ActorsBigSkillLayer","../View/ActorsLayer":"ActorsLayer","../View/FightView":"FightView","./SkillController":"SkillController"}],SpineBase:[function(e,t,i){"use strict";cc._RF.push(t,"37a65BaumRH/ZSSpZGF6Ji3","SpineBase"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./LoadManager"),o=e("./CacheManager"),a=e("../Module/Scene/LayerableCompent"),r=cc._decorator,s=r.ccclass,l=r.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.spine=null,t.canTouch=!1,t.animationnkey="",t.comanimationnkey="",t._defaultsAKey="default",t._defaultsSkin="default",t._loop=!0,t._isPlaying=!1,t.completeCallback=null,t.completeCallbackThisObj=null,t.completeCallbackParam=null,t.animEventHandle={},t.frametime=30,t._playRate=1,t.setintervalnum=0,t.needSpineHandle=!1,t.curTrackEntry=null,t.spineUpdate=null,t.spineUpdateThisObj=null,t.spineUpdateCount=0,t.spineUpdateDt=0,t}return __extends(t,e),t.prototype.setAnimEventCall=function(e,t,i,n){var o={callback:t,callbackthis:i,callbackparm:n};this.animEventHandle[e]=o},t.prototype.start=function(){e.prototype.start.call(this),this.initData()},t.prototype.initData=function(){this.spine||(this.spine=this.node.addComponent(sp.Skeleton))},t.prototype.show=function(){e.prototype.show.call(this),1==this._isPlaying&&this.spine&&(this.spine.paused=!1)},t.prototype.hide=function(){e.prototype.hide.call(this),this.spine.paused=!0},t.prototype.setSpineCache=function(){var e=sp.Skeleton.AnimationCacheMode.SHARED_CACHE;for(var t in this.animEventHandle){e=sp.Skeleton.AnimationCacheMode.REALTIME;break}this.spine.setAnimationCacheMode(e)},t.prototype.initSpineData=function(e,t,i,o){this.spine.paused=!1,this._isPlaying=!0,""!=this.comanimationnkey?this.animationnkey=this.comanimationnkey:this.animationnkey=i,this.spine.timeScale=this._playRate,this.skin=t,this.url=e,void 0!==o&&(this.loop=o),n.default.instance.loadResByType(e,sp.SkeletonData,this.loadComplete,this,[e]),this.setUseRecord()},Object.defineProperty(t.prototype,"playRate",{get:function(){return this._playRate},set:function(e){this._playRate=e,0==this.spine.paused&&(this.spine.timeScale=this._playRate)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loop",{get:function(){return this.spine.loop},set:function(e){this.spine.loop=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultsAKey",{get:function(){return this._defaultsAKey},set:function(e){this._defaultsAKey=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultsSkin",{get:function(){return this._defaultsSkin},set:function(e){this._defaultsSkin=e},enumerable:!0,configurable:!0}),t.prototype.loadComplete=function(e,t){var i=this;if(1!=this.isDestroyed&&t==this.url){if(this.spine.node.active=!0,this.node.active=!0,this.spine.skeletonData=e,this.spine.premultipliedAlpha=!1,this.setAnimationListener(),this.changeAction(this.skin,this.animationnkey),1==this.needSpineHandle){var n=this.spine._sgNode;n=this.spine,this.spineUpdate||(this.spineUpdate=n.update),this.spineUpdateThisObj=n,this.spineUpdateCount=0,this.spineUpdateDt=0;var o=Math.floor(2*Math.random());n.update=function(e){i.spineUpdateCount++,i.spineUpdateCount>1e4&&(i.spineUpdateCount=0),1==i._isPlaying?(i.spineUpdateDt+=e,i.spineUpdateCount%2==o&&(i.spineUpdate.call(i.spineUpdateThisObj,i.spineUpdateDt),i.spineUpdateDt=0)):i.spineUpdateDt>0&&(i.spineUpdateDt=0)}}this.readlySpineCall&&this.readlySpineCall.call(this.readlySpineCallThisObj)}},t.prototype.setAnimationListener=function(){var e=this;this.spine.setCompleteListener(function(t){if(0==e.spine.loop){t.animation&&t.animation.name;if(e.completeCallback){var i=[];e.completeCallbackParam&&(i=i.concat(e.completeCallbackParam)),i.push(t),e.completeCallback.apply(e.completeCallbackThisObj,i)}}e.animOneEndCall&&e.animOneEndCall.call(e.animOneEndThisObj)}),this.spine.setEventListener(function(t,i){i&&i.data.name&&e.animEventHandle[i.data.name]&&e.animEventHandle[i.data.name].callback&&e.animEventHandle[i.data.name].callback.apply(e.animEventHandle[i.data.name].callbackthis,e.animEventHandle[i.data.name].callbackparm)})},t.prototype.play=function(e,t){this.animationnkey=e||this.animationnkey,t?(this.changeAction(this.skin,this.animationnkey),this.skin=t):this.curTrackEntry=this.spine.setAnimation(0,this.animationnkey,this.spine.loop)},t.prototype.resume=function(){this.play(),this.spine.paused=!1,this._isPlaying=!0},t.prototype.stop=function(){this.spine&&(this.spine.paused=!0),this._isPlaying=!1},t.prototype.changeAction=function(e,t){(null==e||""==e&&null==this.skin)&&(e=this.defaultsSkin,this.skin=e),null!=t&&""!=t||(t=this.defaultsAKey);try{this.spine.setSkin(e)}catch(e){}this.curTrackEntry=this.spine.setAnimation(0,t,this.spine.loop)},t.prototype.setStartTrackTime=function(e){this.curTrackEntry&&(this.curTrackEntry.animationStart=e)},Object.defineProperty(t.prototype,"trackAnimationLast",{get:function(){return this.curTrackEntry?this.curTrackEntry.animationLast:0},enumerable:!0,configurable:!0}),t.prototype.clear=function(){this.clearUseRecord(),this.defaultsAKey="",this.stop(),this.url&&(this.url=null),this.completeCallback=null,this.completeCallbackThisObj=null,this.completeCallbackParam=null,this.readlySpineCall=null,this.readlySpineCallThisObj=null,this.animOneEndCall=null,this.animOneEndThisObj=null,this.animationnkey="",this.comanimationnkey="",this.animEventHandle={},this.spine&&this.spine.node&&(this.spine._skeleton=null,this.spine.node.active=!1,this.loop=!0)},t.prototype.dispose=function(){this.clear(),e.prototype.dispose.call(this)},t.prototype.onDestroy=function(){this.clear(),e.prototype.onDestroy.call(this)},t.prototype.clearUseRecord=function(){o.default.instance.clearUseRecord(this.url)},t.prototype.setUseRecord=function(){o.default.instance.setUseRecord(this.url)},__decorate([l(sp.Skeleton)],t.prototype,"spine",void 0),t=__decorate([s],t)}(a.default);i.default=c,cc._RF.pop()},{"../Module/Scene/LayerableCompent":"LayerableCompent","./CacheManager":"CacheManager","./LoadManager":"LoadManager"}],SpinePools:[function(e,t,i){"use strict";cc._RF.push(t,"2bf48BghQdCeqrvMKbsgJYv","SpinePools"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/SpineBase"),o=function(){function e(){}return e.returnSpineNode=function(){var t;return this._spinePool.size()>0?t=this._spinePool.get():((t=new cc.Node).addComponent(n.default),t.getComponent(n.default).initData()),""==t.name&&(t=e.returnSpineNode()),t.getComponent(n.default).playRate=1,t.setScale(1),t.rotation=0,t.active=!0,t},e.recoverSpineNoder=function(e){return e&&(e.getComponent(n.default)?(e.setScale(1),e.rotation=0,e.getComponent(n.default).clear(),e.removeFromParent(!1),e.active=!1,this._spinePool.put(e)):e.destroy()),e},e.addSpineNoder=function(t,i){var n=e.returnSpineNode();return n.setPosition(i),t.addChild(n),n},e.addCreateSpineNoder=function(e,t){var i=new cc.Node;return i.addComponent(n.default),i.getComponent(n.default).initData(),i.setPosition(t),e.addChild(i),i},e.recoverCreateSpineNoder=function(e){return e&&(e.getComponent(n.default).clear(),e.removeFromParent(!1),e.active=!1),e},e.clearAll=function(){this._spinePool.clear()},e._spinePool=new cc.NodePool,e}();i.SpinePools=o,cc._RF.pop()},{"../../../Core/SpineBase":"SpineBase"}],SpineShotView:[function(e,t,i){"use strict";cc._RF.push(t,"de6e7tW8QFA7IuuzclXCJ4t","SpineShotView"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../Scene/Avater/AvatarBase"),a=e("../../Core/TimeController"),r=e("../WarTeam/MonsterController"),s=e("../../Global/GlobalValue"),l=cc._decorator,c=l.ccclass,d=l.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.View=null,t.Container=null,t.Image=null,t.Avatar=null,t._renderTexture=null,t._shotWidth=600,t._shotHeight=300,t._shoting=!1,t._shotImageList=[],t.frametime=30,t._playRate=1,t.setintervalnum=0,t.pause=!0,t.currentFrame=1,t.maxFrame=0,t.loop=!0,t.completeCallback=null,t.completeCallbackThisObj=null,t.completeCallbackParam=null,t.type=null,t.carid=0,t.grade=0,t.skin=null,t.key=null,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this),this.View.x=-this._shotWidth/2,this.Container.width=this._shotWidth,this.Avatar.node.x=this._shotWidth/2,this.Image.node.scaleY=-1,this.setShotHeight(this._shotHeight),this.Avatar.body.readlySpineCall=this.readlySpineCall,this.Avatar.body.readlySpineCallThisObj=this},t.prototype.init=function(e,t,n,o,a,l,c,d){void 0===l&&(l=!1),void 0===c&&(c=s.ACTION.STAND),void 0===d&&(d=s.DIR.RIGHT),this.type=e,this.carid=t,this.grade=n,this.skin=o;var p=r.default.instance.getCardGradeBySpine(t,n),h=r.default.instance.getCardGradeBySpineName(t,n);this.key=e+"_"+p+"_"+h+"_"+o,i.SpriteFrameDic[this.key]?(this.clearShotImage(),this._shoting=!0,this._shotImageList=i.SpriteFrameDic[this.key],this.animOneEndCall()):this.Avatar&&(this.Container.insertChild(this.Avatar.node,1),this.Avatar.init(e,p,h,o,a,l,c,d),this.Avatar.body.animOneEndCall=this.animOneEndCall,this.Avatar.body.animOneEndThisObj=this)},t.prototype.stop=function(){a.default.instance.clearInterval(this.setintervalnum),this.pause=!0},t.prototype.setShotHeight=function(e){this._shotHeight=e,this.Container.height=this._shotHeight,this.Image.node.width=this.Container.width,this.Image.node.height=this.Container.height,this.Image.node.setPosition(this.Container.width/2-this.Avatar.node.position.x-this.Container.position.x,this.Container.height/2-this.Avatar.node.position.y-this.Container.position.y)},t.prototype.shot=function(){this._renderTexture=new cc.RenderTexture(this.Container.width,this.Container.height,1,0),this._renderTexture.getSprite().getTexture().setAntiAliasTexParameters(),this._renderTexture.begin(),this.Container._sgNode.visit(),this._renderTexture.end();var e=this._renderTexture.getSprite().getSpriteFrame();this._shotImageList.push(e)},t.prototype.readlySpineCall=function(){console.log("\u5f00\u59cb\u622a\u56fe",this.key,Date.now()),this.clearShotImage(),this._shoting=!0,this.setinterval(this.frametime)},t.prototype.animOneEndCall=function(){this._shotImageList.length<=0||0==this._shoting||(console.log("\u64ad\u653e\u4e00\u6b21\u5b8c\u6bd5",this.key,this._shotImageList.length,Date.now()),this.Avatar&&(this.Avatar.clear(),this.Avatar.node.removeFromParent(!1)),i.SpriteFrameDic[this.key]=this._shotImageList,this.maxFrame=this._shotImageList.length,this._shoting=!1,this.setinterval(this.maxFrame))},t.prototype.clearShotImage=function(){this._shotImageList=[],this.Image.spriteFrame=null},Object.defineProperty(t.prototype,"playRate",{get:function(){return this._playRate},set:function(e){this._playRate=e,0==this.pause&&this.setinterval(this.frametime)},enumerable:!0,configurable:!0}),t.prototype.setinterval=function(e){var t=this;a.default.instance.clearInterval(this.setintervalnum),this.pause=!1,this.setintervalnum=a.default.instance.setInterval(function(){t.setSpriteFrame()},this,Math.floor(1e3/(e*this.playRate))),console.log("\u8bbe\u7f6e\u64ad\u653e\u52a8\u753b\u9891\u7387: ",e,Math.floor(1e3/(e*this.playRate)))},t.prototype.setSpriteFrame=function(){0==this._shoting&&this._shotImageList.length>0?this._shotImageList.length>0&&!this.pause&&(this.Image.spriteFrame=this._shotImageList[this.currentFrame-1],this.currentFrame++,!this.loop&&this.currentFrame>this.maxFrame?(this.completeCallback&&this.completeCallback.apply(this.completeCallbackThisObj,this.completeCallbackParam),this.Image.spriteFrame=null,this.stop()):this.currentFrame=this.currentFrame>this.maxFrame?1:this.currentFrame):1==this._shoting&&this.shot()},t.prototype.dispose=function(){this.clearShotImage(),this.Avatar&&(this.Avatar.node.removeFromParent(!1),this.Avatar.dispose(),this.Avatar=null),this.completeCallback&&(this.completeCallback=null,this.completeCallbackThisObj=null,this.completeCallbackParam=null),e.prototype.dispose.call(this)},t.SpriteFrameDic={},__decorate([d(cc.Node)],t.prototype,"View",void 0),__decorate([d(cc.Node)],t.prototype,"Container",void 0),__decorate([d(cc.Sprite)],t.prototype,"Image",void 0),__decorate([d(o.default)],t.prototype,"Avatar",void 0),t=i=__decorate([c],t)}(n.default);i.default=p,cc._RF.pop()},{"../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../../Global/GlobalValue":"GlobalValue","../Scene/Avater/AvatarBase":"AvatarBase","../WarTeam/MonsterController":"MonsterController"}],Spine:[function(e,t,i){"use strict";cc._RF.push(t,"b75aet4/r1EX5Y7VcieLRbb","Spine"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/LoadManager"),a=e("../../Core/CacheManager"),r=cc._decorator,s=r.ccclass,l=r.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.resourceUrl="",t.skin="default",t.ani="default",t.spine=null,t._url=null,t._loop=!1,t._loadComplete=null,t._loadCompleteThisObj=null,t._loadCompleteParam=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.initSpine()},t.prototype.initSpine=function(){this.spine||(this.spine=this.node.addComponent(sp.Skeleton))},t.prototype.start=function(){e.prototype.start.call(this),this.setSpine()},t.prototype.setSpine=function(){""!=this.resourceUrl&&this.loadSpineData(this.resourceUrl)},t.prototype.updateBg=function(e,t,i,n){void 0===t&&(t="default"),void 0===i&&(i="default"),void 0===n&&(n=!1),this.initSpine(),this.resourceUrl=e,this.skin=t,this.ani=i,this._loop=n,this.setSpine()},t.prototype.loadSpineData=function(e,t,i,n){void 0===t&&(t=null),void 0===i&&(i=null),void 0===n&&(n=null),this._url!=e&&(this.clear(),this._url=e,this._loadComplete=t,this._loadCompleteThisObj=i,this._loadCompleteParam=n,o.default.instance.loadResByType(e,sp.SkeletonData,this.loadSpineComplete,this,[e]),this.setUseRecord())},t.prototype.loadSpineComplete=function(e,t){1!=this.isDestroyed&&t==this._url&&(this.spine.skeletonData=e,this.spine.premultipliedAlpha=!1,this.changeAction(this.skin,this.ani,this._loop))},t.prototype.changeAction=function(e,t,i){void 0===i&&(i=!1),null==e&&""==e||(this.skin=e),null==t&&""==t||(this.ani=t),this._loop=i,this.spine.setSkin(this.skin),this.spine.setAnimation(0,this.ani,i)},t.prototype.setPaused=function(e){void 0===e&&(e=!1),this.spine.paused=e},t.prototype.clear=function(){this.clearUseRecord(),this.spine&&this.spine.isValid&&(this.spine.skeletonData=null),this._loadComplete=null,this._loadCompleteThisObj=null,this._loadCompleteParam=null,this._url=null},t.prototype.dispose=function(){this.clear(),e.prototype.dispose.call(this)},t.prototype.onDestroy=function(){this.clear(),e.prototype.onDestroy.call(this)},t.prototype.clearUseRecord=function(){this._url&&""!=this._url&&a.default.instance.clearUseRecord(this._url)},t.prototype.setUseRecord=function(){this._url&&""!=this._url&&a.default.instance.setUseRecord(this._url)},__decorate([l(cc.String)],t.prototype,"resourceUrl",void 0),__decorate([l(cc.String)],t.prototype,"skin",void 0),__decorate([l(cc.String)],t.prototype,"ani",void 0),t=__decorate([s],t)}(n.default);i.default=c,cc._RF.pop()},{"../../Core/CacheManager":"CacheManager","../../Core/LoadManager":"LoadManager","../../Core/Widget":"Widget"}],SportController:[function(e,t,i){"use strict";cc._RF.push(t,"14eb0SCoOZGHJY+M0zI+pqO","SportController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../Core/ConfigsManager"),a=e("./SportsData/SportData"),r=cc._decorator,s=r.ccclass,l=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._config=null,t._sportData=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this,this._config=o.ConfigsManager.instance.getConfigs("activityInfoconf"),this.onInitData()},t.prototype.onInitData=function(){this._sportData=new a.default,this._sportData.onInit(this._config.ActivityConf)},Object.defineProperty(t.prototype,"sportList",{get:function(){return this._sportData.sportList},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sportWindowTypeList",{get:function(){return this._sportData.sportWindowTypeList},enumerable:!0,configurable:!0}),t.instance=null,t=i=__decorate([s],t)}(n.default));i.default=l,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Controller":"Controller","./SportsData/SportData":"SportData"}],SportData:[function(e,t,i){"use strict";cc._RF.push(t,"539420W2eZPTp8DOzG+Qaq6","SportData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Activity/ActivityHallData/ActivityHallItemData"),o=function(){function e(){this._sportList=[],this._sportWindowTypeList=[],this._config=null}return e.prototype.onInit=function(e){for(var t in this._config=e,this._sportList=[],this._sportWindowTypeList=[],this._config){var i=new n.default;i.onInit(this._config[t]),2==i.type&&(this._sportList.push(i),this._sportWindowTypeList.push(i.windowType))}},Object.defineProperty(e.prototype,"sportList",{get:function(){return this._sportList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sportWindowTypeList",{get:function(){return this._sportWindowTypeList},enumerable:!0,configurable:!0}),e}();i.default=o,cc._RF.pop()},{"../../Activity/ActivityHallData/ActivityHallItemData":"ActivityHallItemData"}],SportsWindow:[function(e,t,i){"use strict";cc._RF.push(t,"cf7a31HajlKdopLnobEe0g6","SportsWindow"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/WindowManager"),o=e("../../Core/WindowType"),a=e("../../GlobalContext"),r=e("../Scene/UIAnim/VariousAnim"),s=e("../../Core/Widget"),l=e("./SportController"),c=e("../Activity/ActivityHallItem"),d=e("../../Core/TimeController"),p=e("../../Core/LoadManager"),h=e("../../Util/Utils"),u=cc._decorator,f=u.ccclass,g=u.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layerContent=null,t.scrollView=null,t.spriteBG=null,t.layerBack=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this,this.node.setContentSize(a.GlobalContext.UIWidth,a.GlobalContext.UIHeight)},t.prototype.onInitData=function(e){void 0===e&&(e=0),this.onShowPage(!0)},t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.onDisable=function(){e.prototype.onDisable.call(this)},t.prototype.onShowPage=function(e){var t=this;void 0===e&&(e=!1),h.default.setNodeChildDestoryByUrl(this.layerContent,a.GlobalContext.Root+"prefab/ActivityHall/ActivityHallItem"),p.default.instance.loadResByType(a.GlobalContext.Root+"prefab/ActivityHall/ActivityHallItem",cc.Prefab,function(e){for(var i=l.default.instance.sportList,n=(t.scrollView.getContentPosition(),0);n<i.length;n++){var o,r=h.default.getNodeByUrl(e,a.GlobalContext.Root+"prefab/ActivityHall/ActivityHallItem");r.getComponent(c.default).onInitData(i[n]),r.name="ActivityHallItem"+i[n].windowType,o=r.getComponent(c.default).getIndex(),t.layerContent.insertChild(r,o)}d.default.instance.setTimeout(function(){t.layerContent.runAction(cc.moveTo(.1,0,0))},t,200)},this)},t.prototype.onShowEffect=function(){var e=this;this.node.x=a.GlobalContext.UIWidth,this.node.runAction(cc.moveTo(.5,0,0)),r.default.instance.openTwoAnim(function(){e.layerBack.opacity=1,e.layerBack.runAction(cc.fadeTo(.4,255)),e.spriteBG.opacity=255,r.default.instance.initInfo()},this)},t.prototype.onClickBack=function(){n.default.instance.close(o.WindowType.SportsWin)},t.instance=null,__decorate([g(cc.Node)],t.prototype,"layerContent",void 0),__decorate([g(cc.ScrollView)],t.prototype,"scrollView",void 0),__decorate([g(cc.Node)],t.prototype,"spriteBG",void 0),__decorate([g(cc.Node)],t.prototype,"layerBack",void 0),t=i=__decorate([f],t)}(s.default);i.default=y,cc._RF.pop()},{"../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Activity/ActivityHallItem":"ActivityHallItem","../Scene/UIAnim/VariousAnim":"VariousAnim","./SportController":"SportController"}],StatusController:[function(e,t,i){"use strict";cc._RF.push(t,"957fcHKo5NHarFLEliQr4Ot","StatusController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("./StatusType"),a=e("../../Core/GameEventDispatcher"),r=e("../../Core/Event"),s=e("../../Global/GlobalValue"),l=e("../../Core/WindowManager"),c=e("../Expedition/ExpeditionConfig"),d=e("../../Core/WindowType"),p=e("../Scene/Manager/SceneManager"),h=e("../WorldBoss/WorldBoss"),u=e("../OpenWin/OpenWinController"),f=e("../TreasureMap/TreasureMapController"),g=e("../TreasureMap/Data/TreasureConfig"),y=e("../Scene/Controller/SceneController"),m=e("../Role/RoleController"),C=e("../Scene/UIAnim/VariousAnim"),v=e("../EquipCopy/EquipCopyController"),_=e("../TotemsCopy/TotemsCopyUtils"),b=e("../Daily/Dailycontroller"),T=e("../ExpCopy/ExpCopyUtils"),S=cc._decorator,I=S.ccclass,w=(S.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._oldActivityStatus=0,t.guanqiaId=null,t}var i;return __extends(t,e),i=t,t.prototype.listNotification=function(){i.instance=this},t.prototype.start=function(){e.prototype.start.call(this),a.GameEventDispatcher.instance.on(r.EventDefiner.ChangeActivityStatus,this.changeActivityStatus,this)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this),a.GameEventDispatcher.instance.off(r.EventDefiner.ChangeActivityStatus,this.changeActivityStatus,this)},t.prototype.changeActivityStatus=function(e){var t=e.getUserData();this.activityStatus=Number(t)},Object.defineProperty(t.prototype,"oldActivityStatus",{get:function(){return this._oldActivityStatus},set:function(e){this._oldActivityStatus=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_activityStatus",{set:function(e){o.ActivityStatus.value=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activityStatus",{set:function(e){console.log("StatusController.activityStatus, \u65e7\u7684\u72b6\u6001\u4e3a oldStatus:"+this._activityStatus+", \u8bbe\u7f6e\u5f53\u524d\u72b6\u6001\u4e3a currentStatus:"+e),this._activityStatus!=e&&(this.clearByStatus(),this._activityStatus=e,this.activityStatusHandle(!1))},enumerable:!0,configurable:!0}),t.prototype.onChangeScene=function(e){void 0===e&&(e=!1),e&&(C.default.instance.oldStatus==s.GameScene.Fight?a.GameEventDispatcher.instance.emit(r.EventDefiner.ChangeGameScene,{status:s.GameScene.Main}):y.default.instance.scenestatus!=C.default.instance.oldStatus&&a.GameEventDispatcher.instance.emit(r.EventDefiner.ChangeGameScene,{status:C.default.instance.oldStatus}))},t.prototype.onFightBack=function(e){void 0===e&&(e=!1),e&&(l.default.instance.closeAll(),m.default.instance.RoleUpgrading())},t.prototype.activityStatusHandle=function(e,t,i){switch(void 0===e&&(e=!0),void 0===t&&(t=!1),void 0===i&&(i=!1),o.ActivityStatus.value){case o.ActivityStatus.NoActivity:a.GameEventDispatcher.instance.emit(r.EventDefiner.ChangeGameScene,{status:s.GameScene.Main}),b.default.instance.skipBool&&a.GameEventDispatcher.instance.emit("PROGRESSBAR",this);break;case o.ActivityStatus.Chapter:y.default.instance.scenestatus!=s.GameScene.Scene&&a.GameEventDispatcher.instance.emit(r.EventDefiner.ChangeGameScene,{status:s.GameScene.Scene,type:1,isFightBack:e});break;case o.ActivityStatus.TreasureMap:f.default.instance.isOpenMainView&&(this.onFightBack(e||i),this.onChangeScene(e||i),u.default.instance.openWindow(d.WindowType.TreasureMainView,function(){a.GameEventDispatcher.instance.emit(g.TreasureConfig.treasureDataRefresh),e&&a.GameEventDispatcher.instance.emit(g.TreasureConfig.treasureFightResult,p.default.instance.fightresult)}));break;case o.ActivityStatus.Expedition:this.onFightBack(e),this.onChangeScene(e),u.default.instance.openWindow(d.WindowType.Expedition,function(){e&&(a.GameEventDispatcher.instance.emit(c.ExpeditionEvent.Gamecustoms),t&&a.GameEventDispatcher.instance.emit(c.ExpeditionEvent.GameNext))});break;case o.ActivityStatus.WorldBoss:this.onFightBack(e),this.onChangeScene(e),u.default.instance.openWindow(d.WindowType.WorldBoss,function(){h.default.instance.initInfo()});break;case o.ActivityStatus.EliteBoss:this.onFightBack(e),this.onChangeScene(e),u.default.instance.openWindow(d.WindowType.EliteBoss,function(){});break;case o.ActivityStatus.HighLadder:this.onFightBack(e),this.onChangeScene(e),u.default.instance.openWindow(d.WindowType.HighLadderWin,function(){});break;case o.ActivityStatus.Arena:this.onFightBack(e),this.onChangeScene(e),u.default.instance.openWindow(d.WindowType.Arena);break;case o.ActivityStatus.FridBoss:this.onFightBack(e),this.onChangeScene(e),u.default.instance.openWindow(d.WindowType.FridBoss);break;case o.ActivityStatus.MoneyDailyCopy:case o.ActivityStatus.RefineDailyCopy:case o.ActivityStatus.GemDailyCopy:case o.ActivityStatus.ArtifactDailyCopy:this.onFightBack(e),this.onChangeScene(e),u.default.instance.openWindow(d.WindowType.DailyCopyArtifact);break;case o.ActivityStatus.EquipCopy:this.onFightBack(e),this.onChangeScene(e),u.default.instance.openWindow(d.WindowType.EquipCopyMain,function(){if(t){var e=v.default.instance.equipData.equipCopyMainData.currentLevel,i=v.default.instance.getLevelConfig(e).guanqia[2];v.default.instance.sendCmdInToFight(3,i)}},this);break;case o.ActivityStatus.TotemsCopy:this.onFightBack(e),this.onChangeScene(e),t?_.TotemsCopyUtils.getInfoFight():u.default.instance.openWindow(d.WindowType.TotemsCopy);break;case o.ActivityStatus.ExpCopy:i&&e?T.ExpCopyUtils.joinFight():t?T.ExpCopyUtils.isCanFight():e&&(this.onFightBack(e),this.onChangeScene(e),u.default.instance.openWindow(d.WindowType.ExpCopy));break;case o.ActivityStatus.Mine:this.onFightBack(e),this.onChangeScene(e),u.default.instance.openWindow(d.WindowType.Mine);break;case o.ActivityStatus.LoardCrusade:this.onFightBack(e),this.onChangeScene(e),u.default.instance.openWindow(d.WindowType.LoardCrusadeWin)}},t.prototype.clearByStatus=function(){var e=o.ActivityStatus.value;switch(this.oldActivityStatus=e,e){case o.ActivityStatus.NoActivity:l.default.instance.closeAll()}},Object.defineProperty(t.prototype,"isSingle",{get:function(){switch(o.ActivityStatus.value){case o.ActivityStatus.Arena:case o.ActivityStatus.EliteBoss:case o.ActivityStatus.WorldBoss:case o.ActivityStatus.HighLadder:case o.ActivityStatus.LoardCrusade:return!1}return!0},enumerable:!0,configurable:!0}),t.instance=null,t=i=__decorate([I],t)}(n.default));i.default=w,cc._RF.pop()},{"../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../Daily/Dailycontroller":"Dailycontroller","../EquipCopy/EquipCopyController":"EquipCopyController","../ExpCopy/ExpCopyUtils":"ExpCopyUtils","../Expedition/ExpeditionConfig":"ExpeditionConfig","../OpenWin/OpenWinController":"OpenWinController","../Role/RoleController":"RoleController","../Scene/Controller/SceneController":"SceneController","../Scene/Manager/SceneManager":"SceneManager","../Scene/UIAnim/VariousAnim":"VariousAnim","../TotemsCopy/TotemsCopyUtils":"TotemsCopyUtils","../TreasureMap/Data/TreasureConfig":"TreasureConfig","../TreasureMap/TreasureMapController":"TreasureMapController","../WorldBoss/WorldBoss":"WorldBoss","./StatusType":"StatusType"}],StatusType:[function(e,t,i){"use strict";cc._RF.push(t,"fef89Z3r+xPlZm6GyYr9xX4","StatusType"),Object.defineProperty(i,"__esModule",{value:!0}),i.ActivityStatus={value:0,NoActivity:1,Chapter:2,TreasureMap:3,Expedition:4,WorldBoss:5,EliteBoss:6,HighLadder:7,Arena:8,FridBoss:10,LoardCrusade:11,equipRelpace:12,equipForging:13,ThemeShop:14,MoneyDailyCopy:15,RefineDailyCopy:16,GemDailyCopy:17,ArtifactDailyCopy:18,EquipCopy:19,TotemsCopy:20,ExpCopy:22,Mine:23,Guide:100,FightSimulator:9999},cc._RF.pop()},{}],StopClickEventComponent:[function(e,t,i){"use strict";cc._RF.push(t,"ac43dCq8/ZFca4+rVX/9al5","StopClickEventComponent"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./Window"),o=e("./Widget"),a=cc._decorator,r=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.MaskClickIsClose=!1,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this),this.node.on(cc.Node.EventType.TOUCH_START,this.StopClickEventHandle,this)},t.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.TOUCH_START,this.StopClickEventHandle,this)},t.prototype.StopClickEventHandle=function(e){e.stopPropagation(),this.MaskClickIsClose&&this.node.parent&&this.node.parent.getComponent(n.default)&&this.node.parent.getComponent(n.default).close()},__decorate([s(cc.Boolean)],t.prototype,"MaskClickIsClose",void 0),t=__decorate([r],t)}(o.default);i.default=l,cc._RF.pop()},{"./Widget":"Widget","./Window":"Window"}],Strengthen:[function(e,t,i){"use strict";cc._RF.push(t,"5511aji2VFBr5psZZWx5HVK","Strengthen"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../Item/ItemData"),a=e("../../Item/ItemIcon"),r=e("./EquipCtrl"),s=e("../../../Util/Utils"),l=e("../../../GlobalContext"),c=e("../../../Core/LoadManager"),d=e("../EquipTypeNode"),p=e("../../../Core/Language"),h=e("../../Role/RoleInfo"),u=e("../../Tips/OpTipsController"),f=e("../../../Core/GameEventDispatcher"),g=e("../../../Core/Event"),y=e("../../../Util/RechargeUtils"),m=e("../../../Util/RechargeConst"),C=e("../../Commons/RewardUtils"),v=e("../../Item/ItemController"),_=e("../../Role/RoleStrengthen/RoleStrengthenController"),b=e("../../Role/RoleStrengthen/RoleStrengthenEvent"),T=e("../../../Core/SimpleActionEffect"),S=e("../EquipWin"),I=e("../../Sound/SoundController"),w=e("../../WarTeam/MonsterController"),D=e("../../Tips/TipsWinController"),R=e("../../Commons/CommonProgress"),A=cc._decorator,N=A.ccclass,L=A.property,E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.attrPre=null,t.effect=null,t.toggle=null,t._data=null,t._guid=null,t._gold=null,t._expFlag=null,t._itemMap={},t.goldValueColor=[new cc.Color(92,60,52),new cc.Color(255,0,0)],t}return __extends(t,e),t.prototype.show=function(){f.GameEventDispatcher.instance.on(g.EventDefiner.EQUIP_upgrade_ret,this.equipUpgrade,this),f.GameEventDispatcher.instance.on("BagPackInfoChange",this.upData,this),f.GameEventDispatcher.instance.on(g.EventDefiner.Card_xingtai_up,this.setAttr,this)},t.prototype.hide=function(){this._data=null,this._guid=null,this._gold=null,this._expFlag=null,this._itemMap={},f.GameEventDispatcher.instance.off(g.EventDefiner.EQUIP_upgrade_ret,this.equipUpgrade,this),f.GameEventDispatcher.instance.off("BagPackInfoChange",this.upData,this),f.GameEventDispatcher.instance.off(g.EventDefiner.Card_xingtai_up,this.setAttr,this),e.prototype.hide.call(this)},t.prototype.setData=function(e){this._guid=e,this.upData()},t.prototype.equipUpgrade=function(e){var t=e?e.getUserData():null;t&&t.result&&I.default.instance.PlayEffect(I.SoundType.upSucceeds),this.upShowData()},t.prototype.upData=function(){this._data=r.default.instance.data.getItemByGuid(this._guid),this._data?this.upShowData():this.resetData()},t.prototype.resetData=function(){var e=!!this._data,t=this.node.getChildByName("item");t.getChildByName("noEquip").active=!e,t.getChildByName("ItemIcon").active=e;var i=this.node.getChildByName("ProgressBar");i.getComponent(R.default).value=0,i.getChildByName("value").getComponent(cc.Label).string="0/0";var n=this.node.getChildByName("infoNode"),o=l.GlobalContext.Root+"prefab/Equip/TypeNode";s.default.setNodeChildDestoryByUrl(n,o),this.node.getChildByName("materialNode").active=!1,this.node.getChildByName("btnNode").getChildByName("btnReplace").getComponent(cc.Button).interactable=!1,this.node.getChildByName("btnNode").getChildByName("sprPrice").getChildByName("value").color=this._gold<=h.MyRoleInfo.money?this.goldValueColor[0]:this.goldValueColor[1]},t.prototype.upShowData=function(){this.setItemShow(),this.setProgressBar(),this.setAttr(),this.setMaterial(),this.setOther()},t.prototype.setItemShow=function(){var e=!!r.default.instance.data.getItemByGuid(this._guid),t=this.node.getChildByName("item");if(t.getChildByName("noEquip").active=!e,t.getChildByName("ItemIcon").active=e,e){var i=r.default.instance.data.getMaxUPLevelData(this._data);i=i||0;var n="LV:"+this._data.level+"/"+i;t.getChildByName("ItemIcon").getComponent(a.default).ItemData(this._data,!0,n,!0)}},t.prototype.setProgressBar=function(){var e=this.node.getChildByName("ProgressBar"),t=e.getChildByName("value"),i=r.default.instance.data.getEquipNeedExp(this._data.id,this._data.level);e.getComponent(R.default).value=this._data.exp/i,t.getComponent(cc.Label).string=this._data.exp+"/"+i},t.prototype.setAttr=function(){var e=r.default.instance.data.getCalculateEquipStrengthenAttr(this._data.id,this._data.level,!0),t=w.default.instance.getAttrPrecentByGradeAndType(w.default.instance.data.MorphologicalTag,e),i=r.default.instance.data.getCalculateEquipStrengthenAttr(this._data.id,this._data.level+1,!0),n=w.default.instance.getAttrPrecentByGradeAndType(w.default.instance.data.MorphologicalTag,i),o=r.default.instance.data.getEquipLevel(this._data),a=this._data.level<o,p=this.node.getChildByName("infoNode"),h=l.GlobalContext.Root+"prefab/Equip/TypeNode";c.default.instance.loadResByType(h,cc.Prefab,function(e){s.default.setNodeChildDestoryByUrl(p,h);var i=Object.keys(t).length>0?t:n;for(var o in i)if(i[o]){var r=s.default.getNodeByUrl(e,l.GlobalContext.Root+"prefab/Equip/TypeNode");a?r.getComponent(d.default).initEventNode(3,parseInt(o),t[o]?t[o]:0,0,n[o]?n[o]:0):r.getComponent(d.default).initEventNode(1,parseInt(o),t[o]),p.addChild(r)}},this)},t.prototype.setMaterial=function(){var e=this.node.getChildByName("materialNode");e.active=!0;var t=r.default.instance.data.getUpLevelMaterialDataList();for(var i in e.children)if(t[i]){e.children[i].active=!0;var n=e.children[i],s=v.default.instance.getItemNum(t[i].itemId),l=o.default.creatItem(t[i].itemId,s);n.getChildByName("ItemIcon").getComponent(a.default).ItemData(l,!0,s+"",!0),n.getChildByName("Label").getComponent(cc.Label).string=p.default.getStr("5514",t[i].exp)}else e.children[i].active=!1;var c=r.default.instance.data.getEquipUPLevelExpend(this._data);this._gold=c.gold,this._itemMap=c.itemMap,this._expFlag=c.expFlag},t.prototype.setOther=function(){var e=this.node.getChildByName("btnNode"),t=this.node.getChildByName("maxLevelNode"),i=r.default.instance.data.getEquipLevel(this._data),n=this._data.level<i;if(t.active=!n,e.active=n,n){e.getChildByName("btnReplace").getComponent(cc.Button).interactable=n;var o=e.getChildByName("sprPrice").getChildByName("value");o.color=this._gold<=h.MyRoleInfo.money?this.goldValueColor[0]:this.goldValueColor[1],o.getComponent(cc.Label).string=this._gold+""}},t.prototype.onClickBtn=function(){var e=this,t=r.default.instance.data.getMaxUPLevelData(this._data);if(h.MyRoleInfo.level<=this._data.level)u.default.instance.ShowMsg(p.default.getStr("\u7b49\u7ea7\u4e0a\u9650, \u8bf7\u5148\u63d0\u4eba\u7269\u7b49\u7ea7"));else if(t<=this._data.level)D.default.instance.ShowTips(p.default.getStr("equipTipsText"),function(){f.GameEventDispatcher.instance.emit(g.EventDefiner.EQUIP_JumpTag,{index:1})},this,null,1,null,null,null,null,null,!1);else if(this.isGetItem()||this.toggle.isChecked||S.default.instance.strengThen)this.toggle.isChecked?this.toggle.isChecked&&this.refiningEquipSend():y.default.PurchaseItemOrRechage(m.RechargeTypeConst.Prop,this._gold,this.callBack1,this,C.RewardType.Coin);else{S.default.instance.strengThen=!0;D.default.instance.ShowTips("\u662f\u5426\u5f00\u542f\u81ea\u52a8\u8d2d\u4e70",function(){e.toggle.isChecked=!0},null,null,1,null,null,function(){e.callBack1()})}},t.prototype.callBack1=function(){if(this._expFlag)this.refiningEquipSend();else{var e=r.default.instance.data.getUpLevelMaterialDataList();y.default.PurchaseItemOrRechage(m.RechargeTypeConst.Prop,1e4,this.refiningEquipSend,this,e[0].itemId)}},t.prototype.refiningEquipSend=function(){var e;_.default.instence.setImgState(b.RoleImgType.Strengthen),this.node.getChildByName("item"),this.effect.getComponent(T.default).playById(5,"upSKIllEffect",!1,null,this),e=this.toggle.isChecked?r.default.instance.data.getEquipUpExp(this._data):this._itemMap,r.default.instance.reqEquipuplevel(this._guid,e,this.toggle.isChecked)},t.prototype.isGetItem=function(){for(var e in this._itemMap)if(this._itemMap[e]>0)return!0;return!1},__decorate([L(cc.Prefab)],t.prototype,"attrPre",void 0),__decorate([L(cc.Node)],t.prototype,"effect",void 0),__decorate([L(cc.Toggle)],t.prototype,"toggle",void 0),t=__decorate([N],t)}(n.default);i.default=E,cc._RF.pop()},{"../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Core/LoadManager":"LoadManager","../../../Core/SimpleActionEffect":"SimpleActionEffect","../../../Core/Widget":"Widget","../../../GlobalContext":"GlobalContext","../../../Util/RechargeConst":"RechargeConst","../../../Util/RechargeUtils":"RechargeUtils","../../../Util/Utils":"Utils","../../Commons/CommonProgress":"CommonProgress","../../Commons/RewardUtils":"RewardUtils","../../Item/ItemController":"ItemController","../../Item/ItemData":"ItemData","../../Item/ItemIcon":"ItemIcon","../../Role/RoleInfo":"RoleInfo","../../Role/RoleStrengthen/RoleStrengthenController":"RoleStrengthenController","../../Role/RoleStrengthen/RoleStrengthenEvent":"RoleStrengthenEvent","../../Sound/SoundController":"SoundController","../../Tips/OpTipsController":"OpTipsController","../../Tips/TipsWinController":"TipsWinController","../../WarTeam/MonsterController":"MonsterController","../EquipTypeNode":"EquipTypeNode","../EquipWin":"EquipWin","./EquipCtrl":"EquipCtrl"}],StringUtil:[function(e,t,i){"use strict";cc._RF.push(t,"287ceFDCDFG3YZr/WVTBqsb","StringUtil"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(){}return e.substitute=function(e,t){for(var i=t.length,n=0;n<i;n++)e=e.replace(new RegExp("\\{"+n+"\\}","g"),t[n]);return e},e.substring=function(e,t){return e.length>t?e.substring(0,t)+"...":e},e}();i.default=n,cc._RF.pop()},{}],SweepingItem:[function(e,t,i){"use strict";cc._RF.push(t,"c328aranRtObbGp982+zQq2","SweepingItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../Commons/RewardUtils"),a=e("../Item/ItemIcon"),r=e("../../NetConnect/NetConnet"),s=e("./ChapterController"),l=e("../../Core/Language"),c=e("./ChapterScouring"),d=e("../../Util/Utils"),p=e("../../Util/RechargeUtils"),h=e("../../Core/GameEventDispatcher"),u=e("../../GlobalContext"),f=e("../../Core/LoadManager"),g=e("../../Util/RechargeConst"),y=e("../Tips/TipsWinController"),m=cc._decorator,C=m.ccclass,v=m.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fixContent=null,t.randomContent=null,t.timeLabe=null,t.physical=null,t.sweep=null,t.reset=null,t.title=null,t}return __extends(t,e),t.prototype.Info=function(e,t,i,n,r,s){var l=this;this.currChapterID=s,this.title.string=r,this.timeLabe.string=i,this.physical.string=n,d.default.setNodeChildDestoryByUrl(this.fixContent,u.GlobalContext.Root+"prefab/Bag/ItemIcon"),d.default.setNodeChildDestoryByUrl(this.randomContent,u.GlobalContext.Root+"prefab/Bag/ItemIcon"),f.default.instance.loadResByType(u.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(i){var n=o.default.instance.getItemList(e.rewardID);for(var r in n){(c=d.default.getNodeByUrl(i,u.GlobalContext.Root+"prefab/Bag/ItemIcon")).getComponent(a.default).ItemData(n[r],!0,null,!0),l.fixContent.addChild(c)}var s=o.default.instance.getItemList(t.randreward);for(var r in s){var c;(c=d.default.getNodeByUrl(i,u.GlobalContext.Root+"prefab/Bag/ItemIcon")).getComponent(a.default).ItemData(s[r],!0,null,!0),l.randomContent.addChild(c)}},this),this.InitTimes()},t.prototype.ClickSweep=function(){h.GameEventDispatcher.instance.emit("CHAPTERNOTENTER",this);var e=c.default.instance.conf.SweepingConfig[1].energy;p.default.PurchaseItemOrRechage(g.RechargeTypeConst.Prop,e,this.sweepingSend,this,o.RewardType.Energy)},t.prototype.sweepingSend=function(){var e={cmd:"startsweeping",chapter:this.currChapterID};r.default.instance.sendProto(e),this.InitTimes()},t.prototype.ClickReset=function(){var e=this,t=s.default.instance.resetTimes>=10?c.default.instance.conf.reset[10].diamond:c.default.instance.conf.reset[s.default.instance.resetTimes+1].diamond;y.default.instance.ShowTips(l.default.getStr("\u662f\u5426\u6d88\u8017{0}\u94bb\u77f3\u91cd\u7f6e\u626b\u8361",t),function(){p.default.PurchaseItemOrRechage(g.RechargeTypeConst.Diamonds,t,function(){var t={cmd:"resetsweeping",chapter:e.currChapterID};r.default.instance.sendProto(t),e.InitTimes()})})},t.prototype.InitTimes=function(){var e=this;this.scheduleOnce(function(){if(null!=s.default.instance.sweepChapterTimes&&s.default.instance.sweepChapterTimes[e.currChapterID-1]?e.timeLabe.string=3-s.default.instance.sweepChapterTimes[e.currChapterID-1]+"":e.timeLabe.string="3",s.default.instance.sweepChapterTimes[e.currChapterID-1]&&3-s.default.instance.sweepChapterTimes[e.currChapterID-1]<=0){var t=s.default.instance.resetTimes>=10?c.default.instance.conf.reset[10].diamond:c.default.instance.conf.reset[s.default.instance.resetTimes+1].diamond;e.reset.children[0].getComponentInChildren(cc.Label).string="X"+t,e.reset.active=!0,e.sweep.active=!1}else e.reset.active=!1,e.sweep.active=!0},0)},__decorate([v(cc.Node)],t.prototype,"fixContent",void 0),__decorate([v(cc.Node)],t.prototype,"randomContent",void 0),__decorate([v(cc.Label)],t.prototype,"timeLabe",void 0),__decorate([v(cc.Label)],t.prototype,"physical",void 0),__decorate([v(cc.Node)],t.prototype,"sweep",void 0),__decorate([v(cc.Node)],t.prototype,"reset",void 0),__decorate([v(cc.Label)],t.prototype,"title",void 0),t=__decorate([C],t)}(n.default);i.default=_,cc._RF.pop()},{"../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/Widget":"Widget","../../GlobalContext":"GlobalContext","../../NetConnect/NetConnet":"NetConnet","../../Util/RechargeConst":"RechargeConst","../../Util/RechargeUtils":"RechargeUtils","../../Util/Utils":"Utils","../Commons/RewardUtils":"RewardUtils","../Item/ItemIcon":"ItemIcon","../Tips/TipsWinController":"TipsWinController","./ChapterController":"ChapterController","./ChapterScouring":"ChapterScouring"}],SyntheticCard:[function(e,t,i){"use strict";cc._RF.push(t,"16a48HF3HlO45zQYC9dk48o","SyntheticCard"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Core/CommonsResManager"),a=e("./SyntheticCtrl"),r=e("../../WarTeam/MonsterController"),s=e("../../../Util/Utils"),l=e("../../../Core/WindowType"),c=cc._decorator,d=c.ccclass,p=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cardBG=null,t.cardimg=null,t.Model=null,t.imgNode=null,t.cardLevel=null,t.quality=null,t.type=null,t.cardAtlas=null,t.img=null,t.attributeImg=null,t}return __extends(t,e),t.prototype.setData=function(e){if(e>5){var t=a.default.instance.data.getCardPieceId(e),i=r.default.instance.data.getCardIdByItemId(t),n=r.default.instance.GetMonsterData(i.id);this.cardBG.spriteFrame=this.cardAtlas.getSpriteFrame("di_"+i.rarity),this.cardimg.spriteFrame=this.cardAtlas.getSpriteFrame("di_0"+i.rarity),this.quality.spriteFrame=o.default.instance.getSpriteFrameByName("rarity_"+i.rarity),this.type.spriteFrame=o.default.instance.getSpriteFrameByName("stance_"+i.cardType),this.attributeImg.spriteFrame=o.default.instance.getSpriteFrameByName("series"+i.fiveLineAttributes),this.attributeImg.node.active=!0,this.cardLevel.string=n?n.level.toString():"0";var c=r.default.instance.getIsMonsterCard(i.id);this.img.node.active=!c,this.Model.childrenCount&&s.default.setNodeToPool(l.PoolType.MonsterPreview,this.Model.children[0]),r.default.instance.infoPreview(this.Model,cc.v2(0,0),i.id,5,.4,-1,!0)}else this.cardBG.spriteFrame=this.cardAtlas.getSpriteFrame("di_"+(7-e)),this.cardimg.spriteFrame=this.cardAtlas.getSpriteFrame("di_0"+(7-e)),this.cardLevel.string="0",this.quality.spriteFrame=o.default.instance.getSpriteFrameByName("rarity_"+(7-e)),this.img.node.active=!1,this.attributeImg.node.active=!1;this.Model.active=e>5,this.imgNode.active=e<=5,this.type.node.active=e>5},__decorate([p(cc.Sprite)],t.prototype,"cardBG",void 0),__decorate([p(cc.Sprite)],t.prototype,"cardimg",void 0),__decorate([p(cc.Node)],t.prototype,"Model",void 0),__decorate([p(cc.Node)],t.prototype,"imgNode",void 0),__decorate([p(cc.Label)],t.prototype,"cardLevel",void 0),__decorate([p(cc.Sprite)],t.prototype,"quality",void 0),__decorate([p(cc.Sprite)],t.prototype,"type",void 0),__decorate([p(cc.SpriteAtlas)],t.prototype,"cardAtlas",void 0),__decorate([p(cc.Sprite)],t.prototype,"img",void 0),__decorate([p(cc.Sprite)],t.prototype,"attributeImg",void 0),t=__decorate([d],t)}(n.default);i.default=h,cc._RF.pop()},{"../../../Core/CommonsResManager":"CommonsResManager","../../../Core/Widget":"Widget","../../../Core/WindowType":"WindowType","../../../Util/Utils":"Utils","../../WarTeam/MonsterController":"MonsterController","./SyntheticCtrl":"SyntheticCtrl"}],SyntheticCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"7a1af/TSZ5EDrxdbiZG6oJt","SyntheticCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Controller"),o=e("./SyntheticData"),a=e("../../../Core/Event"),r=e("../../../NetConnect/NetConnet"),s=e("../../../Core/GameEventDispatcher"),l=cc._decorator,c=l.ccclass,d=(l.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._data=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},Object.defineProperty(t.prototype,"data",{get:function(){return this._data||(this._data=new o.default),this._data},enumerable:!0,configurable:!0}),t.prototype.listNotification=function(){this.addProto(a.EventDefiner.synthetic,this.resSynthetic,this),this.addProto(a.EventDefiner.rewardpanel,this.resReward,this)},t.prototype.resSynthetic=function(e){this.data.setData(e.data),s.GameEventDispatcher.instance.emit(a.EventDefiner.synthetic_Up)},t.prototype.reqItemsynthetic=function(e,t){var i={cmd:"itemsynthetic",id:e,count:t};r.default.instance.sendProto(i)},t.prototype.resReward=function(e){111==e.paneltype&&s.GameEventDispatcher.instance.emit(a.EventDefiner.Synthetic_Reward,{reward:e.reward})},t.instance=null,t=i=__decorate([c],t)}(n.default));i.default=d,cc._RF.pop()},{"../../../Core/Controller":"Controller","../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../NetConnect/NetConnet":"NetConnet","./SyntheticData":"SyntheticData"}],SyntheticData:[function(e,t,i){"use strict";cc._RF.push(t,"c219aOqA+REA4s6tjLTELmj","SyntheticData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/ConfigsManager"),o=e("../../WarTeam/MonsterController"),a=e("../../Functionicon/FunctionIconController"),r=function(){function e(){this._cfg=null,this._data=null}return Object.defineProperty(e.prototype,"cfg",{get:function(){return this._cfg||(this._cfg=n.ConfigsManager.instance.getConfigs("syntheticConf")),this._cfg},enumerable:!0,configurable:!0}),e.prototype.getCfgData=function(e){var t=[],i=[],n=[],a=[];for(var r in this.cfg.syntheticConf)if(e){if(!this.cfg.syntheticConf[r].pieceId)continue;var s=o.default.instance.data.getCardIdByItemId(this.cfg.syntheticConf[r].pieceId);if(!s||s.cardType!=e)continue;this.setCfgData(n,a,this.cfg.syntheticConf[r],parseInt(r))}else parseInt(r)<=5?this.setCfgData(t,i,this.cfg.syntheticConf[r],parseInt(r)):this.setCfgData(n,a,this.cfg.syntheticConf[r],parseInt(r));return t.concat(i,n,a)},e.prototype.setCfgData=function(e,t,i,n){this.getUnlockFlag(n)?e.push({cfg:i,id:n}):t.push({cfg:i,id:n})},e.prototype.getCardPieceId=function(e){return this.cfg.syntheticConf[e].pieceId},e.prototype.getCfgMaxNum=function(e){var t=null;return e&&this.cfg.syntheticConf[e].times>0&&(t=this.cfg.syntheticConf[e].times),t},e.prototype.maxNum=function(e){var t=null;return e&&this.cfg.syntheticConf[e].times>0&&(t=this.cfg.syntheticConf[e].times,t-=this.getNum(e)),t},e.prototype.getConsumeCfg=function(e){var t=null;if(e){var i=this.cfg.syntheticConf[e].needItem?this.cfg.syntheticConf[e].needItem:null;i>=0&&this.cfg.needItem[i]&&(t=this.cfg.needItem[i])}return t},e.prototype.setData=function(e){this._data=e},e.prototype.getNum=function(e){return e&&this._data[e]?this._data[e]:0},e.prototype.getChapter=function(e){return this.cfg.syntheticConf[e].chapter},e.prototype.getGuanqia=function(e){return this.cfg.syntheticConf[e].guanqia},e.prototype.getUnlockFlag=function(e){if(!e)return!1;if(e<=5){if(o.default.instance.data.getRarityFlag(7-e))return!0}else{var t=this.getCardPieceId(e),i=o.default.instance.data.getCardIdByItemId(t).id;if(o.default.instance.getIsMonsterCard(i))return!0}var n=this.cfg.syntheticConf[e].chapter,r=this.cfg.syntheticConf[e].guanqia;return!!a.default.instance.checkIsPass(n,r)},e}();i.default=r,cc._RF.pop()},{"../../../Core/ConfigsManager":"ConfigsManager","../../Functionicon/FunctionIconController":"FunctionIconController","../../WarTeam/MonsterController":"MonsterController"}],SyntheticItem:[function(e,t,i){"use strict";cc._RF.push(t,"c00c5/MG8ROCZFxEKj8cN86","SyntheticItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../Item/ItemIcon"),a=e("../../Item/ItemData"),r=e("../../../Core/CommonsResManager"),s=e("../../../Util/Utils"),l=e("./SyntheticCtrl"),c=e("../../../Core/Language"),d=e("../../Tips/OpTipsController"),p=cc._decorator,h=p.ccclass,u=(p.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._data=null,t._selectedCallback=null,t._selectedCallbackObj=null,t._selectedID=null,t._tipsTextFlag=!1,t}return __extends(t,e),t.prototype.setData=function(e,t,i){this._data=e,this._selectedCallback=t,this._selectedCallbackObj=i;var n=!!e,c=!1;if(n){if(c=e.id<=5){var d=r.default.instance.getSpriteFrameByName("rarity_"+(7-e.id));this.node.getChildByName("cardimg").getChildByName("img").getComponent(cc.Sprite).spriteFrame=d,this.node.getChildByName("cardimg").getComponent(cc.Sprite).spriteFrame=r.default.instance.getSpriteFrameByName("bag"+(6-e.id))}else{var p=a.default.creatItem(e.cfg.pieceId);this.node.getChildByName("ItemIcon").getComponent(o.default).ItemData(p)}s.default.setGrayEffect(this.node,l.default.instance.data.getUnlockFlag(this._data.id))}this.node.getChildByName("cardimg").active=n&&c,this.node.getChildByName("ItemIcon").active=n&&!c,this.node.getChildByName("bg").active=!n,this.node.getChildByName("Choose").active=this._data&&this._data.id==this._selectedID,this._tipsTextFlag=!1},t.prototype.setSelected=function(e){this._selectedID=e,this.node.getChildByName("Choose").active=this._data&&this._data.id==this._selectedID},t.prototype.getID=function(){return this._data.id},t.prototype.onClick=function(e){if(this._data){e.currentTarget;if(this._selectedCallback&&this._selectedCallback.call(this._selectedCallbackObj,this._data.id),!l.default.instance.data.getUnlockFlag(this._data.id)&&!this._tipsTextFlag){var t=l.default.instance.data.getChapter(this._data.id),i=l.default.instance.data.getGuanqia(this._data.id);d.default.instance.ShowMsg(c.default.getStr("Synthetic_13",t,i))}}},t=__decorate([h],t)}(n.default));i.default=u,cc._RF.pop()},{"../../../Core/CommonsResManager":"CommonsResManager","../../../Core/Language":"Language","../../../Core/Widget":"Widget","../../../Util/Utils":"Utils","../../Item/ItemData":"ItemData","../../Item/ItemIcon":"ItemIcon","../../Tips/OpTipsController":"OpTipsController","./SyntheticCtrl":"SyntheticCtrl"}],SyntheticView:[function(e,t,i){"use strict";cc._RF.push(t,"ed09dz7z2FI3IPlLpwB8FP2","SyntheticView"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../TagBtn"),o=e("../../../Core/Widget"),a=e("../../../Util/Utils"),r=e("./SyntheticCtrl"),s=e("../../Commons/ListViewCtrl"),l=e("./SyntheticItem"),c=e("../../../Core/Language"),d=e("./SyntheticCard"),p=e("../../WarTeam/MonsterController"),h=e("../../Commons/RewardUtils"),u=e("../../Item/ItemIcon"),f=e("../../../Core/GameEventDispatcher"),g=e("../../../Core/Event"),y=e("../../Role/RoleController"),m=e("../../../Global/GlobalValue"),C=e("../../Tips/OpTipsController"),v=e("../../OpenWin/OpenWinController"),_=e("../../../Core/WindowType"),b=e("../../../Util/RechargeUtils"),T=e("../../../Util/RechargeConst"),S=e("../../Tips/TipsWinController"),I=e("../../Commons/Spine"),w=e("../../../Core/TimeController"),D=e("../../Tips/RewardTips"),R=e("../../Guide/GuideNewController"),A=cc._decorator,N=A.ccclass,L=A.property,E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.TagScrollView=null,t.tagBtn=null,t.TagScrollViewTwo=null,t.tagBtnTwo=null,t.leftNode=null,t.editBox=null,t.rightNode=null,t._tagIndex=null,t._tagIndexTwo=null,t._tagName=["\u5361\u724c"],t._tagNameTwo=["\u5168\u90e8","\u524d\u6392","\u4e2d\u6392","\u540e\u6392"],t._dataId=null,t._num=0,t._falg=!1,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),this._num=1,this.setTagList(),f.GameEventDispatcher.instance.on(g.EventDefiner.synthetic_Up,this.upShow,this),f.GameEventDispatcher.instance.on(g.EventDefiner.Synthetic_Reward,this.syntheticReward,this)},t.prototype.hide=function(){e.prototype.hide.call(this),this._tagIndex=null,this._tagIndexTwo=null,this._dataId=null,this._num=0,f.GameEventDispatcher.instance.off(g.EventDefiner.synthetic_Up,this.upShow,this),f.GameEventDispatcher.instance.on(g.EventDefiner.synthetic_Up,this.upShow,this)},t.prototype.setTagList=function(){var e=this.TagScrollView.content;for(var t in e.children)e.children[t].active=!1;for(var t in this._tagName){if(!e.children[t]){var i=cc.instantiate(this.tagBtn);e.addChild(i)}e.children[t].active=!0,e.children[t].getComponent(n.default).setData(this._tagName[t],this.onClickTag,this,!0)}for(var t in e.children)e.children[t].getComponent(n.default).setSelectedFlag(0==parseInt(t));this.onClickTag(0)},t.prototype.setTagListTwo=function(){var e=this.TagScrollViewTwo.content;for(var t in e.children)e.children[t].active=!1;for(var t in this._tagNameTwo){if(!e.children[t]){var i=cc.instantiate(this.tagBtnTwo);e.addChild(i)}e.children[t].active=!0,e.children[t].getComponent(n.default).setData(this._tagNameTwo[t],this.onClickTagTwo,this)}for(var t in e.children)e.children[t].getComponent(n.default).setSelectedFlag(0==parseInt(t));this.onClickTagTwo(0)},t.prototype.onClickTag=function(e){this._tagIndex=e,this.setTagListTwo()},t.prototype.onClickTagTwo=function(e){this._tagIndexTwo=e,this._falg=!0,this.upShow()},t.prototype.upShow=function(){this.setRightShow(),this.setLeftshow()},t.prototype.setLeftshow=function(){this.setCardItemShow();var e=this.leftNode.getChildByName("LabelNode");e.getChildByName("Label").getComponent(cc.Label).string=this.getTextNmae(),e.getChildByName("num").getComponent(cc.Label).string=c.default.getStr("6004",this._num?this._num:0),e.active=!!this._dataId,this.setMaterial();var t=r.default.instance.data.maxNum(this._dataId),i="";i=null==t?c.default.getStr("Synthetic_08"):c.default.getStr("Synthetic_01",t>0?t:0,r.default.instance.data.getCfgMaxNum(this._dataId)),this.leftNode.getChildByName("RichText").getComponent(cc.RichText).string=i,this.leftNode.getChildByName("RichText").active=null!=this._dataId,this.editBox.string=null!=t&&t<this._num?"1":this._num.toString(),this.leftNode.getChildByName("btn_synthesis").getComponent(cc.Button).interactable=r.default.instance.data.getUnlockFlag(this._dataId)},t.prototype.getTextNmae=function(){var e="";if(this._dataId){switch(this._dataId){case 1:e=c.default.getStr("Synthetic_06");break;case 2:e=c.default.getStr("Synthetic_05");break;case 3:e=c.default.getStr("Synthetic_04");break;case 4:e=c.default.getStr("Synthetic_03");break;case 5:e=c.default.getStr("Synthetic_02");break;default:var t=r.default.instance.data.getCardPieceId(this._dataId);e=p.default.instance.data.getCardIdByItemId(t).cardName}e+=c.default.getStr("Synthetic_07")}return e},t.prototype.setCardItemShow=function(){var e=!!this._dataId,t=this.node.getChildByName("left").getChildByName("cardItem");t.active=e,e&&t.getComponent(d.default).setData(this._dataId)},t.prototype.setMaterial=function(){var e=r.default.instance.data.getConsumeCfg(this._dataId),t=this.leftNode.getChildByName("materialList");if(!e||e.length<=0)t.active=!1;else{t.active=!0;var i=h.default.instance.getItemListByServerData(e);if(t.childrenCount>=i.length)for(var n in t.children)e[n]?(t.children[n].active=!0,i[n].count*=this._num,t.children[n].getComponent(u.default).ItemData(i[n],!0,null,!0)):t.children[n].active=!1;else for(var n in i){if(!t.children[n]){var o=cc.instantiate(this.leftNode.getChildByName("ItemIcon"));o.active=!0,t.addChild(o)}i[n].count*=this._num,t.children[n].getComponent(u.default).ItemData(i[n],!0,null,!0)}}},t.prototype.setRightShow=function(){var e=r.default.instance.data.getCfgData(this._tagIndexTwo);if(e.length<25)for(var t=e.length;t<25;++t)e.push(null);var i=this.node.getChildByName("right").getChildByName("ListViewCtrl");if(i.getComponent(s.default).refreshItem=this.updateitem,i.getComponent(s.default).refreshItemThis=this,i.getComponent(s.default).initialize(e),i.getComponent(s.default).scrollToTop(),null==this._dataId||this._falg){this._falg=!1;var n=i.getComponent(s.default).scrollView.content;this._dataId=n.children[0].getComponent(l.default).getID(),this.setSelectedItem()}},t.prototype.updateitem=function(e,t){var i=this.node.getChildByName("right").getChildByName("ListViewCtrl").getComponent(s.default).dataLsit;if(e.getComponent(l.default).setData(i[t],this.onClickItem,this),i[t]){e.name="item"+i[t].id;var n=!1;if(r.default.instance.data.getUnlockFlag(i[t].id)){var o=r.default.instance.data.maxNum(i[t].id);n=null==o||0!=o}a.default.setGrayEffect(e,n,!0)}else a.default.setGrayEffect(e,!0)},t.prototype.setSelectedItem=function(){var e=this.node.getChildByName("right").getChildByName("ListViewCtrl").getComponent(s.default).scrollView.content;for(var t in e.children)e.children[t].getComponent(l.default).setSelected(this._dataId)},t.prototype.onClickMinus=function(){if(this._dataId){var e=r.default.instance.data.maxNum(this._dataId);null!=e&&0==e&&C.default.instance.ShowMsg(c.default.getStr("Synthetic_09")),this._num=this._num-1<=0?1:this._num-1,this.upShow()}},t.prototype.onClickAdd=function(){if(this._dataId){var e=r.default.instance.data.maxNum(this._dataId);null!=e&&this._num+1>e?(C.default.instance.ShowMsg(c.default.getStr("Synthetic_09")),this._num=e):this._num+=1,this.upShow()}},t.prototype.onEditingDidEnded=function(){var e=Number(this.editBox.string);isNaN(e)&&(e=1,this.editBox.string=e.toString());var t=r.default.instance.data.maxNum(this._dataId);null!=t?(e>t&&(e=t,C.default.instance.ShowMsg(c.default.getStr("Synthetic_09"))),e<=0&&(e=1),this._num=e):this._num=e,this._num<=0&&(this._num=1),this.upShow()},t.prototype.onClickItem=function(e){if(e){this._dataId=e,this.setSelectedItem();var t=r.default.instance.data.maxNum(this._dataId);null!=t&&0==t&&C.default.instance.ShowMsg(c.default.getStr("Synthetic_09")),this._num=1}this.setLeftshow()},t.prototype.onClickSynthesis=function(){if(this._dataId&&!(this._num<=0)&&r.default.instance.data.getUnlockFlag(this._dataId)){var e=r.default.instance.data.getConsumeCfg(this._dataId),t=h.default.instance.getItemListByServerData(e);for(var i in t){var n=!1;if(1==t[i].id?n=y.default.instance.CheckMyWealthIsEnough(m.WealthType.Money,t[i].count*this._num,!1):11902==t[i].id&&(n=y.default.instance.CheckMyWealthIsEnough(m.WealthType.SoulCard,t[i].count*this._num,!1)),!n)return void b.default.PurchaseItemOrRechage(T.RechargeTypeConst.Prop,t[i].count*this._num,null,this,t[i].id)}var o=c.default.getStr("Synthetic_12"),a=S.default.instance.keyList[o];R.default.instance.isGuide||a?r.default.instance.reqItemsynthetic(this._dataId,this._num):this.setBoxShow()}},t.prototype.setBoxShow=function(){var e=this,t=c.default.getStr("Synthetic_12");S.default.instance.ShowTips(t,function(){r.default.instance.reqItemsynthetic(e._dataId,e._num)},this,null,1,null,null,null,null,null,!1,!1,!0)},t.prototype.syntheticReward=function(e){var t=e.getUserData();this.playEffect();var i=w.default.instance.setTimeout(function(){i&&w.default.instance.clearTimeout(i),v.default.instance.openWindow(_.WindowType.RewardTips,function(){D.default.instance.setData(h.default.instance.getItemListByServerData(t.reward))})},this,50)},t.prototype.playEffect=function(){this.leftNode.getChildByName("effect").active=!0,this.leftNode.getChildByName("effect").getComponent(I.default).changeAction("default","animation",!1)},__decorate([L(cc.ScrollView)],t.prototype,"TagScrollView",void 0),__decorate([L(cc.Node)],t.prototype,"tagBtn",void 0),__decorate([L(cc.ScrollView)],t.prototype,"TagScrollViewTwo",void 0),__decorate([L(cc.Node)],t.prototype,"tagBtnTwo",void 0),__decorate([L(cc.Node)],t.prototype,"leftNode",void 0),__decorate([L(cc.EditBox)],t.prototype,"editBox",void 0),__decorate([L(cc.Node)],t.prototype,"rightNode",void 0),t=__decorate([N],t)}(o.default);i.default=E,cc._RF.pop()},{"../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Core/TimeController":"TimeController","../../../Core/Widget":"Widget","../../../Core/WindowType":"WindowType","../../../Global/GlobalValue":"GlobalValue","../../../Util/RechargeConst":"RechargeConst","../../../Util/RechargeUtils":"RechargeUtils","../../../Util/Utils":"Utils","../../Commons/ListViewCtrl":"ListViewCtrl","../../Commons/RewardUtils":"RewardUtils","../../Commons/Spine":"Spine","../../Guide/GuideNewController":"GuideNewController","../../Item/ItemIcon":"ItemIcon","../../OpenWin/OpenWinController":"OpenWinController","../../Role/RoleController":"RoleController","../../Tips/OpTipsController":"OpTipsController","../../Tips/RewardTips":"RewardTips","../../Tips/TipsWinController":"TipsWinController","../../WarTeam/MonsterController":"MonsterController","../TagBtn":"TagBtn","./SyntheticCard":"SyntheticCard","./SyntheticCtrl":"SyntheticCtrl","./SyntheticItem":"SyntheticItem"}],TabBtnList:[function(e,t,i){"use strict";cc._RF.push(t,"5c6c4QJCjdMF4oiogO13uef","TabBtnList"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/TimeController"),a=cc._decorator,r=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.TabBtnItem=null,t.List=null,t.ListContainer=null,t.ListContainer1=null,t.TabBtnNames=[],t.TabViews=[],t.selectedIndex=0,t.selectedCallback=null,t.selectedCallbackThisObj=null,t.conditionCallback=null,t.conditionCallbackThisObj=null,t._delaySelectedIndexTime=0,t.flag=!1,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.addList(),this.selectItem(0)},t.prototype.hide=function(){e.prototype.hide.call(this),this.flag=!1,clearTimeout(this._delaySelectedIndexTime),this._delaySelectedIndexTime=0},t.prototype.addList=function(){if(this.ListContainer.removeAllChildren(),this.ListContainer1&&this.ListContainer1.removeAllChildren(),this.TabBtnNames.length>0)for(var e=0;e<this.TabBtnNames.length;e++){var t=cc.instantiate(this.TabBtnItem);t.active=!0,this.ListContainer.addChild(t),t.name="TabBtn"+e;var i=t.getChildByName("TabBtn1").getChildByName("Label").getComponent(cc.Label);i.string=this.TabBtnNames[e],(i=t.getChildByName("TabBtn2").getChildByName("Label").getComponent(cc.Label)).string=this.TabBtnNames[e];var n=cc.instantiate(t);this.ListContainer1&&(n.getChildByName("TabBtn2").destroy(),this.ListContainer1.addChild(n))}},t.prototype.itemClick=function(e){if(e.type==cc.Node.EventType.TOUCH_END){var t=e.currentTarget.parent.getSiblingIndex();this.selectItem(t)}},t.prototype.selectItemSetRed=function(e,t){this.ListContainer.childrenCount&&(this.ListContainer.children[e].getChildByName("red").active=t,this.ListContainer1.children[e].getChildByName("red").active=t)},t.prototype.selectItem=function(e){var t=this;this.conditionCallback&&!this.conditionCallback.call(this.conditionCallbackThisObj,e)||(this.selectedIndex=e,0==this._delaySelectedIndexTime&&(this._delaySelectedIndexTime=o.default.instance.setTimeout(function(){for(var e=0;e<t.ListContainer.childrenCount;e++){var i=t.ListContainer.children[e],n=t.ListContainer1?t.ListContainer1.children[e]:i;t.selectedIndex==e?(i.getChildByName("TabBtn1").active=!0,n.getChildByName("TabBtn1").active=!0,i.getChildByName("TabBtn2").active=!1,t.TabViews[e]&&(t.TabViews[e].active=!0)):(i.getChildByName("TabBtn1").active=!1,n.getChildByName("TabBtn1").active=!1,i.getChildByName("TabBtn2").active=!0,t.TabViews[e]&&(t.TabViews[e].active=!1)),t.setTabIcon(e,t.flag,i)}t.selectedCallback&&t.selectedCallback.call(t.selectedCallbackThisObj,t.selectedIndex),o.default.instance.clearTimeout(t._delaySelectedIndexTime),t._delaySelectedIndexTime=0},this,50)))},t.prototype.setTabIcon=function(e,t,i){void 0===t&&(t=!1),1==t&&this.TabBtnItem.getChildByName("TabIcon").getComponent("TabIcon").setTabIcon(e,i)},__decorate([s(cc.Node)],t.prototype,"TabBtnItem",void 0),__decorate([s(cc.Node)],t.prototype,"List",void 0),__decorate([s(cc.Node)],t.prototype,"ListContainer",void 0),__decorate([s(cc.Node)],t.prototype,"ListContainer1",void 0),__decorate([s([cc.String])],t.prototype,"TabBtnNames",void 0),__decorate([s([cc.Node])],t.prototype,"TabViews",void 0),t=__decorate([r],t)}(n.default);i.default=l,cc._RF.pop()},{"../../Core/TimeController":"TimeController","../../Core/Widget":"Widget"}],TabBtnSubList:[function(e,t,i){"use strict";cc._RF.push(t,"39fe8r7ELZEr6Qjs79pYvQR","TabBtnSubList"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../Shop/TabIcon"),a=e("../../Core/TimeController"),r=cc._decorator,s=r.ccclass,l=r.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.TabBtnItem=null,t.TabSubBtnItem=null,t.List=null,t.ListContainer=null,t.ListContainer1=null,t.TabBtnNames=[],t.TabViews=[],t.selectedIndex=0,t.subselectedIndex=0,t.selectedCallback=null,t.selectedCallbackThisObj=null,t.subselectedCallback=null,t.subselectedCallbackThisObj=null,t._delaySelectedIndexTime=0,t._delaySelectedIndexTime1=0,t.subData=null,t.flag=!1,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this),this.addList(),this.selectItem(0)},t.prototype.setSubData=function(e){this.subData=e},t.prototype.show=function(){e.prototype.show.call(this),this.TabBtnItem.on(cc.Node.EventType.TOUCH_START,this.itemClick,this)},t.prototype.hide=function(){e.prototype.hide.call(this),this.flag=!1,clearTimeout(this._delaySelectedIndexTime),this._delaySelectedIndexTime=0,this.TabBtnItem.off(cc.Node.EventType.TOUCH_START,this.itemClick,this)},t.prototype.addList=function(){if(this.ListContainer.removeAllChildren(),this.ListContainer1&&this.ListContainer1.removeAllChildren(),this.TabBtnNames.length>0)for(var e=0;e<this.TabBtnNames.length;e++){var t=cc.instantiate(this.TabBtnItem);t.active=!0,this.ListContainer.addChild(t),t.name=this.TabBtnNames[e];var i=t.children[0].getChildByName("TabBtn1").getChildByName("Label").getComponent(cc.Label);i.string=this.TabBtnNames[e],(i=t.children[0].getChildByName("TabBtn2").getChildByName("Label").getComponent(cc.Label)).string=this.TabBtnNames[e];var n=cc.instantiate(t);this.ListContainer1&&(n.children[0].getChildByName("TabBtn2").destroy(),this.ListContainer1.addChild(n))}this.addSubList()},t.prototype.addSubList=function(){for(var e=1;e<=this.TabBtnNames.length;e++){var t=this.ListContainer.children[e],i=this.subData[e];if(i)for(var n=0;n<i.length;n++){var o=cc.instantiate(this.TabSubBtnItem);o.active=!0,t.getChildByName("TabList").addChild(o),o.children[0].children[0].getComponent(cc.Label).string=i[n],o.children[1].children[0].getComponent(cc.Label).string=i[n],o.children[0].getComponent(cc.Button).clickEvents[0].target=this.node,o.children[0].getComponent(cc.Button).clickEvents[0].component="TabBtnSubList",o.children[0].getComponent(cc.Button).clickEvents[0].handler="subItemClick"}}},t.prototype.subItemClick=function(e){var t=e.currentTarget.parent.getSiblingIndex();this.selecsubtItem(t)},t.prototype.selecsubtItem=function(e){var t=this;this.subselectedIndex=e,0==this._delaySelectedIndexTime1&&(this._delaySelectedIndexTime1=a.default.instance.setTimeout(function(){for(var i=0;i<t.ListContainer.children[t.selectedIndex].children[1].childrenCount;i++){var n=t.ListContainer.children[t.selectedIndex].children[1].children[i];e==i?(n.getChildByName("TabBtn1").active=!0,n.getChildByName("TabBtn2").active=!1):(n.getChildByName("TabBtn1").active=!1,n.getChildByName("TabBtn2").active=!0)}t.subselectedCallback&&t.subselectedCallback.call(t.subselectedCallbackThisObj,t.subselectedIndex),a.default.instance.clearTimeout(t._delaySelectedIndexTime1),t._delaySelectedIndexTime1=0},this,50))},t.prototype.itemClick=function(e){var t=e.currentTarget.parent.parent.getSiblingIndex();this.selectItem(t)},t.prototype.chooseClick=function(e){var t=e.currentTarget.parent.parent.getSiblingIndex(),i=this.ListContainer.children[t].getChildByName("TabList");i&&i.childrenCount&&(i.active=!i.active)},t.prototype.selectItem=function(e){var t=this;this.selectedIndex=e,0==this._delaySelectedIndexTime&&(this._delaySelectedIndexTime=a.default.instance.setTimeout(function(){for(var e=0;e<t.ListContainer.childrenCount;e++){var i=t.ListContainer.children[e],n=t.ListContainer1?t.ListContainer1.children[e]:i;t.selectedIndex==e?(i.children[0].getChildByName("TabBtn1").active=!0,n.children[0].getChildByName("TabBtn1").active=!0,i.children[0].getChildByName("TabBtn2").active=!1,t.selecsubtItem(0),t.ListContainer.children[e].children[1].active=!0,t.ListContainer.getComponent(cc.Layout).updateLayout(),t.ListContainer.children[e].children[1].getComponent(cc.Layout).updateLayout(),t.TabViews[e]&&(t.TabViews[e].active=!0)):(i.children[0].getChildByName("TabBtn1").active=!1,n.children[0].getChildByName("TabBtn1").active=!1,i.children[0].getChildByName("TabBtn2").active=!0,t.TabViews[e]&&(t.TabViews[e].active=!1),t.ListContainer.children[e].children[1].active=!1,t.ListContainer.getComponent(cc.Layout).updateLayout(),t.ListContainer.children[e].children[1].getComponent(cc.Layout).updateLayout()),t.setTabIcon(e,t.flag,i.children[0])}t.selectedCallback&&t.selectedCallback.call(t.selectedCallbackThisObj,t.selectedIndex),a.default.instance.clearTimeout(t._delaySelectedIndexTime),t._delaySelectedIndexTime=0},this,50))},t.prototype.setTabIcon=function(e,t,i){void 0===t&&(t=!1),1==t&&this.TabBtnItem.children[0].getChildByName("TabIcon").getComponent(o.default).setTabIcon(e,i)},__decorate([l(cc.Node)],t.prototype,"TabBtnItem",void 0),__decorate([l(cc.Prefab)],t.prototype,"TabSubBtnItem",void 0),__decorate([l(cc.Node)],t.prototype,"List",void 0),__decorate([l(cc.Node)],t.prototype,"ListContainer",void 0),__decorate([l(cc.Node)],t.prototype,"ListContainer1",void 0),__decorate([l([cc.String])],t.prototype,"TabBtnNames",void 0),__decorate([l([cc.Node])],t.prototype,"TabViews",void 0),t=__decorate([s],t)}(n.default);i.default=c,cc._RF.pop()},{"../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../Shop/TabIcon":"TabIcon"}],TabIcon:[function(e,t,i){"use strict";cc._RF.push(t,"f223e4PHoFEHqW+RQoYhyDB","TabIcon"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("./ShopController"),a=cc._decorator,r=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.spritAtlas=null,t.tabIcon=null,t}return __extends(t,e),t.prototype.setTabIcon=function(e,t){var i=t.getChildByName("TabBtn1").active?2:1;this.tabIcon=t.getChildByName("TabIcon").getComponent(cc.Sprite);var n=o.default.instance.sortIndex[e];this.tabIcon.spriteFrame=this.spritAtlas.getSpriteFrame("BtnIcon_"+n+i)},t.prototype.start=function(){e.prototype.start.call(this)},__decorate([s(cc.SpriteAtlas)],t.prototype,"spritAtlas",void 0),t=__decorate([r],t)}(n.default);i.default=l,cc._RF.pop()},{"../../Core/Widget":"Widget","./ShopController":"ShopController"}],TabList:[function(e,t,i){"use strict";cc._RF.push(t,"d7b12Lea5lEGIKCTGz3lH7t","TabList"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("./AchievementController"),a=e("./AchievementWin"),r=e("../../Core/GameEventDispatcher"),s=e("../../Core/Event"),l=e("../Functionicon/FunctionIconController"),c=e("../../Core/WindowType"),d=e("../../Core/TimeController"),p=cc._decorator,h=p.ccclass,u=p.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.TabBtnItem=null,t.List=null,t.ListContainer=null,t.TabBtnLayer=null,t.TabBtnNames=[],t.TabViews=[],t.selectedIndex=0,t.subselectedIndex=0,t.selectedCallback=null,t.selectedCallbackThisObj=null,t.subselectedCallback=null,t.subselectedCallbackThisObj=null,t._delaySelectedIndexTime=0,t._delaySelectedIndexTime1=0,t.flag=!1,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this),this.addList(),this.selectItem(0)},t.prototype.show=function(){e.prototype.show.call(this),r.GameEventDispatcher.instance.on(s.EventDefiner.SetProgress,this.checkRedDot,this)},t.prototype.hide=function(){e.prototype.hide.call(this),this.flag=!1,clearTimeout(this._delaySelectedIndexTime),this.ListContainer.setPosition(0,225),this._delaySelectedIndexTime=0,this._delaySelectedIndexTime1=0,r.GameEventDispatcher.instance.off(s.EventDefiner.SetProgress,this.checkRedDot,this)},t.prototype.addList=function(){var e=0;this.ListContainer.destroyAllChildren();var t=a.default.instance.achievementData;if(this.TabBtnNames.length>0){for(var i=0;i<this.TabBtnNames.length;i++){var n=cc.instantiate(this.TabBtnLayer);n.active=!0,this.ListContainer.addChild(n);var r=n.children[0].getChildByName("TabBtn1").getChildByName("Label").getComponent(cc.Label);for(var s in r.string=this.TabBtnNames[i],(r=n.children[0].getChildByName("TabBtn2").getChildByName("Label").getComponent(cc.Label)).string=this.TabBtnNames[i],o.default.instance.array){if(o.default.instance.array[s].type&&e++,o.default.instance.array[s].type==this.TabBtnNames[i]){n.children[0].getChildByName("redPoint").active=!0;break}n.children[0].getChildByName("redPoint").active=!1}for(var l in n.children[0].getChildByName("TabBtn2").getComponent(cc.Button).clickEvents[0].target=this.List,n.children[0].getChildByName("TabBtn2").getComponent(cc.Button).clickEvents[0].component="TabList",n.children[0].getChildByName("TabBtn2").getComponent(cc.Button).clickEvents[0].handler="itemClick",n.children[0].getChildByName("TabBtn1").getComponent(cc.Button).clickEvents[0].target=this.List,n.children[0].getChildByName("TabBtn1").getComponent(cc.Button).clickEvents[0].component="TabList",n.children[0].getChildByName("TabBtn1").getComponent(cc.Button).clickEvents[0].handler="itemClick",t.subtypeconf)if(t.subtypeconf[l].Type==i){var c=cc.instantiate(this.TabBtnItem);for(var s in c.active=!0,n.children[1].addChild(c),c.children[0].children[0].getComponent(cc.Label).string=t.subtypeconf[l].Name,c.children[1].children[0].getComponent(cc.Label).string=t.subtypeconf[l].Name,o.default.instance.array){if(o.default.instance.array[s].subtype==t.subtypeconf[l].Name){c.children[2].active=!0;break}c.children[2].active=!1}c.children[0].getComponent(cc.Button).clickEvents[0].target=this.List,c.children[0].getComponent(cc.Button).clickEvents[0].component="TabList",c.children[0].getComponent(cc.Button).clickEvents[0].handler="subItemClick"}n.children[1].childrenCount>0?n.children[0].getChildByName("Indicator").active=!0:n.children[0].getChildByName("Indicator").active=!1}this.ListContainer.children[0].children[0].children[3].active=e>0}},t.prototype.itemClick=function(e){var t=e.currentTarget.parent.parent.getSiblingIndex();this.selectItem(t)},t.prototype.subItemClick=function(e){var t=e.currentTarget.parent.getSiblingIndex();this.selecsubtItem(t)},t.prototype.selectItem=function(e){var t=this;this.selectedIndex=e,0==this._delaySelectedIndexTime&&(this._delaySelectedIndexTime=d.default.instance.setTimeout(function(){for(var e=0;e<t.ListContainer.childrenCount;e++){var i=t.ListContainer.children[e].children[0],n=t.ListContainer.children[e].children[1];if(t.selectedIndex==e){if(n.childrenCount>0&&n.active)return i.getChildByName("TabBtn1").active=!1,i.getChildByName("TabBtn2").active=!0,i.getChildByName("Indicator").rotation=-90,t.ListContainer.children[e].children[1].active=!1,d.default.instance.clearTimeout(t._delaySelectedIndexTime),void(t._delaySelectedIndexTime=0);i.getChildByName("TabBtn1").active=!0,i.getChildByName("TabBtn2").active=!1,i.getChildByName("Indicator").rotation=0,t.ListContainer.children[e].children[1].active=!0,t.ListContainer.getComponent(cc.Layout).updateLayout(),t.ListContainer.children[e].children[1].getComponent(cc.Layout).updateLayout(),t.selecsubtItem(0)}else i.getChildByName("TabBtn1").active=!1,i.getChildByName("TabBtn2").active=!0,n.childrenCount>0&&(i.getChildByName("Indicator").rotation=-90),t.ListContainer.children[e].children[1].active=!1,t.ListContainer.getComponent(cc.Layout).updateLayout(),t.ListContainer.children[e].children[1].getComponent(cc.Layout).updateLayout()}t.selectedCallback&&t.selectedCallback.call(t.selectedCallbackThisObj,t.selectedIndex),d.default.instance.clearTimeout(t._delaySelectedIndexTime),t._delaySelectedIndexTime=0},this,50))},t.prototype.selecsubtItem=function(e){var t=this;this.subselectedIndex=e,0==this._delaySelectedIndexTime1&&(this._delaySelectedIndexTime1=d.default.instance.setTimeout(function(){for(var i=0;i<t.ListContainer.children[t.selectedIndex].children[1].childrenCount;i++){var n=t.ListContainer.children[t.selectedIndex].children[1].children[i];e==i?(n.getChildByName("TabBtn1").active=!0,n.getChildByName("TabBtn2").active=!1):(n.getChildByName("TabBtn1").active=!1,n.getChildByName("TabBtn2").active=!0)}t.subselectedCallback&&t.subselectedCallback.call(t.subselectedCallbackThisObj,t.subselectedIndex),d.default.instance.clearTimeout(t._delaySelectedIndexTime1),t._delaySelectedIndexTime1=0},this,50))},t.prototype.checkRedDot=function(){for(var e=0,t=0;t<this.ListContainer.childrenCount;t++){var i=this.ListContainer.children[t].children[0].children[0].children[0].getComponent(cc.Label).string,n=this.ListContainer.children[t].children[1];if(o.default.instance.array)for(var a in o.default.instance.array){if(o.default.instance.array[a].type&&e++,o.default.instance.array[a].type==i){this.ListContainer.children[t].children[0].children[3].active=!0;break}this.ListContainer.children[t].children[0].children[3].active=!1}else this.ListContainer.children[t].children[0].children[3].active=!1;if(n.childrenCount>0)for(var r=0;r<n.childrenCount;r++)for(var a in o.default.instance.array)if(o.default.instance.array){if(n.children[r].children[0].children[0].getComponent(cc.Label).string==o.default.instance.array[a].subtype){n.children[r].children[2].active=!0;break}n.children[r].children[2].active=!1}else n.children[r].children[2].active=!1}e>0?(this.ListContainer.children[0].children[0].children[3].active=!0,l.default.instance.FuncIconRedDeal(c.WindowType.Achievement,!0)):(this.ListContainer.children[0].children[0].children[3].active=!1,l.default.instance.FuncIconRedDeal(c.WindowType.Achievement,!1))},__decorate([u(cc.Prefab)],t.prototype,"TabBtnItem",void 0),__decorate([u(cc.Node)],t.prototype,"List",void 0),__decorate([u(cc.Node)],t.prototype,"ListContainer",void 0),__decorate([u(cc.Prefab)],t.prototype,"TabBtnLayer",void 0),__decorate([u([cc.String])],t.prototype,"TabBtnNames",void 0),__decorate([u([cc.Node])],t.prototype,"TabViews",void 0),t=__decorate([h],t)}(n.default);i.default=f,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../Functionicon/FunctionIconController":"FunctionIconController","./AchievementController":"AchievementController","./AchievementWin":"AchievementWin"}],TagBtn:[function(e,t,i){"use strict";cc._RF.push(t,"e2c94a16bVIr5mnW4niGmAI","TagBtn"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=cc._decorator,a=o.ccclass,r=o.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.img=null,t.clickImg=null,t.tagName=null,t._selectedCallback=null,t._selectedCallbackObj=null,t._colorFlag=null,t}var i;return __extends(t,e),i=t,t.prototype.setData=function(e,t,i,n){void 0===n&&(n=!1),this.tagName.string=e,this._selectedCallback=t,this._selectedCallbackObj=i,this._colorFlag=n,this.setSelectedFlag()},t.prototype.setTagName=function(e){this.tagName.string=e},t.prototype.setSelectedFlag=function(e){void 0===e&&(e=!1),this.node.getComponent(cc.Sprite).spriteFrame=e?this.clickImg:this.img,this._colorFlag?this.tagName.node.color=e?new cc.Color(255,255,255):new cc.Color(40,54,90):this.tagName.node.color=new cc.Color(104,45,9)},t.prototype.setRed=function(e){this.node.getChildByName("red")&&(this.node.getChildByName("red").active=e)},t.prototype.onClickBtn=function(e){if(e.type==cc.Node.EventType.TOUCH_END){var t=e.currentTarget,i=t.getSiblingIndex();this.selectItem(t.parent,i),this._selectedCallback&&this._selectedCallback.call(this._selectedCallbackObj,i)}},t.prototype.selectItem=function(e,t){for(var n in e.children)e.children[n].getComponent(i).setSelectedFlag(t==parseInt(n))},__decorate([r(cc.SpriteFrame)],t.prototype,"img",void 0),__decorate([r(cc.SpriteFrame)],t.prototype,"clickImg",void 0),__decorate([r(cc.Label)],t.prototype,"tagName",void 0),t=i=__decorate([a],t)}(n.default);i.default=s,cc._RF.pop()},{"../../Core/Widget":"Widget"}],TaskTip:[function(e,t,i){"use strict";cc._RF.push(t,"8295f0j7ThHKIUjpwDnTNYx","TaskTip"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("./DailyData"),a=e("./Dailycontroller"),r=e("../../NetConnect/NetConnet"),s=e("../OpenWin/OpenWinController"),l=e("../../Core/GameEventDispatcher"),c=e("../../Core/Event"),d=e("../../Core/WindowType"),p=e("../Sports/SportsWindow"),h=e("../Status/StatusType"),u=e("../Chapter/ChapterController"),f=e("../../Core/CommonsResManager"),g=e("../Functionicon/FunctionIconController"),y=e("../Tips/RewardTips"),m=e("../Commons/RewardUtils"),C=e("../Commons/WindowOpenUtils"),v=e("../Scene/Manager/SceneManager"),_=e("../../GlobalContext"),b=e("../Scene/Controller/SceneController"),T=e("../../Global/GlobalValue"),S=e("../Guide/GuideNewController"),I=e("../Scene/Pool/SpinePools"),w=e("../../Core/SpineBase"),D=e("../Status/StatusController"),R=e("../WarTeam/MonsterController"),A=e("../WarTeam/WarTeamMonsterInfo"),N=cc._decorator,L=N.ccclass,E=N.property,B=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.getButton=null,t.iconAtlas=null,t.icon=null,t.nameLabe=null,t.guideLayer=null,t.windowID=null,t.index=0,t.id=null,t.reward=0,t.progressNum=null,t.currTask=null,t.isFrist=!0,t.currTaskTimes=0,t.effect=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),l.GameEventDispatcher.instance.on("PROGRESSBAR",this.Init,this)},t.prototype.show=function(){e.prototype.show.call(this),i.instance=this,this.dailyData=new o.default,this.sportsWindow=new p.default,l.GameEventDispatcher.instance.on(c.EventDefiner.CheckDailyGuide,this.checkGuide,this),l.GameEventDispatcher.instance.on(c.EventDefiner.WindowCloselink,this.closeWindow,this),l.GameEventDispatcher.instance.on(c.EventDefiner.CurGuideComplete,this.closeWindow,this),l.GameEventDispatcher.instance.on(c.EventDefiner.CurGuideStart,this.closeWindow,this),this.isFrist&&(this.Init(null),this.isFrist=!1),this.closeWindow()},t.prototype.hide=function(){e.prototype.hide.call(this),l.GameEventDispatcher.instance.off(c.EventDefiner.CheckDailyGuide,this.checkGuide,this),l.GameEventDispatcher.instance.off(c.EventDefiner.WindowCloselink,this.closeWindow,this),l.GameEventDispatcher.instance.off(c.EventDefiner.CurGuideComplete,this.closeWindow,this),l.GameEventDispatcher.instance.off(c.EventDefiner.CurGuideStart,this.closeWindow,this)},t.prototype.Init=function(e){var t=g.default.instance,i=a.default.instance.dailyArry;if(t.checkIsOpenbyWindowtype(d.WindowType.DailyQusest))if(0==this.task())if(a.default.instance.skipBool&&this.currTask&&(i[this.currTask-1]&&i[this.currTask-1][0].count<=this.currTaskTimes||!i[this.currTask-1])){var n=this.currTask+1>Object.keys(this.dailyData.config).length?1:this.currTask+1;if(this.currTask+1>Object.keys(this.dailyData.config).length)this.OtherTask(),this.currTask=1;else{for(i[this.currTask-1]&&(this.dailyData.initid(this.currTask),this.currTaskTimes=this.dailyData.time,this.progressNum=" ("+i[this.currTask-1][0].count+" / "+this.currTaskTimes+" )",i[this.currTask-1][0].count>=this.currTaskTimes&&!i[this.currTask-1][0].flag&&(n=this.currTask));n<=Object.keys(this.dailyData.config).length;n++){if(this.dailyData.initid(n),this.currTaskTimes=this.dailyData.time,r=u.default.instance.currentChapterId+1>this.dailyData.chapter||g.default.instance.checkIsPass(this.dailyData.chapter-1,this.dailyData.checkpoint-1)){if(r&&(i[n-1]&&!i[n-1][0].flag||!i[n-1]))break;if(n+1>Object.keys(this.dailyData.config).length&&i[n-1]&&i[n-1][0].flag)return this.OtherTask(),n=1,void(this.currTask=n)}else if(n+1>Object.keys(this.dailyData.config).length)return this.OtherTask(),n=1,void(this.currTask=n)}this.nameLabe.string=this.dailyData.taskName,this.getButton.node.active=!1,this.currTask=n,i[n-1]?(this.progressNum=" ("+i[n-1][0].count+" / "+this.currTaskTimes+" )",i[n-1][0].count>=this.currTaskTimes&&!i[n-1][0].flag&&(this.getButton.node.active=!0,this.currTask=this.currTask-1,this.id=n-1)):this.progressNum=" ( 0 / "+this.dailyData.time+" )",this.label.string=this.dailyData.taskDetails+this.progressNum,this.windowID=this.dailyData.windowstype,this.reward=this.dailyData.reward,this.icon.spriteFrame=f.default.instance.getSpriteFrameByName("task_main_icon_"+this.dailyData.clientType)}}else for(var o in this.dailyData.config){var r,s=Number(o)-1;if(this.dailyData.initid(Number(o)),this.currTaskTimes=this.dailyData.time,r=u.default.instance.currentChapterId+1>this.dailyData.chapter||g.default.instance.checkIsPass(this.dailyData.chapter-1,this.dailyData.checkpoint-1)){if(this.windowID=this.dailyData.windowstype,this.reward=this.dailyData.reward,this.icon.spriteFrame=f.default.instance.getSpriteFrameByName("task_main_icon_"+this.dailyData.clientType),this.id=s,this.nameLabe.string=this.dailyData.taskName,null==i[s]){this.getButton.node.active=!1,this.progressNum=" ( 0 / "+this.dailyData.time+" )",this.label.string=this.dailyData.taskDetails+this.progressNum,this.currTask=Number(o);break}for(var l=0;l<i[s].length;l++){if(this.progressNum=" ("+i[s][l].count+" / "+this.dailyData.goals[l]+" )",this.label.string=this.dailyData.taskDetails+this.progressNum,i[s][l].count>=this.currTaskTimes&&!i[s][l].flag)return this.getButton.node.active=!0,void(this.index=l);if(i[s][l].count<=this.dailyData.goals[l]&&!i[s][l].flag)return this.getButton.node.active=!1,void(this.currTask=Number(o))}}}else this.OtherTask();else this.OtherTask();e||(a.default.instance.skipBool=!1)},t.prototype.goBtnEvent=function(){if(null!=this.windowID){if(a.default.instance.skipBool=!0,!g.default.instance.checkIsOpenbyWindowtype(this.windowID,!0))return;l.GameEventDispatcher.instance.emit("CLOSEWINDOW",this),this.windowID==d.WindowType.CardInfo?s.default.instance.openWindow(d.WindowType.WarTeam,function(){R.default.instance.openMonsterInfoPrefab(R.MonsterType.MonsterWarTeam[R.MonsterType.MonsterBattle][0],A.CardTag.upgrade,null,null,!1)}):C.default.instance.openWindowType(this.windowID)}},t.prototype.getBtnEvent=function(){var e=this,t={cmd:"taskreward",id:this.id,index:this.index};r.default.instance.sendProto(t),s.default.instance.openWindow(d.WindowType.RewardTips,function(){y.default.instance.setData(m.default.instance.getItemList(e.reward))})},t.prototype.task=function(){var e=a.default.instance.dailyArry,t=[];for(var i in this.dailyData.config){this.dailyData.initid(Number(i)),(u.default.instance.currentChapterId+1>this.dailyData.chapter||g.default.instance.checkIsPass(this.dailyData.chapter-1,this.dailyData.checkpoint-1))&&t.push(this.dailyData.config[i])}for(var i in t){var n=t[i].Daily-1;if(e[n]&&!e[n][0].flag||!e[n])return!1}},t.prototype.checkGuide=function(e){var t=!1;switch(e.detail){case 1:D.default.instance.oldActivityStatus==h.ActivityStatus.Chapter?v.default.instance.fightresult&&!S.default.instance.isGuide&&(t=!0):t=!0}this.setGuideEffect(t)},t.prototype.closeWindow=function(){var e=_.PlayerData.WindowLayer.childrenCount;e<=0&&b.default.instance.scenestatus==T.GameScene.Main&&a.default.instance.skipBool&&this.Init(null),e<=0&&b.default.instance.scenestatus==T.GameScene.Main&&!S.default.instance.isGuide?this.setGuideEffect(!0):this.setGuideEffect(!1)},t.prototype.setGuideEffect=function(e){if(S.default.instance.isGuide||u.default.instance.currentChapterId>=5)this.guideLayer.active=!1;else{if(e)if(this.effect)this.effect.getComponent(w.default).play("1");else this.effect=I.SpinePools.addSpineNoder(this.guideLayer,new cc.Vec2(177,-16)),this.effect.getComponent(w.default).initSpineData(T.SPINE_RES_DIR+"effect/dailytipseffect/effect",null,"1",!0);this.guideLayer.active=e}},t.prototype.OtherTask=function(){this.nameLabe.string="\u4e3b\u7ebf\u526f\u672c",this.windowID=1,this.icon.spriteFrame=f.default.instance.getSpriteFrameByName("task_main_icon_2");var e=u.default.instance.checkGuanqiainfobyid(u.default.instance.readyPath),t=u.default.instance.getGuanqiaConfigList(e.chapter.chapterId).length;this.label.string=u.default.instance.currentAreaname+" / "+u.default.instance.currentChaptername+" ( "+u.default.instance.currentGuanqiaId+" / "+t+" )",this.getButton.node.active=!1},t.instance=null,__decorate([E(cc.Label)],t.prototype,"label",void 0),__decorate([E(cc.Button)],t.prototype,"getButton",void 0),__decorate([E(cc.SpriteAtlas)],t.prototype,"iconAtlas",void 0),__decorate([E(cc.Sprite)],t.prototype,"icon",void 0),__decorate([E(cc.Label)],t.prototype,"nameLabe",void 0),__decorate([E(cc.Node)],t.prototype,"guideLayer",void 0),t=i=__decorate([L],t)}(n.default);i.default=B,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/SpineBase":"SpineBase","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../NetConnect/NetConnet":"NetConnet","../Chapter/ChapterController":"ChapterController","../Commons/RewardUtils":"RewardUtils","../Commons/WindowOpenUtils":"WindowOpenUtils","../Functionicon/FunctionIconController":"FunctionIconController","../Guide/GuideNewController":"GuideNewController","../OpenWin/OpenWinController":"OpenWinController","../Scene/Controller/SceneController":"SceneController","../Scene/Manager/SceneManager":"SceneManager","../Scene/Pool/SpinePools":"SpinePools","../Sports/SportsWindow":"SportsWindow","../Status/StatusController":"StatusController","../Status/StatusType":"StatusType","../Tips/RewardTips":"RewardTips","../WarTeam/MonsterController":"MonsterController","../WarTeam/WarTeamMonsterInfo":"WarTeamMonsterInfo","./DailyData":"DailyData","./Dailycontroller":"Dailycontroller"}],ThundercloudEffect:[function(e,t,i){"use strict";cc._RF.push(t,"55224bebLBAOLPKtLlerCSf","ThundercloudEffect"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../SceneEntity"),o=e("../Controller/SkillController"),a=e("../Manager/SceneManager"),r=e("../Controller/FightController"),s=e("../Pool/SpinePools"),l=e("../../../Core/SpineBase"),c=e("../Controller/FightTimeController"),d=e("../Unit/FightLog"),p=e("../View/ActorsLayer"),h=e("../Controller/ServerFightController"),u=cc._decorator,f=u.ccclass,g=(u.property,function(){function e(){this._handleDic={}}var t;return t=e,Object.defineProperty(e,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),e.prototype.show=function(e,t,i){var n=o.default.instance.getSkillResultBySkillIdAndLv(t,i)[0],a=o.default.instance.GetResultConfParam(n.param,i),r={entity:e,skillid:t,skilllv:i,time:a[1],alltime:a[2],count:a[3],effect:null};this._handleDic[e.handle+t]=r,this.addThunEffect(e,t)},e.prototype.addThunEffect=function(e,t){var i=s.SpinePools.addSpineNoder(p.default.instance.node,new cc.Vec2(0,0)),n=i.getComponent(l.default),r=o.default.instance.getSkillBySkillId(this._handleDic[e.prop.handle+t].skillid),d="skin"+e.prop.grade+"_fight"+r.isHitEffect+"_b1";n.initSpineData(e.prop.getAttackEffectUrl(),null,d,!0),n.playRate=a.default.instance.fightViewPlayRate,this._handleDic[e.prop.handle+t].effect=i,c.default.instance.setInterval("ThundercloudEffect"+e.prop.handle,this.updateData,this,this._handleDic[e.prop.handle+t].time,[e.prop.handle+t])},e.prototype.updateData=function(e){if(this._handleDic[e]){var t=this._handleDic[e];t.alltime-=t.time;var i=a.default.instance.leftlives;i.length<=0&&a.default.instance.myRole&&a.default.instance.myRole.getComponent(n.default).prop.isLive&&(i=a.default.instance.leftlives.concat(a.default.instance.myRole.getComponent(n.default).prop));var o=t.entity.prop.selfMonster?a.default.instance.rightlives:i;if(d.default.log("\u89e6\u53d1\u96f7\u4e91",e,o.length,t.alltime),o.length<=0)return void this.remove(e);var s=[],l=Math.floor(h.default.instance.Random()*o.length);l+t.count>o.length&&(l=0);for(var c=Math.min(l+t.count,o.length),p=l;p<c;p++)s.push(o[p].handle);r.default.instance.actorUseSkill(t.entity.prop.handle,s,t.skillid,t.skilllv),t.alltime<=0&&this.remove(e)}},e.prototype.remove=function(e){d.default.log("\u79fb\u9664\u96f7\u4e91",e),s.SpinePools.recoverSpineNoder(this._handleDic[e].effect),delete this._handleDic[e]},e.prototype.removeAll=function(){for(var e in this._handleDic)this.remove(e)},e=t=__decorate([f],e)}());i.default=g,cc._RF.pop()},{"../../../Core/SpineBase":"SpineBase","../Controller/FightController":"FightController","../Controller/FightTimeController":"FightTimeController","../Controller/ServerFightController":"ServerFightController","../Controller/SkillController":"SkillController","../Manager/SceneManager":"SceneManager","../Pool/SpinePools":"SpinePools","../SceneEntity":"SceneEntity","../Unit/FightLog":"FightLog","../View/ActorsLayer":"ActorsLayer"}],TimeController:[function(e,t,i){"use strict";cc._RF.push(t,"94bf7UZgNpBVLFqo4mnMOYU","TimeController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./GameEventDispatcher"),o=e("./Event"),a=e("../Util/SDKUtils"),r=e("./Controller"),s=e("../NetConnect/NetConnet"),l=e("../GlobalContext"),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._ServerTimeSpace=0,t._heartIntervalTime=0,t.setTimeDic={},t.setIntervalDic={},t._sendGetTimeFailCount=0,t}return __extends(t,e),Object.defineProperty(t,"instance",{get:function(){return t._instance||(t._instance=new t,t._instance.listNotification()),t._instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){var e=this;clearInterval(this._heartIntervalTime),this._heartIntervalTime=setInterval(function(){a.default.instance.platformSdk.onlineTime(5e3),e.sendHeart(),e._sendGetTimeFailCount++,1==l.GlobalContext.GameForeground&&e._sendGetTimeFailCount>3&&1==s.default.instance.IsConnecting&&(console.log("\u6ca1\u65ad\u7ebf\uff0c\u4f46\u534f\u8bae\u6ca1\u8fc7\u6765\uff0c\u6709\u95ee\u9898\uff0c\u91cd\u8fde\u8bd5\u8bd5",l.GlobalContext.GameForeground,e._sendGetTimeFailCount,s.default.instance.IsConnecting),s.default.instance.ws&&null!=s.default.instance.reconnkey&&""!=s.default.instance.reconnkey&&(s.default.instance.ws.close(),e._sendGetTimeFailCount=0))},5e3),n.GameEventDispatcher.instance.on(o.EventDefiner.SocketConnectSuccess,this.SocketConnectSuccess,this),n.GameEventDispatcher.instance.on(o.EventDefiner.SocketConnectFail,this.SocketConnectFail,this),n.GameEventDispatcher.instance.on(o.EventDefiner.GameForegroundChange,this.GameForegroundChange,this),a.default.instance.getCurrentTimeFun=this.getServerTimeMins,a.default.instance.getCurrentTimeFunThisObj=this},t.prototype.onDestroy=function(){clearInterval(this._heartIntervalTime),n.GameEventDispatcher.instance.off(o.EventDefiner.SocketConnectSuccess,this.SocketConnectSuccess,this),n.GameEventDispatcher.instance.off(o.EventDefiner.SocketConnectFail,this.SocketConnectFail,this),n.GameEventDispatcher.instance.off(o.EventDefiner.GameForegroundChange,this.GameForegroundChange,this)},t.prototype.clear=function(){for(var e in this.onDestroy(),clearInterval(this._heartIntervalTime),this.setIntervalDic)this.setIntervalDic.hasOwnProperty(e)&&this.clearInterval(parseInt(e));for(var e in this.setTimeDic)this.setTimeDic.hasOwnProperty(e)&&this.clearTimeout(parseInt(e))},t.prototype.listNotification=function(){this.addProto("heart",this.getServerTime,this)},t.prototype.getServerTime=function(e){this._sendGetTimeFailCount=0;var t=Number(e.time);this._ServerTimeSpace=t-Date.now()},Object.defineProperty(t.prototype,"ServerTimeMins",{get:function(){return Date.now()+this._ServerTimeSpace},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ServerTime",{get:function(){return Math.floor(this.ServerTimeMins/1e3)},enumerable:!0,configurable:!0}),t.prototype.getServerTimeMins=function(){return this.ServerTimeMins},t.prototype.sendHeart=function(){1==s.default.instance.IsConnecting&&s.default.instance.sendProto({cmd:"heart"})},t.prototype.SocketConnectSuccess=function(e){this.sendHeart()},t.prototype.SocketConnectFail=function(e){},t.prototype.GameForegroundChange=function(){this._sendGetTimeFailCount=0,this.sendHeart()},t.prototype.getTimer=function(){return Date.now()},t.prototype.setTimeout=function(e,t,i){for(var n=[],o=3;o<arguments.length;o++)n[o-3]=arguments[o];var a=setTimeout(function(){e.apply(t,n)},i);return this.setTimeDic[a]=1,a},t.prototype.clearTimeout=function(e){clearTimeout(e),delete this.setTimeDic[e]},t.prototype.setInterval=function(e,t,i){for(var n=[],o=3;o<arguments.length;o++)n[o-3]=arguments[o];var a=setInterval(function(){e.apply(t,n)},i);return this.setIntervalDic[a]=1,a},t.prototype.clearInterval=function(e){clearInterval(e),delete this.setIntervalDic[e]},t._instance=null,t}(r.default);i.default=c,cc._RF.pop()},{"../GlobalContext":"GlobalContext","../NetConnect/NetConnet":"NetConnet","../Util/SDKUtils":"SDKUtils","./Controller":"Controller","./Event":"Event","./GameEventDispatcher":"GameEventDispatcher"}],TipsWinController:[function(e,t,i){"use strict";cc._RF.push(t,"62ba0XlQbdKeIaA/ESYK0PJ","TipsWinController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("./TipsWin"),a=e("../../GlobalContext"),r=cc._decorator,s=r.ccclass,l=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.keyList={},t}var i;return __extends(t,e),i=t,Object.defineProperty(t,"instance",{get:function(){return i._instance||(i._instance=new i),i._instance},enumerable:!0,configurable:!0}),t.prototype.ShowTips=function(e,t,i,n,r,s,l,c,d,p,h,u,f){void 0===t&&(t=null),void 0===i&&(i=null),void 0===n&&(n=null),void 0===r&&(r=1),void 0===s&&(s=null),void 0===l&&(l=null),void 0===c&&(c=null),void 0===d&&(d=null),void 0===p&&(p=null),void 0===h&&(h=!1),void 0===u&&(u=!1),void 0===f&&(f=!1),this.keyList[e]?t&&t.apply(i,n):(a.PlayerData.tipWinNode.active=!0,o.default.instance.ShowTips(e,t,i,n,r,s,l,c,d,p,h,u,f))},t=i=__decorate([s],t)}(n.default));i.default=l,cc._RF.pop()},{"../../Core/Controller":"Controller","../../GlobalContext":"GlobalContext","./TipsWin":"TipsWin"}],TipsWin:[function(e,t,i){"use strict";cc._RF.push(t,"43cf4ulrOBNkaVT12JYGhjm","TipsWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/TimeController"),o=e("../../Core/Widget"),a=e("../../Core/Language"),r=e("./TipsWinController"),s=cc._decorator,l=s.ccclass,c=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.InfoLabel=null,t.Type1=null,t.Type2=null,t.tips=null,t.CheckBox1=null,t.bg=null,t._ConfirmBtnClickCallback=null,t._ConfirmBtnClickCallbackThisObj=null,t._ConfirmBtnClickCallbackParam=null,t._isCloseSameConfirm=!1,t._CancelBtnClickCallback=null,t._CancelBtnClickCallbackThisObj=null,t._CancelBtnClickCallbackParam=null,t.cd=6,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){i.instance=this},t.prototype.show=function(){e.prototype.show.call(this),this.cd=5},t.prototype.ShowTips=function(e,t,i,o,a,r,s,l,c,d,p,h,u){void 0===t&&(t=null),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=1),void 0===r&&(r=null),void 0===s&&(s=null),void 0===l&&(l=null),void 0===c&&(c=null),void 0===d&&(d=null),void 0===p&&(p=!1),void 0===h&&(h=!1),void 0===u&&(u=!1),r=r||"\u786e\u5b9a",s=s||"\u53d6\u6d88",this.InfoLabel.string=e,this._ConfirmBtnClickCallback=t,this._ConfirmBtnClickCallbackThisObj=i,this._ConfirmBtnClickCallbackParam=o,this._CancelBtnClickCallback=l,this._CancelBtnClickCallbackThisObj=c,this._CancelBtnClickCallbackParam=d,this.Type1.active=!1,this.Type2.active=!1,this.CheckBox1&&(this.CheckBox1.isChecked=!1,this.CheckBox1.node.active=u),this._isCloseSameConfirm=p,1==a?(this.Type1.active=!0,this.Type1.getChildByName("ConfirmBtn").getChildByName("Label").getComponent(cc.Label).string=r,this.Type1.getChildByName("CancelBtn").getChildByName("Label").getComponent(cc.Label).string=s):2==a&&(this.Type2.active=!0,this.Type2.getChildByName("ConfirmBtn").getChildByName("Label").getComponent(cc.Label).string=r),this.Type1.y=this.Type2.y=u?-124:-82,this.tips.node.y=u?-214:-170,this.tips.node.active=h,this.bg&&(this.bg.height=u?334:290),!this.time&&h&&(this.setOverTime(),this.time=n.default.instance.setInterval(this.setOverTime,this,1e3))},t.prototype.hide=function(){e.prototype.hide.call(this),this.colseTime()},t.prototype.setOverTime=function(){this.cd--,this.cd<=0&&this.CancelBtnClick(),this.tips.string=a.default.getStr("3628",this.cd)},t.prototype.onCloseWindow=function(e){void 0===e&&(e=!0),this.node.active=!1},t.prototype.colseTime=function(){this.time&&(n.default.instance.clearInterval(this.time),this.time=null)},t.prototype.onClickClose=function(){this._isCloseSameConfirm?this.ConfirmBtnClick():this.CancelBtnClick()},t.prototype.ConfirmBtnClick=function(){var e=this;this.onCloseWindow(!1);var t=n.default.instance.setTimeout(function(){e._ConfirmBtnClickCallback&&e._ConfirmBtnClickCallback.apply(e._ConfirmBtnClickCallbackThisObj,e._ConfirmBtnClickCallbackParam),e._ConfirmBtnClickCallback=null,e._ConfirmBtnClickCallbackThisObj=null,e._ConfirmBtnClickCallbackParam=null,n.default.instance.clearTimeout(t)},this,100)},t.prototype.CancelBtnClick=function(){var e=this;this.onCloseWindow();var t=n.default.instance.setTimeout(function(){e._CancelBtnClickCallback&&e._CancelBtnClickCallback.apply(e._CancelBtnClickCallbackThisObj,e._CancelBtnClickCallbackParam),e._CancelBtnClickCallback=null,e._CancelBtnClickCallbackThisObj=null,e._CancelBtnClickCallbackParam=null,n.default.instance.clearTimeout(t)},this,100)},t.prototype.onToggle=function(){r.default.instance.keyList[this.InfoLabel.string]=this.CheckBox1.isChecked},t.instance=null,__decorate([c(cc.RichText)],t.prototype,"InfoLabel",void 0),__decorate([c(cc.Node)],t.prototype,"Type1",void 0),__decorate([c(cc.Node)],t.prototype,"Type2",void 0),__decorate([c(cc.Label)],t.prototype,"tips",void 0),__decorate([c(cc.Toggle)],t.prototype,"CheckBox1",void 0),__decorate([c(cc.Node)],t.prototype,"bg",void 0),t=i=__decorate([l],t)}(o.default);i.default=d,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","./TipsWinController":"TipsWinController"}],Tips:[function(e,t,i){"use strict";cc._RF.push(t,"b3f48s8QlZBjbAc/dqHeOos","Tips"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../Item/ItemData"),a=e("../Item/ItemIcon"),r=e("../../Util/Utils"),s=e("../../GlobalContext"),l=e("../../Core/LoadManager"),c=cc._decorator,d=c.ccclass,p=c.property,h=function(e){function t(){var t=e.call(this)||this;return t.content=null,t.colseBtn=null,t.rewardID=null,t.rewardNum=null,i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.show=function(){e.prototype.show.call(this),this.node.active=!0},t.prototype.hide=function(){e.prototype.hide.call(this),this.node.active=!1},t.prototype.setRewardID=function(e){this.rewardID=e},t.prototype.setRewardNum=function(e){this.rewardNum=e},t.prototype.creatReward=function(){var e=this;r.default.setNodeChildDestoryByUrl(this.content,s.GlobalContext.Root+"prefab/Bag/ItemIcon"),l.default.instance.loadResByType(s.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(t){var i=r.default.getNodeByUrl(t,s.GlobalContext.Root+"prefab/Bag/ItemIcon");e.content.addChild(i);var n=o.default.creatItem(e.rewardID,e.rewardNum);i.getComponent(a.default).ItemData(n,!0)},this)},t.instance=null,__decorate([p(cc.Node)],t.prototype,"content",void 0),__decorate([p(cc.Button)],t.prototype,"colseBtn",void 0),t=i=__decorate([d],t)}(n.default);i.default=h,cc._RF.pop()},{"../../Core/LoadManager":"LoadManager","../../Core/Widget":"Widget","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Item/ItemData":"ItemData","../Item/ItemIcon":"ItemIcon"}],TopUpInfo:[function(e,t,i){"use strict";cc._RF.push(t,"233e8a4JyVMqKQqQ6l31NcW","TopUpInfo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Util/SDKUtils"),a=e("../../Core/WindowManager"),r=e("../../Core/WindowType"),s=e("./DiamondInfo"),l=e("../../Core/GameEventDispatcher"),c=e("../../Core/Event"),d=e("./ShopController"),p=e("../../Core/LoadManager"),h=e("../../GlobalContext"),u=e("../../Util/Utils"),f=e("../ActivityView/ActivityCtrl"),g=cc._decorator,y=g.ccclass,m=g.property,C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Times=null,t.Number=null,t.Present=null,t.BtnLable=null,t.Icon=null,t.Icons=null,t.PresentNode=null,t.effectNode=null,t.position=[[new cc.Vec2(-31.4,26.4),new cc.Vec2(12.8,47)],[new cc.Vec2(20.3,-29.5)],[new cc.Vec2(21.4,30.2)],[new cc.Vec2(-22.5,-10),new cc.Vec2(-52,-17.7),new cc.Vec2(-17.7,-31)],[new cc.Vec2(19.1,42.3)],[new cc.Vec2(20.6,-28),new cc.Vec2(-7,-27)],[new cc.Vec2(21.3,15.8),new cc.Vec2(-16.2,18)],[new cc.Vec2(25.4,22.4)],[new cc.Vec2(24.6,29.8),new cc.Vec2(-11.5,27.2),new cc.Vec2(-49.8,4)]],t.conf=null,t.id=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),l.GameEventDispatcher.instance.on(c.EventDefiner.TopUpFlag,this.checkHot,this)},t.prototype.hide=function(){e.prototype.hide.call(this),l.GameEventDispatcher.instance.off(c.EventDefiner.TopUpFlag,this.checkHot,this)},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.checkHot=function(){var e=f.default.instance.data.getOpenDay();d.default.instance.diamondData&&this.id&&(d.default.instance.diamondData[this.id]||e>7?(this.conf.times=1,this.Times.active=!1,this.PresentNode.active=!1):(this.conf.times=0,this.Times.active=!0,this.PresentNode.active=!0))},t.prototype.initDiamond=function(e,t){var i=this;this.conf=e,this.id=t,this.Present.string=e.present+"",this.BtnLable.string=e.btnlabel,this.Number.string=e.diamond+"",this.Icon.spriteFrame=this.Icons.getSpriteFrame(e.icon);var n=f.default.instance.data.getOpenDay();0!=e.times||n>7?(this.Times.active=!1,this.PresentNode.active=!1):(this.Times.active=!0,this.PresentNode.active=!0),p.default.instance.loadResByType(h.GlobalContext.Root+"effects/prefabs/Shop/star",cc.Prefab,function(e){for(var n in u.default.setNodeChildDestoryByUrl(i.effectNode,h.GlobalContext.Root+"effects/prefabs/Shop/star"),i.position[t]){var o=u.default.getNodeByUrl(e,h.GlobalContext.Root+"effects/prefabs/Shop/star");o.position=i.position[t][n],i.effectNode.addChild(o)}},this)},t.prototype.purchaseBtn=function(){var e=this;o.default.instance.isInitWX?"ios"==qq.getSystemInfoSync().platform?a.default.instance.open(r.WindowType.DiamondInfo,function(){s.default.instance.initDiamondInfo(e.conf,"1",e.id),console.log("ios")},this):a.default.instance.open(r.WindowType.DiamondInfo,function(){s.default.instance.initDiamondInfo(e.conf,"2",e.id),console.log("others")},this):a.default.instance.open(r.WindowType.DiamondInfo,function(){s.default.instance.initDiamondInfo(e.conf,"2",e.id)},this)},__decorate([m(cc.Node)],t.prototype,"Times",void 0),__decorate([m(cc.Label)],t.prototype,"Number",void 0),__decorate([m(cc.Label)],t.prototype,"Present",void 0),__decorate([m(cc.Label)],t.prototype,"BtnLable",void 0),__decorate([m(cc.Sprite)],t.prototype,"Icon",void 0),__decorate([m(cc.SpriteAtlas)],t.prototype,"Icons",void 0),__decorate([m(cc.Node)],t.prototype,"PresentNode",void 0),__decorate([m(cc.Node)],t.prototype,"effectNode",void 0),t=__decorate([y],t)}(n.default);i.default=C,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/LoadManager":"LoadManager","../../Core/Widget":"Widget","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/SDKUtils":"SDKUtils","../../Util/Utils":"Utils","../ActivityView/ActivityCtrl":"ActivityCtrl","./DiamondInfo":"DiamondInfo","./ShopController":"ShopController"}],TopupNode:[function(e,t,i){"use strict";cc._RF.push(t,"b67105ekKVPYqM+UhaQiHUd","TopupNode"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/ConfigsManager"),o=e("../../Util/SDKUtils"),a=e("../../Core/Widget"),r=e("../../NetConnect/NetConnet"),s=e("../Tips/OpTipsController"),l=e("../../Core/Language"),c=e("../../GlobalContext"),d=cc._decorator,p=d.ccclass,h=d.property,u=function(e){function t(){var t=e.call(this)||this;return t.ShopTitle=null,t.Description=null,t.TopUpBtn=null,t.Number=null,t.Present=null,t.Price=null,t.Icon=null,t.Icons=null,t.PurchasesBtn=null,t.Hot=null,t.PresentNode=null,t.Warning=null,t.conf=null,t.data=null,t.index=null,t.id=null,t.userId=null,i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this),console.log(this.conf)},t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.hide=function(){e.prototype.hide.call(this)},t.prototype.initDiamondInfo=function(e,t,i,o,a){if(void 0===o&&(o=null),void 0===a&&(a=null),null!=o&&(this.userId=o,console.log(this.userId)),this.id=i,this.conf=n.ConfigsManager.instance.getConfigs("diamondshopconf").Type,this.data=e,this.index=t,this.PurchasesBtn.interactable="4"!=t,this.ShopTitle.string=this.conf[t].title,"3"==t||"4"==t){var r=this.conf[t].description+a+this.conf[t].description2;this.Description.string=r,this.Warning.active=!0,this.Warning.getComponent(cc.Label).string=this.conf[t].description3}else this.Description.string=this.conf[t].description,this.Warning.active=!1;this.TopUpBtn.string=this.conf[t].btnlabel,this.Number.string=e.diamond,this.Icon.spriteFrame=this.Icons.getSpriteFrame(e.icon),this.Present.string=e.present,this.Price.string=e.btnlabel,0!=e.times||"3"==t||"4"==t?(this.Hot.active=!1,this.PresentNode.active=!1):(this.Hot.active=!0,this.PresentNode.active=!0)},t.prototype.close=function(){this.node.active=!1},t.prototype.purchaseBtn=function(){var e=this;if(1==o.default.instance.isInitWX)if("1"==this.index){var t="help="+this.id+"&"+("topupinfo="+JSON.stringify(this.data))+"&"+("name="+c.PlayerData.userInfo.nickname);o.default.instance.shareAppMessage(function(){console.log("\u5206\u4eab\u6210\u529f"),e.node.active=!1},this,t,null,null,"\u597d\u53cb\u5145\u503c\u94fe\u63a5")}else"2"==this.index?o.default.instance.rechargeByIndex(parseInt(this.id),function(t){t&&s.default.instance.ShowMsg(l.default.getStr("\u5145\u503c\u6210\u529f")),e.node.active=!1},this):"3"==this.index&&o.default.instance.rechargeByIndex(parseInt(this.id),function(t){t&&s.default.instance.ShowMsg(l.default.getStr("\u5145\u503c\u6210\u529f")),e.node.active=!1},this);else o.default.instance.rechargeByIndex(this.data.price,function(){var t={cmd:"gm",type:"diamondshop",param:[Number(e.id)]};console.log("\u53d1\u9001\u534f\u8bae3",t),r.default.instance.sendProto(t),s.default.instance.ShowMsg(l.default.getStr("\u5145\u503c\u6210\u529f")),e.close()},this)},t.instance=null,__decorate([h(cc.Label)],t.prototype,"ShopTitle",void 0),__decorate([h(cc.Label)],t.prototype,"Description",void 0),__decorate([h(cc.Label)],t.prototype,"TopUpBtn",void 0),__decorate([h(cc.Label)],t.prototype,"Number",void 0),__decorate([h(cc.Label)],t.prototype,"Present",void 0),__decorate([h(cc.Label)],t.prototype,"Price",void 0),__decorate([h(cc.Sprite)],t.prototype,"Icon",void 0),__decorate([h(cc.SpriteAtlas)],t.prototype,"Icons",void 0),__decorate([h(cc.Button)],t.prototype,"PurchasesBtn",void 0),__decorate([h(cc.Node)],t.prototype,"Hot",void 0),__decorate([h(cc.Node)],t.prototype,"PresentNode",void 0),__decorate([h(cc.Node)],t.prototype,"Warning",void 0),t=i=__decorate([p],t)}(a.default);i.default=u,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Language":"Language","../../Core/Widget":"Widget","../../GlobalContext":"GlobalContext","../../NetConnect/NetConnet":"NetConnet","../../Util/SDKUtils":"SDKUtils","../Tips/OpTipsController":"OpTipsController"}],TotemsAdvancedItem:[function(e,t,i){"use strict";cc._RF.push(t,"2ffd37cGGNLLZjYiOU9Prsw","TotemsAdvancedItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/Language"),a=e("../Item/ItemController"),r=e("../Item/ItemData"),s=e("../Commons/Image"),l=e("../../Util/NumberUtil"),c=e("../../Core/CommonsResManager"),d=e("../../Util/Utils"),p=e("../../GlobalContext"),h=cc._decorator,u=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.icon=null,t.itemColor=null,t.count=null,t.effect=null,t.Iteminfo=null,t.num=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),this.effect.on("finished",this.hideEffect,this),this.effect.node.active=!1},t.prototype.hideEffect=function(){this.effect.node.active=!1},t.prototype.hide=function(){e.prototype.hide.call(this),this.effect.off("finished",this.hideEffect,this)},t.prototype.updateData=function(e){this.num=a.default.instance.getItemNum(e.id);var t=this.num<e.count?"ff0000":"00ff00",i=l.NumberUtil.getNumber(this.num);this.count.string=o.default.getStr("5513",t,i,e.count);var n=r.default.creatItem(e.id,this.num);this.ItemData(n)},t.prototype.ItemData=function(e){this.Iteminfo=e;var t=p.GlobalContext.ResRoot+"resources/itemicon/"+e.ItemIcon+".png";d.default.setImage(this.icon.node,t),this.itemColor.spriteFrame=c.default.instance.getSpriteFrameByName("bag"+e.colorIndex)},t.prototype.setItemIcon=function(){},t.prototype.playEffect=function(){this.effect.node.active=!0,this.effect.play()},t.prototype.onClickOpenItemTipsWin=function(){a.default.instance.openItemTips(this.Iteminfo)},__decorate([f(s.default)],t.prototype,"icon",void 0),__decorate([f(cc.Sprite)],t.prototype,"itemColor",void 0),__decorate([f(cc.RichText)],t.prototype,"count",void 0),__decorate([f(cc.Animation)],t.prototype,"effect",void 0),t=__decorate([u],t)}(n.default);i.default=g,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Language":"Language","../../Core/Widget":"Widget","../../GlobalContext":"GlobalContext","../../Util/NumberUtil":"NumberUtil","../../Util/Utils":"Utils","../Commons/Image":"Image","../Item/ItemController":"ItemController","../Item/ItemData":"ItemData"}],TotemsAttrItem:[function(e,t,i){"use strict";cc._RF.push(t,"06edebei/tKWYp85RfD9jil","TotemsAttrItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Util/AttrUtil"),a=cc._decorator,r=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.attrIcons=null,t.icon=null,t.attrName=null,t.attrNum=null,t}return __extends(t,e),t.prototype.initData=function(e){var t=o.default.getAttrIconID(e);this.icon.spriteFrame=this.attrIcons.getSpriteFrame("attrIcon_"+t),this.attrName.string=o.default.getAttrName(e)},t.prototype.updateData=function(e){this.attrNum.string=e+""},__decorate([s(cc.SpriteAtlas)],t.prototype,"attrIcons",void 0),__decorate([s(cc.Sprite)],t.prototype,"icon",void 0),__decorate([s(cc.Label)],t.prototype,"attrName",void 0),__decorate([s(cc.Label)],t.prototype,"attrNum",void 0),t=__decorate([r],t)}(n.default);i.default=l,cc._RF.pop()},{"../../Core/Widget":"Widget","../../Util/AttrUtil":"AttrUtil"}],TotemsAttrThanItem:[function(e,t,i){"use strict";cc._RF.push(t,"7538crZqNNF3qZn30AeP6bV","TotemsAttrThanItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Util/AttrUtil"),a=cc._decorator,r=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.attrIcons=null,t.icon=null,t.attrName=null,t.attrNum=null,t.addAttrNum=null,t.state=null,t}return __extends(t,e),t.prototype.initData=function(e){var t=o.default.getAttrIconID(e);this.icon.spriteFrame=this.attrIcons.getSpriteFrame("attrIcon_"+t),this.attrName.string=o.default.getAttrName(e)},t.prototype.updateData=function(e,t){this.attrNum.string=e+"",this.addAttrNum.string=t+""},__decorate([s(cc.SpriteAtlas)],t.prototype,"attrIcons",void 0),__decorate([s(cc.Sprite)],t.prototype,"icon",void 0),__decorate([s(cc.Label)],t.prototype,"attrName",void 0),__decorate([s(cc.Label)],t.prototype,"attrNum",void 0),__decorate([s(cc.Label)],t.prototype,"addAttrNum",void 0),t=__decorate([r],t)}(n.default);i.default=l,cc._RF.pop()},{"../../Core/Widget":"Widget","../../Util/AttrUtil":"AttrUtil"}],TotemsClearItem:[function(e,t,i){"use strict";cc._RF.push(t,"57c93vD3HVMpbtqfLh5A/yg","TotemsClearItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/Language"),a=e("../OpenWin/OpenWinController"),r=e("../../Core/WindowType"),s=e("../../Util/AttrUtil"),l=e("./TotemsCtrl"),c=e("../WarTeam/MonsterController"),d=cc._decorator,p=d.ccclass,h=d.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.attrIcons=null,t.icon=null,t.progressNum=null,t.unlock=null,t.bg=null,t.clearBtn=null,t.state=null,t.index=null,t}return __extends(t,e),t.prototype.initData=function(e){this.index=e},t.prototype.updateData=function(e){if(this.progressNum.node.active=!1,this.unlock.node.active=!1,this.clearBtn.interactable=e,this.clearBtn.node.getChildByName("unlock").active=!1,this.clearBtn.node.getChildByName("label").active=!1,e){var t=l.default.instance.nowIndex,i=l.default.instance.totemsSerData[t],n=i.reshuffle[this.index].value,a=i.reshuffle[this.index].type,r=l.default.instance.getAttrType(t)[a].attr[i.getLevel()-1].max;this.progressNum.node.active=!0,this.bg.progress=n/r;var d=s.default.getAttrName(a),p=[];p[a]=n;var h=c.default.instance.getAttrPrecentByGradeAndType(l.default.instance.chooseGrade,p)[a];p[a]=r;var u=c.default.instance.getAttrPrecentByGradeAndType(l.default.instance.chooseGrade,p)[a];this.clearBtn.node.getChildByName("label").active=!0,this.progressNum.string=o.default.getStr("5503",d,h,u);var f=s.default.getAttrIconID(a);this.icon.spriteFrame=this.attrIcons.getSpriteFrame("attrIcon_"+f),this.clearBtn.node.getChildByName("label").getComponent(cc.Label).string=o.default.getStr("5500")}else{this.icon.spriteFrame=this.attrIcons.getSpriteFrame("attrIcon"),this.unlock.node.active=!0,this.bg.progress=0;var g=l.default.instance.holes[this.index];g.vipLv?this.unlock.string=o.default.getStr("5520",g.vipLv):this.unlock.string=o.default.getStr("5515",g.stage),this.clearBtn.node.getChildByName("unlock").active=!0}},t.prototype.onClickSend=function(){l.default.instance.holeIndex=this.index,a.default.instance.openWindow(r.WindowType.TotemsClear)},__decorate([h(cc.SpriteAtlas)],t.prototype,"attrIcons",void 0),__decorate([h(cc.Sprite)],t.prototype,"icon",void 0),__decorate([h(cc.Label)],t.prototype,"progressNum",void 0),__decorate([h(cc.Label)],t.prototype,"unlock",void 0),__decorate([h(cc.ProgressBar)],t.prototype,"bg",void 0),__decorate([h(cc.Button)],t.prototype,"clearBtn",void 0),t=__decorate([p],t)}(n.default);i.default=u,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../Util/AttrUtil":"AttrUtil","../OpenWin/OpenWinController":"OpenWinController","../WarTeam/MonsterController":"MonsterController","./TotemsCtrl":"TotemsCtrl"}],TotemsClearWin:[function(e,t,i){"use strict";cc._RF.push(t,"589edrQ499GV4BPSiyq37Xu","TotemsClearWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Commons/CommonPageBG"),o=e("../../Core/Language"),a=e("../../Core/WindowType"),r=e("../../Core/GameEventDispatcher"),s=e("../../Core/WindowManager"),l=e("../../Core/Event"),c=e("../../Core/CommonsResManager"),d=e("../Tips/OpTipsController"),p=e("./TotemsCtrl"),h=e("../../Util/AttrUtil"),u=e("../Item/ItemController"),f=e("../Item/ItemData"),g=e("../../Util/UtilsFight"),y=e("../../Util/RechargeUtils"),m=e("../../Util/RechargeConst"),C=e("./TotemsWin"),v=e("../Item/ItemModel"),_=e("../Sound/SoundController"),b=e("../WarTeam/MonsterController"),T=e("../../GlobalContext"),S=e("../../Util/Utils"),I=e("../Tips/TipsWinController"),w=cc._decorator,D=w.ccclass,R=w.property,A=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.totemsAtals=null,t.attrIcons=null,t.consume=null,t.left=null,t.right=null,t.oldPower=null,t.effect=null,t.toggle=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.onInit(890,485,o.default.getStr("5500"),!0),this.left.getChildByName("label").getComponent(cc.Label).string=this.right.getChildByName("label").getComponent(cc.Label).string=o.default.getStr("5501"),cc.find("main/replaceBtn/label",this.node).getComponent(cc.Label).string=o.default.getStr("5504"),cc.find("main/clearBtn/label",this.node).getComponent(cc.Label).string=o.default.getStr("5500")},t.prototype.show=function(){e.prototype.show.call(this),i.instance=this,r.GameEventDispatcher.instance.on("TotemsHide",this.hideInfo,this),r.GameEventDispatcher.instance.on(l.EventDefiner.ToeamsUpdateClear,this.onToeamsUpdateClear,this),r.GameEventDispatcher.instance.on("BagPackInfoChange",this.updateItemData,this),this.effect.setCompleteListener(this.setEffectsFinished),this.right.active=!1,this.updateData(!0)},t.prototype.setEffectsFinished=function(e){i.instance.effect.node.active=!1},t.prototype.hide=function(){r.GameEventDispatcher.instance.off(l.EventDefiner.ToeamsUpdateClear,this.onToeamsUpdateClear,this),r.GameEventDispatcher.instance.off("BagPackInfoChange",this.updateItemData,this),r.GameEventDispatcher.instance.off("TotemsHide",this.hideInfo,this)},t.prototype.hideInfo=function(){this.toggle.isChecked=!1},t.prototype.updateData=function(e,t){var i=p.default.instance.nowIndex,n=p.default.instance.holeIndex,a=p.default.instance.totemsSerData[i],r=p.default.instance.getAttrType(i);this.updateItemData();var s=null,l=null,d=null,u=null,f=[];if(e){this.right.active=!1;var y=a.reshuffle[n];s=y.value,l=r[y.type].attr[a.getLevel()-1].max,u=h.default.getAttrIconID(y.type),cc.find("data/progress/icon/attrIcon",this.left).getComponent(cc.Sprite).spriteFrame=this.attrIcons.getSpriteFrame("attrIcon_"+u),cc.find("data/progress/bg",this.left).getComponent(cc.ProgressBar).progress=s/l,d=h.default.getAttrName(y.type),(v=[])[y.type]=s;var m=b.default.instance.getAttrPrecentByGradeAndType(p.default.instance.chooseGrade,v)[y.type];v[y.type]=l;var C=b.default.instance.getAttrPrecentByGradeAndType(p.default.instance.chooseGrade,v)[y.type];cc.find("data/progress/progressNum",this.left).getComponent(cc.Label).string=o.default.getStr("5503",d,m,C),this.left.getChildByName("grade").getComponent(cc.Sprite).spriteFrame=c.default.instance.getSpriteFrameByName(p.default.instance.getGrade(s/l*100)),f[y.type]=y.value,this.oldPower=g.default.cptFight(i+1,f),cc.find("evaluate/richtext",this.left).getComponent(cc.RichText).string=o.default.getStr("5502",this.oldPower)}else{var v;this.right.active=!0,l=r[t.type].attr[a.getLevel()-1].max,u=h.default.getAttrIconID(t.type),cc.find("data/progress/icon/attrIcon",this.right).getComponent(cc.Sprite).spriteFrame=this.attrIcons.getSpriteFrame("attrIcon_"+u),cc.find("data/progress/bg",this.right).getComponent(cc.ProgressBar).progress=t.value/l,d=h.default.getAttrName(t.type),(v=[])[t.type]=t.value;m=b.default.instance.getAttrPrecentByGradeAndType(p.default.instance.chooseGrade,v)[t.type];v[t.type]=l;C=b.default.instance.getAttrPrecentByGradeAndType(p.default.instance.chooseGrade,v)[t.type];cc.find("data/progress/progressNum",this.right).getComponent(cc.Label).string=o.default.getStr("5503",d,m,C),this.right.getChildByName("grade").getComponent(cc.Sprite).spriteFrame=c.default.instance.getSpriteFrameByName(p.default.instance.getGrade(t.value/l*100)),f[t.type]=t.value;var _=g.default.cptFight(i+1,f);this.right.getChildByName("icon_jian").active=this.oldPower<_,this.effect.node.active=!0,this.effect.setAnimation(0,"effect",!0),this.left.getChildByName("icon_jian").active=this.oldPower>=_,cc.find("evaluate/richtext",this.right).getComponent(cc.RichText).string=o.default.getStr("5502",_)}},t.prototype.updateItemData=function(){var e=p.default.instance.nowIndex,t=p.default.instance.totemConfig[e].needItem[0];this.itemId=t.id;var i=u.default.instance.getItemNum(t.id),n=f.default.creatItem(t.id,i);this.consume.getChildByName("label").getComponent(cc.Label).string=o.default.getStr("5505",i,t.count),this.count=t.count;var a=this.consume.getChildByName("icon");a.attr({count:i,itemdata:n}),a.getComponent(cc.Button).clickEvents[0].customEventData=n.id+"",a.scaleX=a.scaleY=.5;var r=T.GlobalContext.ResRoot+"resources/itemicon/"+n.ItemIcon+".png";S.default.setImage(a,r)},t.prototype.onToeamsUpdateClear=function(e){var t=e.detail;this.updateData(t.flag,t.newAttr)},t.prototype.onSendBtn=function(e,t){var i=this;if("0"==t){if(!this.right.active)return void d.default.instance.ShowMsg(o.default.getStr("5521"));this.boo=!0,p.default.instance.sendTtmreshuffleReq(this.boo),_.default.instance.PlayEffect(_.SoundType.upSucceeds)}else{if(this.boo=!1,v.default.getCountByid(this.itemId)<this.count&&!C.default.instance.isFrist2&&!this.toggle.isChecked)return C.default.instance.isFrist2=!0,void I.default.instance.ShowTips("\u662f\u5426\u4f7f\u7528\u81ea\u52a8\u8d2d\u4e70",function(){i.toggle.isChecked=!0});if(this.toggle.isChecked)return void p.default.instance.sendTtmreshuffleReq(this.boo,this.toggle.isChecked);y.default.PurchaseItemOrRechage(m.RechargeTypeConst.Prop,this.count,function(){p.default.instance.sendTtmreshuffleReq(i.boo,i.toggle.isChecked)},this,this.itemId)}},t.prototype.onClose=function(){this.right.active?I.default.instance.ShowTips(o.default.getStr("5523"),function(){s.default.instance.close(a.WindowType.TotemsClear)}):s.default.instance.close(a.WindowType.TotemsClear)},t.instance=null,__decorate([R(cc.SpriteAtlas)],t.prototype,"totemsAtals",void 0),__decorate([R(cc.SpriteAtlas)],t.prototype,"attrIcons",void 0),__decorate([R(cc.Node)],t.prototype,"consume",void 0),__decorate([R(cc.Node)],t.prototype,"left",void 0),__decorate([R(cc.Node)],t.prototype,"right",void 0),__decorate([R(sp.Skeleton)],t.prototype,"effect",void 0),__decorate([R(cc.Toggle)],t.prototype,"toggle",void 0),t=i=__decorate([D],t)}(n.default);i.default=A,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/AttrUtil":"AttrUtil","../../Util/RechargeConst":"RechargeConst","../../Util/RechargeUtils":"RechargeUtils","../../Util/Utils":"Utils","../../Util/UtilsFight":"UtilsFight","../Commons/CommonPageBG":"CommonPageBG","../Item/ItemController":"ItemController","../Item/ItemData":"ItemData","../Item/ItemModel":"ItemModel","../Sound/SoundController":"SoundController","../Tips/OpTipsController":"OpTipsController","../Tips/TipsWinController":"TipsWinController","../WarTeam/MonsterController":"MonsterController","./TotemsCtrl":"TotemsCtrl","./TotemsWin":"TotemsWin"}],TotemsConditionVo:[function(e,t,i){"use strict";cc._RF.push(t,"85cdf+3mulIUo8MW6QONdYe","TotemsConditionVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){return function(e){for(var t in e)this[t]=e[t]}}();i.TotemsConditionVo=n,cc._RF.pop()},{}],TotemsConst:[function(e,t,i){"use strict";cc._RF.push(t,"c26a1H9/PVCsIhKEBBLTSEQ","TotemsConst"),Object.defineProperty(i,"__esModule",{value:!0}),function(e){e[e.Front=0]="Front",e[e.Middle=1]="Middle",e[e.After=2]="After"}(i.TotemsType||(i.TotemsType={})),function(e){e[e.News=0]="News",e[e.Strengthen=1]="Strengthen",e[e.Advanced=2]="Advanced",e[e.Talent=3]="Talent",e[e.Clear=4]="Clear"}(i.TotemsPageType||(i.TotemsPageType={})),function(e){e[e.Have=0]="Have",e[e.Unlock=1]="Unlock",e[e.Ununlocked=2]="Ununlocked"}(i.TotemsTalentType||(i.TotemsTalentType={})),function(e){e[e.Ununlocked=0]="Ununlocked",e[e.CanBattle=1]="CanBattle",e[e.Unload=2]="Unload"}(i.TotemsGiftedType||(i.TotemsGiftedType={})),function(e){e[e.AddPVEHp=700]="AddPVEHp",e[e.CutPVEHp=701]="CutPVEHp",e[e.AddPVPHp=600]="AddPVPHp",e[e.CutPVPHp=601]="CutPVPHp",e[e.AddFiveAttr=410]="AddFiveAttr",e[e.CutFiveAttr=411]="CutFiveAttr",e[e.AddHightHp=412]="AddHightHp",e[e.CutHightHp=413]="CutHightHp",e[e.AllAddLvPVE=2100]="AllAddLvPVE",e[e.HightAddForm=2101]="HightAddForm"}(i.TotemsAttributeType||(i.TotemsAttributeType={})),cc._RF.pop()},{}],TotemsCopyConst:[function(e,t,i){"use strict";cc._RF.push(t,"1a72bvqxNJHKII2em4xxnid","TotemsCopyConst"),Object.defineProperty(i,"__esModule",{value:!0}),function(e){e[e.Reset=1]="Reset",e[e.SweepAway=2]="SweepAway",e[e.Challenge=3]="Challenge"}(i.TotemsCopyBtnConst||(i.TotemsCopyBtnConst={})),function(e){e[e.Front=0]="Front",e[e.Middle=1]="Middle",e[e.After=2]="After"}(i.TotemsCopyType||(i.TotemsCopyType={})),function(e){e.INIT="resources/totemscopy/"}(i.TOTEMSCOPYROUTE||(i.TOTEMSCOPYROUTE={})),cc._RF.pop()},{}],TotemsCopyCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"ea77ccgQZRFX6ybUFt6F4/a","TotemsCopyCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../NetConnect/NetConnet"),a=e("../../Core/ConfigsManager"),r=e("../../Core/GameEventDispatcher"),s=e("./TotemsCopyVo"),l=e("../Tips/OpTipsController"),c=e("../../Core/Language"),d=e("./TotemsCopySerVo"),p=e("../../Core/Event"),h=e("./TotemsCopyFirstpassrewardVo"),u=e("./TotemsCopyPassRewardVo"),f=e("./TotemsCopyPositionVo"),g=e("../Fight/staticattr"),y=e("../Scene/Prop/EntityProperty"),m=e("../../Core/Const/EntityType"),C=e("../Scene/Controller/SkillController"),v=e("../Chat/ChatVo"),_=e("../Role/RoleInfo"),b=e("./TotemsCopyUtils"),T=e("../Fight/FightUtils"),S=cc._decorator,I=S.ccclass,w=(S.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.totemsCopyConfig={},t.serData=null,t.permutation={},t.firstpassreward={},t.passreward={},t.position={},t.chooseNum=0,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this;var t=a.ConfigsManager.instance.getConfigs("TotemsCopyConf"),n=t.permutation;for(var o in n)this.permutation[o]=n[o];for(var o in n=t.passreward){var r=n[o][0].passreward;this.passreward[r]||(this.passreward[r]=[]);var l=n[o];for(var c in l)this.passreward[r].push(new u.TotemsCopyPassRewardVo(l[c]))}for(var o in n=t.firstpassreward){var d=n[o][0].firstpassreward;this.firstpassreward[d]||(this.firstpassreward[d]=[]);l=n[o];for(var c in l)this.firstpassreward[d].push(new h.TotemsCopyFirstpassRewardVo(l[c]))}for(var o in n=t.position)this.position[o]=new f.TotemsCopyPositionVo(n[o]);for(var o in n=t.Lv[1])this.totemsCopyConfig[o]=new s.TotemsCopyVo(n[o]);this.resetSelectionState()},t.prototype.resetSelectionState=function(){this.selectionState=[0,0,0,1,1,1,2,2,2],this.chooseNum=0},t.prototype.setUpSelectionState=function(e){var t,i=e.start,n=e.end;t=[this.selectionState[n],this.selectionState[i]],this.selectionState[i]=t[0],this.selectionState[n]=t[1],r.GameEventDispatcher.instance.emit(p.EventDefiner.ToeamsCopyUpdataData)},t.prototype.listNotification=function(){this.addProto("totemfbnotsweeping",this.totemfbnotsweeping,this),this.addProto("totemfbtimeschange",this.totemfbtimeschange,this),this.addProto("totemfbfirstpassplayer",this.totemfbfirstpassplayer,this),this.addProto("totemfb",this.totemfb,this)},t.prototype.getStepNum=function(){return this.totemsCopyConfig[this.serData.current].sandtablestep},t.prototype.getNum=function(){return this.fightWheels<3?this.totemsCopyConfig[this.serData.current].reservemonster+T.FightUtils.addMonsterReserveNum():0},t.prototype.getMonNum=function(){return this.totemsCopyConfig[this.serData.current].reservemonster},t.prototype.totemfbnotsweeping=function(){l.default.instance.ShowMsg(c.default.getStr("6006"))},t.prototype.totemfb=function(e){this.serData||(this.serData=new d.TotemsCopySerVo),this.serData.updateData(e.data),r.GameEventDispatcher.instance.emit(p.EventDefiner.ToeamsCopyUpdataData)},t.prototype.totemfbtimeschange=function(e){this.serData.times=e.times,r.GameEventDispatcher.instance.emit(p.EventDefiner.ToeamsCopyUpdataData)},t.prototype.totemfbfirstpassplayer=function(e){var t;e.actorid?(this.playData=new v.ChatVo(null),t=[e.name,e.icon,e.viplv,e.gender,e.level,e.actorid,_.MyRoleInfo.serverid],this.playData.name=t[0],this.playData.icon=t[1],this.playData.viplv=t[2],this.playData.gender=t[3],this.playData.level=t[4],this.playData.id=t[5],this.playData.serverid=t[6]):this.playData=null,r.GameEventDispatcher.instance.emit(p.EventDefiner.ToeamsCopyUpdataData)},t.prototype.totemfbresetReq=function(){o.default.instance.sendProto({cmd:"totemfbreset"})},t.prototype.totemfbsweepingReq=function(){o.default.instance.sendProto({cmd:"totemfbsweeping"})},t.prototype.addMonsterByGQidAndGames=function(e){void 0===e&&(e=!0);for(var t,i,n,o,a=[],s=this.totemsCopyConfig[this.serData.current].permutation,l=this.fightWheels-1,c=[],d=0;d<3;d++)if(n=b.TotemsCopyUtils.getChooseMonFightPos(d,l),o=(t=JSON.parse(JSON.stringify(s[d].position[n]))).grade,t.grade)for(var h=t.grade;h>0;h--)t.grade=h,i=new f.TotemsCopyPositionVo(t),a.push(i),c.push(o);if(a&&a.length>0)for(d=0;d<a.length;d++){var u=a[d].count,g=this.getGQMonsterAttr(a[d],c[d]);for(h=0;h<u;h++){var y={cardid:a[d].cardId,grade:a[d].grade,level:1,num:1,self:!1,attr:g,autoUseSkill:!!a[d].autousebigskill,skills:g.skills,playeffect:!1,ismoveenter:e};r.GameEventDispatcher.instance.emit(p.EventDefiner.C_Scene_Add_Actor,y)}}},t.prototype.getGQMonsterAttr=function(e,t){var i=new g.StaticAttr,n=1;switch(t){case 5:n=.03*Math.pow(e.grade,1.63);break;case 4:n=.07*Math.pow(e.grade,1.34);break;case 3:n=.11*Math.pow(e.grade,1.511)}var o=new y.EntityProperty;o.cardid=e.cardId,o.grade=e.grade,o.type=m.EntityType.enMonster,o.selfMonster=!1;var a=C.default.instance.getSkills(o,e.skilllevel,!!e.autousebigskill);return i.PushCard(e.cardId,1,e.grade,n,a,e.prop),i},t.prototype.isCanReset=function(){return!!this.serData.current},t.instance=null,t=i=__decorate([I],t)}(n.default));i.default=w,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Const/EntityType":"EntityType","../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../NetConnect/NetConnet":"NetConnet","../Chat/ChatVo":"ChatVo","../Fight/FightUtils":"FightUtils","../Fight/staticattr":"staticattr","../Role/RoleInfo":"RoleInfo","../Scene/Controller/SkillController":"SkillController","../Scene/Prop/EntityProperty":"EntityProperty","../Tips/OpTipsController":"OpTipsController","./TotemsCopyFirstpassrewardVo":"TotemsCopyFirstpassRewardVo","./TotemsCopyPassRewardVo":"TotemsCopyPassRewardVo","./TotemsCopyPositionVo":"TotemsCopyPositionVo","./TotemsCopySerVo":"TotemsCopySerVo","./TotemsCopyUtils":"TotemsCopyUtils","./TotemsCopyVo":"TotemsCopyVo"}],TotemsCopyFirstpassRewardVo:[function(e,t,i){"use strict";cc._RF.push(t,"1ff4bWQ3mhM84e5qqMwybld","TotemsCopyFirstpassRewardVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){return function(e){for(var t in e)this[t]=e[t]}}();i.TotemsCopyFirstpassRewardVo=n,cc._RF.pop()},{}],TotemsCopyItem:[function(e,t,i){"use strict";cc._RF.push(t,"7b39ewcBwxDrrSZNEsKEXOd","TotemsCopyItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/Language"),a=e("../../Core/CommonsResManager"),r=e("../Commons/CombatValue"),s=e("../../Util/Utils"),l=e("../../Core/WindowType"),c=e("./TotemsCopyConst"),d=e("./TotemsCopyMonsterItem"),p=e("./TotemsCopyCtrl"),h=e("../WarTeam/MonsterController"),u=e("../../Core/GameEventDispatcher"),f=e("../../Core/Event"),g=e("../Commons/MonsterPreview"),y=e("../../Global/GlobalValue"),m=e("../../GlobalContext"),C=e("../../Core/LoadManager"),v=e("./TotemsCopyUtils"),_=e("../Commons/Image"),b=e("./TotemsCopyPositionVo"),T=cc._decorator,S=T.ccclass,I=T.property,w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.typeName=null,t.content=null,t.item=null,t.index=null,t.img=null,t.imgBg=null,t.di=null,t.com=null,t.icon=null,t.monsterName=null,t.model=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),u.GameEventDispatcher.instance.on(f.EventDefiner.ToeamsCopyUpdataData,this.updateData,this)},t.prototype.hide=function(){e.prototype.hide.call(this),u.GameEventDispatcher.instance.off(f.EventDefiner.ToeamsCopyUpdataData,this.updateData,this);for(var t=this.content.childrenCount-1;t>=0;t--)s.default.setNodeToPool(l.PoolType.TotemsCopyMonsterItem,this.content.children[t]);this.model.childrenCount&&(this.model.children[0].getComponent(g.default).clear(),s.default.setNodeToPool(l.PoolType.MonsterPreview,this.model.children[0]));this.oldId=null},t.prototype.initData=function(e){this.index=e,this.typeName.string=o.default.getStr("601"+this.index),this.img.spriteFrame=a.default.instance.getSpriteFrameByName("stance_"+(this.index+1)),this.imgBg.updateBg(c.TOTEMSCOPYROUTE.INIT+"title_bg_"+this.index+".png")},t.prototype.updateData=function(){var e=p.default.instance.serData.current,t=p.default.instance.totemsCopyConfig[e].permutation[this.index];if(!this.content.childrenCount){var i=void 0;for(var n in t.position)i=s.default.getNodeByPool(l.PoolType.TotemsCopyMonsterItem,this.item,m.GlobalContext.Root+"prefab/TotemsCopy/TotemsCopyMonsterItem"),this.content.addChild(i)}p.default.instance.selectionState;for(var o=0;o<this.content.children.length;o++)this.content.children[o].getComponent(d.default).updateData(t.position[o],this.index,o);this.updateSelectionMonster()},t.prototype.updateSelectionMonster=function(){for(var e,t,i=this,n=p.default.instance.serData.current,o=(p.default.instance.serData,v.TotemsCopyUtils.getWheelsChooseMonPos1(this.index)),d=p.default.instance.totemsCopyConfig[n].permutation[this.index].position[o],u=0,f=JSON.parse(JSON.stringify(d)),_=d.grade;_>0;_--)f.grade=_,e=new b.TotemsCopyPositionVo(f),t=p.default.instance.getGQMonsterAttr(e,d.grade),u+=t.GetFight();if(this.icon.spriteFrame=a.default.instance.getSpriteFrameByName("fiveLine_"+d.grade),this.monsterName.string=h.default.instance._cardConfigs.Card[d.cardId].cardName,!this.model.childrenCount){var T=s.default.getNodeByPool(l.PoolType.MonsterPreview,h.default.instance.MonsterPreview);this.model.addChild(T)}this.di.updateBg(c.TOTEMSCOPYROUTE.INIT+"bg_texiao"+(p.default.instance.chooseNum+3)+".png"),this.oldId&&this.oldId==d.cardId||(s.default.setNodeChildDestoryByUrl(this.com,m.GlobalContext.Root+"prefab/CombatVal"),C.default.instance.loadResByType(m.GlobalContext.Root+"prefab/CombatVal",cc.Prefab,function(e){var t=s.default.getNodeByUrl(e,m.GlobalContext.Root+"prefab/CombatVal");i.com.addChild(t),t.getComponent(r.default).onInit(u,24,1,!1,!1)},this),this.model.children[0].getComponent(g.default).init("monster",d.cardId,d.grade,y.DEFAULTS_SKIN+d.grade,y.PRIORITY.MONSTER),this.oldId=d.cardId)},__decorate([I(cc.Label)],t.prototype,"typeName",void 0),__decorate([I(cc.Node)],t.prototype,"content",void 0),__decorate([I(cc.Prefab)],t.prototype,"item",void 0),__decorate([I(cc.Sprite)],t.prototype,"img",void 0),__decorate([I(_.default)],t.prototype,"imgBg",void 0),__decorate([I(_.default)],t.prototype,"di",void 0),__decorate([I(cc.Node)],t.prototype,"com",void 0),__decorate([I(cc.Sprite)],t.prototype,"icon",void 0),__decorate([I(cc.Label)],t.prototype,"monsterName",void 0),__decorate([I(cc.Node)],t.prototype,"model",void 0),t=__decorate([S],t)}(n.default);i.default=w,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/CombatValue":"CombatValue","../Commons/Image":"Image","../Commons/MonsterPreview":"MonsterPreview","../WarTeam/MonsterController":"MonsterController","./TotemsCopyConst":"TotemsCopyConst","./TotemsCopyCtrl":"TotemsCopyCtrl","./TotemsCopyMonsterItem":"TotemsCopyMonsterItem","./TotemsCopyPositionVo":"TotemsCopyPositionVo","./TotemsCopyUtils":"TotemsCopyUtils"}],TotemsCopyMonsterItem:[function(e,t,i){"use strict";cc._RF.push(t,"4ddcecwCE5KrI25WM3Q+PDA","TotemsCopyMonsterItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../Commons/MonsterPreview"),a=e("../../Global/GlobalValue"),r=e("../../Util/Utils"),s=e("../../Core/WindowType"),l=e("./TotemsCopyCtrl"),c=e("../WarTeam/MonsterController"),d=e("./TotemsCopyUtils"),p=e("../Commons/Image"),h=e("./TotemsCopyConst"),u=cc._decorator,f=u.ccclass,g=u.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mon=null,t.choose=null,t.bg=null,t.indexIcon=null,t.index=null,t.outIndex=null,t.monData=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this),this.isSet=!1},t.prototype.touchStart=function(e){d.TotemsCopyUtils.setChooseMon(this.outIndex,this.index)},t.prototype.hide=function(){(e.prototype.hide.call(this),this.node.off(cc.Node.EventType.TOUCH_START,this.touchStart,this),this.mon.childrenCount)&&(this.mon.children[0].getComponent(o.default).clear(),r.default.setNodeToPool(s.PoolType.MonsterPreview,this.mon.children[0]));this.isSet=null,this.oldId=null},t.prototype.setPos=function(){this.isSet||(this.pos=cc.v2(this.node.x,this.node.y),this.isSet=!0)},t.prototype.recoveryPos=function(){this.isSet=!1,this.node.position=this.pos},t.prototype.updateData=function(e,t,i){this.index=i,this.monData=e,this.outIndex=t,this.node.name=this.index+"";l.default.instance.selectionState,l.default.instance.chooseNum;var n=d.TotemsCopyUtils.getWheelsChooseMonPos(this.index,this.outIndex),p=d.TotemsCopyUtils.getWheelsChooseMonPos1(this.outIndex);if(this.choose.node.active=p==this.index,this.indexIcon.updateBg(h.TOTEMSCOPYROUTE.INIT+"icon_shunxu"+(n+1)+".png"),this.choose.updateBg(h.TOTEMSCOPYROUTE.INIT+"bg_xuanzhong"+(3+n)+".png"),!this.mon.childrenCount){var u=r.default.getNodeByPool(s.PoolType.MonsterPreview,c.default.instance.MonsterPreview);this.mon.addChild(u)}this.oldId&&this.oldId==e.cardId||(this.mon.children[0].getComponent(o.default).init("monster",e.cardId,e.grade,a.DEFAULTS_SKIN+e.grade,a.PRIORITY.MONSTER),this.oldId=e.cardId)},t.prototype.onClickSend=function(){if(!this.choose.node.active){var e=d.TotemsCopyUtils.getFindChooseMonPos(this.index,this.outIndex),t=d.TotemsCopyUtils.getChooseMonPos(this.outIndex);l.default.instance.setUpSelectionState({start:e,end:t})}},__decorate([g(cc.Node)],t.prototype,"mon",void 0),__decorate([g(p.default)],t.prototype,"choose",void 0),__decorate([g(cc.Sprite)],t.prototype,"bg",void 0),__decorate([g(p.default)],t.prototype,"indexIcon",void 0),t=__decorate([f],t)}(n.default);i.default=y,cc._RF.pop()},{"../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../Util/Utils":"Utils","../Commons/Image":"Image","../Commons/MonsterPreview":"MonsterPreview","../WarTeam/MonsterController":"MonsterController","./TotemsCopyConst":"TotemsCopyConst","./TotemsCopyCtrl":"TotemsCopyCtrl","./TotemsCopyUtils":"TotemsCopyUtils"}],TotemsCopyPassRewardVo:[function(e,t,i){"use strict";cc._RF.push(t,"5a923AUMRpMdpHVghDunPOK","TotemsCopyPassRewardVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){return function(e){for(var t in e)this[t]=e[t]}}();i.TotemsCopyPassRewardVo=n,cc._RF.pop()},{}],TotemsCopyPermutationVo:[function(e,t,i){"use strict";cc._RF.push(t,"e19148sCE9Ne4lCtZXQ7X5H","TotemsCopyPermutationVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./TotemsCopyCtrl"),o=e("./TotemsCopyPositionVo"),a=function(){return function(e){this.position={},this.permutation=e.permutation;var t=n.default.instance.position[e.position];for(var i in t)this.position[i]=new o.TotemsCopyPositionVo(t[i])}}();i.TotemsCopyPermutationVo=a,cc._RF.pop()},{"./TotemsCopyCtrl":"TotemsCopyCtrl","./TotemsCopyPositionVo":"TotemsCopyPositionVo"}],TotemsCopyPositionVo:[function(e,t,i){"use strict";cc._RF.push(t,"46f5e/tPdBA85/pLQaDl+zB","TotemsCopyPositionVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./TotemsCopyCtrl"),o=function(){return function(e){for(var t in e)"firstpassreward"==t?this.firstpassreward=n.default.instance.firstpassreward[e[t]]:"passreward"==t?this.passreward=n.default.instance.passreward[e[t]]:this[t]=e[t]}}();i.TotemsCopyPositionVo=o,cc._RF.pop()},{"./TotemsCopyCtrl":"TotemsCopyCtrl"}],TotemsCopySerVo:[function(e,t,i){"use strict";cc._RF.push(t,"c0709bLHNNNWLu3uVXHre/a","TotemsCopySerVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.updateData=function(e){for(var t in e)this[t]=e[t]},e}();i.TotemsCopySerVo=n,cc._RF.pop()},{}],TotemsCopyUtils:[function(e,t,i){"use strict";cc._RF.push(t,"39d751BvnlMibxDzW/qnHr2","TotemsCopyUtils"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./TotemsCopyCtrl"),o=e("../Item/ItemData"),a=e("../Commons/RewardUtils"),r=e("../../Core/GameEventDispatcher"),s=e("../../Core/Event"),l=e("../../Global/GlobalValue"),c=e("../Functionicon/FunctionIconController"),d=e("../../Core/WindowType"),p=function(){function e(){}return Object.defineProperty(e,"ctrl",{get:function(){return n.default.instance},enumerable:!0,configurable:!0}),e.getRewards=function(){for(var e=this.ctrl,t=[],i=e.serData.current,n=e.serData,r=0;r<3;r++)for(var s=0;s<3;s++){var l=e.totemsCopyConfig[i].permutation[r].position[s],c=l.firstpassreward;for(var d in i<n.maxpass&&(c=l.passreward),c){var p=a.default.instance.getItemId(c[d].type,c[d].id,c[d].count),h=o.default.creatItem(Number(p[0]),Number(p[1]));t=this.mergeReward(t,h)}}return t},e.mergeReward=function(e,t){var i=!0;for(var n in e)if(e[n].id==t.id){e[n].count+=t.count,i=!1;break}return i&&e.push(t),e},e.setChooseMon=function(e,t){this.ctrl.chooseMon={outIndex:e,index:t}},e.closeChooseMon=function(){this.ctrl.chooseMon=null},e.getChooseMon=function(e){var t=this.ctrl;return t.selectionState[3*t.chooseNum+e]},e.getChooseMonPos=function(e){for(var t,i,n=this.ctrl,o=n.chooseNum,a=n.selectionState,r=0;r<3;r++)if(a[i=3*r+e]==o){t=i;break}return t},e.getFindChooseMonPos=function(e,t){this.ctrl.selectionState;for(var i,n,o=0;o<3;o++)if(i=3*o+t,o==e){n=i;break}return n},e.getWheelsChooseMonPos=function(e,t){for(var i,n,o=this.ctrl,a=o.selectionState,r=(o.chooseNum,0);r<3;r++)if(i=3*r+t,r==e){n=a[i];break}return n},e.getWheelsChooseMonPos1=function(e){for(var t,i=this.ctrl,n=i.selectionState,o=i.chooseNum,a=0;a<3;a++)if(n[3*a+e]==o){t=a;break}return t},e.getInfoFight=function(){var e=this.ctrl;e.fightWheels=1;var t=e.serData,i=e.totemsCopyConfig[t.current].sandtableId;r.GameEventDispatcher.instance.emit(s.EventDefiner.ChangeGameScene,{status:l.GameScene.Fight,guanqiaId:i}),r.GameEventDispatcher.instance.emit(s.EventDefiner.ToeamsCopyUpdataData)},e.isEnd=function(){return 3==this.ctrl.fightWheels},e.isMaxLayer=function(){var e=this.ctrl;return!e.totemsCopyConfig[e.serData.current+1]&&!e.totemsCopyConfig[e.serData.maxpass]},e.addWheel=function(){return this.ctrl.fightWheels++},e.getGuanqiaId=function(){var e=this.ctrl,t=e.serData;return e.totemsCopyConfig[t.current].sandtableId},e.getRed=function(){return this.ctrl&&c.default.instance.checkIsOpenbyWindowtype(d.WindowType.TotemsCopy),!1},e.getChooseMonFightPos=function(e,t){for(var i,n=this.ctrl,o=(n.chooseNum,n.selectionState),a=0;a<3;a++)if(o[3*a+e]==t){i=a;break}return i},e}();i.TotemsCopyUtils=p,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../Commons/RewardUtils":"RewardUtils","../Functionicon/FunctionIconController":"FunctionIconController","../Item/ItemData":"ItemData","./TotemsCopyCtrl":"TotemsCopyCtrl"}],TotemsCopyVo:[function(e,t,i){"use strict";cc._RF.push(t,"0a02cVRr6tFbb82xGD4COrY","TotemsCopyVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./TotemsCopyCtrl"),o=e("./TotemsCopyPermutationVo"),a=function(){return function(e){this.permutation={},this.Lv=e.Lv,this.reservemonster=e.reservemonster,this.sandtableId=e.sandtableId,this.sandtablestep=e.sandtablestep;for(var t=n.default.instance.permutation[e.permutation],i=0;i<t.length;i++)n.default.instance.position[t[i].position],this.permutation[i]=new o.TotemsCopyPermutationVo(t[i])}}();i.TotemsCopyVo=a,cc._RF.pop()},{"./TotemsCopyCtrl":"TotemsCopyCtrl","./TotemsCopyPermutationVo":"TotemsCopyPermutationVo"}],TotemsCopyWin:[function(e,t,i){"use strict";cc._RF.push(t,"b042fJQwilJCYvj/xV8cjlC","TotemsCopyWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../../Core/Language"),a=e("../Tips/OpTipsController"),r=e("../../Core/GameEventDispatcher"),s=e("../../Core/Event"),l=e("../OpenWin/OpenWinController"),c=e("../../Core/WindowType"),d=e("../../GlobalContext"),p=e("../Gamelayer/RoleHead"),h=e("./TotemsCopyConst"),u=e("../../Util/Utils"),f=e("./TotemsCopyItem"),g=e("../Role/RoleInfo"),y=e("./TotemsCopyCtrl"),m=e("../Chat/ChatTips"),C=e("../../Core/LoadManager"),v=e("./TotemsCopyUtils"),_=e("../Item/ItemIcon"),b=e("../../Util/CommonUtil"),T=e("../../Global/GlobalValue"),S=cc._decorator,I=S.ccclass,w=S.property,D=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.level=null,t.resetNum=null,t.str=null,t.firstPass=null,t.RoleHead=null,t.item=null,t.content=null,t.tips=null,t.rewardContent=null,t.ToggleContainer=null,t.challengeBtn=null,t.resetBtn=null,t.sweepAwayBtn=null,t.block=null,t.adopt=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.onInit(c.WindowType.TotemsCopy,!0),this.str.string=o.default.getStr("6018"),e.prototype.onLoad.call(this)},t.prototype.onClick=function(){var e=this.tips.getChildByName("ChatTips").getComponent(m.default);e.node.active&&(e.node.active=!1)},t.prototype.onClickPlayTips=function(){var e=y.default.instance.playData,t=this.tips.getChildByName("ChatTips").getComponent(m.default);e&&e.id!=Number(g.MyRoleInfo.id)?t.node.active?t.node.active=!t.node.active:t.initData(1,e):t.node.active=!1},t.prototype.show=function(){var t=this;if(e.prototype.show.call(this),r.GameEventDispatcher.instance.on(s.EventDefiner.ToeamsCopyUpdataData,this.updataData,this),this.ToggleContainer.node.children[y.default.instance.chooseNum].getComponent(cc.Toggle).isChecked=!0,this.tips.childrenCount||C.default.instance.loadResByType(d.GlobalContext.Root+"prefab/Chat/ChatTips",cc.Prefab,function(e){var i=u.default.getNodeByUrl(e,d.GlobalContext.Root+"prefab/Chat/ChatTips");i.getComponent(m.default).node.active=!1,t.tips.addChild(i)},this),!this.content.childrenCount)for(var i=void 0,n=0;n<3;n++)(i=u.default.getNodeByPool(c.PoolType.TotemsCopyItem,this.item,d.GlobalContext.Root+"prefab/TotemsCopy/TotemsCopyItem")).name="TotemsCopyItem"+n,this.content.addChild(i),i.getComponent(f.default).initData(n);this.updataData()},t.prototype.updataData=function(){var e=this,t=v.TotemsCopyUtils.isMaxLayer();this.challengeBtn.active=!t,this.adopt.active=this.block.active=t;var i=y.default.instance.serData,n=y.default.instance.playData;for(var a in this.RoleHead.getComponent(p.default).SetHead(g.MyRoleInfo.icon),this.RoleHead.SetHead(n?n.icon:""),this.firstPass.string=n?n.name:o.default.getStr("6002"),this.RoleHead.node.getChildByName("di").getComponent(cc.Sprite).node.active=!n,this.content.children)this.content.children[a].getComponent(f.default).updateData();this.nowLv&&this.nowLv==i.current+1||(this.nowLv=i.current+1,this.level.string=o.default.getStr("6001",i.current+1),u.default.setNodeChildDestoryByUrl(this.rewardContent,d.GlobalContext.Root+"prefab/Bag/ItemIcon"),C.default.instance.loadResByType(d.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(t){var i=v.TotemsCopyUtils.getRewards();for(var n in i){var o=u.default.getNodeByPool(c.PoolType.ItemIcon,t,d.GlobalContext.Root+"prefab/Bag/ItemIcon");o.scale=.8,e.rewardContent.addChild(o),o.getComponent(_.default).ItemData(i[n],!0,i[n].count+"",!0)}},this)),this.resetBtn.active=!i.sweep,this.sweepAwayBtn.active=!this.resetBtn.active;var r=b.CommonUtil.getTimes(T.VipPrivilegeType.TotemsCopyReset)-y.default.instance.serData.times;if(this.resetBtn.active)if(this.resetBtn.getComponent(cc.Button).interactable=!(g.MyRoleInfo.vipLevel==T.MaxVipLev&&!r),r)this.resetNum.string=o.default.getStr("6020",r);else{var s=b.CommonUtil.getNextTimes(T.VipPrivilegeType.TotemsCopyReset);null!=s&&(this.resetNum.string=o.default.getStr("6019",s[0],s[1]))}},t.prototype.hide=function(){e.prototype.hide.call(this),this.nowLv=null,r.GameEventDispatcher.instance.off(s.EventDefiner.ToeamsCopyUpdataData,this.updataData,this);for(var t=this.content.childrenCount-1;t>=0;t--)u.default.setNodeToPool(c.PoolType.TotemsCopyItem,this.content.children[t])},t.prototype.onClickSendBtn=function(e,t){var i=parseInt(t),n=y.default.instance.serData;switch(i){case h.TotemsCopyBtnConst.Reset:if(n.times==b.CommonUtil.getTimes(T.VipPrivilegeType.TotemsCopyReset))return void l.default.instance.openWindow(c.WindowType.VIP);if(!y.default.instance.isCanReset())return void a.default.instance.ShowMsg(o.default.getStr("6017"));y.default.instance.totemfbresetReq();break;case h.TotemsCopyBtnConst.SweepAway:y.default.instance.totemfbsweepingReq();break;case h.TotemsCopyBtnConst.Challenge:v.TotemsCopyUtils.getInfoFight()}},t.prototype.onClickToggle=function(e){var t=parseInt(e.target.name);null!=t&&t==y.default.instance.chooseNum||(y.default.instance.chooseNum=t,r.GameEventDispatcher.instance.emit(s.EventDefiner.ToeamsCopyUpdataData))},__decorate([w(cc.Label)],t.prototype,"level",void 0),__decorate([w(cc.RichText)],t.prototype,"resetNum",void 0),__decorate([w(cc.Label)],t.prototype,"str",void 0),__decorate([w(cc.Label)],t.prototype,"firstPass",void 0),__decorate([w(p.default)],t.prototype,"RoleHead",void 0),__decorate([w(cc.Prefab)],t.prototype,"item",void 0),__decorate([w(cc.Node)],t.prototype,"content",void 0),__decorate([w(cc.Node)],t.prototype,"tips",void 0),__decorate([w(cc.Node)],t.prototype,"rewardContent",void 0),__decorate([w(cc.ToggleContainer)],t.prototype,"ToggleContainer",void 0),__decorate([w(cc.Node)],t.prototype,"challengeBtn",void 0),__decorate([w(cc.Node)],t.prototype,"resetBtn",void 0),__decorate([w(cc.Node)],t.prototype,"sweepAwayBtn",void 0),__decorate([w(cc.Node)],t.prototype,"block",void 0),__decorate([w(cc.Node)],t.prototype,"adopt",void 0),t=__decorate([I],t)}(n.default);i.default=D,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/Window":"Window","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/CommonUtil":"CommonUtil","../../Util/Utils":"Utils","../Chat/ChatTips":"ChatTips","../Gamelayer/RoleHead":"RoleHead","../Item/ItemIcon":"ItemIcon","../OpenWin/OpenWinController":"OpenWinController","../Role/RoleInfo":"RoleInfo","../Tips/OpTipsController":"OpTipsController","./TotemsCopyConst":"TotemsCopyConst","./TotemsCopyCtrl":"TotemsCopyCtrl","./TotemsCopyItem":"TotemsCopyItem","./TotemsCopyUtils":"TotemsCopyUtils"}],TotemsCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"e38da4h7qVMAYhATK4fyDR3","TotemsCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../Core/GameEventDispatcher"),a=e("../../Core/Event"),r=e("../../Core/ConfigsManager"),s=e("../../NetConnect/NetConnet"),l=e("./TotemsVo"),c=e("./TotemsConst"),d=e("./TotemsSerVo"),p=e("../OpenWin/OpenWinController"),h=e("../../Core/WindowType"),u=e("./TotemsUpgradeWin"),f=e("./TotemsRateVo"),g=e("./TotemsWin"),y=e("./TotemsUtils"),m=e("../../Core/TimeController"),C=e("../Status/StatusController"),v=e("../WarTeam/MonsterController"),_=e("../Role/RoleStrengthen/RoleStrengthenController"),b=e("../Role/RoleStrengthen/RoleStrengthenEvent"),T=e("../Activity/ActivityController"),S=e("../Functionicon/FunctionIconController"),I=cc._decorator,w=I.ccclass,D=(I.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.config=null,t.totemConfig={},t.nowIndex=c.TotemsType.Front,t.pageIndex=c.TotemsPageType.News,t.maxTalentNum=6,t.maxBaseNum=3,t.unlockTalent={},t.totemsSerData={},t.holeIndex=null,t.rate=[],t.totemsRatio=null,t.totemsTalentAttr={},t.talentName=null,t.branchUnlock=null,t.formTotemsData={},t.holes={},t.chooseGrade=1,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this,this.config=r.ConfigsManager.instance.getConfigs("TotemConf");for(var t=this.config.totem[1],n=0;n<t.length;n++)this.totemConfig[n]=new l.TotemsVo(t[n]);t=this.config.condition[1];for(n=0;n<t.length;n++){var o=t[n].slot;this.unlockTalent[o]||(this.unlockTalent[o]=n+1)}for(var a in this.upgradeItem=this.config.upgradeItem[1],t=this.config.rate[1])this.rate.push(new f.TotemsRateVo(t[a]));for(var a in t=this.config.talentName,this.talentName={},t)this.talentName[t[a].damageType]=t[a].name;t=this.config.branchUnlock,this.branchUnlock=t,this.talentData=this.config.talent,t=this.config.hole[1];for(n=0;n<t.length;n++)this.holes[n]={},this.holes[n].stage=t[n].stage,this.holes[n].vipLv=t[n].vipLv;this.setTotemsTalentAttr()},t.prototype.getUpgradeItemMoney=function(e){var t=0;for(var i in this.upgradeItem)if(this.upgradeItem[i].id==e){t=this.upgradeItem[i].needMoney;break}return t},t.prototype.setTotemsTalentAttr=function(){for(var e=0;e<3;e++)this.totemsTalentAttr[e]={},this.totemsTalentAttr[e][c.TotemsAttributeType.AllAddLvPVE]=!1,this.totemsTalentAttr[e][c.TotemsAttributeType.HightAddForm]=!1},t.prototype.setActorData=function(e){var t=this.totemsTalentAttr;if(C.default.instance.isSingle||T.default.instance.isSetSandTab)for(var i in t)t[i][c.TotemsAttributeType.AllAddLvPVE]&&e.level++;return e},t.prototype.getTotemsAddLevel=function(e){var t=0,i=v.default.instance.getCardConfCardType(e)-1;(C.default.instance.isSingle||T.default.instance.isSetSandTab)&&(this.totemsTalentAttr[i][c.TotemsAttributeType.AllAddLvPVE]&&t++);return t},t.prototype.setUpgrade=function(e){var t=this.totemsTalentAttr,i=this.formTotemsData,n=v.default.instance.getCardConfCardType(e.cardid)-1;return t[n][c.TotemsAttributeType.HightAddForm]&&i[n][c.TotemsAttributeType.HightAddForm]&&(i[n][c.TotemsAttributeType.HightAddForm]=!1,e.grade++),e},t.prototype.setHaveUpgrade=function(){var e=this.totemsTalentAttr,t=!1;for(var i in e)if(e[i][c.TotemsAttributeType.HightAddForm]){t=!0;break}return t},t.prototype.setTotemsRatio=function(){this.totemsRatio={},this.setTotemsTalentAttr();var e=null;for(var t in this.totemsSerData)for(var i in e=this.totemsSerData[t].talent){var n=this.talentData[t][e[i]];n.damageType!=c.TotemsAttributeType.AllAddLvPVE&&n.damageType!=c.TotemsAttributeType.HightAddForm||(this.totemsTalentAttr[t][n.damageType]=!0)}},t.prototype.isUnlockBranch=function(e){var t=this.branchUnlock[e];return S.default.instance.checkIsPass(t.unlockChapter-1,t.unlockSection-1)?null:t},t.prototype.initFightData=function(){for(var e=0;e<3;e++)this.formTotemsData[e]||(this.formTotemsData[e]={}),this.formTotemsData[e][c.TotemsAttributeType.AllAddLvPVE]=!0,this.formTotemsData[e][c.TotemsAttributeType.HightAddForm]=!0},t.prototype.getGrade=function(e){var t=this.rate[0].grade;for(var i in this.rate){var n=this.rate[i].range[0],o=this.rate[i].range[1];if(e>=n&&o>=e){t=this.rate[i].grade;break}}return t},t.prototype.getAttrType=function(e){return this.totemConfig[e].reshuffle},t.prototype.getAttrTypeConfig=function(){return this.totemConfig[this.nowIndex]},t.prototype.listNotification=function(){this.addProto("toteminfo",this.settoteminfo,this),this.addProto("ttmupgrade",this.ttmupgradeRes,this),this.addProto("ttmupstart",this.ttmupstartRes,this),this.addProto("ttmreshuffle",this.ttmreshuffleRes,this),this.addProto("ttmreplace",this.ttmreshuffleRes,this),this.addProto("ttmtalent",this.ttmtalentRes,this),o.GameEventDispatcher.instance.on(a.EventDefiner.MorphologicalTags_onClick,this.setChooseGrade,this)},t.prototype.setChooseGrade=function(e){var t=e.detail.tabIndex;this.chooseGrade=t,o.GameEventDispatcher.instance.emit(a.EventDefiner.ToeamsUpdateData)},t.prototype.settoteminfo=function(e){for(var t=e.totem,i=0;i<t.length;i++)this.totemsSerData[i]=new d.TotemsSerVo(t[i],i);this.setTotemsRatio();var n=m.default.instance.setTimeout(function(){m.default.instance.clearTimeout(n),y.TotemsUtils.setRed()},this,500)},t.prototype.ttmupgradeRes=function(e){this.totemsSerData[e.index].updateData(e.totem),this.setTotemsRatio(),this.pageIndex==c.TotemsPageType.Strengthen&&this.nowIndex==e.index&&(g.default.instance.isDong=!0,g.default.instance.setProgressData(),o.GameEventDispatcher.instance.emit(a.EventDefiner.ToeamsUpdateData)),y.TotemsUtils.setRed()},t.prototype.sendTtmupgradeReq=function(e,t){_.default.instence.setImgState(b.RoleImgType.Strengthen);var i={cmd:"ttmupgrade",index:this.nowIndex,needItem:e,isAutoBuy:t};s.default.instance.sendProto(i)},t.prototype.ttmupstartRes=function(e){var t=this;this.totemsSerData[e.index].updateData(e.totem);var i=this.totemsSerData[e.index];o.GameEventDispatcher.instance.emit(a.EventDefiner.ToeamsUpdateData),this.oldData.getLevel()!=i.getLevel()&&p.default.instance.openWindow(h.WindowType.TotemsUpgrade,function(){u.default.instance.initInfo(t.oldData,i)},this),this.setTotemsRatio()},t.prototype.sendTtmupstartReq=function(e){this.oldData=new d.TotemsSerVo(null,this.nowIndex);var t=JSON.parse(JSON.stringify(this.totemsSerData[this.nowIndex]));for(var i in t)this.oldData[i]=t[i];this.totemsSerData[this.nowIndex].star%5+1<=4&&_.default.instence.setImgState(b.RoleImgType.AddProduct);var n={cmd:"ttmupstart",index:this.nowIndex,isAutoBuy:e};s.default.instance.sendProto(n)},t.prototype.ttmreshuffleRes=function(e){e.flag&&(this.totemsSerData[this.nowIndex].reshuffle[e.rshidx]=e.newAttr),o.GameEventDispatcher.instance.emit(a.EventDefiner.ToeamsUpdateData),o.GameEventDispatcher.instance.emit(a.EventDefiner.ToeamsUpdateClear,e),this.setTotemsRatio()},t.prototype.sendTtmreshuffleReq=function(e,t){var i;void 0===t&&(t=!1),i=e?{cmd:"ttmreplace",index:this.nowIndex,rshidx:this.holeIndex}:{cmd:"ttmreshuffle",index:this.nowIndex,rshidx:this.holeIndex,isAutoBuy:t},s.default.instance.sendProto(i)},t.prototype.ttmtalentRes=function(e){this.totemsSerData[e.index].updateData(e.totem),o.GameEventDispatcher.instance.emit(a.EventDefiner.ToeamsUpdateData),this.setTotemsRatio()},t.prototype.sendTtmtalentReq=function(e,t){var i={cmd:"ttmpartake",index:this.nowIndex,tltidx:e};t&&(i.cmd="ttmremove"),s.default.instance.sendProto(i)},t.prototype.isUnlockClear=function(e){return!!this.totemsSerData[this.nowIndex].reshuffle[e]},t.instance=null,t=i=__decorate([w],t)}(n.default));i.default=D,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/TimeController":"TimeController","../../Core/WindowType":"WindowType","../../NetConnect/NetConnet":"NetConnet","../Activity/ActivityController":"ActivityController","../Functionicon/FunctionIconController":"FunctionIconController","../OpenWin/OpenWinController":"OpenWinController","../Role/RoleStrengthen/RoleStrengthenController":"RoleStrengthenController","../Role/RoleStrengthen/RoleStrengthenEvent":"RoleStrengthenEvent","../Status/StatusController":"StatusController","../WarTeam/MonsterController":"MonsterController","./TotemsConst":"TotemsConst","./TotemsRateVo":"TotemsRateVo","./TotemsSerVo":"TotemsSerVo","./TotemsUpgradeWin":"TotemsUpgradeWin","./TotemsUtils":"TotemsUtils","./TotemsVo":"TotemsVo","./TotemsWin":"TotemsWin"}],TotemsGiftedPlayertItem:[function(e,t,i){"use strict";cc._RF.push(t,"3398aE20nZEv4MMBltJe60h","TotemsGiftedPlayertItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/Language"),a=e("../../Core/CommonsResManager"),r=e("./TotemsConst"),s=e("./TotemsCtrl"),l=e("../Tips/OpTipsController"),c=cc._decorator,d=c.ccclass,p=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.unlock=null,t.attrStr=null,t.icon=null,t.itemColor=null,t.buttons=[],t.state=r.TotemsGiftedType.Ununlocked,t.index=null,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this),this.itemColor.spriteFrame=a.default.instance.getSpriteFrameByName("bag3")},t.prototype.initData=function(e){this.index=e},t.prototype.updateData=function(e,t,i){for(var n in this.state=t,this.buttons)this.buttons[n].node.active=!1;this.buttons[t].node.active=!0;var l=s.default.instance.talentData[r.TotemsType.Front][i].damageType;this.icon.spriteFrame=a.default.instance.getSpriteFrameByName("icon_j"+l);var c=s.default.instance.talentName[l];this.attrStr.string=o.default.getStr("5"+l,c,Math.floor(e.ratio/100)),this.unlock.string=o.default.getStr("5524",this.index+1)},t.prototype.onClickSend=function(e){var t=s.default.instance.nowIndex,i=s.default.instance.totemsSerData[t];this.state==r.TotemsGiftedType.Unload||i.slot!=i.talent.length?s.default.instance.sendTtmtalentReq(this.index,this.state==r.TotemsGiftedType.Unload):l.default.instance.ShowMsg(o.default.getStr("5551"))},__decorate([p(cc.Label)],t.prototype,"unlock",void 0),__decorate([p(cc.Label)],t.prototype,"attrStr",void 0),__decorate([p(cc.Sprite)],t.prototype,"icon",void 0),__decorate([p(cc.Sprite)],t.prototype,"itemColor",void 0),__decorate([p([cc.Button])],t.prototype,"buttons",void 0),t=__decorate([d],t)}(n.default);i.default=h,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Language":"Language","../../Core/Widget":"Widget","../Tips/OpTipsController":"OpTipsController","./TotemsConst":"TotemsConst","./TotemsCtrl":"TotemsCtrl"}],TotemsLevelVo:[function(e,t,i){"use strict";cc._RF.push(t,"26fa7IysWJDo6+HpSvXE1MY","TotemsLevelVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./TotemsNeedItemVo"),o=e("./TotemsCtrl"),a=function(){return function(e){this.needItem=[],this.prop=e.prop,this.exp=e.exp;var t=o.default.instance.config.needItem[e.needItem];for(var i in t)this.needItem.push(new n.TotemsNeedItemVo(t[i]))}}();i.TotemsLevelVo=a,cc._RF.pop()},{"./TotemsCtrl":"TotemsCtrl","./TotemsNeedItemVo":"TotemsNeedItemVo"}],TotemsNeedItemVo:[function(e,t,i){"use strict";cc._RF.push(t,"b4158gFVklBHYeWBI1m+Wjb","TotemsNeedItemVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){return function(e){for(var t in e)this[t]=e[t]}}();i.TotemsNeedItemVo=n,cc._RF.pop()},{}],TotemsRateVo:[function(e,t,i){"use strict";cc._RF.push(t,"68e5d9/v0lECL+cxGhxbDg0","TotemsRateVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){return function(e){for(var t in e)this[t]=e[t]}}();i.TotemsRateVo=n,cc._RF.pop()},{}],TotemsReshuffleVo:[function(e,t,i){"use strict";cc._RF.push(t,"070eeP2bNZP0JO9zpSO+Pzq","TotemsReshuffleVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./TotemsRateVo"),o=e("./TotemsCtrl"),a=function(){return function(e){this.rate=[],this.type=e.type,this.attr=o.default.instance.config.attr[e.attr];var t=o.default.instance.config.rate[e.rate];for(var i in t)this.rate.push(new n.TotemsRateVo(t[i]))}}();i.TotemsReshuffleVo=a,cc._RF.pop()},{"./TotemsCtrl":"TotemsCtrl","./TotemsRateVo":"TotemsRateVo"}],TotemsSerVo:[function(e,t,i){"use strict";cc._RF.push(t,"0a43aFcb+dBrowFCPc7xn9x","TotemsSerVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./TotemsCtrl"),o=e("../../Util/UtilsFight"),a=e("../Item/ItemController"),r=e("../WarTeam/MonsterController"),s=function(){function e(e,t){this.type=null,this.star=null,this.level=null,this.exp=null,this.talent=null,this.reshuffle=null,this.slot=null,this.hole=null,this.tltstatus=null,this.allAttrs={},this.type=t,this.updateData(e)}return e.prototype.getLevel=function(){return Math.floor(this.star/5)+1},e.prototype.updateData=function(e){for(var t in e)this[t]="level"==t?e[t]+1:e[t]},Object.defineProperty(e.prototype,"levelAttr",{get:function(){for(var e=n.default.instance.totemConfig[this.type].level,t={0:0,1:0,2:0},i=this.level-1,o=0;o<e[i].prop.length;o++)t[o]+=e[i].prop[o];return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextLevelAttr",{get:function(){for(var e=n.default.instance.totemConfig[this.type].level,t={0:0,1:0,2:0},i=e[this.level+1]?this.level:this.level-1,o=0;o<e[i].prop.length;o++)t[o]+=e[i].prop[o];return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextStarAttr",{get:function(){for(var e=n.default.instance.totemConfig[this.type].star,t={0:0,1:0,2:0},i=e[this.star+1]?this.star+1:this.star,o=0;o<e[i].prop.length;o++)t[o]+=e[i].prop[o];return t},enumerable:!0,configurable:!0}),e.prototype.isHaveNextStar=function(){return!!n.default.instance.totemConfig[this.type].star[this.star+1]},Object.defineProperty(e.prototype,"starAttr",{get:function(){for(var e=n.default.instance.totemConfig[this.type].star,t={0:0,1:0,2:0},i=0;i<e[this.star].prop.length;i++)t[i]+=e[this.star].prop[i];return t},enumerable:!0,configurable:!0}),e.prototype.initAllAttr=function(){for(var e=0;e<7;e++)this.allAttrs[e]=0},Object.defineProperty(e.prototype,"allAttr",{get:function(){for(var e in this.initAllAttr(),this.levelAttr)this.allAttrs[e]+=this.levelAttr[e];for(var e in this.starAttr)this.allAttrs[e]+=this.starAttr[e];for(var e in this.reshuffle)this.reshuffle[e]&&(this.allAttrs[this.reshuffle[e].type]+=this.reshuffle[e].value);return this.allAttrs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reshuFight",{get:function(){for(var e in this.initAllAttr(),this.reshuffle)this.reshuffle[e]&&(this.allAttrs[this.reshuffle[e].type]+=this.reshuffle[e].value);var t=n.default.instance,i=r.default.instance.getAttrPrecentByGradeAndType(n.default.instance.chooseGrade,this.allAttrs);return o.default.cptFight(t.nowIndex+1,i)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allResshuFIght",{get:function(){this.initAllAttr();var e=n.default.instance.nowIndex,t=(n.default.instance.holeIndex,n.default.instance.getAttrType(e));for(var i in this.reshuffle)this.reshuffle[i]&&(this.allAttrs[this.reshuffle[i].type]+=t[this.reshuffle[i].type].attr[this.getLevel()-1].max);var a=n.default.instance;return o.default.cptFight(a.nowIndex+1,this.allAttrs)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getReshuStr",{get:function(){var e=this.reshuFight,t=this.allResshuFIght;return n.default.instance.getGrade(e/t*100)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextLevelExp",{get:function(){var e=n.default.instance.totemConfig[this.type].level;return e[this.level]?e[this.level-1].exp:this.exp},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"needMoney",{get:function(){for(var e,t,i,o=n.default.instance.upgradeItem,r=n.default.instance.nowIndex,s=n.default.instance.totemsSerData[r],l=[],c=[],d=s.nextLevelExp-s.exp,p=0;p<o.length;p++){var h=void 0;if(e=a.default.instance.getItemNum(o[p].id),t=o[p].exp,i=!1,e){c.push(p);for(var u=1;u<=e;u++)if((d-=t)<=0){h=u,i=!0;break}l.push({id:o[p].id,count:h||e})}if(i)break}l.length||l.push({id:o[0].id,count:Math.ceil(d/o[0].exp)});var f=0;for(var g in l)f+=l[g].count*n.default.instance.getUpgradeItemMoney(l[g].id);return f},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"needStarItem",{get:function(){var e=n.default.instance.totemConfig[this.type].star;return e[this.star],e[this.star].needItem},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"unlockStr",{get:function(){var e=Math.floor((this.star+1)/5);return!!n.default.instance.totemConfig[this.type].condition[e+1]},enumerable:!0,configurable:!0}),e}();i.TotemsSerVo=s,cc._RF.pop()},{"../../Util/UtilsFight":"UtilsFight","../Item/ItemController":"ItemController","../WarTeam/MonsterController":"MonsterController","./TotemsCtrl":"TotemsCtrl"}],TotemsStarVo:[function(e,t,i){"use strict";cc._RF.push(t,"9df28+BGntAlJB6IkRs88Ha","TotemsStarVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./TotemsNeedItemVo"),o=e("./TotemsCtrl"),a=function(){return function(e){this.needItem=[],this.prop=e.prop;var t=o.default.instance.config.needItem[e.needItem];for(var i in t)this.needItem.push(new n.TotemsNeedItemVo(t[i]))}}();i.TotemsStarVo=a,cc._RF.pop()},{"./TotemsCtrl":"TotemsCtrl","./TotemsNeedItemVo":"TotemsNeedItemVo"}],TotemsStrengthenItem:[function(e,t,i){"use strict";cc._RF.push(t,"54491aUv7RMdKcTq2o0PHRW","TotemsStrengthenItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../Commons/Image"),a=e("../../Util/NumberUtil"),r=e("../Item/ItemData"),s=e("../../Core/Language"),l=e("../Item/ItemController"),c=e("../../Core/CommonsResManager"),d=e("../../Util/Utils"),p=e("../../GlobalContext"),h=cc._decorator,u=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Icon=null,t.ItemColor=null,t.ItemCount=null,t.expAdd=null,t.CountBg=null,t.InitIcon=null,t.effect=null,t.Iteminfo=null,t.num=null,t}return __extends(t,e),t.prototype.show=function(){this.effect.on("finished",this.hideEffect,this),this.effect.node.active=!1},t.prototype.hideEffect=function(){this.effect.node.active=!1},t.prototype.onClickOpenItemTipsWin=function(){l.default.instance.openItemTips(this.Iteminfo)},t.prototype.hide=function(){this.effect.off("finished",this.hideEffect,this)},t.prototype.playEffect=function(){this.effect.node.active=!0,this.effect.play()},t.prototype.setData=function(e){this.expAdd.string=s.default.getStr("5514",e.exp);var t=this.num=l.default.instance.getItemNum(e.id),i=r.default.creatItem(e.id,t);this.ItemData(i)},t.prototype.ItemData=function(e){this.Iteminfo=e,this.Iteminfo.AltsName&&""!=this.Iteminfo.AltsName&&this.Iteminfo.ItemIcon&&""!=this.Iteminfo.ItemIcon&&this.setItemIcon(),this.setItemCount(e.count),this.ItemColor.spriteFrame=c.default.instance.getSpriteFrameByName("bag"+e.colorIndex)},t.prototype.setItemIcon=function(){var e=p.GlobalContext.ResRoot+"resources/itemicon/"+this.Iteminfo.ItemIcon+".png";d.default.setImage(this.InitIcon.node,e),this.InitIcon.node.active=!0},t.prototype.setItemCount=function(e){this.ItemCount.string=a.NumberUtil.getNumber(e)+""},__decorate([f(cc.Sprite)],t.prototype,"Icon",void 0),__decorate([f(cc.Sprite)],t.prototype,"ItemColor",void 0),__decorate([f(cc.Label)],t.prototype,"ItemCount",void 0),__decorate([f(cc.Label)],t.prototype,"expAdd",void 0),__decorate([f(cc.Node)],t.prototype,"CountBg",void 0),__decorate([f(o.default)],t.prototype,"InitIcon",void 0),__decorate([f(cc.Animation)],t.prototype,"effect",void 0),t=__decorate([u],t)}(n.default);i.default=g,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Language":"Language","../../Core/Widget":"Widget","../../GlobalContext":"GlobalContext","../../Util/NumberUtil":"NumberUtil","../../Util/Utils":"Utils","../Commons/Image":"Image","../Item/ItemController":"ItemController","../Item/ItemData":"ItemData"}],TotemsTalentItem:[function(e,t,i){"use strict";cc._RF.push(t,"b3fac42Gf5MbK94AiF5n/Tf","TotemsTalentItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/Language"),a=e("../../Core/CommonsResManager"),r=e("./TotemsConst"),s=e("./TotemsCtrl"),l=e("../../Core/GameEventDispatcher"),c=e("../../Core/Event"),d=cc._decorator,p=d.ccclass,h=d.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.unlock=null,t.add=null,t.icon=null,t.itemColor=null,t.state=null,t.index=null,t.tltidx=null,t}return __extends(t,e),t.prototype.initData=function(e){this.index=e},t.prototype.updateData=function(e,t){switch(this.state=null!=e?t?r.TotemsTalentType.Have:r.TotemsTalentType.Unlock:t?r.TotemsTalentType.Unlock:r.TotemsTalentType.Ununlocked,this.tltidx=e,this.add.node.active=!1,this.unlock.active=!1,this.itemColor.spriteFrame=a.default.instance.getSpriteFrameByName("bag_kong2"),this.icon.spriteFrame=null,this.state){case r.TotemsTalentType.Have:this.itemColor.spriteFrame=a.default.instance.getSpriteFrameByName("bag3");var i=s.default.instance.talentData[r.TotemsType.Front][this.tltidx].damageType;this.icon.spriteFrame=a.default.instance.getSpriteFrameByName("icon_j"+i);break;case r.TotemsTalentType.Unlock:this.add.node.active=!0;break;case r.TotemsTalentType.Ununlocked:this.unlock.active=!0;var n=o.default.getStr("5510",s.default.instance.unlockTalent[this.index]);this.unlock.getChildByName("label").getComponent(cc.Label).string=n}},t.prototype.onClickJump=function(){var e=null;switch(this.state){case r.TotemsTalentType.Have:case r.TotemsTalentType.Unlock:e=r.TotemsPageType.Talent;break;case r.TotemsTalentType.Ununlocked:e=r.TotemsPageType.Advanced}e!=s.default.instance.pageIndex?l.GameEventDispatcher.instance.emit(c.EventDefiner.ToeamsJumpPage,e):e==r.TotemsPageType.Talent&&s.default.instance.sendTtmtalentReq(this.tltidx,!0)},__decorate([h(cc.Node)],t.prototype,"unlock",void 0),__decorate([h(cc.Sprite)],t.prototype,"add",void 0),__decorate([h(cc.Sprite)],t.prototype,"icon",void 0),__decorate([h(cc.Sprite)],t.prototype,"itemColor",void 0),t=__decorate([p],t)}(n.default);i.default=u,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/Widget":"Widget","./TotemsConst":"TotemsConst","./TotemsCtrl":"TotemsCtrl"}],TotemsUnlockItem:[function(e,t,i){"use strict";cc._RF.push(t,"84fb3g5XWpFwKzEtQRMtBd9","TotemsUnlockItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/CommonsResManager"),a=cc._decorator,r=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Name=null,t.add=null,t.icon=null,t.itemColor=null,t}return __extends(t,e),t.prototype.setData=function(e,t,i){this.add.node.active=!e,this.Name.string=t,this.itemColor.spriteFrame=o.default.instance.getSpriteFrameByName(e?"bag3":"bag_kong2"),this.icon.spriteFrame=i?o.default.instance.getSpriteFrameByName("icon_j"+i):null},__decorate([s(cc.Label)],t.prototype,"Name",void 0),__decorate([s(cc.Sprite)],t.prototype,"add",void 0),__decorate([s(cc.Sprite)],t.prototype,"icon",void 0),__decorate([s(cc.Sprite)],t.prototype,"itemColor",void 0),t=__decorate([r],t)}(n.default);i.default=l,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Widget":"Widget"}],TotemsUpgradeWin:[function(e,t,i){"use strict";cc._RF.push(t,"a617cUR6aROnortC6qAlNMf","TotemsUpgradeWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/WindowManager"),a=e("../../Util/Utils"),r=e("../../Core/WindowType"),s=e("./TotemsCtrl"),l=e("../../Core/Language"),c=e("./TotemsUnlockItem"),d=e("../../GlobalContext"),p=e("./TotemsConst"),h=cc._decorator,u=h.ccclass,f=h.property,g=function(e){function t(){var t=e.call(this)||this;return t.sp=null,t.oldName=null,t.newName=null,t.contents=[],t.content=null,t.unlockName=null,t.unlockItem=null,t.posXType=null,i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.initInfo=function(e,t){var i=s.default.instance.nowIndex,n=s.default.instance.totemConfig[i].name,o=l.default.getStr("5519",e.getLevel(),n);this.oldName.string=o,o=l.default.getStr("5519",t.getLevel(),n),this.newName.string=o;var a=e.starAttr,r=t.starAttr;for(var c in this.contents)this.contents[c].getChildByName("oldNum1").getComponent(cc.Label).string=this.contents[c].getChildByName("oldNum2").getComponent(cc.Label).string=a[c]+"",this.contents[c].getChildByName("value").getComponent(cc.Label).string="+"+(r[c]-a[c]);this.schedule(this.StarsAnim,1),this.showUnlockData(e.getLevel()!=t.getLevel(),t,e.slot!=t.slot)},t.prototype.showUnlockData=function(e,t,i){if(e){if(this.content.active=this.unlockName.node.active=e,!this.content.childrenCount)for(var n=0;n<2;n++){var o=a.default.getNodeByPool(r.PoolType.TotemsUnlockItem,this.unlockItem,d.GlobalContext.Root+"prefab/Totems/TotemsUnlockItem");this.content.addChild(o)}var h=t.getLevel(),u=s.default.instance.talentData[p.TotemsType.Front][h-1].damageType,f=s.default.instance.talentName[u];if(f=l.default.getStr("5525",f),this.content.children[0].active=!0,this.content.children[0].getComponent(c.default).setData(!0,f,u),this.content.children[1].active=!1,i){this.content.children[1].active=!0;var g=s.default.instance.unlockTalent[t.slot];f=l.default.getStr("5526",g),this.content.children[1].getComponent(c.default).setData(!1,f)}}},t.prototype.StarsAnim=function(){var e=cc.instantiate(cc.find("Layer/twoLayer/Stars",this.node));cc.find("Layer/twoLayer/lightEffect",this.node).addChild(e),e.setPosition(0,0),e.active=!0,e.scale=.5,this.posXType=1==this.posXType?-1:1,e.runAction(cc.sequence(cc.spawn(cc.moveBy(2,160*Math.random()*this.posXType,160),cc.sequence(cc.scaleTo(1.5,1),cc.fadeOut(.5))),cc.callFunc(function(){e&&e.destroy()})))},t.prototype.btn_close=function(){for(var e=this.content.childrenCount-1;e>=0;e--)a.default.setNodeToPool(r.PoolType.TotemsUnlockItem,this.content.children[e]);this.content.active=this.unlockName.node.active=!1,this.unschedule(this.schedule),o.default.instance.closeWindow(this.node)},t.instance=null,__decorate([f(cc.Node)],t.prototype,"sp",void 0),__decorate([f(cc.Label)],t.prototype,"oldName",void 0),__decorate([f(cc.Label)],t.prototype,"newName",void 0),__decorate([f([cc.Node])],t.prototype,"contents",void 0),__decorate([f(cc.Node)],t.prototype,"content",void 0),__decorate([f(cc.Label)],t.prototype,"unlockName",void 0),__decorate([f(cc.Prefab)],t.prototype,"unlockItem",void 0),t=i=__decorate([u],t)}(n.default);i.default=g,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/Widget":"Widget","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","./TotemsConst":"TotemsConst","./TotemsCtrl":"TotemsCtrl","./TotemsUnlockItem":"TotemsUnlockItem"}],TotemsUtils:[function(e,t,i){"use strict";cc._RF.push(t,"7f8ddZ4nyFAHavuDPv+fp+9","TotemsUtils"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./TotemsCtrl"),o=e("../../Util/UtilsFight"),a=e("./TotemsConst"),r=e("../Functionicon/FunctionIconController"),s=e("../../Core/WindowType"),l=e("../Item/ItemModel"),c=e("../Commons/RewardUtils"),d=e("../Item/ItemController"),p=e("../../Core/GameEventDispatcher"),h=e("../Gamelayer/Interface/EventInterface"),u=e("../WarTeam/MonsterController"),f=function(){function e(){}return Object.defineProperty(e,"ctrl",{get:function(){return n.default.instance},enumerable:!0,configurable:!0}),e.getSingleAllPower=function(){var e=this.ctrl,t=u.default.instance.getAttrPrecentByGradeAndType(n.default.instance.chooseGrade,e.totemsSerData[e.nowIndex].allAttrs);return o.default.cptFight(e.nowIndex+1,t)},e.getAllPower=function(){var e,t=this.ctrl,i=0;return e=a.TotemsType.Front,i+=o.default.cptFight(e+1,t.totemsSerData[e].allAttrs),e=a.TotemsType.Middle,i+=o.default.cptFight(e+1,t.totemsSerData[e].allAttrs),e=a.TotemsType.After,i+=o.default.cptFight(e+1,t.totemsSerData[e].allAttrs)},e.getCardIdAttr=function(e){var t=this.ctrl,i={};if(r.default.instance.checkIsOpenbyWindowtype(s.WindowType.Totems)){i=t.totemsSerData[e-1].allAttr;var n=t.totemsSerData[e-1].tltstatus;for(var o in n){var a=t.talentData[e-1][o];n[o]&&a.ratio&&(i[a.damageType]=a.ratio)}}return i},e.getStrengthenRed=function(){var e=!1;if(n.default.instance.isUnlockBranch(a.TotemsPageType.Strengthen))return e;for(var t=0;t<3;t++)if(this.getUpgradeRed(t)){e=!0;break}return e},e.getUpgradeRiseRed=function(){var e=!1;if(n.default.instance.isUnlockBranch(a.TotemsPageType.Advanced))return e;for(var t=0;t<3;t++)if(this.getRiseRed(t)){e=!0;break}return e},e.getRed=function(){return!!r.default.instance.checkIsOpenbyWindowtype(s.WindowType.Totems)&&(!!this.getStrengthenRed()||!!this.getUpgradeRiseRed())},e.getUpgradeRed=function(e){var t=this.ctrl,i=t.totemsSerData[e];if(!i.nextLevelExp)return!1;var n,o,a,r=t.totemConfig[e],s=t.upgradeItem,p=i.nextLevelExp-i.exp,h=[],u=[];if(l.default.getCountByid(c.RewardType.Coin)<i.needMoney)return!1;for(var f=0;f<s.length;f++){var g=void 0;if(n=d.default.instance.getItemNum(s[f].id),o=s[f].exp,a=!1,n){u.push(f);for(var y=1;y<=n;y++)if((p-=o)<=0){g=y,a=!0;break}h.push({id:s[f].id,count:g||n})}if(a)break}if(!h.length||p>0)return!1;var m=r.condition[i.getLevel()-1].maxLevel;return!(i.level>=m)},e.setRed=function(){r.default.instance.FuncIconRedDeal(s.WindowType.Totems,this.getRed()),p.GameEventDispatcher.instance.emit(h.EventInterface.TotemsRed,this.getRed())},e.getRiseRed=function(e){void 0===e&&(e=n.default.instance.nowIndex);var t=n.default.instance.totemsSerData[e],i=t.needStarItem,o=!0;if(n.default.instance.isUnlockBranch(a.TotemsPageType.Advanced)||!t.isHaveNextStar())return!1;for(var r in i)if(d.default.instance.getItemNum(i[r].id)<i[r].count)return void(o=!1);return o},e}();i.TotemsUtils=f,cc._RF.pop()},{"../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/WindowType":"WindowType","../../Util/UtilsFight":"UtilsFight","../Commons/RewardUtils":"RewardUtils","../Functionicon/FunctionIconController":"FunctionIconController","../Gamelayer/Interface/EventInterface":"EventInterface","../Item/ItemController":"ItemController","../Item/ItemModel":"ItemModel","../WarTeam/MonsterController":"MonsterController","./TotemsConst":"TotemsConst","./TotemsCtrl":"TotemsCtrl"}],TotemsVo:[function(e,t,i){"use strict";cc._RF.push(t,"4c023JnRadDAbfUj/LxoRMc","TotemsVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./TotemsLevelVo"),o=e("./TotemsReshuffleVo"),a=e("./TotemsNeedItemVo"),r=e("./TotemsCtrl"),s=e("./TotemsConditionVo"),l=e("./TotemsStarVo"),c=function(){return function(e){this.star=[],this.level=[],this.reshuffle=[],this.needItem=[],this.condition=[],this.name=e.name;var t=r.default.instance.config.star[e.star];for(var i in t)this.star.push(new l.TotemsStarVo(t[i]));for(var i in t=r.default.instance.config.level[e.level])this.level.push(new n.TotemsLevelVo(t[i]));for(var i in t=r.default.instance.config.reshuffle[e.reshuffle])this.reshuffle.push(new o.TotemsReshuffleVo(t[i]));for(var i in t=r.default.instance.config.needItem[e.needItem])this.needItem.push(new a.TotemsNeedItemVo(t[i]));for(var i in t=r.default.instance.config.condition[1])this.condition.push(new s.TotemsConditionVo(t[i]))}}();i.TotemsVo=c,cc._RF.pop()},{"./TotemsConditionVo":"TotemsConditionVo","./TotemsCtrl":"TotemsCtrl","./TotemsLevelVo":"TotemsLevelVo","./TotemsNeedItemVo":"TotemsNeedItemVo","./TotemsReshuffleVo":"TotemsReshuffleVo","./TotemsStarVo":"TotemsStarVo"}],TotemsWin:[function(e,t,i){"use strict";cc._RF.push(t,"4c5a7BCzrtAnquHIjGP+RCx","TotemsWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Language"),o=e("../../Core/Window"),a=e("./TotemsConst"),r=e("../../Core/CommonsResManager"),s=e("../../Core/GameEventDispatcher"),l=e("../../Core/Event"),c=e("../Commons/WindowBg1"),d=e("./TotemsAttrItem"),p=e("../../Util/Utils"),h=e("../../Core/WindowType"),u=e("./TotemsCtrl"),f=e("./TotemsTalentItem"),g=e("./TotemsAttrThanItem"),y=e("./TotemsStrengthenItem"),m=e("./TotemsAdvancedItem"),C=e("./TotemsGiftedPlayertItem"),v=e("./TotemsClearItem"),_=e("./TotemsUtils"),b=e("../Item/ItemController"),T=e("../Tips/OpTipsController"),S=e("../../Core/TimeController"),I=e("../Scene/Pool/SpinePools"),w=e("../../Core/SpineBase"),D=e("../../GlobalContext"),R=e("../Item/ItemData"),A=e("../Item/ItemModel"),N=e("../Commons/RewardUtils"),L=e("../Commons/CombatValue"),E=e("../../Core/LoadManager"),B=e("../../Util/RechargeUtils"),M=e("../../Util/RechargeConst"),x=e("../Sound/SoundController"),k=e("../WarTeam/MonsterController"),P=e("../Commons/MorphologicalTags"),G=e("../Tips/TipsWinController"),F=cc._decorator,W=F.ccclass,U=F.property,O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.prefabs=[],t.pagingTitle=null,t.labelCombat=null,t.contentAttr0_1=null,t.contentAttr0_2=null,t.contentAttr1_1=null,t.contentAttr1_2=null,t.label=null,t.progressBar=null,t.progressNum=null,t.strengthenBtn=null,t.item=null,t.contentAttr2_1=null,t.leftLabel=null,t.rightLabel=null,t.unlockLabel=null,t.advancedBtn=null,t.contentAttr2_2=null,t.contentAttr3_1=null,t.contentAttr3_2=null,t.contentAttr4_1=null,t.grade=null,t.score=null,t.switchName=null,t.gradeNum=null,t.gradeNum1=null,t.animations=[],t.skeleton=null,t.particle=null,t.toggle1=null,t.toggle2=null,t.gradeGroup=null,t.isDong=!1,t.canClick=null,t.needItem=[],t.switchNameAny=["i18n_zxtt","i18n_tltt","i18n_lytt"],t.pagingTitleAny=["icon_qian","icon_zhong","icon_hou"],t._selectIndex=a.TotemsPageType.News,t.isFrist=!1,t.isFrist1=!1,t.isFrist2=!1,t.exp=null,t.allExp=null,t.newExp=null,t.speed=null,t.isAdd=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){var t=this;this.loadWindowCom=function(){t.onShowPage()},this.loadWindowComThis=this,this.onInit(h.WindowType.Totems,!0),e.prototype.onLoad.call(this),this.strengthenBtn.getComponentInChildren(cc.Label).string=n.default.getStr("5507"),this.advancedBtn.getComponentInChildren(cc.Label).string=n.default.getStr("5508");var o=this.item.getChildByName("itemIcon"),a=b.default.instance.getItemNum(1),r=R.default.creatItem(1,a);o.attr({count:a,itemdata:r}),o.scale=.5,o.getComponent(cc.Button).clickEvents[0].customEventData="1";var s=D.GlobalContext.ResRoot+"resources/itemicon/"+r.ItemIcon+".png";p.default.setImage(o,s),i.instance=this},t.prototype.onInitData=function(e){this._selectIndex=e,this.onShowPage()},t.prototype.onShowPage=function(){var e=this;if(this.windowBg){var t=this.windowBg.getComponent(c.default);t.TabBtnList._delaySelectedIndexTime=0,t.TabBtnList.selectItem(this._selectIndex),this.updateRed()}else var i=S.default.instance.setTimeout(function(){e.onShowPage(),S.default.instance.clearTimeout(i)},this,50)},t.prototype.show=function(){var t=this;e.prototype.show.call(this),this.isDong=!1,u.default.instance.nowIndex=a.TotemsType.Front;for(var i=0;i<this.animations.length;i++)this.animations[i].active=i==u.default.instance.nowIndex;this.setSwitchBtnState(),this.onUpdateData(),s.GameEventDispatcher.instance.on(l.EventDefiner.ToeamsUpdateData,this.onUpdateData,this),s.GameEventDispatcher.instance.on(l.EventDefiner.ToeamsJumpPage,this.onToeamsJumpPage,this),s.GameEventDispatcher.instance.on(l.EventDefiner.ToeamsPlayUpgradeAnimation,this.playUpgradeAnimation,this),s.GameEventDispatcher.instance.on("BagPackInfoChange",this.onUpdateData,this),this.skeleton.setCompleteListener(this.setEffectsFinished),this.canClick=!0;for(i=1;i<=this.animations.length;i++){I.SpinePools.addSpineNoder(this.animations[i-1],cc.v2(0,0)).getComponent(w.default).initSpineData(D.GlobalContext.Root+"spine/totems/"+i+"/skin",null,"stand",!0)}this.gradeGroup.childrenCount||E.default.instance.loadResByType(D.GlobalContext.Root+"prefab/Common/morphologicalTags",cc.Prefab,function(e){var i=p.default.getNodeByPool(h.PoolType.MorphologicalTags,e,D.GlobalContext.Root+"prefab/Common/morphologicalTags");i.getComponent(P.default).setShow(u.default.instance.chooseGrade),t.gradeGroup.addChild(i)},this)},t.prototype.playParticle=function(){var e=this;this.particle.resetSystem(),this.particle.node.active=!0,this.time=S.default.instance.setTimeout(function(){S.default.instance.clearTimeout(e.time),e.playUpgradeAnimation()},this,1200)},t.prototype.playUpgradeAnimation=function(){x.default.instance.PlayEffect(x.SoundType.upSucceeds),i.instance.skeleton.setAnimation(0,"effect_di",!0)},t.prototype.setEffectsFinished=function(e){var t=i.instance;t.skeleton.clearTracks(),"effect_di"==e.animation.name?(t.skeleton.setAnimation(0,"effect",!0),!t.isClickAdvanced&&t.getNeedItem()&&(t.canClick=!0)):t.isClickAdvanced&&(t.canClick=!0)},t.prototype.nextPlay=function(){x.default.instance.PlayEffect(x.SoundType.upSucceeds),this.isDong=!1,S.default.instance.clearTimeout(this.time),this.particle.stopSystem(),this.particle.node.active=!1,i.instance.skeleton.clearTracks(),i.instance.isClickAdvanced?u.default.instance.sendTtmupstartReq(i.instance.toggle2.isChecked):this.getNeedItem()&&u.default.instance.sendTtmupgradeReq(i.instance.needItem,i.instance.toggle1.isChecked)},t.prototype.closePlay=function(){this.isDong=!1,S.default.instance.clearTimeout(this.time),this.particle.stopSystem(),this.particle.node.active=!1,i.instance.skeleton.clearTracks()},t.prototype.switchBtn=function(e,t){this.isDong&&this.closePlay(),this.canClick=!0,this.animations[u.default.instance.nowIndex].active=!1,"+"==t?u.default.instance.nowIndex++:u.default.instance.nowIndex--,this.animations[u.default.instance.nowIndex].active=!0,this.animations[u.default.instance.nowIndex].children[0].getComponent(w.default).play(),this.setSwitchBtnState(),this.onUpdateData()},t.prototype.setSwitchBtnState=function(){var e=u.default.instance.nowIndex;cc.find("main/left/leftBtn",this.node).active=e!=a.TotemsType.Front,cc.find("main/left/rightBtn",this.node).active=e!=a.TotemsType.After,cc.find("main/left/title/pagingTitle",this.node).getComponent(cc.Sprite).spriteFrame=r.default.instance.getSpriteFrameByName(this.switchNameAny[e]),cc.find("main/left/switchName",this.node).getComponent(cc.Sprite).spriteFrame=r.default.instance.getSpriteFrameByName(this.pagingTitleAny[e])},t.prototype.hide=function(){e.prototype.hide.call(this),this.isFrist=!1,this.isFrist1=!1,this.isFrist2=!1,this.toggle1.isChecked=!1,this.toggle2.isChecked=!1,s.GameEventDispatcher.instance.emit("TotemsHide",this),this.isDong&&this.closePlay(),this.clearNodeToPool(this.contentAttr0_1.childrenCount,this.contentAttr0_1,h.PoolType.TotemsAttrItem),this.clearNodeToPool(this.contentAttr0_2.childrenCount,this.contentAttr0_2,h.PoolType.TotemsTalentItem),this.clearNodeToPool(this.contentAttr1_1.childrenCount,this.contentAttr1_1,h.PoolType.TotemsAttrThanItem),this.clearNodeToPool(this.contentAttr1_2.childrenCount,this.contentAttr1_2,h.PoolType.TotemsStrengthenItem),this.clearNodeToPool(this.contentAttr2_1.childrenCount,this.contentAttr2_1,h.PoolType.TotemsAttrThanItem),this.clearNodeToPool(this.contentAttr2_2.childrenCount,this.contentAttr2_2,h.PoolType.TotemsAdvancedItem),this.clearNodeToPool(this.contentAttr3_1.childrenCount,this.contentAttr3_1,h.PoolType.TotemsTalentItem),this.clearNodeToPool(this.contentAttr3_2.childrenCount,this.contentAttr3_2,h.PoolType.TotemsGiftedPlayertItem),this.clearNodeToPool(this.contentAttr4_1.childrenCount,this.contentAttr4_1,h.PoolType.TotemsClearItem);for(var t=0;t<this.animations.length;t++)I.SpinePools.recoverSpineNoder(this.animations[t].children[0]);s.GameEventDispatcher.instance.off(l.EventDefiner.ToeamsUpdateData,this.onUpdateData,this),s.GameEventDispatcher.instance.off(l.EventDefiner.ToeamsJumpPage,this.onToeamsJumpPage,this),s.GameEventDispatcher.instance.off(l.EventDefiner.ToeamsPlayUpgradeAnimation,this.playUpgradeAnimation,this),s.GameEventDispatcher.instance.off("BagPackInfoChange",this.onUpdateData,this);for(t=this.gradeGroup.childrenCount-1;t>=0;t--)p.default.setNodeToPool(h.PoolType.MorphologicalTags,this.gradeGroup.children[t])},t.prototype.clearNodeToPool=function(e,t,i){for(var n=e-1;n>=0;n--)p.default.setNodeToPool(i,t.children[n])},t.prototype.setProgressData=function(){var e=u.default.instance.nowIndex,t=u.default.instance.totemsSerData[e];this.newExp=t.exp;var i=this.progressNum.string.split("/");this.exp=parseInt(i[0]),this.allExp=parseInt(i[1]),this.speed=(this.allExp-this.exp+this.newExp)/15,this.isAdd=!1},t.prototype.update=function(){if(this.isDong){var e=u.default.instance.nowIndex,t=u.default.instance.totemsSerData[e];if(!this.isAdd&&this.exp<this.allExp){var i=this.exp+this.speed;this.exp=i>this.allExp?this.allExp:i,this.progressBar.getComponent(cc.ProgressBar).progress=Math.floor(this.exp)/this.allExp,this.progressNum.string=n.default.getStr("5505",Math.floor(this.exp),this.allExp)}else if(this.exp==this.allExp&&t.level!=parseInt(this.label.string))this.exp=0,t.nextLevelExp?(this.allExp=t.nextLevelExp,this.newExp>this.speed?this.exp=this.speed:(this.exp=this.newExp,this.isDong=!1),this.progressNum.string=n.default.getStr("5505",Math.floor(this.exp),this.allExp),this.progressBar.getComponent(cc.ProgressBar).progress=Math.floor(this.exp)/this.allExp):(this.strengthenBtn.getComponentInChildren(cc.Label).string=n.default.getStr("5540"),this.progressNum.string="",this.isDong=!1),this.isAdd=!0,this.label.string=t.level+"";else{(i=this.exp+this.speed)>=this.newExp?(this.exp=this.newExp,this.isDong=!1):this.exp=i,this.progressNum.string=n.default.getStr("5505",Math.floor(this.exp),this.allExp),this.progressBar.getComponent(cc.ProgressBar).progress=Math.floor(this.exp)/this.allExp}}},t.prototype.onUpdateData=function(){var e,t,i=this,o=u.default.instance.nowIndex,s=u.default.instance.pageIndex,l=u.default.instance.maxTalentNum,c=u.default.instance.maxBaseNum,b=u.default.instance.totemsSerData[o],T=(u.default.instance.totemConfig[o].reshuffle,u.default.instance.talentData[o]),S=b.star%5+1,I=b.isHaveNextStar()?S+1==6?0:S+1:S,w=b.getLevel(),R="i18n_"+w;switch(this.gradeNum1.node.active=!0,w<=10?(this.gradeNum.spriteFrame=r.default.instance.getSpriteFrameByName(R),this.gradeNum1.spriteFrame=null,this.gradeNum1.node.active=!1):w<=19?(R="i18n_"+(w-10),this.gradeNum.spriteFrame=r.default.instance.getSpriteFrameByName("i18n_10"),this.gradeNum1.spriteFrame=r.default.instance.getSpriteFrameByName(R)):(R="i18n_"+(w+"")[0],this.gradeNum.spriteFrame=r.default.instance.getSpriteFrameByName(R),R="i18n_"+(w+"")[1],this.gradeNum1.spriteFrame=r.default.instance.getSpriteFrameByName(R)),s){case a.TotemsPageType.News:if(!this.contentAttr0_1.childrenCount){t=u.default.instance.getAttrType(o);for(var N=0;N<t.length;N++)e=p.default.getNodeByPool(h.PoolType.TotemsAttrItem,this.prefabs[0],D.GlobalContext.Root+"prefab/Totems/TotemsAttrItem"),this.contentAttr0_1.addChild(e),e.getComponent(d.default).initData(N)}var B=b.allAttr;B=k.default.instance.getAttrPrecentByGradeAndType(u.default.instance.chooseGrade,B);for(N=0;N<this.contentAttr0_1.children.length;N++)this.contentAttr0_1.children[N].getComponent(d.default).updateData(B[N]);if(!this.contentAttr0_2.childrenCount)for(N=1;N<=l;N++)e=p.default.getNodeByPool(h.PoolType.TotemsTalentItem,this.prefabs[1],D.GlobalContext.Root+"prefab/Totems/TotemsTalentItem"),this.contentAttr0_2.addChild(e),e.getComponent(f.default).initData(N);for(N=0;N<this.contentAttr0_2.children.length;N++)this.contentAttr0_2.children[N].getComponent(f.default).updateData(b.talent[N],N<b.slot);p.default.setNodeChildDestoryByUrl(this.labelCombat,D.GlobalContext.Root+"prefab/CombatVal"),E.default.instance.loadResByType(D.GlobalContext.Root+"prefab/CombatVal",cc.Prefab,function(e){var t=p.default.getNodeByUrl(e,D.GlobalContext.Root+"prefab/CombatVal");i.labelCombat.addChild(t),t.getComponent(L.default).onInit(_.TotemsUtils.getSingleAllPower(),24,1,!1,!1)},this);break;case a.TotemsPageType.Strengthen:this.strengthenBtn.interactable=!!b.nextLevelExp;var M=n.default.getStr("5507");if(this.isDong||(this.progressBar.getComponent(cc.ProgressBar).progress=b.exp/b.nextLevelExp,this.label.string=b.level+"",b.nextLevelExp?this.progressNum.string=n.default.getStr("5505",b.exp,b.nextLevelExp):(M=n.default.getStr("5540"),this.progressNum.string="")),this.strengthenBtn.getComponentInChildren(cc.Label).string=M,!this.contentAttr1_1.childrenCount)for(N=0;N<c;N++)e=p.default.getNodeByPool(h.PoolType.TotemsAttrThanItem,this.prefabs[2],D.GlobalContext.Root+"prefab/Totems/TotemsAttrThanItem"),this.contentAttr1_1.addChild(e),e.getComponent(g.default).initData(N);var x=b.levelAttr,P=b.nextLevelAttr;x=k.default.instance.getAttrPrecentByGradeAndType(u.default.instance.chooseGrade,x),P=k.default.instance.getAttrPrecentByGradeAndType(u.default.instance.chooseGrade,P);var G=u.default.instance.upgradeItem;for(N=0;N<this.contentAttr1_1.children.length;N++)this.contentAttr1_1.children[N].getComponent(g.default).updateData(x[N],P[N]);if(!this.contentAttr1_2.childrenCount)for(N=0;N<G.length;N++)e=p.default.getNodeByPool(h.PoolType.TotemsStrengthenItem,this.prefabs[3],D.GlobalContext.Root+"prefab/Totems/TotemsStrengthenItem"),this.contentAttr1_2.addChild(e);for(N=0;N<this.contentAttr1_2.children.length;N++)this.contentAttr1_2.children[N].getComponent(y.default).setData(G[N]);this.item.getChildByName("label").getComponent(cc.Label).string=b.needMoney+"",this.item.getChildByName("label").getComponent(cc.Label).node.color=A.default.getCountByid(1)>=b.needMoney?new cc.Color(48,24,16):new cc.Color(255,0,0);break;case a.TotemsPageType.Advanced:if(!this.contentAttr2_1.childrenCount)for(N=0;N<c;N++)e=p.default.getNodeByPool(h.PoolType.TotemsAttrThanItem,this.prefabs[2],D.GlobalContext.Root+"prefab/Totems/TotemsAttrThanItem"),this.contentAttr2_1.addChild(e),e.getComponent(g.default).initData(N);var F=b.starAttr,W=b.nextStarAttr;F=k.default.instance.getAttrPrecentByGradeAndType(u.default.instance.chooseGrade,F),W=k.default.instance.getAttrPrecentByGradeAndType(u.default.instance.chooseGrade,W);for(N=0;N<this.contentAttr2_1.children.length;N++)this.contentAttr2_1.children[N].getComponent(g.default).updateData(F[N],W[N]);var U=b.needStarItem;if(this.contentAttr2_2.childrenCount)for(N=this.contentAttr2_2.childrenCount-1;N>=0;N--)p.default.setNodeToPool(h.PoolType.TotemsAdvancedItem,this.contentAttr2_2.children[N]);for(N=0;N<U.length;N++)e=p.default.getNodeByPool(h.PoolType.TotemsAdvancedItem,this.prefabs[4],D.GlobalContext.Root+"prefab/Totems/TotemsAdvancedItem"),this.contentAttr2_2.addChild(e);for(var O in this.contentAttr2_2.children)this.contentAttr2_2.children[O].getComponent(m.default).updateData(U[O]);this.leftLabel.string=n.default.getStr("5518",w,S),this.rightLabel.string=n.default.getStr("5518",S>I?w+1:w,I||1);var V=u.default.instance.unlockTalent[b.slot+1];M=T[w]?u.default.instance.talentName[u.default.instance.talentData[0][w].damageType]:null;if(this.advancedBtn.interactable=W[0]!=F[0],this.advancedBtn.getComponentInChildren(cc.Label).string=n.default.getStr(W[0]==F[0]?"5527":"5508"),M){var q=n.default.getStr("5525",M),H="";V&&w+1==V&&(H=n.default.getStr("5526",V)),this.unlockLabel.string=n.default.getStr("5512",w+1,q,H)}else this.unlockLabel.string="";break;case a.TotemsPageType.Talent:if(!this.contentAttr3_1.childrenCount)for(N=1;N<=l;N++)e=p.default.getNodeByPool(h.PoolType.TotemsTalentItem,this.prefabs[1],D.GlobalContext.Root+"prefab/Totems/TotemsTalentItem"),this.contentAttr3_1.addChild(e),e.getComponent(f.default).initData(N);for(N=0;N<this.contentAttr3_1.children.length;N++)this.contentAttr3_1.children[N].getComponent(f.default).updateData(b.talent[N],N<b.slot);if(!this.contentAttr3_2.childrenCount)for(N=0;N<T.length;N++)e=p.default.getNodeByPool(h.PoolType.TotemsGiftedPlayertItem,this.prefabs[5],D.GlobalContext.Root+"prefab/Totems/TotemsGiftedPlayertItem"),this.contentAttr3_2.addChild(e),e.getComponent(C.default).initData(N);for(N=0;N<this.contentAttr3_2.children.length;N++){var j=b.tltstatus[N]?b.tltstatus[N]:a.TotemsGiftedType.Ununlocked;this.contentAttr3_2.children[N].getComponent(C.default).updateData(T[N],j,N)}break;case a.TotemsPageType.Clear:if(!this.contentAttr4_1.childrenCount)for(N=0;N<l;N++)e=p.default.getNodeByPool(h.PoolType.TotemsClearItem,this.prefabs[6],D.GlobalContext.Root+"prefab/Totems/TotemsClearItem"),this.contentAttr4_1.addChild(e),e.getComponent(v.default).initData(N);for(N=0;N<this.contentAttr4_1.children.length;N++)this.contentAttr4_1.children[N].getComponent(v.default).updateData(u.default.instance.isUnlockClear(N));this.grade.spriteFrame=r.default.instance.getSpriteFrameByName(b.getReshuStr),this.score.string=b.reshuFight+""}this.updateRed()},t.prototype.getNeedItem=function(){var e=this;this.needItem=null;var t,i,o,a,r=u.default.instance.nowIndex,s=u.default.instance.totemsSerData[r],l=u.default.instance.totemConfig[r],c=u.default.instance.upgradeItem,d=s.nextLevelExp-s.exp,p=[];if(this.addEff=[],A.default.getCountByid(N.RewardType.Coin)<s.needMoney)B.default.PurchaseItemOrRechage(M.RechargeTypeConst.Prop,s.needMoney,null,this,N.RewardType.Coin);else{for(var h=0;h<c.length;h++){var f=void 0;if(t=b.default.instance.getItemNum(c[h].id),i=c[h].exp,o=!1,t){this.addEff.push(h);for(var g=1;g<=t;g++)if((d-=i)<=0){f=g,o=!0;break}p.push({id:c[h].id,count:f||t})}if(o)break}if(o||this.isFrist||this.toggle1.isChecked){if(this.toggle1.isChecked)for(h=0;h<c.length-3;h++){f=void 0;i=c[h].exp,a=!1,this.addEff.push(h);for(g=1;g<=9999999;g++)if((d-=i)<=0){f=g,a=!0;break}if(p.push({id:c[h].id,count:f||t}),a)break}if(p.length&&!(d>0)||this.toggle1.isChecked){var y=l.condition[s.getLevel()-1].maxLevel;if(!(s.level>=y))return this.needItem=p,!0;T.default.instance.ShowMsg(n.default.getStr("5552",s.getLevel()+1))}else B.default.PurchaseItemOrRechage(M.RechargeTypeConst.Prop,1e4,null,this,c[0].id)}else{this.isFrist=!0;G.default.instance.ShowTips("\u662f\u5426\u4f7f\u7528\u81ea\u52a8\u8d2d\u4e70",function(){e.toggle1.isChecked=!0},this,null,1,null,null,function(){B.default.PurchaseItemOrRechage(M.RechargeTypeConst.Prop,1e4,null,e,c[0].id)},this)}}},t.prototype.onClickStrengthenBtn=function(){if(this.getNeedItem())if(this.isDong)for(var e in this.isDong=!1,this.onUpdateData(),this.nextPlay(),this.playParticle(),this.addEff)this.contentAttr1_2.children[this.addEff[e]].getComponent(y.default).playEffect();else{for(var e in this.isClickAdvanced=!1,this.canClick=!1,this.addEff)this.contentAttr1_2.children[this.addEff[e]].getComponent(y.default).playEffect();this.playParticle(),u.default.instance.sendTtmupgradeReq(i.instance.needItem,i.instance.toggle1.isChecked)}},t.prototype.onClickAdvancedBtn=function(){var e=this;if(this.isDong){for(var t in this.nextPlay(),this.contentAttr2_2.children)this.contentAttr2_2.children[t].getComponent(m.default).playEffect();this.playParticle()}else{var n=u.default.instance.nowIndex,o=u.default.instance.totemsSerData[n].needStarItem,a=function(t){if(b.default.instance.getItemNum(o[t].id)<o[t].count&&!r.isFrist1&&!r.toggle2.isChecked){r.isFrist1=!0;return G.default.instance.ShowTips("\u662f\u5426\u4f7f\u7528\u81ea\u52a8\u8d2d\u4e70",function(){e.toggle2.isChecked=!0},r,null,1,null,null,function(){B.default.PurchaseItemOrRechage(M.RechargeTypeConst.Prop,o[t].count,null,e,o[t].id)},r),{value:void 0}}},r=this;for(var t in o){var s=a(t);if("object"==typeof s)return s.value}for(var t in o)if(b.default.instance.getItemNum(o[t].id)<o[t].count&&!this.toggle2.isChecked)return void B.default.PurchaseItemOrRechage(M.RechargeTypeConst.Prop,o[t].count,null,this,o[t].id);for(var t in this.canClick=!1,this.isClickAdvanced=!0,this.contentAttr2_2.children)this.contentAttr2_2.children[t].getComponent(m.default).playEffect();this.playParticle(),u.default.instance.sendTtmupstartReq(i.instance.toggle2.isChecked)}},t.prototype.onToeamsJumpPage=function(e){var t=e.detail;this.windowBg.getComponent(c.default).TabBtnList.selectItem(t)},t.prototype.conditionCallback=function(t){e.prototype.conditionCallback.call(this,t);var i=u.default.instance.isUnlockBranch(t);return i&&T.default.instance.ShowMsg(n.default.getStr("4507",i.unlockChapter,i.unlockSection)),!i},t.prototype.tabBtnSelectedChange=function(e){u.default.instance.pageIndex=e,this.isDong&&this.closePlay(),this.onUpdateData(),cc.find("main/right/title/name",this.node).getComponent(cc.Label).string=this.TabBtnNames[e]},t.prototype.updateRed=function(){if(this.windowBg){var e=this.windowBg.getComponent(c.default);e.TabBtnList.selectItemSetRed(a.TotemsPageType.Strengthen,_.TotemsUtils.getStrengthenRed()),e.TabBtnList.selectItemSetRed(a.TotemsPageType.Advanced,_.TotemsUtils.getUpgradeRiseRed())}},t.instance=null,__decorate([U([cc.Prefab])],t.prototype,"prefabs",void 0),__decorate([U(cc.Sprite)],t.prototype,"pagingTitle",void 0),__decorate([U(cc.Node)],t.prototype,"labelCombat",void 0),__decorate([U(cc.Node)],t.prototype,"contentAttr0_1",void 0),__decorate([U(cc.Node)],t.prototype,"contentAttr0_2",void 0),__decorate([U(cc.Node)],t.prototype,"contentAttr1_1",void 0),__decorate([U(cc.Node)],t.prototype,"contentAttr1_2",void 0),__decorate([U(cc.Label)],t.prototype,"label",void 0),__decorate([U(cc.ProgressBar)],t.prototype,"progressBar",void 0),__decorate([U(cc.Label)],t.prototype,"progressNum",void 0),__decorate([U(cc.Button)],t.prototype,"strengthenBtn",void 0),__decorate([U(cc.Node)],t.prototype,"item",void 0),__decorate([U(cc.Node)],t.prototype,"contentAttr2_1",void 0),__decorate([U(cc.Label)],t.prototype,"leftLabel",void 0),__decorate([U(cc.Label)],t.prototype,"rightLabel",void 0),__decorate([U(cc.RichText)],t.prototype,"unlockLabel",void 0),__decorate([U(cc.Button)],t.prototype,"advancedBtn",void 0),__decorate([U(cc.Node)],t.prototype,"contentAttr2_2",void 0),__decorate([U(cc.Node)],t.prototype,"contentAttr3_1",void 0),__decorate([U(cc.Node)],t.prototype,"contentAttr3_2",void 0),__decorate([U(cc.Node)],t.prototype,"contentAttr4_1",void 0),__decorate([U(cc.Sprite)],t.prototype,"grade",void 0),__decorate([U(cc.Label)],t.prototype,"score",void 0),__decorate([U(cc.Sprite)],t.prototype,"switchName",void 0),__decorate([U(cc.Sprite)],t.prototype,"gradeNum",void 0),__decorate([U(cc.Sprite)],t.prototype,"gradeNum1",void 0),__decorate([U([cc.Node])],t.prototype,"animations",void 0),__decorate([U(sp.Skeleton)],t.prototype,"skeleton",void 0),__decorate([U(cc.ParticleSystem)],t.prototype,"particle",void 0),__decorate([U(cc.Toggle)],t.prototype,"toggle1",void 0),__decorate([U(cc.Toggle)],t.prototype,"toggle2",void 0),__decorate([U(cc.Node)],t.prototype,"gradeGroup",void 0),t=i=__decorate([W],t)}(o.default);i.default=O,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/SpineBase":"SpineBase","../../Core/TimeController":"TimeController","../../Core/Window":"Window","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/RechargeConst":"RechargeConst","../../Util/RechargeUtils":"RechargeUtils","../../Util/Utils":"Utils","../Commons/CombatValue":"CombatValue","../Commons/MorphologicalTags":"MorphologicalTags","../Commons/RewardUtils":"RewardUtils","../Commons/WindowBg1":"WindowBg1","../Item/ItemController":"ItemController","../Item/ItemData":"ItemData","../Item/ItemModel":"ItemModel","../Scene/Pool/SpinePools":"SpinePools","../Sound/SoundController":"SoundController","../Tips/OpTipsController":"OpTipsController","../Tips/TipsWinController":"TipsWinController","../WarTeam/MonsterController":"MonsterController","./TotemsAdvancedItem":"TotemsAdvancedItem","./TotemsAttrItem":"TotemsAttrItem","./TotemsAttrThanItem":"TotemsAttrThanItem","./TotemsClearItem":"TotemsClearItem","./TotemsConst":"TotemsConst","./TotemsCtrl":"TotemsCtrl","./TotemsGiftedPlayertItem":"TotemsGiftedPlayertItem","./TotemsStrengthenItem":"TotemsStrengthenItem","./TotemsTalentItem":"TotemsTalentItem","./TotemsUtils":"TotemsUtils"}],TreasureBuff:[function(e,t,i){"use strict";cc._RF.push(t,"86198IpTl5CNKHIYPn3Po33","TreasureBuff"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../GlobalContext"),a=e("../../Util/Utils"),r=cc._decorator,s=r.ccclass,l=r.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.spriteIcon=null,t.labelLv=null,t}return __extends(t,e),t.prototype.onInitData=function(e,t){var i=o.GlobalContext.ResRoot+"resources/itemicon/"+e+".png";a.default.setImage(this.spriteIcon,i),this.labelLv.node.active=t>1,this.labelLv.string=t+""},__decorate([l(cc.Node)],t.prototype,"spriteIcon",void 0),__decorate([l(cc.Label)],t.prototype,"labelLv",void 0),t=__decorate([s],t)}(n.default);i.default=c,cc._RF.pop()},{"../../Core/Widget":"Widget","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils"}],TreasureConfig:[function(e,t,i){"use strict";cc._RF.push(t,"e610dTlkcpKpLPpT/I5hvkD","TreasureConfig"),Object.defineProperty(i,"__esModule",{value:!0}),function(e){e.treasureFightResult="treasureFightResult",e.treasureRemainFight="treasureRemainFight",e.treasureShopConfire="treasureShopConfire",e.treasureBuffAdd="treasureBuffAdd",e.treasureDataRefresh="treasureDataRefresh",e.treasureBuy="treasureBuy",e.treasureOut="treasureOut"}(i.TreasureConfig||(i.TreasureConfig={})),cc._RF.pop()},{}],TreasureData:[function(e,t,i){"use strict";cc._RF.push(t,"ec1ccXCskRPaK6ks9Tu08Bd","TreasureData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./TreasureLevelData"),o=cc._decorator,a=o.ccclass,r=(o.property,function(){function e(){this.levelCount=0,this.currentLevel=0,this.remainFight=0,this.levelDataList=[],this.currentNodeData=null,this._savePosList=[],this._config=null,this._nodeConfig=null,this._buffList=[],this._reinforcementList=[],this._captureMonsterList=[],this._rewardList=[],this._effectPos=[],this.Event_Type_Monster=1,this.Event_Type_Campsite=2,this.Event_Type_Trap=3,this.Event_Type_medical=4,this.Event_Type_Box=5,this.Event_Type_Shop=6,this.Event_Type_Unkonw=7,this.Event_Type_Elite=8,this.Event_Type_Boss=9,this.Event_Type_CurrentNode=20,this.tips_1=1,this.tips_2=2,this.tips_3=3,this.tips_5=5}return e.prototype.onInitData=function(e,t){this._config=e,this._nodeConfig=t},e.prototype.onInit=function(){this.levelDataList=[],this._savePosList=[],this._rewardList=[],this._buffList=[],this._reinforcementList=[]},e.prototype.onSaveList=function(e,t,i){if(e||i){this.onInit(),this.levelCount=e.length,this.currentLevel=t;var o=[0,4],a=null;if(i&&i.remainFight&&(this.remainFight=i.remainFight),i&&i.posList&&t>1){this._savePosList=i.posList||[],this._rewardList=i.rewardList||[],this._buffList=i.buffList||[],this._reinforcementList=i.reinforcementList||[];for(var r=0;r<this.levelCount;r++){(l=new n.default).onSetData(r,e[r],this._savePosList[r],this.levelCount),this.levelDataList.push(l),a&&(o=this.onCreateWay(a,l,r,this.levelCount,o)),a=l}}else{var s=[];for(r=0;r<this.levelCount;r++){var l;(l=new n.default).onInitData(r,e[r],this._nodeConfig,s,this._config.nodePosCount,this.levelCount),this.levelDataList.push(l),s=l.getNodePos,this._savePosList.push(s),a&&(o=this.onCreateWay(a,l,r,this.levelCount,o)),a=l}}this.setRoleNode(o[0],o[1])}},e.prototype.onCreateWay=function(e,t,i,n,o){void 0===o&&(o=[]);var a=o.concat();for(var r in e.getNodeList){var s=e.getNodeList[r];for(var l in s.setNodeConnect=[],t.getNodeList){var c=t.getNodeList[l];0!=c.getNodeStatus&&(a[0]=i,a[1]=c.getNodePosition),1==i||i==n-1?s.getNodeConnect.push([c.getNodePosition,1==i?1:s.getNodeStatus,c.getNodeStatus]):c.getNodePosition+1>=s.getNodePosition&&c.getNodePosition-1<=s.getNodePosition&&s.getNodeConnect.push([c.getNodePosition,s.getNodeStatus,c.getNodeStatus])}}return a},Object.defineProperty(e.prototype,"getLevelCount",{get:function(){return this.levelCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"treasureLevel",{get:function(){return this.currentLevel},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getLevelDataList",{get:function(){return this.levelDataList},enumerable:!0,configurable:!0}),e.prototype.setRoleNode=function(e,t){if(this._effectPos=[],e<this.levelCount)for(var i=this.levelDataList[e],n=0;n<i.getNodeList.length;n++)if(i.getNodeList[n].nodePosition==t){this.currentNodeData=i.getNodeList[n],this._effectPos[0]=this.currentNodeData.getNodeLevel+1;for(var o=0;o<this.currentNodeData.getNodeConnect.length;o++)this._effectPos.push(this.currentNodeData.getNodeConnect[o][0])}},Object.defineProperty(e.prototype,"getRoleNode",{get:function(){return this.currentNodeData},enumerable:!0,configurable:!0}),e.prototype.checkCanGo=function(e,t){if(this.currentNodeData.getNodeLevel<e-1)return this.tips_1;if(this.currentNodeData.getNodeLevel>e-1)return this.tips_2;if(this.currentNodeData.getNodeLevel==e-1)for(var i=0;i<this.currentNodeData.getNodeConnect.length;i++)if(t==this.currentNodeData.getNodeConnect[i][0])return this.tips_5;return this.tips_3},Object.defineProperty(e.prototype,"getLevelList",{get:function(){for(var e=[],t=this.levelDataList.length,i=0;i<t;i++)e.push(this.levelDataList[i].getLevelData);return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getLayerPosList",{get:function(){return this._savePosList},enumerable:!0,configurable:!0}),e.prototype.addReward=function(e){if(e&&e.length>0)for(var t=0;t<e.length;t++){for(var i=!0,n=0;n<this._rewardList.length;n++)if(this._rewardList[n].type==e[t].type&&this._rewardList[n].id==e[t].id){this._rewardList[n].count+=e[t].count,i=!1;break}i&&this._rewardList.push(e[t])}},Object.defineProperty(e.prototype,"getRewardList",{get:function(){return this._rewardList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"setRemainFight",{set:function(e){this.remainFight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getRemainFight",{get:function(){return this.remainFight},enumerable:!0,configurable:!0}),e.prototype.addBuff=function(e){for(var t=this._buffList.length,i=!0,n=0;n<t;n++)if(this._buffList[n].length>1&&this._buffList[n][0]==e){this._buffList[n][1]++,i=!1;break}i&&this._buffList.push([e,1])},Object.defineProperty(e.prototype,"getBuffList",{get:function(){return this._buffList},enumerable:!0,configurable:!0}),e.prototype.addReinforcement=function(e){this._reinforcementList.push(e)},Object.defineProperty(e.prototype,"getReinforcementList",{get:function(){return this._reinforcementList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"setReinforcementList",{set:function(e){this._reinforcementList=e},enumerable:!0,configurable:!0}),e.prototype.addCaptureMonster=function(e){this._captureMonsterList.push(e)},Object.defineProperty(e.prototype,"getCaptureMonsterList",{get:function(){return this._captureMonsterList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"setCaptureMonsterList",{set:function(e){this._captureMonsterList=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getEffectPos",{get:function(){return this._effectPos},enumerable:!0,configurable:!0}),e=__decorate([a],e)}());i.default=r,cc._RF.pop()},{"./TreasureLevelData":"TreasureLevelData"}],TreasureLevelData:[function(e,t,i){"use strict";cc._RF.push(t,"1b97dKrS/9NKoYqD7F+MICD","TreasureLevelData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Util/Utils"),o=e("./TreasureNodeData"),a=cc._decorator,r=a.ccclass,s=(a.property,function(){function e(){this.level=1,this.nodePosCount=0,this.levelCount=0,this.nodeList=[],this.layerList=[],this.middlePosi=4,this.nodePos=[],this.posList=[],this._nodeConfig=null,this._canChangePos=[]}return e.prototype.onInitData=function(e,t,i,n,o,a){this.level=e,this.layerList=t?t.concat():[],this._nodeConfig=i,this.nodePosCount=o,this.levelCount=a;for(var r=0;r<=this.nodePosCount;r++)this._nodeConfig[r]&&this._nodeConfig[r].nodePos.length==this.layerList.length&&this.posList.push(this._nodeConfig[r].nodePos);this.onCreate(n)},e.prototype.onSetData=function(e,t,i,n){if(this.level=e,this.level=e,this.layerList=t?t.concat():[],this.levelCount=n,0==this.level||this.level+1==this.levelCount){(s=new o.default).onInitData(0==this.level?null:this.layerList[0],this.level,this.middlePosi,0),this.nodeList.push(s),this.nodePos=[this.middlePosi]}else{for(var a=this.layerList.length,r=0;r<a;r++){var s;(s=new o.default).onInitData(this.layerList[r],this.level,i[r],r),this.nodeList.push(s)}this.nodePos=i?i.concat():[]}},e.prototype.onCreate=function(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=0);var a,r=4;3==e.length&&5==this.layerList.length||5==e.length&&3==this.layerList.length?r=4:4==e.length&&5==this.layerList.length||5==e.length&&4==this.layerList.length?r=3:(3==e.length&&4==this.layerList.length||4==e.length&&3==this.layerList.length)&&(r=3);var s=0;if(this.nodePos=[],0==this.level||this.level+1==this.levelCount){(p=new o.default).onInitData(0==this.level?null:this.layerList[0],this.level,this.middlePosi,0),this.nodeList.push(p),this.nodePos=[this.middlePosi]}else{var l=this.layerList.length;a=t?(i+1)%this.posList.length:n.default.RandomBy(0,this.posList.length-1);for(var c=0;c<e.length;c++)for(var d=0;d<this.nodePos.length;d++)e[c]==this.nodePos[d]&&s++;s>=r&&this.onCreate(e,!0,a);for(c=0;c<l;c++){var p;(p=new o.default).onInitData(this.layerList[c],this.level,this.posList[a][c],c),this.nodeList.push(p)}this.nodePos=this.posList[a]?this.posList[a].concat():[]}if(s<r)return this.nodePos},Object.defineProperty(e.prototype,"getNodeList",{get:function(){return this.nodeList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getLevel",{get:function(){return this.level},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getNodePos",{get:function(){return this.nodePos},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getLevelData",{get:function(){return{nodeList:this.nodeList,level:this.level}},enumerable:!0,configurable:!0}),e=__decorate([r],e)}());i.default=s,cc._RF.pop()},{"../../../Util/Utils":"Utils","./TreasureNodeData":"TreasureNodeData"}],TreasureLine:[function(e,t,i){"use strict";cc._RF.push(t,"a98ferzEH9OHbbVWNVe48cp","TreasureLine"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Util/Utils"),a=cc._decorator,r=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.contentPass=null,t.contentNor=null,t.spriteAtlas=null,t.nodeHeight=36,t}return __extends(t,e),t.prototype.initData=function(e,t,i,n){void 0===n&&(n=!0);var a=Math.sqrt(t*t+i*i)-108,r=Math.floor(a/this.nodeHeight),s=0;0!=t&&(s=Math.atan2(i,t)/(Math.PI/180)-90,n||(s=-s));var l=null,c="";if(e?(c="line_2",l=this.contentPass,o.default.setNodeActive([this.contentNor],[this.contentPass])):(c="line_1",l=this.contentNor,o.default.setNodeActive([this.contentPass],[this.contentNor])),l.rotation=s,l.childrenCount>r)for(var d=l.childrenCount-1;d>r;d--)l.getChildByName("line"+d)&&l.removeChild(l.getChildByName("line"+d));else for(d=l.childrenCount;d<r;d++){var p=new cc.Node;p.name="line"+d,p.addComponent(cc.Sprite).spriteFrame=this.spriteAtlas.getSpriteFrame(c),l.addChild(p)}},__decorate([s(cc.Node)],t.prototype,"contentPass",void 0),__decorate([s(cc.Node)],t.prototype,"contentNor",void 0),__decorate([s(cc.SpriteAtlas)],t.prototype,"spriteAtlas",void 0),t=__decorate([r],t)}(n.default);i.default=l,cc._RF.pop()},{"../../Core/Widget":"Widget","../../Util/Utils":"Utils"}],TreasureMainView:[function(e,t,i){"use strict";cc._RF.push(t,"0d366SHwcNAHYfmdKsQEzst","TreasureMainView"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Language"),o=e("./TreasureMapController"),a=e("../../Core/Window"),r=e("../../Util/Utils"),s=e("../../Core/WindowType"),l=e("./TreasureNodeItem"),c=e("../../Core/TimeController"),d=e("../../GlobalContext"),p=e("./TreasureReward"),h=e("../../Core/GameEventDispatcher"),u=e("../../Core/Event"),f=e("../Commons/CombatValue"),g=e("../Buff/BuffController"),y=e("../Tips/OpTipsController"),m=e("../OpenWin/OpenWinController"),C=e("./TreasureBuff"),v=e("./Data/TreasureConfig"),_=e("../Commons/Image"),b=e("../../Core/LoadManager"),T=e("../Status/StatusType"),S=cc._decorator,I=S.ccclass,w=S.property,D=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Bg=null,t.layerScroll=null,t.listContent=null,t.labelProgress=null,t.layerCombat=null,t.spriteBuffContent=null,t.layerBuff=null,t.layerBuffTips=null,t._mwNode=null,t._pageCombat=null,t.nodePositionX=[-433,-283,-133,17,167,317,467],t.firstPositionY=-120,t.intervalY=200,t.intervalX=150,t.treasureData=null,t}return __extends(t,e),t.prototype.onLoad=function(){var t=this;this.loadWindowCom=function(){t.Bg.setSiblingIndex(1),t.layerScroll.setSiblingIndex(2),t.layerBuff.setSiblingIndex(3);var e=t.windowBg.getChildByName("BackBtn1");e.removeFromParent();var i=t.windowBg.getChildByName("Title1");i.removeFromParent(),t.node.addChild(i),t.node.addChild(e)},this.loadWindowComThis=this,this.onInit(s.WindowType.TreasureMainView,!0),e.prototype.onLoad.call(this),this.layerScroll.getComponentInChildren(cc.ScrollView).elastic=!1},t.prototype.show=function(){e.prototype.show.call(this),o.default.instance.isInTreasure=!0,h.GameEventDispatcher.instance.on(v.TreasureConfig.treasureBuffAdd,this.onBuffShow,this),h.GameEventDispatcher.instance.on(v.TreasureConfig.treasureRemainFight,this.onShowFightCombat,this),h.GameEventDispatcher.instance.on(v.TreasureConfig.treasureDataRefresh,this.onShowPage,this),h.GameEventDispatcher.instance.on(v.TreasureConfig.treasureBuy,this.onShowPage,this),h.GameEventDispatcher.instance.on(v.TreasureConfig.treasureOut,this.backBtnClick,this),this.onShowPage(),this.node.setContentSize(d.GlobalContext.UIWidth,d.GlobalContext.UIHeight),this.layerBuff.width=d.GlobalContext.UIWidth,this.layerBuffTips.active=!1,this.listContent.on(cc.Node.EventType.TOUCH_START,this.onClickThis,this),o.default.instance.sendLoadData()},t.prototype.close=function(){e.prototype.close.call(this),r.default.clearPoolToType(s.PoolType.TreasureNode)},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),this.saveNodePrefab(),h.GameEventDispatcher.instance.off(v.TreasureConfig.treasureBuffAdd,this.onBuffShow,this),h.GameEventDispatcher.instance.off(v.TreasureConfig.treasureBuy,this.onShowPage,this),h.GameEventDispatcher.instance.off(v.TreasureConfig.treasureRemainFight,this.onShowFightCombat,this),h.GameEventDispatcher.instance.off(v.TreasureConfig.treasureDataRefresh,this.onShowPage,this),h.GameEventDispatcher.instance.off(v.TreasureConfig.treasureOut,this.backBtnClick,this)},t.prototype.onShowPage=function(){this.treasureData=o.default.instance.getTreasureData,this.onShowNode(),this.onShowOther(),this.onBuffShow()},t.prototype.onNodeLoadComplete=function(){this.onShowNode()},t.prototype.onShowNode=function(){var e=this;b.default.instance.loadResByType(d.GlobalContext.Root+"prefab/treasuremap/TreasureNodeItem",cc.Prefab,function(t){e.saveNodePrefab();var i=e.treasureData.getLevelDataList.concat();i.reverse();for(var n=i.length,o=e.treasureData.getRoleNode,a=n-o.getNodeLevel-4>0?n-o.getNodeLevel-4:0,p=0,h=a;h<n;h++){for(var u=i[h].getNodeList,f=u.length,g=0;g<f;g++){var y=r.default.getNodeByPool(s.PoolType.TreasureNode,t,d.GlobalContext.Root+"prefab/treasuremap/TreasureNodeItem");e.listContent.addChild(y),y.getComponent(l.default).initData(u[g],o,u[g].getNodeLevel<e.treasureData.treasureLevel-1,e.treasureData.getEffectPos),y.getComponent(l.default).createLine(e.intervalX,e.intervalY),y.setPosition(e.nodePositionX[u[g].getNodePosition-1],e.firstPositionY-e.intervalY*p)}if(a>0&&h==a){if(!e._mwNode){if(e._mwNode=new cc.Node,e._mwNode.addComponent(_.default),e._mwNode.getComponent(_.default)){var m=d.GlobalContext.ResRoot+"resources/treasure/bg_yun.png";e._mwNode.getComponent(_.default).loadImageByHttps(m)}e._mwNode.setPosition(0,e.firstPositionY-e.intervalY*p)}e.listContent.insertChild(e._mwNode,999)}p++}e.listContent.height=(n-a)*e.intervalY,c.default.instance.setTimeout(function(){e.layerScroll.getComponentInChildren(cc.ScrollView).scrollToPercentVertical(o.getNodeLevel/(n-a-3.75),.1)},e,1)},this)},t.prototype.onShowOther=function(){this.labelProgress.string=n.default.getStr("treasure_progress_desc",this.treasureData.treasureLevel-1>0?this.treasureData.treasureLevel-1:0,this.treasureData.getLevelCount-1)},t.prototype.onShowFightCombat=function(){var e=this;r.default.setNodeChildDestoryByUrl(this.layerCombat,d.GlobalContext.Root+"prefab/CombatVal"),b.default.instance.loadResByType(d.GlobalContext.Root+"prefab/CombatVal",cc.Prefab,function(t){e._pageCombat=r.default.getNodeByUrl(t,d.GlobalContext.Root+"prefab/CombatVal"),e.layerCombat.insertChild(e._pageCombat,999),e._pageCombat.getComponent(f.default).onInit(o.default.instance.remainFight,30,1.2)},this)},t.prototype.hide=function(){e.prototype.hide.call(this)},t.prototype.backBtnClick=function(){e.prototype.backBtnClick.call(this),o.default.instance.isInTreasure=!1,h.GameEventDispatcher.instance.emit(u.EventDefiner.ChangeActivityStatus,T.ActivityStatus.NoActivity)},t.prototype.saveNodePrefab=function(){if(this.listContent)for(var e=this.listContent.childrenCount-1;e>=0;e--)this.listContent.children[e]&&this.listContent.children[e].getComponent(l.default)&&r.default.setNodeToPool(s.PoolType.TreasureNode,this.listContent.children[e],d.GlobalContext.Root+"prefab/treasuremap/TreasureNodeItem")},t.prototype.onClickReward=function(){var e=this;this.treasureData=o.default.instance.getTreasureData,this.treasureData.getRewardList.length<1?y.default.instance.ShowMsg(n.default.getStr("treasure_reward_none")):m.default.instance.openWindow(s.WindowType.TreasureReward,function(){p.default.instance.initData(e.treasureData.getRewardList)},this)},t.prototype.onBuffShow=function(){var e=this,t=this.treasureData.getBuffList;console.log("\u85cf\u5b9d\u56feBUFF\u4e0b\u53d1:",t),b.default.instance.loadResByType(d.GlobalContext.Root+"prefab/treasuremap/TreasureBuff",cc.Prefab,function(i){r.default.setNodeChildDestoryByUrl(e.spriteBuffContent,d.GlobalContext.Root+"prefab/treasuremap/TreasureBuff");var n=function(n){if(t[n]&&t[n].length>=2){var o=g.default.instance.getBuffById(t[n][0]);if(o){var a=r.default.getNodeByUrl(i,d.GlobalContext.Root+"prefab/treasuremap/TreasureBuff");a.getComponent(C.default).onInitData(o.buffIcon,t[n][1]),e.spriteBuffContent.addChild(a),a.on(cc.Node.EventType.TOUCH_END,function(){e.onClickBuffIcon(o,t[n][1])},e)}}};for(var o in t)n(o)},this)},t.prototype.onClickBuffIcon=function(e,t){if(this.layerBuffTips.active=!0,this.layerBuffTips.getChildByName("spriteBuff")&&this.layerBuffTips.getChildByName("spriteBuff").getComponent(C.default)&&this.layerBuffTips.getChildByName("spriteBuff").getComponent(C.default).onInitData(e.buffIcon,t),this.layerBuffTips.getChildByName("labelBuffName")&&(this.layerBuffTips.getChildByName("labelBuffName").getComponent(cc.Label).string=e.buffName+""),this.layerBuffTips.getChildByName("labelDesc")){var i=Math.floor(Math.abs(e.param||e.param1)*t*1e4)/100,o=n.default.getStr1(e.buffDesc,[i]);this.layerBuffTips.getChildByName("labelDesc").getComponent(cc.RichText).string=o}},t.prototype.onClickThis=function(){this.layerBuffTips.active=!1},__decorate([w(cc.Node)],t.prototype,"Bg",void 0),__decorate([w(cc.Node)],t.prototype,"layerScroll",void 0),__decorate([w(cc.Node)],t.prototype,"listContent",void 0),__decorate([w(cc.Label)],t.prototype,"labelProgress",void 0),__decorate([w(cc.Node)],t.prototype,"layerCombat",void 0),__decorate([w(cc.Node)],t.prototype,"spriteBuffContent",void 0),__decorate([w(cc.Node)],t.prototype,"layerBuff",void 0),__decorate([w(cc.Node)],t.prototype,"layerBuffTips",void 0),t=__decorate([I],t)}(a.default);i.default=D,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/Window":"Window","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Buff/BuffController":"BuffController","../Commons/CombatValue":"CombatValue","../Commons/Image":"Image","../OpenWin/OpenWinController":"OpenWinController","../Status/StatusType":"StatusType","../Tips/OpTipsController":"OpTipsController","./Data/TreasureConfig":"TreasureConfig","./TreasureBuff":"TreasureBuff","./TreasureMapController":"TreasureMapController","./TreasureNodeItem":"TreasureNodeItem","./TreasureReward":"TreasureReward"}],TreasureMapController:[function(e,t,i){"use strict";cc._RF.push(t,"ef673hoPa9AzYrDtAvJeIN+","TreasureMapController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("../../Core/ConfigsManager"),a=e("../../Core/GameEventDispatcher"),r=e("../../Core/Event"),s=e("../Status/StatusType"),l=e("../../Core/WindowManager"),c=e("../SandTable/SandTableController"),d=e("./Data/TreasureData"),p=e("../../NetConnect/NetConnet"),h=e("../OpenWin/OpenWinController"),u=e("../../Core/WindowType"),f=e("../../Global/GlobalValue"),g=e("../Scene/Controller/SceneController"),y=e("../Scene/Manager/SceneManager"),m=e("../Tips/OpTipsController"),C=e("../../Core/Language"),v=e("../WarTeam/MonsterController"),_=e("../Scene/Prop/EntityProperty"),b=e("../../Core/Const/EntityType"),T=e("../Scene/Controller/SkillController"),S=e("../../Util/Utils"),I=e("../../Core/TimeController"),w=e("./Data/TreasureConfig"),D=e("../Scene/Controller/EntityQiPaoController"),R=e("../Scene/View/ActorsLayer"),A=e("../Scene/Unit/FightLog"),N=e("../Role/RoleInfo"),L=e("../Fight/FightUtils"),E=e("../Buff/BuffController"),B=e("../Tips/TipsWinController"),M=e("../Commons/WindowOpenUtils"),x=e("../Chapter/GuanqiaController"),k=e("../../Util/CommonUtil"),P=cc._decorator,G=P.ccclass,F=(P.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._configs=null,t.isOpenMainView=!1,t.isInTreasure=!1,t.getInNum=-1,t.Event_Type_Monster=1,t.Event_Type_Campsite=2,t.Event_Type_Trap=3,t.Event_Type_medical=4,t.Event_Type_Box=5,t.Event_Type_Shop=6,t.Event_Type_Unkonw=7,t.Event_Type_Elite=8,t.Event_Type_Boss=9,t.Event_Type_CurrentNode=20,t.fightType=1,t.fightTips=null,t.percentNum=0,t.isGameEnd=!1,t.fightResult=!1,t.currentLevel=-1,t.remainFight=0,t.isRefreshTreasure=!1,t.isSendInto=!1,t.isCanSlink=!1,t.knowChangePercent=0,t._bossDialogType=1,t._dialogIndex=0,t._addBuffIndex=-1,t._saveKnowData=null,t.clickNodeData=null,t._layerList=null,t._treasureNode=null,t.treasureData=null,t.isPlaySkill=null,t}var i;return __extends(t,e),i=t,t.prototype.isNoOneLayer=function(){return this.currentLevel>1},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this,this.initInfo(),this._configs=o.ConfigsManager.instance.getConfigs("treasureMapConf")},t.prototype.start=function(){e.prototype.start.call(this),a.GameEventDispatcher.instance.on(w.TreasureConfig.treasureFightResult,this.onFightResult,this),a.GameEventDispatcher.instance.on(r.EventDefiner.TreasureDialog,this.fightDialog,this)},t.prototype.initInfo=function(){this.isRefreshTreasure=!1,this._addBuffIndex=-1,this._dialogIndex=0,this._bossDialogType=1,this.fightTips=null,this.remainFight=0,this.fightType=1,this.percentNum=0,this.isGameEnd=!1,this.currentLevel=-1,this._saveKnowData=null,this.clickNodeData=null,this._layerList=null,this._treasureNode=null},t.prototype.listNotification=function(){this.addProto("tmstate",this.setTMState,this),this.addProto("tmtimes",this.setLastTMNum,this),this.addProto("tmlayerinfo",this.onGetTreasureLayerInfo,this),this.addProto("loadtmdata",this.onGetTreasureNode,this),this.addProto("tmunkonwevent",this.onKnowResult,this),this.addProto("tmreadied",this.onEnterResult,this),this.addProto("tmbuyresult",this.onBuyResult,this)},t.prototype.setDataPlaySkill=function(e){this.isPlaySkill=e},t.prototype.sendGetTreasureLayerInfo=function(){this.initInfo();this.isSendInto=!0,p.default.instance.sendProto({cmd:"tmlayerinfo"})},t.prototype.exitTreasure=function(){p.default.instance.sendProto({cmd:"tmclear"})},t.prototype.sendInToTreasureNode=function(e,t){var i={cmd:"tmenter",layer:e,eventIndex:t};p.default.instance.sendProto(i)},t.prototype.sendGetNodeData=function(){p.default.instance.sendProto({cmd:"loadtmdata"})},t.prototype.sendSaveNodeData=function(){var e={cmd:"savetmdata",data:this.getSaveData()};p.default.instance.sendProto(e)},t.prototype.sendFinishAction=function(){p.default.instance.sendProto({cmd:"tmfinish"})},t.prototype.sendBuyItem=function(e,t){void 0===t&&(t=1);var i={cmd:"treasurydiscount",index:e-1,count:t};p.default.instance.sendProto(i)},t.prototype.sendCmdSlink=function(){p.default.instance.sendProto({cmd:"tmskip"})},t.prototype.onGetTreasureLayerInfo=function(e){var t=e.data.data||e.data;t.layers&&this.currentLevel+1>=t.layers.length&&t.curLayer<=1?this.isGameEnd=!0:(this.currentLevel=t.curLayer,this._layerList=t.layers,1==t.curLayer&&this.isSendInto?(this.isOpenMainView=!1,this.sendGetNodeData()):t.curLayer>1&&(this.isOpenMainView=!0,(this.isSendInto||this.FightNum==this.Event_Type_Campsite||this.FightNum==this.Event_Type_Shop)&&this.sendGetNodeData()),this.isSendInto=!1,a.GameEventDispatcher.instance.emit(w.TreasureConfig.treasureDataRefresh))},t.prototype.isElite=function(){return this.clickNodeData.getNodeType==this.Event_Type_Elite},t.prototype.setLastTMNum=function(e){-1!=this.getInNum&&0==e.times&&(this.isRefreshTreasure=!0,this.onCheckToOut()),this.getInNum=e.times},t.prototype.setTMState=function(e){},t.prototype.onKnowResult=function(e){this._saveKnowData=e.event},t.prototype.onEnterResult=function(e){if(e.ret)switch(this.FightNum=this.clickNodeData.getNodeType,this.clickNodeData.getNodeType){case this.Event_Type_Monster:this.onRandomBuff(),a.GameEventDispatcher.instance.emit(r.EventDefiner.ChangeActivityStatus,s.ActivityStatus.TreasureMap),a.GameEventDispatcher.instance.emit(r.EventDefiner.ChangeGameScene,{status:f.GameScene.Fight,guanqiaId:this.paramId});break;case this.Event_Type_Campsite:a.GameEventDispatcher.instance.emit(r.EventDefiner.ChangeActivityStatus,s.ActivityStatus.TreasureMap),a.GameEventDispatcher.instance.emit(r.EventDefiner.ChangeGameScene,{status:f.GameScene.Fight,guanqiaId:this.clickNodeData.getNodeParam[0]||51001});break;case this.Event_Type_Trap:this.knowChangePercent>0?this.percentNum=-this.knowChangePercent:this.percentNum=-this.onGetChangeVal(),a.GameEventDispatcher.instance.emit(r.EventDefiner.ChangeActivityStatus,s.ActivityStatus.TreasureMap),a.GameEventDispatcher.instance.emit(r.EventDefiner.ChangeGameScene,{status:f.GameScene.Fight,guanqiaId:this.clickNodeData.getNodeParam[0]});break;case this.Event_Type_medical:this.knowChangePercent>0?this.percentNum=this.knowChangePercent:this.percentNum=this.onGetChangeVal(),this.fightTips||(this.fightTips=C.default.getStr("treasure_yl")),a.GameEventDispatcher.instance.emit(r.EventDefiner.ChangeActivityStatus,s.ActivityStatus.TreasureMap),a.GameEventDispatcher.instance.emit(r.EventDefiner.ChangeGameScene,{status:f.GameScene.Fight,guanqiaId:this.clickNodeData.getNodeParam[0]});break;case this.Event_Type_Box:this.sendFinishAction();break;case this.Event_Type_Shop:this.sendFinishAction(),h.default.instance.openWindow(u.WindowType.TreasureShop);break;case this.Event_Type_Unkonw:return this.clickNodeData.setNodeType=this._saveKnowData.type,this.clickNodeData.setNodeParam=this._saveKnowData.param,this.knowChangePercent=this.onGetChangeVal(),this._saveKnowData.type!=this.Event_Type_Campsite&&this._saveKnowData.type!=this.Event_Type_Shop&&(this.fightTips=C.default.getStr("treasure_enter_"+this._saveKnowData.type)),this._saveKnowData.type!=this.Event_Type_Elite&&this._saveKnowData.type!=this.Event_Type_Monster||(this.canSlink=!0),void this.onEnterResult(e);case this.Event_Type_Elite:a.GameEventDispatcher.instance.emit(r.EventDefiner.ChangeActivityStatus,s.ActivityStatus.TreasureMap),a.GameEventDispatcher.instance.emit(r.EventDefiner.ChangeGameScene,{status:f.GameScene.Fight,guanqiaId:this.paramId});break;case this.Event_Type_Boss:this._bossDialogType=this.paramId+1,a.GameEventDispatcher.instance.emit(r.EventDefiner.ChangeActivityStatus,s.ActivityStatus.TreasureMap),a.GameEventDispatcher.instance.emit(r.EventDefiner.ChangeGameScene,{status:f.GameScene.Fight,guanqiaId:this.paramId})}this.knowChangePercent=0},t.prototype.getParamId=function(){return this.paramId=this.clickNodeData.getParamId(),this.paramId},t.prototype.onBuyResult=function(e){var t=e;if(this.treasureData)switch(m.default.instance.ShowMsg(C.default.getStr("treasure_buy")),a.GameEventDispatcher.instance.emit(w.TreasureConfig.treasureBuy,t.index),t.itemType){case 3:this.treasureData.addBuff(this.getBuffIdByIndex(t.itemParam)),a.GameEventDispatcher.instance.emit(w.TreasureConfig.treasureBuffAdd),this.sendSaveNodeData(),this.sendLoadData();break;case 2:this.treasureData.addReinforcement(t.itemParam),this.sendSaveNodeData(),this.sendLoadData()}},t.prototype.onGetTreasureNode=function(e){if(!e.data||!e.data.data||1!=e.data.data.level&&1==this.treasureLevel)return this.onSelectMonster(),void this.onSaveLayerData();var t=null;e.data&&e.data.data&&(t=e.data.data),this.onSaveLayerData(t),this.FightNum!=this.Event_Type_Shop?(this.isOpenMainView=!0,a.GameEventDispatcher.instance.emit(w.TreasureConfig.treasureDataRefresh),a.GameEventDispatcher.instance.emit(r.EventDefiner.ChangeActivityStatus,s.ActivityStatus.TreasureMap)):a.GameEventDispatcher.instance.emit(w.TreasureConfig.treasureDataRefresh)},t.prototype.addReward=function(e){this.treasureData&&this.treasureData.addReward(e)},Object.defineProperty(t.prototype,"getFightTips",{get:function(){return this.fightTips},enumerable:!0,configurable:!0}),t.prototype.onShowEnterTips=function(){var e=this;null!=this.fightTips&&I.default.instance.setTimeout(function(){m.default.instance.ShowMsg(e.fightTips),e.fightTips=null},this,100)},t.prototype.onSelectMonster=function(){this.FightNum=this.Event_Type_Campsite,c.default.instance.clearData(),g.default.instance.clearAll(),a.GameEventDispatcher.instance.emit(r.EventDefiner.ChangeActivityStatus,s.ActivityStatus.TreasureMap),a.GameEventDispatcher.instance.emit(r.EventDefiner.ChangeGameScene,{status:f.GameScene.Fight,guanqiaId:f.GQIdType.ZangBaoTu})},t.prototype.onSaveLayerData=function(e){void 0===e&&(e=null),this.treasureData||(this.treasureData=new d.default,this.treasureData.onInitData(this.getTreasureMainConfig(),this.getTreasureNodeConfig())),this.treasureData.onSaveList(this._layerList,this.currentLevel,e)},t.prototype.onSelectEvent=function(e){var t=[this.Event_Type_Monster,this.Event_Type_Elite,this.Event_Type_Boss];switch(this.getTreasureData.checkCanGo(e.getNodeLevel,e.getNodePosition)){case this.getTreasureData.tips_1:m.default.instance.ShowMsg(C.default.getStr("treasure_error_1"));break;case this.getTreasureData.tips_2:m.default.instance.ShowMsg(C.default.getStr("treasure_error_2"));break;case this.getTreasureData.tips_3:m.default.instance.ShowMsg(C.default.getStr("treasure_error_3"));break;case this.getTreasureData.tips_5:this.clickNodeData=e,-1==t.indexOf(this.clickNodeData.getNodeType)?this.sendInToTreasureNode(e.getNodeLevel,e.getNodeIndex):M.default.instance.openWindowType(u.WindowType.FightInfo)}},t.prototype.sendReq=function(){this.sendInToTreasureNode(this.clickNodeData.getNodeLevel,this.clickNodeData.getNodeIndex)},t.prototype.onSaveData=function(){this.getTreasureData&&this.sendSaveNodeData()},t.prototype.onFightResult=function(e){var t=e.detail;this.fightResult=t,!this.isGameEnd&&t?this.onCheckToOut()||t&&(this._addBuffIndex>=0&&(this.treasureData.addBuff(this.getBuffIdByIndex(this._addBuffIndex)),this.sendLoadData(),this._addBuffIndex=-1),this.onSaveData(),this.sendGetNodeData()):h.default.instance.openWindow(u.WindowType.TreasureResult)},t.prototype.setRemainFight=function(e,t){void 0===t&&(t=!1),this.remainFight=e+N.MyRoleInfo.GetCurrentFight(L.FightUtils.getRoleHp()),a.GameEventDispatcher.instance.emit(w.TreasureConfig.treasureRemainFight),a.GameEventDispatcher.instance.emit(r.EventDefiner.Set_Monster_Data),t&&this.sendSaveNodeData()},t.prototype.getTreasureMainConfig=function(){return this._configs.treasureMain[1]},t.prototype.getTreasureNodeConfig=function(){return this._configs.treasureNodePos},t.prototype.getTreasureBuffConfig=function(){return this._configs.buff[1]},t.prototype.getBuffIdByIndex=function(e){return this.getTreasureBuffConfig()[e]?this.getTreasureBuffConfig()[e].buffId:0},t.prototype.getItemName=function(e){return this._configs.shop[e].name},t.prototype.getSaveData=function(){return this.getTreasureData?{posList:this.getTreasureData.getLayerPosList,rewardList:this.getTreasureData.getRewardList,remainFight:this.getTreasureData.getRemainFight,buffList:this.getTreasureData.getBuffList,reinforcementList:this.getTreasureData.getReinforcementList,level:this.treasureLevel,serveTime:I.default.instance.ServerTimeMins}:null},Object.defineProperty(t.prototype,"getFinalBuffList",{get:function(){var e=[];if(this.treasureData&&this.treasureData.getBuffList){var t=this.treasureData.getBuffList;for(var i in t)if(t[i]&&t[i].length>=2)for(var n=0;n<t[i][1];n++)e.push(t[i][0])}return e},enumerable:!0,configurable:!0}),t.prototype.setAttr=function(e){if(this.treasureData&&this.treasureData.getBuffList&&this.treasureData.getBuffList.length){var t=this.treasureData.getBuffList,i=void 0;for(var n in t)i=E.default.instance.getBuffById(t[n][0]).param1,e.attr.Push(this.getAddBuffType(t[n][0]),i*t[n][1]*1e4);A.default.log("cbt buff==",e,t)}},t.prototype.getAddBuffType=function(e){var t=this._configs.buff[1];for(var i in t)if(t[i].buffId==e)return t[i].attrType},Object.defineProperty(t.prototype,"getTreasureData",{get:function(){return this.treasureData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FightNum",{get:function(){return this.fightType},set:function(e){this.fightType=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PercentNum",{get:function(){return this.percentNum},set:function(e){this.percentNum=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"treasureLevel",{get:function(){return this.currentLevel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rewardList",{get:function(){return this.treasureData.getRewardList},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isWinResult",{get:function(){return this.fightResult},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canSlink",{get:function(){return this.isCanSlink},set:function(e){this.isCanSlink=e},enumerable:!0,configurable:!0}),t.prototype.onCheckToOut=function(){return!(!this.isRefreshTreasure||s.ActivityStatus.value!=s.ActivityStatus.TreasureMap||g.default.instance.scenestatus==f.GameScene.Fight||!this.isInTreasure)&&(B.default.instance.ShowTips(C.default.getStr("treasure_out"),function(){a.GameEventDispatcher.instance.emit(w.TreasureConfig.treasureOut),l.default.instance.closeAll()},this,null,2,null,null,null,null,null,!0),!0)},Object.defineProperty(t.prototype,"setCaptureMonster",{set:function(e){if(e&&e.length>0){this.treasureData.setCaptureMonsterList=[];var t=e.length,i=[S.default.RandomBy(0,t-1),S.default.RandomBy(0,t-1)];this.onPushCaptureMonster(e,i[0]),i[0]!=i[1]&&this.onPushCaptureMonster(e,i[1])}else this.treasureData.setCaptureMonsterList=[]},enumerable:!0,configurable:!0}),t.prototype.setSaveMonster=function(){if(this.isElite()){x.default.instance.getGuanqiaMonsters(this.paramId,1);this.setCaptureMonster=k.CommonUtil.getMonster(this.paramId)}},t.prototype.onPushCaptureMonster=function(e,t){var i=e[t];i.cultivateLv&&(i.cultivateLv=i.cultivateLv+5);var n=v.default.instance.getMonsterMaxAttrByType(i.cardid||i.id,i.cultivateLv,i.grade);i.attr=n||i.attr,i.hp=n.hp,i.autoUseSkill=!1,i.reinforcement=!0,i.addtype=f.ADD_ACTOR_TYPE.CAPTIVE,this.treasureData.addCaptureMonster(i)},Object.defineProperty(t.prototype,"getCaptureMonster",{get:function(){return this.treasureData.getCaptureMonsterList},enumerable:!0,configurable:!0}),t.prototype.resetCaptureMonster=function(){this.treasureData.setCaptureMonsterList=[]},t.prototype.clearReinforment=function(){this.treasureData.setReinforcementList=[]},t.prototype.getReinforcement=function(){if(this.treasureData.getReinforcementList.length<1)return[];var e=[];for(var t in this.treasureData.getReinforcementList){var i=this._configs.monsters[this.treasureData.getReinforcementList[t]];if(i){var n=this.getReinforcementsMonsterAttr(i),o={cardid:i.cardId,grade:i.grade,level:i.level,num:i.num,self:!0,attr:n,autoUseSkill:!1,skills:n.skills,buffList:this.getFinalBuffList,reinforcement:!0,addtype:f.ADD_ACTOR_TYPE.REINFORCEMENTS};console.log("\u8d2d\u4e70\u85cf\u5b9d\u56fe\u63f4\u519b\u6570\u636e:",o),e.push(o)}}return e},t.prototype.getReinforcementsMonsterAttr=function(e){var t=v.default.instance.getMonsterMaxAttrByType(e.cardId||e.cardid,e.level||1,e.grade),i=new _.EntityProperty;i.cardid=e.cardId,i.grade=e.grade,i.type=b.EntityType.enMonster,i.selfMonster=!0;var n=T.default.instance.getSkills(i,e.skilllevel);return t.skills=n,t},t.prototype.onRandomBuff=function(){var e=this.getTreasureBuffConfig().length;this._addBuffIndex=S.default.RandomBy(0,e-1)},t.prototype.getRewardBuffId=function(){return this._addBuffIndex>=0?this.getBuffIdByIndex(this._addBuffIndex):-1},t.prototype.onGetChangeVal=function(){return this._layerList[this.currentLevel][this.clickNodeData.getNodeIndex].changePerval},t.prototype.getBossDialogList=function(){if(this._configs.dialogue[this._bossDialogType]){if(this._configs.dialogue[this._bossDialogType][this._dialogIndex])return this._configs.dialogue[this._bossDialogType][this._dialogIndex]}else if(this._configs.dialogue[1]&&this._configs.dialogue[1][this._dialogIndex])return this._configs.dialogue[1][this._dialogIndex];return null},t.prototype.closeTime=function(){this.time&&(I.default.instance.clearTimeout(this.time),this.time=null)},t.prototype.sendLoadData=function(){var e={cmd:"loadfightdata",key:s.ActivityStatus.TreasureMap+""};p.default.instance.sendProto(e)},t.prototype.setFightData=function(e){if(e){this.reserve=e.reserve,this.table=e.table?e.table:this.table,this.specialMonsters=e.specialMonsters;var t=g.default.instance.sunFightDataFight(this.reserve,this.specialMonsters),i=this.getReinforcement();for(var n in i){var o=new _.EntityProperty;o.init(b.EntityType.enMonster,i[n]),t+=o.currentFight}console.log("fight===",t,N.MyRoleInfo.GetCurrentFight(L.FightUtils.getRoleHp()),t+N.MyRoleInfo.GetCurrentFight(L.FightUtils.getRoleHp())),this.setRemainFight(t)}else this.reserve=null,this.table=null,this.specialMonsters=null,a.GameEventDispatcher.instance.emit(r.EventDefiner.Set_Monster_Data)},t.prototype.fightDialog=function(){var e=this;if(s.ActivityStatus.value==s.ActivityStatus.TreasureMap&&this.nowType==this.Event_Type_Boss){var t=this.getBossDialogList(),i=null;if(!t)return this._dialogIndex=0,this.nowType=null,this.closeTime(),void a.GameEventDispatcher.instance.emit(r.EventDefiner.C_Fight_Start);this.closeTime();var n=t.time;(i=t.isSelf?R.default.instance.getSceneEntity(y.default.instance.myRoleHandle):y.default.instance.rightentitys[0])?(D.default.instance.showQiPao(i,t.desc,t.time),this._dialogIndex++):n=1e3,this.time=I.default.instance.setTimeout(function(){e.fightDialog()},this,n)}},t.prototype.onTreasureEndClear=function(){this.currentLevel=-1,this.sendSaveNodeData(),this.treasureData=null},t.prototype.onChangeAttrByCoefficient=function(e,t){var i=v.default.instance.getCardAverageLv(4),n=(316*i*i+29499*i-20227)/1e4*.7,o=i,a=(316*i*i+29499*i-20227)/1e4*.6,r=t;switch(r||(r=this.clickNodeData.getNodeType),r){case this.Event_Type_Monster:n*=.5,a*=.5;break;case this.Event_Type_Elite:case this.Event_Type_Boss:n*=.7,a*=.7}A.default.log("\u5361\u724c\u5e73\u5747\u7b49\u7ea7\uff1a"+i,"\u5361\u724c\u5e73\u5747\u7b49\u7ea7\u516c\u5f0f\u8ba1\u7b97\u540e\uff08\u5176\u5b83\uff09\uff1a"+n,"\u5361\u724c\u5e73\u5747\u7b49\u7ea7\u516c\u5f0f\u8ba1\u7b97\u540e\uff08\u9632\u5fa1\uff09:"+a),A.default.log("\u602a\u7269\u5361\u724cid"+e.cardid,"\u85cf\u5b9d\u56fe\u5c5e\u6027----\u66ff\u6362\u524d\uff1a\u7cfb\u65701\uff1a"+n+" \u7cfb\u65702:"+o+" \u7b49\u7ea7:"+o+"\u8840\u91cf\uff1a"+e.attr.GetAttrVale(f.AttrType.MaxHp)+",\u653b\u51fb\uff1a"+e.attr.GetAttrVale(f.AttrType.Attack)+",\u9632\u5fa1\uff1a"+e.attr.GetAttrVale(f.AttrType.Defence)+",\u547d\u4e2d\uff1a"+e.attr.GetAttrVale(f.AttrType.Hit)+",\u95ea\u907f\uff1a"+e.attr.GetAttrVale(f.AttrType.Dodge)+",\u66b4\u51fb\uff1a"+e.attr.GetAttrVale(f.AttrType.Critical)+",\u97e7\u6027\uff1a"+e.attr.GetAttrVale(f.AttrType.DefCri)+",\u96f7\u653b:"+e.attr.GetAttrVale(f.AttrType.ThunderAttack)+",\u96f7\u9632\uff1a"+e.attr.GetAttrVale(f.AttrType.ThunderDef)+",\u571f\u653b\uff1a"+e.attr.GetAttrVale(f.AttrType.EarthAttack)+",\u571f\u9632\uff1a"+e.attr.GetAttrVale(f.AttrType.EarthDef)+",\u6c34\u653b\uff1a"+e.attr.GetAttrVale(f.AttrType.WaterAttack)+",\u6c34\u9632\uff1a"+e.attr.GetAttrVale(f.AttrType.WaterDef)+",\u706b\u653b \uff1a"+e.attr.GetAttrVale(f.AttrType.FireAttack)+",\u706b\u9632\uff1a"+e.attr.GetAttrVale(f.AttrType.FireDef)+",\u98ce\u653b\uff1a"+e.attr.GetAttrVale(f.AttrType.WindAttack)+",\u98ce\u9632\uff1a"+e.attr.GetAttrVale(f.AttrType.WindDef));for(var s=f.AttrType.MaxHp;s<=f.AttrType.WindDef;s++){var l=e.attr.GetVale(s);s<f.AttrType.Hit?s==f.AttrType.Defence?e.attr.ChangeAtt(s,l*a):e.attr.ChangeAtt(s,l*n):e.attr.ChangeAtt(s,l*o)}A.default.log("\u85cf\u5b9d\u56fe\u5c5e\u6027----\u66ff\u6362\u540e\uff1a",",\u8840\u91cf\uff1a"+e.attr.GetAttrVale(f.AttrType.MaxHp)+",\u653b\u51fb\uff1a"+e.attr.GetAttrVale(f.AttrType.Attack)+",\u9632\u5fa1\uff1a"+e.attr.GetAttrVale(f.AttrType.Defence)+",\u547d\u4e2d\uff1a"+e.attr.GetAttrVale(f.AttrType.Hit)+",\u95ea\u907f\uff1a"+e.attr.GetAttrVale(f.AttrType.Dodge)+",\u66b4\u51fb\uff1a"+e.attr.GetAttrVale(f.AttrType.Critical)+",\u97e7\u6027\uff1a"+e.attr.GetAttrVale(f.AttrType.DefCri)+",\u96f7\u653b:"+e.attr.GetAttrVale(f.AttrType.ThunderAttack)+",\u96f7\u9632\uff1a"+e.attr.GetAttrVale(f.AttrType.ThunderDef)+",\u571f\u653b\uff1a"+e.attr.GetAttrVale(f.AttrType.EarthAttack)+",\u571f\u9632\uff1a"+e.attr.GetAttrVale(f.AttrType.EarthDef)+",\u6c34\u653b\uff1a"+e.attr.GetAttrVale(f.AttrType.WaterAttack)+",\u6c34\u9632\uff1a"+e.attr.GetAttrVale(f.AttrType.WaterDef)+",\u706b\u653b \uff1a"+e.attr.GetAttrVale(f.AttrType.FireAttack)+",\u706b\u9632\uff1a"+e.attr.GetAttrVale(f.AttrType.FireDef)+",\u98ce\u653b\uff1a"+e.attr.GetAttrVale(f.AttrType.WindAttack)+",\u98ce\u9632\uff1a"+e.attr.GetAttrVale(f.AttrType.WindDef))},t.prototype.onCheckCanEnter=function(){return this.getTreasureMainConfig().enterCount-this.getInNum>0},t.instance=null,t=i=__decorate([G],t)}(n.default));i.default=F,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Const/EntityType":"EntityType","../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/TimeController":"TimeController","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../NetConnect/NetConnet":"NetConnet","../../Util/CommonUtil":"CommonUtil","../../Util/Utils":"Utils","../Buff/BuffController":"BuffController","../Chapter/GuanqiaController":"GuanqiaController","../Commons/WindowOpenUtils":"WindowOpenUtils","../Fight/FightUtils":"FightUtils","../OpenWin/OpenWinController":"OpenWinController","../Role/RoleInfo":"RoleInfo","../SandTable/SandTableController":"SandTableController","../Scene/Controller/EntityQiPaoController":"EntityQiPaoController","../Scene/Controller/SceneController":"SceneController","../Scene/Controller/SkillController":"SkillController","../Scene/Manager/SceneManager":"SceneManager","../Scene/Prop/EntityProperty":"EntityProperty","../Scene/Unit/FightLog":"FightLog","../Scene/View/ActorsLayer":"ActorsLayer","../Status/StatusType":"StatusType","../Tips/OpTipsController":"OpTipsController","../Tips/TipsWinController":"TipsWinController","../WarTeam/MonsterController":"MonsterController","./Data/TreasureConfig":"TreasureConfig","./Data/TreasureData":"TreasureData"}],TreasureNodeData:[function(e,t,i){"use strict";cc._RF.push(t,"28d2bJrS9BPQ6FAIhbVt+o6","TreasureNodeData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Util/Utils"),o=cc._decorator,a=o.ccclass,r=(o.property,function(){function e(){this.nodeType=2,this.nodeLevel=1,this.nodePosition=1,this.nodeIndex=0,this.nodeStatus=0,this.nodeParam=[],this.nodeReward=0,this.nodeConnect=[]}return e.prototype.onInitData=function(e,t,i,n,o){void 0===t&&(t=1),void 0===i&&(i=1),void 0===n&&(n=0),void 0===o&&(o=null),e&&(this.nodeType=e.type,this.nodeStatus=e.status,this.nodeParam=e.param,this.nodeReward=e.reward),this.nodeIndex=n,this.nodeLevel=t,this.nodePosition=i,this.nodeConnect=o},Object.defineProperty(e.prototype,"setNodeType",{set:function(e){this.nodeType=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getNodeType",{get:function(){return this.nodeType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"setNodeLevel",{set:function(e){this.nodeLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getNodeLevel",{get:function(){return this.nodeLevel},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"setNodePosition",{set:function(e){this.nodePosition=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getNodePosition",{get:function(){return this.nodePosition},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"setNodeConnect",{set:function(e){this.nodeConnect=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getNodeConnect",{get:function(){return this.nodeConnect},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getNodeIndex",{get:function(){return this.nodeIndex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"setNodeStatus",{set:function(e){this.nodeStatus=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getNodeStatus",{get:function(){return this.nodeStatus},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"setNodeParam",{set:function(e){this.nodeParam=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getNodeParam",{get:function(){return this.nodeParam},enumerable:!0,configurable:!0}),e.prototype.getParamId=function(){var e=n.default.RandomBy(0,this.getNodeParam.length-1);return this.nodeParam[e]},e=__decorate([a],e)}());i.default=r,cc._RF.pop()},{"../../../Util/Utils":"Utils"}],TreasureNodeItem:[function(e,t,i){"use strict";cc._RF.push(t,"2ef30QwD0dF/oeoaMNmm9Nr","TreasureNodeItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/Language"),a=e("./TreasureMapController"),r=e("./TreasureLine"),s=e("../../Util/Utils"),l=e("../../Core/TimeController"),c=e("../../Util/GrayEffect"),d=e("../../GlobalContext"),p=e("../../Core/LoadManager"),h=cc._decorator,u=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layerNorBG=null,t.layerUnknowBG=null,t.spriteNodeType=null,t.btnNode=null,t.layerNorName=null,t.layerUnknowName=null,t.layerLine=null,t.treasureAtlas=null,t.effectBottom=[],t.itemData=null,t.isPass=!1,t.canClick=!0,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this),this.node.setContentSize(229,143)},t.prototype.initData=function(e,t,i,n){void 0===i&&(i=!1),void 0===n&&(n=[]),this.itemData=e,this.isPass=i;var r=e.getNodeLevel==t.getNodeLevel&&e.getNodePosition==t.getNodePosition?a.default.instance.Event_Type_CurrentNode:e.getNodeType;this.layerNorBG.active=r!=a.default.instance.Event_Type_CurrentNode,this.layerNorName.active=r!=a.default.instance.Event_Type_CurrentNode,this.layerUnknowName.active=r==a.default.instance.Event_Type_CurrentNode,this.layerUnknowBG.active=r==a.default.instance.Event_Type_CurrentNode;var s=!1;if(n&&n.length>0&&n[0]==e.getNodeLevel)for(var l=1;l<n.length;l++)if(n[l]==e.getNodePosition){s=!0;break}s?this.effectBottom[0].runAction(cc.repeatForever(cc.sequence(cc.spawn(cc.scaleTo(.9,1.3),cc.moveTo(.9,0,10)),cc.spawn(cc.scaleTo(.9,1),cc.moveTo(.9,0,0))))):(this.effectBottom[0].stopAllActions(),this.effectBottom[0].setScale(1));var d,p=r!=a.default.instance.Event_Type_CurrentNode?this.layerNorName:this.layerUnknowName,h="treasure_node_name"+r;switch(this.spriteNodeType.node.setContentSize(114,103),r){case a.default.instance.Event_Type_Monster:d="iocn_pt";break;case a.default.instance.Event_Type_Campsite:d="iocn_by";break;case a.default.instance.Event_Type_medical:d="iocn_hxyp";break;case a.default.instance.Event_Type_Shop:d="iocn_sd";break;case a.default.instance.Event_Type_Trap:case a.default.instance.Event_Type_Unkonw:d="iocn_wz";break;case a.default.instance.Event_Type_Elite:d="iocn_jy";break;case a.default.instance.Event_Type_Boss:d="iocn_boss";break;case a.default.instance.Event_Type_CurrentNode:this.spriteNodeType.node.setContentSize(78,78),d="iocn_qd"}(this.spriteNodeType.spriteFrame=this.treasureAtlas.getSpriteFrame(d),this.btnNode.enabled=!this.isPass,this.spriteNodeType.node.getComponent(c.default))?this.spriteNodeType.node.getComponent(c.default).setGray(this.isPass):this.isPass&&this.spriteNodeType.node.addComponent(c.default).setGray(!0);p.getChildByName("labelName")&&p.getChildByName("labelName").getComponent(cc.Label)&&o.default.getStr(h)&&(p.getChildByName("labelName").getComponent(cc.Label).string=o.default.getStr(h))},t.prototype.createLine=function(e,t,i){var n=this;void 0===i&&(i=null),s.default.setNodeChildDestoryByUrl(this.layerLine,d.GlobalContext.Root+"prefab/treasuremap/TreasureLine"),p.default.instance.loadResByType(d.GlobalContext.Root+"prefab/treasuremap/TreasureLine",cc.Prefab,function(i){for(var o=n.itemData.getNodeConnect?n.itemData.getNodeConnect.length:0,a=0;a<o;a++){var l=s.default.getNodeByUrl(i,d.GlobalContext.Root+"prefab/treasuremap/TreasureLine"),c=n.itemData.getNodeConnect[a],p=!0;n.itemData.getNodePosition<c[0]&&(p=!1);var h=(n.itemData.getNodePosition-c[0])*e;l.setPosition(-h/2,t/2-20),l.getComponent(r.default).initData(0!=c[1]&&0!=c[2],Math.abs(h),t,p),n.layerLine.addChild(l)}},this)},t.prototype.onCkeckIsPass=function(e,t){if(e&&e.length>0)for(var i=e.length,n=0;n<i;n++)if(e[n]&&e[n].length>2&&e[n][0]==this.itemData.getNodeLevel){if(e[n][1]==this.itemData.getNodePosition&&e[n][2]==t)return!0;break}return!1},t.prototype.onClick=function(e){var t=this;void 0===e&&(e=null),this.canClick&&(this.canClick=!1,a.default.instance.onSelectEvent(this.itemData),l.default.instance.setTimeout(function(){t.canClick=!0},this,1e3))},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),this.effectBottom[0].stopAllActions(),this.effectBottom[0].setScale(1),s.default.setNodeChildDestoryByUrl(this.layerLine,d.GlobalContext.Root+"prefab/treasuremap/TreasureLine")},__decorate([f(cc.Node)],t.prototype,"layerNorBG",void 0),__decorate([f(cc.Node)],t.prototype,"layerUnknowBG",void 0),__decorate([f(cc.Sprite)],t.prototype,"spriteNodeType",void 0),__decorate([f(cc.Button)],t.prototype,"btnNode",void 0),__decorate([f(cc.Node)],t.prototype,"layerNorName",void 0),__decorate([f(cc.Node)],t.prototype,"layerUnknowName",void 0),__decorate([f(cc.Node)],t.prototype,"layerLine",void 0),__decorate([f(cc.SpriteAtlas)],t.prototype,"treasureAtlas",void 0),__decorate([f(cc.Node)],t.prototype,"effectBottom",void 0),t=__decorate([u],t)}(n.default);i.default=g,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../../GlobalContext":"GlobalContext","../../Util/GrayEffect":"GrayEffect","../../Util/Utils":"Utils","./TreasureLine":"TreasureLine","./TreasureMapController":"TreasureMapController"}],TreasureResult:[function(e,t,i){"use strict";cc._RF.push(t,"3d419gMgVVK7oJmAX8MiVwX","TreasureResult"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Util/Utils"),a=e("../../Core/WindowType"),r=e("../Item/ItemIcon"),s=e("../Commons/RewardUtils"),l=e("../../Core/GameEventDispatcher"),c=e("../../Global/GlobalValue"),d=e("../../Core/Event"),p=e("../../Core/WindowManager"),h=e("./TreasureMapController"),u=e("../../Core/TimeController"),f=e("./Data/TreasureConfig"),g=e("../../GlobalContext"),y=e("../../Core/LoadManager"),m=cc._decorator,C=m.ccclass,v=m.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.listContent=null,t.layerWin=null,t.layerLose=null,t.scrollView=null,t.layerBG=null,t.spriteLoseEffect=[],t.spriteWinEffect=[],t.isShow=!0,t.maxWid=650,t.lineMaxCount=5,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.show=function(){e.prototype.show.call(this),this.isShow=!0,this.showReward()},t.prototype.onShowWinEffect=function(){this.isShow&&(this.spriteWinEffect[0].runAction(cc.repeatForever(cc.sequence(cc.rotateTo(1,10),cc.rotateTo(.5,0)))),this.spriteWinEffect[1].runAction(cc.repeatForever(cc.sequence(cc.rotateTo(1,-10),cc.rotateTo(.5,0)))))},t.prototype.onShowLoseEffect=function(){if(this.isShow){this.spriteLoseEffect[0].opacity=255,this.spriteLoseEffect[1].opacity=255,this.spriteLoseEffect[2].opacity=255,this.spriteLoseEffect[3].opacity=255,this.spriteLoseEffect[0].setPosition(-195,59),this.spriteLoseEffect[1].setPosition(193,59),this.spriteLoseEffect[2].setPosition(-228,3),this.spriteLoseEffect[3].setPosition(198,20),this.spriteLoseEffect[0].runAction(cc.sequence(cc.spawn(cc.moveBy(.5,40,-30),cc.rotateTo(.5,-40)),cc.spawn(cc.moveBy(.5,-45,-30),cc.rotateTo(.5,20),cc.fadeOut(.6)))),this.spriteLoseEffect[1].runAction(cc.sequence(cc.spawn(cc.moveBy(.5,-30,-30),cc.rotateTo(.5,10)),cc.spawn(cc.moveBy(.5,40,-30),cc.rotateTo(.5,-10),cc.fadeOut(.6)))),this.spriteLoseEffect[2].runAction(cc.sequence(cc.spawn(cc.moveBy(.5,-30,-30),cc.rotateTo(.5,20)),cc.spawn(cc.sequence(cc.moveBy(.5,30,-30),cc.rotateTo(.5,-20),cc.spawn(cc.moveBy(.2,-20,-20),cc.rotateTo(.2,20))),cc.fadeOut(.7))));var e=cc.callFunc(function(e){this.onShowLoseEffect()},this);this.spriteLoseEffect[3].runAction(cc.sequence(cc.spawn(cc.moveBy(.5,30,-30),cc.rotateTo(.5,30)),cc.spawn(cc.sequence(cc.moveBy(.5,-30,-30),cc.rotateTo(.5,-20),cc.spawn(cc.moveBy(.2,20,-20),cc.rotateTo(.2,15))),cc.fadeOut(.7)),e))}},t.prototype.showReward=function(){var e=this,t=h.default.instance.rewardList,i=h.default.instance.isWinResult;!t||t.length<1?(this.layerWin.y=0,this.layerLose.y=0,this.layerWin.getChildByName("spriteBlackBG").active=!1,this.layerLose.getChildByName("spriteBlackBG").active=!1):(this.layerWin.y=175,this.layerLose.y=175,this.layerWin.getChildByName("spriteBlackBG").active=!0,this.layerLose.getChildByName("spriteBlackBG").active=!0),i?this.onShowWinEffect():this.onShowLoseEffect(),this.layerWin.active=i,this.layerLose.active=!i;var n=s.default.instance.getItemListByServerData(t);this.removeNode(),y.default.instance.loadResByType(g.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(i){var s=0;for(var l in n){if(5008==t[l].id)return;var c=o.default.getNodeByPool(a.PoolType.ItemIcon,i,g.GlobalContext.Root+"prefab/Bag/ItemIcon");c.getComponent(r.default).ItemData(n[l],!0,null,!0),e.listContent.addChild(c),c.setScale(.8),s++}if(s<5){var d=e.lineMaxCount-s,p=e.maxWid*d/(2*e.lineMaxCount);e.scrollView.node.x=p}else e.scrollView.node.x=0;e.scrollView.node.opacity=2,u.default.instance.setTimeout(function(){s>10?(e.scrollView.scrollToTop(),e.scrollView.node.y=0):e.scrollView.node.y=-(e.scrollView.node.height-e.listContent.height)/2,e.scrollView.node.opacity=255},e,20)},this)},t.prototype.removeNode=function(){for(var e=this.listContent.childrenCount-1;e>=0;e--)o.default.setNodeToPool(a.PoolType.ItemIcon,this.listContent.children[e])},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),this.removeNode()},t.prototype.onClose=function(){this.isShow=!1,l.GameEventDispatcher.instance.emit(d.EventDefiner.ChangeGameScene,{status:c.GameScene.Main}),l.GameEventDispatcher.instance.emit(f.TreasureConfig.treasureOut),h.default.instance.onTreasureEndClear(),p.default.instance.close(a.WindowType.TreasureResult)},__decorate([v(cc.Node)],t.prototype,"listContent",void 0),__decorate([v(cc.Node)],t.prototype,"layerWin",void 0),__decorate([v(cc.Node)],t.prototype,"layerLose",void 0),__decorate([v(cc.ScrollView)],t.prototype,"scrollView",void 0),__decorate([v(cc.Node)],t.prototype,"layerBG",void 0),__decorate([v([cc.Node])],t.prototype,"spriteLoseEffect",void 0),__decorate([v([cc.Node])],t.prototype,"spriteWinEffect",void 0),t=__decorate([C],t)}(n.default);i.default=_,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/RewardUtils":"RewardUtils","../Item/ItemIcon":"ItemIcon","./Data/TreasureConfig":"TreasureConfig","./TreasureMapController":"TreasureMapController"}],TreasureReward:[function(e,t,i){"use strict";cc._RF.push(t,"347fataDYhIiKW+u9dLv4dl","TreasureReward"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Language"),o=e("../Commons/CommonPageBG"),a=e("../../Util/Utils"),r=e("../../Core/WindowType"),s=e("../Item/ItemIcon"),l=e("../Commons/RewardUtils"),c=e("../../Core/TimeController"),d=e("../../Core/WindowManager"),p=e("../../GlobalContext"),h=e("../../Core/LoadManager"),u=cc._decorator,f=u.ccclass,g=u.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.listContent=null,t.scrollView=null,t.maxWid=620,t.lineMaxCount=5,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.onInit(702,445,n.default.getStr("treasure_reward_title"),!0),i.instance=this},t.prototype.initData=function(e){var t=this,i=l.default.instance.getItemListByServerData(e);this.removeNode(),h.default.instance.loadResByType(p.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(e){var n=0;for(var o in i){var l=a.default.getNodeByPool(r.PoolType.ItemIcon,e,p.GlobalContext.Root+"prefab/Bag/ItemIcon");l.getComponent(s.default).ItemData(i[o],!0,null,!0),t.listContent.addChild(l),l.setScale(.8),n++}if(n<5){var d=t.lineMaxCount-n,h=t.maxWid*d/(2*t.lineMaxCount);t.scrollView.node.x=h}else t.scrollView.node.x=0;t.scrollView.node.opacity=2,c.default.instance.setTimeout(function(){n>10?(t.scrollView.scrollToTop(),t.scrollView.node.y=0):t.scrollView.node.y=-(t.scrollView.node.height-t.listContent.height)/2,t.scrollView.node.opacity=255},t,100)},this)},t.prototype.removeNode=function(){for(var e=this.listContent.childrenCount-1;e>=0;e--)a.default.setNodeToPool(r.PoolType.ItemIcon,this.listContent.children[e])},t.prototype.onClose=function(){this.removeNode(),d.default.instance.close(r.WindowType.TreasureReward)},t.instance=null,__decorate([g(cc.Node)],t.prototype,"listContent",void 0),__decorate([g(cc.ScrollView)],t.prototype,"scrollView",void 0),t=i=__decorate([f],t)}(o.default);i.default=y,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/CommonPageBG":"CommonPageBG","../Commons/RewardUtils":"RewardUtils","../Item/ItemIcon":"ItemIcon"}],TreasureShopData:[function(e,t,i){"use strict";cc._RF.push(t,"941e9mBAAZLGrzw5YaHXOYk","TreasureShopData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/ConfigsManager"),o=cc._decorator,a=o.ccclass,r=(o.property,function(){function e(){this.treasureConfig=null}return e.prototype.initData=function(e){this.id=e},Object.defineProperty(e.prototype,"config",{get:function(){return this.treasureConfig=n.ConfigsManager.instance.getConfigs("treasureMapConf"),this.treasureConfig},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shopid",{get:function(){return this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemid",{get:function(){return this.config.shop[this.id].itemid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"price",{get:function(){return this.config.shop[this.id].price},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this.config.shop[this.id].type?this.config.shop[this.id].type:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"count",{get:function(){return this.config.shop[this.id].count?this.config.shop[this.id].count:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buffId",{get:function(){return this.config.shop[this.id].buffId?this.config.shop[this.id].buffId:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labelName",{get:function(){return this.config.shopType[this.type].name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemType",{get:function(){return this.config.shop[this.id].itemType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemParam",{get:function(){return this.config.shop[this.id].itemParam||0},enumerable:!0,configurable:!0}),e=__decorate([a],e)}());i.default=r,cc._RF.pop()},{"../../../Core/ConfigsManager":"ConfigsManager"}],TreasureShopItem:[function(e,t,i){"use strict";cc._RF.push(t,"c88e8+UZWVLFoDcvU4581HO","TreasureShopItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../Item/ItemData"),a=e("../Item/ItemIcon"),r=e("../../Core/WindowType"),s=e("../Shop/ShopController"),l=e("./Data/TreasureShopData"),c=e("../../Core/GameEventDispatcher"),d=e("./Data/TreasureConfig"),p=e("../../Util/Utils"),h=e("../../GlobalContext"),u=e("../../Core/LoadManager"),f=e("./TreasureMapController"),g=e("../Item/ItemWidget"),y=cc._decorator,m=y.ccclass,C=y.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ItemName=null,t.layerItemIcon=null,t.MoneyIcons=null,t.itemTypeAltas=null,t.Price=null,t.costTypeIcon=null,t.itemType=null,t.layerContent=null,t.layerNone=null,t.isCanBuy=!0,t.itemIndex=0,t.itemName="",t.itemCostTypeName="",t.shopData=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.show=function(){e.prototype.show.call(this),c.GameEventDispatcher.instance.on(d.TreasureConfig.treasureBuy,this.onShopBuy,this)},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),c.GameEventDispatcher.instance.off(d.TreasureConfig.treasureBuy,this.onShopBuy,this),this.layerItemIcon.childrenCount>0&&p.default.setNodeToPool(r.PoolType.ItemIcon,this.layerItemIcon.children[0])},t.prototype.onShopBuy=function(e){this.itemIndex-1==e.detail&&this.setItemNone()},t.prototype.initItem=function(e,t,i){var n=this;void 0===i&&(i=r.WindowType.Shop),u.default.instance.loadResByType(h.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(t){n.layerContent.active=!0,n.layerItemIcon.active=!0,n.layerNone.active=!1,n.isCanBuy=!0,n.itemIndex=e,n.shopData=new l.default,n.shopData.initData(e),n.itemCostTypeName=s.default.instance.getIconNmae(n.shopData.labelName),n.costTypeIcon.spriteFrame=n.MoneyIcons.getSpriteFrame(n.itemCostTypeName);var i=new o.default;if(i=o.default.creatItem(n.shopData.itemid,n.shopData.count),n.layerItemIcon.childrenCount<1){var c=p.default.getNodeByPool(r.PoolType.ItemIcon,t,h.GlobalContext.Root+"prefab/Bag/ItemIcon");c.getComponent(a.default).comCall=function(){c.getComponentInChildren(g.default).debris.active=!1},c.getComponent(a.default).comCallThis=n,n.layerItemIcon.addChild(c)}switch(n.layerItemIcon.getComponentInChildren(a.default).ItemData(i,!0,"",!0),n.itemName=f.default.instance.getItemName(e),2==n.shopData.itemType&&-1!=n.itemName.indexOf("\u788e\u7247")&&(n.itemName=n.itemName.replace("\u788e\u7247","")),n.ItemName.string=n.itemName,n.Price.string=n.shopData.price+"",n.shopData.itemType){case 2:n.itemType.spriteFrame=n.itemTypeAltas.getSpriteFrame("iocn_yj");break;case 3:n.itemType.spriteFrame=n.itemTypeAltas.getSpriteFrame("iocn_zy");break;default:n.itemType.spriteFrame=n.itemTypeAltas.getSpriteFrame("iocn_dj")}},this)},t.prototype.setItemNone=function(){this.layerContent.active=!1,this.layerNone.active=!0,this.layerItemIcon.active=!1,this.isCanBuy=!1},t.prototype.ItemClick=function(){this.isCanBuy&&c.GameEventDispatcher.instance.emit(d.TreasureConfig.treasureShopConfire,{index:this.itemIndex,itemCostIconName:this.itemCostTypeName,itemPrice:this.shopData.price,itemName:this.itemName,costType:this.shopData.type,itemParam:3==this.shopData.itemType?this.shopData.itemParam:0})},__decorate([C(cc.Label)],t.prototype,"ItemName",void 0),__decorate([C(cc.Node)],t.prototype,"layerItemIcon",void 0),__decorate([C(cc.SpriteAtlas)],t.prototype,"MoneyIcons",void 0),__decorate([C(cc.SpriteAtlas)],t.prototype,"itemTypeAltas",void 0),__decorate([C(cc.Label)],t.prototype,"Price",void 0),__decorate([C(cc.Sprite)],t.prototype,"costTypeIcon",void 0),__decorate([C(cc.Sprite)],t.prototype,"itemType",void 0),__decorate([C(cc.Node)],t.prototype,"layerContent",void 0),__decorate([C(cc.Node)],t.prototype,"layerNone",void 0),t=__decorate([m],t)}(n.default);i.default=v,cc._RF.pop()},{"../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/LoadManager":"LoadManager","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Item/ItemData":"ItemData","../Item/ItemIcon":"ItemIcon","../Item/ItemWidget":"ItemWidget","../Shop/ShopController":"ShopController","./Data/TreasureConfig":"TreasureConfig","./Data/TreasureShopData":"TreasureShopData","./TreasureMapController":"TreasureMapController"}],TreasureShop:[function(e,t,i){"use strict";cc._RF.push(t,"6db54K/YChM5L1dKumO+9W4","TreasureShop"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Language"),o=e("../Commons/CommonPageBG"),a=e("../../Core/ConfigsManager"),r=e("../../Core/GameEventDispatcher"),s=e("../Shop/ShopBuyConfire"),l=e("./TreasureMapController"),c=e("./TreasureShopItem"),d=e("../../Core/WindowManager"),p=e("../../Core/WindowType"),h=e("./Data/TreasureConfig"),u=e("../../Util/Utils"),f=e("../Role/RoleController"),g=e("../../Global/GlobalValue"),y=e("../../Util/RechargeUtils"),m=e("../../GlobalContext"),C=e("../../Core/LoadManager"),v=e("../../Util/RechargeConst"),_=cc._decorator,b=_.ccclass,T=_.property,S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.listContent=null,t.layerBuyConfire=null,t.scrollView=null,t._shopSaleIndexList=[],t._shopItemList=[],t._buyItemData=null,t.buyConfire=null,t.shopConfig=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),this.onInit(758,614,n.default.getStr("treasure_shop_title"),!0),this.shopConfig=a.ConfigsManager.instance.getConfigs("treasureMapConf").shop,r.GameEventDispatcher.instance.on(h.TreasureConfig.treasureShopConfire,this.onOpenConfire,this),this.layerBuyConfire.active=!1,this.onInitSaleItem(),this.scrollView.scrollToTop()},t.prototype.onClose=function(){r.GameEventDispatcher.instance.off(h.TreasureConfig.treasureShopConfire,this.onOpenConfire,this),d.default.instance.close(p.WindowType.TreasureShop)},t.prototype.onInitSaleItem=function(){this._shopSaleIndexList=[];var e=l.default.instance.getTreasureMainConfig();this.onRanDomItem(e,[])},t.prototype.onRanDomItem=function(e,t,i){void 0===t&&(t=[]),void 0===i&&(i=-1);var n=t,o=i;this._shopSaleIndexList.length<e.shopItemList.length?((!n||n.length<1)&&(n=this.onGetRandomList(e.shopItemList[this._shopSaleIndexList.length])),o=n[u.default.RandomBy(0,n.length-1)],n=[]):((!n||n.length<1)&&(n=this.onGetRandomList()),o=n[u.default.RandomBy(0,n.length-1)]);for(var a=0;a<this._shopSaleIndexList.length;a++)if(this._shopSaleIndexList[a]==o)return void this.onRanDomItem(e,n);this._shopSaleIndexList.push(o),this._shopSaleIndexList.length<e.shopItemMax?this.onRanDomItem(e,n):this.initData()},t.prototype.onGetRandomList=function(e){void 0===e&&(e=-1);var t=[];for(var i in this.shopConfig)-1!=e?this.shopConfig[i].itemType==e&&t.push(this.shopConfig[i].id):this.shopConfig[i]&&t.push(this.shopConfig[i].id);return t},t.prototype.initData=function(){var e=this;u.default.setNodeChildDestoryByUrl(this.listContent,m.GlobalContext.Root+"prefab/treasuremap/TreasureShopItem"),this._shopItemList=[],C.default.instance.loadResByType(m.GlobalContext.Root+"prefab/treasuremap/TreasureShopItem",cc.Prefab,function(t){for(var i in e._shopSaleIndexList)if(e._shopSaleIndexList[i]>0){var n=u.default.getNodeByUrl(t,m.GlobalContext.Root+"prefab/treasuremap/TreasureShopItem");e.listContent.addChild(n),n.getComponent(c.default).initItem(e._shopSaleIndexList[i],0),e._shopItemList.push(n)}},this)},t.prototype.onOpenConfire=function(e){var t=this;this._buyItemData=e.detail,this._buyItemData.costType==g.WealthType.Diamond?y.default.PurchaseItemOrRechage(v.RechargeTypeConst.Diamonds,this._buyItemData.itemPrice,function(){t.layerBuyConfire.active=!0,t.layerBuyConfire.getComponent(s.default).onInitData(t._buyItemData.index,t._buyItemData.itemCostIconName,t._buyItemData.itemName,t._buyItemData.itemPrice,t._buyItemData.itemParam)},this):f.default.instance.CheckMyWealthIsEnough(this._buyItemData.costType,this._buyItemData.itemPrice,!0)&&(this.layerBuyConfire.active=!0,this.layerBuyConfire.getComponent(s.default).onInitData(this._buyItemData.index,this._buyItemData.itemCostIconName,this._buyItemData.itemName,this._buyItemData.itemPrice,this._buyItemData.itemParam))},__decorate([T(cc.Node)],t.prototype,"listContent",void 0),__decorate([T(cc.Node)],t.prototype,"layerBuyConfire",void 0),__decorate([T(cc.ScrollView)],t.prototype,"scrollView",void 0),t=__decorate([b],t)}(o.default);i.default=S,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/RechargeConst":"RechargeConst","../../Util/RechargeUtils":"RechargeUtils","../../Util/Utils":"Utils","../Commons/CommonPageBG":"CommonPageBG","../Role/RoleController":"RoleController","../Shop/ShopBuyConfire":"ShopBuyConfire","./Data/TreasureConfig":"TreasureConfig","./TreasureMapController":"TreasureMapController","./TreasureShopItem":"TreasureShopItem"}],TreasureTroop:[function(e,t,i){"use strict";cc._RF.push(t,"2c2c9og1xFC0qJixnw/Wzm8","TreasureTroop"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Language"),o=e("../WarTeam/MonsterController"),a=e("../../Core/ConfigsManager"),r=e("../Scene/Manager/SceneManager"),s=e("../Expedition/ExpeditionMonsterinfo"),l=e("../Commons/CombatValue"),c=e("../Commons/CommonPageBG"),d=e("../../Core/GameEventDispatcher"),p=e("../../Core/Event"),h=e("./TreasureMapController"),u=e("../../Core/WindowManager"),f=e("../../Core/WindowType"),g=e("../OpenWin/OpenWinController"),y=e("../Status/StatusType"),m=e("../../Util/MonsterGroupUtils"),C=e("../HighLadder/HighLadderWin"),v=e("../HighLadder/HighLadderData"),_=e("../Guide/GuideNewController"),b=e("../Status/StatusController"),T=e("../FightInfoPanel/FightInfoPanel"),S=e("../../Util/Utils"),I=e("../../GlobalContext"),w=e("../../Core/LoadManager"),D=e("../Role/RoleInfo"),R=e("../Activity/ActivityController"),A=e("../Commons/MonsterPreview"),N=cc._decorator,L=N.ccclass,E=N.property,B=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.listContent=null,t.spriteCombat=null,t.btnConfire=null,t.btnCancle=null,t.btnTeam=null,t.monsterPreview=null,t.roleCombat=null,t.roleLabe=null,t._cardConfigs=null,t.monsterList=[],t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this,this.onInit(1035,576,n.default.getStr("treasure_troop_title"),!0)},t.prototype.onInitData=function(){},t.prototype.show=function(){e.prototype.show.call(this),this.leftInfo(),this.initData()},t.prototype.hide=function(){e.prototype.hide.call(this),d.GameEventDispatcher.instance.emit(p.EventDefiner.TreasureTroopSwitch,!1)},t.prototype.onClose=function(){this.onClickConfire()},t.prototype.leftInfo=function(){var e=this;S.default.setNodeChildDestoryByUrl(this.roleCombat,I.GlobalContext.Root+"prefab/CombatVal"),w.default.instance.loadResByType(I.GlobalContext.Root+"prefab/CombatVal",cc.Prefab,function(t){var i=S.default.getNodeByUrl(t,I.GlobalContext.Root+"prefab/CombatVal");e.roleCombat.addChild(i),e.roleCombat.getComponentInChildren(l.default).onInit(D.MyRoleInfo.Fight,34,1.5,!1)},this),this.monsterPreview.getComponent(A.default).init("role",D.MyRoleInfo.currentsurface,1,"default"),this.roleLabe.string=D.MyRoleInfo.name},t.prototype.initData=function(){var e=this;this._cardConfigs||(this._cardConfigs=a.ConfigsManager.instance.getConfigs("cardConf"));var t,i=null,n=0;switch(this.btnConfire.node.active=this.btnCancle.node.active=!0,this.btnTeam.node.active=!1,y.ActivityStatus.value){case y.ActivityStatus.HighLadder:this.monsterList=o.default.instance.getServerListChangeBattleList(v.SelfHighLadderData.Lineup),i=o.default.instance.GetWarTeamConfig(),t=m.default.getMonsterGroup(this.monsterList,i,!0),this.btnTeam.node.active=!0;break;case y.ActivityStatus.TreasureMap:this.monsterList=r.default.instance.leftlives.concat(),this.btnCancle.node.active=h.default.instance.treasureLevel<2,i=o.default.instance.GetWarTeamConfig(),t=m.default.getMonsterGroup(this.monsterList,i)}S.default.setNodeChildDestoryByUrl(this.listContent,I.GlobalContext.Root+"prefab/Expedition/ExpeditionMonsterinfo"),w.default.instance.loadResByType(I.GlobalContext.Root+"prefab/Expedition/ExpeditionMonsterinfo",cc.Prefab,function(o){for(var a in i){var r=i[a],c=m.default.getMonsterIndex(t,r),d=S.default.getNodeByUrl(o,I.GlobalContext.Root+"prefab/Expedition/ExpeditionMonsterinfo");e.listContent.addChild(d),n+=d.getComponent(s.default).initData(r.id,r.level,r.grade,e._cardConfigs.Card[r.id].cardName,c?t[c].list:[])}e.node.getComponentInChildren(cc.ScrollView).scrollToTop(),n+=D.MyRoleInfo.Fight,S.default.setNodeChildDestoryByUrl(e.spriteCombat,I.GlobalContext.Root+"prefab/CombatVal"),w.default.instance.loadResByType(I.GlobalContext.Root+"prefab/CombatVal",cc.Prefab,function(t){var i=S.default.getNodeByUrl(t,I.GlobalContext.Root+"prefab/CombatVal");e.spriteCombat.addChild(i),e.spriteCombat.getComponentInChildren(l.default).onInit(n,34,1.5,!0)},e)},this)},t.prototype.onClickConfire=function(){y.ActivityStatus.value==y.ActivityStatus.HighLadder?u.default.instance.close(f.WindowType.TreasureTroop):y.ActivityStatus.value==y.ActivityStatus.TreasureMap&&(d.GameEventDispatcher.instance.emit(p.EventDefiner.C_Fight_Data_Save,h.default.instance.treasureLevel>1||h.default.instance.isOpenMainView),h.default.instance.isOpenMainView=!0,h.default.instance.onCheckToOut(),_.default.instance.checkCondition(11),b.default.instance.activityStatusHandle(!1,!1,!0),u.default.instance.close(f.WindowType.TreasureTroop)),R.default.instance.isSetSandTab=!1},t.prototype.onClickCancle=function(){y.ActivityStatus.value==y.ActivityStatus.HighLadder&&C.default.instance?C.default.instance.onSetSquad():y.ActivityStatus.value==y.ActivityStatus.TreasureMap&&h.default.instance.onSelectMonster(),T.default.instance&&T.default.instance.onResetMonsterNum(),u.default.instance.close(f.WindowType.TreasureTroop)},t.prototype.onClickTeam=function(){g.default.instance.openWindow(f.WindowType.WarTeam)},t.instance=null,__decorate([E(cc.Node)],t.prototype,"listContent",void 0),__decorate([E(cc.Node)],t.prototype,"spriteCombat",void 0),__decorate([E(cc.Button)],t.prototype,"btnConfire",void 0),__decorate([E(cc.Button)],t.prototype,"btnCancle",void 0),__decorate([E(cc.Button)],t.prototype,"btnTeam",void 0),__decorate([E(cc.Node)],t.prototype,"monsterPreview",void 0),__decorate([E(cc.Node)],t.prototype,"roleCombat",void 0),__decorate([E(cc.Label)],t.prototype,"roleLabe",void 0),t=i=__decorate([L],t)}(c.default);i.default=B,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/MonsterGroupUtils":"MonsterGroupUtils","../../Util/Utils":"Utils","../Activity/ActivityController":"ActivityController","../Commons/CombatValue":"CombatValue","../Commons/CommonPageBG":"CommonPageBG","../Commons/MonsterPreview":"MonsterPreview","../Expedition/ExpeditionMonsterinfo":"ExpeditionMonsterinfo","../FightInfoPanel/FightInfoPanel":"FightInfoPanel","../Guide/GuideNewController":"GuideNewController","../HighLadder/HighLadderData":"HighLadderData","../HighLadder/HighLadderWin":"HighLadderWin","../OpenWin/OpenWinController":"OpenWinController","../Role/RoleInfo":"RoleInfo","../Scene/Manager/SceneManager":"SceneManager","../Status/StatusController":"StatusController","../Status/StatusType":"StatusType","../WarTeam/MonsterController":"MonsterController","./TreasureMapController":"TreasureMapController"}],Typeinfo:[function(e,t,i){"use strict";cc._RF.push(t,"f784eZDOaNA16X23S0Ffbie","Typeinfo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/GameEventDispatcher"),a=e("../../Core/Event"),r=e("./AchievementData"),s=e("../Commons/CommonProgress"),l=cc._decorator,c=l.ccclass,d=l.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ProgressNum=null,t.totalnum=null,t.Icon=null,t.Icons=null,t.TypeName=null,t.Achieved=null,t.config=null,t.num=0,t.totalNum=0,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this),this.config=new r.default,o.GameEventDispatcher.instance.on(a.EventDefiner.SetProgress,this.setProgress,this)},t.prototype.show=function(){o.GameEventDispatcher.instance.on(a.EventDefiner.SetProgress,this.setProgress,this)},t.prototype.hide=function(){o.GameEventDispatcher.instance.off(a.EventDefiner.SetProgress,this.setProgress,this)},t.prototype.setProgress=function(e){if(e){var t=e.getUserData();this.config.initData(t),this.config.labelName==this.TypeName.string&&(this.num+=1,this.ProgressNum.string=this.num+"",this.totalnum.string="/"+this.totalNum,this.Achieved.getComponent(s.default).value=this.num/this.totalNum)}},t.prototype.init=function(e,t,i){this.TypeName.string=e,this.ProgressNum.string=t+"",this.totalnum.string="/"+i,this.Achieved.getComponent(s.default).value=t/i,this.num=t,this.totalNum=i,this.setIcon(e)},t.prototype.setIcon=function(e){"\u6210\u957f"==e?this.Icon.spriteFrame=this.Icons.getSpriteFrame("growth"):"\u6536\u96c6"==e?this.Icon.spriteFrame=this.Icons.getSpriteFrame("collet"):"\u793e\u4ea4"==e?this.Icon.spriteFrame=this.Icons.getSpriteFrame("socile"):"\u6d3b\u52a8"==e&&(this.Icon.spriteFrame=this.Icons.getSpriteFrame("other"))},__decorate([d(cc.Label)],t.prototype,"ProgressNum",void 0),__decorate([d(cc.Label)],t.prototype,"totalnum",void 0),__decorate([d(cc.Sprite)],t.prototype,"Icon",void 0),__decorate([d(cc.SpriteAtlas)],t.prototype,"Icons",void 0),__decorate([d(cc.Label)],t.prototype,"TypeName",void 0),__decorate([d(cc.Node)],t.prototype,"Achieved",void 0),t=__decorate([c],t)}(n.default);i.default=p,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Widget":"Widget","../Commons/CommonProgress":"CommonProgress","./AchievementData":"AchievementData"}],UIBtnEffectController:[function(e,t,i){"use strict";cc._RF.push(t,"77f6d6IxOxNCa1pjvYX7kKu","UIBtnEffectController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/LoadManager"),o=e("../../../GlobalContext"),a=e("../../../Util/Utils"),r=e("../../../Core/WindowType"),s=cc._decorator,l=s.ccclass,c=(s.property,function(){function e(){this._wantEffectWindowList=[r.WindowType.LoopActivity,r.WindowType.RoleStrengthen,r.WindowType.OneSeckill,r.WindowType.SingleRechargeRebate,r.WindowType.ActivityView,r.WindowType.DrawCard,r.WindowType.RechargeWin,r.WindowType.DailyQusest,r.WindowType.SevenDayRanking,r.WindowType.BaiBeiFanLi,r.WindowType.SevenDayTarget,r.WindowType.WelfareLobby,r.WindowType.CardRecommend,r.WindowType.HalfPrice],this._clickWindowList=[],this._redWindowList=[],this._itemEffect=null}var t;return t=e,Object.defineProperty(e,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),e.prototype.onPushClickWindowType=function(e,t){a.default.checkInList(e,this._clickWindowList)||this._clickWindowList.push(e),a.default.checkInList(e,this._redWindowList)||this.onClearEffect(t)},e.prototype.onSetEffect=function(e,t,i,r){void 0===t&&(t=0),void 0===i&&(i=!1),void 0===r&&(r=1);var s=!1,l=i;t>0&&(s=a.default.checkInList(t,this._wantEffectWindowList)&&!a.default.checkInList(t,this._clickWindowList),a.default.checkInList(t,this._wantEffectWindowList)&&(i&&!a.default.checkInList(t,this._redWindowList)?this._redWindowList.push(t):!i&&a.default.checkInList(t,this._redWindowList)&&(this._redWindowList=a.default.removeInList(t,this._redWindowList))),l=i&&a.default.checkInList(t,this._wantEffectWindowList)),e&&(s||l)?this._itemEffect?this.onLoadComplete(this._itemEffect,e,r):n.default.instance.loadResByType(o.GlobalContext.Root+"effects/prefabs/UIBtnEffect/UIBtnEffect",cc.Prefab,this.onLoadComplete,this,[e,r]):this.onClearEffect(e)},e.prototype.onLoadComplete=function(e,t,i){if(void 0===i&&(i=1),this._itemEffect||(this._itemEffect=e),t&&t.parent&&!t.getChildByName("btnEffect")){var n=a.default.getNodeByUrl(this._itemEffect,o.GlobalContext.Root+"effects/prefabs/UIBtnEffect/UIBtnEffect");n.name="btnEffect",t.insertChild(n,999),n.setScale(i)}},e.prototype.onClearEffect=function(e){e&&e.parent&&e.getChildByName("btnEffect")&&(e.removeChild(e.getChildByName("btnEffect")),a.default.setNodeDestoryByUrl(e.getChildByName("btnEffect"),o.GlobalContext.Root+"effects/prefabs/UIBtnEffect/UIBtnEffect"))},e._instance=null,e=t=__decorate([l],e)}());i.default=c,cc._RF.pop()},{"../../../Core/LoadManager":"LoadManager","../../../Core/WindowType":"WindowType","../../../GlobalContext":"GlobalContext","../../../Util/Utils":"Utils"}],UltimateTeamItem:[function(e,t,i){"use strict";cc._RF.push(t,"97bffdl1vtO3I6hZiseCv8D","UltimateTeamItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/CommonsResManager"),a=e("../WarTeam/MonsterController"),r=e("../Commons/MonsterPreview"),s=e("../../Util/Utils"),l=e("../../Core/WindowType"),c=e("../../Core/WindowManager"),d=e("../Commons/WindowOpenUtils"),p=cc._decorator,h=p.ccclass,u=p.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ratiy=null,t.pos=null,t.titleLabe=null,t.describe=null,t.pathLabe=null,t.monsterNode=null,t.winType=null,t}return __extends(t,e),t.prototype.Init=function(e,t,i,n,c,d,p){this.ratiy.spriteFrame=o.default.instance.getSpriteFrameByName("rarity_"+e),this.pos.spriteFrame=o.default.instance.getSpriteFrameByName("stance_"+t),this.titleLabe.string=i,this.describe.string=n,this.winType=p,this.pathLabe.string=c;for(var h=this.monsterNode.childrenCount-1;h>=0;h--){this.monsterNode.children[h].getComponent(r.default).clear(),s.default.setNodeToPool(l.PoolType.MonsterPreview,this.monsterNode.children[h])}a.default.instance.infoPreview(this.monsterNode,cc.v2(0,0),d,5,.6,-1)},t.prototype.SkipBtnClick=function(){c.default.instance.close(l.WindowType.CardRecommend),this.winType[1]?d.default.instance.openWindowType(this.winType[0],this.winType[1]):d.default.instance.openWindowType(this.winType[0])},__decorate([u(cc.Sprite)],t.prototype,"ratiy",void 0),__decorate([u(cc.Sprite)],t.prototype,"pos",void 0),__decorate([u(cc.Label)],t.prototype,"titleLabe",void 0),__decorate([u(cc.RichText)],t.prototype,"describe",void 0),__decorate([u(cc.RichText)],t.prototype,"pathLabe",void 0),__decorate([u(cc.Node)],t.prototype,"monsterNode",void 0),t=__decorate([h],t)}(n.default);i.default=f,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Widget":"Widget","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../Util/Utils":"Utils","../Commons/MonsterPreview":"MonsterPreview","../Commons/WindowOpenUtils":"WindowOpenUtils","../WarTeam/MonsterController":"MonsterController"}],UpgradeStage:[function(e,t,i){"use strict";cc._RF.push(t,"18234lgy+FJQIYETZE0uzE/","UpgradeStage"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Core/Language"),a=e("../../Item/ItemIcon"),r=e("../../Item/ItemData"),s=e("./EquipCtrl"),l=e("../../Role/RoleInfo"),c=e("../../Tips/OpTipsController"),d=e("../../../Core/GameEventDispatcher"),p=e("../../../Core/Event"),h=e("../../Item/ItemController"),u=e("../../../Util/RechargeUtils"),f=e("../../../Util/RechargeConst"),g=e("../../Commons/RewardUtils"),y=e("../../../Core/SimpleActionEffect"),m=e("../EquipWin"),C=e("../../Sound/SoundController"),v=e("../../../Util/NumberUtil"),_=e("../../Tips/TipsWinController"),b=e("../../WarTeam/MonsterController"),T=e("../../../Util/AttrUtil"),S=cc._decorator,I=S.ccclass,w=S.property,D=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.effect=null,t.toggle=null,t.attrNode=null,t.effectAttrNode=null,t.attrIcons=null,t._guid=null,t._data=null,t._orderIsOkList=[],t._orderSelectList=[],t._orderUseCount=0,t._maxStage=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),d.GameEventDispatcher.instance.on(p.EventDefiner.EQUIP_upgrade_stage_ret,this.upgradeStage,this),d.GameEventDispatcher.instance.on("BagPackInfoChange",this.upShowData,this),d.GameEventDispatcher.instance.on(p.EventDefiner.Card_xingtai_up,this.upShowData,this)},t.prototype.hide=function(){this._data=null,this._guid=null,d.GameEventDispatcher.instance.off(p.EventDefiner.EQUIP_upgrade_stage_ret,this.upgradeStage,this),d.GameEventDispatcher.instance.off("BagPackInfoChange",this.upShowData,this),d.GameEventDispatcher.instance.off(p.EventDefiner.Card_xingtai_up,this.upShowData,this),e.prototype.hide.call(this)},t.prototype.setData=function(e){this._guid=e,this.upShowData()},t.prototype.upgradeStage=function(e){var t=e?e.getUserData():null;t&&t.result&&C.default.instance.PlayEffect(C.SoundType.upSucceeds),this.upShowData()},t.prototype.upShowData=function(){this._data=s.default.instance.data.getItemByGuid(this._guid),this._maxStage=s.default.instance.data.getStageLimit(l.MyRoleInfo.level),this._data?this.setinfoData(this._data):this.initData()},t.prototype.initData=function(){this.node.getChildByName("ItemIcon").active=!1,this.node.getChildByName("noEquip").active=!0,this.node.getChildByName("levelNode").active=!1,this.node.getChildByName("sprPrice").getChildByName("value").getComponent(cc.Label).string="0",this.node.getChildByName("btnNode").active=!1,this.node.getChildByName("maxStageNode").active=!1;var e=this.node.getChildByName("materialNode").getChildByName("node");for(var t in e.children)this.setItemData(e.children[t],null)},t.prototype.setEquipShow=function(e){this.node.getChildByName("ItemIcon").active=!0,this.node.getChildByName("noEquip").active=!1,this.node.getChildByName("ItemIcon").getComponent(a.default).ItemData(e,!1,null,!0)},t.prototype.setAttrSHow=function(e){var t=s.default.instance.data.getEquipInfoById(e.id),i=s.default.instance.data.getEquipCfg(),n=v.NumberUtil.unitsDigitToText(e.stage+1)+o.default.getStr("rank"),a=v.NumberUtil.unitsDigitToText(e.stage+2)+o.default.getStr("rank"),r=i.stage[t.stage][e.stage+1],l=this.node.getChildByName("levelNode");l.active=!0;var c=l.getChildByName("di1"),d=l.getChildByName("di2");c.getChildByName("name").getComponent(cc.Label).string=n,d.getChildByName("name").getComponent(cc.Label).string=r?a:n,this.setAttr(e),this.setEffectAttr(e)},t.prototype.setMaterialShsow=function(e){var t=s.default.instance.data.getEquipInfoById(e.id),i=s.default.instance.data.getEquipCfg(),n=i.stage[t.stage][e.stage],o=i.needItem[n.needItem],a=i.stage[t.stage][e.stage+1],l=0,c=this.node.getChildByName("materialNode").getChildByName("node");for(var d in c.children){var p=parseInt(d);if(p>0&&o[p-1]){c.children[p].active=!0,l=o[p-1].num;var h=r.default.creatItem(o[p-1].itemId,0),u=s.default.instance.data.getIconNumById(o[p-1].itemId);this._orderIsOkList[p-1]=u>=o[p-1].count,this.setItemData(c.children[p],h,u,o[p-1].count)}else c.children[p].active=!1}this._orderUseCount=l,this._orderSelectList=null;var f=0;if(this._orderUseCount>0){var g=s.default.instance.data.getOrderItem(e,this._orderUseCount);g&&(f=g.length,this._orderSelectList=f>this._orderUseCount?g.slice(0,this._orderUseCount):g)}c.children[0].active=this._orderUseCount>0,this.setItemData(c.children[0],e,f,this._orderUseCount),c.active=!!a},t.prototype.setOther=function(e){var t=s.default.instance.data.getEquipInfoById(e.id),i=s.default.instance.data.getEquipCfg(),n=i.stage[t.stage][e.stage+1],o=i.stage[t.stage][e.stage];this.node.getChildByName("btnNode").active=!!n,this.node.getChildByName("maxStageNode").active=!n,this.node.getChildByName("sprPrice").active=!1,this.node.getChildByName("sprPrice").getChildByName("value").getComponent(cc.Label).string=o.money},t.prototype.setinfoData=function(e){this.setEquipShow(e),this.setAttrSHow(e),this.setMaterialShsow(e),this.setOther(e)},t.prototype.setItemData=function(e,t,i,n){void 0===i&&(i=null),void 0===n&&(n=null);var o=!!t;e.getChildByName("ItemIcon").active=o,e.getChildByName("noEquip").active=!o,o&&e.getChildByName("ItemIcon").getComponent(a.default).ItemData(t,!1,null,!0);var r=e.getChildByName("num");r.getChildByName("value1").getComponent(cc.Label).string=i?""+i:"0",r.getChildByName("value2").getComponent(cc.Label).string=n?"/"+n:"/0"},t.prototype.onOrder=function(){var e=this,t=this._data,i=this.node.getChildByName("sprPrice").getChildByName("value").getComponent(cc.Label).string,n=!(this._orderUseCount>0)||this._orderSelectList&&this._orderSelectList.length>=this._orderUseCount;if(!n||this.judgeOrderIsOk()||this.toggle.isChecked||m.default.instance.upgradStage){var a=s.default.instance.data.getMaxUPLevelData(t);if(this._maxStage-1==t.stage)c.default.instance.ShowMsg("\u4eba\u7269\u7b49\u7ea7\u4e0d\u8db3\u65e0\u6cd5\u5347\u9636");else if(a>this._data.level+1)_.default.instance.ShowTips(o.default.getStr("equipTipsText2"),function(){d.GameEventDispatcher.instance.emit(p.EventDefiner.EQUIP_JumpTag,{index:0})},this,null,1,null,null,null,null,null,!1);else if(n)if(l.MyRoleInfo.money<Number(i))u.default.PurchaseItemOrRechage(f.RechargeTypeConst.Prop,Number(i),null,this,g.RewardType.Coin);else{var r=[],h=!1;if(this._orderSelectList)for(var C=0;C<this._orderSelectList.length;C++)r.push(this._orderSelectList[C].guid),h=h||this.orderFlag(this._orderSelectList[C]);h?_.default.instance.ShowTips(o.default.getStr("\u662f\u5426\u6d88\u8017\u5f3a\u5316\u8fc7\u88c5\u5907\u4f5c\u4e3a\u5347\u9636\u6750\u6599"),function(){e.effect.getComponent(y.default).playById(5,"upSKIllEffect",!1,null,e),s.default.instance.reqEquipupStage(t.guid,r,e.toggle.isChecked)},this,null,1,null,null,null,null,null,!1):(this.effect.getComponent(y.default).playById(5,"upSKIllEffect",!1,null,this),s.default.instance.reqEquipupStage(t.guid,r,this.toggle.isChecked))}else this.materialTips()}else{m.default.instance.upgradStage=!0;_.default.instance.ShowTips("\u662f\u5426\u5f00\u542f\u81ea\u52a8\u8d2d\u4e70",function(){e.toggle.isChecked=!0},null,null,1,null,null,function(){e.materialTips()})}},t.prototype.judgeOrderIsOk=function(){for(var e in this._orderIsOkList)if(0==this._orderIsOkList[e])return!1;return!0},t.prototype.orderFlag=function(e){return!!(e.level&&e.level>0)||(!!(e.stage&&e.stage>0)||(!!(e.refineLevel&&e.refineLevel>0)||!!(e.gem.length>0&&(e.gem[0]||e.gem[1]||e.gem[2]))))},t.prototype.materialTips=function(){var e=s.default.instance.data.getEquipInfoById(this._data.id),t=s.default.instance.data.getEquipCfg(),i=t.stage[e.stage][this._data.stage],n=t.needItem[i.needItem],o=s.default.instance.data.getIconNumById(n[0].itemId);n[0].equipFlag>0&&h.default.instance.getItemNum(this._data.id)<n[0].num?u.default.PurchaseItemOrRechage(f.RechargeTypeConst.Prop,n[0].num+1,null,this,this._data.id):o<n[0].count&&!this.toggle.isChecked&&u.default.PurchaseItemOrRechage(f.RechargeTypeConst.Prop,n[0].count,null,this,n[0].itemId)},t.prototype.setAttr=function(e){var t=s.default.instance.data.getEquipInfoById(this._data.id),i=s.default.instance.data.getEquipCfg(),n=i.stage[t.stage][e.stage],o=i.randomAttr[n.randomAttr],a=i.stage[t.stage][e.stage+1],r=a?i.randomAttr[a.randomAttr]:o,l=b.default.instance,c=[];c.push({name:"",val:n.maxlevel,val2:a?a.maxlevel:n.maxlevel});var d={};for(var p in o){d={};var h=1==parseInt(p)?0:1;d[o[h].type]=o[h].value;var u=(d=l.getAttrPrecentByGradeAndType(l.data.MorphologicalTag,d))[o[h].type];d[r[h].type]=r[h].value;var f=(d=l.getAttrPrecentByGradeAndType(l.data.MorphologicalTag,d))[r[h].type],g=T.default.getAttrName(o[h].type);c.push({type:o[h].type,name:g,val:u,val2:f})}for(var p in this.attrNode.children)c[p]?(this.attrNode.children[p].active=!0,""!=c[p].name?(this.attrNode.children[p].children[1].getComponent(cc.Label).string=c[p].name,this.attrNode.children[p].children[0].getComponent(cc.Sprite).spriteFrame=this.attrIcons.getSpriteFrame("attrIcon_"+T.default.getAttrIconID(c[p].type))):this.attrNode.children[p].children[0].getComponent(cc.Sprite).spriteFrame=this.attrIcons.getSpriteFrame("attrIcon_422"),this.attrNode.children[p].children[2].getComponent(cc.Label).string=c[p].val,this.attrNode.children[p].children[3].getComponent(cc.Label).string=c[p].val2):this.attrNode.children[p].active=!1},t.prototype.setEffectAttr=function(e){for(var t in this.effectAttrNode.children)if(e.effect[t]>=0){this.effectAttrNode.children[t].children[0].active=!1,this.effectAttrNode.children[t].children[1].active=!0;var i=s.default.instance.data.getEquipEffectAttrCfg(e.effect[t],e.stage),n=T.default.getAttrName(i.type),a=s.default.instance.data.getEquipEffectAttrCfg(e.effect[t],e.stage+1);a=a||i,this.effectAttrNode.children[t].children[1].children[0].getComponent(cc.Sprite).spriteFrame=this.attrIcons.getSpriteFrame("attrIcon_"+T.default.getAttrIconID(i.type)),this.effectAttrNode.children[t].children[1].children[1].getComponent(cc.Label).string=n,this.effectAttrNode.children[t].children[1].children[2].getComponent(cc.Label).string=o.default.getStr("{0}\u7ea7",e.stage+1),this.effectAttrNode.children[t].children[1].children[3].getComponent(cc.Label).string=o.default.getStr("{0}\u7ea7",e.stage+2>=this._maxStage?this._maxStage:e.stage+2)}else this.effectAttrNode.children[t].children[0].active=!0,this.effectAttrNode.children[t].children[1].active=!1},__decorate([w(cc.Node)],t.prototype,"effect",void 0),__decorate([w(cc.Toggle)],t.prototype,"toggle",void 0),__decorate([w(cc.Node)],t.prototype,"attrNode",void 0),__decorate([w(cc.Node)],t.prototype,"effectAttrNode",void 0),__decorate([w(cc.SpriteAtlas)],t.prototype,"attrIcons",void 0),t=__decorate([I],t)}(n.default);i.default=D,cc._RF.pop()},{"../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Core/SimpleActionEffect":"SimpleActionEffect","../../../Core/Widget":"Widget","../../../Util/AttrUtil":"AttrUtil","../../../Util/NumberUtil":"NumberUtil","../../../Util/RechargeConst":"RechargeConst","../../../Util/RechargeUtils":"RechargeUtils","../../Commons/RewardUtils":"RewardUtils","../../Item/ItemController":"ItemController","../../Item/ItemData":"ItemData","../../Item/ItemIcon":"ItemIcon","../../Role/RoleInfo":"RoleInfo","../../Sound/SoundController":"SoundController","../../Tips/OpTipsController":"OpTipsController","../../Tips/TipsWinController":"TipsWinController","../../WarTeam/MonsterController":"MonsterController","../EquipWin":"EquipWin","./EquipCtrl":"EquipCtrl"}],UseItemWin:[function(e,t,i){"use strict";cc._RF.push(t,"f286dXPCGlF85oeBeaNgY/x","UseItemWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=cc._decorator,a=o.ccclass,r=o.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.itemPrefab=null,t.content=null,t.nameLabe=null,t.num=null,t.maxNum=null,t.progressBar=null,t}var i;return __extends(t,e),i=t,t.prototype.show=function(){i.instance=this},t.prototype.hide=function(){},t.instance=null,__decorate([r(cc.Prefab)],t.prototype,"itemPrefab",void 0),__decorate([r(cc.Node)],t.prototype,"content",void 0),__decorate([r(cc.Label)],t.prototype,"nameLabe",void 0),__decorate([r(cc.Label)],t.prototype,"num",void 0),__decorate([r(cc.Label)],t.prototype,"maxNum",void 0),__decorate([r(cc.ProgressBar)],t.prototype,"progressBar",void 0),t=i=__decorate([a],t)}(n.default);i.default=s,cc._RF.pop()},{"../../Core/Widget":"Widget"}],UtilsFight:[function(e,t,i){"use strict";cc._RF.push(t,"5042fbeDzFJ468vGB/rIuVH","UtilsFight"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Global/GlobalValue"),o=e("../Module/Scene/Controller/CardEquipAddUtils"),a=e("../Module/WarTeam/CardUtils"),r=e("../Module/EquipCopy/EquipCopyUtils"),s=e("../Module/Ornament/OrnamentUtils"),l=e("../Module/Artifact/ArtifactUtils"),c=e("./Utils"),d=e("../Module/WarTeam/MonsterController"),p=e("../Module/Fight/FightUtils"),h=e("../Module/Status/StatusType"),u=e("../Module/TreasureMap/TreasureMapController"),f=function(){function e(){}return e.cptFight=function(e,t,i){return void 0===i&&(i=[]),0==e&&(e=3),c.default.cptFight(e,t,i)},e.addPropAttr=function(t,i){void 0===i&&(i=!1);var f={};if(c.default.accumulationAttrs(f,o.default.instance.setCardEquipAddProp(t)),c.default.accumulationAttrs(f,a.default.instance.setCardProp(t)),c.default.accumulationAttrs(f,s.default.instance.setOrnametProp(t)),c.default.accumulationAttrs(f,o.default.instance.setCardEquipEffectAddAttr(t)),i&&(c.default.accumulationAttrs(f,l.default.instance.setArtifactProp(t)),c.default.accumulationAttrs(f,p.FightUtils.setFightAttr(t.cardid,t.attr,!0))),t.selfMonster){var g={};for(var y in c.default.accumulationAttrs(g,d.default.instance.getAttrPrecentByGradeAndType(t.grade,t.attr.attr_)),g)t.attr.ChangeAtt(parseInt(y),g[y]);for(var y in e.countAdditionAttrsTwo(t.attr.attr_,f,t.CardType),f){var m=parseInt(y);m<=n.AttrType.WindDef&&m>=n.AttrType.MaxHp&&t.attr.Push(parseInt(y),f[y])}h.ActivityStatus.value==h.ActivityStatus.TreasureMap&&u.default.instance.setAttr(t)}var C=o.default.instance.setCardEquipEffectAddAttr(t,!1);for(var y in C)t.attr.Push(parseInt(y),Math.ceil(t.attr.GetAttrVale(parseInt(y))*(C[y]/1e4)));r.default.instance.setEquipCopyAddProp(t)},e.countAdditionAttrsTwo=function(e,t,i,o){void 0===i&&(i=3),void 0===o&&(o=0);for(var a=c.default.getAttrValue(n.AttrType.AllCardRate,t),r=c.default.getAttrValue(n.AttrType.ThunderRate+o,t),s=c.default.getAttrValue(n.AttrType.FAllCardRate+i-1,t),l=0;l<=n.AttrType.WindDef;l++){var d=c.default.getAttrValue(200+l,t)+c.default.getAttrValue(100*(i+2)+l,t)+a+r+s;e[l]=Math.ceil(e[l]+e[l]*(d/1e4))||0}},e.countAdditionAttrs=function(e,t,i){void 0===t&&(t=3),void 0===i&&(i=0);for(var o=c.default.getAttrValue(n.AttrType.AllCardRate,e),a=c.default.getAttrValue(n.AttrType.ThunderRate+i-1,e),r=c.default.getAttrValue(n.AttrType.FAllCardRate+t-1,e),s=0;s<=n.AttrType.WindDef;s++){var l=c.default.getAttrValue(200+s,e)+c.default.getAttrValue(100*(t+2)+s,e)+o+a+r;e[s]=Math.ceil(e[s]+e[s]*(l/1e4))||0}},e}();i.default=f,cc._RF.pop()},{"../Global/GlobalValue":"GlobalValue","../Module/Artifact/ArtifactUtils":"ArtifactUtils","../Module/EquipCopy/EquipCopyUtils":"EquipCopyUtils","../Module/Fight/FightUtils":"FightUtils","../Module/Ornament/OrnamentUtils":"OrnamentUtils","../Module/Scene/Controller/CardEquipAddUtils":"CardEquipAddUtils","../Module/Status/StatusType":"StatusType","../Module/TreasureMap/TreasureMapController":"TreasureMapController","../Module/WarTeam/CardUtils":"CardUtils","../Module/WarTeam/MonsterController":"MonsterController","./Utils":"Utils"}],UtilsFunClick:[function(e,t,i){"use strict";cc._RF.push(t,"c295cLCe4xLfJRb/jF7J9IS","UtilsFunClick"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/WindowType"),o=e("../../Util/ReportSdkUtils"),a=cc._decorator,r=a.ccclass,s=(a.property,function(){function e(){}var t;return t=e,Object.defineProperty(e,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),e.prototype.onClickWin=function(e){var t=null;switch(e){case n.WindowType.DrawCard:case n.WindowType.RechargeWin:case n.WindowType.DailyQusest:case n.WindowType.BaiBeiFanLi:case n.WindowType.OneSeckill:t="0#"+e;break;case n.WindowType.WelfareLobby:t="2#0";break;case n.WindowType.WelfareLobby_ZX:case n.WindowType.WelfareLobby_QD:case n.WindowType.WelfareLobby_DC:case n.WindowType.WelfareLobby_TZ:case n.WindowType.WelfareLobby_TQ:case n.WindowType.WelfareLobby_FL:case n.WindowType.WelfareLobby_LB:t="2#"+e;break;case n.WindowType.ActivityView:t="1#0";break;case n.WindowType.FristCharge:case n.WindowType.GroupPurchase:case n.WindowType.SevenDayLogin:case n.WindowType.ActiveBack:case n.WindowType.SevenDayGoal:case n.WindowType.SevenDayRanking:case n.WindowType.HalfPrice:t="1#"+e;break;case n.WindowType.LoopActivity:t="3#0";break;case n.WindowType.Loop_FristCharge:case n.WindowType.Loop_GroupPurchase:case n.WindowType.Loop_ActiveBack:case n.WindowType.Loop_HalfPrice:t="3#"+e}t&&""!=t&&(o.default.instance.loginPointOutActivity(t),console.log("ReportSdkUtils",t))},e=t=__decorate([r],e)}());i.default=s,cc._RF.pop()},{"../../Core/WindowType":"WindowType","../../Util/ReportSdkUtils":"ReportSdkUtils"}],Utils:[function(e,t,i){"use strict";cc._RF.push(t,"09a23D1Oa9EioihgPyrqhAO","Utils"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Core/CacheManager"),o=e("../Core/PrefabCache"),a=e("./GrayEffect"),r=e("../Module/Commons/Image"),s=e("../Global/GlobalValue"),l=e("../Core/ConfigsManager"),c=e("../Core/TimeController"),d=e("../Core/Language"),p=function(){function e(){}return e.RandomBy=function(e,t){var i=t-e+1;return Math.floor(Math.random()*i+e)},e.distance=function(e,t,i,n){var o=Math.abs(e-i),a=Math.abs(t-n);return Math.floor(Math.sqrt(o*o+a*a))},e.getDisMePos=function(e,t,i,n,o){var a=i-e,r=n-t,s=o/Math.sqrt((n-t)*(n-t)+(i-e)*(i-e));return new cc.Vec2(s*a+e,s*r+t)},e.getBezierCurvePaths=function(e,t,i,n,o){void 0===o&&(o=!1);var a,r=[];o&&(t.x=(t.x<<1)-(e.x+i.x>>1),t.y=(t.y<<1)-(e.y+i.y>>1));for(var s=0,l=0;l<=n;++l)s=l/n,(a=new cc.Vec2).x=(1-s)*(1-s)*e.x+2*s*(1-s)*t.x+s*s*i.x,a.y=(1-s)*(1-s)*e.y+2*s*(1-s)*t.y+s*s*i.y,r[l]=a;return r},e.getNodeByPool=function(t,i,n){var o;(void 0===n&&(n=null),this.PoolDic[t]&&this.PoolDic[t].length>0)?(o=this.PoolDic[t].shift(),this.PoolUrlDic[t]&&this.PoolUrlDic[t]>0&&this.PoolUrlDic[t].shift()):n&&""!=n&&i instanceof cc.Prefab?o=e.getNodeByUrl(i,n):i instanceof cc.Prefab?o=cc.instantiate(i):i instanceof cc.Node&&(o=cc.instantiate(i));return o.setPosition(0,0),o.opacity=255,o.scale=1,o.active=!0,o},e.setNodeToPool=function(e,t,i){void 0===i&&(i=null),t.removeFromParent(!1),t.active=!1,this.PoolDic[e]||(this.PoolDic[e]=[]),this.PoolDic[e].push(t),i&&""!=i&&(this.PoolUrlDic[e]||(this.PoolUrlDic[e]=[]),this.PoolUrlDic[e].push(i))},e.clearPool=function(){if(this.PoolDic){for(var e in this.PoolDic){if(o=this.PoolDic[e]){for(var t=0;t<o.length;t++){var i=o[t];i.parent&&i.removeFromParent(!0),i.destroy()}this.PoolDic[e].length=0,this.PoolDic[e]=null}}this.PoolDic=null,this.PoolDic={}}if(this.PoolUrlDic){for(var e in this.PoolUrlDic){var o=this.PoolUrlDic[e];for(t=0;t<o.length;t++)n.default.instance.clearUseRecord(o[t]);this.PoolUrlDic[e].length=0,this.PoolUrlDic[e]=null}this.PoolUrlDic=null,this.PoolUrlDic={}}},e.clearPoolToType=function(e){if(this.PoolDic&&((o=this.PoolDic[e])&&o.length>0)){for(var t=0;t<o.length;t++){var i=o[t];i.parent&&i.removeFromParent(!0),i.destroy()}this.PoolDic[e].length=0,this.PoolDic[e]=null}if(this.PoolDic&&this.PoolUrlDic[e]){var o=this.PoolUrlDic[e];for(t=0;t<o.length;t++)n.default.instance.clearUseRecord(o[t]);this.PoolUrlDic[e].length=0,this.PoolUrlDic[e]=null}},Object.defineProperty(e,"isHightVersion",{get:function(){if(null==e._isHightVersion){e._isHightVersion=0;var t=cc.ENGINE_VERSION.split(".");t&&t.length>1&&(e._isHightVersion=Number(t[1])),console.log("\u68c0\u67e5\u5f15\u64ce\u7248\u672c\u662f\u5426\u662f\u9ad8\u7248\u672c:"+e._isHightVersion)}return e._isHightVersion},enumerable:!0,configurable:!0}),e.setNodeActive=function(e,t){if(e)for(var i=0,n=e;i<n.length;i++){(r=n[i])&&(r.active=!1)}if(t)for(var o=0,a=t;o<a.length;o++){var r;(r=a[o])&&(r.active=!0)}},e.setNodeOpacity=function(e,t){void 0===t&&(t=.01),e&&(e.opacity=1,e.runAction(cc.fadeTo(t,255)))},e.checkInList=function(e,t){for(var i=0;i<t.length;i++)if(e==t[i])return!0;return!1},e.removeInList=function(e,t){for(var i=t.concat(),n=0;n<i.length;n++)if(e==i[n]){i.splice(n,1);break}return i},e.getNodeByUrl=function(e,t){var i=cc.instantiate(e);return n.default.instance.setUseRecord(t),i.addComponent(o.default),i.getComponent(o.default).init(t),i},e.setNodeChildDestoryByUrl=function(e,t,i){if(void 0===t&&(t=null),void 0===i&&(i=null),e){var a=[];e.getComponent(o.default)&&e.getComponent(o.default).dispose();for(var r=0;r<e.childrenCount;r++)e.children[r].getComponent(o.default)&&e.children[r].getComponent(o.default).dispose(),i&&n.default.instance.clearUseRecord(i),a.push(e.children[r]);e.removeAllChildren();for(r=0;r<a.length;r++)a[r]&&a[r].destroy()}},e.setNodeChildDestroy=function(e){if(e){for(var t=[],i=0;i<e.childrenCount;i++)t.push(e.children[i]);e.removeAllChildren();for(i=0;i<t.length;i++)t[i]&&t[i].destroy()}},e.setNodeDestoryByUrl=function(e,t){if(e){var i=e;e.getComponent(o.default)&&e.getComponent(o.default).dispose(),e.parent&&e.isValid&&e.removeFromParent(),i.destroy()}},e.setGrayEffect=function(e,t,i){void 0===i&&(i=!1);(e.getComponent(a.default)?e.getComponent(a.default):e.addComponent(a.default)).setGray(!t,i)},e.setImage=function(e,t,i){void 0===i&&(i=null),e.getComponent(r.default)||e.addComponent(r.default),i&&""!=i?e.getComponent(r.default).loadSpriteAtlas(t,i):e.getComponent(r.default).updateBg(t)},e.deepCopy=function(e,t){for(var i in t)"object"==typeof t[i]?(e[i]=t[i].constructor===Array?[]:{},this.deepCopy(e[i],t[i])):e[i]=t[i];return e},e.MapAttrToAttrList=function(e){var t=[];for(var i in e)t[parseInt(i)]=e[i];return t},e.AttrListToMapAttr=function(e){var t={};for(var i in e)e[i]&&(t[i]=e[i]);return t},e.accumulationAttrs=function(e,t){if(-1!==Object.prototype.toString.call(t).indexOf("Array"))for(var i=0;i<t.length;i++)e[i]?e[i]+=t[i]:e[i]=t[i];else for(var n in t)e[n]?e[n]+=t[n]:e[n]=t[n]},e.getVal=function(e,t){return e&&e[t]?e[t]:0},e.getGemVal=function(e,t,i){void 0===i&&(i=!1);return s.AttrType.HpRate<=e&&e<=s.AttrType.DefCriRate?"+"+t/100+"%":(i?"+":"")+t},e.setAttrMap=function(e,t,i){e[t]?e[t]+=i:e[t]=i},e.cptFight=function(e,t,i){void 0===i&&(i=[]);var n=0;0==e&&(n=1,e=3);for(var o=0,a=0,r=0,l=0,c=i;l<c.length;l++){var d=c[l],p=d.skillid.toString(),h=parseInt(p.charAt(p.length-1));n?9999!=d.skillid&&(r+=d.skilllv):h>=5&&h<=7&&(r+=d.skilllv)}for(var u=this.getAttrValue(s.AttrType.Attack,t),f=this.getAttrValue(s.AttrType.Defence,t),g=this.getAttrValue(s.AttrType.MaxHp,t),y=s.AttrType.ThunderAttack;y<=s.AttrType.WindDef;y++)y%2==0?a+=Math.min(Math.pow(this.getAttrValue(y,t),2)/f,f)||0:o+=Math.min(Math.pow(this.getAttrValue(y,t),2)/u,u)||0;var m=u?u+o:0,C=f?f+a:0;m=m*this.REFERATTR[e-1][s.AttrType.Attack]*(1+(this.getAttrValue(s.AttrType.Hit,t)+this.getAttrValue(s.AttrType.Critical,t))/1e4),C=C*this.REFERATTR[e-1][s.AttrType.Defence]*(1+this.getAttrValue(s.AttrType.DefCri,t)/1e4);var v=g*this.REFERATTR[e-1][s.AttrType.MaxHp],_=Math.pow(m+C+v,1.35)*(12+Math.pow(r/3,.2)),b=25*r,T=1+this.getAttrValue(s.AttrType.Dodge,t)/1e4;return Math.ceil((_+b)*T)},e.getAttrValue=function(e,t){return t[e]||0},e.getCardBaseAttr=function(e,t){var i=[],n=l.ConfigsManager.instance.getConfigs("cardstageConf"),o=l.ConfigsManager.instance.getConfigs("cardConf").Card[e].cardType;i=n.stage[e][0].prop.concat();for(var a=0;a<i.length;a++){var r=1,s=t>0?t-1:0,c=n.cardAttr[o][s].base;c&&(r=n.base[c][a].param),i[a]=Math.ceil(i[a]*r/1e4)}return i},e.getWeekStr=function(e){var t,i=["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"];for(var n in e)t=t?t+","+i[e[n]]:i[e[n]];return t},e.isDoubleTime=function(e){var t=c.default.instance.ServerTimeMins;return-1==e.indexOf(new Date(t).getDay())?d.default.getStr("4508",this.getWeekStr(e)):d.default.getStr("4509")},e.getAttrValStr=function(e,t){var i="";return e>=s.AttrType.MaxHp&&e<=s.AttrType.WindDef||e>=s.AttrType.RetainStep&&e<=s.AttrType.SkillThree||e==s.AttrType.ExtraHurt||e>=s.AttrType.ThuHp&&e<=s.AttrType.WinDefCri?i+=t:i+=t/100+"%",i},e.getQualityName=function(e){var t=null;switch(e){case s.RefiningQuality.TYPE1:t=d.default.getStr("\u666e\u901a");break;case s.RefiningQuality.TYPE2:t=d.default.getStr("\u4f18\u826f");break;case s.RefiningQuality.TYPE3:t=d.default.getStr("\u7cbe\u826f");break;case s.RefiningQuality.TYPE4:t=d.default.getStr("\u5b8c\u7f8e");break;case s.RefiningQuality.TYPE5:t=d.default.getStr("\u81f3\u5c0a")}return t},e.getWinowTypeByJumpType=function(e){return l.ConfigsManager.instance.getConfigs("Itemconf").RoadInfo[e].windType},e.PoolDic={},e.PoolUrlDic={},e._isHightVersion=null,e.REFERATTR=[[.009,.11,.1],[.01,.1,.15],[.011,.09,.17]],e}();i.default=p,cc._RF.pop()},{"../Core/CacheManager":"CacheManager","../Core/ConfigsManager":"ConfigsManager","../Core/Language":"Language","../Core/PrefabCache":"PrefabCache","../Core/TimeController":"TimeController","../Global/GlobalValue":"GlobalValue","../Module/Commons/Image":"Image","./GrayEffect":"GrayEffect"}],VariousAnim:[function(e,t,i){"use strict";cc._RF.push(t,"ea5baSVJodFYqWr3rDRrQmH","VariousAnim"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../GlobalContext"),a=e("../../../Core/GameEventDispatcher"),r=cc._decorator,s=r.ccclass,l=r.property,c=function(e){function t(){var t=e.call(this)||this;return t.TopLayerNode=null,t.PlayerWealth=null,t.BottomNode=null,t.TopActivityNode=null,t.TaskTips=null,t.LeftNode=null,t.chat=null,t.layerArtifact=null,t.Info=null,t.MonsterPreview=null,t.GameLayer=null,t.GameLayerBG=null,t.InfoList=null,t.BackBtn=null,t.ChapterDown=null,t.NewMain=null,t.systemOpenNode=null,t.bool=null,t.flag=!1,t.ismove=!1,t.isInChapter=!1,t.oldStatus=null,t.posArr=[],i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.show=function(){e.prototype.show.call(this),this.initInfo(),a.GameEventDispatcher.instance.on("CLOSEENTRANCE",this.dailyRecharge,this),a.GameEventDispatcher.instance.on("MOVEENTRANCE",this.moveRechagge,this)},t.prototype.hide=function(){e.prototype.hide.call(this),a.GameEventDispatcher.instance.off("CLOSEENTRANCE",this.dailyRecharge,this),a.GameEventDispatcher.instance.off("MOVEENTRANCE",this.moveRechagge,this)},t.prototype.initInfo=function(e){void 0===e&&(e=!1),this.isInChapter||(this.TopLayerNode.active=!0,this.BottomNode.active=!0,this.TopActivityNode.active=!0,this.LeftNode.active=!0,this.Info.active=!0,this.TaskTips.active=!0,this.GameLayerBG.active=!0),this.PlayerWealth.active=!0,this.chat.active=!0,this.resetAllPosition(e)},t.prototype.clearAllActions=function(){this.node.stopAllActions(),this.TopLayerNode.stopAllActions(),this.PlayerWealth.stopAllActions(),this.TopActivityNode.stopAllActions(),this.BottomNode.stopAllActions(),this.LeftNode.stopAllActions(),this.Info.stopAllActions(),this.chat.stopAllActions(),this.TaskTips.stopAllActions(),this.layerArtifact.stopAllActions()},t.prototype.resetAllPosition=function(e){void 0===e&&(e=!1),this.clearAllActions(),this.posArr.length>0?(this.Info.setPosition(this.posArr[0]),this.TopActivityNode.setPosition(this.posArr[2]),this.TopLayerNode.setPosition(this.posArr[3]),this.BottomNode.setPosition(this.posArr[4]),this.LeftNode.setPosition(this.posArr[5]),this.TaskTips.setPosition(this.posArr[6]),this.PlayerWealth.setPosition(this.posArr[7]),this.layerArtifact.setPosition(this.posArr[8]),e||this.chat.setPosition(this.posArr[1])):(this.TopLayerNode.y=o.GlobalContext.UIHeight/2-this.TopLayerNode.height/2,this.PlayerWealth.y=o.GlobalContext.UIHeight/2-this.PlayerWealth.height/2-12,this.BottomNode.y=-o.GlobalContext.UIHeight/2+this.BottomNode.height/2,this.LeftNode.x=-o.GlobalContext.UIWidth/2+this.LeftNode.width/2+25+o.PlayerData.SceneBorld,this.TaskTips.x=-o.GlobalContext.UIWidth/2+this.TaskTips.width/2+5+o.PlayerData.SceneBorld,this.TopActivityNode.x=-o.GlobalContext.UIWidth/2+25+o.PlayerData.SceneBorld,this.Info.setPosition(0,0),this.chat.x=-o.GlobalContext.UIWidth/2+this.chat.width/2+5+o.PlayerData.SceneBorld,this.BackBtn.y=o.GlobalContext.UIHeight/2-this.BackBtn.height/2),this.ismove=!1},t.prototype.onGetInitPos=function(){this.posArr.length<=0&&(this.posArr[0]=new cc.Vec2(0,0),this.posArr[1]=new cc.Vec2(-o.GlobalContext.UIWidth/2+this.chat.width/2+5+o.PlayerData.SceneBorld,this.chat.y),this.posArr[2]=new cc.Vec2(-o.GlobalContext.UIWidth/2+25+o.PlayerData.SceneBorld,this.TopActivityNode.y),this.posArr[3]=new cc.Vec2(this.TopLayerNode.x,o.GlobalContext.UIHeight/2-this.TopLayerNode.height/2),this.posArr[4]=new cc.Vec2(this.BottomNode.x,-o.GlobalContext.UIHeight/2+this.BottomNode.height/2),this.posArr[5]=new cc.Vec2(-o.GlobalContext.UIWidth/2+this.LeftNode.width/2+5+o.PlayerData.SceneBorld,this.LeftNode.y),this.posArr[6]=new cc.Vec2(-o.GlobalContext.UIWidth/2+this.TaskTips.width/2+5+o.PlayerData.SceneBorld,this.TaskTips.y),this.posArr[7]=new cc.Vec2(this.PlayerWealth.x,o.GlobalContext.UIHeight/2-this.PlayerWealth.height/2-12),this.posArr[8]=new cc.Vec2(this.layerArtifact.x,this.layerArtifact.y))},t.prototype.openOneAnim=function(e,t){var i=this;if(void 0===e&&(e=null),void 0===t&&(t=null),!this.ismove){this.ismove=!0,this.clearAllActions(),this.onGetInitPos();var n=e,o=t;this.node.runAction(cc.sequence(cc.spawn(cc.callFunc(function(){i.TopLayerNode.runAction(cc.sequence(cc.moveBy(.4,0,i.TopLayerNode.height+25),cc.callFunc(function(){i.TopLayerNode.active=!1})))}),cc.callFunc(function(){i.PlayerWealth.runAction(cc.sequence(cc.moveBy(.4,0,i.PlayerWealth.height+25),cc.callFunc(function(){i.PlayerWealth.active=!1})))}),cc.callFunc(function(){i.TopActivityNode.runAction(cc.sequence(cc.moveBy(.4,-i.TopActivityNode.height-25,0),cc.callFunc(function(){i.TopActivityNode.active=!1})))}),cc.callFunc(function(){i.BottomNode.runAction(cc.sequence(cc.moveBy(.4,0,-i.BottomNode.height),cc.callFunc(function(){i.BottomNode.active=!1})))}),cc.callFunc(function(){i.LeftNode.runAction(cc.sequence(cc.moveBy(.4,-i.LeftNode.width-25,0),cc.callFunc(function(){i.LeftNode.active=!1})))}),cc.callFunc(function(){i.TaskTips.runAction(cc.sequence(cc.moveBy(.4,-i.TaskTips.width-25,0),cc.callFunc(function(){i.TaskTips.active=!1})))}),cc.callFunc(function(){i.chat.runAction(cc.sequence(cc.moveBy(.4,-i.chat.width-25,0),cc.callFunc(function(){i.chat.active=!1})))})),cc.delayTime(.5),cc.callFunc(function(){i.resetAllPosition(),n&&n.apply(o)})))}},t.prototype.openTwoAnim=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this.ismove=!0,this.clearAllActions(),this.onGetInitPos();var i=e,n=t;this.Info.runAction(cc.sequence(cc.moveBy(.5,-o.GlobalContext.UIWidth,0),cc.callFunc(function(){i&&i.apply(n)}))),this.layerArtifact.runAction(cc.moveBy(.5,-o.GlobalContext.UIWidth,0)),1==this.bool&&this.moveRechagge()},t.prototype.openThreeAnim=function(){var e=this;this.ismove=!0,this.clearAllActions(),this.onGetInitPos(),this.TopLayerNode.active=!1,this.PlayerWealth.active=!1,this.BottomNode.active=!1,this.LeftNode.active=!1,this.TopActivityNode.active=!0,this.chat.active=!0,this.chat.y=-o.GlobalContext.UIHeight/2-this.chat.height/2,this.MonsterPreview.active=!1,this.Info.runAction(cc.moveTo(1,this.posArr[0])),this.chat.runAction(cc.sequence(cc.moveTo(1,this.posArr[1]),cc.callFunc(function(){e.MonsterPreview.active=!0,e.openScene()}))),this.TopActivityNode.runAction(cc.moveTo(1,this.posArr[2]))},t.prototype.openFourAnim=function(){var e=this;this.ismove=!0,this.clearAllActions(),this.onGetInitPos(),this.chat.active=!1,this.BackBtn.active=!1,this.TopLayerNode.active=!1,this.ChapterDown.active=!1,this.scheduleOnce(function(){e.BackBtn.active=!0,e.TopLayerNode.active=!0,e.ChapterDown.active=!0,e.BackBtn.stopAllActions(),e.BackBtn.y=o.GlobalContext.UIHeight/2+e.BackBtn.height/2,e.TopLayerNode.y=o.GlobalContext.UIHeight/2+e.TopLayerNode.height/2,e.TopLayerNode.runAction(cc.sequence(cc.moveTo(.4,e.TopLayerNode.x,o.GlobalContext.UIHeight/2-e.TopLayerNode.height/2-12),cc.callFunc(function(){e.BackBtn.stopAllActions(),e.resetAllPosition()},e))),e.BackBtn.runAction(cc.moveTo(.4,e.BackBtn.x,o.GlobalContext.UIHeight/2-e.BackBtn.height/2))},1)},t.prototype.onOpenFiveAnim=function(){this.clearAllActions(),this.onGetInitPos(),this.NewMain.active=!1,this.PlayerWealth.active=!0,this.TopLayerNode.active=!1,this.GameLayerBG.active=!1,this.Info.active=!1,this.TaskTips.active=!1,this.InfoList.active=!1,this.isInChapter=!0,this.chat.runAction(cc.moveTo(.4,this.posArr[1].x,this.posArr[1].y-80)),this.layerArtifact.runAction(cc.moveTo(.4,this.posArr[8].x,this.posArr[8].y-80))},t.prototype.openScene=function(){var e=this;this.ismove=!1,this.isInChapter=!1,this.clearAllActions(),this.onGetInitPos(),this.NewMain.active=!0,this.GameLayerBG.active=!0,this.TopLayerNode.active=!0,this.BottomNode.active=!0,this.TopActivityNode.active=!0,this.LeftNode.active=!0,this.chat.active=!0,this.TaskTips.active=!0,this.PlayerWealth.active=!0,this.InfoList.active=!0,this.Info.active=!0,this.TopLayerNode.runAction(cc.sequence(cc.moveTo(.4,this.posArr[3]),cc.callFunc(function(){e.resetAllPosition()},this))),this.BottomNode.runAction(cc.moveBy(.4,this.posArr[4])),this.TopActivityNode.runAction(cc.moveTo(.4,this.posArr[2])),this.LeftNode.runAction(cc.moveTo(.4,this.posArr[5])),this.Info.runAction(cc.moveTo(.4,this.posArr[0])),this.chat.runAction(cc.moveTo(.4,this.posArr[1])),this.TaskTips.runAction(cc.moveTo(.4,this.posArr[6])),this.PlayerWealth.runAction(cc.moveTo(.4,this.posArr[7])),this.layerArtifact.runAction(cc.moveTo(.4,this.posArr[8]))},t.prototype.dailyRecharge=function(){},t.prototype.moveRechagge=function(){},t.instance=null,__decorate([l(cc.Node)],t.prototype,"TopLayerNode",void 0),__decorate([l(cc.Node)],t.prototype,"PlayerWealth",void 0),__decorate([l(cc.Node)],t.prototype,"BottomNode",void 0),__decorate([l(cc.Node)],t.prototype,"TopActivityNode",void 0),__decorate([l(cc.Node)],t.prototype,"TaskTips",void 0),__decorate([l(cc.Node)],t.prototype,"LeftNode",void 0),__decorate([l(cc.Node)],t.prototype,"chat",void 0),__decorate([l(cc.Node)],t.prototype,"layerArtifact",void 0),__decorate([l(cc.Node)],t.prototype,"Info",void 0),__decorate([l(cc.Node)],t.prototype,"MonsterPreview",void 0),__decorate([l(cc.Node)],t.prototype,"GameLayer",void 0),__decorate([l(cc.Node)],t.prototype,"GameLayerBG",void 0),__decorate([l(cc.Node)],t.prototype,"InfoList",void 0),__decorate([l(cc.Node)],t.prototype,"BackBtn",void 0),__decorate([l(cc.Node)],t.prototype,"ChapterDown",void 0),__decorate([l(cc.Node)],t.prototype,"NewMain",void 0),__decorate([l(cc.Node)],t.prototype,"systemOpenNode",void 0),t=i=__decorate([s],t)}(n.default);i.default=c,cc._RF.pop()},{"../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Widget":"Widget","../../../GlobalContext":"GlobalContext"}],VipAddCount:[function(e,t,i){"use strict";cc._RF.push(t,"e2b04uafsBACJ6as38pXil9","VipAddCount"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Commons/CommonPageBG"),o=e("../../Core/Language"),a=e("../../Core/WindowType"),r=e("../Role/RoleInfo"),s=e("../Vip/VipCtrl"),l=e("../../Util/Utils"),c=e("../Item/ItemIcon"),d=e("../OpenWin/OpenWinController"),p=e("../Shop/ShopController"),h=e("../Shop/ShopConst"),u=e("../Shop/Shop"),f=e("../../Global/GlobalValue"),g=e("../../Core/LoadManager"),y=e("../../GlobalContext"),m=e("../../Util/CommonUtil"),C=cc._decorator,v=C.ccclass,_=C.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.richTextDesc=null,t.labelVipLv=null,t.scrollView=null,t.layerContent=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.onInit(741,466,o.default.getStr("common_page_title"),!0)},t.prototype.show=function(){e.prototype.show.call(this),this.onShowPage(r.MyRoleInfo.vipLevel+1)},t.prototype.onShowPage=function(e){var t=this,i=s.default.instance.data.getRewardList(e);e>=f.MaxVipLev?this.richTextDesc.string=o.default.getStr("2019"):this.richTextDesc.string=o.default.getStr("2018",m.CommonUtil.getNextTimes(s.default.instance.type)[0],m.CommonUtil.getBadTimes(s.default.instance.type)),this.labelVipLv.string=e+"",this.onClear(),g.default.instance.loadResByType(y.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(e){if(i&&i.length>0){for(var n=0;n<i.length;n++){var o=l.default.getNodeByPool(a.PoolType.ItemIcon,e,y.GlobalContext.Root+"prefab/Bag/ItemIcon");t.layerContent.addChild(o),o.getComponent(c.default).ItemData(i[n],!0)}t.scrollView.scrollToLeft()}},this)},t.prototype.onClear=function(){for(var e=this.layerContent.childrenCount-1;e>=0;e--)l.default.setNodeToPool(a.PoolType.ItemIcon,this.layerContent.children[e]);this.layerContent.removeAllChildren()},t.prototype.onClickCancle=function(){this.onClose()},t.prototype.onClickConfirm=function(){this.onClose(),d.default.instance.openWindow(a.WindowType.Shop,function(){var e=p.default.instance.nowSortIndex[h.ShopConst.Recharge];u.default.instance.TabBtnList2.selectItem(e)},this)},__decorate([_(cc.RichText)],t.prototype,"richTextDesc",void 0),__decorate([_(cc.Label)],t.prototype,"labelVipLv",void 0),__decorate([_(cc.ScrollView)],t.prototype,"scrollView",void 0),__decorate([_(cc.Node)],t.prototype,"layerContent",void 0),t=__decorate([v],t)}(n.default);i.default=b,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/CommonUtil":"CommonUtil","../../Util/Utils":"Utils","../Commons/CommonPageBG":"CommonPageBG","../Item/ItemIcon":"ItemIcon","../OpenWin/OpenWinController":"OpenWinController","../Role/RoleInfo":"RoleInfo","../Shop/Shop":"Shop","../Shop/ShopConst":"ShopConst","../Shop/ShopController":"ShopController","../Vip/VipCtrl":"VipCtrl"}],VipBenefitCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"ffb242MFNZC9puqCSJjwH41","VipBenefitCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Controller"),o=e("./VipBenefitData"),a=e("../../../NetConnect/NetConnet"),r=e("../../../Core/GameEventDispatcher"),s=e("../../../Core/Event"),l=e("../welfarelobbyUtils"),c=e("../welfarelobby"),d=e("../../../Global/GlobalValue"),p=cc._decorator,h=p.ccclass,u=(p.property,function(e){function t(){var t=e.call(this)||this;return t._data=null,t._flag=!1,i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.listNotification=function(){this.addProto(s.EventDefiner.vipbenefitsflag,this.resVipbenefitsflag,this),r.GameEventDispatcher.instance.on(s.EventDefiner.Vip_info_up,this.updateRed,this)},Object.defineProperty(t.prototype,"data",{get:function(){return this._data||(this._data=new o.default),this._data},enumerable:!0,configurable:!0}),t.prototype.resVipbenefitsflag=function(e){this.data.setData(e.flag),r.GameEventDispatcher.instance.emit(s.EventDefiner.vipbenefitsUp),this.updateRed()},t.prototype.reqGetVipbenefits=function(e){var t={cmd:"getvipbenefits",benefitslv:e};a.default.instance.sendProto(t)},t.prototype.updateRed=function(){var e=this.data.getRedPoint();l.welfarelobbyUtils.isOpenWindow()&&this._flag!=e&&c.default.instance.IsRead(d.WelfareType.VipBenefit,e),this._flag!=e&&(this._flag=e,l.welfarelobbyUtils.setRed())},t.instance=null,t=i=__decorate([h],t)}(n.default));i.default=u,cc._RF.pop()},{"../../../Core/Controller":"Controller","../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Global/GlobalValue":"GlobalValue","../../../NetConnect/NetConnet":"NetConnet","../welfarelobby":"welfarelobby","../welfarelobbyUtils":"welfarelobbyUtils","./VipBenefitData":"VipBenefitData"}],VipBenefitData:[function(e,t,i){"use strict";cc._RF.push(t,"fce54UiLg5G5YzBxNfRudpG","VipBenefitData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/ConfigsManager"),o=e("../../Vip/VipCtrl"),a=e("../../Role/RoleInfo"),r=function(){function e(){this._flag=[],this._cfg=null,this._cfg=n.ConfigsManager.instance.getConfigs("vipbenefitsConf")}return Object.defineProperty(e.prototype,"cfg",{get:function(){return this._cfg},enumerable:!0,configurable:!0}),e.prototype.setData=function(e){this._flag=e},Object.defineProperty(e.prototype,"CfgData",{get:function(){var e=[],t=[],i=[];for(var n in this._cfg.viplv){var r=o.default.instance.data.getVipCfg(parseInt(n)),s=0;if(r.needExp){var l=r.needExp-a.MyRoleInfo.vipExp;s=Math.ceil(l/r.addExp)}this.getFlag(parseInt(n))?i.push({vipLev:parseInt(n),data:this._cfg.viplv[n]}):s>0?t.push({vipLev:parseInt(n),data:this._cfg.viplv[n]}):e.push({vipLev:parseInt(n),data:this._cfg.viplv[n]})}return e.concat(t,i)},enumerable:!0,configurable:!0}),e.prototype.getFlag=function(e){return!!this._flag[e]&&1!=this._flag[e]},e.prototype.getRedPoint=function(){var e=!1;for(var t in this._cfg.viplv){var i=o.default.instance.data.getVipCfg(parseInt(t)-1),n=0;if(i&&i.needExp){var r=i.needExp-a.MyRoleInfo.vipExp;n=Math.ceil(r/i.addExp)}n=n<=0?0:n;var s=this.getFlag(parseInt(t));if(n<=0&&!s){e=!0;break}}return e},e}();i.default=r,cc._RF.pop()},{"../../../Core/ConfigsManager":"ConfigsManager","../../Role/RoleInfo":"RoleInfo","../../Vip/VipCtrl":"VipCtrl"}],VipBenefitItem:[function(e,t,i){"use strict";cc._RF.push(t,"c568d85LaxM0LQPeYA66/2C","VipBenefitItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../Role/RoleInfo"),a=e("../../../Core/Language"),r=e("../../../Core/WindowType"),s=e("../../../Util/Utils"),l=e("../../Vip/VipCtrl"),c=e("../../Item/ItemIcon"),d=e("../../Item/ItemData"),p=e("../../Commons/RewardUtils"),h=e("./VipBenefitCtrl"),u=e("../../OpenWin/OpenWinController"),f=e("../../Shop/ShopController"),g=e("../../Shop/ShopConst"),y=e("../../Shop/Shop"),m=e("../../../Core/LoadManager"),C=e("../../../GlobalContext"),v=cc._decorator,_=v.ccclass,b=(v.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._lev=null,t._data=null,t._flag=-1,t}return __extends(t,e),t.prototype.setData=function(e){this._lev=e.vipLev,this._data=e.data,this.setShowData()},t.prototype.setShowData=function(){var e=this,t=l.default.instance.data.getVipCfg(this._lev-1),i=0;if(t&&t.needExp){var n=t.needExp-o.MyRoleInfo.vipExp;i=Math.ceil(n/t.addExp)}i=i<=0?0:i,this.node.getChildByName("levNode").getChildByName("vipLev").getComponent(cc.Label).string=this._lev+"",this.node.getChildByName("numNode").getChildByName("Label").getComponent(cc.Label).string=a.default.getStr("(\u518d\u5145\u503c{0}",i);var r=this.node.getChildByName("itemList");m.default.instance.loadResByType(C.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(t){for(var n in s.default.setNodeChildDestoryByUrl(r,C.GlobalContext.Root+"prefab/Bag/ItemIcon"),e._data){var o=s.default.getNodeByUrl(t,C.GlobalContext.Root+"prefab/Bag/ItemIcon");o.scale=.8*o.scale;var l=p.default.instance.getItemId(e._data[n].type,e._data[n].id,e._data[n].count);o.getComponent(c.default).ItemData(d.default.creatItem(l[0],l[1]),!0,null,!0),r.addChild(o)}var u=e.node.getChildByName("btn"),f=h.default.instance.data.getFlag(e._lev),g=null;i<=0?(e._flag=f?1:0,g=e._flag>0?a.default.getStr("\u5df2\u9886\u53d6"):a.default.getStr("\u9886 \u53d6")):(e._flag=-1,g=a.default.getStr("\u5145 \u503c")),u.getComponent(cc.Button).interactable=!f,e.node.getChildByName("numNode").active=e._flag<0,u.getChildByName("Label").getComponent(cc.Label).string=g},this)},t.prototype.onClickBtn=function(){switch(this._flag){case-1:u.default.instance.openWindow(r.WindowType.Shop,function(){var e=f.default.instance.nowSortIndex[g.ShopConst.Recharge];y.default.instance.TabBtnList2.selectItem(e)},this);break;case 0:h.default.instance.reqGetVipbenefits(this._lev)}},t=__decorate([_],t)}(n.default));i.default=b,cc._RF.pop()},{"../../../Core/Language":"Language","../../../Core/LoadManager":"LoadManager","../../../Core/Widget":"Widget","../../../Core/WindowType":"WindowType","../../../GlobalContext":"GlobalContext","../../../Util/Utils":"Utils","../../Commons/RewardUtils":"RewardUtils","../../Item/ItemData":"ItemData","../../Item/ItemIcon":"ItemIcon","../../OpenWin/OpenWinController":"OpenWinController","../../Role/RoleInfo":"RoleInfo","../../Shop/Shop":"Shop","../../Shop/ShopConst":"ShopConst","../../Shop/ShopController":"ShopController","../../Vip/VipCtrl":"VipCtrl","./VipBenefitCtrl":"VipBenefitCtrl"}],VipBenefitView:[function(e,t,i){"use strict";cc._RF.push(t,"13c08JePiBI5IhRU3NMiY2s","VipBenefitView"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../Vip/VipCtrl"),a=e("./VipBenefitCtrl"),r=e("../../../Core/Event"),s=e("../../../Core/GameEventDispatcher"),l=e("../../Commons/ListViewCtrl"),c=e("./VipBenefitItem"),d=cc._decorator,p=d.ccclass,h=d.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lsit=null,t.lsitViewCtrl=null,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.show=function(){e.prototype.show.call(this),o.default.instance.reqVipInfo(),this.setShowData(),s.GameEventDispatcher.instance.on(r.EventDefiner.Vip_info_up,this.setShowData,this),s.GameEventDispatcher.instance.on(r.EventDefiner.vipbenefitsUp,this.setShowData,this)},t.prototype.hide=function(){s.GameEventDispatcher.instance.off(r.EventDefiner.Vip_info_up,this.setShowData,this),s.GameEventDispatcher.instance.off(r.EventDefiner.vipbenefitsUp,this.setShowData,this),e.prototype.hide.call(this)},t.prototype.setShowData=function(){var e=a.default.instance.data.CfgData;!e||e.length<=0||this.setData(e)},t.prototype.setData=function(e){this.lsitViewCtrl.refreshItem=this.updateitem,this.lsitViewCtrl.refreshItemThis=this,this.lsitViewCtrl.initialize(e),this.lsitViewCtrl.scrollToTop()},t.prototype.updateitem=function(e,t){var i=this.lsitViewCtrl.dataLsit[t];e.getComponent(c.default).setData(i)},__decorate([h(cc.ScrollView)],t.prototype,"lsit",void 0),__decorate([h(l.default)],t.prototype,"lsitViewCtrl",void 0),t=__decorate([p],t)}(n.default);i.default=u,cc._RF.pop()},{"../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Widget":"Widget","../../Commons/ListViewCtrl":"ListViewCtrl","../../Vip/VipCtrl":"VipCtrl","./VipBenefitCtrl":"VipBenefitCtrl","./VipBenefitItem":"VipBenefitItem"}],VipCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"57c33YezX1C5qQx5ZbtBmdy","VipCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Controller"),o=e("./VipData"),a=e("../../NetConnect/NetConnet"),r=e("../../Core/Event"),s=e("../../Core/GameEventDispatcher"),l=e("../Commons/RewardUtils"),c=e("../OpenWin/OpenWinController"),d=e("../../Core/WindowType"),p=e("../Tips/RewardTips"),h=e("../Role/RoleInfo"),u=e("./VipUPTips"),f=cc._decorator,g=f.ccclass,y=(f.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.data=null,t._vipUPFlag=null,t}var i;return __extends(t,e),i=t,t.prototype.listNotification=function(){i.instance=this,this.data=new o.default,this.addProto(r.EventDefiner.Vip_info,this.resVipInfo,this),this.addProto(r.EventDefiner.vip_level,this.resVipLevel,this),this.addProto("vipbuyreward",this.onBuyReward,this),this.addProto(r.EventDefiner.vipbenefitsflag,this.resVipbenefitsflag,this)},t.prototype.resVipInfo=function(e){this.data.setData(e),s.GameEventDispatcher.instance.emit(r.EventDefiner.Vip_info_up)},t.prototype.resVipLevel=function(e){this._vipUPFlag=!0,s.GameEventDispatcher.instance.emit(r.EventDefiner.vip_level_up)},t.prototype.onBuyReward=function(e){var t=l.default.instance.getItemListByServerData(e.reward);c.default.instance.openWindow(d.WindowType.RewardTips,function(){p.default.instance.setData(t)},this)},t.prototype.reqVipInfo=function(){a.default.instance.sendProto({cmd:"vipinfo"})},t.prototype.reqVipBuyGiftPack=function(e){var t={cmd:"vipbuygiftpack",viplv:e};a.default.instance.sendProto(t)},t.prototype.resVipbenefitsflag=function(e){this.data.setVipbenefitsFlag(e.flag),s.GameEventDispatcher.instance.emit(r.EventDefiner.vipbenefitsUp)},t.prototype.reqGetVipbenefits=function(e){var t={cmd:"getvipbenefits",benefitslv:e};a.default.instance.sendProto(t)},t.prototype.openVipUPtips=function(){this._vipUPFlag&&(this._vipUPFlag=!1,c.default.instance.openWindow(d.WindowType.VIPUPTips,function(e){e.getComponent(u.default).setData(h.MyRoleInfo.vipLevel)},this))},t.instance=null,t=i=__decorate([g],t)}(n.default));i.default=y,cc._RF.pop()},{"../../Core/Controller":"Controller","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/WindowType":"WindowType","../../NetConnect/NetConnet":"NetConnet","../Commons/RewardUtils":"RewardUtils","../OpenWin/OpenWinController":"OpenWinController","../Role/RoleInfo":"RoleInfo","../Tips/RewardTips":"RewardTips","./VipData":"VipData","./VipUPTips":"VipUPTips"}],VipData:[function(e,t,i){"use strict";cc._RF.push(t,"54203EJVrBA97X9G/Cyy8x5","VipData"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/ConfigsManager"),o=e("../Commons/RewardUtils"),a=e("../Role/RoleInfo"),r=e("../welfarelobby/welfarelobbyUtils"),s=e("../../Global/GlobalValue"),l=function(){function e(){this._cfg=null,this._benefitCfg=null,this._giftstatus=[],this.isFrsit=!1,this.currVipLevel=null,this._Vipbenefitsflag=null,this._cfg=n.ConfigsManager.instance.getConfigs("vipConf"),this._benefitCfg=n.ConfigsManager.instance.getConfigs("vipbenefitsConf")}return e.prototype.getVipCfg=function(e){return this._cfg.vipConfig[1][Math.min(s.MaxVipLev,e)]},e.prototype.getGiftPackCfg=function(e){var t=this.getVipCfg(e).giftpack;return this._cfg.giftpack[t]},e.prototype.getRewardList=function(e){var t=this.getGiftPackCfg(e).present;return o.default.instance.getItemList(t)},e.prototype.geGiftPackCfg=function(e){return this.getGiftPackCfg(e)},e.prototype.privilegeDesc=function(e){var t=this.getVipCfg(e).desc;return this._cfg.desc[t]},e.prototype.setData=function(e){a.MyRoleInfo.vipLevel=e.level,a.MyRoleInfo.vipExp=e.exp,this._giftstatus=e.giftstatus,this.currVipLevel!=e.level&&(this.currVipLevel=e.level,this.isFrsit=!1,r.welfarelobbyUtils.setRed())},e.prototype.getGiftstatus=function(e){var t=0;return this._giftstatus[e]&&(t=this._giftstatus[e]),t},Object.defineProperty(e.prototype,"getVipItemId",{get:function(){var e=[];if(this._cfg){var t=this._cfg.item;for(var i in t)-1==e.indexOf(t[i][0].itemId)&&e.push(t[i][0].itemId)}return e},enumerable:!0,configurable:!0}),e.prototype.getGiftBagFlag=function(e){var t=!1;if(this._cfg.vipConfig[1][e].giftpack){var i=this.getGiftstatus(e),n=a.MyRoleInfo.vipLevel>=e;1==i&&n&&(t=!0)}return t},e.prototype.getPrivilegList=function(){return this._cfg.privilege},e.prototype.getPrivileg=function(e){return this._cfg.privilege[e]},e.prototype.getprivilegeData=function(e,t){var i=this.getPrivileg(e);if(i)for(var n in i)if(i[n].type==t)return i[n];return null},e.prototype.getPrivilegDataByLevel=function(e,t){if(this.getVipCfg(e)){var i=this.getVipCfg(e).privilege;return this.getprivilegeData(i,t)}return null},e.prototype.getItemData=function(e){var t=this.getVipCfg(e).item;return this._cfg.item[t]},e.prototype.getAddNum=function(e,t){var i=this.getItemData(e);if(i)for(var n in i)if(i[n].id==t)return i[n].times;return 0},Object.defineProperty(e.prototype,"CfgData",{get:function(){var e=[],t=[],i=[];for(var n in this._cfg.vipConfig[1]){if(this._cfg.vipConfig[1][n].giftpack)switch(this.getGiftstatus(parseInt(n))){case 1:e.push({vipLev:parseInt(n),data:this.getRewardList(parseInt(n))});break;case 2:i.push({vipLev:parseInt(n),data:this.getRewardList(parseInt(n))});break;default:t.push({vipLev:parseInt(n),data:this.getRewardList(parseInt(n))})}}return e.concat(t,i)},enumerable:!0,configurable:!0}),e.prototype.getVipGiftRed=function(){for(var e in this._giftstatus)if(this._giftstatus[e]&&1==this._giftstatus[e])return!0;return!1},e.prototype.getBenefitRewardCfg=function(e){var t=this._benefitCfg.viplv[e];return o.default.instance.getItemListByServerData(t)},e.prototype.setVipbenefitsFlag=function(e){this._Vipbenefitsflag=e},e.prototype.getVipbenefitsStatus=function(e){var t=0;return this._Vipbenefitsflag&&this._Vipbenefitsflag[e]&&(t=this._Vipbenefitsflag[e]),t},e.prototype.getGoldNum=function(e){var t=0,i=this.getVipCfg(e-1);if(i&&i.needExp){var n=i.needExp-a.MyRoleInfo.vipExp;t=Math.ceil(n/i.addExp)}return t=t<=0?0:t},e.prototype.getVipbenefitsRedPoint=function(){for(var e=!1,t=0;t<s.MaxVipLev;++t){if(this.getVipbenefitsFlag(t)){e=!0;break}}return e},e.prototype.getVipbenefitsFlag=function(e){var t=!1,i=this.getGoldNum(e),n=this.getVipbenefitsStatus(e);return i<=0&&1==n&&(t=!0),t},e}();i.default=l,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Global/GlobalValue":"GlobalValue","../Commons/RewardUtils":"RewardUtils","../Role/RoleInfo":"RoleInfo","../welfarelobby/welfarelobbyUtils":"welfarelobbyUtils"}],VipLev:[function(e,t,i){"use strict";cc._RF.push(t,"15e04QsiTNJ8IoGmzTs9xn5","VipLev"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=cc._decorator,a=o.ccclass,r=o.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.level=null,t._callbackFun=null,t._callbackObj=null,t}return __extends(t,e),t.prototype.setData=function(e,t,i,n){void 0===t&&(t=!1),void 0===i&&(i=null),void 0===n&&(n=null),this.level.string=e+"",t&&(this._callbackFun=i,this._callbackObj=n)},t.prototype.onClickBtn=function(){this._callbackFun&&this._callbackFun.call(this._callbackObj)},__decorate([r(cc.Label)],t.prototype,"level",void 0),t=__decorate([a],t)}(n.default);i.default=s,cc._RF.pop()},{"../../Core/Widget":"Widget"}],VipUPTips:[function(e,t,i){"use strict";cc._RF.push(t,"25e88MNMj9JaK3vb/r56A4j","VipUPTips"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../../Core/Language"),a=e("./VipCtrl"),r=e("../../Core/LoadManager"),s=e("../../GlobalContext"),l=e("../../Util/Utils"),c=e("../Item/ItemIcon"),d=e("../../Core/WindowType"),p=e("../Commons/WindowOpenUtils"),h=cc._decorator,u=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.vipLev=null,t.vipLev2=null,t.vipLev3=null,t.itemList=null,t.itemList2=null,t.btn=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),this.node.scale=0,this.node.opacity=0},t.prototype.setData=function(e){var t=this;this.vipLev.string=e.toString(),this.vipLev2.string=o.default.getStr("expedition_vip",e),this.vipLev3.string=o.default.getStr("expedition_vip",e),r.default.instance.loadResByType(s.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(i){l.default.setNodeChildDestoryByUrl(t.itemList,s.GlobalContext.Root+"prefab/Bag/ItemIcon");var n=a.default.instance.data.getBenefitRewardCfg(e);for(var o in n){var r=l.default.getNodeByUrl(i,s.GlobalContext.Root+"prefab/Bag/ItemIcon");r.getComponent(c.default).ItemData(n[o],!1,n[o].count+"",!0),t.itemList.addChild(r)}},this),r.default.instance.loadResByType(s.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(i){l.default.setNodeChildDestoryByUrl(t.itemList2,s.GlobalContext.Root+"prefab/Bag/ItemIcon");var n=a.default.instance.data.getRewardList(e);for(var o in n){var r=l.default.getNodeByUrl(i,s.GlobalContext.Root+"prefab/Bag/ItemIcon");r.getComponent(c.default).ItemData(n[o],!1,n[o].count+"",!0),t.itemList2.addChild(r)}},this),this.playEffect()},t.prototype.playEffect=function(){var e=this;this.node.runAction(cc.spawn(cc.fadeIn(.25),cc.scaleTo(.25,1,1),cc.callFunc(function(){e.node.getChildByName("MaskBg").on(cc.Node.EventType.TOUCH_START,function(){e.close()},e)})))},t.prototype.onClickBtn=function(){p.default.instance.openWindowType(d.WindowType.VIP),this.close()},__decorate([f(cc.Label)],t.prototype,"vipLev",void 0),__decorate([f(cc.Label)],t.prototype,"vipLev2",void 0),__decorate([f(cc.Label)],t.prototype,"vipLev3",void 0),__decorate([f(cc.Node)],t.prototype,"itemList",void 0),__decorate([f(cc.Node)],t.prototype,"itemList2",void 0),__decorate([f(cc.Node)],t.prototype,"btn",void 0),t=__decorate([u],t)}(n.default);i.default=g,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/Window":"Window","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Commons/WindowOpenUtils":"WindowOpenUtils","../Item/ItemIcon":"ItemIcon","./VipCtrl":"VipCtrl"}],VipWin:[function(e,t,i){"use strict";cc._RF.push(t,"7f401Nv+yVHoLaIp4kr2ZeE","VipWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../../GlobalContext"),a=e("../OpenWin/OpenWinController"),r=e("../../Core/WindowType"),s=e("../Shop/ShopController"),l=e("../Shop/ShopConst"),c=e("../Shop/Shop"),d=e("./VipCtrl"),p=e("../Role/RoleInfo"),h=e("../Tips/OpTipsController"),u=e("../../Core/Language"),f=e("../../Global/GlobalValue"),g=e("../Item/ItemIcon"),y=e("../../Core/Event"),m=e("../../Core/GameEventDispatcher"),C=e("../../Core/LoadManager"),v=e("../../Util/Utils"),_=e("../Decompose/TagBtn"),b=cc._decorator,T=b.ccclass,S=b.property,I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.topNode=null,t.leftNode=null,t.rightNode=null,t.imgs=[],t.vipIcon=null,t.btnLeft=null,t.btnRight=null,t.data=null,t._showLev=null,t._tagIndex=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.node.width=o.GlobalContext.StageWidth,this.node.height=o.GlobalContext.StageHeight},t.prototype.show=function(){d.default.instance.reqVipInfo(),this.data=d.default.instance.data,this._showLev=p.MyRoleInfo.vipLevel,this.initTagBtn(),this.setShow(),m.GameEventDispatcher.instance.on(y.EventDefiner.Vip_info_up,this.setShow,this),m.GameEventDispatcher.instance.on(y.EventDefiner.vipbenefitsUp,this.setShow,this)},t.prototype.hide=function(){this.data=null,this._showLev=null,this._tagIndex=null,m.GameEventDispatcher.instance.off(y.EventDefiner.Vip_info_up,this.setShow,this),m.GameEventDispatcher.instance.off(y.EventDefiner.vipbenefitsUp,this.setShow,this)},t.prototype.setShow=function(){this.node.active&&(this.setTopShow(),this.setLeftShow(),this.setRightShow())},t.prototype.setTopShow=function(){this.topNode.getChildByName("vipLev").getComponent(cc.Label).string=p.MyRoleInfo.vipLevel+"";var e=this.data.getVipCfg(p.MyRoleInfo.vipLevel),t=0,i=0;if(e.needExp){t=e.needExp;var n=e.needExp-p.MyRoleInfo.vipExp;i=Math.ceil(n/e.addExp)}else t=p.MyRoleInfo.vipExp;var o=this.topNode.getChildByName("node");o.getChildByName("num").getComponent(cc.Label).string=i+"";var a=p.MyRoleInfo.vipLevel>=f.MaxVipLev?f.MaxVipLev:p.MyRoleInfo.vipLevel+1;o.getChildByName("nextLevel").getComponent(cc.Label).string=a+"",this.setProgressBarShow(this.topNode.getChildByName("ProgressBar"),p.MyRoleInfo.vipExp,t)},t.prototype.setProgressBarShow=function(e,t,i){e.getChildByName("Label").getComponent(cc.Label).string=u.default.getStr("{0}/{1}",t,i);var n=e.width*(t/i>=1?1:t/i);e.getChildByName("bar").width=n},t.prototype.setLeftShow=function(){this.setItem(),this.setText(),this.setBtn(),this.setRedPoint()},t.prototype.setItem=function(){var e=this._tagIndex?this.data.getRewardList(this._showLev):this.data.getBenefitRewardCfg(this._showLev),t=this.leftNode.getChildByName("ScrollView").getComponent(cc.ScrollView);C.default.instance.loadResByType(o.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(i){for(var n in v.default.setNodeChildDestoryByUrl(t.content,o.GlobalContext.Root+"prefab/Bag/ItemIcon"),e){var a=v.default.getNodeByUrl(i,o.GlobalContext.Root+"prefab/Bag/ItemIcon");a.getComponent(g.default).ItemData(e[n],!0,e[n].count+"",!0),a.scale=.7,t.content.addChild(a)}t.scrollToTop()},this)},t.prototype.setText=function(){var e=!!this._tagIndex;this.leftNode.getChildByName("benefitNode").active=!e,e||this.setBenefitText()},t.prototype.setGiftBagText=function(){var e=this.leftNode.getChildByName("giftBagNode"),t=this.data.getGiftPackCfg(this._showLev);e.getChildByName("price").getChildByName("Sprite2").getComponent(cc.Sprite).spriteFrame=this.imgs[t.type];var i=e.getChildByName("costPrice");i.getComponent(cc.Label).string=t.costPrice+"";var n=e.getChildByName("line");n.width=i.width+8,n.x=i.x-4,e.getChildByName("price").getChildByName("Sprite2").getComponent(cc.Sprite).spriteFrame=this.imgs[t.type],e.getChildByName("curPrice").getComponent(cc.Label).string=t.curPrice+""},t.prototype.setBenefitText=function(){var e=this.leftNode.getChildByName("benefitNode"),t=d.default.instance.data.getGoldNum(this._showLev);e.getChildByName("node").getChildByName("Label").getComponent(cc.Label).string=u.default.getStr("vip_03",t),e.active=t>0},t.prototype.setBtn=function(){var e=!!this._tagIndex,t=this.leftNode.getChildByName("btn_Buy");if(e){var i=this.data.getGiftstatus(this._showLev);t.getComponent(cc.Button).interactable=1==i;o=2==i?u.default.getStr("\u5df2\u9886\u53d6"):u.default.getStr("\u9886 \u53d6");t.getChildByName("Label").getComponent(cc.Label).string=o}else{var n=d.default.instance.data.getVipbenefitsStatus(this._showLev),o=null;switch(n){case 0:o=u.default.getStr("\u5145 \u503c");break;case 1:o=u.default.getStr("\u9886 \u53d6");break;case 2:o=u.default.getStr("\u5df2\u9886\u53d6")}t.getComponent(cc.Button).interactable=2!=n,t.getChildByName("Label").getComponent(cc.Label).string=o}},t.prototype.setRedPoint=function(){var e=this.leftNode.getChildByName("TagList");e.children[0].getComponent(_.default).setRed(d.default.instance.data.getVipbenefitsFlag(this._showLev)),e.children[1].getComponent(_.default).setRed(1==d.default.instance.data.getGiftstatus(this._showLev)),this.btnLeft.getChildByName("red").active=d.default.instance.data.getVipbenefitsFlag(this._showLev-1>=0?this._showLev-1:f.MaxVipLev),this.btnRight.getChildByName("red").active=d.default.instance.data.getVipbenefitsFlag(this._showLev+1<=f.MaxVipLev?this._showLev+1:0)},t.prototype.setRightShow=function(){var e=this;this.rightNode.getChildByName("title").getChildByName("Label").getComponent(cc.Label).string=u.default.getStr("VIP{0}\u7279\u6743",this._showLev);var t=this.rightNode.getChildByName("ScrollView").getComponent(cc.ScrollView);C.default.instance.loadResByType(o.GlobalContext.Root+"prefab/VIP/privilege",cc.Prefab,function(i){var n=e.data.privilegeDesc(e._showLev);for(var a in v.default.setNodeChildDestoryByUrl(t.content,o.GlobalContext.Root+"prefab/VIP/privilege"),n){var r=v.default.getNodeByUrl(i,o.GlobalContext.Root+"prefab/VIP/privilege");e.setVIPPrivilege(r,n[a]),t.content.addChild(r)}t.scrollToTop()},this)},t.prototype.setVIPPrivilege=function(e,t){e.getChildByName("title").getComponent(cc.Label).string=t.title,e.getChildByName("Label").getComponent(cc.Label).string=t.text,e.getChildByName("img").getComponent(cc.Sprite).spriteFrame=this.vipIcon.getSpriteFrame("icon_"+t.imgID)},t.prototype.onClickPay=function(){a.default.instance.openWindow(r.WindowType.Shop,function(){var e=s.default.instance.nowSortIndex[l.ShopConst.Recharge];c.default.instance.TabBtnList2.selectItem(e)},this)},t.prototype.onClickBuy=function(){if(!!this._tagIndex){if(p.MyRoleInfo.vipLevel<this._showLev)return void h.default.instance.ShowMsg(u.default.getStr("6005"));d.default.instance.reqVipBuyGiftPack(this._showLev)}else{switch(d.default.instance.data.getVipbenefitsStatus(this._showLev)){case 0:this.onClickPay();break;case 1:d.default.instance.reqGetVipbenefits(this._showLev)}}},t.prototype.onClickleftOrRight=function(e,t){t<1?this._showLev>0?this._showLev-=1:this._showLev=f.MaxVipLev:this._showLev<f.MaxVipLev?this._showLev+=1:this._showLev=0,this.setTagNmae(),this.setLeftShow(),this.setRightShow()},t.prototype.initTagBtn=function(){var e=this.leftNode.getChildByName("TagList"),t=[u.default.getStr("vip_01"),u.default.getStr("vip_02",this._showLev)];for(var i in e.children)e.children[i].getComponent(_.default).setData(t[i],this.onClickTag,this);for(var i in e.children)e.children[i].getComponent(_.default).setSelectedFlag(0==parseInt(i));this._tagIndex=0},t.prototype.setTagNmae=function(){this.leftNode.getChildByName("TagList").children[1].getComponent(_.default).setTagName(u.default.getStr("vip_02",this._showLev))},t.prototype.onClickTag=function(e){this._tagIndex=e,this.setLeftShow()},__decorate([S(cc.Node)],t.prototype,"topNode",void 0),__decorate([S(cc.Node)],t.prototype,"leftNode",void 0),__decorate([S(cc.Node)],t.prototype,"rightNode",void 0),__decorate([S([cc.SpriteFrame])],t.prototype,"imgs",void 0),__decorate([S(cc.SpriteAtlas)],t.prototype,"vipIcon",void 0),__decorate([S(cc.Node)],t.prototype,"btnLeft",void 0),__decorate([S(cc.Node)],t.prototype,"btnRight",void 0),t=__decorate([T],t)}(n.default);i.default=I,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/Window":"Window","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../Decompose/TagBtn":"TagBtn","../Item/ItemIcon":"ItemIcon","../OpenWin/OpenWinController":"OpenWinController","../Role/RoleInfo":"RoleInfo","../Shop/Shop":"Shop","../Shop/ShopConst":"ShopConst","../Shop/ShopController":"ShopController","../Tips/OpTipsController":"OpTipsController","./VipCtrl":"VipCtrl"}],VitalityBox:[function(e,t,i){"use strict";cc._RF.push(t,"f3fa35fp/NKWqhgm5y0c4kk","VitalityBox"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../NetConnect/NetConnet"),a=e("../../Core/GameEventDispatcher"),r=e("./DailyData"),s=e("../OpenWin/OpenWinController"),l=e("../../Core/WindowType"),c=e("../Tips/RewardTips"),d=e("../Item/ItemData"),p=e("../../Util/GrayEffect"),h=e("../Item/ItemController"),u=cc._decorator,f=u.ccclass,g=u.property,y=function(e){function t(){var t=e.call(this)||this;return t.highLight=null,t.content=null,t.VitalityLabe=null,t.boxVitality=null,t.boxID=null,t.isGet=!1,t.isNum=null,t.boxRewardID=null,t.boxRewardNum=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),this.dailyData=new r.default,this.dailyData.initid(this.boxID),this.VitalityLabe.string=""+this.boxVitality,a.GameEventDispatcher.instance.on("DESTROY",this.deleteTip,this)},t.prototype.hide=function(){e.prototype.hide.call(this),a.GameEventDispatcher.instance.off("DESTROY",this.deleteTip,this)},t.prototype.setBoxVitality=function(e){this.boxVitality=e},t.prototype.getBoxVitality=function(e){return this.boxVitality},t.prototype.setID=function(e){this.boxID=e},t.prototype.boxClickEvent=function(){var e=this;1!=this.isNum&&2!=this.isNum&&(this.dailyData.configVitality,h.default.instance.openItemTips(d.default.creatItem(this.boxRewardID,1))),1==this.isNum&&(this.getBoxReward(),this.isNum=null,this.node.addComponent(p.default).setGray(!0,!0),this.node.setScale(.15,1),this.closeJoggle(this.node.getChildByName("box")),this.closeJoggle(this.node.getChildByName("HighLight")),s.default.instance.openWindow(l.WindowType.RewardTips,function(){e.dailyData.configVitality,c.default.instance.setData([d.default.creatItem(e.boxRewardID,1)])})),this.isGet=!0,this.highLight.node.active=!1},t.prototype.deleteTip=function(){this.content.removeAllChildren()},t.prototype.getIsType=function(){return this.isGet},t.prototype.getBoxReward=function(){var e={cmd:"vitalityreward",id:this.boxID-1};o.default.instance.sendProto(e)},t.prototype.getFetterBoxReward=function(){var e={cmd:"dtreward",id:this.boxID-1};o.default.instance.sendProto(e)},t.prototype.setHighLight=function(e){this.highLight.node.active=e,(e=!0)&&(this.joggle(this.node.getChildByName("box")),this.joggle(this.node.getChildByName("HighLight")))},t.prototype.joggle=function(e){e.stopAllActions(),e.runAction(cc.repeatForever(cc.sequence(cc.delayTime(.1),cc.rotateTo(.18,10),cc.rotateTo(.18,-10),cc.rotateTo(.1,2),cc.rotateTo(.1,-2))))},t.prototype.closeJoggle=function(e){e.stopAllActions()},t.prototype.setReward=function(e){this.boxRewardID=e},t.prototype.setRewardNum=function(e){this.boxRewardNum=e},__decorate([g(cc.Sprite)],t.prototype,"highLight",void 0),__decorate([g(cc.Node)],t.prototype,"content",void 0),__decorate([g(cc.Label)],t.prototype,"VitalityLabe",void 0),t=__decorate([f],t)}(n.default);i.default=y,cc._RF.pop()},{"../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Widget":"Widget","../../Core/WindowType":"WindowType","../../NetConnect/NetConnet":"NetConnet","../../Util/GrayEffect":"GrayEffect","../Item/ItemController":"ItemController","../Item/ItemData":"ItemData","../OpenWin/OpenWinController":"OpenWinController","../Tips/RewardTips":"RewardTips","./DailyData":"DailyData"}],WarTeamMonsterInfo:[function(e,t,i){"use strict";cc._RF.push(t,"76b9bEZBPZEJYvGvnQU4SJU","WarTeamMonsterInfo"),Object.defineProperty(i,"__esModule",{value:!0});var n,o=e("./MonsterController"),a=e("../../Core/WindowType"),r=e("../../Core/GameEventDispatcher"),s=e("../../Core/Event"),l=e("../Functionicon/FunctionIconController"),c=e("../../Core/Language"),d=e("../../Core/CommonsResManager"),p=e("../Ornament/OrnamentCtrl"),h=e("../Equip/equip/EquipCtrl"),u=e("../Item/ItemIcon"),f=e("../../GlobalContext"),g=e("../../Core/LoadManager"),y=e("../../Util/Utils"),m=e("../Commons/MorphologicalTags"),C=e("../../Global/GlobalValue"),v=e("../Scene/Pool/SpinePools"),_=e("../../Core/SpineBase"),b=e("../../Core/WindowManager"),T=e("../OpenWin/OpenWinController"),S=e("./CardInfoLayer"),I=e("./CardStage/CardStage"),w=e("./CardSkill/CardSkill"),D=e("../Equip/EquipWin"),R=e("../../Util/GrayEffect"),A=e("../Tips/OpTipsController"),N=e("../Item/ItemData"),L=e("../Sound/SoundController"),E=e("../Ornament/OrnamentView"),B=e("../../Core/Window"),M=e("../Commons/Image"),x=e("../../Util/NumberUtil"),k=e("../Commons/WindowBg5"),P=e("../Item/ItemModel"),G=e("../../Core/ConfigsManager"),F=e("../../Util/RechargeUtils"),W=e("../../Util/RechargeConst"),U=e("../../Core/TimeController"),O=e("../Commons/MonsterPreview"),V=e("./CardGroup/CardGroupAttrTips"),q=e("../Guide/GuideNewController"),H=cc._decorator,j=H.ccclass;H.property;(function(e){e[e.info=0]="info",e[e.upgrade=1]="upgrade",e[e.skill=2]="skill",e[e.equip=3]="equip"})(n=i.CardTag||(i.CardTag={}));var K=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.stance=null,t.cardId=null,t.tagIndex=null,t._cardCfg=null,t.ctr=null,t.cardFlag=null,t.equipTabWintype=null,t.equipWearIndex=0,t.BtnWindowType=[a.WindowType.CardInfo,a.WindowType.CardUpgrade,a.WindowType.CardSkill,a.WindowType.CardEquip],t.prefabName=["CardInfoLayer","CardStage","CardSkill/CardSkill","EquipWin"],t._viewNodeMap={},t._type=0,t._ChooseIndex=null,t.gemIndex=null,t._cardConfigs=null,t.endFunc=null,t.endFuncThisObj=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this._cardConfigs=G.ConfigsManager.instance.getConfigs("cardConf"),i.instance=this,this.ctr=o.default.instance,this._cardCfg=this.ctr.data.getCardCfg()},t.prototype.show=function(){e.prototype.show.call(this),this.setTabShow(),this.cardId&&this.upLefgData(),r.GameEventDispatcher.instance.on(s.EventDefiner.Card_updataCardInfo,this.itemChangeUP,this),r.GameEventDispatcher.instance.on(s.EventDefiner.itemchangeUP,this.itemChangeUP,this),r.GameEventDispatcher.instance.on(s.EventDefiner.EQUIP_up_GemInfo,this.itemChangeUP,this),r.GameEventDispatcher.instance.on(s.EventDefiner.itemAddUP,this.itemChangeUP,this),r.GameEventDispatcher.instance.on(s.EventDefiner.MorphologicalTags_onClick,this.MorphologicalTag,this)},t.prototype.hide=function(){e.prototype.hide.call(this),r.GameEventDispatcher.instance.off(s.EventDefiner.Card_updataCardInfo,this.itemChangeUP,this),r.GameEventDispatcher.instance.off(s.EventDefiner.itemchangeUP,this.itemChangeUP,this),r.GameEventDispatcher.instance.off(s.EventDefiner.EQUIP_up_GemInfo,this.itemChangeUP,this),r.GameEventDispatcher.instance.emit(s.EventDefiner.WarTeamMonsterInfoHide),r.GameEventDispatcher.instance.off(s.EventDefiner.itemAddUP,this.itemChangeUP,this),r.GameEventDispatcher.instance.off(s.EventDefiner.MorphologicalTags_onClick,this.MorphologicalTag,this),this.endFunc&&(this.endFunc.apply(this.endFuncThisObj),this.endFunc=null,this.endFuncThisObj=null),this._ChooseIndex=null,this.tagIndex=null,this.gemIndex=null,L.default.instance.stopCardEffect(),L.default.instance.CurrentCardEffect=null},t.prototype.setOnclickTab=function(){var e=this;l.default.instance.checkIsOpenbyWindowtype(this.BtnWindowType[this._type])||(this._type=0),o.default.instance.getIsMonsterCard(this.cardId)?this.windowBg?this.windowBg.getComponent(k.default).TabBtnList.selectItem(this._type):(this.loadWindowCom=function(){e.scheduleOnce(function(){e.windowBg.getComponent(k.default).TabBtnList.selectItem(e._type)},.1)},this.loadWindowComThis=this):this.windowBg?this.windowBg.getComponent(k.default).TabBtnList.selectItem(n.skill):(this.loadWindowCom=function(){e.scheduleOnce(function(){e.windowBg.getComponent(k.default).TabBtnList.selectItem(n.skill)},.1)},this.loadWindowComThis=this)},t.prototype.noCardSet=function(){var e=o.default.instance.getIsMonsterCard(this.cardId),t=this.node.getChildByName("OneLayer"),i=t.getChildByName("itemList"),n=t.getChildByName("power"),a=t.getChildByName("btnGoGetPiece"),r=t.getChildByName("Upgrades"),s=this.node.getChildByName("btnLayer");if(e)i.active=!0,s.active=!0,n.active=!0,r.active=!1,a.active=!1;else{i.active=!1,s.active=!1,n.active=!1,r.active=!0,a.active=!0;var l=P.default.getCountByid(this._cardConfigs.Card[this.cardId].pieceId),c=this._cardConfigs.Card[this.cardId].pieceNum;r.getChildByName("value").getComponent(cc.Label).string=l+"/"+c,r.getChildByName("di").getChildByName("sp1").width=r.getChildByName("di").width*(l/c>=1?1:l/c)}},t.prototype.onClickGetPiece=function(){var e=o.default.instance.data.getCardPieceId(this.cardId);F.default.PurchaseItemOrRechage(W.RechargeTypeConst.Prop,this._cardConfigs.Card[this.cardId].pieceNum,null,this,e)},t.prototype.initInfo=function(e,t,i,n,o,a,r){void 0===i&&(i=null),void 0===n&&(n=null),void 0===a&&(a=null),void 0===r&&(r=0),this.equipTabWintype=a,this.equipWearIndex=r,this._type=t,this.cardId=e,this.cardFlag=o,this.endFunc=i,this.endFuncThisObj=n,this.node.getChildByName("btnLayer").active=!0,this.setMonsterModel(),this.upLefgData(),this.setOnclickTab(),this.btnRedPoit(),this.setTabShow(),this.noCardSet(),this._ChooseIndex=0},t.prototype.upLefgData=function(){this.setLeftData(),this.setLettOTherData(),this.setBtnData(),this.setXingTai(),this.setFight(),this.upRedPoint(),this.setItemListDat()},t.prototype.setLeftData=function(){var e=o.default.instance,t=e.GetMonsterData(this.cardId),i=this.node.getChildByName("OneLayer");i.getChildByName("name").getComponent(cc.Label).string=this._cardCfg.Card[this.cardId].cardName;var n=t?t.level:0,a=e.cardStageData.getCardMaxLevel(this.cardId),r=n;if(r>0){var s=h.default.instance.data.getEquipEffectAddAttr(this.cardId);r=a<(r+=s[C.AttrType.CardLevel]?s[C.AttrType.CardLevel]:0)?a:r}i.getChildByName("level").getComponent(cc.Label).string=c.default.getStr("Lv",r)+"/"+e.cardStageData.getCardMaxLevel(this.cardId);var l=e.GetMonsterInfo(this.cardId);i.getChildByName("shuxing").getComponent(cc.Sprite).spriteFrame=d.default.instance.getSpriteFrameByName("fiveLine_"+l.fiveLineAttributes)},t.prototype.setItemListDat=function(){var e=this.node.getChildByName("OneLayer").getChildByName("itemList"),t=o.default.instance.GetMonsterData(this.cardId),i=t&&t.equip?t.equip:[],n=t&&t.peishi?t.peishi:[];for(var r in e.children){var s=parseInt(r)<4?a.WindowType.CardEquip:a.WindowType.Ornament,c=parseInt(r),d=l.default.instance.checkIsOpenbyWindowtype(s),h=null;if(parseInt(r)<4)h=i[c]?i[c]:null;else{var u=p.default.instance.data.conversio(c-4);h=n[u]?n[u]:null}this.setItemImg(e.children[r],h),e.children[r].getChildByName("lock").active=!d}},t.prototype.setItemImg=function(e,t){if(e.getChildByName("ItemIcon").active=!!t,t){var i=h.default.instance.data.getItemByGuid(t);i||(i=p.default.instance.data.getOrnamentGuid(t)),e.getChildByName("ItemIcon").getComponent(u.default).ItemData(i,!1)}},t.prototype.setLettOTherData=function(){var e=this._cardCfg.Card[this.cardId].rarity,t=this._cardCfg.Card[this.cardId].cardType;this.node.getChildByName("OneLayer").getChildByName("MonsterType").getComponent(cc.Sprite).spriteFrame=d.default.instance.getSpriteFrameByName("stance_"+t),this.node.getChildByName("OneLayer").getChildByName("MonsterRarity").getComponent(cc.Sprite).spriteFrame=d.default.instance.getSpriteFrameByName("rarity_"+e)},t.prototype.setBtnData=function(){var e=this.node.getChildByName("OneLayer").getChildByName("btnGoToBattle");e.active=!0,e.getComponent(cc.Button).interactable=!0,e.getChildByName("Label").getComponent(cc.Label).string=c.default.getStr("\u4e0a\u9635");var t=o.default.instance,i=t.getIsLineupArr(this.cardId);t.getIsMonsterCard(this.cardId)?i[o.MonsterType.MonsterBattle]?(e.active=!1,e.getComponent(cc.Button).interactable=!1,this.node.getChildByName("OneLayer").getChildByName("img").active=!0,e.getChildByName("Label").getComponent(cc.Label).string=c.default.getStr("\u51fa\u6218\u4e2d")):(e.active=!0,e.getComponent(cc.Button).interactable=!0,this.node.getChildByName("OneLayer").getChildByName("img").active=!1,e.getChildByName("Label").getComponent(cc.Label).string=c.default.getStr("\u4e0a\u9635")):(e.active=!1,this.node.getChildByName("OneLayer").getChildByName("img").active=!1)},t.prototype.setXingTai=function(){var e=this.node.getChildByName("OneLayer").getChildByName("xingtai");if(e.childrenCount<=0){var t=f.GlobalContext.Root+"prefab/Common/morphologicalTags";g.default.instance.loadResByType(t,cc.Prefab,function(i){var n=y.default.getNodeByUrl(i,t);e.addChild(n);var a=n.getComponent(m.default);o.default.instance.data.MorphologicalTag=a.defalutIndex,n.getComponent(m.default).setShow(a.defalutIndex)},this)}},t.prototype.setFight=function(){var e=this.node.getChildByName("OneLayer"),t=o.default.instance,i=t.GetMonsterData(this.cardId);e.getChildByName("power").getChildByName("CombatPower").getChildByName("value").getComponent(cc.Label).string=i?""+t.getCarFight(this.cardId,i.level,t.data.MorphologicalTag,!0,null,!1):"0"},t.prototype.setMonsterModel=function(){var e=this,t=this.node.getChildByName("OneLayer").getChildByName("MonsterNode"),i=this.node.getChildByName("OneLayer").getChildByName("talkNode");t.removeAllChildren();var n=o.default.instance,a=L.default.instance;a.stopCardEffect();var r=Math.floor(Math.random()*this._cardConfigs.cardTalk[this.cardId].length),s=this._cardConfigs.cardTalk[this.cardId][r];n.infoPreview(t,new cc.Vec2(0,0),this.cardId,n.data.MorphologicalTag,.7,-1,!0,function(){g.default.instance.loadResByType(f.GlobalContext.Root+"prefab/WarTeam/talkBox",cc.Prefab,function(n){y.default.setNodeChildDestoryByUrl(i,f.GlobalContext.Root+"prefab/WarTeam/talkBox");var o=y.default.getNodeByUrl(n,f.GlobalContext.Root+"prefab/WarTeam/talkBox");q.default.instance.isGuide||a.playCardEffect(L.SoundType.cardTalk+s.sound),o.getComponentInChildren(cc.Label).string=s.talk,i.addChild(o);var r=.7*t.getComponentInChildren(O.default).height+50;o.setPosition(0,r),o.height=o.children[0].height+35;var l=U.default.instance.setTimeout(function(){o.runAction(cc.sequence(cc.delayTime(a.getCardEffect()),cc.fadeOut(.5))),U.default.instance.clearTimeout(l)},e,300)},e)},this,C.ACTION.STAND)},t.prototype.upgradeAnim=function(){var e=v.SpinePools.addSpineNoder(cc.find("OneLayer/AnimLayer",this.node),new cc.Vec2(0,0)),t=e.getComponent(_.default);t.playRate=1,t.initSpineData(C.SPINE_RES_DIR+"effect/monstereffect/effect",null,C.BuffEffectName.ZENGYI,!1),t.completeCallbackThisObj=this,t.completeCallbackParam=[e],t.completeCallback=function(e){v.SpinePools.recoverSpineNoder(e)},this.upLefgData()},t.prototype.btn_leftOrRight=function(e,t){for(var i=null,n=o.default.instance,a=n.data.cardShowDataSort(),r=this.cardFlag?o.MonsterType.MonsterWarTeam[o.MonsterType.MonsterBattle].length:a.length,s=0;s<a.length;s++)if(a[s]==this.cardId){i=s;break}1==t?--i<0&&(i=r-1):++i>=r&&(i=0);var l=a[i];null==n.GetMonsterData(l)?(this.cardId=l,this.btn_leftOrRight(null,t)):this.initInfo(l,this.tagIndex,null,null,this.cardFlag),this.setEquipItemShow()},t.prototype.btn_goToBattle=function(){var e=this;if(this.btn_close(),b.default.instance.isOpenWindow(a.WindowType.WarTeam)){var t={cardIDTwo:this.cardId};r.GameEventDispatcher.instance.emit("newCard",{flag:t})}else T.default.instance.openWindow(a.WindowType.WarTeam,function(){var t={cardIDTwo:e.cardId};r.GameEventDispatcher.instance.emit("newCard",{flag:t})},this)},t.prototype.tabBtnSelectedChange=function(e){var t=this;if(this.cardId)if(this.tagIndex=parseInt(e),this._viewNodeMap[e])this.setShowTag();else{var i=f.GlobalContext.Root+"prefab/Card/"+this.prefabName[e];g.default.instance.loadResByType(i,cc.Prefab,function(n){if(!t._viewNodeMap[e]){var o=y.default.getNodeByUrl(n,i);t.node.getChildByName("TwoLayer").addChild(o),t._viewNodeMap[e]=o,t.setShowTag()}},this)}},t.prototype.setViewNodeShow=function(){for(var e in this._viewNodeMap)this._viewNodeMap[e].active=parseInt(e)==this.tagIndex},t.prototype.setShowTag=function(){if(this.setViewNodeShow(),this._viewNodeMap[this.tagIndex]){var e=o.default.instance,t=e.data.MorphologicalTag;switch(this.tagIndex){case n.info:this._viewNodeMap[n.info].getComponent(S.default).setData(this.cardId,t);break;case n.upgrade:this._viewNodeMap[n.upgrade].getComponent(I.default).setData(this.cardId,t);break;case n.skill:this._viewNodeMap[n.skill].getComponent(w.default).setCarId(this.cardId,t);break;case n.equip:var i=e.GetMonsterData(this.cardId),a=e.getIsLineup(this.cardId);this._viewNodeMap[n.equip].getComponent(D.default).setData(i.equip[this.equipWearIndex],a,this.equipTabWintype)}this.equpRedPoit(),this.setChoose(),this.setEquipItemShow()}},t.prototype.btn_close=function(){this.close(),e.prototype.close.call(this)},t.prototype.openCardCombination=function(){var e=this;T.default.instance.openWindow(a.WindowType.CardGroupAttrTips,function(t){t.getComponent(V.default).setData(e.cardId)},this)},t.prototype.setTabShow=function(){if(this.windowBg){var e=this.windowBg.getComponent(k.default),t=o.default.instance,i=t.GetMonsterData(this.cardId);if(e.TabBtnList.ListContainer.childrenCount>0)for(var n in e.TabBtnList.ListContainer.children){var r=t.getIsMonsterCard(this.cardId),s=l.default.instance.checkIsOpenbyWindowtype(this.BtnWindowType[parseInt(n)]);this.BtnWindowType[parseInt(n)]==a.WindowType.CardInfo?s=r:this.BtnWindowType[parseInt(n)]!=a.WindowType.CardSkill&&(s=r&&s),i&&i.flag&&1==i.flag&&(this.BtnWindowType[parseInt(n)]==a.WindowType.CardEquip||this.BtnWindowType[parseInt(n)]==a.WindowType.CardUpgrade)&&(s=!1),this.setGrayEffect(e.TabBtnList.ListContainer.children[n],s),this.setGrayEffect(e.TabBtnList.ListContainer1.children[n],s)}}else console.log("========== this.windowBg \u4e3a NULL ========")},t.prototype.setGrayEffect=function(e,t){(e.getComponent(R.default)?e.getComponent(R.default):e.addComponent(R.default)).setGray(!t)},t.prototype.itemChangeUP=function(){this.equpRedPoit(),this.btnRedPoit(),this.upLefgData(),this.tabBtnSelectedChange(this.tagIndex?this.tagIndex:0),this.setEquipItemShow()},t.prototype.upRedPoint=function(){if(this.windowBg){var e=this.windowBg.getComponent(k.default),t=o.default.instance,i=t.data,a=t.getIsLineup(this.cardId),r=t.GetMonsterData(this.cardId),s=!(!r||!r.flag||1!=r.flag);e.TabBtnList.selectItemSetRed(n.upgrade,a&&!s&&i.getCardUPlevFlag(this.cardId)),e.TabBtnList.selectItemSetRed(n.skill,a&&!s&&i.getCardUpSkillFlag(this.cardId)),e.TabBtnList.selectItemSetRed(n.equip,a&&!s&&h.default.instance.data.getEquipFlag(this.cardId))}},t.prototype.onClickItem=function(e,t){var i=this,r=!(Number(t)<4),s=r?a.WindowType.Ornament:a.WindowType.CardEquip,d=o.default.instance;if(d.getIsMonsterCard(this.cardId)){if(l.default.instance.checkIsOpenbyWindowtype(s,!0)){this._ChooseIndex=parseInt(t);var u=r?p.default.instance.data.conversio(parseInt(t)-4):parseInt(t),f=d.GetMonsterData(this.cardId);if(!(!f||!f.flag||1!=f.flag))A.default.instance.ShowMsg(c.default.getStr("\u4e34\u65f6\u5361\u724c\u65e0\u6cd5\u7a7f\u6234"));else{var g=r?f.peishi&&f.peishi[u]:f.equip&&f.equip[u];if(this.tagIndex!=n.equip&&!r){if(this.equipWearIndex=u,!g)if(y=h.default.instance.data.getMaxFightEquip(this.cardId,u))return h.default.instance.reqTakeonEquip(this.cardId,y.guid),void L.default.instance.PlayEffect(L.SoundType.replaceSucceeds);return h.default.instance.onpenWearEquip(this.cardId,u,r),void this.setChoose()}if(g)r?T.default.instance.openWindow(s,function(e){e.getComponent(E.default).setCardId(i.cardId,u)}):(this.equipWearIndex=u,this._viewNodeMap[n.equip]&&1==this._viewNodeMap[n.equip].active?(this.tagIndex=n.equip,this.setShowTag()):this.windowBg&&this.windowBg.getComponent(k.default).TabBtnList.selectItem(n.equip));else{var y;if(!r)if(this.equipWearIndex=u,y=h.default.instance.data.getMaxFightEquip(this.cardId,u))return h.default.instance.reqTakeonEquip(this.cardId,y.guid),void L.default.instance.PlayEffect(L.SoundType.replaceSucceeds);h.default.instance.onpenWearEquip(this.cardId,u,r)}}}}else A.default.instance.ShowMsg(c.default.getStr("\u672a\u6fc0\u6d3b\u5361\u724c"))},t.prototype.equpRedPoit=function(){for(var e=this.node.getChildByName("OneLayer").getChildByName("itemList"),t=l.default.instance.checkIsOpenbyWindowtype(a.WindowType.CardEquip,!1),i=o.default.instance,n=i.getIsLineup(this.cardId),r=i.GetMonsterData(this.cardId),s=!(!r||!r.flag||1!=r.flag),c=0;c<4;++c){var d=!1;d=this.tagIndex<3?h.default.instance.data.getWearRedPointFlag(c,this.cardId):h.default.instance.data.getEquipFlag(this.cardId,c),e.children[c].getChildByName("red").active=t&&n&&!s&&d}t=l.default.instance.checkIsOpenbyWindowtype(a.WindowType.Ornament,!1);var u=p.default.instance.data.getCardOrnamentFlag(this.cardId,p.default.instance.data.conversio(0));e.children[4].getChildByName("red").active=t&&n&&!s&&u,u=p.default.instance.data.getCardOrnamentFlag(this.cardId,p.default.instance.data.conversio(1)),e.children[5].getChildByName("red").active=t&&n&&!s&&u},t.prototype.setGemIndex=function(e){this.gemIndex=e},t.prototype.setChoose=function(){var e=this.node.getChildByName("OneLayer").getChildByName("itemList"),t=o.default.instance.GetMonsterData(this.cardId),i=t&&t.equip?t.equip:[],n=t&&t.peishi?t.peishi:[];for(var r in e.children){var s=parseInt(r)<4?a.WindowType.CardEquip:a.WindowType.Ornament,c=parseInt(r),d=l.default.instance.checkIsOpenbyWindowtype(s),h=null;if(parseInt(r)<4)h=i[c]?i[c]:null;else{var u=p.default.instance.data.conversio(c-4);h=n[u]?n[u]:null}e.children[r].getChildByName("Choose").active=d&&null!=h&&parseInt(r)==this._ChooseIndex}},t.prototype.btnRedPoit=function(){for(var e=null,t=o.default.instance,i=t.data.cardShowDataSort(),n=this.cardFlag?o.MonsterType.MonsterWarTeam[o.MonsterType.MonsterBattle].length:i.length,a=0;a<2;++a){for(var r=0;r<i.length;r++)if(i[r]==this.cardId){e=r;break}0==a?--e<0&&(e=n-1):++e>=n&&(e=0);var s=i[e],l=!1,c=t.getIsLineup(s),d=t.GetMonsterData(s);l=!(!d||!d.flag||1!=d.flag),c&&!l&&(t.data.getCardUPlevFlag(s)||t.data.getCardUpSkillFlag(s)||h.default.instance.data.getEquipFlag(s)||h.default.instance.data.getEquipWearFlag(s))&&(l=!0),this.node.getChildByName("btnLayer").children[a].getChildByName("red").active=l}},t.prototype.setEquipItemShow=function(){var e=this.node.getChildByName("OneLayer").getChildByName("itemList");if(this.tagIndex==n.equip){var t=D.default.instance.equipTabIndex?D.default.instance.equipTabIndex:0,i=o.default.instance.GetMonsterData(this.cardId),r=i.equip?i.equip:[];if(r.length>0){for(var s in e.children){var p=h.default.instance.data.getItemByGuid(r[s]),u="",g=!1;if(parseInt(s)<4){if(p)switch(t){case D.euqipTag.Strengthen:u=(g=l.default.instance.checkIsOpenbyWindowtype(a.WindowType.Strengthen))?"+"+p.level:"+0";break;case D.euqipTag.UpgradeStage:g=l.default.instance.checkIsOpenbyWindowtype(a.WindowType.UpgradeStage),u=x.NumberUtil.unitsDigitToText(p.stage+1)+c.default.getStr("rank");break;case D.euqipTag.Gemstone:if(g=l.default.instance.checkIsOpenbyWindowtype(a.WindowType.Gemstone)){var m=e.children[s].getChildByName("bg2").getChildByName("baoshi");for(var C in m.children)if(p.gem[C]){var v=N.default.creatItem(p.gem[C],1),_=f.GlobalContext.ResRoot+"resources/itemicon/"+v.ItemIcon+".png";y.default.setImage(m.children[C],_)}else m.children[C].getComponent(M.default).clear(),m.children[C].getComponent(cc.Sprite).spriteFrame=d.default.instance.getSpriteFrameByName("bg_baoshidi")}break;case D.euqipTag.Refine:g=l.default.instance.checkIsOpenbyWindowtype(a.WindowType.Refine);var b=p.refineLevel>=0?p.refineLevel:0;u=g?y.default.getQualityName(Math.ceil((b+1)/10)):""}e.children[s].getChildByName("bg2").active=!(t!=D.euqipTag.Gemstone||!g),e.children[s].getChildByName("Label").active=!(t==D.euqipTag.Gemstone||!g);var T=e.children[s].getChildByName("Label").getChildByName("Label");if(T.getComponent(cc.Label).string=u,t==D.euqipTag.Refine&&p){var S=new cc.Color,I=(b=p.refineLevel>=0?p.refineLevel:0,["#00ca47","#00d5f5","#ff5df2","#ffc600","#ff0000"][Math.ceil((b+1)/10)-1]);S.fromHEX(I),T.color=S}else T.color=new cc.Color(255,255,255)}}return}}for(var s in e.children)parseInt(s)<4&&(e.children[s].getChildByName("bg2").active=!1,e.children[s].getChildByName("Label").active=!1)},t.prototype.MorphologicalTag=function(e){var t=e.getUserData().tabIndex;o.default.instance.data.MorphologicalTag=t,this.tabBtnSelectedChange(this.tagIndex?this.tagIndex:0),this.setFight(),this.setMonsterModel(),r.GameEventDispatcher.instance.emit(s.EventDefiner.Card_xingtai_up)},t.instance=null,t=i=__decorate([j],t)}(B.default);i.default=K,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/ConfigsManager":"ConfigsManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/SpineBase":"SpineBase","../../Core/TimeController":"TimeController","../../Core/Window":"Window","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/GrayEffect":"GrayEffect","../../Util/NumberUtil":"NumberUtil","../../Util/RechargeConst":"RechargeConst","../../Util/RechargeUtils":"RechargeUtils","../../Util/Utils":"Utils","../Commons/Image":"Image","../Commons/MonsterPreview":"MonsterPreview","../Commons/MorphologicalTags":"MorphologicalTags","../Commons/WindowBg5":"WindowBg5","../Equip/EquipWin":"EquipWin","../Equip/equip/EquipCtrl":"EquipCtrl","../Functionicon/FunctionIconController":"FunctionIconController","../Guide/GuideNewController":"GuideNewController","../Item/ItemData":"ItemData","../Item/ItemIcon":"ItemIcon","../Item/ItemModel":"ItemModel","../OpenWin/OpenWinController":"OpenWinController","../Ornament/OrnamentCtrl":"OrnamentCtrl","../Ornament/OrnamentView":"OrnamentView","../Scene/Pool/SpinePools":"SpinePools","../Sound/SoundController":"SoundController","../Tips/OpTipsController":"OpTipsController","./CardGroup/CardGroupAttrTips":"CardGroupAttrTips","./CardInfoLayer":"CardInfoLayer","./CardSkill/CardSkill":"CardSkill","./CardStage/CardStage":"CardStage","./MonsterController":"MonsterController"}],WarTeam:[function(e,t,i){"use strict";cc._RF.push(t,"7c227Eeq89OFrLsP0SrJhT1","WarTeam"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./MonsterController"),o=e("../../NetConnect/NetConnet"),a=e("../../Core/Window"),r=e("../../Core/WindowType"),s=e("../Commons/WindowBg1"),l=e("../../Core/ConfigsManager"),c=e("./MonsterLineup"),d=e("./MonsterCard"),p=e("./CardInfo"),h=e("../Sound/SoundController"),u=e("../../Core/GameEventDispatcher"),f=e("../../Core/Event"),g=e("../Functionicon/FunctionIconController"),y=e("../../Core/Language"),m=e("../Commons/ListViewCtrl"),C=e("../Tips/OpTipsController"),v=e("../../Core/LoadManager"),_=e("../../GlobalContext"),b=e("../../Util/Utils"),T=e("../Scene/Controller/SceneController"),S=e("../Gamelayer/Interface/EventInterface"),I=e("../Tips/TipsWinController"),w=e("../setting/SettingData"),D=e("../../Core/TimeController"),R=e("../Guide/GuideNewController"),A=cc._decorator,N=A.ccclass,L=A.property,E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=null,t.LineupLayer=null,t.lineupNode=null,t.FingerLayer=null,t.ContentTop=null,t.BagList=null,t.BtnLineupLayer=null,t.btnCloseLineup=null,t.warteamAtlas2=null,t.cardAtlas=null,t.listViewCtrl=null,t.toggleGroup=null,t.showCardBtn=null,t.information=null,t.effect=null,t.effectRight=null,t.inChange=!1,t.LineupCardId=null,t.fightTeamNum=0,t.inLeftChoice=!1,t.changeConfig=null,t.clickRightChane=!1,t.showCardUp=!1,t.showCardUpId=null,t._cardConfigs=null,t._huanzhuangFlag=!1,t._oldId=null,t._newId=null,t.newCardChange=!1,t.newCardId=null,t.lastSound=null,t.callbackCloseFunc=null,t.callbackCloseThisObj=null,t.tabBtnType=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){var t=this;this.onInit(r.WindowType.WarTeam,!0),this.loadWindowCom=function(){t.content.setSiblingIndex(0)},this.loadWindowComThis=this,e.prototype.onLoad.call(this),i.instance=this,this.listViewCtrl.refreshItem=this.updateCardItem,this.listViewCtrl.refreshItemThis=this},t.prototype.start=function(){e.prototype.start.call(this),this._cardConfigs=l.ConfigsManager.instance.getConfigs("cardConf")},t.prototype.show=function(){var t=this;e.prototype.show.call(this),_.PlayerData.TopPanel.active=!0,h.default.instance.StopBGM(),this.initInfo(),this.setCancelCardInfo(),this.updataCardInfo(!1),this.tabBtnSelectedChange(0),this.windowBg&&this.windowBg.getComponent(s.default).TabBtnList.selectItem(0);D.default.instance.setTimeout(function(){1==t.clickRed()?(g.default.instance.FuncIconRedDeal(r.WindowType.WarTeam,!0),u.GameEventDispatcher.instance.emit(S.EventInterface.CombatteamRed,!0)):(g.default.instance.FuncIconRedDeal(r.WindowType.WarTeam,!1),u.GameEventDispatcher.instance.emit(S.EventInterface.CombatteamRed,!1))},this,100);u.GameEventDispatcher.instance.on(f.EventDefiner.WarTeamMonsterInfoHide,this.BtnLineupInfo,this),u.GameEventDispatcher.instance.on(f.EventDefiner.Card_updataCardInfo,this.updataCardInfo,this),u.GameEventDispatcher.instance.on(f.EventDefiner.onekeyreplace_Status,this.upOnekeyreplace,this),u.GameEventDispatcher.instance.on("newCard",this.newCard,this)},t.prototype.hide=function(){e.prototype.hide.call(this),this.btn_closeLineup(),h.default.instance.stopCardEffect(),h.default.instance.CurrentCardEffect=null,h.default.instance.PlayBGM(w.default.currMusic)},t.prototype.BtnLineupInfo=function(){this.setBtnLineupInfo(n.MonsterType.MonsterBattle)},t.prototype.closeCallback=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this.callbackCloseFunc=e,this.callbackCloseThisObj=t},t.prototype.close=function(){e.prototype.close.call(this),this.callbackCloseFunc&&(this.callbackCloseFunc.apply(this.callbackCloseThisObj),this.callbackCloseFunc=null,this.callbackCloseThisObj=null),u.GameEventDispatcher.instance.off(f.EventDefiner.WarTeamMonsterInfoHide,this.BtnLineupInfo,this),u.GameEventDispatcher.instance.off(f.EventDefiner.Card_updataCardInfo,this.updataCardInfo,this),u.GameEventDispatcher.instance.off("newCard",this.newCard,this),T.default.instance.requestFightData(2),this._huanzhuangFlag=!1,this._oldId=null,this._newId=null,n.default.instance.data.setAutoReplaceData({flag:!1,type:-1,cardID:-1,cardIDTwo:-1})},t.prototype.initInfo=function(){this.setBtnLineupInfo(n.MonsterType.MonsterBattle),this.setLeftShow(),this.btnCloseLineup.active=!1},t.prototype.newLineup=function(e){var t=Number(e);this.cancelLineup(!1);var i=n.MonsterType.MonsterWarTeam[n.MonsterType.MonsterBattle];if(n.default.instance.getIsLineupArr(this.LineupCardId)[n.MonsterType.MonsterBattle]){for(var o in n.MonsterType.MonsterCardArr)if(n.MonsterType.MonsterCardArr[o].id==this.LineupCardId){for(var a in i)if(i[a]==o){i[a]=Number(i[t]),this.lineupNode.children[a].getComponent(c.default).initInfo(n.MonsterType.MonsterCardArr[i[a]].id,a);break}i[t]=Number(o),this.lineupNode.children[t].getComponent(c.default).initInfo(n.MonsterType.MonsterCardArr[i[t]].id,t);break}}else for(var o in n.MonsterType.MonsterCardArr)if(n.MonsterType.MonsterCardArr[o].id==this.LineupCardId){this._huanzhuangFlag=!0,this._oldId=Number(i[t]),this._newId=this.LineupCardId,i[t]=Number(o);var r=n.MonsterType.MonsterCardArr[o];this.lineupNode.children[t].getComponent(c.default).initInfo(r.id,t);break}this.setMonsterCard(this.tabBtnType),this.SendWarTeam(),this.setCardTalk(this._newId),this.scorllviewTop(),this.closeChangeCard()},t.prototype.setCardTalk=function(e){if(!R.default.instance.isGuide){var t=Math.floor(Math.random()*this._cardConfigs.cardTalk[e].length),i=this._cardConfigs.cardTalk[e][t];h.default.instance.stopCardEffect(),h.default.instance.playCardEffect(h.SoundType.cardTalk+i.sound),this.lastSound=h.SoundType.cardTalk+i.sound}},t.prototype.newCardLayer=function(e){void 0===e&&(e=0),this.setCancelCardInfo();var t=n.default.instance.data.getCarArrByType(e);this.listViewCtrl.initialize(t)},t.prototype.clickShowCard=function(){var e=this.showCardBtn.getChildByName("img");if(e.active)e.active=!1;else{if(this.inChange)return;e.active=!0}this.setMonsterCard(this.tabBtnType)},t.prototype.cheakInit=function(){if(this.showCardBtn)return!!this.showCardBtn.getChildByName("img")&&this.showCardBtn.getChildByName("img").active},t.prototype.clickShowInformantion=function(){var e=this.information.getChildByName("img");e.active?e.active=!1:e.active=!0,this.showCardInfomantion()},t.prototype.showCardInfomantion=function(){this.information.getChildByName("img").active?(this.listViewCtrl.items.forEach(function(e){e.getComponent(d.default).Infomantion()}),this.lineupNode.children.forEach(function(e){e.getComponent(c.default).showInfo()})):(this.listViewCtrl.items.forEach(function(e){e.getComponent(d.default).Infomantion()}),this.lineupNode.children.forEach(function(e){e.getComponent(c.default).hideInfo()}))},t.prototype.cheakInfo=function(){return!!this.information.getChildByName("img")&&this.information.getChildByName("img").active},t.prototype.updateCardItem=function(e,t){0!=this.listViewCtrl.dataLsit[t]&&e.getComponent("MonsterCard").initInfo(this.listViewCtrl.dataLsit[t])},t.prototype.setCancelCardInfo=function(){this.ContentTop.active=!1,this.cancelInfo()},t.prototype.cancelInfo=function(){this.listViewCtrl.items.forEach(function(e){e.getComponent(d.default).cancelInfo()})},t.prototype.setBtnLineupInfo=function(e){var t=2-Number(e);if(n.MonsterType.MonsterBattle=e,this.SendWarTeam(),this.BtnLineupLayer)for(var i=0;i<this.BtnLineupLayer.children.length;i++)this.BtnLineupLayer.children[i].children[1].active=i==t},t.prototype.setLineup=function(e){var t=Number(e);if(this.lineupNode)for(var i in n.MonsterType.MonsterWarTeam[t]){var o=n.MonsterType.MonsterCardArr[n.MonsterType.MonsterWarTeam[t][i]];this.lineupNode.children[i].getComponent(c.default).initInfo(o?o.id:null,i)}},t.prototype.setMonsterCard=function(e){this.newCardLayer(e),this.scorllviewTop()},t.prototype.cancelLineup=function(e){if(this.lineupNode){for(var t=0;t<this.lineupNode.children.length;t++){this.lineupNode.children[t].getChildByName("btnLineup").active=e}this.btnCloseLineup.active=e}},t.prototype.clickSelectChange=function(e,t){if(!this.clickRightChane){var i=Number(t);this.tabBtnSelectedChange(i)}},t.prototype.selectCardType=function(e){this.toggleGroup.children[e].getComponent(cc.Toggle).isChecked=!0,this.listViewCtrl.items.length<=0&&this.setSelectChange()},t.prototype.setSelectChange=function(){this.toggleGroup.children[0].getComponent(cc.Toggle).isChecked=!0},t.prototype.tabBtnSelectedChange=function(e){this.tabBtnType=Number(e),this.setMonsterCard(this.tabBtnType),this.scorllviewTop()},t.prototype.btn_Lineup=function(e,t){var i=Number(t);this.setBtnLineupInfo(i),this.setLeftShow()},t.prototype.setLeftShow=function(){this.lineupNode.active=!0,this.setLineup(n.MonsterType.MonsterBattle),this.huanZhuang()},t.prototype.btnChangeCard=function(){this.newCardLayer(this.tabBtnType),this.listViewCtrl.items.forEach(function(e){e.getComponent(d.default).Infomantion(),e.getComponent(d.default).showEffect()}),this.lineupNode.children.forEach(function(e){e.getComponent(c.default).setModelBlack(),e.getComponent(c.default).hideChangeStage(),e.getComponent(c.default).hideInfo()})},t.prototype.clickHideBlote=function(){this.ContentTop.active=!1},t.prototype.btn_closeLineup=function(){this.cancelLineup(!1),this.closeChangeCard(),this.setSelectChange(),this.newCardLayer(this.tabBtnType)},t.prototype.closeChangeCard=function(){this.inChange=!1,this.inLeftChoice=!1,this.LineupCardId=null,this.effect.active=!1,this.effectRight.active=!1,this.newCardChange=!1,this.clickRightChane=!1,this.showCardUp=!1,this.showCardUpId=null,this.newCardId=null,this.changeConfig=null,this.listViewCtrl.items.forEach(function(e){e.getComponent(d.default).choice=!1,e.getComponent(d.default).Infomantion(),e.getComponent(d.default).stopEffect()}),this.lineupNode.children.forEach(function(e){e.getComponent(c.default).stopEfffect(),e.getComponent(c.default).setOneModel(),e.getComponent(c.default).showChangeStage(),e.getComponent(c.default).showInfo(),e.getComponent(c.default).choice=!1,e.getComponent(c.default).allChoice=!1}),this.clickCloseChange(),this.scorllviewTop()},t.prototype.clickCardGoBattle=function(e){this.listViewCtrl.items.forEach(function(t){t.getComponent(d.default).cardId==e?(t.getComponent(d.default).choice=!0,t.getComponent(d.default).hideMask()):t.getComponent(d.default).showMask(),t.getComponent(d.default).Infomantion()});var t=[],i=this._cardConfigs.Card[e].cardType;if(this.lineupNode.children.forEach(function(e){t=e.getComponent(c.default).cheackChioce(i,t)}),-1!=t.indexOf(!0))for(var n=0;n<this.lineupNode.childrenCount;n++){var o=this.lineupNode.children[n].getComponent(c.default);t[n]?(o.allChoice=!0,o.effect()):(o.getComponent(c.default).setModelBlack(),o.getComponent(c.default).hideChangeStage(),o.getComponent(c.default).hideInfo())}else this.lineupNode.children.forEach(function(e){e.getComponent(c.default).allChoice=!0,e.getComponent(c.default).effect()})},t.prototype.clickCloseChange=function(){this.listViewCtrl.items.forEach(function(e){e.getComponent(d.default).hideMask()})},t.prototype.updataCardInfo=function(e){void 0===e&&(e=!0),this.node&&this.node.parent&&this.node.active&&(this.ContentTop.children[0].getComponent(p.default).updateInfo(),this.upMonsterLineup(),e&&(this.newCardLayer(this.tabBtnType),this.scorllviewTop()))},t.prototype.upMonsterLineup=function(){var e=n.MonsterType.MonsterWarTeam[n.MonsterType.MonsterBattle];for(var t in e)this.lineupNode.children[t].getComponent(c.default).setToUpdateInfo()},t.prototype.SendWarTeam=function(){var e={cmd:"cardconf",battle:Number(n.MonsterType.MonsterBattle),config:n.MonsterType.MonsterWarTeam};o.default.instance.sendProto(e),u.GameEventDispatcher.instance.emit("SetCard",this),this.huanZhuang()},t.prototype.scorllviewTop=function(){this.listViewCtrl.scrollToTop()},t.prototype.Bagscorllview=function(e){var t=1-this.listViewCtrl.scrollView.content.y/(this.listViewCtrl.scrollView.content.height-this.BagList.node.height);t<0?t=0:t>1&&(t=1),this.listViewCtrl.scrollView.scrollTo(new cc.Vec2(0,t),.1)},t.prototype.openMonsterCardPrefab=function(e,t){v.default.instance.loadResByType(_.GlobalContext.Root+"prefab/WarTeam/MonsterCard",cc.Prefab,function(i){var n=b.default.getNodeByUrl(i,_.GlobalContext.Root+"prefab/WarTeam/MonsterCard");e.addChild(n),n.name="MonsterCard"+t,n.getComponent("MonsterCard").initInfo(t)},this)},t.prototype.clickRed=function(){for(var e=n.default.instance,t=e.data.cardShowDataSort(),i=0;i<t.length;i++){if(e.getIsLineup(t[i]))if(!e.data.getRedByCardid(t[i]))return!0}},t.prototype.huanZhuang=function(){var e=this;if(this._huanzhuangFlag){this._huanzhuangFlag=!1,h.default.instance.PlayEffect(h.SoundType.replaceSucceeds);var t=n.default.instance;if(t.getCardConfCardType(this._oldId)==t.getCardConfCardType(this._newId)){var i=t.GetMonsterData(this._oldId);if(i){if(i.equip&&(i.equip[0]||i.equip[1]||i.equip[2])){var o=t.GetMonsterInfo(this._oldId).cardName,a=t.GetMonsterInfo(this._newId).cardName;I.default.instance.ShowTips(y.default.getStr("\u662f\u5426\u628a {0} \u8eab\u4e0a\u7684\u88c5\u5907\u66ff\u6362\u5230 {1}",o,a),function(){t.reqOnekeyreplace(e._oldId,e._newId)},this,null,1,null,null,null,null,null,!1)}}else console.log("\u66ff\u6362\u524d\u7684\u88c5\u5907\u4e0d\u5b58\u5728\u88c5\u5907\uff0c\u65e0\u6cd5\u6362\u88c5")}else console.log("\u5361\u724c\u4f4d\u7f6e\u4e0d\u5bf9\uff0c\u65e0\u6cd5\u6362\u88c5")}},t.prototype.upOnekeyreplace=function(e){e.getUserData().flag&&C.default.instance.ShowMsg(y.default.getStr("\u6362\u88c5\u6210\u529f"))},t.prototype.autoReplace=function(e){if(e.getUserData().flag){var t=n.default.instance.data.getAutoReplaceData();this._oldId=t.cardID,this._newId=t.cardIDTwo,this._huanzhuangFlag=!0,this.huanZhuang()}},t.prototype.newCard=function(e){var t=e.getUserData();if(t.flag){var i=t.flag.cardIDTwo;this.inChange=!0,this.clickRightChane=!0,this.effect.active=!0,this.newCardId=i,this.newCardChange=!0,this.newCardLayer(this.tabBtnType),this.LineupCardId=i,this.cancelLineup(!0),this.clickCardGoBattle(i)}},t.instance=null,__decorate([L(cc.Node)],t.prototype,"content",void 0),__decorate([L(cc.Node)],t.prototype,"LineupLayer",void 0),__decorate([L(cc.Node)],t.prototype,"lineupNode",void 0),__decorate([L(cc.Node)],t.prototype,"FingerLayer",void 0),__decorate([L(cc.Node)],t.prototype,"ContentTop",void 0),__decorate([L(cc.ScrollView)],t.prototype,"BagList",void 0),__decorate([L(cc.Node)],t.prototype,"BtnLineupLayer",void 0),__decorate([L(cc.Node)],t.prototype,"btnCloseLineup",void 0),__decorate([L(cc.SpriteAtlas)],t.prototype,"warteamAtlas2",void 0),__decorate([L(cc.SpriteAtlas)],t.prototype,"cardAtlas",void 0),__decorate([L(m.default)],t.prototype,"listViewCtrl",void 0),__decorate([L(cc.Node)],t.prototype,"toggleGroup",void 0),__decorate([L(cc.Node)],t.prototype,"showCardBtn",void 0),__decorate([L(cc.Node)],t.prototype,"information",void 0),__decorate([L(cc.Node)],t.prototype,"effect",void 0),__decorate([L(cc.Node)],t.prototype,"effectRight",void 0),t=i=__decorate([N],t)}(a.default);i.default=E,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/Window":"Window","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../NetConnect/NetConnet":"NetConnet","../../Util/Utils":"Utils","../Commons/ListViewCtrl":"ListViewCtrl","../Commons/WindowBg1":"WindowBg1","../Functionicon/FunctionIconController":"FunctionIconController","../Gamelayer/Interface/EventInterface":"EventInterface","../Guide/GuideNewController":"GuideNewController","../Scene/Controller/SceneController":"SceneController","../Sound/SoundController":"SoundController","../Tips/OpTipsController":"OpTipsController","../Tips/TipsWinController":"TipsWinController","../setting/SettingData":"SettingData","./CardInfo":"CardInfo","./MonsterCard":"MonsterCard","./MonsterController":"MonsterController","./MonsterLineup":"MonsterLineup"}],WebSDK:[function(e,t,i){"use strict";cc._RF.push(t,"19585cbUXBKTbQhhTCPfLM5","WebSDK"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../NetConnect/NetConnet"),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.login=function(){e.prototype.login.call(this),this.loginBack()},t.prototype.exit=function(){e.prototype.exit.call(this),cc.game.end()},t.prototype.pay=function(t,i,o,a){void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),e.prototype.pay.call(this,t,i,o,a);var r={cmd:"gm",type:"diamondshop",param:[t]};n.default.instance.sendProto(r),this.payBack()},t}(e("./GameBaseSDK").GameBaseSDK);i.WebSDK=o,cc._RF.pop()},{"../../NetConnect/NetConnet":"NetConnet","./GameBaseSDK":"GameBaseSDK"}],WelfarelobbyTabBtnItem:[function(e,t,i){"use strict";cc._RF.push(t,"4ae74lA/xxNrrynBGERIGjU","WelfarelobbyTabBtnItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/TimeController"),a=cc._decorator,r=a.ccclass,s=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.ClickTimeOut=function(){var e=this;this.node.getChildByName("TabBtn2").getComponent(cc.Button).interactable=!1;var t=o.default.instance.setTimeout(function(){e.node.getChildByName("TabBtn2").getComponent(cc.Button).interactable=!0,o.default.instance.clearTimeout(t)},this,100)},t=__decorate([r],t)}(n.default));i.default=s,cc._RF.pop()},{"../../Core/TimeController":"TimeController","../../Core/Widget":"Widget"}],Widget:[function(e,t,i){"use strict";cc._RF.push(t,"ec0de1LAiRD9ItE3ILAS5IQ","Widget"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./PrefabCache"),o=cc._decorator,a=o.ccclass,r=(o.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isinit=!1,t.isDestroyed=!1,t}var i;return __extends(t,e),i=t,Object.defineProperty(t.prototype,"x",{get:function(){return this.node.position.x},set:function(e){this.node.x=e,this.worldX=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.node.position.y},set:function(e){this.node.y=e,this.worldY=e},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){},t.prototype.start=function(){this.isinit=!0,this.initWidget()},t.prototype.onEnable=function(){this.initWidget()},t.prototype.onDisable=function(){this.hide()},t.prototype.onDestroy=function(){this.isDestroyed=!0},t.prototype.initWidget=function(){this.isinit&&this.show()},t.prototype.show=function(){},t.prototype.hide=function(){},t.prototype.dispose=function(e){void 0===e&&(e=!0),this.getComponent(n.default)&&this.getComponent(n.default).dispose(),this.disposChild(this.node,e),1==this.node.isValid&&this.node.destroy()},t.prototype.disposChild=function(e,t){if(!(e.childrenCount<1))for(var i=e.childrenCount-1;i>=0;i--){var n=e.children[i];this.disposComponent(n,t)}},t.prototype.disposComponent=function(e,t){var n=e.getComponents(i);if(!n||n.length<1)t&&this.disposChild(e,t);else for(var o=0;o<n.length;o++)n[o]instanceof i&&n[o].dispose(t)},t=i=__decorate([a],t)}(cc.Component));i.default=r,cc._RF.pop()},{"./PrefabCache":"PrefabCache"}],WindowBg1:[function(e,t,i){"use strict";cc._RF.push(t,"7f8d9Gv/MhJpJdC3rTcc8Cn","WindowBg1"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("./TabBtnList"),a=e("../../GlobalContext"),r=e("../../Core/GameEventDispatcher"),s=e("../../Core/Event"),l=cc._decorator,c=l.ccclass,d=l.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.TitleImage=null,t.Container=null,t.TabBtnList=null,t.ListContainer_copy=null,t.WindowBg=null,t.WindowLeftBg=null,t.Title1=null,t.BackBtn1=null,t.Bg=null,t.TitleAtilas=null,t.btnRule=null,t._windowType=0,t._isShowBtnRule=!1,t.backBtnClickCallback=null,t.backBtnClickCallbackThisObj=null,t.setPosLick=!1,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this),this.setPosLick||(this.BackBtn1.setPosition(-a.GlobalContext.UIWidth/2+this.BackBtn1.width/2,a.GlobalContext.UIHeight/2-this.BackBtn1.height/2),this.Title1.setPosition(this.BackBtn1.x+122,this.BackBtn1.y))},t.prototype.show=function(){e.prototype.show.call(this),this.onShowPage()},t.prototype.onInit=function(e,t){void 0===e&&(e=0),void 0===t&&(t=!1),this._windowType=e,this._isShowBtnRule=t},t.prototype.onShowPage=function(){this.btnRule.active=this._windowType>0&&this._isShowBtnRule},t.prototype.backBtnClick=function(e){e.type==cc.Node.EventType.TOUCH_END&&this.backBtnClickCallback&&this.backBtnClickCallback.call(this.backBtnClickCallbackThisObj)},t.prototype.onClickRule=function(){this._windowType>0&&r.GameEventDispatcher.instance.emit(s.EventDefiner.OpenRulePage,this._windowType)},__decorate([d(cc.Sprite)],t.prototype,"TitleImage",void 0),__decorate([d(cc.Node)],t.prototype,"Container",void 0),__decorate([d(o.default)],t.prototype,"TabBtnList",void 0),__decorate([d(cc.Node)],t.prototype,"ListContainer_copy",void 0),__decorate([d(cc.Node)],t.prototype,"WindowBg",void 0),__decorate([d(cc.Node)],t.prototype,"WindowLeftBg",void 0),__decorate([d(cc.Node)],t.prototype,"Title1",void 0),__decorate([d(cc.Node)],t.prototype,"BackBtn1",void 0),__decorate([d(cc.Node)],t.prototype,"Bg",void 0),__decorate([d(cc.SpriteAtlas)],t.prototype,"TitleAtilas",void 0),__decorate([d(cc.Node)],t.prototype,"btnRule",void 0),t=__decorate([c],t)}(n.default);i.default=p,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Widget":"Widget","../../GlobalContext":"GlobalContext","./TabBtnList":"TabBtnList"}],WindowBg2:[function(e,t,i){"use strict";cc._RF.push(t,"fe1dfBJp1lC07GMNQb3kE7P","WindowBg2"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/Window"),a=cc._decorator,r=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.TitleLabel=null,t.Container=null,t.Title="",t.isOpenAnim=!0,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this),this.isOpenAnim&&(this.node.scale=.1,this.node.addComponent("SmallWindowZoom")),this.TitleLabel&&(this.TitleLabel.string=this.Title),this.Container&&(this.Container.scale=.1)},t.prototype.closeBtnClick=function(){this.node.parent&&this.node.parent.getComponent(o.default)&&this.node.parent.getComponent(o.default).close()},__decorate([s(cc.Label)],t.prototype,"TitleLabel",void 0),__decorate([s(cc.Node)],t.prototype,"Container",void 0),__decorate([s(cc.String)],t.prototype,"Title",void 0),__decorate([s(cc.Boolean)],t.prototype,"isOpenAnim",void 0),t=__decorate([r],t)}(n.default);i.default=l,cc._RF.pop()},{"../../Core/Widget":"Widget","../../Core/Window":"Window"}],WindowBg4:[function(e,t,i){"use strict";cc._RF.push(t,"42b5cw5tItHPIb+3LiMtC7K","WindowBg4"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../GlobalContext"),a=e("../../Core/GameEventDispatcher"),r=e("../../Core/Event"),s=cc._decorator,l=s.ccclass,c=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.labelCloseTips=null,t.spriteMask=null,t.spriteBG=null,t.layerTitle=null,t.spriteTitleBG=null,t.labelTitle=null,t.layerContain=null,t.btnClose=null,t.isClilckBGClose=!1,t._windowFlag=0,t}return __extends(t,e),t.prototype.initData=function(e,t,i,n,a,r,s){void 0===n&&(n=!1),void 0===a&&(a=0),void 0===r&&(r=0),void 0===s&&(s=0),this.spriteBG.setContentSize(e,t),this.btnClose.setPosition(e/2-10,t/2-15),this.layerTitle.setPosition(0,t/2-25),this.layerTitle.active=!!i,i&&(this.labelTitle.string=i),this.isClilckBGClose=n,this.spriteMask.width=o.GlobalContext.UIWidth+500,this.spriteMask.height=o.GlobalContext.UIHeight,this.spriteMask.active=!0,this.spriteMask.on(cc.Node.EventType.TOUCH_START,this.onClickMask,this),a>0&&(this.spriteTitleBG.width=a),r>0&&(this.spriteTitleBG.height=r),this._windowFlag=s},t.prototype.show=function(){e.prototype.show.call(this),this.spriteMask&&this.spriteMask.on(cc.Node.EventType.TOUCH_START,this.onClickMask,this),this.onShowCloseTips()},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),this.spriteMask&&this.spriteMask.off(cc.Node.EventType.TOUCH_START,this.onClickMask,this)},t.prototype.onShowCloseTips=function(e){void 0===e&&(e=!1),this.labelCloseTips.active=e},t.prototype.setMaskActive=function(e){void 0===e&&(e=!0),this.spriteMask.active=e,this.spriteMask.opacity=1,this.spriteMask.scale=10,e&&this.spriteMask.runAction(cc.spawn(cc.scaleTo(.22,1),cc.fadeTo(.22,180)))},t.prototype.onResetTitle=function(e){this.labelTitle.string=e},t.prototype.onClickClose=function(){a.GameEventDispatcher.instance.emit(r.EventDefiner.CloseCommonPage4,this._windowFlag)},t.prototype.onClickMask=function(e){this.isClilckBGClose&&this.onClickClose()},__decorate([c(cc.Node)],t.prototype,"labelCloseTips",void 0),__decorate([c(cc.Node)],t.prototype,"spriteMask",void 0),__decorate([c(cc.Node)],t.prototype,"spriteBG",void 0),__decorate([c(cc.Node)],t.prototype,"layerTitle",void 0),__decorate([c(cc.Node)],t.prototype,"spriteTitleBG",void 0),__decorate([c(cc.RichText)],t.prototype,"labelTitle",void 0),__decorate([c(cc.Node)],t.prototype,"layerContain",void 0),__decorate([c(cc.Node)],t.prototype,"btnClose",void 0),t=__decorate([l],t)}(n.default);i.default=d,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Widget":"Widget","../../GlobalContext":"GlobalContext"}],WindowBg5:[function(e,t,i){"use strict";cc._RF.push(t,"6b19bMHg6hNhZnZbkF5iVVr","WindowBg5"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../GlobalContext"),a=e("./TabBtnList"),r=cc._decorator,s=r.ccclass,l=r.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.labelCloseTips=null,t.spriteMask=null,t.spriteBG=null,t.layerTitle=null,t.spriteTitleBG=null,t.labelTitle=null,t.layerContain=null,t.btnClose=null,t.TabBtnList=null,t.ListContainer_copy=null,t.isClilckBGClose=!1,t._windowFlag=0,t.backBtnClickCallback=null,t.backBtnClickCallbackThisObj=null,t}return __extends(t,e),t.prototype.initData=function(e,t,i,n,a,r,s){void 0===n&&(n=!1),void 0===a&&(a=0),void 0===r&&(r=0),void 0===s&&(s=0),this.spriteBG.setContentSize(e,t),this.spriteBG.setPosition(-50,-15),this.btnClose.setPosition(e/2-50,t/2-15),this.layerTitle.setPosition(-50,t/2-25-15);var l=this.labelCloseTips.position.x,c=this.labelCloseTips.position.y;this.labelCloseTips.setPosition(l-50,c-15),this.labelTitle.string=i,this.isClilckBGClose=n,this.spriteMask.width=o.GlobalContext.UIWidth+500,this.spriteMask.height=o.GlobalContext.UIHeight,this.spriteMask.active=!0,this.spriteMask.on(cc.Node.EventType.TOUCH_START,this.backBtnClick,this),a>0&&(this.spriteTitleBG.width=a),r>0&&(this.spriteTitleBG.height=r),this._windowFlag=s},t.prototype.show=function(){e.prototype.show.call(this),this.spriteMask&&this.spriteMask.on(cc.Node.EventType.TOUCH_START,this.backBtnClick,this),this.onShowCloseTips()},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),this.spriteMask&&this.spriteMask.off(cc.Node.EventType.TOUCH_START,this.backBtnClick,this)},t.prototype.onShowCloseTips=function(e){void 0===e&&(e=!1),this.labelCloseTips.active=e},t.prototype.setMaskActive=function(e){void 0===e&&(e=!0),this.spriteMask.active=e,this.spriteMask.opacity=1,this.spriteMask.scale=10,e&&this.spriteMask.runAction(cc.spawn(cc.scaleTo(.22,1),cc.fadeTo(.22,180)))},t.prototype.onResetTitle=function(e){this.labelTitle.string=e},t.prototype.backBtnClick=function(e){e.type==cc.Node.EventType.TOUCH_END&&this.backBtnClickCallback&&this.backBtnClickCallback.call(this.backBtnClickCallbackThisObj)},__decorate([l(cc.Node)],t.prototype,"labelCloseTips",void 0),__decorate([l(cc.Node)],t.prototype,"spriteMask",void 0),__decorate([l(cc.Node)],t.prototype,"spriteBG",void 0),__decorate([l(cc.Node)],t.prototype,"layerTitle",void 0),__decorate([l(cc.Node)],t.prototype,"spriteTitleBG",void 0),__decorate([l(cc.RichText)],t.prototype,"labelTitle",void 0),__decorate([l(cc.Node)],t.prototype,"layerContain",void 0),__decorate([l(cc.Node)],t.prototype,"btnClose",void 0),__decorate([l(a.default)],t.prototype,"TabBtnList",void 0),__decorate([l(cc.Node)],t.prototype,"ListContainer_copy",void 0),t=__decorate([s],t)}(n.default);i.default=c,cc._RF.pop()},{"../../Core/Widget":"Widget","../../GlobalContext":"GlobalContext","./TabBtnList":"TabBtnList"}],WindowManager:[function(e,t,i){"use strict";cc._RF.push(t,"c1b500AsIVHRYFwmHi7BqzP","WindowManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./LoadManager"),o=e("../GlobalContext"),a=e("./WindowType"),r=e("./ConfigsManager"),s=e("./Window"),l=e("./GameEventDispatcher"),c=e("./Event"),d=e("../Module/Scene/UIAnim/VariousAnim"),p=e("./Widget"),h=e("./PrefabCache"),u=e("../Global/GlobalValue"),f=e("./TimeController"),g=e("../Util/Utils"),y=e("../Module/Guide/GuideNewController"),m=cc._decorator,C=m.ccclass,v=(m.property,function(e){function t(){var t=e.call(this)||this;return t.Root=o.GlobalContext.Root,t._registerDic={},t._windowDic={},t._windowTimeDic={},t._windowTopShow={},t.unHides=[a.WindowType.RewardTips,a.WindowType.CardSynthesis,a.WindowType.HighLadderFighting,a.WindowType.SandTableWin,a.WindowType.ItemTipsWin,a.WindowType.RulePage,a.WindowType.ChatWin,a.WindowType.WorldBossRewardInfo,a.WindowType.SandTableCardSynthesis,a.WindowType.EquipEffect,a.WindowType.EquipRelpace,a.WindowType.BoxTips,a.WindowType.SandtableFunTip,a.WindowType.SandtableShapan,a.WindowType.RoleSkillTips,a.WindowType.FightBuffTips,a.WindowType.EquipTips,a.WindowType.CardRecommendOfficial],t._openWinTime=0,t}var i;return __extends(t,e),i=t,Object.defineProperty(t,"instance",{get:function(){return i._instance||(i._instance=new i,i._instance.init()),i._instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){this.clear(),this.register(),l.GameEventDispatcher.instance.on(c.EventDefiner.WindowClose,this.onWindowClose,this)},t.prototype.clear=function(){for(var e in this._registerDic={},this._windowDic){var t=this._windowDic[e];t&&(t.removeFromParent(!0),t.destroy())}this._windowDic={},this._windowTopShow={}},t.prototype.register=function(){this.registerWindow(a.WindowType.RoleUpgrading,"RoleUpgrading"),this.registerWindow(a.WindowType.CardSynthesis,"CardSynthesis"),this.registerWindow(a.WindowType.BatchUsageTips,"Tips/BatchUsageTips"),this.registerWindow(a.WindowType.RoleWin,"RoleWin"),this.registerWindow(a.WindowType.RoleSkinPage,"Role/RoleSkinPage"),this.registerWindow(a.WindowType.RoleStrengthen,"Role/RoleStrengthen/RoleStrengthenPage"),this.registerWindow(a.WindowType.RoleTitleWin,"Role/RoleTitle/RoleTitlePage"),this.registerWindow(a.WindowType.BagpackWin,"BagpackWin"),this.registerWindow(a.WindowType.WarTeam,"WarTeam"),this.registerWindow(a.WindowType.CardInfo,"WarTeamMonsterInfo"),this.registerWindow(a.WindowType.AssistFight,"Card/CardGroup/CardGroupView"),this.registerWindow(a.WindowType.CardGroupAttrTips,"Card/CardGroup/CardGroupAttrTips"),this.registerWindow(a.WindowType.SandTable,"sandTable"),this.registerWindow(a.WindowType.SandTableWin,"sandTable/SandTableWin"),this.registerWindow(a.WindowType.SandTableCardSynthesis,"sandTable/sandTableEffect/STCardSynthesis"),this.registerWindow(a.WindowType.ActivityWin,"ActivityHall/ActivityHallPage"),this.registerWindow(a.WindowType.TreasureMainView,"treasuremap/TreasureMainView"),this.registerWindow(a.WindowType.TreasureTroop,"treasuremap/TreasureTroop"),this.registerWindow(a.WindowType.TreasureResult,"treasuremap/TreasureResult"),this.registerWindow(a.WindowType.TreasureReward,"treasuremap/TreasureReward"),this.registerWindow(a.WindowType.TreasureShop,"treasuremap/TreasureShop"),this.registerWindow(a.WindowType.Decompose,"Decompose/DecomposeAndSyntheticView"),this.registerWindow(a.WindowType.Shop,"Shop"),this.registerWindow(a.WindowType.Expedition,"Expedition"),this.registerWindow(a.WindowType.ExpeditionReset,"Expedition/ExpeditionReset"),this.registerWindow(a.WindowType.ExpeditionMirror,"Expedition/ExpeditionMirror"),this.registerWindow(a.WindowType.ExpeditionRecord,"Expedition/ExpeditionRecord"),this.registerWindow(a.WindowType.WorldBoss,"WorldBoss"),this.registerWindow(a.WindowType.EliteBoss,"EliteBoss/EliteBoss"),this.registerWindow(a.WindowType.WorldBossRewardInfo,"WorldBossRewardInfo"),this.registerWindow(a.WindowType.ItemTipsWin,"Tips/ItemTips"),this.registerWindow(a.WindowType.PotentialTips,"Tips/potentialTips"),this.registerWindow(a.WindowType.FightResultExpedition,"FightResult/FightResultExpedition"),this.registerWindow(a.WindowType.FightResultTroop,"FightResult/FightResultTroop"),this.registerWindow(a.WindowType.RulePage,"commons/RulePage"),this.registerWindow(a.WindowType.FightResultWin,"FightResult/FightResultWin"),this.registerWindow(a.WindowType.FightDamageWin,"FightResult/FightDamageWin"),this.registerWindow(a.WindowType.ShopItemInfo,"shopinfo/ShopItemInfo"),this.registerWindow(a.WindowType.Mail,"Mail/MailView"),this.registerWindow(a.WindowType.SportsWin,"SportsWin"),this.registerWindow(a.WindowType.HighLadderWin,"Ladder/HighLadderWin"),this.registerWindow(a.WindowType.HighLadderFighting,"Ladder/HighLadderFighting"),this.registerWindow(a.WindowType.HighLadderReward,"Ladder/HighLadderReward"),this.registerWindow(a.WindowType.HighLadderSkill,"Ladder/HighLadderSkill"),this.registerWindow(a.WindowType.LadderFighTips,"Ladder/LadderFighTips"),this.registerWindow(a.WindowType.ChatWin,"Chat/ChatWin"),this.registerWindow(a.WindowType.FridBoss,"FridBoss/FridBossWin"),this.registerWindow(a.WindowType.FridBossResult,"FridBoss/FridBossResult"),this.registerWindow(a.WindowType.PlotWin,"PlotWin/PlotWin"),this.registerWindow(a.WindowType.Cmd,"Cmd"),this.registerWindow(a.WindowType.Arena,"Arena/ArenaWin"),this.registerWindow(a.WindowType.ArenaSingleResultWin,"Arena/ArenaSingleResultWin"),this.registerWindow(a.WindowType.ArenaResultWin,"Arena/ArenaResultNode"),this.registerWindow(a.WindowType.ArenaRewardInfo,"Arena/ArenaRewardInfoPage"),this.registerWindow(a.WindowType.Friends,"PartnerPanel"),this.registerWindow(a.WindowType.FriendBlackList,"Friend/FriendBlacklistPage"),this.registerWindow(a.WindowType.FriendSearchPage,"Friend/FriendSearchPage"),this.registerWindow(a.WindowType.FriendNews,"Friend/FriendsNewsWin"),this.registerWindow(a.WindowType.DailyQusest,"Daily/DailyQuest"),this.registerWindow(a.WindowType.RankList,"RankingList/RankingListView"),this.registerWindow(a.WindowType.RankListReward,"RankingList/RankRewardView"),this.registerWindow(a.WindowType.ReelWin,"ReelWin"),this.registerWindow(a.WindowType.DrawCard,"DrawCard/DrawCard"),this.registerWindow(a.WindowType.OpenFuncTips,"OpenFuncTips/OpenFuncTips"),this.registerWindow(a.WindowType.OpenFuncWin,"FunctionIcon/FunctionIconWin"),this.registerWindow(a.WindowType.Achievement,"Achievement"),this.registerWindow(a.WindowType.DiamondShop,"DiamondShop"),this.registerWindow(a.WindowType.DiamondInfo,"shopinfo/DiamondInfo"),this.registerWindow(a.WindowType.CardEquip,"Equip/EquipWin"),this.registerWindow(a.WindowType.EquipRelpace,"Equip/replaceWin"),this.registerWindow(a.WindowType.EquipEffect,"Equip/effectPre/effectNode"),this.registerWindow(a.WindowType.EquipTips,"Tips/EquipTips"),this.registerWindow(a.WindowType.Ornament,"Ornament/OrnamentView"),this.registerWindow(a.WindowType.Artifact,"Artifact/ArtifactView"),this.registerWindow(a.WindowType.ArtifactEffect,"Artifact/ArtifactEffect"),this.registerWindow(a.WindowType.ArtifactCollection,"ArtifactCollection/ArtifactCollection"),this.registerWindow(a.WindowType.RewardTips,"Tips/RewardTips"),this.registerWindow(a.WindowType.BoxTips,"Tips/BoxTips"),this.registerWindow(a.WindowType.VIP,"VIP/VipWin"),this.registerWindow(a.WindowType.VIPUPTips,"VIP/VipUPTips"),this.registerWindow(a.WindowType.VipAddCount,"VIP/VipAddCountWin"),this.registerWindow(a.WindowType.DailyCopy,"DailyCopy/DailyCopyWin"),this.registerWindow(a.WindowType.DailyCopyArtifact,"DailyCopy/DailyCopyWin"),this.registerWindow(a.WindowType.DailyCopyMoney,"DailyCopy/DailyCopyWin"),this.registerWindow(a.WindowType.DailyCopyRefine,"DailyCopy/DailyCopyWin"),this.registerWindow(a.WindowType.WorldBossResult,"worldBossResult"),this.registerWindow(a.WindowType.FightResultDailyCopy,"FightResult/FightResultDailyCopy"),this.registerWindow(a.WindowType.EquipCopyMain,"EquipCopy/EquipCopyWin"),this.registerWindow(a.WindowType.EquipCopyDifficulty,"EquipCopy/EquipCopyDifficulty/EquipCopyDifficultyPage"),this.registerWindow(a.WindowType.EquipCopyAttrShop,"EquipCopy/EquipCopyAttr/EquipCopyAttrPage"),this.registerWindow(a.WindowType.EquipCopyBox,"EquipCopy/EquipCopyBox/EquipCopyBoxPage"),this.registerWindow(a.WindowType.EquipCopyWipeBox,"EquipCopy/EquipCopyBox/EquipCopyBoxListPage"),this.registerWindow(a.WindowType.EquipCopyWipeAttr,"EquipCopy/EquipCopyAttrAdd/EquipCopyAttrAddPage"),this.registerWindow(a.WindowType.EquipCopyWipeResult,"EquipCopy/EquipCopyWipe/EquipCopyWipeResult"),this.registerWindow(a.WindowType.EquipCopyWipeWin,"EquipCopy/EquipCopyWipe/EquipCopyWipeWin"),this.registerWindow(a.WindowType.FightResultEquipCopy,"FightResult/FightResultEquipCopy"),this.registerWindow(a.WindowType.ChapterSouring,"WipeOutWin"),this.registerWindow(a.WindowType.Totems,"Totems/TotemsWin"),this.registerWindow(a.WindowType.TotemsUpgrade,"Totems/TotemsUpgradeWin"),this.registerWindow(a.WindowType.TotemsClear,"Totems/TotemsClearWin"),this.registerWindow(a.WindowType.GiftBagWin,"Bag/GiftBagWin"),this.registerWindow(a.WindowType.ActivityView,"ActivityView/ActivityView"),this.registerWindow(a.WindowType.LoopActivity,"ActivityView/ActivityView"),this.registerWindow(a.WindowType.MergeServer,"ActivityView/ActivityView"),this.registerWindow(a.WindowType.TotemsCopy,"TotemsCopy/TotemsCopyWin"),this.registerWindow(a.WindowType.WelfareLobby,"welfarelobby/welfarelobby"),this.registerWindow(a.WindowType.BaiBeiFanLi,"ActivityView/BaiBeiFanLiWin"),this.registerWindow(a.WindowType.RechargeWin,"rechargecarnival/rechargecarnival"),this.registerWindow(a.WindowType.RoleAddProductEffect,"Role/RoleAddProductEffectWin"),this.registerWindow(a.WindowType.RoleSkillTips,"Role/RoleSkillTips"),this.registerWindow(a.WindowType.FightInfo,"ChapterMapView/FightInfo"),this.registerWindow(a.WindowType.OneSeckill,"OneSeckill/OneSeckill"),this.registerWindow(a.WindowType.ChapterReward,"ChapterMapView/GetRewardNode"),this.registerWindow(a.WindowType.ChapterRewardWin,"ChapterReward/ChapterRewardWin"),this.registerWindow(a.WindowType.ChapterRewardTips,"ChapterReward/ChapterRewardTips"),this.registerWindow(a.WindowType.AcquistionPathWin,"AcquistionPath/AcquistionPathWin"),this.registerWindow(a.WindowType.BossCommingWin,"Chapter/BossComming"),this.registerWindow(a.WindowType.FightBuffTips,"fightinfopanel/FightBuffTips"),this.registerWindow(a.WindowType.ExpCopy,"ExpCopy/ExpCopyWin"),this.registerWindow(a.WindowType.UseItemWin,"ItemUserTips/UseItemWin"),this.registerWindow(a.WindowType.FeedBack,"FeedBackWin"),this.registerWindow(a.WindowType.CardRecommend,"Card/CardRecommended"),this.registerWindow(a.WindowType.CardRecommendOfficial,"Card/CardRecommendOfficialWin"),this.registerWindow(a.WindowType.CardSynthesisEnd,"CardSynthesisEnd"),this.registerWindow(a.WindowType.SandtableShapan,"sandTable/SandtableShapan"),this.registerWindow(a.WindowType.SandtableFunTip,"sandTable/SandtableFunTip"),this.registerWindow(a.WindowType.SevenDayTarget,"SevenDayTarget/SevenDayTargetWin"),this.registerWindow(a.WindowType.SevenDayTargetRank,"SevenDayTarget/SevenDayTargetRankWin"),this.registerWindow(a.WindowType.SingleRechargeRebate,"ActivityView/NewActivity/SingleRechargeRebate"),this.registerWindow(a.WindowType.RoleHeadSetUp,"Role/RoleHeadSetUpWin"),this.registerWindow(a.WindowType.SettingWin,"setting/setting"),this.registerWindow(a.WindowType.NickNameChange,"setting/NicknameChange"),this.registerWindow(a.WindowType.SettingWin,"setting/setting"),this.registerWindow(a.WindowType.NickNameChange,"setting/NicknameChange"),this.registerWindow(a.WindowType.Mine,"Mine/MineWin"),this.registerWindow(a.WindowType.MineNews,"Mine/MineNewsWin"),this.registerWindow(a.WindowType.MineJournal,"Mine/MineJournalWin"),this.registerWindow(a.WindowType.MineInteractive,"Mine/MineInteractiveWin"),this.registerWindow(a.WindowType.MineHelp,"Mine/MineHelpWin"),this.registerWindow(a.WindowType.LoardCrusadeWin,"LoardCrusade/LoardCrusadeWin"),this.registerWindow(a.WindowType.LoardCrusadeReward,"LoardCrusade/LoardRewardWin"),this.registerWindow(a.WindowType.DevilResult,"LoardCrusade/DevilResult"),this.registerWindow(a.WindowType.devilNewsWin,"LoardCrusade/DevilNewsWin"),this.registerWindow(a.WindowType.EliteBossOpenTipsWin,"EliteBoss/EliteBossOpenTips"),this.registerWindowTop("RoleWin"),this.registerWindowTop("RoleStrengthen"),this.registerWindowTop("RoleTitleWin"),this.registerWindowTop("BagpackWin"),this.registerWindowTop("WarTeamMonsterInfo"),this.registerWindowTop("DiamondShop"),this.registerWindowTop("OrnamentView"),this.registerWindowTop("TreasureShop"),this.registerWindowTop("TotemsWin"),this.registerWindowTop("ExpCopyWin"),this.registerWindowTop("DailyCopyWin"),this.registerWindowTop("RoleSkillTips")},t.prototype.registerWindow=function(e,t,i,n,o){void 0===i&&(i=null),void 0===n&&(n=null),void 0===o&&(o=!1),t=this.Root+"prefab/"+t,this._registerDic[e]={windowType:e,resUrl:t,dependsUrls:i,configNames:n,showTopPanel:o}},t.prototype.registerWindowTop=function(e){this._windowTopShow[e]={windowName:e}},t.prototype.isWindowTopShow=function(e){return!!this._windowTopShow[e]},t.prototype.getWindow=function(e){return this._windowDic[e]},t.prototype.open=function(e,t,i,a){var r=this;void 0===t&&(t=null),void 0===i&&(i=null),void 0===a&&(a=null);var s=e,l=t,c=i,d=a;(function(){if(r._windowDic[s])r.openWindow(r._windowDic[s],s,l,c,d);else if(r._registerDic[s]){var t=r._registerDic[s].resUrl,i=[t],a=r._registerDic[s].configNames;if(a&&a.length>0)for(var p=0;p<a.length;p++)i.push(r.Root+"configs/"+a[p]+".json");r._openWinTime=Date.now(),console.log("\u5f00\u59cb\u52a0\u8f7d\u7a97\u53e3:"+e+", time:"+r._openWinTime),o.GlobalContext.ItemLoading.active||(o.GlobalContext.ItemLoading.active=!0),n.default.instance.loadResByType(t,cc.Prefab,r.loadComplete,r,[s,l,c,d,t],r.loadProgress,r,[s])}})()},t.prototype.closeAll=function(e){void 0===e&&(e=0);for(var t=o.PlayerData.WindowLayer.childrenCount-1;t>=0;t--)this.closeWindow(o.PlayerData.WindowLayer.children[t],e)},t.prototype.hideAll=function(e){void 0===e&&(e=0);for(var t=0;t<o.PlayerData.WindowLayer.childrenCount;t++)o.PlayerData.WindowLayer.children[t].active=!1},t.prototype.showAll=function(e){void 0===e&&(e=0);for(var t=0;t<o.PlayerData.WindowLayer.childrenCount;t++)o.PlayerData.WindowLayer.children[t].active=!0},t.prototype.closeWindow=function(e,t){for(var i in void 0===t&&(t=0),this._windowDic){var n=!1;if(t&&(n=t==Number(i)),e==this._windowDic[i]&&!n){this.close(Number(i)),d.default.instance.initInfo(!0);break}}},t.prototype.close=function(e){if(this._windowDic[e]){var t=this._windowDic[e];if(t.removeFromParent(!1),t.active=!1,o.PlayerData.TopPanel){if(o.PlayerData.WindowLayer.childrenCount>=1){for(var i=o.PlayerData.WindowLayer.children[o.PlayerData.WindowLayer.childrenCount-1],n=void 0,a=1;a<=3;a++)(n=o.PlayerData.WindowLayer.children[o.PlayerData.WindowLayer.childrenCount-a])&&(n.active=!0);var r=i.name;this._windowTopShow[r]?o.PlayerData.TopLayer.active=!0:o.PlayerData.TopLayer.active=!1}else o.PlayerData.GameLayer.insertChild(o.PlayerData.TopPanel,o.PlayerData.GameLayer.childrenCount),l.GameEventDispatcher.instance.emit(c.EventDefiner.PlayerWealthBG,!1),o.PlayerData.TopLayer.active=!0;this._windowTimeDic[e]=Date.now();var s=o.PlayerData.WindowLayer.childrenCount;s>0&&this.setWindowLayerSpineBase(s-1,s,!0)}l.GameEventDispatcher.instance.emit(c.EventDefiner.WindowCloselink,e),this.checkWindowDestroy()}},t.prototype.checkWindowDestroy=function(){var e=Date.now(),t=u.CACHE_DISPOS_TIME;for(var i in this._windowTimeDic){var n=Number(this._windowTimeDic[i]);n>0&&e-n>t&&(console.log("\u7a97\u53e3\u6ca1\u7528\u4e86\uff0c\u53ef\u4ee5\u9500\u6bc1\u4e86, windowType:"+i),this.destroyWindow(Number(i)),this._windowTimeDic[i]=null,delete this._windowTimeDic[i])}},t.prototype.isOpenWindow=function(e){return!!this._windowDic[e]&&this._windowDic[e].active},t.prototype.haveWindow=function(e){var t=!!this._windowDic[e]&&this._windowDic[e].active;return t=t||n.default.instance.isLoading(this._registerDic[e].resUrl)},t.prototype.destroyWindow=function(e){if(this._windowDic[e]){console.log("\u9500\u6bc1\u754c\u9762, windowType:"+e);var t=this._windowDic[e],i=t.getComponent(s.default);i?i.dispose():t.getComponent(p.default)?t.getComponent(p.default).dispose():t.destroy(),t.getComponent(h.default)&&t.getComponent(h.default).dispose(),this._windowDic[e]=null,delete this._windowDic[e];this._registerDic[e].resUrl}},t.prototype.loadComplete=function(e,t,i,n,a,r){var s=this;void 0===i&&(i=null),void 0===n&&(n=null),void 0===a&&(a=null),void 0===r&&(r=""),o.GlobalContext.ItemLoading.active=!1,this._windowDic[t]||(this._windowDic[t]=g.default.getNodeByUrl(e,r));var l=Date.now();console.log("\u52a0\u8f7d\u7a97\u53e3\u5b8c\u6210:"+t+", time:"+this._openWinTime+", costTime:"+(l-this._openWinTime)),this._openWinTime=l;var c=f.default.instance.setTimeout(function(){s.openWindow(s._windowDic[t],t,i,n,a),f.default.instance.clearTimeout(c)},this,500)},t.prototype.loadComplete2=function(e,t,i,n,a){var s=this;void 0===i&&(i=null),void 0===n&&(n=null),void 0===a&&(a=null),o.GlobalContext.ItemLoading.active=!1;var l=e[0],c=cc.instantiate(l);if(this._windowDic[t]=c,e.length>1){var d=this._registerDic[t].configNames;if(d&&d.length>0)for(var p=1;p<=d.length;p++)p<e.length&&r.ConfigsManager.instance.setConfigs(d[p-1],e[p])}console.log("\u52a0\u8f7d\u7a97\u53e3\u5b8c\u6210,",t);var h=f.default.instance.setTimeout(function(){s.openWindow(c,t,i,n,a),f.default.instance.clearTimeout(h)},this,1e3)},t.prototype.loadProgress=function(e,t,i,n){t>0&&(o.GlobalContext.ItemLoading.active=!0)},t.prototype.openWindow=function(e,t,i,n,r){if(void 0===i&&(i=null),void 0===n&&(n=null),void 0===r&&(r=null),y.default.instance.isGuide){var s=y.default.instance.vo;s&&s.curstep&&void 0!==s.curstep.windowtype&&a.WindowType.PlotWin!=t&&s.curstep.windowtype!=t&&-1!=s.curstep.windowtype&&y.default.instance.curGuideSkip()}if(o.PlayerData.TopPanel){var d=e.name;this._windowTopShow[d]?(o.PlayerData.TopLayer.insertChild(o.PlayerData.TopPanel,o.PlayerData.TopLayer.childrenCount),l.GameEventDispatcher.instance.emit(c.EventDefiner.PlayerWealthBG,!0),o.PlayerData.TopLayer.active=!0):o.PlayerData.TopLayer.active=!1}e.active=!0;var p=o.PlayerData.WindowLayer;if(i)var h=f.default.instance.setTimeout(function(){var t=[e];r&&(t=t.concat(r)),i.apply(n,t),f.default.instance.clearTimeout(h)},this,50);if(!p.getChildByName(e.name)){p.insertChild(e,p.childrenCount),this.hideSubstratumWindow(e);var u=0;p==o.PlayerData.WindowLayer&&-1==this.unHides.indexOf(t)?o.PlayerData.WindowLayer.childrenCount&&(u=o.PlayerData.WindowLayer.childrenCount-1,this.setWindowLayerSpineBase(0,u,!1),this.setWindowLayerSpineBase(u,u+1,!0)):u=o.PlayerData.WindowLayer.childrenCount,this._windowTimeDic[t]=0,l.GameEventDispatcher.instance.emit(c.EventDefiner.WindowOpenlink,t),this.checkWindowDestroy()}},t.prototype.onWindowClose=function(e){var t=Number(e.getUserData());this.close(t)},t.prototype.setWindowLayerSpineBase=function(e,t,i){for(var n=o.PlayerData.WindowLayer,a=e;a<t;a++){var r=n.children[a].getComponentsInChildren("SpineBase");if(r&&r.length>0)for(var s=r.length-1;s>=0;s--){var l=r[s].node;0==i?1==l.active&&(l.active=!1):0==l.active&&(l.active=!0)}}},t.prototype.hideSubstratumWindow=function(e){var t=e.getComponent(s.default);if(t&&1==t.WindowType)for(var i=0;i<o.PlayerData.WindowLayer.childrenCount-1;i++){var n=o.PlayerData.WindowLayer.children[i];n.getComponent(s.default)&&i>=3&&(n.attr({show:!0}),n.active=!1)}},t=i=__decorate([C],t)}(cc.Component));i.default=v,cc._RF.pop()},{"../Global/GlobalValue":"GlobalValue","../GlobalContext":"GlobalContext","../Module/Guide/GuideNewController":"GuideNewController","../Module/Scene/UIAnim/VariousAnim":"VariousAnim","../Util/Utils":"Utils","./ConfigsManager":"ConfigsManager","./Event":"Event","./GameEventDispatcher":"GameEventDispatcher","./LoadManager":"LoadManager","./PrefabCache":"PrefabCache","./TimeController":"TimeController","./Widget":"Widget","./Window":"Window","./WindowType":"WindowType"}],WindowOpenUtils:[function(e,t,i){"use strict";cc._RF.push(t,"fd5c2nqKBtKyr32lqfW2aXO","WindowOpenUtils"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/WindowType"),o=e("../OpenWin/OpenWinController"),a=e("../Role/RoleWin"),r=e("../Role/RoleConst"),s=e("../Functionicon/FunctionIconController"),l=e("../WarTeam/MonsterController"),c=e("../Activity/ActivityController"),d=e("../Tips/OpTipsController"),p=e("../../Core/GameEventDispatcher"),h=e("../../Core/Event"),u=e("../Status/StatusType"),f=e("../TreasureMap/TreasureMapController"),g=e("../../Core/Language"),y=e("../DailyCopy/DailyCopyCtrl"),m=e("../DailyCopy/DailyCopyConst"),C=e("../Shop/Shop"),v=e("../Shop/ShopController"),_=e("../Totems/TotemsWin"),b=e("../../Core/TimeController"),T=e("../welfarelobby/welfarelobby"),S=e("../welfarelobby/welfarelobbyConst"),I=e("../DrawCard/DrawController"),w=e("../ExpCopy/ExpCopyCtrl"),D=e("../Decompose/DecomposeAndSyntheticView"),R=e("../Mine/MineCtrl"),A=cc._decorator,N=A.ccclass,L=(A.property,function(){function e(){}var t;return t=e,Object.defineProperty(e,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),e.prototype.openWindowType=function(e,t){var i=this;void 0===t&&(t=0);for(var A=[],N=2;N<arguments.length;N++)A[N-2]=arguments[N];if(s.default.instance.checkIsOpenbyWindowtype(e,!0))if(e>=n.WindowType.WelfareLobby_ZX&&e<=n.WindowType.WelfareLobby_LB)o.default.instance.openWindow(n.WindowType.WelfareLobby,function(){var t=null;switch(e){case n.WindowType.WelfareLobby_ZX:t=S.welfarelobbyConst.welfareOnlineReward;break;case n.WindowType.WelfareLobby_QD:break;case n.WindowType.WelfareLobby_DC:t=S.welfarelobbyConst.DailyMeal;break;case n.WindowType.WelfareLobby_TZ:t=S.welfarelobbyConst.InvestmentPlan;break;case n.WindowType.WelfareLobby_TQ:t=S.welfarelobbyConst.PrivilegeCard;break;case n.WindowType.WelfareLobby_LB:t=S.welfarelobbyConst.vipGiftbag}var o=T.default.instance.returnIndex(t),a=b.default.instance.setTimeout(function(){T.default.instance.selectItem(o),b.default.instance.clearTimeout(a)},i,100)});else switch(e){case 1:p.GameEventDispatcher.instance.emit(h.EventDefiner.ChangeActivityStatus,u.ActivityStatus.Chapter);break;case 0:p.GameEventDispatcher.instance.emit(h.EventDefiner.ChangeActivityStatus,u.ActivityStatus.NoActivity);break;case n.WindowType.ChapterSouring:p.GameEventDispatcher.instance.emit(h.EventDefiner.ChangeActivityStatus,u.ActivityStatus.Chapter),o.default.instance.openWindow(n.WindowType.ChapterSouring,function(){},this);break;case n.WindowType.RoleTrain:o.default.instance.openWindow(n.WindowType.RoleWin,function(){a.default.instance.onInitData(r.RolePageType.Culture)},this);break;case n.WindowType.RoleGpUp:o.default.instance.openWindow(n.WindowType.RoleWin,function(){a.default.instance.onInitData(r.RolePageType.AddProduct)},this);break;case n.WindowType.Synthesis:if(s.default.instance.checkIsOpenbyWindowtype(n.WindowType.Refine,!0))return;o.default.instance.openWindow(n.WindowType.Decompose,function(e){e.getComponent(D.default).setTagIndex(1)},this);break;case n.WindowType.CardSkill:case n.WindowType.CardUpgrade:case n.WindowType.CardStage:case n.WindowType.CardEquip:case n.WindowType.Strengthen:case n.WindowType.UpgradeStage:case n.WindowType.Gemstone:case n.WindowType.Refine:var L=3;switch(e){case n.WindowType.CardUpgrade:case n.WindowType.CardStage:L=1;break;case n.WindowType.CardSkill:L=2}var E=0,B=0;A&&A.length>0&&(E=A[0],A[1]&&(B=A[1])),o.default.instance.openWindow(n.WindowType.WarTeam,function(){l.default.instance.openMonsterInfoPrefab(l.MonsterType.MonsterWarTeam[l.MonsterType.MonsterBattle][E],L,null,null,null,!1,3==L?e:null,3==L?B:null)},this);break;case n.WindowType.WorldBoss:null==c.default.instance.actstatusArr[1]||0==c.default.instance.actstatusArr[1].status||3==c.default.instance.actstatusArr[1].status?d.default.instance.ShowMsg("\u6d3b\u52a8\u672a\u5f00\u653e"):1!=c.default.instance.actstatusArr[1].status&&2!=c.default.instance.actstatusArr[1].status||p.GameEventDispatcher.instance.emit(h.EventDefiner.ChangeActivityStatus,u.ActivityStatus.WorldBoss);break;case n.WindowType.EliteBoss:u.ActivityStatus.value=u.ActivityStatus.EliteBoss;var M=c.default.instance;null==M.actstatusArr[2]||0==M.actstatusArr[2].status||3==M.actstatusArr[2].status?d.default.instance.ShowMsg("\u6d3b\u52a8\u672a\u5f00\u653e"):o.default.instance.openWindow(n.WindowType.EliteBoss);break;case n.WindowType.FridBoss:p.GameEventDispatcher.instance.emit(h.EventDefiner.ChangeActivityStatus,u.ActivityStatus.FridBoss),c.default.instance.isFrist=!1;break;case n.WindowType.Arena:p.GameEventDispatcher.instance.emit(h.EventDefiner.ChangeActivityStatus,u.ActivityStatus.Arena);break;case n.WindowType.HighLadderWin:p.GameEventDispatcher.instance.emit(h.EventDefiner.ChangeActivityStatus,u.ActivityStatus.HighLadder);break;case n.WindowType.Expedition:p.GameEventDispatcher.instance.emit(h.EventDefiner.ChangeActivityStatus,u.ActivityStatus.Expedition);break;case n.WindowType.TreasureMainView:f.default.instance.onCheckCanEnter()?f.default.instance.sendGetTreasureLayerInfo():d.default.instance.ShowMsg(g.default.getStr("strong_enter_error"));break;case n.WindowType.EquipCopyMain:p.GameEventDispatcher.instance.emit(h.EventDefiner.ChangeActivityStatus,u.ActivityStatus.EquipCopy);break;case n.WindowType.DailyCopy:y.default.instance.getOpen(m.DailyCopyType.Gem)?y.default.instance.setSelectCopyIndex(m.DailyCopyType.Gem):y.default.instance.openShowMsgUnclock(m.DailyCopyType.Gem);break;case n.WindowType.DailyCopyRefine:y.default.instance.getOpen(m.DailyCopyType.Refine)?y.default.instance.setSelectCopyIndex(m.DailyCopyType.Refine):y.default.instance.openShowMsgUnclock(m.DailyCopyType.Refine);break;case n.WindowType.DailyCopyArtifact:y.default.instance.getOpen(m.DailyCopyType.Artifact)?y.default.instance.setSelectCopyIndex(m.DailyCopyType.Artifact):y.default.instance.openShowMsgUnclock(m.DailyCopyType.Artifact);break;case n.WindowType.DailyCopyMoney:y.default.instance.getOpen(m.DailyCopyType.Money)?y.default.instance.setSelectCopyIndex(m.DailyCopyType.Money):y.default.instance.openShowMsgUnclock(m.DailyCopyType.Money);break;case n.WindowType.DrawCardUltima:case n.WindowType.DrawCardHight:case n.WindowType.DrawCard:I.default.instance.setChooseIndex(e),o.default.instance.openWindow(n.WindowType.DrawCard);break;case n.WindowType.ExpCopy:case n.WindowType.ExpCopyPlain:case n.WindowType.ExpCopyBump:case n.WindowType.ExpCopyNightmare:case n.WindowType.ExpCopyInfernal:w.default.instance.setChooseIndex(e,t);break;case n.WindowType.Shop:o.default.instance.openWindow(n.WindowType.Shop,function(){var e=v.default.instance.nowSortIndex[t]?v.default.instance.nowSortIndex[t]:0;C.default.instance.TabBtnList2.selectItem(e)},this);break;case n.WindowType.TotemsCopy:p.GameEventDispatcher.instance.emit(h.EventDefiner.ChangeActivityStatus,u.ActivityStatus.TotemsCopy);break;case n.WindowType.Totems:o.default.instance.openWindow(n.WindowType.Totems,function(){_.default.instance.onInitData(t)},this);break;case n.WindowType.Artifact:o.default.instance.openWindow(e);break;case n.WindowType.ExpCopy:p.GameEventDispatcher.instance.emit(h.EventDefiner.ChangeActivityStatus,u.ActivityStatus.ExpCopy);break;case n.WindowType.WelfareLobby:o.default.instance.openWindow(n.WindowType.WelfareLobby,function(){var e=b.default.instance.setTimeout(function(){T.default.instance.selectItem(t),b.default.instance.clearTimeout(e)},i,100)});break;case n.WindowType.Mine:p.GameEventDispatcher.instance.emit(h.EventDefiner.ChangeActivityStatus,u.ActivityStatus.Mine),R.default.instance.openTime();break;case n.WindowType.LoardCrusadeWin:p.GameEventDispatcher.instance.emit(h.EventDefiner.ChangeActivityStatus,u.ActivityStatus.LoardCrusade);break;default:o.default.instance.openWindow(e)}},e=t=__decorate([N],e)}());i.default=L,cc._RF.pop()},{"../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/TimeController":"TimeController","../../Core/WindowType":"WindowType","../Activity/ActivityController":"ActivityController","../DailyCopy/DailyCopyConst":"DailyCopyConst","../DailyCopy/DailyCopyCtrl":"DailyCopyCtrl","../Decompose/DecomposeAndSyntheticView":"DecomposeAndSyntheticView","../DrawCard/DrawController":"DrawController","../ExpCopy/ExpCopyCtrl":"ExpCopyCtrl","../Functionicon/FunctionIconController":"FunctionIconController","../Mine/MineCtrl":"MineCtrl","../OpenWin/OpenWinController":"OpenWinController","../Role/RoleConst":"RoleConst","../Role/RoleWin":"RoleWin","../Shop/Shop":"Shop","../Shop/ShopController":"ShopController","../Status/StatusType":"StatusType","../Tips/OpTipsController":"OpTipsController","../Totems/TotemsWin":"TotemsWin","../TreasureMap/TreasureMapController":"TreasureMapController","../WarTeam/MonsterController":"MonsterController","../welfarelobby/welfarelobby":"welfarelobby","../welfarelobby/welfarelobbyConst":"welfarelobbyConst"}],WindowType:[function(e,t,i){"use strict";cc._RF.push(t,"0ea69us+Q9Jnor214ih8nH+","WindowType"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(){}return e.ItemTipsWin=2,e.Cmd=3,e.BatchUsageTips=4,e.RoleWin=10100,e.RoleTrain=10120,e.RoleGpUp=10130,e.RoleStrengthen=10140,e.RoleSkinPage=10150,e.RoleSkillTips=10151,e.RoleHeadSetUp=10152,e.RoleAddProductEffect=10101,e.RoleTitleWin=10110,e.BagpackWin=10200,e.GiftBagWin=10250,e.WarTeam=10300,e.AssistFight=10310,e.CardGroupAttrTips=10320,e.VIP=10400,e.VIPUPTips=10401,e.VipAddCount=10402,e.RankList=10500,e.RankListReward=10510,e.Shop=20100,e.ShopItemInfo=20101,e.ActivityWin=20300,e.TreasureShop=20360,e.TreasureMainView=20370,e.TreasureTroop=20380,e.TreasureResult=20390,e.TreasureReward=20350,e.SandTable=20400,e.SandTableWin=20401,e.SandtableShapan=20402,e.SandtableFunTip=20403,e.SandTableCardSynthesis=20410,e.Mail=20500,e.Friends=20550,e.FriendBlackList=20551,e.FriendSearchPage=20552,e.FriendNews=20553,e.DailyQusest=20700,e.DrawCard=20900,e.DrawCardHight=20901,e.DrawCardUltima=20902,e.RewardTips=20910,e.BoxTips=20920,e.Achievement=21e3,e.DiamondShop=22e3,e.DiamondInfo=22001,e.Decompose=23e3,e.Synthesis=23100,e.Expedition=30100,e.ExpeditionReset=30110,e.ExpeditionMirror=30120,e.ExpeditionRecord=30130,e.CardInfo=30200,e.CardSkill=10410,e.CardUpgrade=10308,e.CardStage=10309,e.CardEquip=60100,e.CardInherit=10600,e.CardInheritTips=10601,e.SportsWin=30300,e.HighLadderWin=30400,e.HighLadderSkill=30401,e.WorldBoss=30500,e.WorldBossRewardInfo=30501,e.EliteBoss=30600,e.EliteBossOpenTipsWin=30601,e.HighLadderFighting=30700,e.HighLadderReward=30701,e.LadderFighTips=30702,e.Arena=30800,e.ArenaResultWin=30801,e.ArenaSingleResultWin=30802,e.ArenaRewardInfo=30803,e.FridBoss=30900,e.FridBossResult=30901,e.ChatWin=31e3,e.OpenFuncTips=31200,e.OpenFuncWin=31201,e.PlotWin=31300,e.ReelWin=40100,e.EquipRelpace=51e3,e.EquipTips=51100,e.Strengthen=60110,e.UpgradeStage=60120,e.Gemstone=60130,e.Refine=60140,e.Ornament=61e3,e.OrnamentUpgrade=61100,e.OrnamentUpStage=61200,e.ChangeAttr=54e3,e.GrailMap=55e3,e.Artifact=56e3,e.ArtifactEffect=56001,e.ArtifactCollection=56100,e.DailyCopy=57e3,e.DailyCopyRefine=57001,e.DailyCopyArtifact=57002,e.DailyCopyMoney=57003,e.FightResultDailyCopy=57100,e.EquipCopyMain=59e3,e.EquipCopyDifficulty=59100,e.EquipCopyAttrShop=59101,e.EquipCopyBox=59300,e.EquipCopyWipeBox=59400,e.EquipCopyWipeAttr=59500,e.EquipCopyWipeResult=59600,e.EquipCopyWipeWin=59601,e.FightResultEquipCopy=59700,e.Totems=58100,e.TotemsUpgrade=58101,e.TotemsClear=58102,e.TotemsCopy=58103,e.ExpCopy=59200,e.ExpCopyPlain=59201,e.ExpCopyBump=59202,e.ExpCopyNightmare=59203,e.ExpCopyInfernal=59204,e.FeedBack=60001,e.RoleUpgrading=90100,e.CardSynthesis=90200,e.EquipEffect=90201,e.CardSynthesisEnd=90202,e.FightResultWin=90400,e.FightBuffTips=90401,e.WorldBossResult=90500,e.FightResultExpedition=90600,e.FightResultTroop=90700,e.RulePage=90800,e.PotentialTips=90801,e.ChapterSouring=90900,e.WelfareLobby=60200,e.WelfareLobby_ZX=60201,e.WelfareLobby_QD=60202,e.WelfareLobby_DC=60203,e.WelfareLobby_TZ=60204,e.WelfareLobby_TQ=60205,e.WelfareLobby_LB=60207,e.WelfareLobby_DH=60208,e.WelfareLobby_GGB=60209,e.ActivityView=7e4,e.BaiBeiFanLi=70001,e.HalfPrice=70002,e.SevenDayLogin=70003,e.ActiveBack=70005,e.SevenDayGoal=7999006,e.SevenDayRanking=70007,e.FristCharge=70008,e.GroupPurchase=70009,e.SevenDayTarget=70006,e.SevenDayTargetRank=81011,e.Loop_FristCharge=70012,e.Loop_GroupPurchase=70013,e.SingleRechargeRebate=70011,e.Loop_ActiveBack=70015,e.Loop_HalfPrice=70014,e.LoopActivity=79997,e.MergeServer=79998,e.MaxActivityID=79999,e.FactionWin=60300,e.InviteWin=60360,e.RechargeWin=60400,e.FightInfo=60500,e.OneSeckill=60600,e.ChapterReward=60700,e.ChapterRewardWin=60710,e.ChapterRewardTips=60720,e.AcquistionPathWin=60800,e.BossCommingWin=60900,e.UseItemWin=8e4,e.CardRecommend=80001,e.CardRecommendOfficial=80002,e.SettingWin=80003,e.NickNameChange=80004,e.Mine=82001,e.MineJournal=82002,e.MineNews=82003,e.MineInteractive=82004,e.MineHelp=82005,e.FightDamageWin=86e3,e.LoardCrusadeWin=87e3,e.LoardCrusadeReward=87001,e.DevilResult=87002,e.devilNewsWin=87003,e}();i.WindowType=n;var o=function(){function e(){}return e.ComboBoxListItem=1,e.OpTipsItem=2,e.SpriteItem=3,e.MoneyEffectCoinItem=4,e.MoneyEffectGoldItem=5,e.MoneyEffectGuardItem=6,e.FlagItem=7,e.BarrageTipsItem=8,e.MoneyEffectPowerItem=9,e.ChatContent_MySelf=10,e.ChatContent_OtherSelf=11,e.MonsterPreview=12,e.ItemIcon=13,e.TalentRichText=14,e.SkillEffect=15,e.activityIcon=16,e.rewardActivityIcon=17,e.inviteIcon=18,e.arenaReward=19,e.EmailContent=20,e.MotionStreakEffectItem=21,e.BuffCell=22,e.CardGiftNode=23,e.BossNode=24,e.BuffTip=25,e.equipTypeNode=26,e.rangeTypeNode=27,e.TreasureNode=30,e.ChatNotice=32,e.CommonPageBG=33,e.ArenaFace=34,e.TotemsAttrThanItem=36,e.TotemsClearItem=37,e.TotemsGiftedPlayertItem=38,e.TotemsStrengthenItem=39,e.TotemsTalentItem=40,e.TotemsUnlockItem=41,e.TotemsAdvancedItem=42,e.TotemsAttrItem=43,e.TotemsCopyItem=47,e.TotemsCopyMonsterItem=48,e.DailySigninItem=49,e.DailyBoxItem=50,e.welfareOnlineRewardItem=51,e.RoleAttrItem=52,e.RoleClearItem=53,e.RoleAddAttrItem=54,e.RankItem=55,e.TerritoryWarItem=56,e.TerritoryWarPageItem=57,e.TerritoryWarRecordItem=58,e.TerritoryWarNewItem=59,e.ChannelItem=60,e.FriendPrefab=61,e.RecommendPrefab=62,e.ExpCopyToggleItem=63,e.ExpCopyPassItem=64,e.MorphologicalTags=65,e.FightBuffItem=66,e.FightActiveSkill=67,e.SevenDayTargetToggleItem=68,e.SevenDayTargetItem=69,e.SevenDayTargetTaskItem=70,e.ArtifactAttrItem=71,e.ArtifactEffectItem=72,e.ArtifactEquip=73,e.SevenDayTargetRewardItem=74,e.SevenDayTargetRankItem=75,e.CardNews=76,e.CardRecommendOfficialItem=77,e.RoleHeadSetUpItem=78,e}();i.PoolType=o,cc._RF.pop()},{}],Window:[function(e,t,i){"use strict";cc._RF.push(t,"daed3eG6c5CGqMkcyZzrgsT","Window"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./WindowManager"),o=e("./Widget"),a=e("../GlobalContext"),r=e("./LoadManager"),s=e("../Module/Commons/WindowBg1"),l=e("../Module/Commons/Image"),c=e("../Util/Utils"),d=e("../Module/Commons/WindowBg5"),p=cc._decorator,h=p.ccclass,u=p.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.BgUrl="",t.BgName="",t.WindowType=0,t.Title=null,t.Container=null,t.TabBtnNames=[],t.TabViews=[],t.TabBtnLocation="0,20",t.ShowWindowBg=!0,t.ShowWindowLeftBgH=90,t.ShowWindowLeftBg=!1,t.ShowBg=!0,t.MaskBg=!0,t.WinWeight="0",t.WinHeight="0",t.WinTitle="",t.WinClickBlackClose=!1,t.mask=null,t.windowBg=null,t.loadWindowCom=null,t.loadWindowComThis=null,t.loadWindowComThisParem=[],t._windowType=0,t._isShowRuleBtn=!1,t.backBtnClickCallback=null,t.backBtnClickCallbackThisObj=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.WindowType>0?r.default.instance.loadResByType(a.GlobalContext.Root+"prefab/commons/WindowBg"+this.WindowType,cc.Prefab,this.loadWindowBgComplete,this):this.setMaskBg(this.node),this.backBtnClickCallback=this.close,this.backBtnClickCallbackThisObj=this},t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.hide=function(){e.prototype.hide.call(this)},t.prototype.close=function(){n.default.instance.closeWindow(this.node)},t.prototype.setMaskBg=function(e){var t=this.node.getChildByName("MaskBg");t||(t=cc.instantiate(i.MaskBgPrefab),e.insertChild(t,0),t.name="MaskBg"),t.setPosition(0,0),t.width=a.GlobalContext.StageWidth,t.height=a.GlobalContext.StageHeight,t.active=this.MaskBg},t.prototype.BtnClickToOpenWin=function(e,t){var i=Number(t);n.default.instance.open(i)},t.prototype.setWindowTitle=function(e){if(this.windowBg&&1==this.WindowType){var t=this.windowBg.getComponent(s.default);t&&(t.TitleImage.spriteFrame=t.TitleAtilas.getSpriteFrame(e))}},t.prototype.loadWindowBgComplete=function(e){if(1!=this.isDestroyed){if(this.windowBg=c.default.getNodeByUrl(e,a.GlobalContext.Root+"prefab/commons/WindowBg"+this.WindowType),1==this.WindowType){var t=this.windowBg.getComponent(s.default);t.Bg.active=this.ShowBg,this.BgUrl&&t.Bg.getComponent(l.default).updateBg(this.BgUrl,this.BgName),i.windowtitlename&&""!=i.windowtitlename&&t.TitleAtilas.getSpriteFrame(i.windowtitlename)?t.TitleImage.spriteFrame=t.TitleAtilas.getSpriteFrame(i.windowtitlename):t.TitleImage.spriteFrame=this.Title,this.Container&&t.Container.addChild(this.Container),t.backBtnClickCallback=this.backBtnClick,t.backBtnClickCallbackThisObj=this,t.TabBtnList.TabBtnNames=this.TabBtnNames,t.TabBtnList.TabViews=this.TabViews,t.TabBtnList.selectedCallback=this.tabBtnSelectedChange,t.TabBtnList.selectedCallbackThisObj=this,t.TabBtnList.conditionCallback=this.conditionCallback,t.TabBtnList.conditionCallbackThisObj=this;var n=this.TabBtnLocation.split(","),o=Number(n[0]);t.TabBtnList.List.y=o,t.TabBtnList.ListContainer.getComponent(cc.Layout).spacingY=Number(n[1]),t.TabBtnList.List.height+=o,t.TabBtnList.List.getChildByName("view").height+=o,t.ListContainer_copy.getChildByName("List").y=o,t.ListContainer_copy.getChildByName("List").getChildByName("view").getComponentInChildren(cc.Layout).spacingY=Number(n[1]),t.ListContainer_copy.getChildByName("List").height+=o,t.ListContainer_copy.getChildByName("List").getChildByName("view").height+=o,t.WindowBg.active=this.ShowWindowBg,t.WindowLeftBg.active=this.ShowWindowLeftBg,t.WindowLeftBg.height=this.ShowWindowLeftBgH,t.onInit(this._windowType,this._isShowRuleBtn)}else if(5==this.WindowType){var r=this.windowBg.getComponent(d.default);r.backBtnClickCallback=this.backBtnClick,r.backBtnClickCallbackThisObj=this,r.TabBtnList.TabBtnNames=this.TabBtnNames,r.TabBtnList.TabViews=this.TabViews,r.TabBtnList.selectedCallback=this.tabBtnSelectedChange,r.TabBtnList.selectedCallbackThisObj=this,r.TabBtnList.conditionCallback=this.conditionCallback,r.TabBtnList.conditionCallbackThisObj=this;n=this.TabBtnLocation.split(","),o=Number(n[0]);r.TabBtnList.List.y=o,r.TabBtnList.ListContainer.getComponent(cc.Layout).spacingY=Number(n[1]),r.TabBtnList.List.height+=o,r.TabBtnList.List.getChildByName("view").height+=o,r.ListContainer_copy.getChildByName("List").y=o,r.ListContainer_copy.getChildByName("List").getChildByName("view").getComponentInChildren(cc.Layout).spacingY=Number(n[1]),r.ListContainer_copy.getChildByName("List").height+=o,r.ListContainer_copy.getChildByName("List").getChildByName("view").height+=o,r.initData(Number(this.WinWeight),Number(this.WinHeight),this.WinTitle,this.WinClickBlackClose)}this.node.insertChild(this.windowBg,0),this.setMaskBg(this.windowBg),this.windowBg.setPosition(0,0),this.loadWindowCom&&this.loadWindowCom.apply(this.loadWindowComThis,this.loadWindowComThisParem)}},t.prototype.onShowWindow=function(){this.node.runAction(cc.sequence(cc.spawn(cc.scaleTo(.22,1.1),cc.fadeTo(.22,200),cc.callFunc(function(e){this.onOneFinish()},this)),cc.spawn(cc.scaleTo(.05,1),cc.fadeTo(.05,255)),cc.callFunc(function(e){this.onAllfinished()},this)))},t.prototype.conditionCallback=function(e){return!0},t.prototype.tabBtnSelectedChange=function(e){},t.prototype.backBtnClick=function(){this.backBtnClickCallback&&this.backBtnClickCallback.call(this.backBtnClickCallbackThisObj)},t.prototype.onInit=function(e,t){void 0===e&&(e=0),void 0===t&&(t=!1),this._windowType=e,this._isShowRuleBtn=t},t.MaskBgPrefab=null,t.windowtitlename="",__decorate([u(cc.String)],t.prototype,"BgUrl",void 0),__decorate([u(cc.String)],t.prototype,"BgName",void 0),__decorate([u(cc.Integer)],t.prototype,"WindowType",void 0),__decorate([u(cc.SpriteFrame)],t.prototype,"Title",void 0),__decorate([u(cc.Node)],t.prototype,"Container",void 0),__decorate([u([cc.String])],t.prototype,"TabBtnNames",void 0),__decorate([u([cc.Node])],t.prototype,"TabViews",void 0),__decorate([u(cc.String)],t.prototype,"TabBtnLocation",void 0),__decorate([u(cc.Boolean)],t.prototype,"ShowWindowBg",void 0),__decorate([u(cc.Integer)],t.prototype,"ShowWindowLeftBgH",void 0),__decorate([u(cc.Boolean)],t.prototype,"ShowWindowLeftBg",void 0),__decorate([u(cc.Boolean)],t.prototype,"ShowBg",void 0),__decorate([u(cc.Boolean)],t.prototype,"MaskBg",void 0),__decorate([u(cc.String)],t.prototype,"WinWeight",void 0),__decorate([u(cc.String)],t.prototype,"WinHeight",void 0),__decorate([u(cc.String)],t.prototype,"WinTitle",void 0),__decorate([u(cc.Boolean)],t.prototype,"WinClickBlackClose",void 0),__decorate([u(cc.Node)],t.prototype,"mask",void 0),t=i=__decorate([h],t)}(o.default);i.default=f,cc._RF.pop()},{"../GlobalContext":"GlobalContext","../Module/Commons/Image":"Image","../Module/Commons/WindowBg1":"WindowBg1","../Module/Commons/WindowBg5":"WindowBg5","../Util/Utils":"Utils","./LoadManager":"LoadManager","./Widget":"Widget","./WindowManager":"WindowManager"}],WorldBossRank:[function(e,t,i){"use strict";cc._RF.push(t,"5a6aakD6alEsIYLRYD+q+fk","WorldBossRank"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../Role/RoleInfo"),a=e("../../Util/Utils"),r=e("../Activity/ActivityController"),s=e("../../Core/Language"),l=e("../../Core/CommonsResManager"),c=e("../../Core/LoadManager"),d=e("../../Util/NumberUtil"),p=cc._decorator,h=p.ccclass,u=(p.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this},t.prototype.initRankInfo=function(e,t){var i=cc.find("rankLayer/mask/content",this.node);cc.find("rankLayer/myRank/level",this.node).getComponent(cc.Label).string=s.default.getStr("\u7b49\u7ea7{0}",o.MyRoleInfo.level),cc.find("rankLayer/myRank/name",this.node).getComponent(cc.Label).string=r.default.instance.nameSubstring(String(o.MyRoleInfo.name),7),t&&t.rank>100?cc.find("rankLayer/myRank/rankNum",this.node).getComponent(cc.Label).string="100+":cc.find("rankLayer/myRank/rankNum",this.node).getComponent(cc.Label).string=t?t.rank:"0",cc.find("rankLayer/myRank/damage",this.node).getComponent(cc.Label).string=t?d.NumberUtil.getNumber(t.point):"0",t&&0==t.point?(cc.find("rankLayer/myRank/rankNum",this.node).active=!1,cc.find("rankLayer/myRank/damage",this.node).active=!1,cc.find("rankLayer/myRank/name",this.node).getComponent(cc.Label).string=o.MyRoleInfo.name+": \u6682\u672a\u4e0a\u699c"):(cc.find("rankLayer/myRank/rankNum",this.node).active=!0,cc.find("rankLayer/myRank/damage",this.node).active=!0);for(var n=0;n<i.children.length;n++)i.children[n].active=!1;var p=cc.find("rankLayer/konDi",this.node);0==e.length?p.active=!0:p.active=!1,c.default.instance.loadResByType("prefab/worldbosss/rank",cc.Prefab,function(t){for(var n=0;n<e.length;n++){var o=null;i.children[n]?o=i.children[n]:(o=a.default.getNodeByUrl(t,"prefab/worldbosss/rank"),i.addChild(o),n<3&&(o.children[0].active=!1,o.getChildByName("image").active=!0,o.getChildByName("image").getComponent(cc.Sprite).spriteFrame=l.default.instance.getSpriteFrameByName("crown"+Number(n+1)))),o.active=!0,cc.find("level",o).getComponent(cc.Label).string=s.default.getStr("\u7b49\u7ea7{0}",e[n].info.level),cc.find("name",o).getComponent(cc.Label).string=r.default.instance.nameSubstring(String(e[n].info.name),7),cc.find("rankNum",o).getComponent(cc.Label).string=n+1+"",cc.find("damage",o).getComponent(cc.Label).string=d.NumberUtil.getNumber(e[n].point),o.setPosition(-8,0)}},this)},t.prototype.btn_Back=function(){this.node.active=!1,this.node.parent.active=!1},t.instance=null,t=i=__decorate([h],t)}(n.default));i.default=u,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/Widget":"Widget","../../Util/NumberUtil":"NumberUtil","../../Util/Utils":"Utils","../Activity/ActivityController":"ActivityController","../Role/RoleInfo":"RoleInfo"}],WorldBossRewardInfo:[function(e,t,i){"use strict";cc._RF.push(t,"3cac1ZKWY9Lh5iGRnfJAaPM","WorldBossRewardInfo"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./WorldBoss"),o=e("../Activity/ActivityController"),a=e("../../Core/ConfigsManager"),r=e("../../NetConnect/NetConnet"),s=e("../Status/StatusType"),l=e("../../Core/Language"),c=e("../../Util/Utils"),d=e("../Item/ItemIcon"),p=e("../Commons/RewardUtils"),h=e("../EliteBoss/EliteBossControl"),u=e("../../Core/CommonsResManager"),f=e("../../Core/GameEventDispatcher"),g=e("../Commons/CommonPageBG"),y=e("../../Core/LoadManager"),m=cc._decorator,C=m.ccclass,v=m.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.twoNode=null,t.threeNode=null,t.sp=[],t.boxAtlas=null,t.comAtals1=null,t.rewardItem=null,t.killerName=null,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.onInit(1085,678,l.default.getStr("reward_info_title"),!0),i.instance=this},t.prototype.show=function(){e.prototype.show.call(this),f.GameEventDispatcher.instance.on("WORLDRED",this.updataKillerName,this),s.ActivityStatus.value==s.ActivityStatus.WorldBoss?(this.twoNode.active=!0,this.threeNode.active=!1,this.initWorldBossInfo()):s.ActivityStatus.value==s.ActivityStatus.EliteBoss&&(this.twoNode.active=!1,this.threeNode.active=!0,this.initEliteBossInfo())},t.prototype.hide=function(){e.prototype.hide.call(this),f.GameEventDispatcher.instance.off("WORLDRED",this.updataKillerName,this),cc.find("oneLayer/mask/content",this.node).destroyAllChildren()},t.prototype.initRewardNode=function(e,t){var i=p.default.instance.getItemList(t);y.default.instance.loadResByType("prefab/Bag/ItemIcon",cc.Prefab,function(t){for(var n=0;n<i.length;n++){var o=c.default.getNodeByUrl(t,"prefab/Bag/ItemIcon");o.getComponent(d.default).ItemData(i[n],!0,null,!0),e.getChildByName("ScrollView").getChildByName("view").getChildByName("rewardLayer").addChild(o)}},this)},t.prototype.initWorldBossInfo=function(){var e=this,t=n.default.instance._worldbossConfigs,i=o.default.instance.worldBossRankReward;y.default.instance.loadResByType("prefab/worldbosss/Reward",cc.Prefab,function(t){for(var n in e.rewardItem=t,i){var o=i[n],a=c.default.getNodeByUrl(e.rewardItem,"prefab/worldbosss/Reward");e.initRewardNode(a,o.reward),cc.find("oneLayer/mask/content",e.node).addChild(a);var r=o.min==o.max;if(cc.find("rank/one",a).active=r,cc.find("rank/two",a).active=!r,r)for(var s=0;s<cc.find("rank/one",a).children.length;s++)cc.find("rank/one",a).children[0].active=!0,cc.find("rank/one",a).children[0].getComponent(cc.Sprite).spriteFrame=u.default.instance.getSpriteFrameByName("crown"+o.min);else 0==o.max?(cc.find("rank/two/num2",a).active=!1,cc.find("rank/two/num1",a).getComponent(cc.Label).string=o.min+"",cc.find("rank/two/sp",a).getComponent(cc.Sprite).spriteFrame=e.sp[1]):(cc.find("rank/two/num2",a).active=!0,cc.find("rank/two/num1",a).getComponent(cc.Label).string=o.min+"",cc.find("rank/two/num2",a).getComponent(cc.Label).string=o.max+"",cc.find("rank/two/sp",a).getComponent(cc.Sprite).spriteFrame=e.sp[0]),console.log(cc.find("rank/two/num1",a).getComponent(cc.Label).string,cc.find("rank/two/num2",a).getComponent(cc.Label).string,o,"\u5956\u52b1\u4fe1\u606f");a.active=!0}},this);for(var r=a.ConfigsManager.instance.getConfigs("stdrewardconf"),s=function(i){cc.find("twoLayer",h.node).children[i].active=!!t.hpReward[1][i],cc.find("twoLayer",h.node).children[i].getChildByName("hp").getComponent(cc.Label).string=t.hpReward[1][i].rate+l.default.getStr("\u8840\u91cf\u5956\u52b1");var o=t.hpReward[1][i].reward,a=t.hpReward[1][i].rate,s=r.reward[o],u=p.default.instance.getItemListByServerData(s);y.default.instance.loadResByType("prefab/Bag/ItemIcon",cc.Prefab,function(t){for(var o=0;o<u.length;o++)if(Math.floor(1e4*n.default.instance.hpData/n.default.instance.bossMaxHp)/100<a){var r=c.default.getNodeByUrl(t,"prefab/Bag/ItemIcon");r.getComponent(d.default).ItemData(u[o],!0),cc.find("twoLayer",e.node).children[i].getChildByName("sp").addChild(r),cc.find("twoLayer",e.node).children[i].getChildByName("sp").getComponent(cc.Sprite).spriteFrame=null,cc.find("twoLayer",e.node).children[i].getChildByName("get").active=!0}else cc.find("twoLayer",e.node).children[i].getChildByName("sp").getComponent(cc.Sprite).spriteFrame=e.boxAtlas.getSpriteFrame("treasurebox"+Number(i+1)),cc.find("twoLayer",e.node).children[i].getChildByName("get").active=!1},h)},h=this,f=0;f<4;f++)s(f)},t.prototype.initInfo=function(){if(s.ActivityStatus.value==s.ActivityStatus.WorldBoss){r.default.instance.sendProto({cmd:"worldbosskiller"})}},t.prototype.updataKillerName=function(){this.killerName=o.default.instance.killName,cc.find("twoLayer",this.node).children[4].getChildByName("name").getComponent(cc.Label).string=this.killerName?this.killerName:l.default.getStr("\u6682\u65e0\u73a9\u5bb6\u83b7\u5f97")},t.prototype.initEliteBossInfo=function(){var e=this,t=h.default.instance.eliteBossConf,i=o.default.instance;y.default.instance.loadResByType("prefab/worldbosss/Reward",cc.Prefab,function(n){for(var o in e.rewardItem=n,t.rank[t.boss[1][i.currElitIndex].rank]){var a=t.rank[i.currElitIndex+1][o],r=c.default.getNodeByUrl(e.rewardItem,"prefab/worldbosss/Reward");r.active=!0,e.initRewardNode(r,a.rwId),cc.find("oneLayer/mask/content",e.node).addChild(r);var s=a.min==a.max;if(cc.find("rank/one",r).active=s,cc.find("rank/two",r).active=!s,s){var l=cc.find("rank/one",r);for(var d in l)l.children[o].active=!0}else cc.find("rank/two/num1",r).getComponent(cc.Label).string=a.min+"",cc.find("rank/two/num2",r).getComponent(cc.Label).string=a.max+""}},this),i.eliteRank.data[i.currElitIndex].killer.name?this.threeNode.getChildByName("textName").getComponent(cc.Label).string=i.eliteRank.data[i.currElitIndex].killer.name+l.default.getStr("\u51fb\u6740"):this.threeNode.getChildByName("textName").getComponent(cc.Label).string=l.default.getStr("\u6682\u65e0\u73a9\u5bb6\u83b7\u5f97")},t.prototype.onClose=function(){e.prototype.onClose.call(this),o.default.instance.WroldAttr()},t.instance=null,__decorate([v(cc.Node)],t.prototype,"twoNode",void 0),__decorate([v(cc.Node)],t.prototype,"threeNode",void 0),__decorate([v([cc.SpriteFrame])],t.prototype,"sp",void 0),__decorate([v(cc.SpriteAtlas)],t.prototype,"boxAtlas",void 0),__decorate([v(cc.SpriteAtlas)],t.prototype,"comAtals1",void 0),t=i=__decorate([C],t)}(g.default);i.default=_,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/ConfigsManager":"ConfigsManager","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../NetConnect/NetConnet":"NetConnet","../../Util/Utils":"Utils","../Activity/ActivityController":"ActivityController","../Commons/CommonPageBG":"CommonPageBG","../Commons/RewardUtils":"RewardUtils","../EliteBoss/EliteBossControl":"EliteBossControl","../Item/ItemIcon":"ItemIcon","../Status/StatusType":"StatusType","./WorldBoss":"WorldBoss"}],WorldBoss:[function(e,t,i){"use strict";cc._RF.push(t,"dff561lvbFL655DWc0bC/RB","WorldBoss"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../WarTeam/MonsterController"),o=e("../../Core/Widget"),a=e("../../Core/WindowManager"),r=e("../../NetConnect/NetConnet"),s=e("../../Core/WindowType"),l=e("./WorldBossRewardInfo"),c=e("./WorldBossRank"),d=e("../Commons/MonsterPreview"),p=e("../../Util/Utils"),h=e("../Activity/ActivityController"),u=e("../Item/ItemIcon"),f=e("../../Core/ConfigsManager"),g=e("../Status/StatusType"),y=e("../../Global/GlobalValue"),m=e("../../GlobalContext"),C=e("../OpenWin/OpenWinController"),v=e("../../Core/Language"),_=e("../../Core/GameEventDispatcher"),b=e("../../Core/Event"),T=e("../../Core/TimeController"),S=e("../Scene/Controller/FightController"),I=e("../SandTable/SandTableController"),w=e("../../Core/CommonsResManager"),D=e("../Tips/OpTipsController"),R=e("../../Core/LoadManager"),A=cc._decorator,N=A.ccclass,L=A.property,E=function(e){function t(){var t=e.call(this)||this;return t.leftWin=null,t.outTimeLabe=null,t.worldBossAlat=null,t.commAlat=null,t.bossStatueAnim=null,t.bossMaxHp=null,t.bossState=null,t._worldbossConfigs=null,t.CoolingTime=[],t.isNewLineup=null,t.index=void 0,t.timeOut=null,t.countDown=null,t.TimeDataLick=null,t.scheBossLick=null,t.rankData=[],t.hpData=null,t.MyrankData=null,t.etime=null,t.jisha=null,i.instance=t,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this._worldbossConfigs=f.ConfigsManager.instance.getConfigs("worldbossconf")},t.prototype.show=function(){e.prototype.show.call(this),this.NodeSetPosition(),_.GameEventDispatcher.instance.on("WorldBossRank",this.worldbossrankData,this),_.GameEventDispatcher.instance.on("WorldSelfRank",this.worldbossrank,this),_.GameEventDispatcher.instance.on("WorldData",this.actchange,this),g.ActivityStatus.value==g.ActivityStatus.WorldBoss&&(h.default.instance.WroldAttr(),this.sendWorlinfo(),this.sendWorldbosshp(),this.sendrankdata()),this.CoolingTime[g.ActivityStatus.value==g.ActivityStatus.WorldBoss?0:1]&&this.openTimeData()},t.prototype.hide=function(){e.prototype.hide.call(this),clearInterval(this.timeOut),clearInterval(this.countDown),this.closeTimeData(),this.closeUpdateBoss(),_.GameEventDispatcher.instance.off("WorldBossRank",this.worldbossrankData,this),_.GameEventDispatcher.instance.off("WorldSelfRank",this.worldbossrank,this),_.GameEventDispatcher.instance.off("WorldData",this.actchange,this)},t.prototype.NodeSetPosition=function(){var e=cc.find("BossInfo/HpDi",this.node),t=cc.find("BossInfo/Info",this.node);e.y=m.GlobalContext.UIHeight/2-e.height-10,t.y=-m.GlobalContext.UIHeight/2+t.height/2-2,t.x=-m.GlobalContext.UIWidth/2+t.width/2+80,cc.find("btnClose",this.node).y=m.GlobalContext.UIHeight/2-cc.find("btnClose",this.node).height/2+2,cc.find("btnClose",this.node).x=-m.GlobalContext.UIWidth/2+cc.find("btnClose",this.node).width/2+2,cc.find("Title",this.node).y=m.GlobalContext.UIHeight/2-cc.find("Title",this.node).height/2+2,cc.find("Title",this.node).x=-m.GlobalContext.UIWidth/2+cc.find("Title",this.node).width/2+2},t.prototype.initInfo=function(){cc.find("BossInfo/Info",this.node).active=!0},t.prototype.openTimeData=function(){this.WorldBtnInfo(!1,!0,!0),this.TimeDataLick||this.CoolingTime[g.ActivityStatus.value==g.ActivityStatus.WorldBoss?0:1]>0&&(this.TimeDataLick=!0,this.CoolingTimeData())},t.prototype.closeTimeData=function(){this.TimeDataLick&&(this.TimeDataLick=!1,this.unschedule(this.CoolingTimeData))},t.prototype.openUpdateBoss=function(){this.updateBoss(),this.scheBossLick||(this.scheBossLick=!0,this.schedule(this.updateBoss,10))},t.prototype.closeUpdateBoss=function(){this.scheBossLick&&(this.scheBossLick=!1,this.unschedule(this.updateBoss))},t.prototype.updateBoss=function(){g.ActivityStatus.value==g.ActivityStatus.WorldBoss&&1!=h.default.instance.actstatusArr[1].status&&(this.sendWorldbosshp(),this.sendrankdata())},t.prototype.actchange=function(){var e=this;this.getFightingNum(),this.monsterInfo();var t;t=h.default.instance.actstatusArr[1];var i=cc.find("btnNewLineup",this.node).getComponent(cc.Button);if(t)switch(t.status){case 1:if(cc.find("BossLayer/sp",this.node).active=!1,this.WorldBtnInfo(!0,!1,!0),g.ActivityStatus.value==g.ActivityStatus.WorldBoss){cc.find("GrayNode",this.node).active=!0,i.interactable=!1;var n=T.default.instance.ServerTimeMins;cc.find("BossInfo/HpDi/base",this.node).active=!0,n<t.etime?(this.countDown&&clearInterval(this.countDown),this.timeOut&&clearInterval(this.timeOut),this.countDown=setInterval(function(){n+=1e3;var i=t.etime-n;if(n<t.etime){var o=parseInt(""+i/1e3/60/60%24),a=parseInt(""+i/1e3/60%60),r=parseInt(""+i/1e3%60);if(e.timeLabeShow(o,a,r),0==Number(o)&&0==Number(a)&&Number(r)<=4){cc.find("countDown",e.node).active=!0;var s=cc.find("countDown/Num",e.node).getComponent(cc.Sprite);switch(r){case 4:s.spriteFrame=w.default.instance.getSpriteFrameByName("i18n_dao3");break;case 3:s.spriteFrame=w.default.instance.getSpriteFrameByName("i18n_dao2");break;case 2:s.spriteFrame=w.default.instance.getSpriteFrameByName("i18n_dao1");break;case 1:s.spriteFrame=e.worldBossAlat.getSpriteFrame("i18n_zhandoukai"),cc.find("countDown",e.node).runAction(cc.fadeTo(1.5,0))}}}},1e3)):cc.find("countDown",this.node).active=!1}break;case 2:if(cc.find("BossLayer/sp",this.node).active=!1,cc.find("BossInfo/BossEtime",this.node).active=!1,g.ActivityStatus.value==g.ActivityStatus.WorldBoss){cc.find("BossInfo/HpDi/base",this.node).active=!0;var o=T.default.instance.ServerTimeMins;this.timeOut&&clearInterval(this.timeOut),this.countDown&&clearInterval(this.countDown),this.timeOut=setInterval(function(){o+=1e3;var i=t.etime-o;if(o<t.etime){var n=parseInt(""+i/1e3/60/60%24),a=parseInt(""+i/1e3/60%60),r=parseInt(""+i/1e3%60);if(e.timeLabeShow(n,a,r),0==Number(n)&&0==Number(a)&&Number(r)<=4)switch(r){case 1:p.default.setNodeChildDestoryByUrl(e.bossStatueAnim,m.GlobalContext.Root+"effects/worldboss/prefabs/worldboss_04"),R.default.instance.loadResByType(m.GlobalContext.Root+"effects/worldboss/prefabs/worldboss_04",cc.Prefab,function(t){var i=p.default.getNodeByUrl(t,m.GlobalContext.Root+"effects/worldboss/prefabs/worldboss_04");i.active=!0,e.bossStatueAnim.addChild(i),i.getComponent(cc.Animation).play(),i.runAction(cc.fadeTo(2,0))},e)}}},1e3),cc.find("FightBase",this.node).active=!1}this.CoolingTime[g.ActivityStatus.value==g.ActivityStatus.WorldBoss?0:1]&&h.default.instance.ChallengeBool?this.WorldBtnInfo(!1,!0,!0):this.WorldBtnInfo(!0,!1,!0),this.openUpdateBoss();break;case 3:cc.find("BossLayer/sp",this.node).active=!0,this.WorldBtnInfo(!1,!1,!1),cc.find("BossInfo/BossEtime",this.node).active=!1,this.btn_close()}else this.updataHpInfo(0),cc.find("BossLayer/sp",this.node).active=!0,this.WorldBtnInfo(!1,!1,!1),g.ActivityStatus.value==g.ActivityStatus.WorldBoss&&(cc.find("BossInfo/BossEtime",this.node).active=!1)},t.prototype.getRecommend=function(e){if(g.ActivityStatus.value==g.ActivityStatus.WorldBoss){if(void 0!=this.index){var t=this._worldbossConfigs.boss[1][this.index];return cc.find("BossInfo/Info/Boss/Desc",this.node).getComponent(cc.RichText).string=h.default.instance.monster?h.default.instance.monster.dec:"\u6682\u65e0",t.recommendCard}for(var i in this._worldbossConfigs.boss[1]){if((t=this._worldbossConfigs.boss[1][i]).level>=e)return t.recommendCard}return cc.find("BossInfo/Info/Boss/Desc",this.node).getComponent(cc.RichText).string=h.default.instance.monster?h.default.instance.monster.dec:"\u6682\u65e0",[]}},t.prototype.Recommend=function(){var e=this.index,t=this.getRecommend(e);if(t)for(r=0;r<3;r++){a=cc.find("BossInfo/Info/Boss/cardLayer",this.node).children[r];cc.find("BossInfo/Info/Boss/cardNameLayer",this.node).children[r].getComponent(cc.Label).string=f.ConfigsManager.instance.getConfigs("cardConf").Card[t[r]].cardName,a.getComponent(cc.Sprite).spriteFrame=w.default.instance.getSpriteFrameByName("bag"+(7-f.ConfigsManager.instance.getConfigs("cardConf").Card[t[r]].rarity));for(var i=a.childrenCount-1;i>=0;i--){a.children[i].getComponent(d.default).clear(),p.default.setNodeToPool(s.PoolType.MonsterPreview,a.children[i])}n.default.instance.infoPreview(a,cc.v2(0,-35),t[r],5,.35,-1,!0,function(){},this)}else for(var o=0;o<3;o++)for(var a,r=(a=cc.find("BossInfo/Info/Boss/cardLayer",this.node).children[o]).childrenCount-1;r>=0;r--){a.children[r].getComponent(d.default).clear(),p.default.setNodeToPool(s.PoolType.MonsterPreview,a.children[r])}},t.prototype.WorldLayerInfo=function(e){g.ActivityStatus.value==g.ActivityStatus.WorldBoss?this.outTimeLabe.node.parent.active=!0:this.outTimeLabe.node.parent.active=!1},t.prototype.WorldBtnInfo=function(e,t,i){cc.find("btnNewLineup",this.node).active=e,cc.find("btnCoolingTime",this.node).active=t,cc.find("btnSetLineup",this.node).active=i},t.prototype.updataHpInfo=function(e){var t=this;(this.bossMaxHp||(this.bossMaxHp=12e4),0==e)?(g.ActivityStatus.value==g.ActivityStatus.WorldBoss&&(this.scheduleOnce(this.btn_close,1.5),p.default.setNodeChildDestoryByUrl(this.bossStatueAnim,m.GlobalContext.Root+"effects/worldboss/prefabs/worldboss_03"),R.default.instance.loadResByType(m.GlobalContext.Root+"effects/worldboss/prefabs/worldboss_03",cc.Prefab,function(e){var i=p.default.getNodeByUrl(e,m.GlobalContext.Root+"effects/worldboss/prefabs/worldboss_03");i.active=!0,t.bossStatueAnim.addChild(i),i.getComponent(cc.Animation).play(),i.runAction(cc.fadeTo(1.5,0))},this)),cc.find("BossInfo/HpDi",this.node).active=!1,cc.find("BossLayer/sp",this.node).active=!0,cc.find("BossLayer/playLayer",this.node).active=!1,this.WorldBtnInfo(!1,!1,!1)):(cc.find("BossInfo/HpDi",this.node).active=!0,cc.find("BossInfo/HpDi",this.node).getComponent(cc.ProgressBar).progress=e/this.bossMaxHp,cc.find("BossInfo/HpDi/HpNum",this.node).getComponent(cc.Label).string=Math.floor(1e4*e/this.bossMaxHp)/100+"%",this.WorldLayerInfo(e/this.bossMaxHp))},t.prototype.worldbosshp=function(e){this.node&&(this.hpData=e.hp,this.bossMaxHp=e.maxhp,3!=h.default.instance.actstatusArr[1]&&0!=this.hpData&&(cc.find("BossInfo/HpDi/NewSprite",this.node).getComponent(cc.Sprite).spriteFrame=this.worldBossAlat.getSpriteFrame("WorldBossIcon"),cc.find("FightBase",this.node).active=!0,0==h.default.instance.fightNum?cc.find("FightBase/FighitNum",this.node).getComponent(cc.Label).string="\u6682\u672a\u8bbe\u7f6e\u9635\u5bb9":cc.find("FightBase/FighitNum",this.node).getComponent(cc.Label).string="\u9635\u5bb9\u6218\u529b\uff1a"+h.default.instance.getFight()),this.node&&this.node.parent&&g.ActivityStatus.value==g.ActivityStatus.WorldBoss&&(this.updataHpInfo(this.hpData),this.WorldLayerInfo(this.hpData/this.bossMaxHp),this.initWorldInfo(e.index),0==this.hpData&&(this.WorldBtnInfo(!1,!1,!1),cc.find("FightBase",this.node).active=!1,this.closeUpdateBoss())))},t.prototype.initWorldInfo=function(e){var t=this._worldbossConfigs.boss[1][e];h.default.instance.monster=t,S.default.instance.bossID=h.default.instance.monster.cardId;f.ConfigsManager.instance.getConfigs("cardConf");cc.find("BossLayer/playLayer",this.node).active=!0,this.Recommend()},t.prototype.worldbossrankData=function(){this.rankData=h.default.instance.worlRank.data,c.default.instance&&c.default.instance.initRankInfo(this.rankData,this.MyrankData)},t.prototype.worldbossrank=function(){this.MyrankData=h.default.instance.worldSelfRank,cc.find("infoLayer/WorldLayer/MyDamage/value",this.node).getComponent(cc.Label).string=this.MyrankData.point+"",cc.find("infoLayer/WorldLayer/MyRanking/value",this.node).getComponent(cc.Label).string=this.MyrankData.rank+""},t.prototype.btn_closeReward=function(){for(var e=cc.find("setReward/content/rewardDi/one/rewardLayer",this.node),t=cc.find("setReward/content/rewardDi/two/rewardLayer",this.node),i=e.childrenCount-1;i>=0;i--){e.children[i].getComponent(u.default).Clear(),p.default.setNodeToPool(s.PoolType.ItemIcon,e.children[i])}for(i=t.childrenCount-1;i>=0;i--){t.children[i].getComponent(u.default).Clear(),p.default.setNodeToPool(s.PoolType.ItemIcon,t.children[i])}cc.find("setReward",this.node).active=!1,this.jisha=!1,_.GameEventDispatcher.instance.emit(b.EventDefiner.ChangeActivityStatus,g.ActivityStatus.WorldBoss),h.default.instance.WroldAttr(),this.hpData<=0&&(this.btn_close(),this.btn_ReceiveReward())},t.prototype.btn_Reward=function(){C.default.instance.openWindow(s.WindowType.WorldBossRewardInfo,function(){l.default.instance.initInfo()},this)},t.prototype.SetLinup=function(){h.default.instance.isSetSandTab=!0,g.ActivityStatus.value==g.ActivityStatus.WorldBoss&&(h.default.instance.WorldBossSetSand(),I.default.instance.clearData(),_.GameEventDispatcher.instance.emit(b.EventDefiner.ChangeGameScene,{status:y.GameScene.Fight,guanqiaId:y.GQIdType.WorldBoss})),C.default.instance.openWindow(s.WindowType.HighLadderFighting),C.default.instance.openWindow(s.WindowType.SandTable)},t.prototype.btn_NewLineup=function(){if(1!=h.default.instance.actstatusArr[1].status)if(h.default.instance.fightNum){var e=g.ActivityStatus.value==g.ActivityStatus.WorldBoss?0:1;n.MonsterType.IsLast[e]=!0,this.isNewLineup=!0,this.sendWorldbossbenter(!1),h.default.instance.isChange=!0,this.WorldBtnInfo(!1,!0,!0),this.CoolingTime[g.ActivityStatus.value==g.ActivityStatus.WorldBoss?0:1]=new Date(T.default.instance.ServerTimeMins).getTime()+1e3*this._worldbossConfigs.WorldBossConf[1].waitTime}else D.default.instance.ShowMsg(v.default.getStr("\u8bf7\u5148\u8bbe\u7f6e\u9635\u5bb9"));else D.default.instance.ShowMsg(v.default.getStr("\u5f53\u524d\u8fd8\u4e0d\u80fd\u53d1\u52a8\u653b\u51fb"))},t.prototype.btn_CoolingTime=function(){var e=Math.round((this.CoolingTime[g.ActivityStatus.value==g.ActivityStatus.WorldBoss?0:1]-(new Date).getTime())/1e3);D.default.instance.ShowMsg(h.default.instance.getTimeLabel(e)+v.default.getStr("\u540e\u53ef\u518d\u6b21\u6311\u6218"))},t.prototype.CoolingTimeData=function(){if((h.default.instance.ChallengeBool||g.ActivityStatus.value!=g.ActivityStatus.EliteBoss)&&null!=this.CoolingTime[g.ActivityStatus.value==g.ActivityStatus.WorldBoss?0:1]){var e=Math.round((this.CoolingTime[g.ActivityStatus.value==g.ActivityStatus.WorldBoss?0:1]-(new Date).getTime())/1e3);if(cc.find("btnCoolingTime/time",this.node).getComponent(cc.Label).string=h.default.instance.getTimeLabel(e)+v.default.getStr("\u540e\u53ef\u518d\u6b21\u6311\u6218"),e<=0)if(this.CoolingTime[g.ActivityStatus.value==g.ActivityStatus.WorldBoss?0:1]=null,this.closeTimeData(),this.hpData>0){this.WorldBtnInfo(!0,!1,!0),console.log("\u51b7\u5374\u5b8c\u6210");g.ActivityStatus.value,g.ActivityStatus.WorldBoss}else g.ActivityStatus.value==g.ActivityStatus.WorldBoss&&!h.default.instance.worldbossRewardData.rewardflag&&this.MyrankData&&this.MyrankData.point,this.WorldBtnInfo(!1,!1,!1)}},t.prototype.btn_ReceiveReward=function(){this.jisha=!0;r.default.instance.sendProto({cmd:"worldbossreward"}),cc.find("btnReceiveReward",this.node).active=!1},t.prototype.sendWorldbossbenter=function(e){var t={cmd:"worldbossbenter",last:e};r.default.instance.sendProto(t)},t.prototype.sendWorlinfo=function(){r.default.instance.sendProto({cmd:"worldbossuidata"})},t.prototype.sendWorldbosshp=function(){r.default.instance.sendProto({cmd:"worldbosshp"})},t.prototype.sendrankdata=function(){var e;e={cmd:"rankdata",type:3},r.default.instance.sendProto(e)},t.prototype.btn_close=function(){a.default.instance.closeAll()},t.prototype.RetractBossWinAnim=function(){this.leftWin.x=-m.GlobalContext.UIWidth/2-this.leftWin.width/2,this.leftWin.runAction(cc.moveBy(.4,50-this.leftWin.width,0)),this.leftWin.getChildByName("LeftButton").active=!1,this.leftWin.getChildByName("RightButton").active=!0},t.prototype.UnfoldBossWinAnim=function(){this.leftWin.x=-m.GlobalContext.UIWidth/2-this.leftWin.width/2,this.leftWin.runAction(cc.moveBy(.4,this.leftWin.width+100,0)),this.leftWin.getChildByName("LeftButton").active=!0,this.leftWin.getChildByName("RightButton").active=!1},t.prototype.boss=function(e,t){var i=cc.find("BossInfo/Info/Boss",this.node),n=cc.find("BossInfo/Info/Rank",this.node);"1"==t?(i.active=!0,n.active=!1):(i.active=!1,n.active=!0,n.getComponent(c.default).initRankInfo(this.rankData,this.MyrankData))},t.prototype.info=function(){_.GameEventDispatcher.instance.emit(b.EventDefiner.OpenRulePage,s.WindowType.WorldBoss)},t.prototype.getFightingNum=function(){var e=h.default.instance,t=cc.find("btnNewLineup",this.node).getComponent(cc.Button);e.fightNum=0;var i=n.default.instance.getServerListChangeBattleList(e.image);for(var o in i)e.fightNum+=n.default.instance.getCarFight(i[o].cardid,i[o].level,i[o].grade)*i[o].count;0==h.default.instance.fightNum?(cc.find("FightBase/FighitNum",this.node).getComponent(cc.Label).string="\u6682\u672a\u8bbe\u7f6e\u9635\u5bb9",cc.find("GrayNode",this.node).active=!0,t.interactable=!1):(cc.find("FightBase/FighitNum",this.node).getComponent(cc.Label).string="\u9635\u5bb9\u6218\u529b\uff1a"+h.default.instance.getFight(),cc.find("GrayNode",this.node).active=!1,t.interactable=!0)},t.prototype.monsterInfo=function(){var e=cc.find("BossLayer/playLayer",this.node);e.active=!0;for(var t=e.childrenCount-1;t>=0;t--){e.children[t].getComponent(d.default).clear(),p.default.setNodeToPool(s.PoolType.MonsterPreview,e.children[t])}var i=this._worldbossConfigs.boss[1][this.index];i&&n.default.instance.infoPreview(e,cc.v2(0,g.ActivityStatus.value==g.ActivityStatus.WorldBoss?0:50),i.cardId,i.grade,1,-1)},t.prototype.timeLabeShow=function(e,t,i){if(Number(t)<10)Number(i)<10?(n=e+":0"+t+":0"+i)&&(this.outTimeLabe.string="\u51c6\u5907\u65f6\u95f4\uff1a"+n):(n=e+":0"+t+":"+i)&&(this.outTimeLabe.string="\u51c6\u5907\u65f6\u95f4\uff1a"+n);else if(Number(i)<10){if(Number(t)<10)(n=e+":0"+t+":0"+i)&&(this.outTimeLabe.string="\u51c6\u5907\u65f6\u95f4\uff1a"+n);else(n=e+":"+t+":0"+i)&&(this.outTimeLabe.string="\u51c6\u5907\u65f6\u95f4\uff1a"+n)}else{var n;(n=e+":"+t+":"+i)&&(this.outTimeLabe.string="\u51c6\u5907\u65f6\u95f4\uff1a"+n)}},t.instance=null,__decorate([L(cc.Node)],t.prototype,"leftWin",void 0),__decorate([L(cc.Label)],t.prototype,"outTimeLabe",void 0),__decorate([L(cc.SpriteAtlas)],t.prototype,"worldBossAlat",void 0),__decorate([L(cc.SpriteAtlas)],t.prototype,"commAlat",void 0),__decorate([L(cc.Node)],t.prototype,"bossStatueAnim",void 0),t=i=__decorate([N],t)}(o.default);i.default=E,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/ConfigsManager":"ConfigsManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/Widget":"Widget","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../NetConnect/NetConnet":"NetConnet","../../Util/Utils":"Utils","../Activity/ActivityController":"ActivityController","../Commons/MonsterPreview":"MonsterPreview","../Item/ItemIcon":"ItemIcon","../OpenWin/OpenWinController":"OpenWinController","../SandTable/SandTableController":"SandTableController","../Scene/Controller/FightController":"FightController","../Status/StatusType":"StatusType","../Tips/OpTipsController":"OpTipsController","../WarTeam/MonsterController":"MonsterController","./WorldBossRank":"WorldBossRank","./WorldBossRewardInfo":"WorldBossRewardInfo"}],WorldResult:[function(e,t,i){"use strict";cc._RF.push(t,"006b4lTUE9FDaD/XPA1EAsQ","WorldResult"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../Status/StatusType"),a=e("../Role/RoleInfo"),r=e("../Item/ItemIcon"),s=e("../../Core/WindowType"),l=e("../../Util/Utils"),c=e("../../Core/ConfigsManager"),d=e("../Scene/Manager/SceneManager"),p=e("../Scene/Controller/FightController"),h=e("../../Core/CommonsResManager"),u=e("../../Core/Language"),f=e("../Activity/ActivityController"),g=e("../Commons/RewardUtils"),y=e("../Item/ItemData"),m=e("../../Core/WindowManager"),C=e("../Status/StatusController"),v=e("../../NetConnect/NetConnet"),_=e("../../Core/LoadManager"),b=e("../../GlobalContext"),T=e("../../Util/NumberUtil"),S=e("../../Core/GameEventDispatcher"),I=e("../../Core/TimeController"),w=cc._decorator,D=w.ccclass,R=w.property,A=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onceNode=null,t.killNode=null,t.theDamage=null,t.allDamage=null,t.rank=null,t.rewardLayout=null,t.killLayout=null,t.rankPrefab=null,t.killRewardLayout=null,t.myKillInfo=null,t.killName=null,t.rewardTimesLabe=null,t.NumberLabe=null,t.worldAtlas=null,t._worldbossConfigs=null,t.eliteBossConfigs=null,t.cardConf=null,t.reward=null,t.rankList=[],t.itemPrefab=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),S.GameEventDispatcher.instance.on("WorldBossRank",this.rankInfo,this),S.GameEventDispatcher.instance.on("EliteRank",this.rankInfo,this),S.GameEventDispatcher.instance.on("eliteBossTheDamage",this.eliteBossTheDamge,this),this.cardConf=c.ConfigsManager.instance.getConfigs("cardConf"),this._worldbossConfigs=c.ConfigsManager.instance.getConfigs("worldbossconf"),this.eliteBossConfigs=c.ConfigsManager.instance.getConfigs("elitebossconf"),this.reward=d.default.instance.resultShowItemList,this.openReward()},t.prototype.hide=function(){e.prototype.hide.call(this),l.default.setNodeChildDestoryByUrl(this.rewardLayout,b.GlobalContext.Root+"prefab/Bag/ItemIcon"),d.default.instance.resultShowItemList=[],p.default.instance.isKill=!1,S.GameEventDispatcher.instance.off("WorldBossRank",this.rankInfo,this),S.GameEventDispatcher.instance.off("EliteRank",this.rankInfo,this),S.GameEventDispatcher.instance.off("eliteBossTheDamage",this.eliteBossTheDamge,this)},t.prototype.eliteBossTheDamge=function(){this.theDamage.string=f.default.instance.theDeamge+""},t.prototype.openReward=function(){var e=this,t=f.default.instance,i=c.ConfigsManager.instance.getConfigs("elitebossconf").boss[1][f.default.instance.currElitIndex].name;if(p.default.instance.isKill){this.killNode.active=!0,this.onceNode.active=!1;var n=o.ActivityStatus.value==o.ActivityStatus.WorldBoss?this.cardConf.Card[p.default.instance.bossID].cardName:i;if(this.killName.string=n+u.default.getStr("\u5df2\u88ab\u51fb\u6740"),o.ActivityStatus.value==o.ActivityStatus.WorldBoss){var d={cmd:"worldbosskiller"};if(v.default.instance.sendProto(d),t.killName!=a.MyRoleInfo.name){var h=null,m=t.worldBossRankReward;for(var C in m)t.worldSelfRank.rank>=m[C].min&&t.worldSelfRank.rank>=m[C].max&&(h=m[C].reward,this.reward=g.default.instance.getItemListByServerData(h))}}else{if((d=t.eliteRank.data[t.currElitIndex]).killer.name!=a.MyRoleInfo.name){h=null;var S=c.ConfigsManager.instance.getConfigs("elitebossconf");m=S.rank[S.boss[1][t.currElitIndex]];for(var C in m)d.myRank>=m[C].min&&d.myRank<=m[C].max&&(h=m[C].rwId,this.reward=g.default.instance.getItemList(h))}}_.default.instance.loadResByType(b.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(t){e.itemPrefab=t;for(var i=0;i<e.reward.length;i++){var n=null,o=g.default.instance.getItemId(e.reward[i].type,e.reward[i].id,e.reward[i].count);e.killRewardLayout.children[i]?(n=e.killRewardLayout.children[i]).getComponent(r.default).ItemData(y.default.creatItem(o[0],o[1]),!0,o[1],!0):((n=l.default.getNodeByPool(s.PoolType.ItemIcon,e.itemPrefab)).getComponent(r.default).ItemData(y.default.creatItem(o[0],o[1]),!0,o[1],!0),e.killRewardLayout.addChild(n)),n.active=!0,n.setScale(.8)}},this),this.scheduleOnce(function(){var i=o.ActivityStatus.value==o.ActivityStatus.WorldBoss?t.killName:t.eliteRank.data[t.currElitIndex].killer.name;e.myKillInfo.children[1].getComponent(cc.Label).string="\u6700\u7ec8\u51fb\u6740\u8005\uff1a"+i},0)}else{this.killNode.active=!1,this.onceNode.active=!0;var w=0,D=0,R=I.default.instance.setTimeout(function(){o.ActivityStatus.value==o.ActivityStatus.WorldBoss?(w=t.worldbossRewardData.rCount,D=e._worldbossConfigs.WorldBossConf[1].rCount):(w=t.challengeTimes,D=e.eliteBossConfigs.EliteBossConf[1].challengeTimes),e.rewardTimesLabe.string="\u653b\u51fb\u5956\u52b1\u6b21\u6570("+w+"/"+D+")",I.default.instance.clearTimeout(R)},this,500);this.reward.length?(this.rewardLayout.active=!0,this.NumberLabe.node.active=!0,this.NumberLabe.string=T.NumberUtil.getNumber(this.reward[0].count)+""):(this.rewardLayout.active=!1,this.NumberLabe.node.active=!1)}},t.prototype.rankInfo=function(){var e=this;this.eliteBossTheDamge();var t=f.default.instance;if(p.default.instance.isKill){var i=o.ActivityStatus.value==o.ActivityStatus.WorldBoss?t.worldSelfRank:t.eliteRank.data[t.currElitIndex];this.rankPrefab.getChildByName("icon").active=!1,this.rankPrefab.getChildByName("ranking").getComponent(cc.Label).string=o.ActivityStatus.value==o.ActivityStatus.WorldBoss?i.rank+"":i.myRank+"",this.rankPrefab.getChildByName("name").getComponent(cc.Label).string=a.MyRoleInfo.name+"",this.rankPrefab.getChildByName("value").getComponent(cc.Label).string=o.ActivityStatus.value==o.ActivityStatus.WorldBoss?i.point+"":i.myPoint}else{if(o.ActivityStatus.value==o.ActivityStatus.WorldBoss)this.allDamage.string=t.worldSelfRank.point,this.rank.string=t.worldSelfRank.rank;else{var n=t.eliteRank.data[t.currElitIndex];this.allDamage.string=n.myPoint,this.rank.string=n.myRank}if(o.ActivityStatus.value==o.ActivityStatus.WorldBoss){var r=d.default.instance.attackenemyhp>=Number(this.allDamage.string)?Number(this.allDamage.string):d.default.instance.attackenemyhp;this.theDamage.string=r+""}}l.default.setNodeChildDestoryByUrl(this.killLayout,"prefab/worldbosss/info"),this.rankList=o.ActivityStatus.value==o.ActivityStatus.WorldBoss?this.rankList=t.worlRank.data:t.eliteRank.data[t.currElitIndex].rank,_.default.instance.loadResByType(b.GlobalContext.Root+"prefab/worldbosss/info",cc.Prefab,function(i){for(var n=0;n<5;n++)if(e.rankList[n]){var o=l.default.getNodeByUrl(i,"prefab/worldbosss/info");n<3?(o.getChildByName("ranking").active=!1,o.getChildByName("icon").active=!0,o.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=h.default.instance.getSpriteFrameByName("crown"+Number(n+1))):(o.getChildByName("ranking").active=!0,o.getChildByName("icon").active=!1,o.getChildByName("ranking").getComponent(cc.Label).string=n+1+""),o.getChildByName("base").getComponent(cc.Sprite).spriteFrame=n%2==0?e.worldAtlas.getSpriteFrame("base1"):e.worldAtlas.getSpriteFrame("base2"),o.getChildByName("name").getComponent(cc.Label).string=t.nameSubstring(e.rankList[n].info.name,7),o.getChildByName("value").getComponent(cc.Label).string=e.rankList[n].point+"",e.killLayout.addChild(o)}},this),S.GameEventDispatcher.instance.off("WorldBossRank",this.rankInfo,this),S.GameEventDispatcher.instance.off("EliteBossRank",this.rankInfo,this)},t.prototype.closeWin=function(){m.default.instance.close(s.WindowType.WorldBossResult),C.default.instance.activityStatusHandle(!0)},__decorate([R(cc.Node)],t.prototype,"onceNode",void 0),__decorate([R(cc.Node)],t.prototype,"killNode",void 0),__decorate([R(cc.Label)],t.prototype,"theDamage",void 0),__decorate([R(cc.Label)],t.prototype,"allDamage",void 0),__decorate([R(cc.Label)],t.prototype,"rank",void 0),__decorate([R(cc.Node)],t.prototype,"rewardLayout",void 0),__decorate([R(cc.Node)],t.prototype,"killLayout",void 0),__decorate([R(cc.Node)],t.prototype,"rankPrefab",void 0),__decorate([R(cc.Node)],t.prototype,"killRewardLayout",void 0),__decorate([R(cc.Node)],t.prototype,"myKillInfo",void 0),__decorate([R(cc.Label)],t.prototype,"killName",void 0),__decorate([R(cc.Label)],t.prototype,"rewardTimesLabe",void 0),__decorate([R(cc.Label)],t.prototype,"NumberLabe",void 0),__decorate([R(cc.SpriteAtlas)],t.prototype,"worldAtlas",void 0),t=__decorate([D],t)}(n.default);i.default=A,cc._RF.pop()},{"../../Core/CommonsResManager":"CommonsResManager","../../Core/ConfigsManager":"ConfigsManager","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/Window":"Window","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../../GlobalContext":"GlobalContext","../../NetConnect/NetConnet":"NetConnet","../../Util/NumberUtil":"NumberUtil","../../Util/Utils":"Utils","../Activity/ActivityController":"ActivityController","../Commons/RewardUtils":"RewardUtils","../Item/ItemData":"ItemData","../Item/ItemIcon":"ItemIcon","../Role/RoleInfo":"RoleInfo","../Scene/Controller/FightController":"FightController","../Scene/Manager/SceneManager":"SceneManager","../Status/StatusController":"StatusController","../Status/StatusType":"StatusType"}],WxSubDomainView:[function(e,t,i){"use strict";cc._RF.push(t,"91d02+BrdVHGZXhkX7c5SX4","WxSubDomainView"),Object.defineProperty(i,"__esModule",{value:!0});var n=cc._decorator,o=n.ccclass,a=n.property,r=function(e){function t(){var t=e.call(this)||this;return t.Image=null,t.tex=null,t.IsShow=!1,t.canvas=!1,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){this.Image.node.setScale(1,1)},t.prototype.start=function(){i.instance=this,this.tex=new cc.Texture2D,this.Image.spriteFrame=new cc.SpriteFrame,this.Image.node.width=cc.find("Canvas").width,this.Image.node.height=cc.find("Canvas").height;var e=cc.find("Canvas").width/sharedCanvas.width,t=cc.find("Canvas").height/sharedCanvas.height;this.postMessageToSubDomain({cmd:"setInit",value:{width:e,height:t}}),sharedCanvas.width=cc.find("Canvas").width,sharedCanvas.height=cc.find("Canvas").height,this.IsShow=!0,this.node.active=!1},t.prototype.onEnable=function(){this.IsShow=!0,this.postMessageToSubDomain({cmd:"show",value:this.IsShow})},t.prototype.onDisable=function(){this.IsShow=!1,this.postMessageToSubDomain({cmd:"show",value:this.IsShow})},t.prototype.postMessageToSubDomain=function(e){console.log("\u4e3b\u57df\u5411\u5b50\u57df\u53d1\u9001\u4fe1\u606f:",e),qq.getOpenDataContext().postMessage(e)},t.prototype._updateSubDomainCanvas=function(){this.tex&&(this.tex.initWithElement(sharedCanvas),this.tex.handleLoadedTexture(),this.Image.spriteFrame.setTexture(this.tex))},t.prototype.update=function(){1==this.IsShow&&this._updateSubDomainCanvas()},t.instance=null,__decorate([a(cc.Sprite)],t.prototype,"Image",void 0),t=i=__decorate([o],t)}(cc.Component);i.default=r,cc._RF.pop()},{}],XYHDSDK:[function(e,t,i){"use strict";cc._RF.push(t,"e4751c8nupLMINLt4wGKv+d","XYHDSDK"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./GameBaseSDK"),o=e("../../GlobalContext"),a=e("../../Util/SDKUtils"),r=e("../Role/RoleInfo"),s=e("../../Core/ConfigsManager"),l=e("../../Core/TimeController"),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.getGameData=function(){e.prototype.getGameData.call(this),o.GlobalContext.ResRoot=a.default.instance.getQueryString("resurl"),a.default.instance.setPhoneGameData({plat_id:1,ditch_id:1,device_id:1})},t.prototype.init=function(){this.qq=1083347165,this.access_token=md5(this.openId+this.timestamp+"e80928f02f4ccb474ac739da5180f3dc"),xysdk.init({gameid:"ce3cfb26cf95d284e880310386f69097",secret:"b5498c52c4a4578c459f11a733132af7",channelid:a.default.instance.ditch_id,contentDomId:"Cocos2dGameContainer",success:function(){console.log("\u521d\u59cb\u5316\u6210\u529f")},fail:function(){console.log("\u521d\u59cb\u5316\u5931\u8d25")}})},t.prototype.createRole=function(){e.prototype.createRole.call(this),xysdk.role_register({accountid:this.uid,roleid:r.MyRoleInfo.id,game:"\u90e8\u843d\u5927\u4e71\u6597",serviceid:r.MyRoleInfo.serverid,name:r.MyRoleInfo.name,level:r.MyRoleInfo.level,channelid:a.default.instance.ditch_id,platfromid:"h5",tmpsecret:"b5498c52c4a4578c459f11a733132af7"})},t.prototype.notifyroleInfo=function(){e.prototype.notifyroleInfo.call(this),xysdk.role_login({accountid:this.uid,roleid:r.MyRoleInfo.id,game:"\u90e8\u843d\u5927\u4e71\u6597",serviceid:r.MyRoleInfo.serverid,name:r.MyRoleInfo.name,level:r.MyRoleInfo.level,channelid:a.default.instance.ditch_id,platfromid:"h5",tmpsecret:"b5498c52c4a4578c459f11a733132af7"})},t.prototype.login=function(){e.prototype.login.call(this),xysdk.login({success:function(e){console.log("\u767b\u5f55\u6210\u529f"),a.default.instance.platformSdk.uid=e.d.uid,a.default.instance.platformSdk.openId=e.d.cpuid,a.default.instance.platformSdk.username=e.d.uname,a.default.instance.platformSdk.deviceid=e.d.deviceid,a.default.instance.platformSdk.loginBack(null)},fail:function(e){console.log("\u767b\u5f55\u5931\u8d25")}})},t.prototype.exit=function(){e.prototype.exit.call(this),cc.game.end()},t.prototype.logout=function(){e.prototype.logout.call(this),xysdk.switchaccount({success:function(e){console.log("\u767b\u51fa\u6210\u529f-------"),console.log(e),a.default.instance.platformSdk.onAccountInvalid()},fail:function(e){console.log("\u767b\u51fa\u5931\u8d25")}})},t.prototype.pay=function(t,i,n,o){var c=this;void 0===i&&(i=null),void 0===n&&(n=null),void 0===o&&(o=null),e.prototype.pay.call(this,t,i,n,o);var d=s.ConfigsManager.instance.getConfigs("rechargeconf").RechargeConf,p=a.default.instance.BackstageUrl+"/5-"+a.default.instance.ditch_id+"/payment/orderid";a.default.instance.sendToHttps(p,function(e){xysdk.pay({cporderid:e.orderid,subject:d[t].name,total_fee:d[t].price,serverid:r.MyRoleInfo.serverid,uid:c.openId,extInfo:t})});l.default.instance.setInterval(function(){},this,5e3)},t}(n.GameBaseSDK);i.XYHDSDK=c,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/TimeController":"TimeController","../../GlobalContext":"GlobalContext","../../Util/SDKUtils":"SDKUtils","../Role/RoleInfo":"RoleInfo","./GameBaseSDK":"GameBaseSDK"}],ZFController:[function(e,t,i){"use strict";cc._RF.push(t,"d415cLZynJEI46G2wOuvAFj","ZFController"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./SkillController"),o=e("../Unit/FightLog"),a=cc._decorator,r=a.ccclass,s=(a.property,function(){function e(){this.zfDic={},this.zfattDic={}}var t;return t=e,Object.defineProperty(e,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),e.prototype.addNode=function(e,t,i){o.default.log(t);var a=n.default.instance.GetResultConfParam(t.param,i);if(!this.zfDic[e]){var r={time:a[3]};this.zfDic[e]=r}var s={};s[a[1]]=a[2],this.zfattDic[e]=s,o.default.log("\u9635\u6cd5 ",t,e,a,s)},e.prototype.getattr=function(e,t){return this.zfattDic[e]?(o.default.log("\u83b7\u53d6\u9635\u6cd5\u5c5e\u6027\uff1a",e,t,this.zfattDic[e][t]||0),this.zfattDic[e][t]||0):0},e.prototype.update=function(e){for(var t in this.zfDic)this.zfDic[t].time-=e,this.zfDic[t].time<=0&&this.clearByCamp(t)},e.prototype.clearByCamp=function(e){this.zfDic[e]&&(o.default.log("\u6e05\u7406\u9635\u6cd5",e),delete this.zfattDic[e],delete this.zfDic[e],o.default.log("\u6e05\u7406\u9635\u6cd5",e,this.zfattDic))},e.prototype.clearAll=function(){for(var e in this.zfDic)this.clearByCamp(e)},e=t=__decorate([r],e)}());i.default=s,cc._RF.pop()},{"../Unit/FightLog":"FightLog","./SkillController":"SkillController"}],bufffunc:[function(e,t,i){"use strict";cc._RF.push(t,"8825fT85OVNV6eyOef6dtcU","bufffunc"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Global/GlobalValue"),o=e("./fightlogic"),a=e("../Scene/Unit/FightLog"),r=e("../Scene/Unit/FightConst"),s=e("./calculator"),l=e("./FightUtils");function c(e,t,i){t=l.FightUtils.CheakSheidHp(t);var n=e.CheakSheidHp(Math.abs(t));n.forEach(function(e){e.userhandle=i}),e.fight.updateResult=e.fight.updateResult.concat(n)}i.BuffFunc=[],i.BuffFunc[n.BuffType.Poison]=function(e,t){if(t.value>=0)return;if(e.IsDie())return;e.prop.otherAttr==n.OtherAttr.ExtraBuffuerhurt&&s.CalcExtraHurt.extraBuffer;var i=Math.ceil(t.value/t.time-t.times);c(e,i,t.userHandle)},i.BuffFunc[n.BuffType.Fire]=function(e,t){if(t.value>=0)return;if(e.IsDie())return;o.StateBit.Damage;e.prop.otherAttr==n.OtherAttr.ExtraBuffuerhurt&&s.CalcExtraHurt.extraBuffer;var i=Math.ceil(t.value/t.time);c(e,i,t.userHandle)},i.BuffFunc[n.BuffType.Recover]=function(e,t){if(t.value<=0)return;if(e.IsDie())return;var i=o.StateBit.Rescure,n=Math.abs(Math.ceil(t.value*t.value/(t.value+e.attr.GetDefence()))),a=(e.ChangeHp(n,1),e.NewResultInfo());a.handle=t.userHandle,a.type="hp",a.state|=i,a.data.hpChange=n,e.fight.CollectUpdateResult(a)},i.BuffFunc[n.BuffType.Recover2]=function(e,t){if(t.value<=0)return;if(e.IsDie())return;var i=o.StateBit.Rescure,n=t.value;n=Math.ceil(n*e.attr.GetMaxHp());e.ChangeHp(n,2);var a=e.NewResultInfo();a.handle=t.userHandle,a.type="hp",a.state|=i,a.data.hpChange=n,e.fight.CollectUpdateResult(a)},i.BuffFunc[n.BuffType.Burn]=function(e,t){if(t.value>=0)return;if(e.IsDie())return;o.StateBit.Damage;for(var i=e.fight.GetRangeEnemy(e,t.range,5e3,!0,!1),n=0;n<i.length;n++){var a=i[n],r=Math.ceil(t.value*t.value/(t.value+e.attr.GetDefence()));c(a,r,t.userHandle)}},i.BuffFunc[n.BuffType.Bleed]=function(e,t){if(t.value>=0)return;if(e.IsDie())return;o.StateBit.Damage;var i=1;e.prop.otherAttr==n.OtherAttr.ExtraBuffuerhurt&&(i+=s.CalcExtraHurt.extraBuffer);var a=t.value*i;a=Math.ceil(s.CalcAvoid(e.attr.GetAttack(),e.attr.GetDefence())*(.2*(1-e.attr.hp/e.attr.GetMaxHp())+a)),c(e,a,t.userHandle)},i.BuffFunc[n.BuffType.DelayShield]=function(e,t){if(e.IsDie())return;c(e,t.param,t.userHandle),a.default.log(e.prop.originalName+"\u89e6\u53d1\u5ef6\u65f6\u62a4\u76fe\u7206\u70b8\u4f24\u5bb3: "+t.param)},i.BuffFunc[n.BuffType.Shield]=function(e,t){if(e.IsDie())return;var i=e.NewResultInfo();i.handle=t.userHandle,i.type=r.SKILL_RESULT_IDE.SHIELD,i.state|=o.StateBit.Shield,i.data.shieldChange=e.attr.GetBuffValue(n.BuffType.Shield),a.default.log("\u79fb\u9664\u62a4\u76febuff",i),e.fight.CollectUpdateResult(i)},i.BuffFunc[n.BuffType.BombMembrane]=function(e,t){if(e.IsDie())return;c(e,t.param,t.userHandle);var i=0==e.camp?1:0,n=e.fight.getEntitysByCamp(i);a.default.log(e.prop.originalName+"\u89e6\u53d1\u7206\u70b8\u819c: "+t.param);for(var o=0,r=n;o<r.length;o++){var s=r[o];c(s,Math.ceil(t.param/n.length),t.userHandle),a.default.log(s.prop.originalName+"\u89e6\u53d1\u7206\u70b8\u819c\u4f24\u5bb3: "+Math.ceil(t.param/n.length))}},cc._RF.pop()},{"../../Global/GlobalValue":"GlobalValue","../Scene/Unit/FightConst":"FightConst","../Scene/Unit/FightLog":"FightLog","./FightUtils":"FightUtils","./calculator":"calculator","./fightlogic":"fightlogic"}],calculator:[function(e,t,i){"use strict";cc._RF.push(t,"e41fdbas01IFZVn1RIIvZBs","calculator"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Global/GlobalValue");i.CalcElemRate=function(e,t){var i=[],o=[],a=0,r=0;for(r=n.AttrType.ThunderAttack;r<=n.AttrType.WindDef;r++)if(r%2!=0)if(void 0!==e[r]){var s=e[r];void 0!==e[400+r-7]?i.push(Math.ceil(s*(1+e[400+r-7]))):i.push(s)}else i.push(0);else void 0!==t[r]?(s=t[r],void 0!==t[400+r-7]?o.push(Math.ceil(s*(1+t[400+r-7]))):o.push(s)):o.push(0);for(r=0;r<i.length;r++){var l=i[r]*i[r]/(i[r]+o[r]);i[r]+o[r]==0&&(l=0),0!=l&&(a+=(l+1e4)/1e4*.33333333-.32333333)}return a=Math.min(2,a),a=Math.max(0,a)},i.CalcCardtype=function(e,t){return 3==e&&1==t?.3:t-e==1&&2!=t?.3:t-e==1&&2==t?3:0},i.CalcFiveLineAttributes=function(e,t){var i=!1;return t-1==0&&5==e?i=!0:e==t-1&&(i=!0),i},function(e){e[e.extraBuffer=.3]="extraBuffer"}(i.CalcExtraHurt||(i.CalcExtraHurt={})),i.CalcAvoid=function(e,t){return e*e/(e+t)},cc._RF.pop()},{"../../Global/GlobalValue":"GlobalValue"}],fightTalk:[function(e,t,i){"use strict";cc._RF.push(t,"90d935emfhCJLkqG+bQjykC","fightTalk"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/ConfigsManager"),o=e("../Scene/Controller/EntityQiPaoController"),a=e("../Scene/View/ActorsLayer"),r=e("../Scene/Controller/FightController"),s=function(){function e(){}return e.Talking=function(e,t){if(this._carconf||(this._carconf=n.ConfigsManager.instance.getConfigs("cardConf")),t)i=a.default.instance.entities[e.handle];else{if(r.default.instance._talkInterval&&e.length<=0)return;var i;(i=e[this.randomNum(e.length)])&&(i=a.default.instance.entities[i.handle])}if(i&&!i.copyEntity&&i){var s=this._carconf.Card[i.prop.cardid];if(i.prop&&0==i.prop.cardid&&console.log("-----------------------\u89d2\u8272\u8fd8\u6ca1\u914d\u5bf9\u8bdd"),s){var l="";if(l=t?s.dieTalk:s.fightTalk){var c=this.splicArr(l),d=c[this.randomNum(c.length)];o.default.instance.showQiPao(i,d,3e3),this.talkArr.push(i)}}else console.log("-------------------------------------------------------------------------------"+i.prop.cardid)}},e.randomNum=function(e){var t=Math.random();return Math.floor(t*e)},e.splicArr=function(e){return e.split(";")},e._carconf=null,e.talkArr=[],e}();i.FightTalk=s,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../Scene/Controller/EntityQiPaoController":"EntityQiPaoController","../Scene/Controller/FightController":"FightController","../Scene/View/ActorsLayer":"ActorsLayer"}],fightattr:[function(e,t,i){"use strict";cc._RF.push(t,"93df9QePv9L8oe+ChSexuAK","fightattr"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Fight/staticattr"),o=e("../../Global/GlobalValue"),a=e("./fightbuff"),r=e("../Status/StatusType"),s=e("../Scene/Unit/FightLog"),l=function(e){function t(t){var i=e.call(this)||this;return i.hp_=0,i.shield_=0,i.entity=t,i.buff=new a.FightBuff(t,function(e,t){i.OnBuffChange(e,t)}),i}return __extends(t,e),Object.defineProperty(t.prototype,"hp",{get:function(){return this.hp_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shield",{get:function(){return this.shield_+Math.ceil(this.GetBuffValue(o.BuffType.Shield))},enumerable:!0,configurable:!0}),t.prototype.ChangeHp=function(e){if(this.entity.prop.addtype==o.ADD_ACTOR_TYPE.WANGHUN)return this.hp_;if(r.ActivityStatus.value==r.ActivityStatus.Guide&&(e=Math.ceil(e/100)),this.shield_>0||this.GetBuffValue(o.BuffType.Shield)>0&&e<0){var t=Math.ceil(this.GetBuffValue(o.BuffType.Shield));s.default.log("\u62a4\u76fe11---"+this.shield_,t,this.shield),t>=Math.abs(e)?(this.buff.SetBuffTypeValue(o.BuffType.Shield,t+e),e=0):(this.buff.SetBuffTypeValue(o.BuffType.Shield,0),e+=t),this.shield_>Math.abs(e)?(this.shield_=this.shield_+e,this.changed=!0,e=0):(this.shield_=0,e+=this.shield_),s.default.log("\u62a4\u76fe2---"+this.shield_,t,this.shield)}var i=this.hp_,n=this.GetMaxHp();if(0==e)return i;if(i<=0&&e<0)return i;if(i>=n&&e>0)return i;var a=i+e;return a<=0&&(a=0),a>n&&(a=n),this.hp_=a,this.changed=!0,a},t.prototype.SetHp=function(e){if(!(e<0)){var t=this.GetMaxHp();e>t&&(e=t),this.hp_=e,this.changed=!0}},t.prototype.SetShield=function(e){this.shield_=Math.ceil(Math.min(Math.ceil(Math.max(e,0)),this.GetMaxHp())),this.changed=!0},t.prototype.GetMaxHp=function(){return Math.ceil(Math.max(Math.min(this.GetAttrVale(o.AttrType.MaxHp)*(1+this.buff.GetBuffValue(o.BuffType.MaxHp_P))+this.buff.GetBuffValue(o.BuffType.MaxHp),2*this.GetAttrVale(o.AttrType.MaxHp)),1))},t.prototype.GetAttack=function(){return Math.ceil(Math.max(Math.min(this.GetAttrVale(o.AttrType.Attack)*(1+this.buff.GetBuffValue(o.BuffType.Attack_P))+this.buff.GetBuffValue(o.BuffType.Attack),2*this.GetAttrVale(o.AttrType.Attack)),1))},t.prototype.GetDefence=function(){return Math.ceil(Math.max(Math.min(this.GetAttrVale(o.AttrType.Defence)*(1+this.buff.GetBuffValue(o.BuffType.Defence_P))+this.buff.GetBuffValue(o.BuffType.Defence),2*this.GetAttrVale(o.AttrType.Defence)),1))},t.prototype.GetBuffValue=function(e){return this.buff.GetBuffValue(e)},t.prototype.OnBuffChange=function(e,t){if(e.type==o.BuffType.MaxHp&&t&&this.ChangeHp(Math.ceil(e.value)),e.type==o.BuffType.MaxHp_P&&t&&this.ChangeHp(Math.ceil(this.GetAttrVale(o.AttrType.MaxHp)*e.value)),!t&&(e.type==o.BuffType.MaxHp||e.type==o.BuffType.MaxHp_P)){var i=this.GetMaxHp();this.hp_>i&&(this.hp_=i)}this.changed=!0},t.prototype.OnChangeAttr=function(e,t,i){if(e==o.AttrType.MaxHp)if(t>0){this.hp_>t&&(this.hp_=t);var n=this.hp_/t;this.hp_=Math.floor(i*n)}else 0==t&&(this.hp_=i)},t}(n.StaticAttr);i.FightAttr=l,cc._RF.pop()},{"../../Global/GlobalValue":"GlobalValue","../Fight/staticattr":"staticattr","../Scene/Unit/FightLog":"FightLog","../Status/StatusType":"StatusType","./fightbuff":"fightbuff"}],fightbuff:[function(e,t,i){"use strict";cc._RF.push(t,"d2959XPlY1MmajKhxmK7+EY","fightbuff"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Global/GlobalValue"),o=e("./fightlogic"),a=e("./bufffunc"),r=e("../Scene/Effect/BuffTypeEffectUtils"),s=e("../Scene/View/ActorsLayer"),l=e("../Scene/Unit/FightConst"),c=e("../Scene/Unit/FightLog"),d=e("../../Core/ConfigsManager");function p(e){return d.ConfigsManager.instance.getConfigs("buffconf").BuffConf[e]}var h=function(){function e(e,t){this.buff=[],this.value=[],this.state=0,this.cb=t,this.entity=e}return e.prototype.Update=function(e){var t=!1,i=[];if(this.buff.length>0)for(var o=this.buff.length-1;o>=0;o--){var r=this.buff[o];if(!r)return;if(null!=r.pass?r.pass+=e:console.warn("buff\u6709\u95ee\u9898",r,o),r.type!=n.BuffType.DelayShield&&r.type!=n.BuffType.Shield&&r.type!=n.BuffType.BombMembrane)for(var s=Math.min(r.pass,r.time),l=s-r.times;l>0;){var c=a.BuffFunc[r.type];c&&c(this.entity,r),r.times++,l=s-r.times}r.pass>=r.time&&(this.buff.splice(o,1),t=!0,i.push(r))}t&&this.OnBuffChange();for(var d=0,p=i;d<p.length;d++){var h=p[d];this.OnRemoveBuff(h)}},e.prototype.UseDelayBuff=function(e){if(e.type==n.BuffType.DelayShield||e.type==n.BuffType.Shield||e.type==n.BuffType.BombMembrane){var t=a.BuffFunc[e.type];t&&t(this.entity,e)}},e.prototype.AddBuff=function(e,t,i,o,a,l){var d=p(e);if(!d)return n.BuffType.Undefined;if(d.type<=n.BuffType.Undefined||d.type>=n.BuffType.Max)return n.BuffType.Undefined;if(this.entity.attr.buff.IsHasBuffByType(n.BuffType.ResistDebuff)&&!d.conduce){var h=s.default.instance.getSceneEntity(this.entity.handle);return r.default.instance.addOneEffect(h,n.BuffEffectName.MIANYIZHUANGTAI),n.BuffType.Undefined}a=d.timeparamlv?Math.round(d.timeparam+d.timeparamlv/1e4*t):a||d.time;var u={id:e,level:t,pass:0,time:a,type:d.type,value:void 0===d.param?0:d.param,range:d.range,conduce:d.conduce,times:0,param:0,admage:0,removegetstatus:d.removegetstatus,isremove:d.isremove,userHandle:o};if(d.isskilllv&&(u.value*=t),d.formula)switch(d.formula){case 1:u.value=.095+.005*Math.floor((t+1)/2);break;case 2:u.value=.02*t;break;case 2:u.value=.195+.005*Math.floor((t+1)/2)}if(d.param1&&(u.value+=d.param1),u.type==n.BuffType.Shield&&(u.value=Math.ceil(i.attr.GetMaxHp()*u.value)),u.value=l||u.value,d.max&&(d.max>0?u.value=Math.max(u.value,d.max):u.value=Math.min(u.value,d.max)),d.coverage){var f=this.buff.find(function(t){return e==t.id});f&&(this.buff.splice(this.buff.indexOf(f),1),this.OnRemoveBuff(f))}if(u.type!=n.BuffType.Poison&&u.type!=n.BuffType.Fire&&u.type!=n.BuffType.Burn||(u.value=Math.floor(i.attr.GetAttack()*i.attr.GetAttack()/(i.attr.GetAttack()+this.entity.attr.GetDefence())*u.value)),u.type==n.BuffType.Recover&&(u.value*=i.attr.GetAttack()),u.type==n.BuffType.Poison){for(var g=[],y=0,m=this.buff;y<m.length;y++){var C=m[y];if(C.type==n.BuffType.Poison){var v={};v.admage=u.value,v.buff=C,g.push(v)}}g.length>=5&&(g.sort(this.sortAdmage),this.buff.splice(this.buff.indexOf(g[0].buff),1),this.OnRemoveBuff(g[0].buff),c.default.log("\u4e2d\u6bd2buff \u8d85\u8fc75\u4e2a\u79fb\u9664",g[0],g,this.buff))}return this.buff.push(u),this.OnBuffChange(),this.OnAddBuff(u),d.type},e.prototype.sortAdmage=function(e,t){return e.admage-t.admage},e.prototype.AddBuffOne=function(e,t,i,o){if(this.AddBuff(e,t,i,o)!=n.BuffType.Undefined||e){var a=this.entity.NewResultInfo();return a.type=l.SKILL_RESULT_IDE.ADDBUFF,a.data.buffId=e,a}},e.prototype.OnAddBuff=function(e){e.type==n.BuffType.ResistDebuff&&this.ClearAllDelBuff(),this.cb&&this.cb(e,!0)},e.prototype.OnRemoveBuff=function(e){this.cb&&this.cb(e,!1);var t=this.entity.NewResultInfo();t.type=l.SKILL_RESULT_IDE.DELBUFF,t.data.buffId=e.id,e.type==n.BuffType.Shield&&(t.state|=o.StateBit.Shield),t.state|=this.state,this.UseDelayBuff(e),this.entity.fight.CollectUpdateResult(t),e.removegetstatus&&this.AddBuff(e.removegetstatus,1,this.entity,this.entity.handle)},e.prototype.OnBuffChange=function(){this.state=0,this.value=[];for(var e=0,t=this.buff;e<t.length;e++){var i=t[e];switch(this.value[i.type]=(this.value[i.type]||0)+i.value,i.type){case n.BuffType.Dizzy:this.state|=o.StateBit.Dizzy;break;case n.BuffType.Poison:this.state|=o.StateBit.Poison;break;case n.BuffType.Fire:this.state|=o.StateBit.Fire;break;case n.BuffType.Taunt:this.state|=o.StateBit.Taunt;break;case n.BuffType.Burn:this.state|=o.StateBit.Burn;break;case n.BuffType.Bleed:this.state|=o.StateBit.Bleed;break;case n.BuffType.Silence:this.state|=o.StateBit.Silence,this.entity.BreakSingSkill()}}},e.prototype.IsHasBuffByType=function(e){return this.buff.length<=0?null:this.buff.find(function(t){return e==t.type})},e.prototype.GetBuffValue=function(e){return this.value[e]||0},e.prototype.SetBuffTypeValue=function(e,t){return this.buff.forEach(function(i){i.type==e&&(i.value=t)}),this.value[e]=t},e.prototype.GetBuff=function(){return this.buff},e.prototype.ClearBuff=function(){for(var e=this.buff.length-1;e>=0;e--){var t=this.buff[e];this.buff.splice(e,1),this.OnRemoveBuff(t)}this.OnBuffChange()},e.prototype.ClearOneDelBuff=function(){for(var e=0;e<this.buff.length;e++){var t=this.buff[e];if(!p(t.id).conduce&&!t.isremove){this.buff.splice(e,1),this.OnRemoveBuff(t);break}}this.OnBuffChange()},e.prototype.ClearConduceDelBuff=function(e){for(var t=0;t<this.buff.length;t++){var i=this.buff[t];if(p(i.id).conduce==e&&!i.isremove){this.buff.splice(t,1),this.OnRemoveBuff(i);break}}this.OnBuffChange()},e.prototype.ClearAllDelBuff=function(){for(var e=0;e<this.buff.length;e++){var t=this.buff[e];p(t.id).conduce||t.isremove||(this.buff.splice(e,1),this.OnRemoveBuff(t))}this.OnBuffChange()},e.prototype.OnDie=function(){this.ClearBuff()},e}();i.FightBuff=h,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Global/GlobalValue":"GlobalValue","../Scene/Effect/BuffTypeEffectUtils":"BuffTypeEffectUtils","../Scene/Unit/FightConst":"FightConst","../Scene/Unit/FightLog":"FightLog","../Scene/View/ActorsLayer":"ActorsLayer","./bufffunc":"bufffunc","./fightlogic":"fightlogic"}],fightentity:[function(e,t,i){"use strict";cc._RF.push(t,"c5f39FUBi1He4qNCD3Np4Dj","fightentity"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./fightlogic"),o=e("./skillfunc"),a=e("./fightattr"),r=e("../Scene/Controller/SkillController"),s=e("../Scene/Manager/SceneManager"),l=e("../../Global/GlobalValue"),c=e("../Scene/Unit/FightLog"),d=e("../Scene/Unit/FightConst"),p=e("../Status/StatusType"),h=e("../../Core/GameEventDispatcher"),u=function(){function e(e,t){this.attr=null,this.data=[],this.camp=e,this.fight=t,this.attr=new a.FightAttr(this)}return e.prototype.Init=function(e){this.handle=e.handle,this.prop=e.prop,this.attr.skills=this.prop.skillList,this.attr.PushAttr(e.attr)},e.prototype.NewResultInfo=function(){return{type:"",handle:this.handle,hp:this.attr.hp,shield:this.attr.shield,maxhp:this.attr.GetMaxHp(),state:this.attr.buff.state,userhandle:0,data:{}}},e.prototype.UseSkill=function(e,t,i){var n=[],a=r.default.instance.getSkillResultBySkillIdAndLv(t,i);if(a){if(r.default.instance.getSkillBySkillId(t).attackTarget==l.ATTACK_TARGE.DRIFTLESS)for(var s=0,c=a;s<c.length;s++){void 0===(g=c[s]).type&&console.warn("\u6280\u80fd\u6ca1\u6709\u914d\u7f6e\u653b\u51fb\u7c7b\u578b:"+t),(y=o.SkillFunc[g.type](this,null,g,t,i))&&(n=n.concat(y))}else for(var d=0,p=e;d<p.length;d++)for(var h=p[d],u=0,f=a;u<f.length;u++){var g,y;void 0===(g=f[u]).type&&console.warn("\u6280\u80fd\u6ca1\u6709\u914d\u7f6e\u653b\u51fb\u7c7b\u578b:"+t),(y=o.SkillFunc[g.type](this,h,g,t,i))&&(n=n.concat(y))}return n}console.error("use skill error skill not exist id:",t," level:",i)},e.prototype.OnDie=function(){this.attr.buff.OnDie(),this.fight.OnEntityDie(this)},e.prototype.OnRelive=function(){this.fight.OnEntityRelive(this)},e.prototype.IsDie=function(){return this.attr.hp<=0},e.prototype.AddSkillInfo=function(e,t,i){var n=[];if(this.skillstatus)n=this.ReleaseSingSkill(e,t,i);else{var o=r.default.instance.getSkillResultBySkillIdAndLv(e,t)[0],a=r.default.instance.GetResultConfParam(o.param,t),s={skillid:e,skilllv:t,pass:0,time:a[1],interval:a[2],type:a[3],totaltime:a[1],use:!1};n=this.ReleaseSingSkill(e,t,i),this.skillstatus=s}return n},e.prototype.ReleaseSingSkill=function(e,t,i){var a=r.default.instance.getSkillResultBySkillIdAndLv(e,t)[0],s=[],l=r.default.instance.GetResultConfParam(a.param,t),c=i;if(0==l[3]){var d=o.SkillFunc[l[3]](this,c,a,e,t);d&&d.length>0&&(s=s.concat(d))}else if(0!=l[3]){var p=c.attr.GetAttack(),h=c.attr.GetAttack(),u=0;0==l[3]||(1==l[3]?u=Math.ceil(p*(l[1]||0)/1e4+h*(l[0]||0)/1e4):2==l[3]?u=Math.ceil(l[0]*c.attr.GetMaxHp()):3==l[3]&&(u=(c.attr.GetMaxHp()-c.attr.hp)*l[0])),u=Math.ceil(u),c.ChangeHp(u,4);var f=c.NewResultInfo();f.type="hp",f.data.hpChange=u,f.state|=n.StateBit.Rescure,s.push(f)}return s},e.prototype.UpdateSing=function(e){if(this.skillstatus){this.skillstatus.use=this.skillstatus.time==this.skillstatus.totaltime,this.skillstatus.pass+=e,this.skillstatus.time-=e,this.skillstatus.pass>=this.skillstatus.interval&&this.skillstatus.time>=0&&(this.skillstatus.use=!0);var t=this.NewResultInfo();this.skillstatus.use&&(this.skillstatus.pass=Math.max(0,this.skillstatus.pass-this.skillstatus.interval)),this.skillstatus.time>0&&(t.state|=n.StateBit.Sing),t.data.skill=this.skillstatus,this.fight.singSkillResult.unshift(t)}},e.prototype.BreakSingSkill=function(){null!=this.skillstatus&&(this.skillstatus.time=0)},e.prototype.ChangeHp=function(e,t){void 0===t&&(t=0),e>0&&this.attr.buff.IsHasBuffByType(l.BuffType.Fire)&&(e=Math.ceil(.2*e));var i=this.attr.hp,n=this.attr.ChangeHp(e);return i<=0&&n>0&&(this.OnRelive(),c.default.log(this.handle+"\u602a\u7269\u590d\u6d3b \u8840\u91cf\u6539\u53d8 \uff1a oldHp"+i+"    newHp"+n+"\u53d7\u5230\u4f24\u5bb3"+e,t)),this.prop&&!this.prop.selfMonster&&e<0&&(s.default.instance.attackenemyhp+=Math.abs(e),s.default.instance.attackEnemyHpOnce+=Math.abs(e),p.ActivityStatus.value==p.ActivityStatus.LoardCrusade&&h.GameEventDispatcher.instance.emit("LoardAllDemage",this)),i>0&&n<=0&&(this.OnDie(),c.default.log(this.handle+"\u602a\u7269\u6b7b\u4ea1 \u8840\u91cf\u6539\u53d8 \uff1a oldHp"+i+"    newHp"+n+"\u53d7\u5230\u4f24\u5bb3"+e,t)),n},e.prototype.CheakSheidHp=function(e,t){var i=[],o=this.NewResultInfo();if(t>0&&0==(o.state&n.StateBit.Die)&&(o.state|=t),this.attr.shield>0){if(e==this.attr.shield)o.data.shieldChange=e;else{var a=e>this.attr.shield?this.attr.shield:e;o.data.shieldChange=a}o.shield-=o.data.shieldChange,this.ChangeHp(-o.data.shieldChange),o.type=d.SKILL_RESULT_IDE.SHIELD,o.state|=n.StateBit.Damage,i.push(o)}for(var r=!0,s=0,p=this.attr.buff.GetBuff();s<p.length;s++){var h=p[s];if(h.type==l.BuffType.DelayShield){h.param+e<this.attr.GetMaxHp()*h.value?(h.param+=e,h.param=h.param>this.attr.GetMaxHp()*h.value?this.attr.GetMaxHp()*h.value:h.param,c.default.log(this.prop.originalName+"\u5ef6\u65f6\u62a4\u76fe\u6dfb\u52a0\u4f24\u5bb3+"+e+"\u5f53\u524d\u603b: "+h.param),r=!1):(e=h.param+e,r=!0);break}h.type==l.BuffType.BombMembrane&&(h.param+=e,c.default.log(this.prop.originalName+"\u70b8\u5f39\u819c\u6dfb\u52a0\u4f24\u5bb3+"+e+"\u5f53\u524d\u603b: "+h.param))}if(r){var u=e-this.attr.shield;this.attr.hp;u=(u=u>this.attr.hp?this.attr.hp:u)>0?-u:0;var f=this.ChangeHp(u,3),g=this.NewResultInfo();t>0&&0==(g.state&n.StateBit.Die)&&(g.state|=t),f<=0?(g.type="hp",g.data.hpChange=u,g.state|=n.StateBit.Damage,g.state|=n.StateBit.Die,i.push(g)):u<0&&(g.type="hp",g.data.hpChange=u,g.state|=n.StateBit.Damage,i.push(g))}else o.type="hp",o.data.hpChange=-e,o.state|=n.StateBit.Damage,i.push(o);return i},e}();i.FightEntity=u,cc._RF.pop()},{"../../Core/GameEventDispatcher":"GameEventDispatcher","../../Global/GlobalValue":"GlobalValue","../Scene/Controller/SkillController":"SkillController","../Scene/Manager/SceneManager":"SceneManager","../Scene/Unit/FightConst":"FightConst","../Scene/Unit/FightLog":"FightLog","../Status/StatusType":"StatusType","./fightattr":"fightattr","./fightlogic":"fightlogic","./skillfunc":"skillfunc"}],fightlogic:[function(e,t,i){"use strict";cc._RF.push(t,"6be14BmQUpJBIeCh2S5J1tP","fightlogic"),Object.defineProperty(i,"__esModule",{value:!0});var n,o,a,r=e("./fightentity"),s=e("../Scene/View/ActorsLayer"),l=e("../../Util/Scene/MoveUtil"),c=e("../Scene/Controller/SkillController"),d=e("../../Global/GlobalValue"),p=e("../WarTeam/MonsterController"),h=e("../../Core/Const/EntityType"),u=e("../Scene/Manager/SceneManager"),f=e("../Scene/SceneEntity"),g=e("../Scene/Unit/FightConst");(function(e){e[e.NoError=0]="NoError",e[e.Invalid=1]="Invalid",e[e.SrcNotFind=2]="SrcNotFind"})(n=i.ResultError||(i.ResultError={})),function(e){e[e.Die=1]="Die",e[e.Relive=2]="Relive",e[e.Damage=4]="Damage",e[e.Dodge=8]="Dodge",e[e.Critical=16]="Critical",e[e.Rescure=32]="Rescure",e[e.Dizzy=64]="Dizzy",e[e.Poison=128]="Poison",e[e.Fire=256]="Fire",e[e.Fly=512]="Fly",e[e.Back=1024]="Back",e[e.Taunt=2048]="Taunt",e[e.Silence=4096]="Silence",e[e.Burn=16384]="Burn",e[e.Drap=32768]="Drap",e[e.Impact=65536]="Impact",e[e.Sing=262144]="Sing",e[e.Shield=524288]="Shield",e[e.Bleed=4194304]="Bleed",e[e.FlyBack=8388608]="FlyBack"}(o=i.StateBit||(i.StateBit={})),function(e){e[e.Self=0]="Self",e[e.Enemy=1]="Enemy"}(a=i.CampEnum||(i.CampEnum={}));var y=function(){function e(){this.valid=!1,this.entity=[],this.entityHandle={},this.entityCampHandle={},this.cardlsit={},this.maxlventity=[],this.campAliveNum=[],this.seed=0,this.updateResult=[],this.singSkillResult=[],this.valid=!0}return e.prototype.Init=function(e,t,i,n){return this.SumFight()},e.prototype.PushEntity=function(e){var t=new r.FightEntity(e.camp,this);return t.Init(e),this.campAliveNum[e.camp]=(this.campAliveNum[e.camp]||0)+1,this.entity.push(t),this.entityCampHandle[e.camp+"_"+e.handle]=1,this.entityHandle[e.handle]=t,this.cardlsit[e.prop.cardid]||(this.cardlsit[e.prop.cardid]=t),e.hp&&t.attr.SetHp(e.hp),this.AddMaxLvEntity(t),this.SumFight()},e.prototype.RemoveEntity=function(e){console.log("\u79fb\u9664\u5206\u8eab",e,this.campAliveNum);var t=this.getFightEntityByHandle(e);this.campAliveNum[t.camp]--,this.entityCampHandle[t.camp+"_"+e]--,this.maxlventity[t.prop.cardid+"_"+t.camp]&&(this.maxlventity[t.prop.cardid+"_"+t.camp]=null);for(var i=0,n=Object.keys(this.campAliveNum);i<n.length;i++){var o=n[i];if(this.campAliveNum[o]<=0){parseInt(o)==a.Self&&this.resCallback?this.resCallback(!1):parseInt(o)==a.Enemy&&this.resCallback&&this.resCallback(!0),this.maxlventity=[];break}}return this.SumFight()},e.prototype.StartFight=function(){this.resCallback&&(!this.campAliveNum[a.Self]||this.campAliveNum[a.Self]<=0?this.resCallback(!1):(!this.campAliveNum[a.Enemy]||this.campAliveNum[a.Enemy]<=0)&&this.resCallback(!0),this.CheckFightSkillResult(this.maxlventity))},e.prototype.CheckFightSkillResult=function(e){for(var t in e)for(var i=e[t],n=0,o=i.prop.skillList;n<o.length;n++){var a=o[n],r=c.default.instance.getSkillBySkillId(a.skillid);if(r&&void 0!==r.passivity&&r.passivity==d.PassivityType.FightStart)for(var s=0,l=c.default.instance.getSkillResultBySkillIdAndLv(a.skillid,a.skilllv);s<l.length;s++){var h=l[s];if(h.firstresult)switch(h.firstresult){case 1:for(var u in e){var f=e[u],g=p.default.instance.getCardConfCardType(i.prop.cardid),y=p.default.instance.getCardConfCardType(f.prop.cardid);if(i.camp!=f.camp||g!=y||i.prop.cardid==f.prop.cardid);else for(var m=0,C=i.fight.entity;m<C.length;m++){var v=C[m];if(y=p.default.instance.getCardConfCardType(v.prop.cardid),v.camp==i.camp&&g==y){var _=c.default.instance.GetResultConfParam(h.param,a.skilllv);this.CollectUpdateResult(v.attr.buff.AddBuffOne(_[0],a.skilllv,i,i.handle)),this.CollectUpdateResult(v.attr.buff.AddBuffOne(_[1],a.skilllv,i,i.handle))}}}}}}},e.prototype.AddMaxLvEntity=function(e){if(e.prop.type!=h.EntityType.enActor)if(this.maxlventity[e.prop.cardid+"_"+e.camp]){var t=this.maxlventity[e.prop.cardid+"_"+e.camp];t.prop.grade<e.prop.grade?t=e:t.prop.grade==e.prop.grade&&t.prop.cultivateLv<e.prop.cultivateLv&&(t=e)}else this.maxlventity[e.prop.cardid+"_"+e.camp]=e},e.prototype.SetCallBack=function(e){this.resCallback=e},e.prototype.SetFightSkillCallBack=function(e){this.fightSkillCallBack=e},e.prototype.SandTableChangeMonsterCamp=function(e){var t=this.getFightEntityByHandle(e);return this.campAliveNum[t.camp]--,t.camp=0,this.maxlventity[t.prop.cardid+"_"+t.camp]&&(this.maxlventity[t.prop.cardid+"_"+t.camp]=null),this.AddMaxLvEntity(t),{fight:this.SumFight(),result:[]}},e.prototype.AddBuffByHandle=function(e,t,i){var n=this.getFightEntityByHandle(e);n.attr.buff.AddBuff(t,i,n);var o=n.NewResultInfo();return o.type="addbuff",o.data.buffId=t,{fight:this.SumFight(),result:[o]}},e.prototype.ChangeHp=function(e,t,i,n){void 0===i&&(i=0),void 0===n&&(n=-1);var a=[],r=0;if(r|=0!=i?i>0?o.Rescure:o.Damage:t>0?o.Rescure:o.Damage,-1!=n){var s=this.getFightEntityByHandle(n);if(!s)return;0!=i&&(t=Math.max(s.attr.GetMaxHp()*Math.abs(i),99),t=Math.min(t,99999)),0!=(r&o.Damage)&&(t=-t),t=Math.ceil(t);var l=s.ChangeHp(t,5);(h=s.NewResultInfo()).type="hp",h.data.hpChange=Math.ceil(t),h.state|=r,l<=0&&(h.state|=o.Die),a.push(h)}else for(var c=0,d=this.entity;c<d.length;c++){var p=d[c];if(e==p.camp&&!p.IsDie()){0!=i&&(t=Math.max(p.attr.GetMaxHp()*Math.abs(i),99),t=Math.min(t,99999)),0!=(r&o.Damage)&&(t=-t),t=Math.ceil(t);var h,u=p.attr.hp;l=p.ChangeHp(t,5);if((h=p.NewResultInfo()).type="hp",t>0&&u+t>l){var f=l-u;t=f>0?f:0}h.data.hpChange=Math.ceil(t),h.state|=r,l<=0&&(h.state|=o.Die),a.push(h)}}return{fight:this.SumFight(),result:a}},e.prototype.Spell=function(e,t,i,o){var a={errno:n.NoError,skillId:i,skilllv:o,fight:this.SumFight(),srcHandle:e,result:[]};if(!this.valid)return a.errno=n.Invalid,a;var r=this.entity.find(function(t){return e==t.handle});if(!r)return a.errno=n.SrcNotFind,a;for(var s=[],l=function(e){var t=c.entity.find(function(t){return e==t.handle});t&&s.push(t)},c=this,d=0,p=t;d<p.length;d++){l(p[d])}return a.result=r.UseSkill(s,i,o),a.fight=this.SumFight(),a},e.prototype.OnEntityDie=function(e){var t=this.SumFight();if(this.campAliveNum[e.camp]--,console.log("111\u5b9e\u4f53\u6b7b\u4ea1",e.prop.originalName,e.prop.handle,t,this.campAliveNum),this.entityCampHandle[e.camp+"_"+e.prop.handle]--,this.campAliveNum[e.camp]<=0){if(e.camp==a.Self&&this.resCallback)return void this.resCallback(!1);if(e.camp==a.Enemy&&this.resCallback)return void this.resCallback(!0);this.maxlventity=[]}if(this.resCallback){if(0==t[a.Self])return console.warn("\u81ea\u5df1\u6218\u529b\u4e3a0"),void this.OnFightResult(!1);if(0==t[a.Enemy])return console.warn("\u654c\u4eba\u6218\u529b\u4e3a0"),u.default.instance.rightFight=0,void this.OnFightResult(!0)}0==u.default.instance.leftlives.length&&u.default.instance.myRole&&!u.default.instance.myRole.getComponent(f.default).prop.isLive?(console.log("==========\u6218\u6597\u6570\u636e\u51fa\u9519\uff1a"),this.resCallback(!1)):0==u.default.instance.rightlives.length&&u.default.instance.otherRole&&!u.default.instance.otherRole.getComponent(f.default).prop.isLive&&(console.log("==========\u6218\u6597\u6570\u636e\u51fa\u9519\uff1a"),this.resCallback(!0))},e.prototype.OnFightResult=function(e){this.resCallback&&this.resCallback(e),this.maxlventity=[]},e.prototype.OnEntityRelive=function(e){this.campAliveNum[e.camp]++,console.log("111\u5b9e\u4f53\u590d\u6d3b",e.prop.originalName,e.prop.handle,this.campAliveNum)},e.prototype.UpdateSing=function(e){for(var t=[],i={},n=0,o=this.entity;n<o.length;n++){var a=o[n];!a.IsDie()&&void 0!==a.skillstatus&&a.skillstatus&&(a.UpdateSing(e),this.singSkillResult.length>0&&a.skillstatus.time>0&&(i={errno:0,skillId:a.skillstatus.skillid,skilllv:a.skillstatus.skilllv,srcHandle:a.handle,fight:this.SumFight(),result:this.singSkillResult},t.push(i)),a.skillstatus.time<=0&&(this.BreakSingSkill(a),i={errno:0,skillId:this.singSkillResult[0].data.skill.skillid,skilllv:this.singSkillResult[0].data.skill.skilllv,srcHandle:a.handle,fight:this.SumFight(),result:this.singSkillResult},t.push(i)))}return this.singSkillResult=[],t},e.prototype.BreakSingSkill=function(e){var t=e.NewResultInfo();t.data.skill=e.skillstatus,e.skillstatus.pass=0,e.skillstatus=null,t.type=g.SKILL_RESULT_IDE.SINGCOM,this.singSkillResult.unshift(t)},e.prototype.Update=function(e){this.updateResult=[];for(var t=0,i=this.entity;t<i.length;t++){var n=i[t];n.IsDie()||n.attr.buff.Update(e)}return{fight:this.SumFight(),result:this.updateResult}},e.prototype.CollectUpdateResult=function(e){this.updateResult.push(e)},e.prototype.SumFight=function(){for(var e=[],t=0,i=this.entity;t<i.length;t++){var n=i[t],o=e[n.camp]||0,a=n.attr.GetFight();e[n.camp]=o+a}return e},e.prototype.GetRangeEnemy=function(e,t,i,n,o){void 0===i&&(i=5e3),void 0===n&&(n=!0),void 0===o&&(o=!0);for(var a=[],r=s.default.instance.getSceneEntity(e.handle).prop.x,c=s.default.instance.getSceneEntity(e.handle).prop.y,d=0;d<this.entity.length;d++){var p=this.entity[d],h=o?p.camp==e.camp:p.camp!=e.camp;if(p.attr.hp>0&&h&&e.handle!=p.handle){var u=s.default.instance.getSceneEntity(p.handle);if(u&&u.prop){var f=u.prop.x,g=u.prop.y;l.MoveUtil.getPixelDis(r,c,f,g)<=t&&a.push(p)}}}return a.sort(this.sortPixelDisCompare(r,c,n)),a.slice(0,i)},e.prototype.GetCampCopyEnemy=function(e,t){void 0===t&&(t=!0);for(var i=[],n=0;n<this.entity.length;n++){var o=this.entity[n],a=t?o.camp==e.camp:o.camp!=e.camp;o.attr.hp>0&&a&&e.handle!=o.handle&&e.prop.copyEntity&&i.push(o)}return i},e.prototype.GetFamilyEnemy=function(e,t){void 0===t&&(t=!0);for(var i=[],n=0;n<this.entity.length;n++){var o=this.entity[n],a=t?o.camp==e.camp:o.camp!=e.camp;o.attr.hp>0&&a&&e.prop.cardid==o.prop.cardid&&i.push(o)}return i},e.prototype.sortPixelDisCompare=function(e,t,i){return void 0===i&&(i=!0),function(n,o){var a=s.default.instance.getSceneEntity(n.handle).prop.x,r=s.default.instance.getSceneEntity(n.handle).prop.y,c=s.default.instance.getSceneEntity(o.handle).prop.x,d=s.default.instance.getSceneEntity(o.handle).prop.y,p=l.MoveUtil.getPixelDis(e,t,a,r),h=l.MoveUtil.getPixelDis(e,t,c,d);return i?p-h:h-p}},e.prototype.getFightEntityByHandle=function(e){return this.entityHandle[e]},e.prototype.getEntitysByCamp=function(e){for(var t=[],i=0,n=this.entity;i<n.length;i++){var o=n[i];o.camp==e&&o.attr.hp>0&&t.push(o)}return t},e}();i.FightLogic=y,cc._RF.pop()},{"../../Core/Const/EntityType":"EntityType","../../Global/GlobalValue":"GlobalValue","../../Util/Scene/MoveUtil":"MoveUtil","../Scene/Controller/SkillController":"SkillController","../Scene/Manager/SceneManager":"SceneManager","../Scene/SceneEntity":"SceneEntity","../Scene/Unit/FightConst":"FightConst","../Scene/View/ActorsLayer":"ActorsLayer","../WarTeam/MonsterController":"MonsterController","./fightentity":"fightentity"}],finnishanim:[function(e,t,i){"use strict";cc._RF.push(t,"76f7f6JMfJBmoS3tIlMT0J6","finnishanim"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=cc._decorator,a=o.ccclass,r=o.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.text="hello",t}return __extends(t,e),t.prototype.start=function(){},t.prototype.finnishanim=function(){},__decorate([r(cc.Label)],t.prototype,"label",void 0),__decorate([r],t.prototype,"text",void 0),t=__decorate([a],t)}(n.default);i.default=s,cc._RF.pop()},{"../../Core/Widget":"Widget"}],grailAttributeNode:[function(e,t,i){"use strict";cc._RF.push(t,"1663aiPNfNJvaqtvA5R0g4p","grailAttributeNode"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Artifact/ArtifactCtrl"),o=cc._decorator,a=o.ccclass,r=o.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.imgs=null,t.icon=null,t.label=null,t.label2=null,t}return __extends(t,e),t.prototype.start=function(){},t.prototype.setData=function(e,t){var i=n.default.instance.getData().getAttrInocnIdxByType(e);this.icon.spriteFrame=this.imgs.getSpriteFrame("fiveLine_"+i),this.label.string=t[0]+"",this.label2.string=t[1]+""},__decorate([r(cc.SpriteAtlas)],t.prototype,"imgs",void 0),__decorate([r(cc.Sprite)],t.prototype,"icon",void 0),__decorate([r(cc.Label)],t.prototype,"label",void 0),__decorate([r(cc.Label)],t.prototype,"label2",void 0),t=__decorate([a],t)}(cc.Component);i.default=s,cc._RF.pop()},{"../Artifact/ArtifactCtrl":"ArtifactCtrl"}],interfaceEffect:[function(e,t,i){"use strict";cc._RF.push(t,"7d10cgHYcBG5KCoaKIHKZKw","interfaceEffect"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Core/GameEventDispatcher"),a=e("./EventInterface"),r=e("../../../Core/SimpleActionEffect"),s=cc._decorator,l=s.ccclass,c=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.activityEffect=null,t.artifactEffect=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.show=function(){e.prototype.show.call(this),o.GameEventDispatcher.instance.on(a.EventInterface.ShowActivityEffect,this.showActivityEffect,this),o.GameEventDispatcher.instance.on(a.EventInterface.ShowArtifactEffect,this.showArtifactEffect,this)},t.prototype.hide=function(){e.prototype.hide.call(this),o.GameEventDispatcher.instance.off(a.EventInterface.ShowActivityEffect,this.showActivityEffect,this),o.GameEventDispatcher.instance.off(a.EventInterface.ShowArtifactEffect,this.showArtifactEffect,this),this.stopActivityEffect(),this.stopArtifactEffect()},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.showActivityEffect=function(){this.activityEffect.getComponent(r.default).playById(8,"activity",!0,null,this)},t.prototype.stopActivityEffect=function(){this.activityEffect.getComponent(r.default).gotoAndStop(8,"activity")},t.prototype.showArtifactEffect=function(){this.artifactEffect.getComponent(r.default).playById(7,"artifact",!0,null,this)},t.prototype.stopArtifactEffect=function(){this.artifactEffect.getComponent(r.default).gotoAndStop(7,"artifact")},__decorate([c(cc.Node)],t.prototype,"activityEffect",void 0),__decorate([c(cc.Node)],t.prototype,"artifactEffect",void 0),t=__decorate([l],t)}(n.default);i.default=d,cc._RF.pop()},{"../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/SimpleActionEffect":"SimpleActionEffect","../../../Core/Widget":"Widget","./EventInterface":"EventInterface"}],loadingtipconf:[function(e,t,i){"use strict";cc._RF.push(t,"afbeaUJueFHoIejC9CGQUl6","loadingtipconf"),Object.defineProperty(i,"__esModule",{value:!0}),i.loadingtipconf={loadingtip:{1:[{desc:"\u9996\u6b21\u52a0\u8f7d\u8d44\u6e90\u8f83\u5927\uff0c\u8bf7\u8010\u5fc3\u7b49\u5019",intervalTime:5e3},{desc:"\u53f2\u8bd7\u3001\u4f20\u8bf4\u5f62\u6001\u5361\u724c\u81ea\u5e26\u514d\u4f24\u6548\u679c"},{desc:"\u53f2\u8bd7\u3001\u4f20\u8bf4\u5f62\u6001\u5361\u724c\u53ef\u91ca\u653e\u5927\u62db"},{desc:"\u5929\u68af\u548c\u7ade\u6280\u573a\u53ef\u4ee5\u83b7\u5f97\u8363\u8a89\u5956\u52b1"},{desc:"\u68cb\u76d8\u6bcf\u6b21\u5408\u6210\u6d88\u9664\u53ef\u53ec\u5524\u602a\u7269\u4e0a\u9635\u6218\u6597"},{desc:"\u68cb\u76d8\u6d88\u9664\u6570\u91cf\u5927\u4e8e3\u4e2a\u53ef\u989d\u5916\u589e\u52a0\u53ec\u5524\u602a\u7269\u6570\u91cf"}]}},cc._RF.pop()},{}],map:[function(e,t,i){"use strict";cc._RF.push(t,"a9406r+7uRK0J8bT28J/Tz2","map"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/GameEventDispatcher"),o=cc._decorator,a=o.ccclass,r=o.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.info=null,t.bg=null,t.spoint=0,t}return __extends(t,e),t.prototype.start=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.OnSceneTouchStart,this)},t.prototype.OnSceneTouchStart=function(e){this.node.convertTouchToNodeSpace(e.touch);n.GameEventDispatcher.instance.emit("CESHIKAISHI",{ball:this,spoint:this.spoint})},t.prototype.setSymbolPo=function(e){this.spoint=e},t.prototype.setVisible=function(e){this.bg.node.active=e,this.info.node.active=e},t.prototype.getSpoint=function(){return this.spoint},t.prototype.getType=function(){return this.bg.node.active},t.prototype.getString=function(){return this.info.string},t.prototype.setString=function(e){this.info.string=e},t.prototype.setSymbolSize=function(e,t){this.bg.node.height=e,this.bg.node.width=t,this.node.height=e,this.node.width=t,this.info.node.width=.8*t},__decorate([r(cc.EditBox)],t.prototype,"info",void 0),__decorate([r(cc.Sprite)],t.prototype,"bg",void 0),t=__decorate([a],t)}(cc.Component);i.default=s,cc._RF.pop()},{"../../Core/GameEventDispatcher":"GameEventDispatcher"}],rechargeItem:[function(e,t,i){"use strict";cc._RF.push(t,"a2280HX+9tAZq1Oe/mHYL0j","rechargeItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Widget"),o=e("../../Core/Language"),a=e("../../Util/SDKUtils"),r=e("../../NetConnect/NetConnet"),s=e("../Tips/OpTipsController"),l=cc._decorator,c=l.ccclass,d=l.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.monenyLabe=null,t.diamondNode1=null,t.diamondNode2=null,t.diamonLabe1=null,t.diamonLabe2=null,t.titleLabe=null,t.diamonAtlas=null,t.index=-1,t.rechargeid=-1,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this)},t.prototype.hide=function(){e.prototype.hide.call(this)},t.prototype.SetInfo=function(e,t,i,n,o){this.index=n,this.titleLabe.string=e,this.monenyLabe.string=t,this.diamonLabe1.string=i+"",this.diamonLabe2.string=i+"",this.diamondNode1.getComponent(cc.Sprite).spriteFrame=this.diamonAtlas.getSpriteFrame("diamond"+(this.index+1)),this.diamondNode2.getComponent(cc.Sprite).spriteFrame=this.diamonAtlas.getSpriteFrame("diamond"+(this.index+1))},t.prototype.RechargeBtnClick=function(){if(a.default.instance.isInitWX)a.default.instance.rechargeByIndex(this.rechargeid,function(e){e&&s.default.instance.ShowMsg(o.default.getStr("\u5145\u503c\u6210\u529f"))},this);else{var e={cmd:"gm",type:"diamondshop",param:[Number(this.index)]};r.default.instance.sendProto(e),s.default.instance.ShowMsg(o.default.getStr("\u5145\u503c\u6210\u529f"))}},__decorate([d(cc.Label)],t.prototype,"monenyLabe",void 0),__decorate([d(cc.Node)],t.prototype,"diamondNode1",void 0),__decorate([d(cc.Node)],t.prototype,"diamondNode2",void 0),__decorate([d(cc.Label)],t.prototype,"diamonLabe1",void 0),__decorate([d(cc.Label)],t.prototype,"diamonLabe2",void 0),__decorate([d(cc.Label)],t.prototype,"titleLabe",void 0),__decorate([d(cc.SpriteAtlas)],t.prototype,"diamonAtlas",void 0),t=__decorate([c],t)}(n.default);i.default=p,cc._RF.pop()},{"../../Core/Language":"Language","../../Core/Widget":"Widget","../../NetConnect/NetConnet":"NetConnet","../../Util/SDKUtils":"SDKUtils","../Tips/OpTipsController":"OpTipsController"}],rechargecarnivalWin:[function(e,t,i){"use strict";cc._RF.push(t,"3eb1cRucedGhoE4aHFW01Ff","rechargecarnivalWin"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../../Core/ConfigsManager"),a=e("./rechargeItem"),r=e("../../Core/Language"),s=e("../Shop/ShopController"),l=e("../../Core/GameEventDispatcher"),c=e("../../Core/Event"),d=e("../ActivityView/ActivityCtrl"),p=e("../../Core/WindowType"),h=e("../../Core/LoadManager"),u=e("../../Util/Utils"),f=cc._decorator,g=f.ccclass,y=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rechargeItem=null,t.content=null,t.timeLabe=null,t.conf=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),this.conf=o.ConfigsManager.instance.getConfigs("rechargecarnivalconf").rechargecarnival[1],l.GameEventDispatcher.instance.on(c.EventDefiner.TopUpFlag,this.Info,this),this.Info();var t=d.default.instance.data.getYunyingData(p.WindowType.RechargeWin);t&&(this.timeLabe.string=new Date(1e3*t.starttime).getFullYear()+"/"+(new Date(1e3*t.starttime).getMonth()+1)+"/"+new Date(1e3*t.starttime).getDate()+"-"+new Date(1e3*t.endtime).getFullYear()+"/"+(new Date(1e3*t.endtime).getMonth()+1)+"/"+new Date(1e3*t.endtime).getDate())},t.prototype.hide=function(){e.prototype.hide.call(this),l.GameEventDispatcher.instance.off(c.EventDefiner.TopUpFlag,this.Info,this)},t.prototype.Info=function(){var e=this;u.default.setNodeChildDestoryByUrl(this.content,"prefab/rechargecarnival/rechargeItem"),h.default.instance.loadResByType("prefab/rechargecarnival/rechargeItem",cc.Prefab,function(t){for(var i in e.rechargeItem=t,e.conf)if(s.default.instance.diamondData&&!s.default.instance.diamondData[i]){var n=u.default.getNodeByUrl(e.rechargeItem,"prefab/rechargecarnival/rechargeItem");e.content.addChild(n),n.active=!0,n.getComponent(a.default).SetInfo(r.default.getStr("7103",e.conf[i].moneny,e.conf[i].diamond),e.conf[i].moneny,e.conf[i].diamond/2,Number(i),e.conf[i].rechargeid)}},this)},__decorate([y(cc.Node)],t.prototype,"content",void 0),__decorate([y(cc.Label)],t.prototype,"timeLabe",void 0),t=__decorate([g],t)}(n.default);i.default=m,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/Event":"Event","../../Core/GameEventDispatcher":"GameEventDispatcher","../../Core/Language":"Language","../../Core/LoadManager":"LoadManager","../../Core/Window":"Window","../../Core/WindowType":"WindowType","../../Util/Utils":"Utils","../ActivityView/ActivityCtrl":"ActivityCtrl","../Shop/ShopController":"ShopController","./rechargeItem":"rechargeItem"}],resultfunc:[function(e,t,i){"use strict";cc._RF.push(t,"834c9S3Re1AyY9rKdCafzhI","resultfunc"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./fightlogic"),o=e("../../Global/GlobalValue"),a=e("../Scene/Controller/FightController"),r=e("../Scene/Controller/SkillController"),s=e("./staticattr"),l=e("../WarTeam/MonsterController"),c=e("../../Core/Const/EntityType"),d=e("../Scene/Unit/FightLog"),p=e("../Scene/Controller/ServerFightController"),h=e("./calculator"),u=e("../Scene/View/FightView");function f(e){return p.default.instance.Random()<=e}function g(e,t,i,n,a,r,s){if(void 0===s&&(s=0),t.data[e+"-"+n]!=r[1]){t.data[e+"-"+n]||(t.data[e+"-"+n]=0),t.data[n]||(t.data[n]=0);var l=0,c=r[1];s||(s=c),t.data[e+"-"+n]+r[0]>s?(l=r[1]-t.data[e+"-"+n],t.data[e+"-"+n]=s,t.data[n]=0):(l=r[0],t.data[e+"-"+n]+=l,n>=o.AttrType.MS_MaxHp_P&&n<=o.AttrType.MS_DefCri_P&&(t.data[n]=l)),d.default.log("skillid"+e+"\u5c5e\u6027\u7c7b\u578btype:"+n+"\u589e\u52a0\uff1a"+l+"\u603b\u589e\u52a0\uff1a",t.data,t.data[e+"-"+n]),t.attr.ChangeAtt(n,t.data[e+"-"+n])}}function y(e,t,i,n,l,c,d){void 0===t&&(t=1),void 0===i&&(i=0),void 0===c&&(c=null),void 0===d&&(d=1);var h=l||e.prop.cultivateLv,f=n||e.prop.grade,g=new s.StaticAttr;g.PushCard(e.prop.cardid,h,f),g.ChangeAtt(o.AttrType.Attack,g.GetAttack()*d);for(var y=Math.ceil(t*g.GetMaxHp()),m=e.prop.handle+Math.ceil(100*p.default.instance.Random())+u.default.instance.loopIntervalCount;e.fight.getFightEntityByHandle(m);)m+=1e4,console.warn("\u6dfb\u52a0\u5b9e\u4f53handle \u76f8\u540c\u52a010000"+m);var C,v=0;i==o.ADD_ACTOR_TYPE.NONE&&(v=e.prop.cultivateLv),C=r.default.instance.getSkills(e.prop,v,!1,!1);var _={cardid:e.prop.cardid,grade:f,level:h,num:1,self:e.prop.selfMonster,x:e.prop.x,y:0,attr:g,autoUseSkill:!1,skills:C,handle:m};a.default.instance.fightingAddActor(_,i,y,c,!0)}function m(e,t,i,n,a,r,s,l){d.default.log("\u5c0f\u6280\u80fd\u89e6\u53d1\u6dfb\u52a0Buff : "+r),d.default.log("\u6dfb\u52a0buff : "+r),t.attr.buff.AddBuff(r,n,e,e.handle,s,l)!=o.BuffType.Undefined&&(a.addbuffentitys.push(t),a.buffId.push(r))}function C(e,t,i){var n=!1;return e.data["trigger"+t]?e.data["trigger"+t]>i&&(e.data["trigger"+t]++,n=!0):(e.data["trigger"+t]=1,n=!0),console.log("\u88ab\u52a8\u6280\u80fd "+t+"      \u5269\u4f59\u4f5c\u7528\u6b21\u6570"+(i-e.data["trigger"+t])+"     \u6700\u5927\u6b21\u6570"+i),n}function v(e,t){return void 0===t&&(t=!1),e.data.attakCount?e.data.attakCount++:e.data.attakCount=1,t&&(e.data.attakCount=0),e.data.attakCount}i.ResultFunc=[],i.ResultFunc[o.PassivityType.Die]=function(e,t,i,n,a,s,l,c){var p=r.default.instance.GetResultConfParam(i.param,l),h=[];switch(i.dieresult){case 1:if(t.prop.grade>1)for(var u=0;u<p[1];u++){d.default.log("\u6b7b\u4ea1\u540e\u53ec\u55241\u4e2aX%\u8840\u91cf\u524d\u4e00\u9636\u5f62\u6001\u7684\u76f8\u540c\u602a\u7269",p[0]);var C=Math.max(t.prop.grade-1,1);y(t,p[0],o.ADD_ACTOR_TYPE.JINGXIANG,C,null,p[2])}break;case 2:if(f(p[0])&&e.prop.isLive)for(var v=t.prop.grade,u=0;u<e.fight.entity.length;u++){var _=e.fight.entity[u];if(_.camp==t.camp&&v<_.prop.grade&&t.prop.cardid==_.prop.cardid&&_.prop.isLive&&_.attr.hp>0&&_.attr.hp>c.damage){d.default.log("\u4f4e\u4e8e\u81ea\u8eab\u5f62\u6001\u7684\u5bb6\u65cf\u6210\u5458\u6b7b\u4ea1\u65f6\uff0c\u6709X%\u6982\u7387\u6062\u590d\u81ea\u8eab\u6700\u5927\u8840\u91cf\u7684X%",i);var b=p[1]*t.attr.GetMaxHp();c.dieresultAddHp.push([_,b]),d.default.log("\u52a0\u8840\u5bf9\u8c61"+_.prop.originalName,_.attr.hp,_.prop.isLive)}}break;case 3:for(var T=0,S=h=e.fight.GetRangeEnemy(t,p[2],p[1],!0,!1);T<S.length;T++){var _=S[T];d.default.log("\u6b7b\u4ea1\u540e\u5bf9\u81ea\u8eab\u5468\u56f4X\u4e2a\u654c\u65b9\u5355\u4f4d\u9020\u6210\u81ea\u7206\u4f24\u5bb3\uff0c\u4f24\u5bb3\u4e3a\u81ea\u8eab\u8840\u91cf\u7684X%",i);var b=Math.ceil(p[0]*t.attr.GetMaxHp());c.deiresultDelHp.push([_,b]),d.default.log(_.prop.originalName,b)}break;case 4:h=t.fight.GetRangeEnemy(t,p[2],p[1]);for(var u=0;u<h.length;u++)d.default.log("\u81ea\u8eab\u6b7b\u4ea1\uff0c\u589e\u52a0\u9644\u8fd1X\u4e2a\u53cb\u519bX%\u7684\u653b\u51fb\u529b\uff0c\u6301\u7eedX\u79d2",i),m(t,h[u],s,l,c,p[0]);break;case 5:for(var I=0,w=t.fight.entity;I<w.length;I++){var _=w[I];_.camp==t.camp&&t.prop.cardid==_.prop.cardid&&_.handle!=t.handle&&(d.default.log("\u6bcf\u6b7b\u4ea1\u4e00\u4e2a\u672c\u5bb6\u65cf\u7684\u6210\u5458\uff0c\u589e\u52a0X%\u7684\u653b\u51fb\u529b\uff0c\u81f3\u591a\u589e\u52a0X%",i),g(s,_,i,o.AttrType.MS_Attack_P,l,p))}break;case 6:f(p[0])&&t.prop.addtype!=o.ADD_ACTOR_TYPE.RESCURE&&(d.default.log("\u6b7b\u4ea1\u540e\u6709X%\u6982\u7387\u7acb\u5373\u539f\u5730\u590d\u6d3b\uff0c\u590d\u6d3b\u540e\u56de\u590dX%\u8840\u91cf\uff08\u6bcf\u573a\u6218\u6597\u53ea\u80fd\u590d\u6d3b1\u6b21\uff09",i),y(t,p[1],o.ADD_ACTOR_TYPE.RESCURE,null,null,p[2]));break;case 7:d.default.log("\u6b7b\u4ea1\u540e\uff0c\u53ec\u5524\u4e00\u4e2a\u4ea1\u9b42 \uff08\u4ea1\u9b42\u65e0\u6cd5\u4f7f\u7528\u4f7f\u7528\u88ab\u52a8\u6280\u80fd\uff0c\u514d\u75ab\u6240\u6709\u4f24\u5bb3\uff0c\u6301\u7eedX\u79d2\uff09",i);for(var u=0;u<p[1];u++)y(t,p[0],o.ADD_ACTOR_TYPE.WANGHUN,null,null,p[2]);break;case 8:h=e.fight.GetRangeEnemy(t,p[0],p[1],!0,!1),d.default.log("\u6b7b\u4ea1\u81ea\u7206\uff0c\u7ed9\u5468\u56f4X\u4e2a\u654c\u4eba\u9020\u6210X%\u4f24\u5bb3\uff0c\u5e76\u9020\u6210buffID\uff08\u7729\u6655\uff0c\u4e2d\u6bd2\uff0c\u6d41\u8840\uff09\uff0cx\u79d2",i),c.sputteringprecent=p[2],c.sputteringentitys=h;for(var D=0,R=h;D<R.length;D++){var _=R[D];m(t,_,s,l,c,p[3])}}return c},i.ResultFunc[o.PassivityType.FinalHit]=function(e,t,i,n,a,s,l,c){var p,h,u=r.default.instance.GetResultConfParam(i.param,l);switch(i.finalhitresult){case 1:d.default.log("\u6bcf\u6d88\u706d\u4e00\u4e2a\u654c\u65b9\u5355\u4f4d\uff0c\u589e\u52a0X%\u7684\u66b4\u51fb\uff0c\u81f3\u591a\u589e\u52a0X%"),g(s,e,i,o.AttrType.Crit_P,l,u);break;case 2:d.default.log("\u6bcf\u6d88\u706d\u4e00\u4e2a\u654c\u65b9\u76ee\u6807\uff0c\u53ec\u55241\u4e2aX%\u8840\u91cf\u201c\u666e\u901a\u5f62\u6001\u201d\u7684\u5bb6\u65cf\u6210\u5458\u4f5c\u6218"),h=u[0]||1,p=u[2]||1;for(var f=0;f<p;f++)y(e,h,o.ADD_ACTOR_TYPE.JINGXIANG,1,null,u[1]);break;case 3:d.default.log("\u6bcf\u6d88\u706d\u4e00\u4e2a\u654c\u65b9\u76ee\u6807\uff0c\u53ec\u55241\u4e2a\u8840\u91cf\u4e3aX%\u7684\u540c\u5f62\u6001\u5bb6\u65cf\u6210\u5458"),h=u[0]||1,p=u[2]||1;for(var f=0;f<p;f++)y(e,h,o.ADD_ACTOR_TYPE.JINGXIANG,null,null,u[1]);break;case 4:d.default.log("2.\t\u6bcf\u51fb\u6740\u4e00\u4e2a\u654c\u65b9\u76ee\u6807\uff0c\u589e\u52a0X%\u7684\u4f24\u5bb3\uff0c\u81f3\u591a\u589e\u52a0X%"),g(s,e,i,o.AttrType.MS_Harm_P,l,u);break;case 5:if(e.prop.isLive){var m=u[0]*e.attr.GetMaxHp();c.dieresultAddHp.push([e,m]),d.default.log("\u6bcf\u6d88\u706d\u4e00\u4e2a\u654c\u65b9\u5355\u4f4d\uff0c\u6062\u590d\u81ea\u8eab\u6700\u5927\u8840\u91cf\u7684X%")}break;case 6:e.prop.isLive&&(y(e,u[0],o.ADD_ACTOR_TYPE.JINGXIANG,null,null,u[2],u[1]),d.default.log("\u6bcf\u6d88\u706d\u4e00\u4e2a\u654c\u4eba\uff0c\u53ec\u5524\u4e00\u4e2a\u81ea\u8eab\u955c\u50cf\u5206\u8eab\uff0c\u53ea\u6709\u81ea\u8eabX%\u8840\u91cf\uff0cX%\u653b\u51fb\u529b"))}return c},i.ResultFunc[o.PassivityType.HpChange]=function(e,t,i,n,o,a,s,l,c){var p=r.default.instance.GetResultConfParam(i.param,s);switch(i.hpchangeresult){case 1:c&&(l.addattackp=Math.max(.1,Math.min(p[1],e.attr.hp/e.attr.GetMaxHp()*p[0])),d.default.log("\u81ea\u8eab\u8840\u91cf\u767e\u5206\u6bd4\u8d8a\u9ad8\uff0c\u653b\u51fb\u529b\u8d8a\u9ad8\uff0c\u81f3\u591a\u4e3aX%",l.addattackp));break;case 2:c||(l.damageprecent-=Math.max(.1,Math.min(p[1],(1-e.attr.hp/e.attr.GetMaxHp())*p[0])),d.default.log("\u81ea\u8eab\u8840\u91cf\u767e\u5206\u6bd4\u8d8a\u4f4e\uff0c\u53d7\u5230\u4f24\u5bb3\u8d8a\u4f4e\uff0c\u81f3\u591a\u4e3aX%",l.damageprecent));break;case 3:if(c){var h=p[1]?e:t;1==p[0]?(d.default.log("\u76ee\u6807\u8840\u91cf\u767e\u5206\u6bd4\u8d8a\u4f4e\uff0c\u5bf9\u76ee\u6807\u9020\u6210\u7684\u4f24\u5bb3\u8d8a\u9ad8   \u4f24\u5bb3\u767e\u5206\u6bd4=(1-(hp/maxhp))*\u7cfb\u6570",Math.max(.1,Math.min(p[3],(1-h.attr.hp/h.attr.GetMaxHp())*p[2]))),l.damageprecent+=Math.max(.1,Math.min(p[3],(1-h.attr.hp/h.attr.GetMaxHp())*p[2]))):2==p[0]&&(d.default.log("\u76ee\u6807\u8840\u91cf\u767e\u5206\u6bd4\u8d8a\u9ad8\uff0c\u5bf9\u76ee\u6807\u9020\u6210\u7684\u4f24\u5bb3\u8d8a\u9ad8   \u4f24\u5bb3\u767e\u5206\u6bd4=(hp/maxhp)*\u7cfb\u6570",Math.max(.1,Math.min(p[3],h.attr.hp/h.attr.GetMaxHp()*p[2]))),l.damageprecent+=Math.max(.1,Math.min(p[3],h.attr.hp/h.attr.GetMaxHp()*p[2])))}break;case 4:c&&e.attr.GetMaxHp()/e.attr.hp>2&&e.prop.isLive&&(l.addcriticalp+=p[0],l.suckblood=p[1],d.default.log("\u81ea\u8eab\u8840\u91cf\u4f4e\u4e8e50%\u65f6\uff0c\u66b4\u51fb\u7387\u589e\u52a0X%\uff0c\u4e14\u9020\u6210\u7684\u4f24\u5bb3\u7684X%\u4f1a\u8f6c\u5316\u4e3a\u8840\u91cf",p[0],l.suckblood))}return l},i.ResultFunc[o.PassivityType.Strike]=function(e,t,i,a,s,c,h,u){var g=[],C=r.default.instance.GetResultConfParam(i.param,h),_=p.default.instance.Random();switch(i.attackresult){case 1:u.damageprecent+=C[0]+_*(C[1]-C[0]),d.default.log("\u9020\u6210\u7684\u4f24\u5bb3\u589e\u52a0X%-X%"+(C[0]+_*(C[1]-C[0])));break;case 2:if(f(C[0]))for(var b=0;b<C[1].length;b++)m(e,t,c,h,u,C[1][b]);break;case 3:(g=t.fight.GetRangeEnemy(t,C[0],C[1])).length>0&&(u.sputteringprecent=C[2],u.sputteringentitys=g,d.default.log("\u666e\u901a\u653b\u51fb\u5bf9\u76ee\u6807\u5468\u56f4X\u4e2a\u654c\u65b9\u5355\u4f4d\u9020\u6210X%\u7684\u6e85\u5c04\u4f24\u5bb3",u.sputteringentitys.length,u.sputteringprecent));break;case 4:t.prop.grade<e.prop.grade&&(d.default.log("\u653b\u51fb\u4f4e\u4e8e\u81ea\u8eab\u5f62\u6001\u7684\u602a\u7269\u65f6\uff0c\u4f24\u5bb3\u589e\u52a0X%",C[0]),u.damageprecent+=C[0]);break;case 5:var T=l.default.instance.getCardConfCardType(t.prop.cardid);C[1]==T&&(d.default.log("\u653b\u51fb\u524d\u6392\u76ee\u6807\u65f6\u4f24\u5bb3\u63d0\u5347X%",C[0]),u.damageprecent+=C[0]);break;case 6:if(f(C[0])){for(var S=t.fight.GetRangeEnemy(t,C[1],C[2]),b=0;b<S.length;b++)u.spcialstateentity.push([1,S[b]]);d.default.log("\u666e\u653b\u6709X%\u7684\u6982\u7387\u9020\u6210\u76ee\u6807\u4ee5\u53ca\u5468\u56f4X\u4e2a\u76ee\u6807\u51fb",u.spcialstateentity.length)}break;case 7:d.default.log("b)\t\u6570\u91cf\u8d8a\u5c11\uff0c\u9020\u6210\u7684\u4f24\u5bb3\u8d8a\u9ad8\uff0c\u81f3\u591a\u589e\u52a0X%",Math.max(.1,Math.min(C[2],Math.max(0,C[0]-C[1]*(e.fight.campAliveNum[n.CampEnum.Self]+e.fight.campAliveNum[n.CampEnum.Enemy]))))),u.damageprecent+=Math.max(.1,Math.min(C[2],Math.max(0,C[0]-C[1]*(e.fight.campAliveNum[n.CampEnum.Self]+e.fight.campAliveNum[n.CampEnum.Enemy]))));break;case 8:d.default.log("c)\t\u6570\u91cf\u8d8a\u591a\uff0c\u9020\u6210\u7684\u4f24\u5bb3\u8d8a\u9ad8\uff0c\u81f3\u591a\u589e\u52a0X%",Math.max(.1,Math.min(C[1],C[0]*(e.fight.campAliveNum[n.CampEnum.Self]+e.fight.campAliveNum[n.CampEnum.Enemy])))),u.damageprecent+=Math.max(.1,Math.min(C[1],C[0]*(e.fight.campAliveNum[n.CampEnum.Self]+e.fight.campAliveNum[n.CampEnum.Enemy])));break;case 9:if(f(C[0]))for(var I=void 0,w=[],D=0,R=e.fight.entity;D<R.length;D++){var A=R[D];if(I=l.default.instance.getCardConfCardType(A.prop.cardid),e.camp==A.camp&&e.prop.cardid!=A.prop.cardid&&I==o.CardType.Centre){for(var N=0,L=e.fight.entity;N<L.length;N++){var E=L[N];I=l.default.instance.getCardConfCardType(E.prop.cardid),e.camp!=E.camp&&e.prop.cardid!=E.prop.cardid&&I==o.CardType.Back&&w.push(E)}if(w.length>0){u.sputteringprecent=C[1],u.sputteringentitys=[w[Math.floor(_*w.length)]],d.default.log("\u4e2d\u6392\u8054\u5408\u666e\u653b\u9020\u6210\u4f24\u5bb3\u65f6\uff0c\u6709X%\u7684\u6982\u7387\uff0c\u968f\u673a\u5411\u4e00\u540d\u540e\u6392\u654c\u4eba\u9020\u6210\u672c\u6b21\u4f24\u5bb3\u7684X%",u.sputteringentitys.length,u.sputteringprecent);break}}}break;case 10:if(f(C[0]))for(var I=void 0,B=0,M=e.fight.entity;B<M.length;B++){var A=M[B];if(I=l.default.instance.getCardConfCardType(A.prop.cardid),e.camp==A.camp&&e.prop.cardid!=A.prop.cardid&&I==o.CardType.Back&&(l.default.instance.getCardConfCardType(A.prop.cardid),T==o.CardType.Front&&e.prop.grade>t.prop.grade)){u.damageprecent+=C[1],m(e,t,c,h,u,C[2]),d.default.log("\u540e\u6392\u8054\u5408\uff1a\u573a\u4e0a\u5b58\u6d3b\u5176\u4ed6\u540e\u6392\u5bb6\u65cf\u7684\u53cb\u519b\u65f6\uff0c\u653b\u51fb\u5f62\u6001\u4e0d\u9ad8\u4e8e\u81ea\u8eab\u7684\u524d\u6392\u654c\u4eba\uff0c\u589e\u52a0X%\u7684\u4f24\u5bb3\uff0c\u6709X%\u7684\u6982\u7387\u9020\u6210\u6655\u7729\uff0c\u6301\u7eedX\u79d2");break}}break;case 11:t.prop.grade<e.prop.grade&&f(C[0])&&(m(e,t,c,h,u,C[1]),d.default.log("\u653b\u51fb\u5f62\u6001\u4f4e\u4e8e\u81ea\u8eab\u7684\u654c\u65b9\u76ee\u6807\u65f6\uff0c\u6709X%\u7684\u6982\u7387\u6dfb\u52a0buff"));break;case 12:d.default.log("\u5bf9\u76ee\u6807\u9020\u6210\u4f24\u5bb3\u65f6\uff0c\u4f1a\u628a\u4f24\u5bb3\u8f6c\u5316\u4e3a\u81ea\u8eab\u62a4\u76fe\uff0c\u62a4\u76fe\u81f3\u591a\u4e3a\u6700\u5927\u8840\u91cf\u7684X%"+e.prop.originalName+C[0]),u.addshieldtar.push(e),u.addshieldmax.push(C[0]);break;case 13:f(C[0])&&(u.suckblood=C[1],d.default.log("\u9020\u6210\u4f24\u5bb3\u65f6\uff0cX%\u7684\u4f24\u5bb3\u4f1a\u8f6c\u5316\u4e3a\u8840\u91cf"+C[1]));break;case 14:t.prop.grade>=4&&(u.damageprecent=C[0],d.default.log("\u5bf9\u7b2c\u56db\u3001\u4e94\u5f62\u6001\u7684\u654c\u65b9\u6210\u5458\uff0c\u9020\u6210\u7684\u4f24\u5bb3\u63d0\u5347X%"+C[0]));break;case 15:d.default.log("\u968f\u7740\u8f93\u51fa\uff0c\u9020\u6210\u7684\u4f24\u5bb3\u63d0\u5347X%"+C),f(C[0])&&m(e,e,c,h,u,C[1]);break;case 16:if(e.prop.grade>t.prop.grade&&f(C[0])){for(var S=t.fight.GetRangeEnemy(t,C[1],C[2]),b=0;b<S.length;b++)u.spcialstateentity.push([1,S[b]]);d.default.log("\u666e\u653b\u4f4e\u4e8e\u81ea\u8eab\u5f62\u6001\u7684\u76ee\u6807\u77f3\uff0c\u6709X%\u7684\u6982\u7387\u9020\u6210\u76ee\u6807\u4ee5\u53ca\u5468\u56f4X\u4e2a\u76ee\u6807\u51fb\u98de")}break;case 17:e.prop.grade>t.prop.grade&&f(C[0])&&(m(e,e,c,h,u,C[1]),d.default.log("\u653b\u51fb\u4e0d\u9ad8\u4e8e\u81ea\u8eab\u5f62\u6001\u654c\u4eba\u65f6\uff0c\u6709X%\u6982\u7387\u6c89\u9ed8\u5bf9\u624b\u3002\uff08\u5bf9\u65b9\u88ab\u52a8\u6280\u80fd\u65e0\u6548\uff09"));break;case 18:for(var b=0;b<C[0];b++)if(t.attr.buff.IsHasBuffByType(C[0][b])){u.damageprecent+=C[1],d.default.log("\u653b\u51fb\u7729\u6655\uff08\u71c3\u70e7\uff0c\u4e2d\u6bd2\uff0c\u51fa\u8840\u7b49\uff09\u7684\u654c\u4eba\uff0c\u9020\u6210X%\u4f24\u5bb3\u3002");break}break;case 19:var x=v(e);x>C[0]&&(d.default.log("\u6bcf\u653b\u51fbX\u6b21\uff0c\u53ec\u5524\u4e00\u4e2a\u81ea\u8eab\u955c\u50cf\u5206\u8eab\uff0c\u53ea\u6709\u81ea\u8eabX%\u8840\u91cf\uff0cX%\u653b\u51fb\u529b\u3002",x),v(e,!0),y(e,C[1],o.ADD_ACTOR_TYPE.JINGXIANG,null,null,C[3],C[2]));break;case 20:var k=v(e);k>C[0]&&(d.default.log("\u6bcf\u653b\u51fbX\u6b21\uff0c\u6dfb\u52a0buff\u3002",x),v(e,!0),m(e,e,c,h,u,C[1]))}return u},i.ResultFunc[o.PassivityType.Injuried]=function(e,t,i,n,a,s,c,p){var h=r.default.instance.GetResultConfParam(i.param,c);switch(i.injuriedresult){case 1:d.default.log("\u6bcf\u6b21\u53d7\u5230\u4f24\u5bb3\uff0c\u90fd\u4f1a\u589e\u52a0X%\u7684\u9632\u5fa1\uff0c\u81f3\u591a\u589e\u52a0X%%"),g(s,t,i,o.AttrType.MS_Defence_P,c,h);break;case 2:var u=r.default.instance.getSkillBySkillId(n);u.rangeattack&&(p.damageprecent-=h[0],d.default.log("\u53d7\u5230\u8303\u56f4\u653b\u51fb\u7684\u4f24\u5bb3\u51cf\u5c11X%",h[0],p.damageprecent));break;case 3:var y=l.default.instance.getCardConfCardType(e.prop.cardid);h[0]==y&&(p.damageprecent-=h[1],d.default.log("\u53d7\u5230\u7684\u524d\u6392\u548c\u4e2d\u6392\u4f24\u5bb3\u51cf\u5c11X",h[1],p.damageprecent));break;case 4:d.default.log("\u53d7\u5230\u4f24\u5bb3\u65f6\uff0c\u6709X%\u6982\u7387\u7ed9\u5bf9\u65b9\u6dfb\u52a0buff"+h[1]),f(h[0])&&m(t,e,s,c,p,h[1]);break;case 5:f(h[0])&&r.default.instance.getSkillBySkillId(s).triggerway!=o.TRIGGER_WAY.COMMON&&(d.default.log("\u6709X%\u7684\u6982\u7387\uff0c\u514d\u75ab\u53d7\u5230\u7684\u666e\u653b\u4f24\u5bb3"),p.dodge=!0);break;case 6:d.default.log("\u53d7\u5230\u524d\u6392\u548c\u4e2d\u6392\u4f24\u5bb3\u65f6\uff0c\u53cd\u5f39\u53d7\u5230\u7684\u4f24\u5bb3\u7684X%");for(var C=0,v=h[0];C<v.length;C++){var _=v[C];l.default.instance.getCardConfCardType(e.prop.cardid)==_&&(p.reboundentitys.push(e),p.reboundprecent.push(h[1]))}break;case 7:d.default.log("\u53d7\u5230\u5f62\u6001\u4f4e\u4e8e\u81ea\u8eab\u602a\u7269\u4f24\u5bb3\u65f6\uff0c\u6709X % \u6982\u7387\u9020\u6210\u76ee\u6807\u51fb\u98de\uff0c\u5e76\u6dfb\u52a0buffid\uff0cx\u79d2",i),e.prop.grade<t.prop.grade&&(f(h[0])&&p.spcialstateentity.push([h[1],e]),m(t,e,s,c,p,h[2]));break;case 8:p.damageChangeHpPrence=h}return p},i.ResultFunc[o.PassivityType.Critical]=function(e,t,i,n,a,s,l,c,p){var h=r.default.instance.GetResultConfParam(i.param,l);switch(i.criticalresult){case 1:if(p&&f(h[0])){d.default.log("\u66b4\u51fb\u65f6\u6709X%\u7684\u6982\u7387\u9020\u6210\u6655\u7729\uff0c\u6301\u7eed X\u79d2",h[1]);for(var u=0;u<h[1].length;u++)m(e,t,s,l,c,h[1][u])}break;case 2:p||(d.default.log("\u6bcf\u6b21\u53d7\u5230\u66b4\u51fb\u4f24\u5bb3\u65f6\uff0c\u4f1a\u51cf\u5c11x%\u9632\u5fa1\u529b"),g(s,t,i,o.AttrType.Defence,l,h));break;case 3:if(p&&f(h[0])){d.default.log("\u66b4\u51fb\u65f6\u6709X%\u7684\u6982\u7387\u6dfb\u52a0\u591a\u4e2abuff\uff0c\u6301\u7eed X\u79d2",h[1]);for(var u=0;u<h[1].length;u++)m(e,t,s,l,c,h[1][u])}break;case 4:p&&(d.default.log("\u66b4\u51fb\u7387\u589e\u52a05% \u6700\u5927\u66b4\u51fb\u73875%\uff0c\u5361\u724c\u9020\u6210\u66b4\u51fb\u4f24\u5bb3\u989d\u5916\u589e\u52a0X% \u6700\u5927\u66b4\u51fb\u4f24\u5bb3\u767e\u5206\u6bd4X%"),g(s,e,i,o.AttrType.Crit_P,l,h.slice(0,2)),g(s,e,i,o.AttrType.Critical_Harm_P,l,h.slice(2)));break;case 5:!p&&f(h[0])&&(d.default.log("\u6709X%\u7684\u6982\u7387\uff0c\u514d\u75ab\u53d7\u5230\u7684\u666e\u653b\u66b4\u64ca\u4f24\u5bb3\uff0c\u6bcf\u573a\u6218\u6597\u81f3\u591a\u751f\u6548X\u6b21%"),C(t,s,h[1])&&(c.damage=0))}return c},i.ResultFunc[o.PassivityType.RoleTalent]=function(e,t,i,n,o,a,s,l){var u=r.default.instance.GetResultConfParam(i.param,s),g=p.default.instance.Random();switch(i.criticalresult){case 1:if(t.prop.selfMonster&&t.prop.type==c.EntityType.enMonster&&f(u[0])&&t.attr.hp+t.attr.shield-l.damage<=0){var y=u[1]*t.attr.GetMaxHp()-t.attr.hp-t.attr.shield;d.default.log("\u5929\u8d4b\u53d7\u5230\u81f4\u547d\u4e00\u51fb\u6062\u590d\u6700\u5230\u5927\u8840\u91cf30%",y),l.dieresultAddHp.push([t,y]),l.damage=0}break;case 2:if(e.prop.selfMonster&&e.prop.type==c.EntityType.enMonster&&f(u[0])&&e.prop.isLive){var y=u[1]*l.damage;d.default.log("\u5929\u8d4b\u672c\u6b21\u4f24\u5bb310%\u8f6c\u4e3a\u8840\u91cf",y),l.dieresultAddHp.push([e,y])}break;case 3:t.prop.selfMonster&&t.prop.type==c.EntityType.enMonster&&f(u[0])&&(d.default.log("\u5929\u8d4b\u6280\u80fd \u53d7\u5230\u4f24\u5bb3\u6dfb\u52a0buff",u[1]),m(t,t,a,s,l,u[1]));break;case 4:e.prop.selfMonster&&e.prop.type==c.EntityType.enActor&&t.prop.grade<u[1]&&f(u[0])&&(d.default.log("\u5929\u8d4b\u6280\u80fd \u4eba\u7269\u79d2\u6740x\u5f62\u6001\u4ee5\u4e0b\u7684\u602a"+t.prop.originalName,t.attr.hp+t.attr.shield),l.damage,t.attr.hp,t.attr.shield);break;case 5:var C=r.default.instance.getSkillBySkillId(a);t.prop.selfMonster&&t.prop.type==c.EntityType.enActor&&C.rangeattack&&(d.default.log("\u5929\u8d4b\u6280\u80fd \u4eba\u7269\u53d7\u5230\u7684aoe\u4f24\u5bb3\u51cf\u5c11X%"+u[0]),l.damageprecent-=u[0]);break;case 6:e.prop.selfMonster&&e.prop.type==c.EntityType.enActor&&t.prop.grade<u[0]&&(d.default.log("\u5929\u8d4b\u6280\u80fd \u4eba\u7269\u5bf9x\u5f62\u6001\u4ee5\u4e0b\u7684\u602a\u7269\u9020\u6210\u4f24\u5bb3x%"+u[0],u[1]),l.damageprecent+=u[1]);break;case 7:t.prop.selfMonster&&t.prop.type==c.EntityType.enActor&&e.prop.grade<u[0]&&(d.default.log("\u5929\u8d4b\u6280\u80fd \u4eba\u7269\u53d7\u5230x\u5f62\u6001\u4ee5\u4e0b\u7684\u4f24\u5bb3\u51cf\u5c11x%"+u[0],u[1]),l.damageprecent-=u[1]);break;case 8:e.prop.selfMonster&&e.prop.type==c.EntityType.enMonster&&f(u[0])&&(d.default.log("\u5929\u8d4b\u6280\u80fd \u602a\u7269\u653b\u51fb\u6982\u7387\u89e6\u53d1\u52a0buff",u[1]),m(e,t,a,s,l,u[1]));break;case 9:e.prop.selfMonster&&e.prop.type==c.EntityType.enMonster&&h.CalcElemRate(e.attr.attr_,t.attr.attr_)>=0&&e.prop.isLive&&(d.default.log("\u5929\u8d4b\u6280\u80fd \u602a\u7269\u6253\u51fa\u4e94\u884c\u514b\u5236\u65f6\u5019\uff0c\u6bcf\u6b21\u653b\u51fb\u6062\u590dX%\u8840\u91cf",u[0]+"%",Math.ceil(e.attr.GetMaxHp()*u[0])),l.dieresultAddHp.push([e,Math.ceil(e.attr.GetMaxHp()*u[0])]));break;case 10:e.prop.selfMonster&&e.prop.type==c.EntityType.enMonster&&h.CalcElemRate(e.attr.attr_,t.attr.attr_)>=0&&f(u[0])&&(d.default.log("\u5929\u8d4b\u6280\u80fd \u602a\u7269\u6253\u51fa\u4e94\u884c\u514b\u5236\u65f6\u5019\uff0c\u6982\u7387\u968f\u673a\u83b7\u53d6\u589e\u76cabuff",u[1][g*length]),m(e,t,a,s,l,u[1][g*length]));break;case 11:e.prop.selfMonster&&e.prop.type==c.EntityType.enMonster&&h.CalcElemRate(e.attr.attr_,t.attr.attr_)>=0&&f(u[0])&&(d.default.log("\u5929\u8d4b\u6280\u80fd \u602a\u7269\u6253\u51fa\u4e94\u884c\u514b\u5236\u65f6\u5019\uff0c\u654c\u65b9\u6982\u7387\u968f\u673a\u83b7\u53d6\u51cf\u76cabuff",u[1][g*length]),m(e,t,a,s,l,u[1][g*length]))}return l},i.ResultFunc[o.PassivityType.Restrain]=function(e,t,i,n,o,a,s,l){var c=r.default.instance.GetResultConfParam(i.param,s);switch(i.restrainresult){case 1:d.default.log("\u89e6\u53d1\u4e94\u7075\u514b\u5236\u65f6\u6709\u6982\u7387\u89e6\u53d1buff"),f(c[0])&&m(e,t,a,s,l,c[1]);break;case 1:if(f(c[0])&&e.prop.isLive){var p=c[1]*t.attr.GetMaxHp();l.dieresultAddHp.push([e,p]),d.default.log("\u89e6\u53d1\u4e94\u7075\u514b\u5236\u65f6\uff0c\u6709X%\u6982\u7387\u6062\u590d\u90e8\u5206\u8840\u91cf",e.prop.originalName,p)}}return l},cc._RF.pop()},{"../../Core/Const/EntityType":"EntityType","../../Global/GlobalValue":"GlobalValue","../Scene/Controller/FightController":"FightController","../Scene/Controller/ServerFightController":"ServerFightController","../Scene/Controller/SkillController":"SkillController","../Scene/Unit/FightLog":"FightLog","../Scene/View/FightView":"FightView","../WarTeam/MonsterController":"MonsterController","./calculator":"calculator","./fightlogic":"fightlogic","./staticattr":"staticattr"}],rolenameconf:[function(e,t,i){"use strict";cc._RF.push(t,"e2a13V4GzxO6JLazqpnh+Oc","rolenameconf"),Object.defineProperty(i,"__esModule",{value:!0}),i.rolenameconf={Names:{1:[{index:0,name:"\u5b89"},{index:1,name:"\u67cf"},{index:2,name:"\u962a"},{index:3,name:"\u5d29"},{index:4,name:"\u78a7"},{index:5,name:"\u6241"},{index:6,name:"\u5f6a"},{index:7,name:"\u5f6c"},{index:8,name:"\u67c4"},{index:9,name:"\u6ce2"},{index:10,name:"\u535a"},{index:11,name:"\u53c2"},{index:12,name:"\u6b8b"},{index:13,name:"\u82cd"},{index:14,name:"\u7985"},{index:15,name:"\u8d85"},{index:16,name:"\u8fb0"},{index:17,name:"\u5bb8"},{index:18,name:"\u8bda"},{index:19,name:"\u57ce"},{index:20,name:"\u4e58"},{index:21,name:"\u94d6"},{index:22,name:"\u7a0b"},{index:23,name:"\u6c60"},{index:24,name:"\u9a70"},{index:25,name:"\u6625"},{index:26,name:"\u806a"},{index:27,name:"\u4ece"},{index:28,name:"\u5200"},{index:29,name:"\u8fea"},{index:30,name:"\u5730"},{index:31,name:"\u7535"},{index:32,name:"\u9f0e"},{index:33,name:"\u5151"},{index:34,name:"\u6076"},{index:35,name:"\u6069"},{index:36,name:"\u7ffb"},{index:37,name:"\u98de"},{index:38,name:"\u98ce"},{index:39,name:"\u67ab"},{index:40,name:"\u5cf0"},{index:41,name:"\u70fd"},{index:42,name:"\u62c2"},{index:43,name:"\u8986"},{index:44,name:"\u7f61"},{index:45,name:"\u56fd"},{index:46,name:"\u679c"},{index:47,name:"\u6d77"},{index:48,name:"\u6db5"},{index:49,name:"\u5bd2"},{index:50,name:"\u701a"},{index:51,name:"\u822a"},{index:52,name:"\u8c6a"},{index:53,name:"\u660a"},{index:54,name:"\u6d69"},{index:55,name:"\u7693"},{index:56,name:"\u6cb3"},{index:57,name:"\u9e64"},{index:58,name:"\u6068"},{index:59,name:"\u5f18"},{index:60,name:"\u8679"},{index:61,name:"\u9e3f"},{index:62,name:"\u864e"},{index:63,name:"\u5212"},{index:64,name:"\u534e"},{index:65,name:"\u6656"},{index:66,name:"\u8f89"},{index:67,name:"\u9b42"},{index:68,name:"\u6781"},{index:69,name:"\u5bc2"},{index:70,name:"\u5bb6"},{index:71,name:"\u5609"},{index:72,name:"\u9a9e"},{index:73,name:"\u5efa"},{index:74,name:"\u5065"},{index:75,name:"\u964d"},{index:76,name:"\u52ab"},{index:77,name:"\u6770"},{index:78,name:"\u6d01"},{index:79,name:"\u754c"},{index:80,name:"\u91d1"},{index:81,name:"\u9526"},{index:82,name:"\u747e"},{index:83,name:"\u664b"},{index:84,name:"\u7ecf"},{index:85,name:"\u6676"},{index:86,name:"\u9756"},{index:87,name:"\u4e5d"},{index:88,name:"\u9a79"},{index:89,name:"\u98d3"},{index:90,name:"\u541b"},{index:91,name:"\u4fca"},{index:92,name:"\u5cfb"},{index:93,name:"\u5f00"},{index:94,name:"\u51ef"},{index:95,name:"\u607a"},{index:96,name:"\u6977"},{index:97,name:"\u574e"},{index:98,name:"\u514b"},{index:99,name:"\u523b"},{index:100,name:"\u72c2"},{index:101,name:"\u5764"},{index:102,name:"\u6606"},{index:103,name:"\u6765"},{index:104,name:"\u84dd"},{index:105,name:"\u72fc"},{index:106,name:"\u4e50"},{index:107,name:"\u96f7"},{index:108,name:"\u78ca"},{index:109,name:"\u9ece"},{index:110,name:"\u7acb"},{index:111,name:"\u6ca5"},{index:112,name:"\u6797"},{index:113,name:"\u9716"},{index:114,name:"\u7075"},{index:115,name:"\u6d41"},{index:116,name:"\u9f99"},{index:117,name:"\u9e6d"},{index:118,name:"\u4ed1"},{index:119,name:"\u68a6"},{index:120,name:"\u89c5"},{index:121,name:"\u6dfc"},{index:122,name:"\u706d"},{index:123,name:"\u6c11"},{index:124,name:"\u73c9"},{index:125,name:"\u660e"},{index:126,name:"\u51a5"},{index:127,name:"\u9ed8"},{index:128,name:"\u7a46"},{index:129,name:"\u5357"},{index:130,name:"\u6960"},{index:131,name:"\u6d85"},{index:132,name:"\u51dd"},{index:133,name:"\u78d0"},{index:134,name:"\u5e9e"},{index:135,name:"\u9e4f"},{index:136,name:"\u7834"},{index:137,name:"\u9b44"},{index:138,name:"\u84b2"},{index:139,name:"\u4e03"},{index:140,name:"\u5947"},{index:141,name:"\u742a"},{index:142,name:"\u797a"},{index:143,name:"\u8d77"},{index:144,name:"\u4e7e"},{index:145,name:"\u5f3a"},{index:146,name:"\u9752"},{index:147,name:"\u6e05"},{index:148,name:"\u64ce"},{index:149,name:"\u7a79"},{index:150,name:"\u66f2"},{index:151,name:"\u6cc9"},{index:152,name:"\u7136"},{index:153,name:"\u8363"},{index:154,name:"\u745e"},{index:155,name:"\u777f"},{index:156,name:"\u6da6"},{index:157,name:"\u68ee"},{index:158,name:"\u5c71"},{index:159,name:"\u7ecd"},{index:160,name:"\u5347"},{index:161,name:"\u5723"},{index:162,name:"\u665f"},{index:163,name:"\u8700"},{index:164,name:"\u971c"},{index:165,name:"\u6c34"},{index:166,name:"\u601d"},{index:167,name:"\u677e"},{index:168,name:"\u788e"},{index:169,name:"\u592a"},{index:170,name:"\u592a"},{index:171,name:"\u5802"},{index:172,name:"\u6d9b"},{index:173,name:"\u5929"},{index:174,name:"\u540c"},{index:175,name:"\u5f64"},{index:176,name:"\u5c60"},{index:177,name:"\u4e07"},{index:178,name:"\u5fae"},{index:179,name:"\u56f4"},{index:180,name:"\u552f"},{index:181,name:"\u4f1f"},{index:182,name:"\u7eac"},{index:183,name:"\u6587"},{index:184,name:"\u543e"},{index:185,name:"\u4e94"},{index:186,name:"\u6b66"},{index:187,name:"\u609f"},{index:188,name:"\u7199"},{index:189,name:"\u8c61"},{index:190,name:"\u6653"},{index:191,name:"\u7b11"},{index:192,name:"\u5578"},{index:193,name:"\u6615"},{index:194,name:"\u946b"},{index:195,name:"\u661f"},{index:196,name:"\u5211"},{index:197,name:"\u4fee"},{index:198,name:"\u65ed"},{index:199,name:"\u7eed"},{index:200,name:"\u8f69"},{index:201,name:"\u714a"},{index:202,name:"\u70ab"},{index:203,name:"\u96ea"},{index:204,name:"\u5bfb"},{index:205,name:"\u7259"},{index:206,name:"\u96c5"},{index:207,name:"\u708e"},{index:208,name:"\u5043"},{index:209,name:"\u96c1"},{index:210,name:"\u7131"},{index:211,name:"\u6d0b"},{index:212,name:"\u5c27"},{index:213,name:"\u70e8"},{index:214,name:"\u4e00"},{index:215,name:"\u6613"},{index:216,name:"\u5f08"},{index:217,name:"\u9038"},{index:218,name:"\u71a0"},{index:219,name:"\u61ff"},{index:220,name:"\u836b"},{index:221,name:"\u6bb7"},{index:222,name:"\u5bc5"},{index:223,name:"\u82f1"},{index:224,name:"\u6620"},{index:225,name:"\u4f51"},{index:226,name:"\u745c"},{index:227,name:"\u611a"},{index:228,name:"\u5b87"},{index:229,name:"\u96e8"},{index:230,name:"\u8bed"},{index:231,name:"\u7389"},{index:232,name:"\u72f1"},{index:233,name:"\u5fa1"},{index:234,name:"\u6108"},{index:235,name:"\u715c"},{index:236,name:"\u6e0a"},{index:237,name:"\u5143"},{index:238,name:"\u733f"},{index:239,name:"\u6e90"},{index:240,name:"\u8fdc"},{index:241,name:"\u82d1"},{index:242,name:"\u5cb3"},{index:243,name:"\u8d8a"},{index:244,name:"\u4e91"},{index:245,name:"\u6cfd"},{index:246,name:"\u5c55"},{index:247,name:"\u54f2"},{index:248,name:"\u632f"},{index:249,name:"\u9707"},{index:250,name:"\u6b63"},{index:251,name:"\u82b7"},{index:252,name:"\u5fd7"},{index:253,name:"\u81f4"},{index:254,name:"\u667a"},{index:255,name:"\u8bdb"},{index:256,name:"\u8bf8"},{index:257,name:"\u6d4a"},{index:258,name:"\u5b50"},{index:259,name:"\u7d2b"}],2:[{index:0,name:"\u5b89"},{index:1,name:"\u50b2"},{index:2,name:"\u767d"},{index:3,name:"\u534a"},{index:4,name:"\u78a7"},{index:5,name:"\u51b0"},{index:6,name:"\u91c7"},{index:7,name:"\u5ae6"},{index:8,name:"\u75f4"},{index:9,name:"\u521d"},{index:10,name:"\u6625"},{index:11,name:"\u4ece"},{index:12,name:"\u7fe0"},{index:13,name:"\u4ee3"},{index:14,name:"\u4e39"},{index:15,name:"\u51ac"},{index:16,name:"\u5c14"},{index:17,name:"\u51e1"},{index:18,name:"\u8bbf"},{index:19,name:"\u98de"},{index:20,name:"\u5b64"},{index:21,name:"\u8c37"},{index:22,name:"\u6d77"},{index:23,name:"\u542b"},{index:24,name:"\u6db5"},{index:25,name:"\u5bd2"},{index:26,name:"\u6068"},{index:27,name:"\u5a73"},{index:28,name:"\u6000"},{index:29,name:"\u6b22"},{index:30,name:"\u5e7b"},{index:31,name:"\u60e0"},{index:32,name:"\u5bc4"},{index:33,name:"\u4f73"},{index:34,name:"\u5a55"},{index:35,name:"\u747e"},{index:36,name:"\u749f"},{index:37,name:"\u5a67"},{index:38,name:"\u9756"},{index:39,name:"\u9759"},{index:40,name:"\u73fa"},{index:41,name:"\u53ef"},{index:42,name:"\u4e50"},{index:43,name:"\u51b7"},{index:44,name:"\u4e3d"},{index:45,name:"\u8389"},{index:46,name:"\u601c"},{index:47,name:"\u7433"},{index:48,name:"\u7075"},{index:49,name:"\u51cc"},{index:50,name:"\u7eff"},{index:51,name:"\u66fc"},{index:52,name:"\u6f2b"},{index:53,name:"\u7f8e"},{index:54,name:"\u68a6"},{index:55,name:"\u89c5"},{index:56,name:"\u5999"},{index:57,name:"\u660e"},{index:58,name:"\u6c90"},{index:59,name:"\u6155"},{index:60,name:"\u5357"},{index:61,name:"\u5ff5"},{index:62,name:"\u51dd"},{index:63,name:"\u76fc"},{index:64,name:"\u6c9b"},{index:65,name:"\u5e73"},{index:66,name:"\u742a"},{index:67,name:"\u7eee"},{index:68,name:"\u5343"},{index:69,name:"\u5029"},{index:70,name:"\u5de7"},{index:71,name:"\u7434"},{index:72,name:"\u9752"},{index:73,name:"\u79cb"},{index:74,name:"\u5982"},{index:75,name:"\u8339"},{index:76,name:"\u777f"},{index:77,name:"\u82e5"},{index:78,name:"\u6851"},{index:79,name:"\u5c71"},{index:80,name:"\u8bd7"},{index:81,name:"\u4e66"},{index:82,name:"\u6dd1"},{index:83,name:"\u6c34"},{index:84,name:"\u601d"},{index:85,name:"\u6a80"},{index:86,name:"\u5929"},{index:87,name:"\u542c"},{index:88,name:"\u5b9b"},{index:89,name:"\u5a49"},{index:90,name:"\u6587"},{index:91,name:"\u95ee"},{index:92,name:"\u60dc"},{index:93,name:"\u7199"},{index:94,name:"\u590f"},{index:95,name:"\u9999"},{index:96,name:"\u5411"},{index:97,name:"\u5c0f"},{index:98,name:"\u6653"},{index:99,name:"\u7b11"},{index:100,name:"\u6b23"},{index:101,name:"\u65b0"},{index:102,name:"\u6b46"},{index:103,name:"\u99a8"},{index:104,name:"\u96ea"},{index:105,name:"\u5bfb"},{index:106,name:"\u96c5"},{index:107,name:"\u5a05"},{index:108,name:"\u5f66"},{index:109,name:"\u96c1"},{index:110,name:"\u591c"},{index:111,name:"\u4f9d"},{index:112,name:"\u6021"},{index:113,name:"\u4ee5"},{index:114,name:"\u65d6"},{index:115,name:"\u5fc6"},{index:116,name:"\u4ea6"},{index:117,name:"\u6613"},{index:118,name:"\u8fce"},{index:119,name:"\u83b9"},{index:120,name:"\u6620"},{index:121,name:"\u4f18"},{index:122,name:"\u53cb"},{index:123,name:"\u53c8"},{index:124,name:"\u5e7c"},{index:125,name:"\u4f51"},{index:126,name:"\u7fbd"},{index:127,name:"\u96e8"},{index:128,name:"\u8bed"},{index:129,name:"\u7389"},{index:130,name:"\u94b0"},{index:131,name:"\u715c"},{index:132,name:"\u5143"},{index:133,name:"\u6708"},{index:134,name:"\u73a5"},{index:135,name:"\u82b8"},{index:136,name:"\u97f5"},{index:137,name:"\u6b63"},{index:138,name:"\u4e4b"},{index:139,name:"\u82b7"},{index:140,name:"\u7d2b"},{index:141,name:"\u9189"},{index:142,name:"\u5b89"},{index:143,name:"\u767d"},{index:144,name:"\u67cf"},{index:145,name:"\u6ce2"},{index:146,name:"\u5a75"},{index:147,name:"\u5bb8"},{index:148,name:"\u6625"},{index:149,name:"\u7fe0"},{index:150,name:"\u4e39"},{index:151,name:"\u8776"},{index:152,name:"\u51ac"},{index:153,name:"\u513f"},{index:154,name:"\u51e1"},{index:155,name:"\u83f2"},{index:156,name:"\u98ce"},{index:157,name:"\u67ab"},{index:158,name:"\u8299"},{index:159,name:"\u6d77"},{index:160,name:"\u6db5"},{index:161,name:"\u5bd2"},{index:162,name:"\u83e1"},{index:163,name:"\u8377"},{index:164,name:"\u69d0"},{index:165,name:"\u5349"},{index:166,name:"\u6167"},{index:167,name:"\u4f73"},{index:168,name:"\u5609"},{index:169,name:"\u6d01"},{index:170,name:"\u5a55"},{index:171,name:"\u9759"},{index:172,name:"\u541b"},{index:173,name:"\u7b60"},{index:174,name:"\u5170"},{index:175,name:"\u5c9a"},{index:176,name:"\u84dd"},{index:177,name:"\u857e"},{index:178,name:"\u4e3d"},{index:179,name:"\u83b2"},{index:180,name:"\u7433"},{index:181,name:"\u7075"},{index:182,name:"\u73b2"},{index:183,name:"\u83f1"},{index:184,name:"\u67f3"},{index:185,name:"\u7490"},{index:186,name:"\u9732"},{index:187,name:"\u7eff"},{index:188,name:"\u66fc"},{index:189,name:"\u6885"},{index:190,name:"\u7f8e"},{index:191,name:"\u68a6"},{index:192,name:"\u5a1c"},{index:193,name:"\u5357"},{index:194,name:"\u6960"},{index:195,name:"\u59ae"},{index:196,name:"\u65ce"},{index:197,name:"\u51dd"},{index:198,name:"\u840d"},{index:199,name:"\u742a"},{index:200,name:"\u7426"},{index:201,name:"\u831c"},{index:202,name:"\u5de7"},{index:203,name:"\u82b9"},{index:204,name:"\u7434"},{index:205,name:"\u9752"},{index:206,name:"\u6674"},{index:207,name:"\u79cb"},{index:208,name:"\u5bb9"},{index:209,name:"\u84c9"},{index:210,name:"\u67d4"},{index:211,name:"\u8339"},{index:212,name:"\u854a"},{index:213,name:"\u5c71"},{index:214,name:"\u59d7"},{index:215,name:"\u73ca"},{index:216,name:"\u53cc"},{index:217,name:"\u971c"},{index:218,name:"\u4e1d"},{index:219,name:"\u677e"},{index:220,name:"\u6843"},{index:221,name:"\u5929"},{index:222,name:"\u5a77"},{index:223,name:"\u5f64"},{index:224,name:"\u8587"},{index:225,name:"\u6587"},{index:226,name:"\u96ef"},{index:227,name:"\u7199"},{index:228,name:"\u66e6"},{index:229,name:"\u590f"},{index:230,name:"\u9999"},{index:231,name:"\u99a8"},{index:232,name:"\u8431"},{index:233,name:"\u7ffe"},{index:234,name:"\u65cb"},{index:235,name:"\u7487"},{index:236,name:"\u96ea"},{index:237,name:"\u96c5"},{index:238,name:"\u70df"},{index:239,name:"\u5ae3"},{index:240,name:"\u598d"},{index:241,name:"\u96c1"},{index:242,name:"\u9633"},{index:243,name:"\u7476"},{index:244,name:"\u794e"},{index:245,name:"\u6021"},{index:246,name:"\u4ea6"},{index:247,name:"\u6613"},{index:248,name:"\u8335"},{index:249,name:"\u83b9"},{index:250,name:"\u9896"},{index:251,name:"\u745c"},{index:252,name:"\u6986"},{index:253,name:"\u7389"},{index:254,name:"\u60a6"},{index:255,name:"\u4e91"},{index:256,name:"\u82b8"},{index:257,name:"\u73cd"},{index:258,name:"\u771f"},{index:259,name:"\u4e4b"},{index:260,name:"\u7af9"},{index:261,name:"\u59ff"}]},Randomname:{1:{Names:1,desc:"\u7537\u540d\u5b57\u524d\u9762\u90e8\u5206"},2:{Names:1,desc:"\u7537\u540d\u5b57\u4e2d\u95f4\u90e8\u5206"},3:{Names:1,desc:"\u7537\u540d\u5b57\u540e\u9762\u90e8\u5206"},4:{Names:2,desc:"\u5973\u540d\u5b57\u524d\u9762\u90e8\u5206"},5:{Names:2,desc:"\u5973\u540d\u5b57\u4e2d\u95f4\u90e8\u5206"},6:{Names:2,desc:"\u5973\u540d\u5b57\u540e\u9762\u90e8\u5206"}},RoleConf:{0:{ChangeNameNeedCsm:[200,300,400]}}},cc._RF.pop()},{}],simulator_Icon:[function(e,t,i){"use strict";cc._RF.push(t,"51adfMHMS5AIaX6QlVCbC+d","simulator_Icon"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/GameEventDispatcher"),o=cc._decorator,a=o.ccclass,r=o.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.bg=null,t.commonchange=null,t.spoint=0,t._oldeType=null,t._nowType=null,t.eliminateNum=0,t}return __extends(t,e),t.prototype.start=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.ontouch,this)},t.prototype.hide=function(){console.log("\u7a81\u7136\u9690\u85cf")},t.prototype.getSpoint=function(){return this.spoint},t.prototype.setVisible=function(e){this.bg.node.active=e,this.label.node.active=e},t.prototype.setSymbolPo=function(e){this.spoint=e},t.prototype.setSymbolSize=function(e,t){this.bg.node.height=e,this.bg.node.width=t,this.node.height=e,this.node.width=t},t.prototype.setGrade=function(e){this.eliminateNum=e},t.prototype.getGrade=function(){return this.eliminateNum},t.prototype.getType=function(){return this._nowType},t.prototype.setBGshow=function(e){if(this._nowType=e.type,100!=e.type){if(this.setVisible(!0),e.type<15){var t=0;t=Math.floor(e.type/3),this.bg.spriteFrame=this.commonchange.getSpriteFrame("mapPaper_"+t)}else this.label.string=e.removalFr+"",this.bg.spriteFrame=this.commonchange.getSpriteFrame("mapPaper_5");if(e.type<15){t=e.type%3;this.label.string=[1,2,3][t]+""}}else this.setVisible(!1)},t.prototype.ontouch=function(e){n.GameEventDispatcher.instance.emit("CHANGEICON",{ball:this,spoint:this.spoint})},__decorate([r(cc.Label)],t.prototype,"label",void 0),__decorate([r(cc.Sprite)],t.prototype,"bg",void 0),__decorate([r(cc.SpriteAtlas)],t.prototype,"commonchange",void 0),t=__decorate([a],t)}(cc.Component);i.default=s,cc._RF.pop()},{"../../../Core/GameEventDispatcher":"GameEventDispatcher"}],simulator_SandTableBackstage:[function(e,t,i){"use strict";cc._RF.push(t,"3b30abwEdxGz6FrxuXUiBOE","simulator_SandTableBackstage"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/GameEventDispatcher"),o=e("../../../Core/Widget"),a=e("./../SandTableController"),r=e("../../../Global/GlobalValue"),s=e("../../../Util/Utils"),l=e("../../WarTeam/MonsterController"),c=e("../../Status/StatusType"),d=e("../../Arena/ArenaController"),p=e("../../Chapter/ChapterController"),h=e("../../Chapter/GuanqiaController"),u=e("./simulator_SandTable"),f=cc._decorator,g=f.ccclass,y=(f.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.symbolArr=[],t.symbolGuideBaoXiangArr=[15,16],t.guideOneCharps=[[0,15,0,0],[16,16,15,16],[0,16,0,0],[0,15,0,0]],t.terrainArr=[[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],t.OfferTypeTrap=[r.SandTableTrapType.JITAN,r.SandTableTrapType.LEITING,r.SandTableTrapType.HEIDONG,r.SandTableTrapType.WODI,r.SandTableTrapType.YAOJI,r.SandTableTrapType.PINGDENG,r.SandTableTrapType.SHENGJI,r.SandTableTrapType.CUIMIAN],t.OfferTypeTrapInfo=[r.SandTableTrapType.PINGDENG,r.SandTableTrapType.SHENGJI,r.SandTableTrapType.CUIMIAN],t.OfferTypeTrapTree=[r.SandTableTrapType.CHUANSONG],t.OfferTypeTrapTwo=[r.SandTableTrapType.TIECHUI,r.SandTableTrapType.HUOPAO,r.SandTableTrapType.QIYUAN,r.SandTableTrapType.JIANGJI,r.SandTableTrapType.CHUANSONG,r.SandTableTrapType.TANGHUANG,r.SandTableTrapType.MEIDUSHA,r.SandTableTrapType.WUSHU],t.storageArr=[],t.removeArr=[],t.resultIndex=0,t.loopIndex=0,t._activeIndex=null,t._passiveIndex=null,t.height=0,t.width=0,t.isDropNum=0,t.data=[],t.upSymbol=[],t.crossArr=[],t.monster=[],t.stoneArr=[],t.operationArr=[],t.trapArr=[],t.trapInfoArr=[],t.addTrapArr=[],t.secondArr=[],t.historyArr=[],t.screeningArr=[],t._aloneOut=!1,t.isSeedCome=!1,t.gradeMin=1,t.gradeMax=1,t.upTalentArr=[],t.talenSkills=!1,t.skillsProbability=0,t.skillsIncrease=0,t.starNum=0,t.deleteChuanSongNum=!1,t.deleteTangHuangNum=!1,t.meidushaIndex=1,t}var i;return __extends(t,e),i=t,t.prototype.start=function(){e.prototype.start.call(this),i.instance=this,n.GameEventDispatcher.instance.on("SANDTABLESTAR",this._starGame,this),n.GameEventDispatcher.instance.on("SABDTAVKEINITDATA",this._initData,this),n.GameEventDispatcher.instance.on("GAMEMOTION",this._gameMotion,this),n.GameEventDispatcher.instance.on("GAMESINGLE",this._gameSingle,this)},t.prototype._initData=function(){this.symbolArr=[],this.data=[],this.resetResultArr(),this.stoneArr=[],this.trapArr=[],this.historyArr=[],this.trapInfoArr=[],this.upTalentArr=[],this._passiveIndex=null,this._activeIndex=null,this.resultIndex=0,this.talenSkills=!1},t.prototype._starGame=function(e){var t=this,i=e.getUserData();if(i.seed){this.isSeedCome=!0;var n=!0;c.ActivityStatus.Arena==c.ActivityStatus.value&&1==d.default.instance.isArenaNextFight&&(n=!1);var o=function(e,i){void 0===i&&(i=null);for(var n=[],o=0;o<e;o++)for(var a=0;a<e;a++){var r=0,s=0,l=0,c=0;i&&i[o]&&i[o][a]?(r=i[o][a].type,s=i[o][a].gradeUp,l=i[o][a].fallDownNum,c=i[o][a].grade):r=t.Random();var d={type:r,gradeUp:s,fallDownNum:l,grade:c};n[o]||(n[o]=[]),n[o][a]=d}if(i)t.symbolArr=n;else{t.symbolArr=[];for(o=0;o<e;o++)for(a=0;a<e;a++)t.symbolArr[o]||(t.symbolArr[o]=[]),t.symbolArr[o][a]=n[a][e-1-o]}};if(i&&i.gradeMax&&(this.gradeMax=i.gradeMax?i.gradeMax:1,this.gradeMin=i.gradeMin?i.gradeMin:1),n)o(i.scale);if(this.symbolArr.length<=0){var r=a.default.instance.getOldArr();r&&o(r.length,r)}this.node.getComponent("SandTableMain").gameStar(this.symbolArr)}else this.isSeedCome=!1,this.Single()},t.prototype.Single=function(e){this.symbolArr=[];var t=[];if(this.gradeMax=parseInt(u.default.instance.gradeMax.string),this.gradeMin=parseInt(u.default.instance.gradeMin.string),t&&t.length)this.height=t.length,this.width=t[0].length;else{this.terrainArr=[];var i=(I=e.split(";")).splice(0,1)[0].split(",");this.height=parseInt(i[0]),this.width=parseInt(i[1]),""==I[I.length-1]&&I.splice(I.length-1,1);for(var n=[],o=0;o<this.height;o++){n[o]=[];for(var a=0;a<this.width;a++)n[o][a]=I[o*this.width+a].split(",")[1].indexOf("-")>-1?I[o*this.width+a].split(",")[1]:parseInt(I[o*this.width+a].split(",")[1])}for(var o in n)this.terrainArr[o]=n[Math.abs(this.height-1-parseInt(o))]}var r=this.symbolArr,s=0,c=0;for(o=0;o<this.height;o++)for(a=0;a<this.width;a++){r[o]||(r[o]=[]);var d=0,f=0,g=0,y=0,m=null,C=0;if(t&&t.length>0){d=(_=t[o][a]).type,f=_.gradeUp,g=_.grade,y=_.removalFr,m=_.info,C=t[o][a].type<30?1:t[o][a].type-0,101==t[o][a].type?C=101:t[o][a].type<100&&t[o][a].type>30&&(C=50)}else{if(d=this.SingleRandom(),console.log("----------------------------------------",d),0==o&&0==a){var v=l.default.instance.nowIsHaveExperience();v&&(d=v)}null!==d&&s==d?++c>=2&&(d<3*this.gradeMax-1&&(d=this.NewRandom(d)),c=0,s=d):(s=d,c=0),(y=this.terrainArr[o][a])>=2&&(y+=""),C=this.terrainArr[o][a]<=1?this.terrainArr[o][a]:101}if(1==C){var _={type:d,gradeUp:f,fallDownNum:0,banOneGame:0,cuimian:0,info:m,grade:g,x:o,y:a};r[o][a]=_}else if(50==C){_={type:d,removalFr:y,operation:!1,banOneGame:0,cuimian:0,info:m,x:o,y:a};r[o][a]=_,this.trapArr.push(_)}else if(101==C){var b=0,T=0;if("string"==typeof y){var S=(y+"").split("-");T=parseInt(S[2]),b=parseInt(S[1]),y=parseInt(S[0]),1==b&&(m={id:parseInt(S[3]),grade:parseInt(S[4]),lv:parseInt(S[5])})}else{this.terrainArr=[];var I,w=p.default.instance.getChapterData1();i=(I=h.default.instance.getConfig(w).table.split(";")).splice(0,1)[0].split(",");I.splice(I.length-1,1);n=[];for(var D=0;D<this.height;D++){n[D]=[];for(var R=0;R<this.width;R++)n[D][R]=I[D*this.width+R].split(",")[1].indexOf("-")>-1?I[D*this.width+R].split(",")[1]:parseInt(I[D*this.width+R].split(",")[1])}for(var A in n)this.terrainArr[A]=n[Math.abs(this.height-1-parseInt(A))];S=(this.terrainArr[o][a]+"").split("-");T=parseInt(S[2]),1==(b=parseInt(S[1]))&&(m={id:parseInt(S[3]),grade:parseInt(S[4]),lv:parseInt(S[5])})}_={type:101,removalFr:y,operation:!1,trapNum:b,stepsNum:T,banOneGame:0,cuimian:0,info:m,x:o,y:a};r[o][a]=_,this.stoneArr.push(_)}else{_={type:100,removalFr:y};r[o][a]=_}}return t&&t.length>0?I=this.symbolArr:(this.starCtninuity(),this.symbolArr)},t.prototype.starCtninuity=function(e){void 0===e&&(e=!0);var t=this.continuity();if(t.length){if(!e&&this.loopIndex>100)return this.loopIndex=0,void this.screening();if(this.loopIndex>1e3)return this.loopIndex=0,this._initData(),void this.Single();if(0==t[0])for(var i=null,n=0,o=0;o<this.symbolArr[t[1]].length;o++)(this.checkCanUpCarMonster(this.symbolArr[t[1]][o].type)||this.checkIsGuideBaoXiang(this.symbolArr[t[1]][o].type))&&null!==this.symbolArr[t[1]][o].type&&i==this.symbolArr[t[1]][o].type?++n>=2&&(this.symbolArr[t[1]][o].type=this.NewRandom(this.symbolArr[t[1]][o].type),o--):(i=this.symbolArr[t[1]][o].type,n=0);else if(1==t[0])for(i=null,n=0,o=0;o<this.symbolArr.length;o++)(this.checkCanUpCarMonster(this.symbolArr[o][t[1]].type)||this.checkIsGuideBaoXiang(this.symbolArr[o][t[1]].type))&&null!==this.symbolArr[o][t[1]].type&&i==this.symbolArr[o][t[1]].type?++n>=2&&(this.symbolArr[o][t[1]].type=this.NewRandom(this.symbolArr[o][t[1]].type),o--):(i=this.symbolArr[o][t[1]].type,n=0);else if(2==t[0])for(i=null,n=0,o=0;o<t[1].length;o++)(this.checkCanUpCarMonster(this.symbolArr[t[1][o][0]][t[1][o][1]].type)||this.checkIsGuideBaoXiang(this.symbolArr[t[1][o][0]][t[1][o][1]].type))&&null!==this.symbolArr[t[1][o][0]][t[1][o][1]].type&&i==this.symbolArr[t[1][o][0]][t[1][o][1]].type?++n>=2&&(this.symbolArr[t[1][o][0]][t[1][o][1]].type=this.NewRandom(this.symbolArr[t[1][o][0]][t[1][o][1]].type),o--):(i=this.symbolArr[t[1][o][0]][t[1][o][1]].type,n=0);else if(e)return;this.starCtninuity(e)}else if(e)return},t.prototype.continuity=function(){var e=[];for(var t in this.symbolArr)for(var i in e[t]=[],this.symbolArr[t]){var n=null!==this.symbolArr[t][i].type?this.symbolArr[t][i].type:null;e[t].push(n)}var o=[];for(var t in e){if(this._check(e[t]))return[0,t];for(var i in o=[],e)o.push(e[i][t]);if(this._check(o))return[1,t]}var a=[],r=[],s=e.length>e[0].length?e.length:e[0].length;for(t=0;t<2*s-1;t++){var l=t<s-1?t:s-1,c=s-1-t>=0?0:Math.abs(s-1-t);a=[],r=[];for(i=0;i<s;i++)if(e[l]&&(a.push(e[l][c]),r.push([l,c]),c++,--l>=s||l<0||c>=s||c<0)){if(this._check(a))return[2,r];break}}for(t=0;t<2*s-1;t++){c=s-1-t>=0?0:Math.abs(s-1-t),l=s-1-t<=0?0:Math.abs(s-1-t);a=[],r=[];for(i=0;i<s;i++)if(console.log(l,c),a.push(e[l][c]),r.push([l,c]),c++,++l>=s||l<0||c>=s||c<0){if(this._check(a))return[2,r];break}}return[]},t.prototype._check=function(e){this.loopIndex++;var t=0,i=null,n=0;for(var o in e)if((this.checkCanUpCarMonster(e[o])||this.checkIsGuideBaoXiang(e[o]))&&null!==e[o]&&i==e[o]?++n>=2&&t++:(i=e[o],n=0),t)return t;return t},t.prototype._gameSingle=function(e){var t=e.getUserData(),i=t.active;t.symbol;if(this._aloneOut=!0,this.resultIndex=0,this.isDropNum=0,this.crossArr=[],this.upSymbol=[],this.monster=[],this.data=[],this.historyArr=[],this.trapInfoArr=[],this.secondArr=[],this.storageArr.push([{type:this.symbolArr[i.x][i.y].type,grade:this.symbolArr[i.x][i.y].grade,x:i.x,y:i.y}]),this.monster[0]={type:this.symbolArr[i.x][i.y].type,num:1,lv:this.symbolArr[i.x][i.y].grade},this.operationArr=[{x:i.x,y:i.y}],this.symbolArr[i.x][i.y]=null,this._arrange(),this._aloneData(1),this.upSymbol=[],this.monster=[],this.crossArr=[],this.storageArr=[],this._eliminate()>0)this.resultIndex++,this._formationJudge(),this._arrange(),this.addRes(1);else{if(this.trapArr.length)return void this.trapScreening();console.log("==================\u6bcf\u6b65\u7ed3\u675f\u540e\u7684\u6570\u636e==================="),console.log(this.data),u.default.instance.gameResult(this.data)}},t.prototype._exDelete=function(e,t){this.symbolArr[t.x][t.y].removalFr-=1,this.addTrapArr.push({type:this.symbolArr[t.x][t.y].type,x:this.symbolArr[t.x][t.y].x,y:this.symbolArr[t.x][t.y].y,removalFr:this.symbolArr[t.x][t.y].removalFr,info:{type:this.symbolArr[t.x][t.y].info.id,grade:this.symbolArr[t.x][t.y].info.grade,lv:this.symbolArr[t.x][t.y].info.lv}}),this.symbolArr[e.x][e.y]=null,this.symbolArr[t.x][t.y].removalFr<=0&&(this.symbolArr[t.x][t.y]=null),this._arrange(),this._aloneData(1),this.continue()},t.prototype._deleteTrapNum=function(e,t){var i=this.symbolArr[t.x][t.y].type;i==r.SandTableTrapType.CHUANSONG&&(this.deleteChuanSongNum=!0),i==r.SandTableTrapType.TANGHUANG&&(this.deleteTangHuangNum=!0),this.symbolArr[t.x][t.y].removalFr-=1,this.addTrapArr.push({type:this.symbolArr[t.x][t.y].type,x:this.symbolArr[t.x][t.y].x,y:this.symbolArr[t.x][t.y].y,removalFr:this.symbolArr[t.x][t.y].removalFr}),this.symbolArr[e.x][e.y]=null,this.symbolArr[t.x][t.y].removalFr<=0&&(this.symbolArr[t.x][t.y]=null),this._arrange(),this._aloneData(1),this.continue()},t.prototype._exStop=function(e,t){var i=this.symbolArr[t.x][t.y],n=i.type;if(-1!=this.OfferTypeTrapInfo.indexOf(n)){for(var o=void 0,a=0;a<this.trapArr.length;a++)if(n==this.trapArr[a].type){o=a;break}this._aloneData(1),this.symbolArr[e.x][e.y]=null,this.inTrapScreenTwo(n,[o],e.x,e.y),this.upSymbol=[],this.monster=[],this.crossArr=[],this.storageArr=[],this.addTrapArr=[],this.historyArr=[],this.addTrapArr.push({type:n}),this._arrange(),this._upGrade(),this.data[this.data.length-1].trapInfoArr=this.trapInfoArr.slice(0),this.data[this.data.length-1].secondArr=this.secondArr.slice(0),this.node.getComponent("SandTableMain").gameResult(this.data)}else{if(this.storageArr.push([{type:this.symbolArr[e.x][e.y].type,grade:this.symbolArr[e.x][e.y].grade,x:e.x,y:e.y}]),this.operationArr=[{x:e.x,y:e.y}],i.removalFr-=1,this.addTrapArr.push({type:n,x:t.x,y:t.y,removalFr:i.removalFr,info:{type:l.MonsterType.MonsterWarTeam[l.MonsterType.MonsterBattle][this.symbolArr[e.x][e.y].type%3],grade:Math.floor(this.symbolArr[e.x][e.y].type/3)+1,lv:this.symbolArr[e.x][e.y].grade+1}}),this.symbolArr[e.x][e.y]=null,!i.removalFr){for(a=0;a<this.trapArr.length;a++)if(this.trapArr[a].type==n&&this.trapArr[a].x==t.x&&this.trapArr[a].y==t.y){this.trapArr.splice(a,1);break}this.symbolArr[t.x][t.y]=null}this._arrange(),this._aloneData(1),this.continue()}},t.prototype.continue=function(){if(this.upSymbol=[],this.monster=[],this.crossArr=[],this.storageArr=[],this.addTrapArr=[],this.historyArr=[],this._eliminate()>0)this.resultIndex++,this._formationJudge(),this._arrange(),this.addRes(1);else{if(this.trapArr.length)return void this.trapScreening();this.node.getComponent("SandTableMain").gameResult(this.data)}},t.prototype._gameMotion=function(e){var t=e.getUserData(),i=t.active,n=t.passive;t.symbol;for(var o in this._activeIndex={x:i.x,y:i.y},this._passiveIndex={x:n.x,y:n.y},this.resultIndex=0,this.isDropNum=0,this.operationArr=[this._activeIndex,this._passiveIndex],this.crossArr=[],this.upSymbol=[],this.monster=[],this.addTrapArr=[],this.trapInfoArr=[],this.secondArr=[],this.historyArr=[],this._aloneOut=!1,this.symbolArr)for(var a in this.symbolArr[o])this.symbolArr[o][a].banOneGame>0&&(this.symbolArr[o][a].banOneGame-=1);for(var o in this.symbolArr)for(var a in this.symbolArr[o])this.symbolArr[o][a].cuimian>0&&(this.symbolArr[o][a].cuimian-=1);return this.deleteChuanSongNum=!1,this.deleteTangHuangNum=!1,this.data=[],this.symbolArr[n.x][n.y].type==r.SandTableTrapType.JITAN?this._exDelete(i,n):this.OfferTypeTrapTree.indexOf(this.symbolArr[n.x][n.y].type)>-1?this._deleteTrapNum(i,n):this.OfferTypeTrap.indexOf(this.symbolArr[n.x][n.y].type)>-1?this._exStop(i,n):(this._exchange(i,n),this._eliminate()>0&&(this._formationJudge(),this._arrange()),void this.addRes(1))},t.prototype.addRes=function(e){for(var t in this.stoneArr)this.stoneArr[t].operation=!1;if(this._aloneData(e),this._eliminate()>0)this.resultIndex++,this.upSymbol=[],this.monster=[],this.crossArr=[],this.addTrapArr=[],1==e&&(this.trapInfoArr=[]),this._formationJudge(),this._arrange(),this.addRes(e);else if(1==e){if(console.log("\u6570\u636e\u5904\u7406\u7ed3\u675f \u5f00\u59cb\u4f20\u56de\u6570\u636e \u5faa\u73af\u6b21\u6570\u4e3a \uff1a",this.resultIndex),this.trapArr.length)return void this.trapScreening();console.log("==================\u6bcf\u6b65\u7ed3\u675f\u540e\u7684\u6570\u636e==================="),console.log(this.data),u.default.instance.gameResult(this.data)}},t.prototype.sameTesting=function(e,t){for(var i in e)for(var n in e[i])if(e[i][n]!=t[i][n].type)return console.log("\u6570\u636e\u6570\u7ec4\u548c\u6c99\u76d8\u663e\u793a\u6570\u636e\u4e0d\u5bf9",i,n,e,t),!1;return!0},t.prototype._exchange=function(e,t){var i=this.symbolArr[e.x][e.y];this.symbolArr[e.x][e.y]=this.symbolArr[t.x][t.y],this.symbolArr[t.x][t.y]=i},t.prototype._eliminate=function(){var e=[],t=0,i=[],n=[];for(var o in this.storageArr=[],this.symbolArr)for(var a in e[o]=[],this.symbolArr[o]){var r=null!==this.symbolArr[o][a].type?this.symbolArr[o][a].type:null;e[o].push(r)}for(var o in e){for(var s in i=[],e[o])i.push({type:e[o][s],grade:this.symbolArr[o][s].grade,y:parseInt(s),x:parseInt(o)});for(var a in t+=this._eliminateScreen(i),i=[],e)this.symbolArr[a][o]&&i.push({type:e[a][o],grade:this.symbolArr[a][o].grade,y:parseInt(o),x:parseInt(a)});t+=this._eliminateScreen(i)}var l=e.length>e[0].length?e.length:e[0].length;for(o=0;o<2*l-1;o++){var c=o<l-1?o:l-1,d=l-1-o>=0?0:Math.abs(l-1-o);n=[];for(a=0;a<l;a++){if(!this.symbolArr[c][d]){t+=this._eliminateScreen(n);break}if(n.push({type:e[c][d],grade:this.symbolArr[c][d].grade,x:c,y:d}),d++,--c>=l||c<0||d>=l||d<0){t+=this._eliminateScreen(n);break}}}for(o=0;o<2*l-1;o++){d=l-1-o>=0?0:Math.abs(l-1-o),c=l-1-o<=0?0:Math.abs(l-1-o);n=[];for(a=0;a<l;a++){if(!this.symbolArr[c][d]){t+=this._eliminateScreen(n);break}if(n.push({type:e[c][d],grade:this.symbolArr[c][d].grade,x:c,y:d}),d++,++c>=l||c<0||d>=l||d<0){t+=this._eliminateScreen(n);break}}}return t},t.prototype.increase=function(e,t){var i=!1;if(this.checkIsGuideBaoXiang(this.symbolArr[this.storageArr[e][t].x][this.storageArr[e][t].y].type)||(this.symbolArr[this.storageArr[e][t].x][this.storageArr[e][t].y].type+=3),this.upTalentArr&&this.upTalentArr.length){var n=this.symbolArr[this.storageArr[e][t].x][this.storageArr[e][t].y].type,o=this.upTalentArr.indexOf(n%3);o>-1&&this.checkCanUpCarMonster(n)&&(this.upTalentArr.splice(o,1),this.symbolArr[this.storageArr[e][t].x][this.storageArr[e][t].y].type+=3)}(this.checkIsGuideBaoXiang(this.symbolArr[this.storageArr[e][t].x][this.storageArr[e][t].y].type)||(this.symbolArr[this.storageArr[e][t].x][this.storageArr[e][t].y].grade=this._getNowGrade(this.storageArr[e])),this.talenSkills)&&(100*Math.random()<this.skillsProbability&&(this.symbolArr[this.storageArr[e][t].x][this.storageArr[e][t].y].grade+=this.skillsIncrease,i=!0));this.upSymbol.push([this.storageArr[e][t].x,this.storageArr[e][t].y,this.symbolArr[this.storageArr[e][t].x][this.storageArr[e][t].y].type,i])},t.prototype._formationJudge=function(){for(var e=0;e<this.storageArr.length;e++)for(var t=e;t<this.storageArr.length;t++){var i=!1;t!=e&&this.storageArr[e][0].type==this.storageArr[t][0].type&&(i=this._relation(this.storageArr[e],this.storageArr[t],e)),i&&(this._mergeArr(this.storageArr[e],this.storageArr[t]),this.storageArr.splice(t,1),t=e)}for(var e in this.storageArr)for(var t in this._setMonster(parseInt(e),this.symbolArr[this.storageArr[e][0].x][this.storageArr[e][0].y].type,this.storageArr[e].length-2),this.storageArr[e])if(this.stoneArr.length&&this._stoneTesting(this.storageArr[e][t].x,this.storageArr[e][t].y),this._aloneOut||0!=this.resultIndex)this.storageArr[e].length<5?parseInt(t)==Math.floor((this.storageArr[e].length-1)/2)?this.increase(e,t):this.symbolArr[this.storageArr[e][t].x][this.storageArr[e][t].y]=null:this.crossArr[e]&&this.crossArr[e].length?this.storageArr[e][t].x==this.crossArr[e][0].x&&this.storageArr[e][t].y==this.crossArr[e][0].y?this.increase(e,t):this.symbolArr[this.storageArr[e][t].x][this.storageArr[e][t].y]=null:parseInt(t)==Math.floor((this.storageArr[e].length-1)/2)?this.increase(e,t):this.symbolArr[this.storageArr[e][t].x][this.storageArr[e][t].y]=null;else{var n=!0;for(var o in this.storageArr[e])if(this.storageArr[e][o].x==this._passiveIndex.x&&this.storageArr[e][o].y==this._passiveIndex.y||this.storageArr[e][o].x==this._activeIndex.x&&this.storageArr[e][o].y==this._activeIndex.y){n=!1;break}n?this.storageArr[e][t].x==this.storageArr[e][this.storageArr[e].length-1].x&&this.storageArr[e][t].y==this.storageArr[e][this.storageArr[e].length-1].y?this.increase(e,t):this.symbolArr[this.storageArr[e][t].x][this.storageArr[e][t].y]=null:this.storageArr[e][t].x==this._passiveIndex.x&&this.storageArr[e][t].y==this._passiveIndex.y||this.storageArr[e][t].x==this._activeIndex.x&&this.storageArr[e][t].y==this._activeIndex.y?this.increase(e,t):this.symbolArr[this.storageArr[e][t].x][this.storageArr[e][t].y]=null}},t.prototype._arrange=function(){for(var e=this.symbolArr.length-1;e>=0;e--)for(var t=0;t<this.symbolArr.length;t++)if(!(null==this.symbolArr[e][t]||this.symbolArr[e][t].type>50||this.symbolArr[e][t].cuimian||this.symbolArr[e][t].banOneGame)){for(var i=0,n=this.symbolArr[e].length-1;n>e;n--)this.symbolArr[n]&&(null==this.symbolArr[n][t]||i>0&&(this.symbolArr[n][t].type>50||this.symbolArr[n][t].cuimian||this.symbolArr[n][t].banOneGame))&&i++;this.symbolArr[e][t].fallDownNum=i,this._exchange({x:e,y:t},{x:e+this.symbolArr[e][t].fallDownNum,y:t})}if(this.isSeedCome)for(e=0;e<this.symbolArr.length;e++)for(t=this.symbolArr.length-1;t>=0;t--)if(null==this.symbolArr[t][e]){var o={type:this.Random(),gradeUp:0,fallDownNum:0,grade:0};this.symbolArr[t][e]=o}else this.symbolArr[t][e].fallDownNum=0;else{var a=[];for(e=0;e<this.symbolArr.length;e++)for(var t in this.symbolArr[e])if(null==this.symbolArr[e][t]){o={type:this.SingleRandom(),gradeUp:0,fallDownNum:0,banOneGame:0,cuimian:0,grade:0,x:e,y:parseInt(t)};a.push(o),this.symbolArr[e][t]=o}else this.symbolArr[e][t].fallDownNum=0}},t.prototype.resetScreening=function(e){if(this.screening()){var t=[];for(var i in this.screeningArr)for(var n in this.screeningArr[i]){var o=this.screeningArr[i][n];-1==t.indexOf(this.symbolArr[o.x][o.y])&&t.push(this.symbolArr[o.x][o.y])}for(var i in e)t.indexOf(e[i])>-1&&(e[i].type=this.NewRandom(e[i].type));this.starCtninuity(!1)}console.log("\u6389\u843d\u5f15\u8d77\u4e09\u6d88\u91cd\u7f6e\u6389\u843d")},t.prototype.screening=function(){var e=[],t=0,i=[],n=[];for(var o in this.screeningArr=[],this.symbolArr)for(var a in e[o]=[],this.symbolArr[o]){var r=null!==this.symbolArr[o][a].type?this.symbolArr[o][a].type:null;e[o].push(r)}for(var o in e){for(var s in i=[],e[o])i.push({type:e[o][s],grade:this.symbolArr[o][s].grade,y:parseInt(s),x:parseInt(o)});for(var a in t+=this.screeningTwo(i),i=[],e)this.symbolArr[a][o]&&i.push({type:e[a][o],grade:this.symbolArr[a][o].grade,y:parseInt(o),x:parseInt(a)});t+=this.screeningTwo(i)}var l=e.length>e[0].length?e.length:e[0].length;for(o=0;o<2*l-1;o++){var c=o<l-1?o:l-1,d=l-1-o>=0?0:Math.abs(l-1-o);n=[];for(a=0;a<l;a++){if(!this.symbolArr[c][d]){t+=this.screeningTwo(n);break}if(n.push({type:e[c][d],grade:this.symbolArr[c][d].grade,x:c,y:d}),d++,--c>=l||c<0||d>=l||d<0){t+=this.screeningTwo(n);break}}}for(o=0;o<2*l-1;o++){d=l-1-o>=0?0:Math.abs(l-1-o),c=l-1-o<=0?0:Math.abs(l-1-o);n=[];for(a=0;a<l;a++){if(!this.symbolArr[c][d]){t+=this.screeningTwo(n);break}if(n.push({type:e[c][d],grade:this.symbolArr[c][d].grade,x:c,y:d}),d++,++c>=l||c<0||d>=l||d<0){t+=this.screeningTwo(n);break}}}return t},t.prototype.screeningTwo=function(e){var t=0,i=[],n=null,o=0;for(var a in e)!this.checkIsGuideBaoXiang(e[a].type)&&!this.checkCanUpCarMonster(e[a].type)||this.symbolArr[e[a].x][e[a].y].banOneGame||this.symbolArr[e[a].x][e[a].y].cuimian||null==e[a].type||n!==e[a].type?(o>=2&&this.screeningArr.push(i.slice(0)),i=[],n=null,!this.symbolArr[e[a].x][e[a].y].banOneGame&&!this.symbolArr[e[a].x][e[a].y].cuimian&&null!=e[a].type&&e[a].type<51&&(i.push(e[a]),n=e[a].type),o=0):(o++,i.push(e[a]),o>=2&&t++);return o>=2&&this.screeningArr.push(i.slice(0)),t},t.prototype.setupTalent=function(e){this.upTalentArr.indexOf(e)>-1||this.upTalentArr.push(e)},t.prototype.setTalent=function(e){this.talenSkills=!0,this.skillsProbability=e,this.skillsIncrease=1},t.prototype._eliminateScreen=function(e){var t=0,i=[],n=null,o=0;for(var a in e)!this.checkIsGuideBaoXiang(e[a].type)&&!this.checkCanUpCarMonster(e[a].type)||this.symbolArr[e[a].x][e[a].y].banOneGame||this.symbolArr[e[a].x][e[a].y].cuimian||null==e[a].type||n!==e[a].type?(o>=2&&this.storageArr.push(i.slice(0)),i=[],n=null,!this.symbolArr[e[a].x][e[a].y].banOneGame&&!this.symbolArr[e[a].x][e[a].y].cuimian&&null!=e[a].type&&e[a].type<51&&(i.push(e[a]),n=e[a].type),o=0):(o++,i.push(e[a]),o>=2&&t++);return o>=2&&this.storageArr.push(i.slice(0)),t},t.prototype._relation=function(e,t,i){this.crossArr[i]||(this.crossArr[i]=[]);var n=!1;for(var o in e)for(var a in t)e[o].x==t[a].x&&e[o].y==t[a].y&&(this.crossArr[i].length?this.crossArr[i][0].y>e[o].y?this.crossArr[i][0]=e[o]:this.crossArr[i][0].y==e[o].y&&this.crossArr[i][0].x<e[o].x&&(this.crossArr[i][0]=e[o]):this.crossArr[i].push(e[o]),n=!0);return n},t.prototype._mergeArr=function(e,t){for(var i in t){var n=!1;for(var o in e)t[i].x==e[o].x&&t[i].y==e[o].y&&(n=!0);n||e.push(t[i])}},t.prototype._getNowGrade=function(e){var t=0;for(var i in e)t+=e[i].grade;return t+=e.length-3},t.prototype._setMonster=function(e,t,i){this.monster[e]={type:t,num:i,lv:0}},t.prototype._stoneTesting=function(e,t){for(var i=0;i<this.stoneArr.length;i++)if(!this.stoneArr[i].operation&&(this.stoneArr[i].x==e&&1==Math.abs(this.stoneArr[i].y-t)||this.stoneArr[i].y==t&&1==Math.abs(this.stoneArr[i].x-e))&&(this.stoneArr[i].operation=!0,this.stoneArr[i].removalFr-=1,this.symbolArr[this.stoneArr[i].x][this.stoneArr[i].y].removalFr=this.stoneArr[i].removalFr,0==this.stoneArr[i].removalFr))if(this.stoneArr[i].trapNum>0){var n;n=50+this.stoneArr[i].trapNum,this.symbolArr[this.stoneArr[i].x][this.stoneArr[i].y]={type:n,removalFr:this.stoneArr[i].stepsNum,info:this.stoneArr[i].info,operation:!1,banOneGame:0,cuimian:0,first:!0,x:this.stoneArr[i].x,y:this.stoneArr[i].y},this.trapArr.push(this.symbolArr[this.stoneArr[i].x][this.stoneArr[i].y]),this.stoneArr.splice(i,1),i--}else this.symbolArr[this.stoneArr[i].x][this.stoneArr[i].y]=null,this.stoneArr.splice(i,1),i--},t.prototype.trapScreening=function(){var e=[];for(var t in this.trapArr)this.trapArr[t].first?this.trapArr[t].first=!1:e.push(this.trapArr[t].type);var i=[];for(t=0;t<this.OfferTypeTrapTwo.length;t++){i[t]||(i[t]=[]);for(var n=0;n<e.length;n++)this.OfferTypeTrapTwo[t]==e[n]&&i[t].push(n)}for(t=0;t<i.length;t++)if(i[t]&&i[t].length){var o=e[i[t][0]];this.inTrapScreen(o,i[t])}for(t=0;t<this.trapArr.length;t++)this.trapArr[t].removalFr<=0&&(this.trapArr.splice(t,1),t--);this.data[this.data.length-1].trapInfoArr=this.trapInfoArr.slice(0),this.data[this.data.length-1].secondArr=this.secondArr.slice(0),this.node.getComponent("SandTableMain").gameResult(this.data)},t.prototype.addTrapResult=function(e,t){(this.trapInfoArr.push(t),e)?this._trapAway():this._eliminate()>0&&this._upGrade()},t.prototype.addTrapResultTwo=function(e,t){if(this.trapInfoArr.push(t),this.resultIndex=0,this.secondArr[this.isDropNum]||(this.secondArr[this.isDropNum]=[]),this._arrange(),this._aloneData(2),this.resetResultArr(),this._eliminate()>0)return this._formationJudge(),this._arrange(),void this.addRes(2)},t.prototype.inTrapScreen=function(e,t){if(!(this.OfferTypeTrapTree.indexOf(e)>-1&&(this.deleteTangHuangNum||this.deleteChuanSongNum))){this.historyArr=[];var i=[],n=!1,o=!1,a=null;for(var s in t){var c=t[s],d=this.trapArr[c];-1==this.OfferTypeTrapTree.indexOf(e)&&(d.removalFr-=1),n=d.removalFr<=0;var p=d.x,h=d.y;switch(e){case r.SandTableTrapType.TIECHUI:var u=this._randomStone();if(this.historyArr=this.historyArr.concat(u),!n){for(var f in u)0==u[f].removalFr?1:0}if(u.length)for(var g=0;g<u.length;g++)i.push({index:e,center:d,isDrop:n,stora:u[g]});else i.push({index:e,center:d,isDrop:n,stora:null});break;case r.SandTableTrapType.HUOPAO:i.push({index:e,center:d,delete:n});break;case r.SandTableTrapType.QIYUAN:this.symbolArr[d.x][d.y+1]&&this.symbolArr[d.x][d.y+1].type<30&&(this.symbolArr[d.x][d.y+1].grade+=5),this.symbolArr[d.x][d.y-1]&&this.symbolArr[d.x][d.y-1].type<30&&(this.symbolArr[d.x][d.y-1].grade+=5),this.symbolArr[d.x+1]&&this.symbolArr[d.x+1][d.y]&&this.symbolArr[d.x+1][d.y].type<30&&(this.symbolArr[d.x+1][d.y].grade+=5),this.symbolArr[d.x-1]&&this.symbolArr[d.x-1][d.y]&&this.symbolArr[d.x-1][d.y].type<30&&(this.symbolArr[d.x-1][d.y].grade+=5),i.push({index:e,center:d,arr:[{symbol:this.symbolArr[d.x][d.y+1],x:d.x,y:d.y+1},{symbol:this.symbolArr[d.x][d.y-1],x:d.x,y:d.y-1},{symbol:this.symbolArr[d.x+1]?this.symbolArr[d.x+1][d.y]:null,x:d.x+1,y:d.y},{symbol:this.symbolArr[d.x-1]?this.symbolArr[d.x-1][d.y]:null,x:d.x-1,y:d.y}]});break;case r.SandTableTrapType.JIANGJI:var y=[];this.symbolArr[d.x][d.y+1]&&this.checkCanUpCarMonster(this.symbolArr[d.x][d.y+1].type)&&(this.symbolArr[d.x][d.y+1].type>2&&(this.symbolArr[d.x][d.y+1].type-=3),y.push({symbol:this.symbolArr[d.x][d.y+1]?this.symbolArr[d.x][d.y+1].type:null,x:d.x,y:d.y+1})),this.symbolArr[d.x][d.y-1]&&this.checkCanUpCarMonster(this.symbolArr[d.x][d.y-1].type)&&(this.symbolArr[d.x][d.y-1].type>2&&(this.symbolArr[d.x][d.y-1].type-=3),y.push({symbol:this.symbolArr[d.x][d.y-1]?this.symbolArr[d.x][d.y-1].type:null,x:d.x,y:d.y-1})),this.symbolArr[d.x+1]&&this.symbolArr[d.x+1][d.y]&&this.checkCanUpCarMonster(this.symbolArr[d.x+1][d.y].type)&&(this.symbolArr[d.x+1][d.y].type>2&&(this.symbolArr[d.x+1][d.y].type-=3),y.push({symbol:this.symbolArr[d.x+1]?this.symbolArr[d.x+1][d.y].type:null,x:d.x+1,y:d.y})),this.symbolArr[d.x-1]&&this.symbolArr[d.x-1][d.y]&&this.checkCanUpCarMonster(this.symbolArr[d.x-1][d.y].type)&&(this.symbolArr[d.x-1][d.y].type>2&&(this.symbolArr[d.x-1][d.y].type-=3),y.push({symbol:this.symbolArr[d.x-1]?this.symbolArr[d.x-1][d.y].type:null,x:d.x-1,y:d.y})),i.push({index:e,center:d,isDrop:n,arr:y});break;case r.SandTableTrapType.CHUANSONG:var m=this._randomSym(),C=d.x,v=d.y,_=m.x,b=m.y;this._exchange({x:m.x,y:m.y},{x:d.x,y:d.y}),d.x=m.x,d.y=m.y,i.push({index:e,center:d,active:{type:m.type,x:_,y:b},passive:{type:e,x:C,y:v},isDrop:n});break;case r.SandTableTrapType.TANGHUANG:C=d.x,v=d.y;if(this.symbolArr[C-1]&&this.symbolArr[C-1][v]){m=this.symbolArr[C-1][v].type;var T=this.symbolArr[C-1][v].grade;m<15&&(1==(a={type:m,id:l.MonsterType.MonsterWarTeam[l.MonsterType.MonsterBattle][m%3],grade:Math.max(Math.ceil(m/3),1),lv:Math.max(T,1),x:C-1,y:v}).id&&a.type&&a.grade++,this.symbolArr[C-1][v]=null),n||this._trapAway()}i.push({index:e,isDrop:n,center:d,launch:a});break;case r.SandTableTrapType.MEIDUSHA:var S=[[d.x+1,d.y-1],[d.x,d.y-1],[d.x-1,d.y-1],[d.x-1,d.y-1],[d.x-1,d.y],[d.x-1,d.y+1],[d.x+1,d.y-1],[d.x+1,d.y],[d.x+1,d.y+1],[d.x-1,d.y+1],[d.x,d.y+1],[d.x+1,d.y+1]],I=this.getMeiDuShaIndex(),w=[],D=S[I][0],R=S[I][1];this.symbolArr[D]&&this.symbolArr[D][R]&&this.symbolArr[D][R].type<15&&(this.symbolArr[D][R].banOneGame=2,w.push({x:D,y:R})),D=S[++I][0],R=S[I][1],this.symbolArr[D]&&this.symbolArr[D][R]&&this.symbolArr[D][R].type<15&&(this.symbolArr[D][R].banOneGame=2,w.push({x:D,y:R})),D=S[++I][0],R=S[I][1],this.symbolArr[D]&&this.symbolArr[D][R]&&this.symbolArr[D][R].type<15&&(this.symbolArr[D][R].banOneGame=2,w.push({x:D,y:R})),i.push({index:r.SandTableTrapType.MEIDUSHA,center:{removalFr:d.removalFr,x:d.x,y:d.y},arr:w});break;case r.SandTableTrapType.WUSHU:i.push({index:r.SandTableTrapType.WUSHU,center:{removalFr:d.removalFr,x:d.x,y:d.y}})}r.SandTableTrapType.TANGHUANG!=e&&r.SandTableTrapType.CHUANSONG!=e&&this._trapAway(),n&&(this.storageArr[0]||(this.storageArr[0]=[]),this.storageArr[0].push({type:e,x:p,y:h}),this.symbolArr[d.x][d.y]=null,o=!0,e==r.SandTableTrapType.TANGHUANG&&this._arrange())}this.addTrapResult(o,i),this.isDropNum++}},t.prototype.getMeiDuShaIndex=function(){for(var e=0;e<9999;e++){var t=3*s.default.RandomBy(0,3);if(this.meidushaIndex!=t)return this.meidushaIndex=t,t}},t.prototype.inTrapScreenTwo=function(e,t,i,n){this.historyArr=[];var o=[],a=!1,s=!1;for(var l in t){var c=t[l],d=this.trapArr[c];switch(d.removalFr-=1,a=d.removalFr<=0,e){case r.SandTableTrapType.SHENGJI:var p=[];this.symbolArr[d.x][d.y+1]&&this.checkCanUpCarMonster(this.symbolArr[d.x][d.y+1].type)&&(i==d.x&&d.y+1==n||(this.symbolArr[d.x][d.y+1].type+=3,p.push({symbol:this.symbolArr[d.x][d.y+1]?this.symbolArr[d.x][d.y+1].type:null,x:d.x,y:d.y+1}))),this.symbolArr[d.x][d.y-1]&&this.checkCanUpCarMonster(this.symbolArr[d.x][d.y-1].type)&&(i==d.x&&d.y-1==n||(this.symbolArr[d.x][d.y-1].type+=3,p.push({symbol:this.symbolArr[d.x][d.y-1]?this.symbolArr[d.x][d.y-1].type:null,x:d.x,y:d.y-1}))),this.symbolArr[d.x+1]&&this.symbolArr[d.x+1][d.y]&&this.checkCanUpCarMonster(this.symbolArr[d.x+1][d.y].type)&&(i==d.x+1&&d.y==n||(this.symbolArr[d.x+1][d.y].type+=3,p.push({symbol:this.symbolArr[d.x+1][d.y]?this.symbolArr[d.x+1][d.y].type:null,x:d.x+1,y:d.y}))),this.symbolArr[d.x-1]&&this.symbolArr[d.x-1][d.y]&&this.checkCanUpCarMonster(this.symbolArr[d.x-1][d.y].type)&&(i==d.x-1&&d.y==n||(this.symbolArr[d.x-1][d.y].type+=3,p.push({symbol:this.symbolArr[d.x-1][d.y]?this.symbolArr[d.x-1][d.y].type:null,x:d.x-1,y:d.y}))),o.push({index:e,center:d,isDrop:a,arr:p});break;case r.SandTableTrapType.PINGDENG:var h=[];this.symbolArr[d.x][d.y+1]&&this.checkCanUpCarMonster(this.symbolArr[d.x][d.y+1].type)&&(i==d.x&&d.y+1==n||(this.symbolArr[d.x][d.y+1].type=this.symbolArr[d.x][d.y+1].type%3+6,h.push({symbol:this.symbolArr[d.x][d.y+1]?this.symbolArr[d.x][d.y+1].type:null,x:d.x,y:d.y+1}))),this.symbolArr[d.x][d.y-1]&&this.checkCanUpCarMonster(this.symbolArr[d.x][d.y-1].type)&&(i==d.x&&d.y-1==n||(this.symbolArr[d.x][d.y-1].type=this.symbolArr[d.x][d.y-1].type%3+6,h.push({symbol:this.symbolArr[d.x][d.y-1]?this.symbolArr[d.x][d.y-1].type:null,x:d.x,y:d.y-1}))),this.symbolArr[d.x+1]&&this.symbolArr[d.x+1][d.y]&&this.checkCanUpCarMonster(this.symbolArr[d.x+1][d.y].type)&&(i==d.x+1&&d.y==n||(this.symbolArr[d.x+1][d.y].type=this.symbolArr[d.x+1][d.y].type%3+6,h.push({symbol:this.symbolArr[d.x+1][d.y]?this.symbolArr[d.x+1][d.y].type:null,x:d.x+1,y:d.y}))),this.symbolArr[d.x-1]&&this.symbolArr[d.x-1][d.y]&&this.checkCanUpCarMonster(this.symbolArr[d.x-1][d.y].type)&&(i==d.x-1&&d.y==n||(this.symbolArr[d.x-1][d.y].type=this.symbolArr[d.x-1][d.y].type%3+6,h.push({symbol:this.symbolArr[d.x-1][d.y]?this.symbolArr[d.x-1][d.y].type:null,x:d.x-1,y:d.y}))),o.push({index:e,center:d,isDrop:a,arr:h});break;case r.SandTableTrapType.CUIMIAN:var u=[];this.symbolArr[d.x][d.y+1]&&(this.setSymbolInfo(this.symbolArr[d.x][d.y+1],3,5),(i!=d.x||d.y+1!=n&&this.symbolArr[d.x][d.y+1].type<15)&&u.push({symbol:this.symbolArr[d.x][d.y+1]?this.symbolArr[d.x][d.y+1].type:null,grade:this.symbolArr[d.x][d.y+1]?this.symbolArr[d.x][d.y+1].grade:null,x:d.x,cuimian:1,y:d.y+1})),this.symbolArr[d.x][d.y-1]&&(this.setSymbolInfo(this.symbolArr[d.x][d.y-1],3,5),(i!=d.x||d.y-1!=n&&this.symbolArr[d.x][d.y-1].type<15)&&u.push({symbol:this.symbolArr[d.x][d.y-1]?this.symbolArr[d.x][d.y-1].type:null,grade:this.symbolArr[d.x][d.y-1]?this.symbolArr[d.x][d.y-1].grade:null,x:d.x,cuimian:1,y:d.y-1})),this.symbolArr[d.x+1]&&this.symbolArr[d.x+1][d.y]&&(this.setSymbolInfo(this.symbolArr[d.x+1][d.y],3,5),(i!=d.x+1||d.y!=n&&this.symbolArr[d.x+1][d.y].type<15)&&u.push({symbol:this.symbolArr[d.x+1]&&this.symbolArr[d.x+1][d.y]?this.symbolArr[d.x+1][d.y].type:null,grade:this.symbolArr[d.x+1]&&this.symbolArr[d.x+1][d.y]?this.symbolArr[d.x+1][d.y].grade:null,x:d.x+1,cuimian:1,y:d.y})),this.symbolArr[d.x-1]&&this.symbolArr[d.x-1][d.y]&&(this.setSymbolInfo(this.symbolArr[d.x-1][d.y],3,5),(i!=d.x-1||d.y!=n&&this.symbolArr[d.x-1][d.y].type<15)&&u.push({symbol:this.symbolArr[d.x-1]&&this.symbolArr[d.x-1][d.y]?this.symbolArr[d.x-1][d.y].type:null,grade:this.symbolArr[d.x-1]&&this.symbolArr[d.x-1][d.y]?this.symbolArr[d.x-1][d.y].grade:null,x:d.x-1,cuimian:1,y:d.y})),o.push({index:e,center:d,isDrop:a,arr:u})}a&&(this.storageArr[0]||(this.storageArr[0]=[]),this.storageArr[0].push({type:e,x:d.x,y:d.y}),this.symbolArr[d.x][d.y]=null,s=!0)}this.addTrapResultTwo(s,o)},t.prototype.setSymbolInfo=function(e,t,i){this.checkCanUpCarMonster(e.type)&&(e.type+=t),e.cuimian=1,e.grade=Math.min(r.MonsterMaxLevel,e.grade+i)},t.prototype._randomSym=function(){var e=Math.floor(this.height*Math.random()),t=Math.floor(this.width*Math.random());return this.symbolArr[e][t]&&this.checkCanUpCarMonster(this.symbolArr[e][t].type)&&-1==this.historyArr.indexOf(this.symbolArr[e][t])&&this.symbolArr[e][t].cuimian<=0&&this.symbolArr[e][t].banOneGame<=0?this.symbolArr[e][t+1]&&this.symbolArr[e][t+1].type==r.SandTableTrapType.CHUANSONG?this._randomSym():(this.historyArr.push(this.symbolArr[e][t]),{type:this.symbolArr[e][t].type,x:e,y:t}):this._randomSym()},t.prototype._randomStone=function(){var e=[],t=[];if(this.stoneArr.length)for(var i=0;i<this.stoneArr.length;i++){var n=this.stoneArr[i].removalFr-=5,o=this.stoneArr[i].x,a=this.stoneArr[i].y;if(n<=0)if(this.stoneArr[i].trapNum>0){var r;r=50+this.stoneArr[i].trapNum,this.symbolArr[this.stoneArr[i].x][this.stoneArr[i].y]={type:r,removalFr:this.stoneArr[i].stepsNum,info:this.stoneArr[i].info,operation:!1,banOneGame:0,cuimian:0,x:this.stoneArr[i].x,y:this.stoneArr[i].y},this.trapArr.push(this.symbolArr[this.stoneArr[i].x][this.stoneArr[i].y]);var s=this.trapArr[this.trapArr.length-1].removalFr;e.push({removalFr:-1,removaNum:s,x:o,y:a})}else this.symbolArr[this.stoneArr[i].x][this.stoneArr[i].y]=null,e.push({removalFr:0,x:o,y:a});else t.push(this.stoneArr[i]),e.push({removalFr:n,x:o,y:a})}return this.stoneArr=t,e},t.prototype._upGrade=function(){this.resultIndex=1,this.secondArr[this.isDropNum]||(this.secondArr[this.isDropNum]=[]),this._formationJudge(),this._arrange(),this.addRes(2),this.resetResultArr()},t.prototype.resetResultArr=function(){this.upSymbol=[],this.monster=[],this.crossArr=[],this.storageArr=[]},t.prototype._trapAway=function(){if(this.resultIndex=0,this.secondArr[this.isDropNum]||(this.secondArr[this.isDropNum]=[]),this._arrange(),this._aloneData(2),this.resetResultArr(),this._eliminate()>0)return this.resultIndex++,this._formationJudge(),this._arrange(),void this.addRes(2)},t.prototype._aloneData=function(e){var t=[];for(var i in this.symbolArr)for(var n in t[i]=[],this.symbolArr[i]){var o=this.symbolArr[i][n];t[i][n]={type:o.type,gradeUp:o.gradeUp,grade:o.grade,removalFr:o.removalFr,info:o.info,banOneGame:o.banOneGame,fallDownNum:o.fallDownNum,cuimian:o.cuimian,trapNum:o.trapNum}}var a=[];for(var i in this.storageArr)for(var n in a[i]=[],this.storageArr[i]){o=this.storageArr[i][n];a[i][n]={type:o.type,x:o.x,y:o.y}}var r=[];for(var i in this.monster){o=this.monster[i];r[i]={type:o.type,num:o.num,lv:o.lv}}var s=[];if(this.upSymbol.length>0)for(var i in this.storageArr)for(var n in s[i]=[],this.upSymbol[i])s[i].push(this.upSymbol[i][n]);this.upSymbol=[];var l=[];for(var i in this.addTrapArr)l.push(this.addTrapArr[0]);this.addTrapArr=[],1==e?this.data.push({result:{index:this.resultIndex,resultArr:t,storageArr:a,upSymbol:s,monsterArr:r,operationArr:this.operationArr,addTrapArr:l}}):(this.secondArr[this.isDropNum].push({result:{index:this.resultIndex,resultArr:t,storageArr:a,upSymbol:s,monsterArr:r,operationArr:this.operationArr,addTrapArr:l}}),console.log("\u6dfb\u52a0\u9677\u9631\u989d\u5916\u4e8b\u4ef6++ ",this.isDropNum,this.secondArr[this.isDropNum])),this.operationArr=[]},t.prototype.Random=function(){var e=3*this.gradeMax,t=Math.max(0,3*(this.gradeMin-1));a.default.instance.seed=(9301*a.default.instance.seed+49297)%233280;var i=a.default.instance.seed/233280,n=Math.floor(t+i*(e-t));return console.log("num",n),n},t.prototype.SingleRandom=function(){return s.default.RandomBy(3*(this.gradeMin-1),3*(this.gradeMax-1)+2)},t.prototype.NewRandom=function(e){var t=this.SingleRandom();return t!=e?t:this.NewRandom(e)},t.prototype.checkIsGuideBaoXiang=function(e){return-1!=this.symbolGuideBaoXiangArr.indexOf(e)},t.prototype.checkCanUpCarMonster=function(e){return e<12},t.instance=null,t=i=__decorate([g],t)}(o.default));i.default=y,cc._RF.pop()},{"../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Widget":"Widget","../../../Global/GlobalValue":"GlobalValue","../../../Util/Utils":"Utils","../../Arena/ArenaController":"ArenaController","../../Chapter/ChapterController":"ChapterController","../../Chapter/GuanqiaController":"GuanqiaController","../../Status/StatusType":"StatusType","../../WarTeam/MonsterController":"MonsterController","./../SandTableController":"SandTableController","./simulator_SandTable":"simulator_SandTable"}],simulator_SandTable:[function(e,t,i){"use strict";cc._RF.push(t,"aeb4bKHlDJDqqcRZwOHf6dS","simulator_SandTable"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/GameEventDispatcher"),o=e("./simulator_SandTableBackstage"),a=e("../../../Util/Utils"),r=e("../../Scene/Prop/EntityProperty"),s=e("../../Fight/staticattr"),l=e("../SandTableBackstage"),c=cc._decorator,d=c.ccclass,p=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.icon=null,t.TouchNode=null,t.mapNode=null,t.bg=null,t.heightL=null,t.widthL=null,t.stoneNum=null,t.gradeMin=null,t.gradeMax=null,t.inheritNum=null,t.step=null,t.rollNum=null,t.stepLabel=null,t.rollLabel=null,t.cardOneID=null,t.cardTwoID=null,t.cardThreeID=null,t.cardOneLevel=null,t.cardTwoLevel=null,t.cardThreeLevel=null,t.shapanText=null,t.cardOneData1=null,t.cardOneData2=null,t.Spoint=cc.v2(0,0),t.symbolArr=[],t._delete=!1,t._nowSymbol=null,t._arrWidth=4,t._arrHeight=4,t._height=0,t._width=0,t.infoText="",t.moveNum=5,t._rollNum=1,t.mapArr=[],t.indexArr=[],t.fractionArr=[],t.staticattr=null,t._newCardArr=[],t.rollStr="inherit",t._clickStr="",t._rollcont=0,t._rollCount=0,t._rollArr=[],t._canChange=!0,t._oldShaPan=[],t.haveRoll=!1,t._monsterNum=0,t._data=null,t._monterArr=[],t.cardData1=[0,0,0,0,0],t.cardData2=[0,0,0,0,0],t.cardData3=[0,0,0,0,0],t.lvMonster=[],t.oneRollNum=0,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){this.staticattr=new s.StaticAttr},t.prototype.start=function(){i.instance=this,n.GameEventDispatcher.instance.on("CHANGEICON",this._changeArray,this)},t.prototype.addStone=function(){this._clickStr="stone",console.log("\u6539\u53d8\u72b6\u6001:"+this._clickStr)},t.prototype.addIcon=function(){this._clickStr="addicon",console.log("\u6539\u53d8\u72b6\u6001:"+this._clickStr)},t.prototype.deleteIcon=function(){this._clickStr="deleteicon",console.log("\u6539\u53d8\u72b6\u6001:"+this._clickStr)},t.prototype.setStepNum=function(){var e=parseInt(this.step.string);parseInt(this.step.string)<1&&(e=1),this.moveNum=e,this.stepLabel.string=this.moveNum+""},t.prototype.again=function(){var e=this,t=setTimeout(function(){e.startTips(),clearTimeout(t)},10)},t.prototype.roll=function(){this.haveRoll=!0,this._canChange=!1,this._rollcont=0,this._monterArr=[],parseInt(this.rollNum.string)<0&&(this.rollNum.string="1"),this._rollNum=parseInt(this.rollNum.string),this._rollNum--,this._rollcont++,this._rollCount++,this.rollLabel.string=this._rollcont+"",this.setStepNum(),this.startTips()},t.prototype.inheritRoll=function(){this.rollStr="inherit"},t.prototype.resetRoll=function(){this.rollStr="reset"},t.prototype.resetData=function(){this.cardOneData2.getComponent(cc.Label).string="",this.cardOneData1.getComponent(cc.Label).string="",this.cardData1=[0,0,0,0,0],this.cardData2=[0,0,0,0,0],this.cardData3=[0,0,0,0,0],this.lvMonster=[],this._monsterNum=0,this.oneRollNum=0,this._rollCount=0,this._rollArr=[]},t.prototype.resetShapan=function(){this._clickStr="",this._canChange=!1,this.resetData(),this.haveRoll||(this._oldShaPan=JSON.parse(JSON.stringify(this._newCardArr))),this._newCardArr=JSON.parse(JSON.stringify(this._oldShaPan)),this.symbolArr=JSON.parse(JSON.stringify(this._oldShaPan)),o.default.instance.symbolArr=[],o.default.instance.symbolArr=JSON.parse(JSON.stringify(this._oldShaPan)),o.default.instance.stoneArr=[];for(var e=0;e<this.TouchNode.childrenCount;e++){var t=Math.floor(e/this._width),i=e%this._width;this.indexArr[t][i]=this._newCardArr[t][i].type,101==this._newCardArr[t][i].type&&o.default.instance.stoneArr.push(this._newCardArr[t][i]),this.TouchNode.children[e].getComponent("simulator_Icon").setBGshow(this._newCardArr[t][i])}},t.prototype.resetRollShapan=function(){o.default.instance.symbolArr=JSON.parse(JSON.stringify(this._oldShaPan)),this._newCardArr=JSON.parse(JSON.stringify(this._oldShaPan)),o.default.instance.stoneArr=[];for(var e=0;e<this.TouchNode.childrenCount;e++){var t=Math.floor(e/this._width),i=e%this._width;this.indexArr[t][i]=this._newCardArr[t][i].type,101==this._newCardArr[t][i].type&&o.default.instance.stoneArr.push(this._newCardArr[t][i]),this.TouchNode.children[e].getComponent("simulator_Icon").setBGshow(this._newCardArr[t][i])}},t.prototype.generate=function(){this._newCardArr=[],this._oldShaPan=[],this.symbolArr=[],this.indexArr=[],this.resetData(),this._canChange=!0,this.haveRoll=!1;this._height=parseInt(this.heightL.string),this._width=parseInt(this.widthL.string);var e=735/this._height,t=735/this._width;this._arrWidth=this._width,this._arrHeight=this._height,e<t?t=e:e=t,this.TouchNode.removeAllChildren();for(var i=0;i<this._height;i++){this.mapArr[i]=[],this.indexArr[i]=[];for(var n=0;n<this._width;n++){var o=(this._height-1)/2,a=(this._width-1)/2,r=this.Spoint.y+(i-o)*e,s=this.Spoint.x+(n-a)*t,l=cc.instantiate(this.icon);this.TouchNode.addChild(l,1),l.setPosition(s,r),l.getComponent("simulator_Icon").setSymbolSize(e,t),l.getComponent("simulator_Icon").setSymbolPo(i*this._arrWidth+n),this.mapArr[i][n]=l}}this.setInfo()},t.prototype.setInfo=function(){this.infoText="",this.infoText+=this._height+","+this._width+";";for(var e=0;e<this._height;e++)for(var t=0;t<this._width;t++){var i=e*this._arrWidth+t;this.infoText+=i+",1",this.infoText+=";"}""!=this.shapanText.string&&(this.infoText=this.shapanText.string),this._newCardArr=o.default.instance.Single(this.infoText),console.log("-----------------------------\u6578\u7d44--------------------------------"),console.log(this._newCardArr),this.setIconShow(this._newCardArr)},t.prototype.setIconShow=function(e){this.symbolArr=o.default.instance.symbolArr;for(var t=0;t<this.TouchNode.childrenCount;t++){var i=Math.floor(t/this._width),n=t%this._width;this.indexArr[i][n]=e[i][n].type,(this._rollNum<=0&&this.moveNum<=0||this._canChange)&&this.TouchNode.children[t].getComponent("simulator_Icon").setBGshow(e[i][n])}console.log(e)},t.prototype.clickGetText=function(){this.infoText="",this.infoText+=this._height+","+this._width+";";for(var e=[],t=this.indexArr.length-1;t>=0;t--)e.push(this.indexArr[t]);for(t=0;t<e.length;t++)for(var i=0;i<e[t].length;i++){var n=t*e[t].length+i;101==e[t][i]?(this.infoText+=n+",2",this.infoText+=";"):100==e[t][i]?(this.infoText+=n+",0",this.infoText+=";"):(this.infoText+=n+",1",this.infoText+=";")}this.shapanText.string=this.infoText,console.log(e),console.log(this.infoText)},t.prototype._changeArray=function(e){var t=0;switch(this._clickStr){case"stone":t=101;break;case"addicon":t=a.default.RandomBy(3*(parseInt(this.gradeMin.string)-1),3*(parseInt(this.gradeMax.string)-1)+2);break;case"deleteicon":t=100;break;default:return}var i=e.getUserData().spoint,n=Math.floor(i/this._width),o=i%this._width,r=this._newCardArr[n][o];r.type=t,101==t?(""==this.stoneNum.string&&(this.stoneNum.string="1"),r.removalFr=parseInt(this.stoneNum.string),r.operation=!1):100==t&&(r.removalFr=0),this.setIconShow(this._newCardArr)},t.prototype.startTips=function(){if(console.log("\u6b65\u6570:"+this.moveNum),this.stepLabel.string=this.moveNum+"",this.moveNum<=0){if("reset"==this.rollStr&&this.resetRollShapan(),!(this._rollNum>0))return void(this._canChange=!1);this.setStepNum(),this._rollNum--,this._rollcont++,this._rollCount++,this.rollLabel.string=this._rollcont+""}var e=this._automaticStar();if(e.length){var t=null;for(var i in e)t||(t=e[i]),e[i]&&t&&(e[i].type<2&&t.type<2&&e[i].power>t.power?t=e[i]:e[i].type>=2&&t.type>=2&&e[i].power>t.power?t=e[i]:t.type>=2&&e[i].type<2&&(t=e[i]));var n=this.mapArr[t.x][t.y],o=this.mapArr[t.x1][t.y1];n.x,n.y,o.x,o.y;this._voluntarily(t.x,t.y,t.x1,t.y1)}else{for(var a={x:0,y:0,power:0},r=0;r<this.symbolArr.length;r++)for(var s=0;s<this.symbolArr[r].length;s++){var l=this.symbolArr[r][s].type;if(l&&l<30){var c=this.monsterData[l%3].id,d=this.monsterData[l%3].level+this.symbolArr[r][s].grade,p=Math.floor(l/3)+1,h=this.getCarFight(c,d,p);h>a.power&&(a.power=h,a.x=r,a.y=s)}}this.mapArr[a.x][a.y].x,this.mapArr[a.x][a.y].y;this._voluntarilyOne(a.x,a.y)}},t.prototype._voluntarily=function(e,t,i,o){this.moveNum-=1;var a=[];for(var r in this.symbolArr)for(var s in a[r]=[],this.symbolArr[r]){var l=this.symbolArr[r][s].type;a[r].push(l)}console.log("\u901a\u77e5\u4ea4\u6362/-----"),n.GameEventDispatcher.instance.emit("GAMEMOTION",{active:{x:e,y:t},passive:{x:i,y:o},symbol:a})},t.prototype._voluntarilyOne=function(e,t){this.moveNum-=1;var i=[];for(var n in this.symbolArr)for(var o in i[n]=[],this.symbolArr[n]){var a=this.symbolArr[n][o].type;i[n].push(a)}this.symbolArr[e][t].type>=9&&this.symbolArr[e][t].type<=14&&(this.moveNum++,this.stepLabel.string=this.moveNum+""),console.log("\u5f53\u524d\u6c99\u76d8\uff1a",i),l.default.instance.gameSingle({x:e,y:t},i)},t.prototype._automaticStar=function(){this.fractionArr=[];for(var e=0;e<this.indexArr.length;e++)for(var t=0;t<this.indexArr[e].length;t++){var i=this.symbolArr[e][t];null!=this.indexArr[e][t]&&this.indexArr[e][t]<30&&i&&i.type>=0&&i.type<=16&&this._replaceStar(e,t)}return this.fractionArr},t.prototype._replaceStar=function(e,t){for(var i=0,n=0,o=0,a=this.indexArr.slice(0),r=e;r<this.indexArr.length;r++)for(var s=r==e?t:0;s<this.indexArr[r].length;s++)if((r!=e||s!=t)&&null!=this.indexArr[r][s]&&this.indexArr[r][s]<30&&this.symbolArr[r][s].type>=1&&this.symbolArr[r][s].type<=16){this._arrExchange(a,e,t,r,s),o=0;var l=0;if(i=this._inspectArr(a,e,t),o+=this.computingPower(a[e][t],i),i&&(l+=Math.floor(a[e][t]/3)),n=this._inspectArr(a,r,s),o+=this.computingPower(a[r][s],n),n&&(l+=Math.floor(a[r][s]/3)),o||(o=0),i+n>0){var c={power:o,x:0,y:0,x1:0,y1:0,type:l};i>n?(c.x=r,c.y=s,c.x1=e,c.y1=t):(c.x=e,c.y=t,c.x1=r,c.y1=s),this.fractionArr.push(c)}this._arrExchange(a,r,s,e,t)}},t.prototype._arrExchange=function(e,t,i,n,o){var a=e[t][i];e[t][i]=e[n][o],e[n][o]=a},t.prototype._inspectArr=function(e,t,i){var n=0,o=[],a=e[t][i],r=0;for(var s in e)o.push(e[s][i]);for(var s in r+=(n=this._check(o,a))>0?2+n:0,o=[],e[t])o.push(e[t][s]);n=this._check(o,a),r+=r?n>0?1+n:0:n>0?2+n:0;var l=this._arrHeight>this._arrWidth?this._arrHeight:this._arrWidth,c=0,d=0;t+i<l?(c=t+i,d=0):d=i-((c=this._arrWidth-1)-t),o=[];for(var p=0;p<l;p++){if(!e[c]){n=this._check(o,a);break}if(o.push(e[c][d]),d++,--c>=l||c<0||d>=l||d<0){n=this._check(o,a);break}}r+=r?n>0?1+n:0:n>0?2+n:0,t>i?(c=t-i,d=0):(c=0,d=i-t),o=[];for(p=0;p<l;p++){if(!e[c]){n=this._check(o,a);break}if(o.push(e[c][d]),d++,++c>=l||c<0||d>=l||d<0){n=this._check(o,a);break}}return r+=r?n>0?1+n:0:n>0?2+n:0},t.prototype._check=function(e,t){var i=0,n=null,o=0;for(var a in e)e[a]<12&&null!==e[a]&&n==e[a]&&n==t?++o>=2&&i++:(n=e[a],o=0);return i},t.prototype.computingPower=function(e,t){if(!this.monsterData[e%3])return 0;if(!t)return 0;var i=this.monsterData[e%3].id,n=this.monsterData[e%3].level,o=Math.floor(e/3)+1,a=t-2;return this.getCarFight(i,n,o)*a},Object.defineProperty(t.prototype,"monsterData",{get:function(){return[{id:parseInt(this.cardOneID.string)>0?parseInt(this.cardOneID.string):1,level:parseInt(this.cardOneLevel.string)>0?parseInt(this.cardOneLevel.string):1},{id:parseInt(this.cardTwoID.string)>1?parseInt(this.cardTwoID.string):2,level:parseInt(this.cardTwoLevel.string)>0?parseInt(this.cardTwoLevel.string):1},{id:parseInt(this.cardThreeID.string)>2?parseInt(this.cardThreeID.string):3,level:parseInt(this.cardThreeLevel.string)>0?parseInt(this.cardThreeLevel.string):1}]},enumerable:!0,configurable:!0}),t.prototype.getCarFight=function(e,t,i,n){return void 0===n&&(n=!0),this.getCardAttr(e,t,i,n).GetFight()},t.prototype.getCardAttr=function(e,t,i,n){void 0===n&&(n=!0),this.staticattr.Reset();var o=new r.EntityProperty;return o.cardid=e,o.grade=i,o.cultivateLv=t,o.selfMonster=n,this.staticattr.PushCard(e,t,i,1,[],[]),n&&(o.attr=this.staticattr),o.attr},t.prototype.gameResult=function(e){this._data=e,this.getMonster(e);var t=e[e.length-1].result;this.setIconShow(t.resultArr),this.again()},t.prototype.getMonster=function(e){for(var t in this.cardOneData2.getComponent(cc.Label).string="",this.cardOneData1.getComponent(cc.Label).string="",this._monterArr=[],e)this._monterArr.push(e[t].result.monsterArr);for(var t in this._monterArr){var i=0,n=0,o=0;for(var a in this._monterArr[t]){i=this._monterArr[t][a].type,n=this._monterArr[t][a].num,o=this._monterArr[t][a].lv;var r={card:h=i%3,type:Math.floor(i/3)+1,num:n,lv:o};switch(this.lvMonster.push(r),i%3){case 0:this.cardData1[Math.floor(i/3)]+=n;break;case 1:this.cardData2[Math.floor(i/3)]+=n;break;case 2:this.cardData3[Math.floor(i/3)]+=n}this._monsterNum+=n,this.oneRollNum+=n}}if(this.moveNum<=0&&(this._rollArr.push(this.oneRollNum),this.oneRollNum=0),this._rollNum<=0&&this.moveNum<=0){var s="";for(t=0;t<this._rollArr.length;t++)s+="roll"+(t+1)+":"+this._rollArr[t]+";\n";var l=this._rollArr,c=Math.max.apply(Math,l),d=Math.min.apply(Math,l),p=function(e,t){return e.reduce(function(e,i){return i===t?e+1:e+0},0)};this.cardOneData1.getComponent(cc.Label).string="\u53611\uff1a\n\u4e00\u9636"+this.cardData1[0]+"\uff0c\n\u4e8c\u9636"+this.cardData1[1]+"\uff0c\n\u4e09\u9636"+this.cardData1[2]+"\uff0c\n\u56db\u9636"+this.cardData1[3]+"\uff0c\n\u4e94\u9636"+this.cardData1[4]+";\n\u53612\uff1a\n\u4e00\u9636"+this.cardData2[0]+"\uff0c\n\u4e8c\u9636"+this.cardData2[1]+"\uff0c\n\u4e09\u9636"+this.cardData2[2]+"\uff0c\n\u56db\u9636"+this.cardData2[3]+"\uff0c\n\u4e94\u9636"+this.cardData2[4]+";\n\u53613\uff1a\n\u4e00\u9636"+this.cardData3[0]+"\uff0c\n\u4e8c\u9636"+this.cardData3[1]+"\uff0c\n\u4e09\u9636"+this.cardData3[2]+"\uff0c\n\u56db\u9636"+this.cardData3[3]+"\uff0c\n\u4e94\u9636"+this.cardData3[4]+";\n\nRoll\u7684\u603b\u6570:"+this._rollCount+";\n\u602a\u7269\u603b\u6570\uff1a"+this._monsterNum+";\n\u6700\u5927:"+c+";"+p(l,c)+"\u6b21;\n\u6700\u5c0f"+d+";"+p(l,d)+"\u6b21;\n"+s,this.lvMonster.sort(function(e,t){return e.card>t.card?1:e.card<t.card?-1:e.type>t.type?1:e.type<t.type?-1:e.lv-t.lv});for(t=0;t<this.lvMonster.length;t++)if(t<this.lvMonster.length-1&&this.lvMonster[t].type==this.lvMonster[t+1].type&&this.lvMonster[t].lv==this.lvMonster[t+1].lv)this.lvMonster[t].num+=this.lvMonster[t+1].num,this.lvMonster.splice(t+1,1),t--;else{i=this.lvMonster[t].type,n=this.lvMonster[t].num,o=this.lvMonster[t].lv;var h=this.lvMonster[t].card;this.cardOneData2.getComponent(cc.Label).string+="\u5361"+(h+1)+":"+i+"\u9636:lv"+o+":"+n+"\u53ea;\n"}}},t.instance=null,__decorate([p(cc.Prefab)],t.prototype,"icon",void 0),__decorate([p(cc.Node)],t.prototype,"TouchNode",void 0),__decorate([p(cc.Node)],t.prototype,"mapNode",void 0),__decorate([p(cc.Sprite)],t.prototype,"bg",void 0),__decorate([p(cc.EditBox)],t.prototype,"heightL",void 0),__decorate([p(cc.EditBox)],t.prototype,"widthL",void 0),__decorate([p(cc.EditBox)],t.prototype,"stoneNum",void 0),__decorate([p(cc.EditBox)],t.prototype,"gradeMin",void 0),__decorate([p(cc.EditBox)],t.prototype,"gradeMax",void 0),__decorate([p(cc.EditBox)],t.prototype,"inheritNum",void 0),__decorate([p(cc.EditBox)],t.prototype,"step",void 0),__decorate([p(cc.EditBox)],t.prototype,"rollNum",void 0),__decorate([p(cc.Label)],t.prototype,"stepLabel",void 0),__decorate([p(cc.Label)],t.prototype,"rollLabel",void 0),__decorate([p(cc.EditBox)],t.prototype,"cardOneID",void 0),__decorate([p(cc.EditBox)],t.prototype,"cardTwoID",void 0),__decorate([p(cc.EditBox)],t.prototype,"cardThreeID",void 0),__decorate([p(cc.EditBox)],t.prototype,"cardOneLevel",void 0),__decorate([p(cc.EditBox)],t.prototype,"cardTwoLevel",void 0),__decorate([p(cc.EditBox)],t.prototype,"cardThreeLevel",void 0),__decorate([p(cc.EditBox)],t.prototype,"shapanText",void 0),__decorate([p(cc.Node)],t.prototype,"cardOneData1",void 0),__decorate([p(cc.Node)],t.prototype,"cardOneData2",void 0),t=i=__decorate([d],t)}(cc.Component);i.default=h,cc._RF.pop()},{"../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Util/Utils":"Utils","../../Fight/staticattr":"staticattr","../../Scene/Prop/EntityProperty":"EntityProperty","../SandTableBackstage":"SandTableBackstage","./simulator_SandTableBackstage":"simulator_SandTableBackstage"}],skillfunc:[function(e,t,i){"use strict";cc._RF.push(t,"45be3vN4NZFdZm2+W5pGUUd","skillfunc"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("./fightlogic"),o=e("../../Global/GlobalValue"),a=e("./calculator"),r=e("../Scene/Controller/FightController"),s=e("./resultfunc"),l=e("../Scene/View/ActorsLayer"),c=e("../Scene/Controller/SkillController"),d=e("./staticattr"),p=e("../../Core/Const/EntityType"),h=e("../Scene/Manager/SceneManager"),u=e("../Scene/Effect/BuffTypeEffectUtils"),f=e("../Scene/Unit/FightLog"),g=e("../Scene/Controller/ServerFightController"),y=e("../Scene/Unit/FightConst"),m=e("../WarTeam/MonsterController"),C=e("../Scene/Controller/ZFController"),v=(e("../Role/RoleInfo"),e("../Scene/Controller/GuideFightController")),_=e("../Equip/equip/EquipCtrl"),b=e("../Scene/View/FightView");function T(e,t,i,r,s,d){if(void 0===d&&(d=1),t.IsDie())return h.default.instance.handledie[t.handle]?h.default.instance.handledie[t.handle]+=1:h.default.instance.handledie[t.handle]=1,void(h.default.instance.handledie[t.handle]>10&&console.log("\u8001\u5144\u6709\u95ee\u9898",t.handle));var y=t.NewResultInfo(),m=C.default.instance,b=e.attr.GetAttrVale(o.AttrType.Hit),T=e.attr.GetAttrVale(o.AttrType.Hit_Imbue)/1e4,D=e.attr.GetAttrVale(o.AttrType.Dodge_Imbue)/1e4,R=t.attr.GetAttrVale(o.AttrType.Dodge),A=Math.min((b+1e4)/(R+1e4)*.9+e.attr.GetBuffValue(o.BuffType.Hit)+T-(t.attr.GetBuffValue(o.BuffType.Dodge)+D),1),N=g.default.instance.Random();if(N>=A)return y.state|=n.StateBit.Dodge,[y];var L,E=e.attr.GetAttrVale(o.AttrType.Critical),B=e.attr.GetAttrVale(o.AttrType.Critical_Imbue)/1e4,M=e.attr.GetAttrVale(o.AttrType.DefCri_Imbue)/1e4,x=t.attr.GetAttrVale(o.AttrType.DefCri),k=Math.min(Math.max((E+1e4)/(x+1e4)*.12+e.attr.GetBuffValue(o.BuffType.Critical)+B-(t.attr.GetBuffValue(o.BuffType.DefCri)+M),.05),1),P=1,G={damageprecent:0,sputteringprecent:0,sputteringentitys:[],reboundprecent:[],reboundentitys:[],suckblood:0,addcriticalp:0,dodge:!1,spcialstateentity:[],addattackp:0,buffId:[],addbuffentitys:[],dieresultAddHp:[],deiresultDelHp:[],addshieldtar:[],addshieldmax:[],damage:-1,skillharmprecent:[],skillharmentitys:[],damageChangeHpPrence:[]};w(e,t,r,s,o.PassivityType.Strike,G),w(e,t,r,s,o.PassivityType.Injuried,G),w(e,t,r,s,o.PassivityType.HpChange,G),k+G.addcriticalp+m.getattr(e.camp,o.AttrType.ZF_Crit_P)+e.attr.GetAttrVale(o.AttrType.Crit_P)>N&&(P=1.5+e.attr.GetAttrVale(o.AttrType.Critical_Harm_P)-t.attr.GetAttrVale(o.AttrType.Critical_Harm_Down_P),w(e,t,r,s,o.PassivityType.Critical,G),L|=n.StateBit.Critical);var F=c.default.instance.GetResultConfParam(i.param,s,t.prop.hp),W=0,U=0;e.prop.grade<=3&&t.prop.grade>=4&&(W=.05*Math.abs(t.prop.grade-e.prop.grade)),5==e.prop.grade&&t.prop.grade<=3&&(U=.05*(Math.abs(e.prop.grade-t.prop.grade)-1));var O=1+e.attr.buff.GetBuffValue(o.BuffType.Attack_P)+(e.attr.GetAttrVale(o.AttrType.MS_Attack_P)-(e.data[o.AttrType.MS_Attack_P]||0))+G.addattackp+U,V=1+t.attr.buff.GetBuffValue(o.BuffType.Defence_P)+(t.attr.GetAttrVale(o.AttrType.MS_Defence_P)-(t.data[o.AttrType.MS_Defence_P]||0))+W;e.data[o.AttrType.MS_Attack_P]=0,t.data[o.AttrType.MS_Defence_P]=0;var q=Math.ceil(Math.max(Math.min(e.attr.GetAttrVale(o.AttrType.Attack)*O+e.attr.buff.GetBuffValue(o.BuffType.Attack),2*e.attr.GetAttrVale(o.AttrType.Attack)),1)),H=q*q/(q+Math.ceil(Math.max(Math.min(t.attr.GetAttrVale(o.AttrType.Defence)*V+t.attr.buff.GetBuffValue(o.BuffType.Defence),2*t.attr.GetAttrVale(o.AttrType.Defence)),1)));H=Math.max(1,H),-1!=G.damage&&(H=G.damage);var j=0;if(j=a.CalcElemRate(e.attr.attr_,t.attr.attr_),t.prop.otherAttr==o.OtherAttr.CradTypebuffe&&e.prop.type==p.EntityType.enMonster&&t.prop.type==p.EntityType.enMonster&&(j+=a.CalcCardtype(e.prop.CardType,t.prop.CardType)),!(t.prop.otherAttr==o.OtherAttr.MaxHpchange&&t.attr.hp/t.attr.GetMaxHp()<.9)){t.prop.otherAttr==o.OtherAttr.ExtraBuffuerhurt&&(t.attr.buff.IsHasBuffByType(o.BuffType.Poison)||t.attr.buff.IsHasBuffByType(o.BuffType.Fire)||t.attr.buff.IsHasBuffByType(o.BuffType.Bleed))&&(j+=.3);var K=0,Y=_.default.instance.data.getEquipEffectAddAttr(e.prop.cardid);e.prop.selfMonster&&(K=Y[o.AttrType.CardHurtRate]?Y[o.AttrType.CardHurtRate]/1e4:0);var z=e.attr.GetBuffValue(o.BuffType.DamageInc)+e.attr.GetVale(o.AttrType.Harm_P)+m.getattr(e.camp,o.AttrType.ZF_Harm_P)+j+K,X=0;e.prop.selfMonster&&(X=Y[o.AttrType.CardPassiveHurtRate]/1e4||0);var J=Math.abs(t.attr.GetVale(o.AttrType.Harm_Down_P))+Math.abs(m.getattr(t.camp,o.AttrType.ZF_Harm_Down_P))+Math.abs(t.attr.GetBuffValue(o.BuffType.BeDamageDec))+X,Q=i.extradamage?i.extradamage:0;if(e.prop.selfMonster&&(Q+=Y[o.AttrType.ExtraHurt]||0),H=Math.ceil(H*P*(1+z-J)*(F[0]*d/1e4))+Q,G.damage=H,a.CalcFiveLineAttributes(e.prop.monsterConf.fiveLineAttributes,t.prop.monsterConf.fiveLineAttributes)&&w(e,t,r,s,o.PassivityType.Restrain,G),S(e,t,r,s,G),0!=G.damageprecent&&(f.default.log("\u4f24\u5bb3\u767e\u5206\u6bd4\u5c5e\u6027"+G.damageprecent),H=Math.ceil(H+G.damageprecent*H)),0!=e.attr.GetVale(o.AttrType.MS_Harm_P)&&(f.default.log("\u7d2f\u52a0\u4f24\u5bb3\u767e\u5206\u6bd4\u5c5e\u6027"+e.attr.GetVale(o.AttrType.MS_Harm_P)),H=Math.ceil(H+e.attr.GetVale(o.AttrType.MS_Harm_P)*H)),f.default.log("\u6280\u80fd\u52a0\u6210\u6700\u7ec8\u4f24\u5bb3"+H),t.attr.hp+t.attr.shield-H<=0&&(w(e,t,r,s,o.PassivityType.FinalHit,G),w(e,t,r,s,o.PassivityType.Die,G)),0==i.type&&t.prop.type==p.EntityType.enMonster&&v.default.instance.iscomplete)switch(F[1]){case 1:if(N<=i.rate/100){var Z=l.default.instance.getSceneEntity(e.handle);t.attr.buff.IsHasBuffByType(o.BuffType.ResistFly)?u.default.instance.addOneEffect(Z,o.BuffEffectName.MIANYIJIFEI):t.attr.buff.IsHasBuffByType(o.BuffType.SuperArmor)?u.default.instance.addOneEffect(Z,o.BuffEffectName.MIANYIJIFEI):(L|=n.StateBit.Fly,t.BreakSingSkill())}break;case 2:if(N<=i.rate/100){Z=l.default.instance.getSceneEntity(e.handle);t.attr.buff.IsHasBuffByType(o.BuffType.SuperArmor)?u.default.instance.addOneEffect(Z,o.BuffEffectName.MIANYIJIFEI):(L|=n.StateBit.Back,t.BreakSingSkill())}break;case 4:t.attr.shield>0&&(H+=t.attr.shield,f.default.log("\u6d88\u9664\u62a4\u76fe",t.prop.originalName));break;case 5:H+=F[2];break;case 6:if(N<=i.rate/100){Z=l.default.instance.getSceneEntity(e.handle);t.attr.buff.IsHasBuffByType(o.BuffType.ResistFly)?u.default.instance.addOneEffect(Z,o.BuffEffectName.MIANYIJIFEI):t.attr.buff.IsHasBuffByType(o.BuffType.SuperArmor)?u.default.instance.addOneEffect(Z,o.BuffEffectName.MIANYIJIFEI):(L|=n.StateBit.FlyBack,t.BreakSingSkill())}break;case 7:if(N<=i.rate/100&&t.prop.grade<=e.prop.grade){Z=l.default.instance.getSceneEntity(e.handle);t.attr.buff.IsHasBuffByType(o.BuffType.ResistFly)?u.default.instance.addOneEffect(Z,o.BuffEffectName.MIANYIJIFEI):t.attr.buff.IsHasBuffByType(o.BuffType.SuperArmor)?u.default.instance.addOneEffect(Z,o.BuffEffectName.MIANYIJIFEI):(L|=n.StateBit.FlyBack,t.BreakSingSkill())}break;case 8:H+=Math.ceil(F[2]*t.prop.hp)+F[3]}var $=[],ee=[];G.damageChangeHpPrence.length&&H>=G.damageChangeHpPrence[0]*t.attr.GetMaxHp()&&(f.default.log("\u53d7\u5230\u4f24\u5bb3\u8d85\u8fc7\u81ea\u8eab\u603b\u8840\u91cfx % \u65f6, \u672c\u6b21\u4f24\u5bb3\u7b49\u4e8ex %",G.damageChangeHpPrence),H=Math.ceil(t.attr.GetMaxHp()*G.damageChangeHpPrence[1])),ee=ee.concat(I(G,y,e,t,L,H));var te=t.attr.buff.IsHasBuffByType(o.BuffType.DelDamage);if(te){var ie=Math.ceil(te.value*H);t.ChangeHp(ie,6),H-=ie}var ne=c.default.instance.getSkillBySkillId(r),oe=e.attr.buff.IsHasBuffByType(o.BuffType.DelDamage);if(oe&&ne.trigger==o.TRIGGER_WAY.COMMON){var ae=e.fight.GetRangeEnemy(t,250,1);ee=ee.concat(ae[0].CheakSheidHp(H*oe.value)),f.default.log("\u6e85\u5c04buff ++ ",ae[0].prop.handle,H,H*oe.value)}var re=e.attr.buff.IsHasBuffByType(o.BuffType.Vow);return re&&t.attr.hp/t.attr.GetMaxHp()<.5&&N<re.value&&!t.prop.isBoss&&(H=t.attr.hp+t.attr.shield,f.default.log("\u89e6\u53d1\u8bb8\u613f\u672f\u65a9\u6740",t.prop.originalName)),H>0&&(ee=t.CheakSheidHp(H,L).concat(ee)),$=$.concat(ee)}t.fight.resCallback(!0)}function S(e,t,i,n,a){var r,s=m.default.instance.getCardConfCardType(e.prop.cardid),l=m.default.instance.getCardConfCardType(t.prop.cardid),d=null;if(s==o.CardType.Back&&l==o.CardType.Front&&e.prop.grade>t.prop.grade){for(var p in e.fight.cardlsit)for(var h=0,u=e.fight.cardlsit[p].prop.skillList;h<u.length;h++){var y=u[h];if(3==(T=c.default.instance.getSkillResultBySkillIdAndLv(y.skillid,y.skilllv)[0]).firstresult){d=c.default.instance.GetResultConfParam(T.param,y.skilllv);break}}if(!d)return;if((w=g.default.instance.Random())<=d[0])for(var C=0,v=e.fight.entity;C<v.length;C++){if((y=v[C]).attr.hp>0&&(r=m.default.instance.getCardConfCardType(y.prop.cardid),e.camp==y.camp&&e.prop.cardid!=y.prop.cardid&&r==o.CardType.Back)){if(a.damageprecent+=d[1],t.attr.buff.AddBuff(d[2],n,e,e.handle)==o.BuffType.Undefined)return;a.addbuffentitys.push(t),a.buffId.push(d[2]),f.default.log("\u540e\u6392\u8054\u5408\uff1a\u573a\u4e0a\u5b58\u6d3b\u5176\u4ed6\u540e\u6392\u5bb6\u65cf\u7684\u53cb\u519b\u65f6\uff0c\u653b\u51fb\u5f62\u6001\u4e0d\u9ad8\u4e8e\u81ea\u8eab\u7684\u524d\u6392\u654c\u4eba\uff0c\u589e\u52a0X%\u7684\u4f24\u5bb3\uff0c\u6709X%\u7684\u6982\u7387\u9020\u6210\u6655\u7729\uff0c\u6301\u7eedX\u79d2");break}}}else if(s!=o.CardType.Centre);else{for(var p in e.fight.cardlsit)for(var _=0,b=e.fight.cardlsit[p].prop.skillList;_<b.length;_++){y=b[_];var T,S=c.default.instance.getSkillResultBySkillIdAndLv(y.skillid,y.skilllv);if(!S)return;2==(T=S[0]).firstresult&&(d=c.default.instance.GetResultConfParam(T.param,y.skilllv))}if(!d)return;var I,w,D=[];if((w=g.default.instance.Random())<=d[0])for(var R=0,A=e.fight.entity;R<A.length;R++){if(!((y=A[R]).attr.hp<=0)&&(I=m.default.instance.getCardConfCardType(y.prop.cardid),e.camp==y.camp&&e.prop.cardid!=y.prop.cardid&&I==o.CardType.Centre)){for(var N=0,L=e.fight.entity;N<L.length;N++){var E=L[N];E.attr.hp<=0||(I=m.default.instance.getCardConfCardType(E.prop.cardid),e.camp!=E.camp&&I==o.CardType.Back&&D.push(E))}if(D.length>0){a.skillharmprecent.push(d[1]),a.skillharmentitys.push(D[Math.floor(w*D.length)]),f.default.log("\u4e2d\u6392\u8054\u5408\u666e\u653b\u9020\u6210\u4f24\u5bb3\u65f6\uff0c\u6709X%\u7684\u6982\u7387\uff0c\u968f\u673a\u5411\u4e00\u540d\u540e\u6392\u654c\u4eba\u9020\u6210\u672c\u6b21\u4f24\u5bb3\u7684X%",a.sputteringentitys.length,a.sputteringprecent);break}}}}}function I(e,t,i,a,r,s){var l=[];if(e.dodge)return t.state|=n.StateBit.Dodge,[t];if(e.spcialstateentity){for(var c=0;c<e.spcialstateentity.length;c++)if(!e.spcialstateentity[c][1].attr.buff.IsHasBuffByType(o.BuffType.SuperArmor)){switch(t=e.spcialstateentity[c][1].NewResultInfo(),e.spcialstateentity[c][0]){case 1:t.state|=n.StateBit.Fly;break;case 2:t.state|=n.StateBit.Back;break;case 6:t.state|=n.StateBit.FlyBack}e.spcialstateentity[c][1].BreakSingSkill(),l.push(t)}n.StateBit.Fly,a.BreakSingSkill()}if(e.sputteringentitys.length>0)for(c=0;c<e.sputteringentitys.length;c++){var d=e.sputteringentitys[c].CheakSheidHp(Math.ceil(s*e.sputteringprecent));l=l.concat(d)}if(e.skillharmentitys.length>0)for(c=0;c<e.skillharmentitys.length;c++){d=e.skillharmentitys[c].CheakSheidHp(Math.ceil(s*e.skillharmprecent[c]));l=l.concat(d)}if(e.reboundentitys.length>0)for(c=0;c<e.reboundentitys.length;c++){var p=Math.min(Math.ceil(s*e.reboundprecent[c]),e.reboundentitys[c].attr.GetMaxHp()*e.reboundprecent[c]);l=l.concat(e.reboundentitys[c].CheakSheidHp(p))}if(e.suckblood){p=Math.ceil(s*e.suckblood);i.ChangeHp(p,10),(t=i.NewResultInfo()).type="hp",t.data.hpChange=p,t.state|=n.StateBit.Rescure,l.push(t)}if(e.dieresultAddHp)for(var h=0,u=e.dieresultAddHp;h<u.length;h++){var f=u[h];p=Math.ceil(f[1]);f[0].ChangeHp(p),(t=f[0].NewResultInfo()).type="hp",t.data.hpChange=p,t.state|=n.StateBit.Rescure,l.push(t)}if(e.deiresultDelHp)for(var g=0,m=e.deiresultDelHp;g<m.length;g++){f=m[g],p=Math.ceil(f[1]);l=l.concat(f[0].CheakSheidHp(p))}if(e.addbuffentitys.length>0)for(c=0;c<e.addbuffentitys.length;c++){var C=e.addbuffentitys[c].NewResultInfo();C.type="addbuff",C.data.buffId=e.buffId[c],l.push(C)}if(e.addshieldtar.length>0)for(c=0;c<e.addshieldtar.length;c++){var v=e.addshieldtar[c].NewResultInfo(),_=e.addshieldtar[c].attr.shield+s,b=Math.ceil(e.addshieldtar[c].attr.GetMaxHp()*e.addshieldmax[c]),T=Math.min(_,b);e.addshieldtar[c].attr.SetShield(T),v.shield=T,v.type=y.SKILL_RESULT_IDE.ADDSHIELD,v.state|=n.StateBit.Shield,l.push(v)}return l}function w(e,t,i,n,a,r){if(e.prop.type!=p.EntityType.enActor&&t.prop.type!=p.EntityType.enActor){var d=[];a==o.PassivityType.FinalHit||a==o.PassivityType.Strike?d.push(e.handle):a==o.PassivityType.Die||a==o.PassivityType.Injuried?d.push(t.handle):(d.push(e.handle),d.push(t.handle));for(var h=0;h<d.length;h++){var u=l.default.instance.entities[d[h]];if(u&&!u.prop.copyEntity&&u.prop.skillList)for(var f=0;f<u.prop.skillList.length;f++){var g=u.prop.skillList[f],y=c.default.instance.getSkillResultBySkillIdAndLv(g.skillid,g.skilllv),m=c.default.instance.getSkillBySkillId(g.skillid);if(m.passivity&&m.passivity==a)for(var C=0,v=y;C<v.length;C++){var _=v[C];s.ResultFunc[m.passivity](e,t,_,i,n,g.skillid,g.skilllv,r,e.handle==u.prop.handle)}}}}}i.SkillFunc=[],i.SkillFunc[0]=T,i.SkillFunc[1]=function(e,t,i,o,a){if(t.IsDie())return;var r,s=e.attr.GetAttack(),l=t.attr.GetAttack(),d=c.default.instance.GetResultConfParam(i.param,a);1==d[0]?r=Math.ceil(s*(d[1]||0)/1e4+l*(d[1]||0)/1e4):2==d[0]?r=Math.ceil(d[1]*t.attr.GetMaxHp()):3==d[0]&&(r=(t.attr.GetMaxHp()-t.attr.hp)*d[1]);r=Math.ceil(r),t.ChangeHp(r,12);var p=t.NewResultInfo();return p.type="hp",p.data.hpChange=r,p.state|=n.StateBit.Rescure,[p]},i.SkillFunc[2]=function(e,t,i,o,a){if(!t.IsDie())return;var r=e.attr.GetAttack(),s=t.attr.GetAttack(),l=c.default.instance.GetResultConfParam(i.param,a),d=Math.ceil(r*(l[0]||0)/1e4+s*(l[0]||0)/1e4);t.ChangeHp(d,11);var p=t.NewResultInfo();return p.type="hp",p.data.hpChange=d,p.state|=n.StateBit.Relive,[p]},i.SkillFunc[3]=function(e,t,i,a,r){var s=c.default.instance.GetResultConfParam(i.param,r);if(g.default.instance.Random()<=s[0]){var l=t.attr.buff.AddBuff(s[1],r,e,e.handle);if(l==o.BuffType.Undefined)return;var d=t.NewResultInfo();return d.type=y.SKILL_RESULT_IDE.ADDBUFF,d.data.buffId=s[1],l==o.BuffType.Shield&&(d.state=n.StateBit.Shield),[d]}return},i.SkillFunc[4]=function(e,t,i,n,a){var s=t.prop,p=[],h=new d.StaticAttr,u=c.default.instance.GetResultConfParam(i.param,a);h.PushCard(s.cardid,s.cultivateLv,s.grade,u[0]);for(var f=!0,g=0;g<u[4];g++){if(u[6]){var y=e.attr.buff.AddBuffOne(u[6],a,e,e.handle);p.push(y)}var m=0,C=0,v=l.default.instance.getSceneEntity(t.prop.handle),_=o.ACTION.STAND;11==e.prop.cardid?(m=g%2==0?-1:1,m=t.prop.x+Math.max(g-g%2,1)*m*v.width/2,C=t.prop.y,f=!1):2==e.prop.cardid&&(C=g%2==0?-1:1,m=t.prop.x-v.width*t.prop.dir,C=t.prop.y+Math.max(g-g%2,0)*C*v.height/4);var b={cardid:s.cardid,grade:Math.max(s.grade+u[1],1),level:Math.max(s.cultivateLv+u[2],1),num:1,self:e.prop.selfMonster,x:m,y:C,attr:h,autoUseSkill:!1,skills:e.prop.skillList};r.default.instance.fightingAddActor(b,o.ADD_ACTOR_TYPE.NONE,u[3]*h.GetMaxHp(),u[5],f,_)}var T=t.NewResultInfo();return T.type="duplicate",p.unshift(p),[T]},i.SkillFunc[5]=function(e,t,i,n,o){var a=t.NewResultInfo();return a.type="removedebuff",t.attr.buff.ClearOneDelBuff(),[a]},i.SkillFunc[6]=function(e,t,i){if(t.IsDie())return;if(t.attr.buff.IsHasBuffByType(o.BuffType.SuperArmor))return;var a=t.NewResultInfo();return a.state|=n.StateBit.Drap,t.BreakSingSkill(),[a]},i.SkillFunc[7]=function(e,t,i,o,a){if(t.IsDie())return;var r=[],s=t.NewResultInfo();s.state|=n.StateBit.Impact,r.push(s);var l=T(e,t,i,o,a);l&&(r=r.concat(l));for(var d=c.default.instance.GetResultConfParam(i.param,a),p=0,h=t.fight.GetRangeEnemy(t,d[2],d[3]);p<h.length;p++){var u=h[p];r.push(u.attr.buff.AddBuffOne(d[1],1,e,e.handle));var f=T(e,u,i,o,a);f&&(r=r.concat(f))}return r},i.SkillFunc[8]=function(e,t,i,n,o){return e.AddSkillInfo(n,o,t)},i.SkillFunc[9]=function(e,t,i,o,a){var r=[],s=c.default.instance.GetResultConfParam(i.param,a),l=!0;s[4]&&(l=1==s[4]);var d=t.fight.GetRangeEnemy(t,s[1],s[2],!0,l),p=T(e,t,i,o,a),h=t.NewResultInfo();switch(s[5]){case 1:h.state|=n.StateBit.Fly;break;case 2:h.state|=n.StateBit.Back;break;case 3:h=t.attr.buff.AddBuffOne(s[6],a,e,e.handle);break;case 4:h.state|=n.StateBit.FlyBack;break;case 5:(h=t.attr.buff.AddBuffOne(s[6],a,e,e.handle)).state|=n.StateBit.Back}r=r.concat(h),p&&(r=r.concat(p));for(var u=0,f=d;u<f.length;u++){var g=f[u],y=g.NewResultInfo(),m=T(e,g,i,o,a,s[3]);switch(s[5]){case 1:y.state|=n.StateBit.Fly;break;case 2:y.state|=n.StateBit.Back;break;case 3:y=g.attr.buff.AddBuffOne(s[6],a,e,e.handle);break;case 4:y.state|=n.StateBit.FlyBack;break;case 5:(y=g.attr.buff.AddBuffOne(s[6],a,e,e.handle)).state|=n.StateBit.Back}m.unshift(y),r=r.concat(m)}return r},i.SkillFunc[10]=function(e,t,i,o,a){var r=[],s=c.default.instance.GetResultConfParam(i.param,a),l=t.NewResultInfo();return t.attr.SetShield(e.attr.GetMaxHp()*s[0]),l.shield=t.attr.shield,l.type=y.SKILL_RESULT_IDE.ADDSHIELD,l.state|=n.StateBit.Shield,r.unshift(l),r},i.SkillFunc[11]=function(e,t,i,n,a){var s=t.prop,l=new d.StaticAttr,p=c.default.instance.GetResultConfParam(i.param,a),h=[];l.PushCard(s.cardid,s.cultivateLv,s.grade),l.ChangeAtt(o.AttrType.MaxHp,l.GetVale(o.AttrType.MaxHp)*p[0]),l.ChangeAtt(o.AttrType.Defence,l.GetVale(o.AttrType.Defence)*p[1]);for(var u=c.default.instance.getSkills(e.prop,e.prop.cultivateLv,!1),f=0,y=0;y<p[2];y++){for(var m=e.prop.handle+Math.ceil(100*g.default.instance.Random())+b.default.instance.loopIntervalCount;e.fight.getFightEntityByHandle(m);)m+=1e4,console.warn("\u6dfb\u52a0\u5b9e\u4f53handle \u76f8\u540c\u52a010000"+m);var C={cardid:e.prop.cardid,grade:s.grade,level:s.cultivateLv,num:1,self:e.prop.selfMonster,x:t.prop.x+f,attr:l,autoUseSkill:!1,skills:u,handle:m};if(f+=50,r.default.instance.fightingAddActor(C,o.ADD_ACTOR_TYPE.DEADMAN,null,p[3],!0),p[4]){var v=e.fight.getFightEntityByHandle(m);v&&h.push(v.attr.buff.AddBuffOne(p[4],a,e,e.handle))}}var _=t.NewResultInfo();return _.type="summon",h.unshift(_),h},i.SkillFunc[12]=T,i.SkillFunc[13]=function(e,t,i,n,o){return void C.default.instance.addNode(e.camp,i,o)},i.SkillFunc[14]=function(e,t,i,n,o){var a=[];return e.fight.GetCampCopyEnemy(e,!1).forEach(function(e){var t=e.NewResultInfo();t.type=y.SKILL_RESULT_IDE.REMOVEHANDLE,e.CheakSheidHp(e.attr.hp+e.attr.shield),t.data.handle=e.prop.handle,a.push(t)}),a},i.SkillFunc[15]=function(e,t,i,a,r){var s=c.default.instance.GetResultConfParam(i.param,r),l=t.attr.buff.AddBuff(s[4],r,e,e.handle);if(l==o.BuffType.Undefined)return;var d=t.NewResultInfo();d.type=y.SKILL_RESULT_IDE.ADDBUFF,d.data.buffId=s[4],l==o.BuffType.Shield&&(d.state=n.StateBit.Shield);return t.attr.buff.ClearConduceDelBuff(1),[d]},cc._RF.pop()},{"../../Core/Const/EntityType":"EntityType","../../Global/GlobalValue":"GlobalValue","../Equip/equip/EquipCtrl":"EquipCtrl","../Role/RoleInfo":"RoleInfo","../Scene/Controller/FightController":"FightController","../Scene/Controller/GuideFightController":"GuideFightController","../Scene/Controller/ServerFightController":"ServerFightController","../Scene/Controller/SkillController":"SkillController","../Scene/Controller/ZFController":"ZFController","../Scene/Effect/BuffTypeEffectUtils":"BuffTypeEffectUtils","../Scene/Manager/SceneManager":"SceneManager","../Scene/Unit/FightConst":"FightConst","../Scene/Unit/FightLog":"FightLog","../Scene/View/ActorsLayer":"ActorsLayer","../Scene/View/FightView":"FightView","../WarTeam/MonsterController":"MonsterController","./calculator":"calculator","./fightlogic":"fightlogic","./resultfunc":"resultfunc","./staticattr":"staticattr"}],staticattr:[function(e,t,i){"use strict";cc._RF.push(t,"a94b0roDJ5LPJphuZ2vjUVK","staticattr"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Global/GlobalValue"),o=e("../../Core/ConfigsManager"),a=e("../../Util/Utils"),r=function(){function e(){this.ratio=1e4,this.attr_={},this.skills=[],this.changed=!1,this.fight=0,this._maxfight=-1,this.level=0,this.type=0,this.element=0}return e.prototype.Reset=function(){this.attr_={},this.changed=!0},e.prototype.Push=function(e,t){e<n.AttrType.MaxHp_P&&(t=Math.floor(t));var i=this.attr_[e]||0,o=i+t;o<0&&(o=0),i!=o&&(this.attr_[e]=o,this.OnChangeAttr(e,i,o),this.changed=!0)},e.prototype.ChangeAtt=function(e,t){e<n.AttrType.MaxHp_P&&(t=Math.floor(t));var i=this.attr_[e]||0;i!=t&&(this.attr_[e]=t,this.OnChangeAttr(e,i,t),this.changed=!0)},e.prototype.PushAttr=function(e){for(var t in e.attr_){var i=e.attr_[t];i&&this.Push(parseInt(t),i)}this.element=e.element,this.level=e.level,this.type=e.type},e.prototype.PushCard=function(e,t,i,n,r,s){void 0===n&&(n=1),void 0===r&&(r=[]),void 0===s&&(s=[]);var l,c=o.ConfigsManager.instance.getConfigs("cardConf");if(!c||!c.Card)return console.warn("\u5361\u724c\u914d\u7f6e\u8868\u672a\u52a0\u8f7d\u6210\u529f"),null;if(!c.Card[e])return console.warn("\u4e0d\u5b58\u5728\u5361\u724cId\u4e3a"+e+"\u7684\u5361\u724c"),null;if(l=c.Card[e]){if(s.length<=0){var d=c.Card[e].grade,p=c.grade[d][i-1];if(!p)return void console.error("attr push card error grade not exist ",e,i,t);if(e>=9e4){var h=o.ConfigsManager.instance.getConfigs("cardConf").level[p.level][Math.max(0,Math.floor(t/10)-1)];if(!h)return void console.error("attr push card error level not exist ",e,i,t);s=h.prop}else s=a.default.getCardBaseAttr(e,t)}for(var u=0;u<s.length;u++){var f=s[u];this.Push(u,Math.ceil(f*n))}this.skills=r,this.level=t,this.type=l.cardType,this.element=l.fiveLineAttributes}else console.error("attr push card error id not exist ",e,i,t)},e.prototype.GetFight=function(){return this.changed&&(this.fight=this.CalCurrentFight(this.hp),this.changed=!1),this.fight},e.prototype.GetCurrentFight=function(e){return this.CalCurrentFight(e)},e.prototype.GetAttrVale=function(e){return e<1e3?e>=7&&e<=16?Math.ceil(this.GetVale(e)):this.GetVale(e)*(1+this.GetVale(1100+e)+this.GetVale(1200+e)):this.GetVale(e)},e.prototype.GetVale=function(e){return this.attr_[e]||0},e.prototype.GetHit=function(){return this.GetAttrVale(n.AttrType.Hit)},e.prototype.GetDodge=function(){return this.GetAttrVale(n.AttrType.Dodge)},e.prototype.GetCritical=function(){return this.GetAttrVale(n.AttrType.Critical)},e.prototype.GetDefCri=function(){return this.GetAttrVale(n.AttrType.DefCri)},e.prototype.GetMaxHp=function(){return this.GetAttrVale(n.AttrType.MaxHp)},e.prototype.GetAttack=function(){return this.GetAttrVale(n.AttrType.Attack)},e.prototype.GetDefence=function(){return this.GetAttrVale(n.AttrType.Defence)},e.prototype.GetBuffValue=function(e){return 0},e.prototype.setSkills=function(e){for(var t in this.skills=[],e)this.skills.push({skillid:e[t].skillid,skilllv:e[t].skilllv})},e.prototype.OnChangeAttr=function(e,t,i){},Object.defineProperty(e.prototype,"hp",{get:function(){return this.attr_[n.AttrType.MaxHp]||0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shield",{get:function(){return this.attr_[n.AttrType.Shield]||0},enumerable:!0,configurable:!0}),e.prototype.CalCurrentFight=function(e){return Math.ceil(this.maxfight*e/this.GetVale(n.AttrType.MaxHp))},e.prototype.TempCalCurrentFight=function(e,t){var i={};for(var o in this.attr_)i[o]=e[o]?t?this.attr_[o]-e[o]:this.attr_[o]+e[o]:this.attr_[o];var r=a.default.cptFight(this.type,i,this.skills);return r=Math.ceil(r*this.hp/this.GetVale(n.AttrType.MaxHp))},Object.defineProperty(e.prototype,"maxfight",{get:function(){return(-1==this._maxfight||this.changed)&&(this._maxfight=a.default.cptFight(this.type,this.attr_,this.skills)),this._maxfight},enumerable:!0,configurable:!0}),e}();i.StaticAttr=r,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Global/GlobalValue":"GlobalValue","../../Util/Utils":"Utils"}],vipGiftbagItem:[function(e,t,i){"use strict";cc._RF.push(t,"97bf6RZn9BHL79a7aAMMVpQ","vipGiftbagItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Core/WindowType"),a=e("../../../Util/Utils"),r=e("../../Item/ItemIcon"),s=e("../../Vip/VipCtrl"),l=e("../../../Core/Language"),c=e("../../Role/RoleInfo"),d=e("../../Tips/OpTipsController"),p=e("../../../Core/LoadManager"),h=e("../../../GlobalContext"),u=cc._decorator,f=u.ccclass,g=(u.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._lev=null,t._data=null,t._gold=null,t}return __extends(t,e),t.prototype.setData=function(e){this._lev=e.vipLev,this._data=e.data,this.setShow()},t.prototype.setShow=function(){var e=this;this.node.getChildByName("vip").getChildByName("lev").getComponent(cc.Label).string=this._lev+"";var t=this.node.getChildByName("lsit");p.default.instance.loadResByType(h.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(i){for(var n in a.default.setNodeChildDestoryByUrl(t,h.GlobalContext.Root+"prefab/Bag/ItemIcon"),e._data){var c=a.default.getNodeByPool(o.PoolType.ItemIcon,i,h.GlobalContext.Root+"prefab/Bag/ItemIcon");c.scale=.7*c.scale,c.getComponent(r.default).ItemData(e._data[n],!0,null,!0),t.addChild(c)}var d=s.default.instance.data.getGiftstatus(e._lev),p=d>1?l.default.getStr("\u5df2\u9886\u53d6"):l.default.getStr("\u9886 \u53d6"),u=e.node.getChildByName("btn");u.getChildByName("Label").getComponent(cc.Label).string=p,u.getComponent(cc.Button).interactable=1==d},this)},t.prototype.onClickBtn=function(){this.reqGetvipgiftbag()},t.prototype.reqGetvipgiftbag=function(){c.MyRoleInfo.vipLevel<this._lev?d.default.instance.ShowMsg(l.default.getStr("6005")):s.default.instance.data.getGiftstatus(this._lev)&&s.default.instance.reqVipBuyGiftPack(this._lev)},t=__decorate([f],t)}(n.default));i.default=g,cc._RF.pop()},{"../../../Core/Language":"Language","../../../Core/LoadManager":"LoadManager","../../../Core/Widget":"Widget","../../../Core/WindowType":"WindowType","../../../GlobalContext":"GlobalContext","../../../Util/Utils":"Utils","../../Item/ItemIcon":"ItemIcon","../../Role/RoleInfo":"RoleInfo","../../Tips/OpTipsController":"OpTipsController","../../Vip/VipCtrl":"VipCtrl"}],vipGiftbagView:[function(e,t,i){"use strict";cc._RF.push(t,"4320d7s0KVG+5C7NLdLNAnz","vipGiftbagView"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../Vip/VipCtrl"),a=e("../../../Core/GameEventDispatcher"),r=e("../../../Core/Event"),s=e("./vipGiftbagItem"),l=e("../../Commons/WindowBg2"),c=e("../../../Core/Language"),d=e("../../Commons/ListViewCtrl"),p=e("../welfarelobby"),h=e("../../../Global/GlobalValue"),u=e("../welfarelobbyUtils"),f=cc._decorator,g=f.ccclass,y=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._fun=null,t._funObj=null,t.lsitNode=null,t.lsitViewCtrl=null,t}return __extends(t,e),t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.show=function(){e.prototype.show.call(this),o.default.instance.reqVipInfo(),this.node.getChildByName("tips").active=!1;var t=o.default.instance.data;t.isFrsit=!0,p.default.instance.IsRead(h.WelfareType.VipGift,t.getVipGiftRed()&&!t.isFrsit),u.welfarelobbyUtils.setRed(),this.setShowData(),a.GameEventDispatcher.instance.on(r.EventDefiner.Vip_info_up,this.setShowData,this),a.GameEventDispatcher.instance.on(r.EventDefiner.vipGiftbag_openTips,this.setTips,this)},t.prototype.hide=function(){a.GameEventDispatcher.instance.off(r.EventDefiner.Vip_info_up,this.setShowData,this),a.GameEventDispatcher.instance.off(r.EventDefiner.vipGiftbag_openTips,this.setTips,this),this.node.getChildByName("tips").active=!1,this._fun=null,this._funObj=null,e.prototype.hide.call(this)},t.prototype.setShowData=function(){var e=o.default.instance.data.CfgData;!e||e.length<=0||this.setData(e)},t.prototype.setTips=function(e){var t=e?e.getUserData():null;if(t){var i=this.node.getChildByName("tips").getChildByName("WindowBg2").getComponent(l.default).Container.getChildByName("LabelNode");i.getChildByName("node").getChildByName("gold").getComponent(cc.Label).string="x"+t.gold,i.getChildByName("lev").getComponent(cc.Label).string=c.default.getStr("\u8d2d\u4e70VIP{0}\u793c\u5305",t.lev),this._fun=t.fun,this._funObj=t.funObj,this.node.getChildByName("tips").active=!0}},t.prototype.onClickclose=function(){this.node.getChildByName("tips").active=!1},t.prototype.onClickConfirm=function(){this.node.getChildByName("tips").active=!1,this._fun&&this._fun.call(this._funObj)},t.prototype.setData=function(e){this.lsitViewCtrl.refreshItem=this.updateitem,this.lsitViewCtrl.refreshItemThis=this,this.lsitViewCtrl.initialize(e),this.lsitViewCtrl.scrollToLeft()},t.prototype.updateitem=function(e,t){var i=this.lsitViewCtrl.dataLsit[t];e.getComponent(s.default).setData(i)},__decorate([y(cc.ScrollView)],t.prototype,"lsitNode",void 0),__decorate([y(d.default)],t.prototype,"lsitViewCtrl",void 0),t=__decorate([g],t)}(n.default);i.default=m,cc._RF.pop()},{"../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Language":"Language","../../../Core/Widget":"Widget","../../../Global/GlobalValue":"GlobalValue","../../Commons/ListViewCtrl":"ListViewCtrl","../../Commons/WindowBg2":"WindowBg2","../../Vip/VipCtrl":"VipCtrl","../welfarelobby":"welfarelobby","../welfarelobbyUtils":"welfarelobbyUtils","./vipGiftbagItem":"vipGiftbagItem"}],welfareOnlineRewardCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"894673mzdJNOIuf+pi/nau/","welfareOnlineRewardCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Controller"),o=e("../../../Core/ConfigsManager"),a=e("../../../NetConnect/NetConnet"),r=e("../../../Core/GameEventDispatcher"),s=e("../../../Core/Event"),l=e("../../../Core/TimeController"),c=e("../welfarelobby"),d=e("../../../Global/GlobalValue"),p=e("../welfarelobbyUtils"),h=cc._decorator,u=h.ccclass,f=(h.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.config={},t.serData="",t.redState=!1,t._reward=!1,t}var i;return __extends(t,e),i=t,t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.instance=this;var t=o.ConfigsManager.instance.getConfigs("onlinerewardsconf");t=t.onlinerewardsConf;var n=1;for(var a in t)this.config[n]=t[a],this.config[n].index=n,n++;for(var a in this.len=n-1,t=o.ConfigsManager.instance.getConfigs("welfarelobbyconf").welfarelobby[1])if(t[a].prefabname==d.WelfareType.welfareOnlineReward){this.windowId=t[a].windowid;break}},t.prototype.openTimer=function(){var e=this;this.redTimer||(this.redTimer=l.default.instance.setInterval(function(){e.updateRed()},this,1e4))},t.prototype.clearTImer=function(){l.default.instance.clearInterval(this.redTimer),this.redTimer=null},t.prototype.updateRed=function(){var e=this.getReddot();p.welfarelobbyUtils.isOpenWindow()&&this.redState!=e&&c.default.instance.IsRead(d.WelfareType.welfareOnlineReward,e),this.redState!=e&&(this.redState=e,p.welfarelobbyUtils.setRed())},t.prototype.listNotification=function(){this.addProto("onlinerewardstime",this.onlinerewardstime,this),this.addProto("onlinerewardsflag",this.onlinerewardsflag,this)},t.prototype.onlinerewardstime=function(e){this.onLineTime=e.time,this.historyTime=Date.now()},t.prototype.onlinerewardsflag=function(e){var t=e.flag;this.serData=t,this.serData.length==this.len?(this.clearTImer(),this.onlineShow(!0)):this.openTimer(),this.updateRed(),r.GameEventDispatcher.instance.emit(s.EventDefiner.welfareOnlineRewardUpdate)},t.prototype.reverse=function(e){return e.split("").reverse().join("")},t.prototype.totemfbresetReq=function(e){var t={cmd:"getonlinerewards",timelv:e};a.default.instance.sendProto(t)},t.prototype.getOverTime=function(e){return this.config[e].time-(Date.now()-this.historyTime+this.onLineTime)},t.prototype.getReddot=function(){var e=!1;for(var t in this.config)if(!parseInt(this.serData[this.config[t].index-1])&&this.getOverTime(this.config[t].index)<1e3){e=!0;break}return e},t.prototype.onlineShow=function(e){this._reward=e},Object.defineProperty(t.prototype,"onlineRewardShow",{get:function(){return this._reward},enumerable:!0,configurable:!0}),t.instance=null,t=i=__decorate([u],t)}(n.default));i.default=f,cc._RF.pop()},{"../../../Core/ConfigsManager":"ConfigsManager","../../../Core/Controller":"Controller","../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/TimeController":"TimeController","../../../Global/GlobalValue":"GlobalValue","../../../NetConnect/NetConnet":"NetConnet","../welfarelobby":"welfarelobby","../welfarelobbyUtils":"welfarelobbyUtils"}],welfareOnlineRewardItem:[function(e,t,i){"use strict";cc._RF.push(t,"66f05VkJWNPYYJGFRbxT59z","welfareOnlineRewardItem"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Language"),o=e("../../../Core/Widget"),a=e("../../../Core/WindowType"),r=e("../../../Util/NumberUtil"),s=e("./welfareOnlineRewardCtrl"),l=e("../../../Util/DateUtil"),c=e("../../../Util/Utils"),d=e("../../Item/ItemIcon"),p=e("../../Commons/RewardUtils"),h=e("../../Item/ItemData"),u=e("../../../Core/LoadManager"),f=e("../../../GlobalContext"),g=e("../../../Core/TimeController"),y=cc._decorator,m=y.ccclass,C=y.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.btn=null,t.onLineLabel=null,t.onLineTimeLabel=null,t.nowOnLineTimeLabel=null,t.reward=null,t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this);c.default.setImage(this.node,"resources/welfarelobby/bg_fldt6.png"),this.isUpdateRed=!0},t.prototype.initData=function(e){var t,i=this;this.weData=e,this.serWeData(),this.btn.node.active&&(this.time=g.default.instance.setInterval(this.serWeData,this,1e3)),this.node.name=e.index+"",this.onLineLabel.string=n.default.getStr("6506",r.NumberUtil.unitsDigitToText(e.index)),this.onLineTimeLabel.string=n.default.getStr("6504",l.DateUtil.setTimeToChineseHMStr(e.time/1e3,1)),this.reward.childrenCount||u.default.instance.loadResByType(f.GlobalContext.Root+"prefab/Bag/ItemIcon",cc.Prefab,function(n){for(var o in e.reward){var r=e.reward[o];t=c.default.getNodeByPool(a.PoolType.ItemIcon,n,f.GlobalContext.Root+"prefab/Bag/ItemIcon");var s=p.default.instance.getItemId(r.type,r.id,r.count),l=h.default.creatItem(s[0],s[1]);t.getComponent(d.default).ItemData(l,!0,r.count+"",!0),i.reward.addChild(t)}},this)},t.prototype.hide=function(){e.prototype.hide.call(this);for(var t=this.reward.childrenCount-1;t>=0;t--)c.default.setNodeToPool(a.PoolType.ItemIcon,this.reward.children[t]);this.closeTime()},t.prototype.onClickSend=function(){s.default.instance.totemfbresetReq(this.weData.index)},t.prototype.closeTime=function(){g.default.instance.clearInterval(this.time),this.time=null},t.prototype.serWeData=function(){if(!!parseInt(s.default.instance.serData[this.weData.index-1]))this.btn.node.active=this.nowOnLineTimeLabel.node.active=!1,this.closeTime();else{this.btn.node.active=!0;var e=s.default.instance.getOverTime(this.weData.index),t=void 0;this.nowOnLineTimeLabel.node.active=e>1e3,e>1e3?(t="6503",this.btn.interactable=!1,this.nowOnLineTimeLabel.string=n.default.getStr("6505",l.DateUtil.timeSecondsToChineseHour(e))):(e>0&&this.isUpdateRed&&(s.default.instance.updateRed(),this.isUpdateRed=!1),this.btn.interactable=!0,t="6502"),this.btn.node.getChildByName("label").getComponent(cc.Label).string=n.default.getStr(t)}},__decorate([C(cc.Button)],t.prototype,"btn",void 0),__decorate([C(cc.Label)],t.prototype,"onLineLabel",void 0),__decorate([C(cc.Label)],t.prototype,"onLineTimeLabel",void 0),__decorate([C(cc.Label)],t.prototype,"nowOnLineTimeLabel",void 0),__decorate([C(cc.Node)],t.prototype,"reward",void 0),t=__decorate([m],t)}(o.default);i.default=v,cc._RF.pop()},{"../../../Core/Language":"Language","../../../Core/LoadManager":"LoadManager","../../../Core/TimeController":"TimeController","../../../Core/Widget":"Widget","../../../Core/WindowType":"WindowType","../../../GlobalContext":"GlobalContext","../../../Util/DateUtil":"DateUtil","../../../Util/NumberUtil":"NumberUtil","../../../Util/Utils":"Utils","../../Commons/RewardUtils":"RewardUtils","../../Item/ItemData":"ItemData","../../Item/ItemIcon":"ItemIcon","./welfareOnlineRewardCtrl":"welfareOnlineRewardCtrl"}],welfareOnlineRewardVo:[function(e,t,i){"use strict";cc._RF.push(t,"9c633qPfZBK2pp+i9pCic0T","welfareOnlineRewardVo"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){return function(e){for(var t in e)this[t]=e[t]}}();i.welfareOnlineRewardVo=n,cc._RF.pop()},{}],welfareOnlineReward:[function(e,t,i){"use strict";cc._RF.push(t,"3107e0vXAVBzqFn/H2QXfor","welfareOnlineReward"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../Core/Widget"),o=e("../../../Core/WindowType"),a=e("./welfareOnlineRewardCtrl"),r=e("../../../Util/Utils"),s=e("./welfareOnlineRewardItem"),l=e("../../../Core/GameEventDispatcher"),c=e("../../../Core/Event"),d=e("../../../GlobalContext"),p=cc._decorator,h=p.ccclass,u=p.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=null,t.item=null,t}return __extends(t,e),t.prototype.show=function(){if(e.prototype.show.call(this),this.content.y=190,l.GameEventDispatcher.instance.on(c.EventDefiner.welfareOnlineRewardUpdate,this.updateData,this),!this.content.childrenCount){var t=void 0,i=a.default.instance.config;for(var n in i)(t=r.default.getNodeByPool(o.PoolType.welfareOnlineRewardItem,this.item,d.GlobalContext.Root+"prefab/OnlineReward/welfareOnlineRewardItem")).getComponent(s.default).initData(i[n]),this.content.addChild(t)}this.updateData(),a.default.instance.updateRed()},t.prototype.hide=function(){e.prototype.hide.call(this),l.GameEventDispatcher.instance.off(c.EventDefiner.welfareOnlineRewardUpdate,this.updateData,this);for(var t=this.content.childrenCount-1;t>=0;t--)r.default.setNodeToPool(o.PoolType.welfareOnlineRewardItem,this.content.children[t])},t.prototype.updateData=function(){var e=a.default.instance.serData;if(!e.length)for(var t=1;t<=this.content.childrenCount;t++)this.content.insertChild(this.content.getChildByName(t+""),t-1);for(t=0;t<e.length;t++)if(parseInt(e[t])){var i=t+1;this.content.insertChild(this.content.getChildByName(i+""),this.content.childrenCount)}},__decorate([u(cc.Node)],t.prototype,"content",void 0),__decorate([u(cc.Prefab)],t.prototype,"item",void 0),t=__decorate([h],t)}(n.default);i.default=f,cc._RF.pop()},{"../../../Core/Event":"Event","../../../Core/GameEventDispatcher":"GameEventDispatcher","../../../Core/Widget":"Widget","../../../Core/WindowType":"WindowType","../../../GlobalContext":"GlobalContext","../../../Util/Utils":"Utils","./welfareOnlineRewardCtrl":"welfareOnlineRewardCtrl","./welfareOnlineRewardItem":"welfareOnlineRewardItem"}],welfarelobbyConst:[function(e,t,i){"use strict";cc._RF.push(t,"0095b2Tjk5IUZMdIyDKsltW","welfarelobbyConst"),Object.defineProperty(i,"__esModule",{value:!0}),function(e){e.welfareOnlineReward="welfareOnlineReward",e.DailySignIn="DailySignIn",e.DailyMeal="DailyMeal",e.InvestmentPlan="InvestmentPlan",e.PrivilegeCard="PrivilegeCard",e.vipGiftbag="vipGiftbag"}(i.welfarelobbyConst||(i.welfarelobbyConst={})),cc._RF.pop()},{}],welfarelobbyUtils:[function(e,t,i){"use strict";cc._RF.push(t,"1daacfVFgNJGZMBxdU6vPmG","welfarelobbyUtils"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../Functionicon/FunctionIconController"),o=e("../../Core/WindowType"),a=e("./dailyMeal/DailyMealCtrl"),r=e("./onlineReward/welfareOnlineRewardCtrl"),s=e("./welfarelobby"),l=e("../../Core/WindowManager"),c=e("./privilegeCard/PrivilegeCardCtrl"),d=e("../DailySignIn/DailySignInController"),p=e("../InvestmentPlan/InvestmentPlanContrl"),h=e("../Vip/VipCtrl"),u=e("../../Core/ConfigsManager"),f=function(){function e(){}return e.setRed=function(){n.default.instance.FuncIconRedDeal(o.WindowType.WelfareLobby,this.getRedState())},e.getRedState=function(){var e=n.default.instance;return!(!r.default.instance.getReddot()||!e.checkIsOpenbyWindowtype(o.WindowType.WelfareLobby_ZX))||(!(!a.default.instance.getReddot()||!e.checkIsOpenbyWindowtype(o.WindowType.WelfareLobby_DC))||(!(!c.default.instance.getReddot()||!e.checkIsOpenbyWindowtype(o.WindowType.WelfareLobby_TQ))||(!(!d.default.instance.CheckIsRed()||!e.checkIsOpenbyWindowtype(o.WindowType.WelfareLobby_QD))||(!(!p.default.instance.FunCheckIsRed()&&!p.default.instance.WelCheckIsRed()||!e.checkIsOpenbyWindowtype(o.WindowType.WelfareLobby_TZ))||!(!h.default.instance.data.getVipGiftRed()||h.default.instance.data.isFrsit||!e.checkIsOpenbyWindowtype(o.WindowType.WelfareLobby_LB))))))},e.isOpenWindow=function(){return s.default.instance&&l.default.instance.isOpenWindow(o.WindowType.WelfareLobby)},Object.defineProperty(e,"GetRewardArray",{get:function(){for(var e=[r.default.instance.getReddot(),d.default.instance.CheckIsRed(),a.default.instance.getReddot(),p.default.instance.FunCheckIsRed()||p.default.instance.WelCheckIsRed(),c.default.instance.getReddot(),h.default.instance.data.getVipGiftRed()&&!h.default.instance.data.isFrsit],t=u.ConfigsManager.instance.getConfigs("welfarelobbyconf"),i=0;i<e.length;i++)n.default.instance.checkIsOpenbyWindowtype(t.welfarelobby[1][i].windowid)||(e.splice(i,1),i--);return e},enumerable:!0,configurable:!0}),e}();i.welfarelobbyUtils=f,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/WindowManager":"WindowManager","../../Core/WindowType":"WindowType","../DailySignIn/DailySignInController":"DailySignInController","../Functionicon/FunctionIconController":"FunctionIconController","../InvestmentPlan/InvestmentPlanContrl":"InvestmentPlanContrl","../Vip/VipCtrl":"VipCtrl","./dailyMeal/DailyMealCtrl":"DailyMealCtrl","./onlineReward/welfareOnlineRewardCtrl":"welfareOnlineRewardCtrl","./privilegeCard/PrivilegeCardCtrl":"PrivilegeCardCtrl","./welfarelobby":"welfarelobby"}],welfarelobby:[function(e,t,i){"use strict";cc._RF.push(t,"1d097uL06dGc7QV38k9PIRN","welfarelobby"),Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../Core/Window"),o=e("../../Core/ConfigsManager"),a=e("../Functionicon/FunctionIconController"),r=e("../../Core/LoadManager"),s=e("../../GlobalContext"),l=e("../../Global/GlobalValue"),c=e("./onlineReward/welfareOnlineRewardCtrl"),d=e("./dailyMeal/DailyMealCtrl"),p=e("../../Core/TimeController"),h=e("./privilegeCard/PrivilegeCardCtrl"),u=e("../DailySignIn/DailySignInController"),f=e("../InvestmentPlan/InvestmentPlanContrl"),g=e("../Functionicon/UtilsFunClick"),y=e("../../Util/Utils"),m=e("./welfarelobbyUtils"),C=e("../Vip/VipCtrl"),v=e("../../Core/WindowType"),_=e("../ActivityView/ActivityCtrl"),b=cc._decorator,T=b.ccclass,S=b.property,I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tabList=null,t.listContainer=null,t.tabBtnItem=null,t.prefabContent=null,t.conf=null,t.nodeList=[],t.tabBtnNames=[],t.selectedIndex=0,t.selectedCallback=null,t.selectedCallbackThisObj=null,t._delaySelectedIndexTime=0,t.isFrist=!0,t.currNodeName=null,t}var i;return __extends(t,e),i=t,t.prototype.show=function(){var t=this;for(var n in e.prototype.show.call(this),i.instance=this,this.conf=o.ConfigsManager.instance.getConfigs("welfarelobbyconf"),this.tabBtnNames=[],this.conf.welfarelobby[1])if(this.conf.welfarelobby[1][n].prefabname!=l.WelfareType.welfareOnlineReward||!c.default.instance.onlineRewardShow){var r=_.default.instance.data.getOpenDay();this.conf.welfarelobby[1][n].windowid==v.WindowType.WelfareLobby_GGB&&r<=7&&a.default.instance.checkIsOpenbyWindowtype(this.conf.welfarelobby[1][n].windowid)?this.tabBtnNames.push(this.conf.welfarelobby[1][n]):a.default.instance.checkIsOpenbyWindowtype(this.conf.welfarelobby[1][n].windowid)&&this.tabBtnNames.push(this.conf.welfarelobby[1][n])}this.addList(),this.selectItem(0);var s=p.default.instance.setTimeout(function(){t.initRed(),p.default.instance.clearTimeout(s)},this,50);this.CurrGetRewardPanel()},t.prototype.initRed=function(){var e,t;for(var i in this.tabBtnNames){switch(e=!1,t=this.tabBtnNames[i].prefabname){case l.WelfareType.welfareOnlineReward:e=c.default.instance.getReddot();break;case l.WelfareType.DailyMeal:e=d.default.instance.getReddot();break;case l.WelfareType.PrivilegeCard:e=h.default.instance.getReddot();break;case l.WelfareType.DailySignIn:e=u.default.instance.CheckIsRed();break;case l.WelfareType.InvestmentPlan:e=f.default.instance.FunCheckIsRed()||f.default.instance.WelCheckIsRed();break;case l.WelfareType.VipGift:e=C.default.instance.data.getVipGiftRed()&&!C.default.instance.data.isFrsit}t&&this.IsRead(t,e)}},t.prototype.hide=function(){e.prototype.hide.call(this),clearTimeout(this._delaySelectedIndexTime),this._delaySelectedIndexTime=0,this.selectItem(0)},t.prototype.addList=function(){if(this.listContainer.removeAllChildren(),this.tabBtnNames.length>0)for(var e=0;e<this.tabBtnNames.length;e++){var t=cc.instantiate(this.tabBtnItem);t.active=!0,this.listContainer.addChild(t),this.tabBtnNames[e].prefabname?t.name=this.tabBtnNames[e].prefabname:t.name="TabBtn"+e;var i=t.getChildByName("TabBtn1").getChildByName("Label").getComponent(cc.Label);i.string=this.tabBtnNames[e].tabBtnName,(i=t.getChildByName("TabBtn2").getChildByName("Label").getComponent(cc.Label)).string=this.tabBtnNames[e].tabBtnName}},t.prototype.itemClick=function(e){if(e.type==cc.Node.EventType.TOUCH_END){var t=e.currentTarget.parent.getSiblingIndex();this.selectItem(t),this.tabBtnNames[this.selectedIndex]&&g.default.instance.onClickWin(this.tabBtnNames[this.selectedIndex].windowid)}},t.prototype.returnIndex=function(e){var t=cc.find(e,this.listContainer);if(t)return t.getSiblingIndex();console.log("\u627e\u4e0d\u5230\u8fd9\u4e2a\u8282\u70b9\u554a\u554a\u554a\u554a\u554a\u554a")},t.prototype.selectItem=function(e){var t=this;this.selectedIndex=e,0==this._delaySelectedIndexTime&&(this._delaySelectedIndexTime=p.default.instance.setTimeout(function(){for(var e=0;e<t.listContainer.childrenCount;e++){var i=t.listContainer.children[e];if(t.selectedIndex==e){i.getChildByName("TabBtn1").active=!0,i.getChildByName("TabBtn2").active=!1,t.currNodeName=t.tabBtnNames[t.selectedIndex].prefabname;var n=t.currNodeName==t.tabBtnNames[t.selectedIndex].prefabname;-1!=t.nodeList.indexOf(t.tabBtnNames[t.selectedIndex].prefabname)?cc.find(t.tabBtnNames[t.selectedIndex].prefabname,t.prefabContent).active=n:r.default.instance.loadResByType(s.GlobalContext.Root+"prefab/welfarelobby/"+t.tabBtnNames[t.selectedIndex].prefabname,cc.Prefab,function(e){var i=y.default.getNodeByUrl(e,s.GlobalContext.Root+"prefab/welfarelobby/"+t.tabBtnNames[t.selectedIndex].prefabname);t.nodeList.push(i.name),t.prefabContent.addChild(i);var n=i.name==t.tabBtnNames[t.selectedIndex].prefabname;cc.find(i.name,t.prefabContent).active=n},t)}else i.getChildByName("TabBtn1").active=!1,i.getChildByName("TabBtn2").active=!0,-1!=t.nodeList.indexOf(t.tabBtnNames[e].prefabname)&&cc.find(t.tabBtnNames[e].prefabname,t.prefabContent)&&(cc.find(t.tabBtnNames[e].prefabname,t.prefabContent).active=!1)}t.selectedCallback&&t.selectedCallback.call(t.selectedCallbackThisObj,t.selectedIndex),p.default.instance.clearTimeout(t._delaySelectedIndexTime),t._delaySelectedIndexTime=0;var o=p.default.instance.setTimeout(function(){t.IsCurrWin(),p.default.instance.clearTimeout(o)},t,500)},this,50))},t.prototype.IsCurrWin=function(){for(var e in this.prefabContent.children)cc.find(this.currNodeName,this.prefabContent)&&cc.find(this.currNodeName,this.prefabContent).name==this.prefabContent.children[e].name?this.prefabContent.children[e].active=!0:this.prefabContent.children[e].active=!1},t.prototype.IsRead=function(e,t){var i=cc.find(e+"/Red",this.listContainer);i&&(i.active=t)},t.prototype.CurrGetRewardPanel=function(){for(var e=m.welfarelobbyUtils.GetRewardArray,t=0;t<e.length;t++)if(e[t])return c.default.instance.onlineRewardShow&&t--,void this.selectItem(t)},t.instance=null,__decorate([S(cc.Node)],t.prototype,"tabList",void 0),__decorate([S(cc.Node)],t.prototype,"listContainer",void 0),__decorate([S(cc.Node)],t.prototype,"tabBtnItem",void 0),__decorate([S(cc.Node)],t.prototype,"prefabContent",void 0),t=i=__decorate([T],t)}(n.default);i.default=I,cc._RF.pop()},{"../../Core/ConfigsManager":"ConfigsManager","../../Core/LoadManager":"LoadManager","../../Core/TimeController":"TimeController","../../Core/Window":"Window","../../Core/WindowType":"WindowType","../../Global/GlobalValue":"GlobalValue","../../GlobalContext":"GlobalContext","../../Util/Utils":"Utils","../ActivityView/ActivityCtrl":"ActivityCtrl","../DailySignIn/DailySignInController":"DailySignInController","../Functionicon/FunctionIconController":"FunctionIconController","../Functionicon/UtilsFunClick":"UtilsFunClick","../InvestmentPlan/InvestmentPlanContrl":"InvestmentPlanContrl","../Vip/VipCtrl":"VipCtrl","./dailyMeal/DailyMealCtrl":"DailyMealCtrl","./onlineReward/welfareOnlineRewardCtrl":"welfareOnlineRewardCtrl","./privilegeCard/PrivilegeCardCtrl":"PrivilegeCardCtrl","./welfarelobbyUtils":"welfarelobbyUtils"}]},{},["InitSubpackage","loadingtipconf","rolenameconf","CacheManager","CommonRes","CommonTabItem","CommonTabList","CommonsResManager","ConfigsManager","EntityType","SAttributeConst","Controller","EffectBase","Event","Flag","FlagController","GameEventDispatcher","LabelWidget","Language","LoadManager","Managet","PrefabCache","SimpleActionEffect","SpineBase","StopClickEventComponent","TimeController","Widget","Window","WindowManager","WindowType","Enter","SAttributeEvent","GlobalContext","GlobalValue","Main","AchieveInfo","AchievementController","AchievementData","AchievementWin","TabList","Typeinfo","AcquistionPathWin","PathItem","ActivityCfg","ActivityCtrl","ActivityData","ActivityReturnController","ActivityReturnData","ActivityReturnEvent","ActivityReturnItem","ActivityReturnItemData","ActivityReturnView","ActivityView","FirstChargge","GroupPurchase","GroupPurchaseContrl","HalfPriceCtrl","HalfPriceGiftVo","HalfPriceItem","HalfPriceWin","SevenDayGoalCtrl","SevenDayGoalData","SevenDayGoalItem","SevenDayGoalView","SevenDayLoginCtrl","SevenDayLoginData","SevenDayLoginView","SevenDayRankingCtrl","SevenDayRankingData","SevenDayRankingItem","SevenDayRankingView","SevenDayTargetConst","SevenDayTargetCtrl","SevenDayTargetRankWin","SevenDayTargetUtils","SevenDayTargetWin","SevenDayTargetItem","SevenDayTargetRankItem","SevenDayTargetRewardItem","SevenDayTargetTaskItem","SevenDayTargetToggleItem","SevenDayTargetConfVo","SevenDayTargetRankConfVo","SevenDayTargetRewardVo","SevenDayTargetScoreConfVo","SevenDayTargetSerRankVo","SevenDayTargetSerVo","SingleRechargeRebateCtrl","SingleRechargeRebateData","SingleRechargeRebateItem","SingleRechargeRebateView","ActivityController","ActivityHallData","ActivityHallItemData","ActivityHallEvent","ActivityHallItem","ActivityHallPage","ArenaController","ArenaLineup","ArenaResultWin","ArenaRewardInfoPage","ArenaSingleResultWin","ArenaTeamInfo","ArenaWindow","ArtifactCollectionCtrl","ArtifactCollectionData","ArtifactCollectionItem","ArtifactCollectionView","ArtifactAttrItem","ArtifactCtrl","ArtifactData","ArtifactEffect","ArtifactEffectItem","ArtifactEquip","ArtifactSkillTips","ArtifactUtils","ArtifactView","FeedBackWin","BaiBeiFanLiConst","BaiBeiFanLiCtrl","BaiBeiFanLiVo","BaiBeiFanLiWin","BuffCell","BuffController","BuffIcon","CardRecommendOfficialItem","CardRecommendOfficialWin","CardRecommended","RecommendItem","UltimateTeamItem","BossComming","ChapterController","ChapterRewardTips","ChapterRewardItem","ChapterRewardWin","ChapterScouring","EventChapter","GuanqiaController","SweepingItem","ChatCell","ChatConst","ChatController","ChatFridLaunch","ChatFridcell","ChatNotice","ChatNoticeController","ChatNoticeVo","ChatSystemInfo","ChatTips","ChatVo","Chatentrance","Chatwin","CmdUtils","CmdWindow","ComUtils","CombatValue","CommonBtn","CommonPageBG","CommonProgress","EditBoxUtils","Image","ListViewCtrl","MaskBg","MonsterPreview","MorphologicalTags","MotionStreakWidget","RewardUtils","RichTextUtils","RulePage","Spine","SpineShotView","TabBtnList","TabBtnSubList","WindowBg1","WindowBg2","WindowBg4","WindowBg5","WindowOpenUtils","DailyCopyConst","DailyCopyCtrl","DailyCopyData","DailyCopyMoneyData","DailyCopyMoneyVo","DailyCopySerVo","DailyCopyVo","DailyCopyWin","DailySignIn","DailySignInController","Daily","DailyData","DailyItem","Dailycontroller","TaskTip","Tips","VitalityBox","DecomposeAndSyntheticView","DecomposeCtrl","DecomposeData","DecomposeView","IconBtn","SyntheticCard","SyntheticCtrl","SyntheticData","SyntheticItem","SyntheticView","TagBtn","CardEffect","DrawCard","DrawCardConst","DrawCardData","DrawCardItem","DrawController","RewardedCard","UIBtnEffectController","EliteBoss","EliteBossControl","EliteBossOpenTips","EliteitemPrefab","EquipCopyAttrAddItem","EquipCopyAttrAddItem1","EquipCopyAttrAddItem2","EquipCopyAttrAddPage","EquipCopyAttrLayer","EquipCopyAttrPage","EquipCopyAttrSelect","EquipCopyBoxItem","EquipCopyBoxListPage","EquipCopyBoxPage","EquipCopyController","EquipCopyAttrData","EquipCopyAttrItem","EquipCopyData","EquipCopyMainData","EquipCopyShopItemData","EquipCopyWipeBuyAttr","EquipCopyWipeShopLevel","EquipCopyDifficultyItem","EquipCopyDifficultyPage","EquipCopyEvent","EquipCopyAttrRightItem","EquipCopyNodeItem","EquipCopyUtils","EquipCopyWin","EquipCopyWipeResult","EquipCopyWipeWin","AttrNode","EquipAttrTileNode","EquipTypeNodeTwo","Attribute","EquipInfo","EquipTypeNode","EquipWin","RangeNode","ReplaceWin","EquipCtrl","EquipData","EquipEffect","Gemstone","Refine","Strengthen","UpgradeStage","grailAttributeNode","ExpCopyConst","ExpCopyCtrl","ExpCopyPassItem","ExpCopyToggleItem","ExpCopyUtils","ExpCopyWin","ExpCopyDifficuteVo","ExpCopyPassVo","ExpCopySerDataVo","Expedition","ExpeditionConfig","ExpeditionController","ExpeditionGuardInfo","ExpeditionMirrorChioce","ExpeditionMirrorPage","ExpeditionMonsterinfo","ExpeditionRecord","ExpeditionReset","ExpeditionReward","FightActiveSkill","FightBuffItem","FightBuffTips","FightInfoPanel","FightSimulatorBox","FightDamageBigItem","FightDamageSmallItem","FightDamageWin","FightResultCombat","FightResultCommon","FightResultContent","FightResultDailyCopy","FightResultBGEffect","FightResultEffectLose","FightResultEffectVic","FightResultMonsterEffect","FightResultEquipCopy","FightResultExpedition","FightResultTroop","FightResultWin","fightTalk","FightUtils","bufffunc","calculator","fightattr","fightbuff","fightentity","fightlogic","resultfunc","skillfunc","staticattr","FridBossController","FridBossHelpList","FridBossResult","FridBossWin","FriendBossItem","HelpFriendItem","HelpFriendWin","HelpFriendsWin","FunctionIconBtn","FunctionIconController","FunctionIconInfo","FunctionIconItem","FunctionIconWin","UtilsFunClick","ClickLayer","FunBottomList","FunctionIconListCell","GameLayer","EventInterface","InterfaceAnimation","InterfaceLayer","interfaceEffect","RoleHead","finnishanim","Finger","FunctionType","GuideNewController","GuideTarget","GuideVo","NewFunction","ChallengePlayer","HighLadderController","HighLadderData","HighLadderFightingWin","HighLadderReward","HighLadderSkill","HighLadderWin","LadderFighTips","HotUpdateController","InvestmentItem","InvestmentPlan","InvestmentPlanContrl","InternisfyContr","ItemUseNumWin","ItemUser","BagpackWin","GiftBagItem","GiftBagWin","ItemController","ItemData","ItemIcon","ItemListcell","ItemModel","ItemType","ItemWidget","Listcell","UseItemWin","ItemLoading","LoadingController","LoadingPanel","BossBigSkillProgBar","DevilNewsWin","DevilRankItem","DevilResult","LoardCrusadeCtrl","LoardCrusadeWin","LoardRewardWin","Loading","LoginController","LoginRequest","MailCtrl","MailData","MailItem","MailView","MineConst","MineCtrl","MineHelpWin","MineInteractiveWin","MineJournalWin","MineNewsWin","MineUtils","MineWin","MineDispatchtem","MineInteractiveItem","MineItem","MineJournalItem","MineAwardsVo","MineCondVo","MineLogVo","MineSerDataVo","MineSerFriendVo","MineSerVo","MineVo","OneSeckillWin","SeckillItem","OpenFuncTips","OpenWinController","OrnamentCtrl","OrnamentData","OrnamentInfo","OrnamentUpStage","OrnamentUpgrade","OrnamentUtils","OrnamentView","FriendBlackList","FriendSearchList","FriendUtils","FriendsController","FriendsData","FriendsInfo","FriendsNewsVo","FriendsNewsWin","PartnerMain","RecommendFriends","PhysicalWin","PowerContr","PlotController","PlotWin","RankDataOne","RankDataThree","RankDataTwo","RankItemThree","RankItemTwo","RankItmeOne","RankListCtrl","RankListData","RankListView","RankPlayerInfo","RankRewardItem","RankRewardView","RankTypeBtn","RankingConst","FightReelWin","ReelCardInfo","ReelClick","ReelController","ReelMode","ReelWin","CreateRole","RoleAddAttrItem","RoleAddProductEffectWin","RoleAddProductWin","RoleAttrItem","RoleClearItem","RoleClearWin","RoleConst","RoleController","RoleFaShionData","RoleFashionVo","RoleHeadSetUpItem","RoleHeadSetUpWin","RoleInfo","RoleNeedItemVo","RoleQualityVo","RoleSkillTips","RoleSkillVo","RoleSkinPage","RoleStrengthenMaterial","RoleStrengthenMaterialItem","RoleStrengthenMaterialWay","RoleFightChange","RoleStrengthenController","RoleStrengthenData","RoleStrengthenItemData","RoleStrengthenMaterialItemData","RoleStrengthenMaterialWayData","RoleStrengthenRewardData","RoleStrengthenEvent","RoleStrengthenPage","RoleStrengthen","RoleStrengthenItem","RoleTitle","RoleTitleAttrItem","RoleTitleController","RoleTitleAttrData","RoleTitleData","RoleTitleItemData","RoleTitleEvent","RoleTitleItem","RoleTitlePage","RoleTrainVo","RoleUtils","RoleWin","TopupNode","BilibiliSDK","GameBaseSDK","GameSDK","QQSDK","SDKPlatform","WebSDK","XYHDSDK","MapEdit","SandTableBackstage","SandTableBg","SandTableCardSynthesis","SandTableChapterguide","SandTableConditionController","SandTableController","SandTableIntegral","SandTableMain","SandTableRec","SandTableShow","SandTableSymbol","SandTableTalent","SandTableWin","SandtableFunTip","SandtableShapan","map","simulator_Icon","simulator_SandTable","simulator_SandTableBackstage","ActiveActor","Animal","AvatarBase","RichAvatar","BigSkill18Controller","BigSkill22Controller","BigSkillArf2Controller","BigSkillArf3Controller","BigSkillArf4Controller","BigSkillArf5Controller","BigSkillArfController","SpecialEffectController","CardEquipAddUtils","EntityQiPaoController","FightController","FightTimeController","GuideFightController","MonsterInitPointController","ReinforcementsController","SceneController","ServerFightController","SkillController","SpecialSkillEffectController","ZFController","SceneJumpCtrl","AttackEffect","AttackEffectUtils","BuffTipHurt","BuffTypeEffectUtils","FntItemAddHurt","FntItemHurt","FntItemLZHurt","FntItemReduceCoin","FntItemSelfHurt","FntSwingGp","FntSwingUtils","MonsterIndividualityUtils","ThundercloudEffect","LayerableCompent","MonsterDeadTipManager","SceneManager","Monster","OhterPlayer","Player","ActorPools","SpinePools","EntityProperty","Role","SceneEntity","SmallWindowZoom","VariousAnim","AsyncResObj","BitmapObj","FightConst","FightLog","ProBarTween","SkillInfo","CardSynthesis","CardSynthesisEnd","RoleUpgrading","ActorsBigSkillLayer","ActorsLayer","ActorsMaskLayer","ChapterLevelInfo","ChapterMapView","ChapterReward","FightInfo","ListControl","MapUnitMoveCtrl","MonsterInfofight_cell","PlayerWealthControl","CloudMove","FightView","MapView","MapViewOne","SceneView","DamageInfo","MyServersListItem","SelectListItem","SelectServersPanel","ServersListItem","DiamondInfo","DiamondShop","EnterBtn","ItemInfo","Shop","ShopBuyConfire","ShopConst","ShopController","ShopData","ShopItem","ShopItemVo","ShopModel","TabIcon","TopUpInfo","BigSkillIcon","SoundController","SportController","SportData","SportsWindow","StatusController","StatusType","AchieveTip","BarrageTips","BatchUsageTips","BoxTips","ChannelItem","CutscenesEffect","EquipTipAttrStr","EquipTips","FightWaveTip","Flash","ItemConst","ItemTips","MoneyEffect","OpTipsController","PotentialTips","RewardTips","TipsWin","TipsWinController","TotemsCopyConst","TotemsCopyCtrl","TotemsCopyFirstpassRewardVo","TotemsCopyItem","TotemsCopyMonsterItem","TotemsCopyPassRewardVo","TotemsCopyPermutationVo","TotemsCopyPositionVo","TotemsCopySerVo","TotemsCopyUtils","TotemsCopyVo","TotemsCopyWin","TotemsAdvancedItem","TotemsAttrItem","TotemsAttrThanItem","TotemsClearItem","TotemsClearWin","TotemsConditionVo","TotemsConst","TotemsCtrl","TotemsGiftedPlayertItem","TotemsLevelVo","TotemsNeedItemVo","TotemsRateVo","TotemsReshuffleVo","TotemsSerVo","TotemsStarVo","TotemsStrengthenItem","TotemsTalentItem","TotemsUnlockItem","TotemsUpgradeWin","TotemsUtils","TotemsVo","TotemsWin","TreasureConfig","TreasureData","TreasureLevelData","TreasureNodeData","TreasureShopData","TreasureBuff","TreasureLine","TreasureMainView","TreasureMapController","TreasureNodeItem","TreasureResult","TreasureReward","TreasureShop","TreasureShopItem","TreasureTroop","VipAddCount","VipCtrl","VipData","VipLev","VipUPTips","VipWin","CardData","CardGroupAttrItem","CardGroupAttrTips","CardGroupChildTag","CardGroupData","CardGroupTag","CardGroupView","CardItem","CardInfo","CardInfoLayer","CardNews","CardSkill","CardSkillData","CardSkillItem","CardStage","CardStageData","CardUtils","MonsterCard","MonsterController","MonsterInfoBox","MonsterLayout","MonsterLineup","WarTeam","WarTeamMonsterInfo","CardRecommendedVo","ServerMonsterVo","WorldBoss","WorldBossRank","WorldBossRewardInfo","WorldResult","rechargeItem","rechargecarnivalWin","NicknameChange","SettingData","SettingWin","CashGiftBag","SevenDayLoginRewardCtrl","SevenDayLoginRewardData","SevenDayLoginRewardItem","SevenDayLoginRewardView","VipBenefitCtrl","VipBenefitData","VipBenefitItem","VipBenefitView","WelfarelobbyTabBtnItem","DailyMeal","DailyMealConst","DailyMealCtrl","DailyMealVo","welfareOnlineReward","welfareOnlineRewardCtrl","welfareOnlineRewardItem","welfareOnlineRewardVo","PrivilegeCard","PrivilegeCardConst","PrivilegeCardCtrl","PrivilegeCardVo","vipGiftbagItem","vipGiftbagView","welfarelobby","welfarelobbyConst","welfarelobbyUtils","NetConnet","AStar","AStarUtil","AnimationFunction","AnimationUtils","AttrUtil","BackStageUtils","ColorUtil","ComFun","CommonUtil","DateUtil","GrayEffect","InitUIPropertyUtils","LocalStorageUtils","MonsterGroupUtils","NumberUtil","Parabola","RechargeConst","RechargeUtils","ReportSdkUtils","SDKUtils","MoveUtil","Shake","StringUtil","Utils","UtilsFight","WxSubDomainView"]);